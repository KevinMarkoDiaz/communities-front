var nee=Object.defineProperty;var ree=(e,t,n)=>t in e?nee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Au=(e,t,n)=>ree(e,typeof t!="symbol"?t+"":t,n);function iee(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const l in r)if(l!=="default"&&!(l in e)){const d=Object.getOwnPropertyDescriptor(r,l);d&&Object.defineProperty(e,l,d.get?d:{enumerable:!0,get:()=>r[l]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const d of l)if(d.type==="childList")for(const p of d.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&r(p)}).observe(document,{childList:!0,subtree:!0});function n(l){const d={};return l.integrity&&(d.integrity=l.integrity),l.referrerPolicy&&(d.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?d.credentials="include":l.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function r(l){if(l.ep)return;l.ep=!0;const d=n(l);fetch(l.href,d)}})();function Gs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var nC={exports:{}},G1={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xR;function aee(){if(xR)return G1;xR=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,l,d){var p=null;if(d!==void 0&&(p=""+d),l.key!==void 0&&(p=""+l.key),"key"in l){d={};for(var a in l)a!=="key"&&(d[a]=l[a])}else d=l;return l=d.ref,{$$typeof:e,type:r,key:p,ref:l!==void 0?l:null,props:d}}return G1.Fragment=t,G1.jsx=n,G1.jsxs=n,G1}var yR;function see(){return yR||(yR=1,nC.exports=aee()),nC.exports}var f=see(),rC={exports:{}},Ri={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vR;function oee(){if(vR)return Ri;vR=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),p=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),T=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),P=Symbol.iterator;function I(Ge){return Ge===null||typeof Ge!="object"?null:(Ge=P&&Ge[P]||Ge["@@iterator"],typeof Ge=="function"?Ge:null)}var R={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},F=Object.assign,W={};function $(Ge,ot,mt){this.props=Ge,this.context=ot,this.refs=W,this.updater=mt||R}$.prototype.isReactComponent={},$.prototype.setState=function(Ge,ot){if(typeof Ge!="object"&&typeof Ge!="function"&&Ge!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Ge,ot,"setState")},$.prototype.forceUpdate=function(Ge){this.updater.enqueueForceUpdate(this,Ge,"forceUpdate")};function Z(){}Z.prototype=$.prototype;function ne(Ge,ot,mt){this.props=Ge,this.context=ot,this.refs=W,this.updater=mt||R}var ie=ne.prototype=new Z;ie.constructor=ne,F(ie,$.prototype),ie.isPureReactComponent=!0;var ge=Array.isArray,ae={H:null,A:null,T:null,S:null,V:null},se=Object.prototype.hasOwnProperty;function me(Ge,ot,mt,It,In,Mn){return mt=Mn.ref,{$$typeof:e,type:Ge,key:ot,ref:mt!==void 0?mt:null,props:Mn}}function ke(Ge,ot){return me(Ge.type,ot,void 0,void 0,void 0,Ge.props)}function qe(Ge){return typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===e}function tt(Ge){var ot={"=":"=0",":":"=2"};return"$"+Ge.replace(/[=:]/g,function(mt){return ot[mt]})}var nt=/\/+/g;function bt(Ge,ot){return typeof Ge=="object"&&Ge!==null&&Ge.key!=null?tt(""+Ge.key):ot.toString(36)}function jt(){}function Nt(Ge){switch(Ge.status){case"fulfilled":return Ge.value;case"rejected":throw Ge.reason;default:switch(typeof Ge.status=="string"?Ge.then(jt,jt):(Ge.status="pending",Ge.then(function(ot){Ge.status==="pending"&&(Ge.status="fulfilled",Ge.value=ot)},function(ot){Ge.status==="pending"&&(Ge.status="rejected",Ge.reason=ot)})),Ge.status){case"fulfilled":return Ge.value;case"rejected":throw Ge.reason}}throw Ge}function vt(Ge,ot,mt,It,In){var Mn=typeof Ge;(Mn==="undefined"||Mn==="boolean")&&(Ge=null);var vn=!1;if(Ge===null)vn=!0;else switch(Mn){case"bigint":case"string":case"number":vn=!0;break;case"object":switch(Ge.$$typeof){case e:case t:vn=!0;break;case E:return vn=Ge._init,vt(vn(Ge._payload),ot,mt,It,In)}}if(vn)return In=In(Ge),vn=It===""?"."+bt(Ge,0):It,ge(In)?(mt="",vn!=null&&(mt=vn.replace(nt,"$&/")+"/"),vt(In,ot,mt,"",function(un){return un})):In!=null&&(qe(In)&&(In=ke(In,mt+(In.key==null||Ge&&Ge.key===In.key?"":(""+In.key).replace(nt,"$&/")+"/")+vn)),ot.push(In)),1;vn=0;var Zn=It===""?".":It+":";if(ge(Ge))for(var Sr=0;Sr<Ge.length;Sr++)It=Ge[Sr],Mn=Zn+bt(It,Sr),vn+=vt(It,ot,mt,Mn,In);else if(Sr=I(Ge),typeof Sr=="function")for(Ge=Sr.call(Ge),Sr=0;!(It=Ge.next()).done;)It=It.value,Mn=Zn+bt(It,Sr++),vn+=vt(It,ot,mt,Mn,In);else if(Mn==="object"){if(typeof Ge.then=="function")return vt(Nt(Ge),ot,mt,It,In);throw ot=String(Ge),Error("Objects are not valid as a React child (found: "+(ot==="[object Object]"?"object with keys {"+Object.keys(Ge).join(", ")+"}":ot)+"). If you meant to render a collection of children, use an array instead.")}return vn}function He(Ge,ot,mt){if(Ge==null)return Ge;var It=[],In=0;return vt(Ge,It,"","",function(Mn){return ot.call(mt,Mn,In++)}),It}function ut(Ge){if(Ge._status===-1){var ot=Ge._result;ot=ot(),ot.then(function(mt){(Ge._status===0||Ge._status===-1)&&(Ge._status=1,Ge._result=mt)},function(mt){(Ge._status===0||Ge._status===-1)&&(Ge._status=2,Ge._result=mt)}),Ge._status===-1&&(Ge._status=0,Ge._result=ot)}if(Ge._status===1)return Ge._result.default;throw Ge._result}var Tt=typeof reportError=="function"?reportError:function(Ge){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ot=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Ge=="object"&&Ge!==null&&typeof Ge.message=="string"?String(Ge.message):String(Ge),error:Ge});if(!window.dispatchEvent(ot))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Ge);return}console.error(Ge)};function Yt(){}return Ri.Children={map:He,forEach:function(Ge,ot,mt){He(Ge,function(){ot.apply(this,arguments)},mt)},count:function(Ge){var ot=0;return He(Ge,function(){ot++}),ot},toArray:function(Ge){return He(Ge,function(ot){return ot})||[]},only:function(Ge){if(!qe(Ge))throw Error("React.Children.only expected to receive a single React element child.");return Ge}},Ri.Component=$,Ri.Fragment=n,Ri.Profiler=l,Ri.PureComponent=ne,Ri.StrictMode=r,Ri.Suspense=b,Ri.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ae,Ri.__COMPILER_RUNTIME={__proto__:null,c:function(Ge){return ae.H.useMemoCache(Ge)}},Ri.cache=function(Ge){return function(){return Ge.apply(null,arguments)}},Ri.cloneElement=function(Ge,ot,mt){if(Ge==null)throw Error("The argument must be a React element, but you passed "+Ge+".");var It=F({},Ge.props),In=Ge.key,Mn=void 0;if(ot!=null)for(vn in ot.ref!==void 0&&(Mn=void 0),ot.key!==void 0&&(In=""+ot.key),ot)!se.call(ot,vn)||vn==="key"||vn==="__self"||vn==="__source"||vn==="ref"&&ot.ref===void 0||(It[vn]=ot[vn]);var vn=arguments.length-2;if(vn===1)It.children=mt;else if(1<vn){for(var Zn=Array(vn),Sr=0;Sr<vn;Sr++)Zn[Sr]=arguments[Sr+2];It.children=Zn}return me(Ge.type,In,void 0,void 0,Mn,It)},Ri.createContext=function(Ge){return Ge={$$typeof:p,_currentValue:Ge,_currentValue2:Ge,_threadCount:0,Provider:null,Consumer:null},Ge.Provider=Ge,Ge.Consumer={$$typeof:d,_context:Ge},Ge},Ri.createElement=function(Ge,ot,mt){var It,In={},Mn=null;if(ot!=null)for(It in ot.key!==void 0&&(Mn=""+ot.key),ot)se.call(ot,It)&&It!=="key"&&It!=="__self"&&It!=="__source"&&(In[It]=ot[It]);var vn=arguments.length-2;if(vn===1)In.children=mt;else if(1<vn){for(var Zn=Array(vn),Sr=0;Sr<vn;Sr++)Zn[Sr]=arguments[Sr+2];In.children=Zn}if(Ge&&Ge.defaultProps)for(It in vn=Ge.defaultProps,vn)In[It]===void 0&&(In[It]=vn[It]);return me(Ge,Mn,void 0,void 0,null,In)},Ri.createRef=function(){return{current:null}},Ri.forwardRef=function(Ge){return{$$typeof:a,render:Ge}},Ri.isValidElement=qe,Ri.lazy=function(Ge){return{$$typeof:E,_payload:{_status:-1,_result:Ge},_init:ut}},Ri.memo=function(Ge,ot){return{$$typeof:T,type:Ge,compare:ot===void 0?null:ot}},Ri.startTransition=function(Ge){var ot=ae.T,mt={};ae.T=mt;try{var It=Ge(),In=ae.S;In!==null&&In(mt,It),typeof It=="object"&&It!==null&&typeof It.then=="function"&&It.then(Yt,Tt)}catch(Mn){Tt(Mn)}finally{ae.T=ot}},Ri.unstable_useCacheRefresh=function(){return ae.H.useCacheRefresh()},Ri.use=function(Ge){return ae.H.use(Ge)},Ri.useActionState=function(Ge,ot,mt){return ae.H.useActionState(Ge,ot,mt)},Ri.useCallback=function(Ge,ot){return ae.H.useCallback(Ge,ot)},Ri.useContext=function(Ge){return ae.H.useContext(Ge)},Ri.useDebugValue=function(){},Ri.useDeferredValue=function(Ge,ot){return ae.H.useDeferredValue(Ge,ot)},Ri.useEffect=function(Ge,ot,mt){var It=ae.H;if(typeof mt=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return It.useEffect(Ge,ot)},Ri.useId=function(){return ae.H.useId()},Ri.useImperativeHandle=function(Ge,ot,mt){return ae.H.useImperativeHandle(Ge,ot,mt)},Ri.useInsertionEffect=function(Ge,ot){return ae.H.useInsertionEffect(Ge,ot)},Ri.useLayoutEffect=function(Ge,ot){return ae.H.useLayoutEffect(Ge,ot)},Ri.useMemo=function(Ge,ot){return ae.H.useMemo(Ge,ot)},Ri.useOptimistic=function(Ge,ot){return ae.H.useOptimistic(Ge,ot)},Ri.useReducer=function(Ge,ot,mt){return ae.H.useReducer(Ge,ot,mt)},Ri.useRef=function(Ge){return ae.H.useRef(Ge)},Ri.useState=function(Ge){return ae.H.useState(Ge)},Ri.useSyncExternalStore=function(Ge,ot,mt){return ae.H.useSyncExternalStore(Ge,ot,mt)},Ri.useTransition=function(){return ae.H.useTransition()},Ri.version="19.1.0",Ri}var _R;function b_(){return _R||(_R=1,rC.exports=oee()),rC.exports}var V=b_();const $s=Gs(V),bR=iee({__proto__:null,default:$s},[V]);var iC={exports:{}},W1={},aC={exports:{}},sC={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wR;function lee(){return wR||(wR=1,function(e){function t(He,ut){var Tt=He.length;He.push(ut);e:for(;0<Tt;){var Yt=Tt-1>>>1,Ge=He[Yt];if(0<l(Ge,ut))He[Yt]=ut,He[Tt]=Ge,Tt=Yt;else break e}}function n(He){return He.length===0?null:He[0]}function r(He){if(He.length===0)return null;var ut=He[0],Tt=He.pop();if(Tt!==ut){He[0]=Tt;e:for(var Yt=0,Ge=He.length,ot=Ge>>>1;Yt<ot;){var mt=2*(Yt+1)-1,It=He[mt],In=mt+1,Mn=He[In];if(0>l(It,Tt))In<Ge&&0>l(Mn,It)?(He[Yt]=Mn,He[In]=Tt,Yt=In):(He[Yt]=It,He[mt]=Tt,Yt=mt);else if(In<Ge&&0>l(Mn,Tt))He[Yt]=Mn,He[In]=Tt,Yt=In;else break e}}return ut}function l(He,ut){var Tt=He.sortIndex-ut.sortIndex;return Tt!==0?Tt:He.id-ut.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;e.unstable_now=function(){return d.now()}}else{var p=Date,a=p.now();e.unstable_now=function(){return p.now()-a}}var b=[],T=[],E=1,P=null,I=3,R=!1,F=!1,W=!1,$=!1,Z=typeof setTimeout=="function"?setTimeout:null,ne=typeof clearTimeout=="function"?clearTimeout:null,ie=typeof setImmediate<"u"?setImmediate:null;function ge(He){for(var ut=n(T);ut!==null;){if(ut.callback===null)r(T);else if(ut.startTime<=He)r(T),ut.sortIndex=ut.expirationTime,t(b,ut);else break;ut=n(T)}}function ae(He){if(W=!1,ge(He),!F)if(n(b)!==null)F=!0,se||(se=!0,bt());else{var ut=n(T);ut!==null&&vt(ae,ut.startTime-He)}}var se=!1,me=-1,ke=5,qe=-1;function tt(){return $?!0:!(e.unstable_now()-qe<ke)}function nt(){if($=!1,se){var He=e.unstable_now();qe=He;var ut=!0;try{e:{F=!1,W&&(W=!1,ne(me),me=-1),R=!0;var Tt=I;try{t:{for(ge(He),P=n(b);P!==null&&!(P.expirationTime>He&&tt());){var Yt=P.callback;if(typeof Yt=="function"){P.callback=null,I=P.priorityLevel;var Ge=Yt(P.expirationTime<=He);if(He=e.unstable_now(),typeof Ge=="function"){P.callback=Ge,ge(He),ut=!0;break t}P===n(b)&&r(b),ge(He)}else r(b);P=n(b)}if(P!==null)ut=!0;else{var ot=n(T);ot!==null&&vt(ae,ot.startTime-He),ut=!1}}break e}finally{P=null,I=Tt,R=!1}ut=void 0}}finally{ut?bt():se=!1}}}var bt;if(typeof ie=="function")bt=function(){ie(nt)};else if(typeof MessageChannel<"u"){var jt=new MessageChannel,Nt=jt.port2;jt.port1.onmessage=nt,bt=function(){Nt.postMessage(null)}}else bt=function(){Z(nt,0)};function vt(He,ut){me=Z(function(){He(e.unstable_now())},ut)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(He){He.callback=null},e.unstable_forceFrameRate=function(He){0>He||125<He?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ke=0<He?Math.floor(1e3/He):5},e.unstable_getCurrentPriorityLevel=function(){return I},e.unstable_next=function(He){switch(I){case 1:case 2:case 3:var ut=3;break;default:ut=I}var Tt=I;I=ut;try{return He()}finally{I=Tt}},e.unstable_requestPaint=function(){$=!0},e.unstable_runWithPriority=function(He,ut){switch(He){case 1:case 2:case 3:case 4:case 5:break;default:He=3}var Tt=I;I=He;try{return ut()}finally{I=Tt}},e.unstable_scheduleCallback=function(He,ut,Tt){var Yt=e.unstable_now();switch(typeof Tt=="object"&&Tt!==null?(Tt=Tt.delay,Tt=typeof Tt=="number"&&0<Tt?Yt+Tt:Yt):Tt=Yt,He){case 1:var Ge=-1;break;case 2:Ge=250;break;case 5:Ge=1073741823;break;case 4:Ge=1e4;break;default:Ge=5e3}return Ge=Tt+Ge,He={id:E++,callback:ut,priorityLevel:He,startTime:Tt,expirationTime:Ge,sortIndex:-1},Tt>Yt?(He.sortIndex=Tt,t(T,He),n(b)===null&&He===n(T)&&(W?(ne(me),me=-1):W=!0,vt(ae,Tt-Yt))):(He.sortIndex=Ge,t(b,He),F||R||(F=!0,se||(se=!0,bt()))),He},e.unstable_shouldYield=tt,e.unstable_wrapCallback=function(He){var ut=I;return function(){var Tt=I;I=ut;try{return He.apply(this,arguments)}finally{I=Tt}}}}(sC)),sC}var SR;function cee(){return SR||(SR=1,aC.exports=lee()),aC.exports}var oC={exports:{}},Bl={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TR;function uee(){if(TR)return Bl;TR=1;var e=b_();function t(b){var T="https://react.dev/errors/"+b;if(1<arguments.length){T+="?args[]="+encodeURIComponent(arguments[1]);for(var E=2;E<arguments.length;E++)T+="&args[]="+encodeURIComponent(arguments[E])}return"Minified React error #"+b+"; visit "+T+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},l=Symbol.for("react.portal");function d(b,T,E){var P=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:P==null?null:""+P,children:b,containerInfo:T,implementation:E}}var p=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function a(b,T){if(b==="font")return"";if(typeof T=="string")return T==="use-credentials"?T:""}return Bl.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Bl.createPortal=function(b,T){var E=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!T||T.nodeType!==1&&T.nodeType!==9&&T.nodeType!==11)throw Error(t(299));return d(b,T,null,E)},Bl.flushSync=function(b){var T=p.T,E=r.p;try{if(p.T=null,r.p=2,b)return b()}finally{p.T=T,r.p=E,r.d.f()}},Bl.preconnect=function(b,T){typeof b=="string"&&(T?(T=T.crossOrigin,T=typeof T=="string"?T==="use-credentials"?T:"":void 0):T=null,r.d.C(b,T))},Bl.prefetchDNS=function(b){typeof b=="string"&&r.d.D(b)},Bl.preinit=function(b,T){if(typeof b=="string"&&T&&typeof T.as=="string"){var E=T.as,P=a(E,T.crossOrigin),I=typeof T.integrity=="string"?T.integrity:void 0,R=typeof T.fetchPriority=="string"?T.fetchPriority:void 0;E==="style"?r.d.S(b,typeof T.precedence=="string"?T.precedence:void 0,{crossOrigin:P,integrity:I,fetchPriority:R}):E==="script"&&r.d.X(b,{crossOrigin:P,integrity:I,fetchPriority:R,nonce:typeof T.nonce=="string"?T.nonce:void 0})}},Bl.preinitModule=function(b,T){if(typeof b=="string")if(typeof T=="object"&&T!==null){if(T.as==null||T.as==="script"){var E=a(T.as,T.crossOrigin);r.d.M(b,{crossOrigin:E,integrity:typeof T.integrity=="string"?T.integrity:void 0,nonce:typeof T.nonce=="string"?T.nonce:void 0})}}else T==null&&r.d.M(b)},Bl.preload=function(b,T){if(typeof b=="string"&&typeof T=="object"&&T!==null&&typeof T.as=="string"){var E=T.as,P=a(E,T.crossOrigin);r.d.L(b,E,{crossOrigin:P,integrity:typeof T.integrity=="string"?T.integrity:void 0,nonce:typeof T.nonce=="string"?T.nonce:void 0,type:typeof T.type=="string"?T.type:void 0,fetchPriority:typeof T.fetchPriority=="string"?T.fetchPriority:void 0,referrerPolicy:typeof T.referrerPolicy=="string"?T.referrerPolicy:void 0,imageSrcSet:typeof T.imageSrcSet=="string"?T.imageSrcSet:void 0,imageSizes:typeof T.imageSizes=="string"?T.imageSizes:void 0,media:typeof T.media=="string"?T.media:void 0})}},Bl.preloadModule=function(b,T){if(typeof b=="string")if(T){var E=a(T.as,T.crossOrigin);r.d.m(b,{as:typeof T.as=="string"&&T.as!=="script"?T.as:void 0,crossOrigin:E,integrity:typeof T.integrity=="string"?T.integrity:void 0})}else r.d.m(b)},Bl.requestFormReset=function(b){r.d.r(b)},Bl.unstable_batchedUpdates=function(b,T){return b(T)},Bl.useFormState=function(b,T,E){return p.H.useFormState(b,T,E)},Bl.useFormStatus=function(){return p.H.useHostTransitionStatus()},Bl.version="19.1.0",Bl}var ER;function lV(){if(ER)return oC.exports;ER=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),oC.exports=uee(),oC.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AR;function dee(){if(AR)return W1;AR=1;var e=cee(),t=b_(),n=lV();function r(m){var v="https://react.dev/errors/"+m;if(1<arguments.length){v+="?args[]="+encodeURIComponent(arguments[1]);for(var C=2;C<arguments.length;C++)v+="&args[]="+encodeURIComponent(arguments[C])}return"Minified React error #"+m+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(m){return!(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)}function d(m){var v=m,C=m;if(m.alternate)for(;v.return;)v=v.return;else{m=v;do v=m,(v.flags&4098)!==0&&(C=v.return),m=v.return;while(m)}return v.tag===3?C:null}function p(m){if(m.tag===13){var v=m.memoizedState;if(v===null&&(m=m.alternate,m!==null&&(v=m.memoizedState)),v!==null)return v.dehydrated}return null}function a(m){if(d(m)!==m)throw Error(r(188))}function b(m){var v=m.alternate;if(!v){if(v=d(m),v===null)throw Error(r(188));return v!==m?null:m}for(var C=m,k=v;;){var G=C.return;if(G===null)break;var ee=G.alternate;if(ee===null){if(k=G.return,k!==null){C=k;continue}break}if(G.child===ee.child){for(ee=G.child;ee;){if(ee===C)return a(G),m;if(ee===k)return a(G),v;ee=ee.sibling}throw Error(r(188))}if(C.return!==k.return)C=G,k=ee;else{for(var _e=!1,Re=G.child;Re;){if(Re===C){_e=!0,C=G,k=ee;break}if(Re===k){_e=!0,k=G,C=ee;break}Re=Re.sibling}if(!_e){for(Re=ee.child;Re;){if(Re===C){_e=!0,C=ee,k=G;break}if(Re===k){_e=!0,k=ee,C=G;break}Re=Re.sibling}if(!_e)throw Error(r(189))}}if(C.alternate!==k)throw Error(r(190))}if(C.tag!==3)throw Error(r(188));return C.stateNode.current===C?m:v}function T(m){var v=m.tag;if(v===5||v===26||v===27||v===6)return m;for(m=m.child;m!==null;){if(v=T(m),v!==null)return v;m=m.sibling}return null}var E=Object.assign,P=Symbol.for("react.element"),I=Symbol.for("react.transitional.element"),R=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),W=Symbol.for("react.strict_mode"),$=Symbol.for("react.profiler"),Z=Symbol.for("react.provider"),ne=Symbol.for("react.consumer"),ie=Symbol.for("react.context"),ge=Symbol.for("react.forward_ref"),ae=Symbol.for("react.suspense"),se=Symbol.for("react.suspense_list"),me=Symbol.for("react.memo"),ke=Symbol.for("react.lazy"),qe=Symbol.for("react.activity"),tt=Symbol.for("react.memo_cache_sentinel"),nt=Symbol.iterator;function bt(m){return m===null||typeof m!="object"?null:(m=nt&&m[nt]||m["@@iterator"],typeof m=="function"?m:null)}var jt=Symbol.for("react.client.reference");function Nt(m){if(m==null)return null;if(typeof m=="function")return m.$$typeof===jt?null:m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case F:return"Fragment";case $:return"Profiler";case W:return"StrictMode";case ae:return"Suspense";case se:return"SuspenseList";case qe:return"Activity"}if(typeof m=="object")switch(m.$$typeof){case R:return"Portal";case ie:return(m.displayName||"Context")+".Provider";case ne:return(m._context.displayName||"Context")+".Consumer";case ge:var v=m.render;return m=m.displayName,m||(m=v.displayName||v.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case me:return v=m.displayName||null,v!==null?v:Nt(m.type)||"Memo";case ke:v=m._payload,m=m._init;try{return Nt(m(v))}catch{}}return null}var vt=Array.isArray,He=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ut=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Tt={pending:!1,data:null,method:null,action:null},Yt=[],Ge=-1;function ot(m){return{current:m}}function mt(m){0>Ge||(m.current=Yt[Ge],Yt[Ge]=null,Ge--)}function It(m,v){Ge++,Yt[Ge]=m.current,m.current=v}var In=ot(null),Mn=ot(null),vn=ot(null),Zn=ot(null);function Sr(m,v){switch(It(vn,v),It(Mn,m),It(In,null),v.nodeType){case 9:case 11:m=(m=v.documentElement)&&(m=m.namespaceURI)?lv(m):0;break;default:if(m=v.tagName,v=v.namespaceURI)v=lv(v),m=cv(v,m);else switch(m){case"svg":m=1;break;case"math":m=2;break;default:m=0}}mt(In),It(In,m)}function un(){mt(In),mt(Mn),mt(vn)}function er(m){m.memoizedState!==null&&It(Zn,m);var v=In.current,C=cv(v,m.type);v!==C&&(It(Mn,m),It(In,C))}function hr(m){Mn.current===m&&(mt(In),mt(Mn)),Zn.current===m&&(mt(Zn),Mg._currentValue=Tt)}var dn=Object.prototype.hasOwnProperty,Ir=e.unstable_scheduleCallback,Zr=e.unstable_cancelCallback,sa=e.unstable_shouldYield,Mi=e.unstable_requestPaint,Ci=e.unstable_now,ls=e.unstable_getCurrentPriorityLevel,wa=e.unstable_ImmediatePriority,Xa=e.unstable_UserBlockingPriority,Ds=e.unstable_NormalPriority,Ft=e.unstable_LowPriority,Hn=e.unstable_IdlePriority,Zt=e.log,pn=e.unstable_setDisableYieldValue,tr=null,Qn=null;function Yr(m){if(typeof Zt=="function"&&pn(m),Qn&&typeof Qn.setStrictMode=="function")try{Qn.setStrictMode(tr,m)}catch{}}var pi=Math.clz32?Math.clz32:Xs,Ua=Math.log,Ji=Math.LN2;function Xs(m){return m>>>=0,m===0?32:31-(Ua(m)/Ji|0)|0}var Ka=256,La=4194304;function cs(m){var v=m&42;if(v!==0)return v;switch(m&-m){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return m&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return m}}function Os(m,v,C){var k=m.pendingLanes;if(k===0)return 0;var G=0,ee=m.suspendedLanes,_e=m.pingedLanes;m=m.warmLanes;var Re=k&134217727;return Re!==0?(k=Re&~ee,k!==0?G=cs(k):(_e&=Re,_e!==0?G=cs(_e):C||(C=Re&~m,C!==0&&(G=cs(C))))):(Re=k&~ee,Re!==0?G=cs(Re):_e!==0?G=cs(_e):C||(C=k&~m,C!==0&&(G=cs(C)))),G===0?0:v!==0&&v!==G&&(v&ee)===0&&(ee=G&-G,C=v&-v,ee>=C||ee===32&&(C&4194048)!==0)?v:G}function vs(m,v){return(m.pendingLanes&~(m.suspendedLanes&~m.pingedLanes)&v)===0}function yi(m,v){switch(m){case 1:case 2:case 4:case 8:case 64:return v+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return v+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Is(){var m=Ka;return Ka<<=1,(Ka&4194048)===0&&(Ka=256),m}function Yc(){var m=La;return La<<=1,(La&62914560)===0&&(La=4194304),m}function ks(m){for(var v=[],C=0;31>C;C++)v.push(m);return v}function Kl(m,v){m.pendingLanes|=v,v!==268435456&&(m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0)}function Hd(m,v,C,k,G,ee){var _e=m.pendingLanes;m.pendingLanes=C,m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0,m.expiredLanes&=C,m.entangledLanes&=C,m.errorRecoveryDisabledLanes&=C,m.shellSuspendCounter=0;var Re=m.entanglements,at=m.expirationTimes,Lt=m.hiddenUpdates;for(C=_e&~C;0<C;){var hn=31-pi(C),En=1<<hn;Re[hn]=0,at[hn]=-1;var Ht=Lt[hn];if(Ht!==null)for(Lt[hn]=null,hn=0;hn<Ht.length;hn++){var Wt=Ht[hn];Wt!==null&&(Wt.lane&=-536870913)}C&=~En}k!==0&&Yl(m,k,0),ee!==0&&G===0&&m.tag!==0&&(m.suspendedLanes|=ee&~(_e&~v))}function Yl(m,v,C){m.pendingLanes|=v,m.suspendedLanes&=~v;var k=31-pi(v);m.entangledLanes|=v,m.entanglements[k]=m.entanglements[k]|1073741824|C&4194090}function Kt(m,v){var C=m.entangledLanes|=v;for(m=m.entanglements;C;){var k=31-pi(C),G=1<<k;G&v|m[k]&v&&(m[k]|=v),C&=~G}}function el(m){switch(m){case 2:m=1;break;case 8:m=4;break;case 32:m=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:m=128;break;case 268435456:m=134217728;break;default:m=0}return m}function Fu(m){return m&=-m,2<m?8<m?(m&134217727)!==0?32:268435456:8:2}function Te(){var m=ut.p;return m!==0?m:(m=window.event,m===void 0?32:Ng(m.type))}function te(m,v){var C=ut.p;try{return ut.p=m,v()}finally{ut.p=C}}var le=Math.random().toString(36).slice(2),ye="__reactFiber$"+le,Me="__reactProps$"+le,De="__reactContainer$"+le,Be="__reactEvents$"+le,Le="__reactListeners$"+le,Ue="__reactHandles$"+le,Ye="__reactResources$"+le,it="__reactMarker$"+le;function Xe(m){delete m[ye],delete m[Me],delete m[Be],delete m[Le],delete m[Ue]}function St(m){var v=m[ye];if(v)return v;for(var C=m.parentNode;C;){if(v=C[De]||C[ye]){if(C=v.alternate,v.child!==null||C!==null&&C.child!==null)for(m=Bf(m);m!==null;){if(C=m[ye])return C;m=Bf(m)}return v}m=C,C=m.parentNode}return null}function qt(m){if(m=m[ye]||m[De]){var v=m.tag;if(v===5||v===6||v===13||v===26||v===27||v===3)return m}return null}function nn(m){var v=m.tag;if(v===5||v===26||v===27||v===6)return m.stateNode;throw Error(r(33))}function Fn(m){var v=m[Ye];return v||(v=m[Ye]={hoistableStyles:new Map,hoistableScripts:new Map}),v}function zn(m){m[it]=!0}var Ln=new Set,cr={};function Qr(m,v){or(m,v),or(m+"Capture",v)}function or(m,v){for(cr[m]=v,m=0;m<v.length;m++)Ln.add(v[m])}var Lr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Cr={},Jr={};function mi(m){return dn.call(Jr,m)?!0:dn.call(Cr,m)?!1:Lr.test(m)?Jr[m]=!0:(Cr[m]=!0,!1)}function Ti(m,v,C){if(mi(v))if(C===null)m.removeAttribute(v);else{switch(typeof C){case"undefined":case"function":case"symbol":m.removeAttribute(v);return;case"boolean":var k=v.toLowerCase().slice(0,5);if(k!=="data-"&&k!=="aria-"){m.removeAttribute(v);return}}m.setAttribute(v,""+C)}}function ea(m,v,C){if(C===null)m.removeAttribute(v);else{switch(typeof C){case"undefined":case"function":case"symbol":case"boolean":m.removeAttribute(v);return}m.setAttribute(v,""+C)}}function Ar(m,v,C,k){if(k===null)m.removeAttribute(C);else{switch(typeof k){case"undefined":case"function":case"symbol":case"boolean":m.removeAttribute(C);return}m.setAttributeNS(v,C,""+k)}}var qi,us;function fa(m){if(qi===void 0)try{throw Error()}catch(C){var v=C.stack.trim().match(/\n( *(at )?)/);qi=v&&v[1]||"",us=-1<C.stack.indexOf(`
    at`)?" (<anonymous>)":-1<C.stack.indexOf("@")?"@unknown:0:0":""}return`
`+qi+m+us}var Fa=!1;function ci(m,v){if(!m||Fa)return"";Fa=!0;var C=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var k={DetermineComponentFrameRoot:function(){try{if(v){var En=function(){throw Error()};if(Object.defineProperty(En.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(En,[])}catch(Wt){var Ht=Wt}Reflect.construct(m,[],En)}else{try{En.call()}catch(Wt){Ht=Wt}m.call(En.prototype)}}else{try{throw Error()}catch(Wt){Ht=Wt}(En=m())&&typeof En.catch=="function"&&En.catch(function(){})}}catch(Wt){if(Wt&&Ht&&typeof Wt.stack=="string")return[Wt.stack,Ht.stack]}return[null,null]}};k.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var G=Object.getOwnPropertyDescriptor(k.DetermineComponentFrameRoot,"name");G&&G.configurable&&Object.defineProperty(k.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var ee=k.DetermineComponentFrameRoot(),_e=ee[0],Re=ee[1];if(_e&&Re){var at=_e.split(`
`),Lt=Re.split(`
`);for(G=k=0;k<at.length&&!at[k].includes("DetermineComponentFrameRoot");)k++;for(;G<Lt.length&&!Lt[G].includes("DetermineComponentFrameRoot");)G++;if(k===at.length||G===Lt.length)for(k=at.length-1,G=Lt.length-1;1<=k&&0<=G&&at[k]!==Lt[G];)G--;for(;1<=k&&0<=G;k--,G--)if(at[k]!==Lt[G]){if(k!==1||G!==1)do if(k--,G--,0>G||at[k]!==Lt[G]){var hn=`
`+at[k].replace(" at new "," at ");return m.displayName&&hn.includes("<anonymous>")&&(hn=hn.replace("<anonymous>",m.displayName)),hn}while(1<=k&&0<=G);break}}}finally{Fa=!1,Error.prepareStackTrace=C}return(C=m?m.displayName||m.name:"")?fa(C):""}function Ca(m){switch(m.tag){case 26:case 27:case 5:return fa(m.type);case 16:return fa("Lazy");case 13:return fa("Suspense");case 19:return fa("SuspenseList");case 0:case 15:return ci(m.type,!1);case 11:return ci(m.type.render,!1);case 1:return ci(m.type,!0);case 31:return fa("Activity");default:return""}}function No(m){try{var v="";do v+=Ca(m),m=m.return;while(m);return v}catch(C){return`
Error generating stack: `+C.message+`
`+C.stack}}function rs(m){switch(typeof m){case"bigint":case"boolean":case"number":case"string":case"undefined":return m;case"object":return m;default:return""}}function nf(m){var v=m.type;return(m=m.nodeName)&&m.toLowerCase()==="input"&&(v==="checkbox"||v==="radio")}function rf(m){var v=nf(m)?"checked":"value",C=Object.getOwnPropertyDescriptor(m.constructor.prototype,v),k=""+m[v];if(!m.hasOwnProperty(v)&&typeof C<"u"&&typeof C.get=="function"&&typeof C.set=="function"){var G=C.get,ee=C.set;return Object.defineProperty(m,v,{configurable:!0,get:function(){return G.call(this)},set:function(_e){k=""+_e,ee.call(this,_e)}}),Object.defineProperty(m,v,{enumerable:C.enumerable}),{getValue:function(){return k},setValue:function(_e){k=""+_e},stopTracking:function(){m._valueTracker=null,delete m[v]}}}}function Gd(m){m._valueTracker||(m._valueTracker=rf(m))}function af(m){if(!m)return!1;var v=m._valueTracker;if(!v)return!0;var C=v.getValue(),k="";return m&&(k=nf(m)?m.checked?"true":"false":m.value),m=k,m!==C?(v.setValue(m),!0):!1}function Cc(m){if(m=m||(typeof document<"u"?document:void 0),typeof m>"u")return null;try{return m.activeElement||m.body}catch{return m.body}}var dp=/[\n"\\]/g;function Do(m){return m.replace(dp,function(v){return"\\"+v.charCodeAt(0).toString(16)+" "})}function tl(m,v,C,k,G,ee,_e,Re){m.name="",_e!=null&&typeof _e!="function"&&typeof _e!="symbol"&&typeof _e!="boolean"?m.type=_e:m.removeAttribute("type"),v!=null?_e==="number"?(v===0&&m.value===""||m.value!=v)&&(m.value=""+rs(v)):m.value!==""+rs(v)&&(m.value=""+rs(v)):_e!=="submit"&&_e!=="reset"||m.removeAttribute("value"),v!=null?Ks(m,_e,rs(v)):C!=null?Ks(m,_e,rs(C)):k!=null&&m.removeAttribute("value"),G==null&&ee!=null&&(m.defaultChecked=!!ee),G!=null&&(m.checked=G&&typeof G!="function"&&typeof G!="symbol"),Re!=null&&typeof Re!="function"&&typeof Re!="symbol"&&typeof Re!="boolean"?m.name=""+rs(Re):m.removeAttribute("name")}function Hm(m,v,C,k,G,ee,_e,Re){if(ee!=null&&typeof ee!="function"&&typeof ee!="symbol"&&typeof ee!="boolean"&&(m.type=ee),v!=null||C!=null){if(!(ee!=="submit"&&ee!=="reset"||v!=null))return;C=C!=null?""+rs(C):"",v=v!=null?""+rs(v):C,Re||v===m.value||(m.value=v),m.defaultValue=v}k=k??G,k=typeof k!="function"&&typeof k!="symbol"&&!!k,m.checked=Re?m.checked:!!k,m.defaultChecked=!!k,_e!=null&&typeof _e!="function"&&typeof _e!="symbol"&&typeof _e!="boolean"&&(m.name=_e)}function Ks(m,v,C){v==="number"&&Cc(m.ownerDocument)===m||m.defaultValue===""+C||(m.defaultValue=""+C)}function Ys(m,v,C,k){if(m=m.options,v){v={};for(var G=0;G<C.length;G++)v["$"+C[G]]=!0;for(C=0;C<m.length;C++)G=v.hasOwnProperty("$"+m[C].value),m[C].selected!==G&&(m[C].selected=G),G&&k&&(m[C].defaultSelected=!0)}else{for(C=""+rs(C),v=null,G=0;G<m.length;G++){if(m[G].value===C){m[G].selected=!0,k&&(m[G].defaultSelected=!0);return}v!==null||m[G].disabled||(v=m[G])}v!==null&&(v.selected=!0)}}function jc(m,v,C){if(v!=null&&(v=""+rs(v),v!==m.value&&(m.value=v),C==null)){m.defaultValue!==v&&(m.defaultValue=v);return}m.defaultValue=C!=null?""+rs(C):""}function _l(m,v,C,k){if(v==null){if(k!=null){if(C!=null)throw Error(r(92));if(vt(k)){if(1<k.length)throw Error(r(93));k=k[0]}C=k}C==null&&(C=""),v=C}C=rs(v),m.defaultValue=C,k=m.textContent,k===C&&k!==""&&k!==null&&(m.value=k)}function Oo(m,v){if(v){var C=m.firstChild;if(C&&C===m.lastChild&&C.nodeType===3){C.nodeValue=v;return}}m.textContent=v}var bl=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function sf(m,v,C){var k=v.indexOf("--")===0;C==null||typeof C=="boolean"||C===""?k?m.setProperty(v,""):v==="float"?m.cssFloat="":m[v]="":k?m.setProperty(v,C):typeof C!="number"||C===0||bl.has(v)?v==="float"?m.cssFloat=C:m[v]=(""+C).trim():m[v]=C+"px"}function Gm(m,v,C){if(v!=null&&typeof v!="object")throw Error(r(62));if(m=m.style,C!=null){for(var k in C)!C.hasOwnProperty(k)||v!=null&&v.hasOwnProperty(k)||(k.indexOf("--")===0?m.setProperty(k,""):k==="float"?m.cssFloat="":m[k]="");for(var G in v)k=v[G],v.hasOwnProperty(G)&&C[G]!==k&&sf(m,G,k)}else for(var ee in v)v.hasOwnProperty(ee)&&sf(m,ee,v[ee])}function Ql(m){if(m.indexOf("-")===-1)return!1;switch(m){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hp=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),vx=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Bu(m){return vx.test(""+m)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":m}var _s=null;function of(m){return m=m.target||m.srcElement||window,m.correspondingUseElement&&(m=m.correspondingUseElement),m.nodeType===3?m.parentNode:m}var Qc=null,Jl=null;function _x(m){var v=qt(m);if(v&&(m=v.stateNode)){var C=m[Me]||null;e:switch(m=v.stateNode,v.type){case"input":if(tl(m,C.value,C.defaultValue,C.defaultValue,C.checked,C.defaultChecked,C.type,C.name),v=C.name,C.type==="radio"&&v!=null){for(C=m;C.parentNode;)C=C.parentNode;for(C=C.querySelectorAll('input[name="'+Do(""+v)+'"][type="radio"]'),v=0;v<C.length;v++){var k=C[v];if(k!==m&&k.form===m.form){var G=k[Me]||null;if(!G)throw Error(r(90));tl(k,G.value,G.defaultValue,G.defaultValue,G.checked,G.defaultChecked,G.type,G.name)}}for(v=0;v<C.length;v++)k=C[v],k.form===m.form&&af(k)}break e;case"textarea":jc(m,C.value,C.defaultValue);break e;case"select":v=C.value,v!=null&&Ys(m,!!C.multiple,v,!1)}}}var lf=!1;function fp(m,v,C){if(lf)return m(v,C);lf=!0;try{var k=m(v);return k}finally{if(lf=!1,(Qc!==null||Jl!==null)&&(_u(),Qc&&(v=Qc,m=Jl,Jl=Qc=null,_x(v),m)))for(v=0;v<m.length;v++)_x(m[v])}}function Rr(m,v){var C=m.stateNode;if(C===null)return null;var k=C[Me]||null;if(k===null)return null;C=k[v];e:switch(v){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(k=!k.disabled)||(m=m.type,k=!(m==="button"||m==="input"||m==="select"||m==="textarea")),m=!k;break e;default:m=!1}if(m)return null;if(C&&typeof C!="function")throw Error(r(231,v,typeof C));return C}var Io=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vu=!1;if(Io)try{var pp={};Object.defineProperty(pp,"passive",{get:function(){Vu=!0}}),window.addEventListener("test",pp,pp),window.removeEventListener("test",pp,pp)}catch{Vu=!1}var Jc=null,eu=null,ec=null;function Wd(){if(ec)return ec;var m,v=eu,C=v.length,k,G="value"in Jc?Jc.value:Jc.textContent,ee=G.length;for(m=0;m<C&&v[m]===G[m];m++);var _e=C-m;for(k=1;k<=_e&&v[C-k]===G[ee-k];k++);return ec=G.slice(m,1<k?1-k:void 0)}function mp(m){var v=m.keyCode;return"charCode"in m?(m=m.charCode,m===0&&v===13&&(m=13)):m=v,m===10&&(m=13),32<=m||m===13?m:0}function cf(){return!0}function Uu(){return!1}function bs(m){function v(C,k,G,ee,_e){this._reactName=C,this._targetInst=G,this.type=k,this.nativeEvent=ee,this.target=_e,this.currentTarget=null;for(var Re in m)m.hasOwnProperty(Re)&&(C=m[Re],this[Re]=C?C(ee):ee[Re]);return this.isDefaultPrevented=(ee.defaultPrevented!=null?ee.defaultPrevented:ee.returnValue===!1)?cf:Uu,this.isPropagationStopped=Uu,this}return E(v.prototype,{preventDefault:function(){this.defaultPrevented=!0;var C=this.nativeEvent;C&&(C.preventDefault?C.preventDefault():typeof C.returnValue!="unknown"&&(C.returnValue=!1),this.isDefaultPrevented=cf)},stopPropagation:function(){var C=this.nativeEvent;C&&(C.stopPropagation?C.stopPropagation():typeof C.cancelBubble!="unknown"&&(C.cancelBubble=!0),this.isPropagationStopped=cf)},persist:function(){},isPersistent:cf}),v}var wl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(m){return m.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zd=bs(wl),Xd=E({},wl,{view:0,detail:0}),ko=bs(Xd),Mc,gp,Kd,Yd=E({},Xd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kn,button:0,buttons:0,relatedTarget:function(m){return m.relatedTarget===void 0?m.fromElement===m.srcElement?m.toElement:m.fromElement:m.relatedTarget},movementX:function(m){return"movementX"in m?m.movementX:(m!==Kd&&(Kd&&m.type==="mousemove"?(Mc=m.screenX-Kd.screenX,gp=m.screenY-Kd.screenY):gp=Mc=0,Kd=m),Mc)},movementY:function(m){return"movementY"in m?m.movementY:gp}}),$u=bs(Yd),Ro=E({},Yd,{dataTransfer:0}),bx=bs(Ro),Wm=E({},Xd,{relatedTarget:0}),Qd=bs(Wm),Kr=E({},wl,{animationName:0,elapsedTime:0,pseudoElement:0}),Ry=bs(Kr),Vn=E({},wl,{clipboardData:function(m){return"clipboardData"in m?m.clipboardData:window.clipboardData}}),zy=bs(Vn),Zm=E({},wl,{data:0}),xp=bs(Zm),yp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qu(m){var v=this.nativeEvent;return v.getModifierState?v.getModifierState(m):(m=Jd[m])?!!v[m]:!1}function kn(){return qu}var vi=E({},Xd,{key:function(m){if(m.key){var v=yp[m.key]||m.key;if(v!=="Unidentified")return v}return m.type==="keypress"?(m=mp(m),m===13?"Enter":String.fromCharCode(m)):m.type==="keydown"||m.type==="keyup"?Sl[m.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kn,charCode:function(m){return m.type==="keypress"?mp(m):0},keyCode:function(m){return m.type==="keydown"||m.type==="keyup"?m.keyCode:0},which:function(m){return m.type==="keypress"?mp(m):m.type==="keydown"||m.type==="keyup"?m.keyCode:0}}),ai=bs(vi),go=E({},Yd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tu=bs(go),ii=E({},Xd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kn}),eh=bs(ii),vp=E({},wl,{propertyName:0,elapsedTime:0,pseudoElement:0}),_p=bs(vp),Qs=E({},Yd,{deltaX:function(m){return"deltaX"in m?m.deltaX:"wheelDeltaX"in m?-m.wheelDeltaX:0},deltaY:function(m){return"deltaY"in m?m.deltaY:"wheelDeltaY"in m?-m.wheelDeltaY:"wheelDelta"in m?-m.wheelDelta:0},deltaZ:0,deltaMode:0}),ka=bs(Qs),B_=E({},wl,{newState:0,oldState:0}),bp=bs(B_),wx=[9,13,27,32],Hu=Io&&"CompositionEvent"in window,Tl=null;Io&&"documentMode"in document&&(Tl=document.documentMode);var Xm=Io&&"TextEvent"in window&&!Tl,Rs=Io&&(!Hu||Tl&&8<Tl&&11>=Tl),El=" ",Js=!1;function Sx(m,v){switch(m){case"keyup":return wx.indexOf(v.keyCode)!==-1;case"keydown":return v.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function th(m){return m=m.detail,typeof m=="object"&&"data"in m?m.data:null}var pa=!1;function eo(m,v){switch(m){case"compositionend":return th(v);case"keypress":return v.which!==32?null:(Js=!0,El);case"textInput":return m=v.data,m===El&&Js?null:m;default:return null}}function pr(m,v){if(pa)return m==="compositionend"||!Hu&&Sx(m,v)?(m=Wd(),ec=eu=Jc=null,pa=!1,m):null;switch(m){case"paste":return null;case"keypress":if(!(v.ctrlKey||v.altKey||v.metaKey)||v.ctrlKey&&v.altKey){if(v.char&&1<v.char.length)return v.char;if(v.which)return String.fromCharCode(v.which)}return null;case"compositionend":return Rs&&v.locale!=="ko"?null:v.data;default:return null}}var _n={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function uf(m){var v=m&&m.nodeName&&m.nodeName.toLowerCase();return v==="input"?!!_n[m.type]:v==="textarea"}function Kn(m,v,C,k){Qc?Jl?Jl.push(k):Jl=[k]:Qc=k,v=iv(v,"onChange"),0<v.length&&(C=new Zd("onChange","change",null,C,k),m.push({event:C,listeners:v}))}var tc=null,Pc=null;function Jn(m){d2(m,0)}function wp(m){var v=nn(m);if(af(v))return m}function Al(m,v){if(m==="change")return v}var Tx=!1;if(Io){var df;if(Io){var ds="oninput"in document;if(!ds){var zs=document.createElement("div");zs.setAttribute("oninput","return;"),ds=typeof zs.oninput=="function"}df=ds}else df=!1;Tx=df&&(!document.documentMode||9<document.documentMode)}function nh(){tc&&(tc.detachEvent("onpropertychange",nu),Pc=tc=null)}function nu(m){if(m.propertyName==="value"&&wp(Pc)){var v=[];Kn(v,Pc,m,of(m)),fp(Jn,v)}}function rh(m,v,C){m==="focusin"?(nh(),tc=v,Pc=C,tc.attachEvent("onpropertychange",nu)):m==="focusout"&&nh()}function ih(m){if(m==="selectionchange"||m==="keyup"||m==="keydown")return wp(Pc)}function to(m,v){if(m==="click")return wp(v)}function Sp(m,v){if(m==="input"||m==="change")return wp(v)}function Tp(m,v){return m===v&&(m!==0||1/m===1/v)||m!==m&&v!==v}var nl=typeof Object.is=="function"?Object.is:Tp;function rl(m,v){if(nl(m,v))return!0;if(typeof m!="object"||m===null||typeof v!="object"||v===null)return!1;var C=Object.keys(m),k=Object.keys(v);if(C.length!==k.length)return!1;for(k=0;k<C.length;k++){var G=C[k];if(!dn.call(v,G)||!nl(m[G],v[G]))return!1}return!0}function Km(m){for(;m&&m.firstChild;)m=m.firstChild;return m}function nc(m,v){var C=Km(m);m=0;for(var k;C;){if(C.nodeType===3){if(k=m+C.textContent.length,m<=v&&k>=v)return{node:C,offset:v-m};m=k}e:{for(;C;){if(C.nextSibling){C=C.nextSibling;break e}C=C.parentNode}C=void 0}C=Km(C)}}function Ym(m,v){return m&&v?m===v?!0:m&&m.nodeType===3?!1:v&&v.nodeType===3?Ym(m,v.parentNode):"contains"in m?m.contains(v):m.compareDocumentPosition?!!(m.compareDocumentPosition(v)&16):!1:!1}function ru(m){m=m!=null&&m.ownerDocument!=null&&m.ownerDocument.defaultView!=null?m.ownerDocument.defaultView:window;for(var v=Cc(m.document);v instanceof m.HTMLIFrameElement;){try{var C=typeof v.contentWindow.location.href=="string"}catch{C=!1}if(C)m=v.contentWindow;else break;v=Cc(m.document)}return v}function Ex(m){var v=m&&m.nodeName&&m.nodeName.toLowerCase();return v&&(v==="input"&&(m.type==="text"||m.type==="search"||m.type==="tel"||m.type==="url"||m.type==="password")||v==="textarea"||m.contentEditable==="true")}var V_=Io&&"documentMode"in document&&11>=document.documentMode,ah=null,Qm=null,Ep=null,hf=!1;function Ax(m,v,C){var k=C.window===C?C.document:C.nodeType===9?C:C.ownerDocument;hf||ah==null||ah!==Cc(k)||(k=ah,"selectionStart"in k&&Ex(k)?k={start:k.selectionStart,end:k.selectionEnd}:(k=(k.ownerDocument&&k.ownerDocument.defaultView||window).getSelection(),k={anchorNode:k.anchorNode,anchorOffset:k.anchorOffset,focusNode:k.focusNode,focusOffset:k.focusOffset}),Ep&&rl(Ep,k)||(Ep=k,k=iv(Qm,"onSelect"),0<k.length&&(v=new Zd("onSelect","select",null,v,C),m.push({event:v,listeners:k}),v.target=ah)))}function zo(m,v){var C={};return C[m.toLowerCase()]=v.toLowerCase(),C["Webkit"+m]="webkit"+v,C["Moz"+m]="moz"+v,C}var sh={animationend:zo("Animation","AnimationEnd"),animationiteration:zo("Animation","AnimationIteration"),animationstart:zo("Animation","AnimationStart"),transitionrun:zo("Transition","TransitionRun"),transitionstart:zo("Transition","TransitionStart"),transitioncancel:zo("Transition","TransitionCancel"),transitionend:zo("Transition","TransitionEnd")},Jm={},Nc={};Io&&(Nc=document.createElement("div").style,"AnimationEvent"in window||(delete sh.animationend.animation,delete sh.animationiteration.animation,delete sh.animationstart.animation),"TransitionEvent"in window||delete sh.transitionend.transition);function rc(m){if(Jm[m])return Jm[m];if(!sh[m])return m;var v=sh[m],C;for(C in v)if(v.hasOwnProperty(C)&&C in Nc)return Jm[m]=v[C];return m}var eg=rc("animationend"),il=rc("animationiteration"),oh=rc("animationstart"),ff=rc("transitionrun"),Cx=rc("transitionstart"),tg=rc("transitioncancel"),Lo=rc("transitionend"),Ap=new Map,en="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");en.push("scrollEnd");function al(m,v){Ap.set(m,v),Qr(v,[m])}var Cp=new WeakMap;function xo(m,v){if(typeof m=="object"&&m!==null){var C=Cp.get(m);return C!==void 0?C:(v={value:m,source:v,stack:No(v)},Cp.set(m,v),v)}return{value:m,source:v,stack:No(v)}}var Fo=[],Cl=0,Bo=0;function iu(){for(var m=Cl,v=Bo=Cl=0;v<m;){var C=Fo[v];Fo[v++]=null;var k=Fo[v];Fo[v++]=null;var G=Fo[v];Fo[v++]=null;var ee=Fo[v];if(Fo[v++]=null,k!==null&&G!==null){var _e=k.pending;_e===null?G.next=G:(G.next=_e.next,_e.next=G),k.pending=G}ee!==0&&ch(C,G,ee)}}function ic(m,v,C,k){Fo[Cl++]=m,Fo[Cl++]=v,Fo[Cl++]=C,Fo[Cl++]=k,Bo|=k,m.lanes|=k,m=m.alternate,m!==null&&(m.lanes|=k)}function lh(m,v,C,k){return ic(m,v,C,k),jr(m)}function jl(m,v){return ic(m,null,null,v),jr(m)}function ch(m,v,C){m.lanes|=C;var k=m.alternate;k!==null&&(k.lanes|=C);for(var G=!1,ee=m.return;ee!==null;)ee.childLanes|=C,k=ee.alternate,k!==null&&(k.childLanes|=C),ee.tag===22&&(m=ee.stateNode,m===null||m._visibility&1||(G=!0)),m=ee,ee=ee.return;return m.tag===3?(ee=m.stateNode,G&&v!==null&&(G=31-pi(C),m=ee.hiddenUpdates,k=m[G],k===null?m[G]=[v]:k.push(v),v.lane=C|536870912),ee):null}function jr(m){if(50<Wo)throw Wo=0,ul=null,Error(r(185));for(var v=m.return;v!==null;)m=v,v=m.return;return m.tag===3?m.stateNode:null}var Gu={};function U_(m,v,C,k){this.tag=m,this.key=C,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=v,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=k,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vo(m,v,C,k){return new U_(m,v,C,k)}function jp(m){return m=m.prototype,!(!m||!m.isReactComponent)}function ac(m,v){var C=m.alternate;return C===null?(C=Vo(m.tag,v,m.key,m.mode),C.elementType=m.elementType,C.type=m.type,C.stateNode=m.stateNode,C.alternate=m,m.alternate=C):(C.pendingProps=v,C.type=m.type,C.flags=0,C.subtreeFlags=0,C.deletions=null),C.flags=m.flags&65011712,C.childLanes=m.childLanes,C.lanes=m.lanes,C.child=m.child,C.memoizedProps=m.memoizedProps,C.memoizedState=m.memoizedState,C.updateQueue=m.updateQueue,v=m.dependencies,C.dependencies=v===null?null:{lanes:v.lanes,firstContext:v.firstContext},C.sibling=m.sibling,C.index=m.index,C.ref=m.ref,C.refCleanup=m.refCleanup,C}function Ki(m,v){m.flags&=65011714;var C=m.alternate;return C===null?(m.childLanes=0,m.lanes=v,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=C.childLanes,m.lanes=C.lanes,m.child=C.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=C.memoizedProps,m.memoizedState=C.memoizedState,m.updateQueue=C.updateQueue,m.type=C.type,v=C.dependencies,m.dependencies=v===null?null:{lanes:v.lanes,firstContext:v.firstContext}),m}function ng(m,v,C,k,G,ee){var _e=0;if(k=m,typeof m=="function")jp(m)&&(_e=1);else if(typeof m=="string")_e=lA(m,C,In.current)?26:m==="html"||m==="head"||m==="body"?27:5;else e:switch(m){case qe:return m=Vo(31,C,v,G),m.elementType=qe,m.lanes=ee,m;case F:return uh(C.children,G,ee,v);case W:_e=8,G|=24;break;case $:return m=Vo(12,C,v,G|2),m.elementType=$,m.lanes=ee,m;case ae:return m=Vo(13,C,v,G),m.elementType=ae,m.lanes=ee,m;case se:return m=Vo(19,C,v,G),m.elementType=se,m.lanes=ee,m;default:if(typeof m=="object"&&m!==null)switch(m.$$typeof){case Z:case ie:_e=10;break e;case ne:_e=9;break e;case ge:_e=11;break e;case me:_e=14;break e;case ke:_e=16,k=null;break e}_e=29,C=Error(r(130,m===null?"null":typeof m,"")),k=null}return v=Vo(_e,C,v,G),v.elementType=m,v.type=k,v.lanes=ee,v}function uh(m,v,C,k){return m=Vo(7,m,k,v),m.lanes=C,m}function jx(m,v,C){return m=Vo(6,m,null,v),m.lanes=C,m}function rg(m,v,C){return v=Vo(4,m.children!==null?m.children:[],m.key,v),v.lanes=C,v.stateNode={containerInfo:m.containerInfo,pendingChildren:null,implementation:m.implementation},v}var pf=[],au=0,ig=null,Mp=0,Uo=[],yo=0,su=null,vo=1,sc="";function Wu(m,v){pf[au++]=Mp,pf[au++]=ig,ig=m,Mp=v}function dh(m,v,C){Uo[yo++]=vo,Uo[yo++]=sc,Uo[yo++]=su,su=m;var k=vo;m=sc;var G=32-pi(k)-1;k&=~(1<<G),C+=1;var ee=32-pi(v)+G;if(30<ee){var _e=G-G%5;ee=(k&(1<<_e)-1).toString(32),k>>=_e,G-=_e,vo=1<<32-pi(v)+G|C<<G|k,sc=ee+m}else vo=1<<ee|C<<G|k,sc=m}function hh(m){m.return!==null&&(Wu(m,1),dh(m,1,0))}function mf(m){for(;m===ig;)ig=pf[--au],pf[au]=null,Mp=pf[--au],pf[au]=null;for(;m===su;)su=Uo[--yo],Uo[yo]=null,sc=Uo[--yo],Uo[yo]=null,vo=Uo[--yo],Uo[yo]=null}var ws=null,ma=null,Hi=!1,ou=null,oc=!1,Pp=Error(r(519));function Dc(m){var v=Error(r(418,""));throw vf(xo(v,m)),Pp}function gf(m){var v=m.stateNode,C=m.type,k=m.memoizedProps;switch(v[ye]=m,v[Me]=k,C){case"dialog":Vi("cancel",v),Vi("close",v);break;case"iframe":case"object":case"embed":Vi("load",v);break;case"video":case"audio":for(C=0;C<h0.length;C++)Vi(h0[C],v);break;case"source":Vi("error",v);break;case"img":case"image":case"link":Vi("error",v),Vi("load",v);break;case"details":Vi("toggle",v);break;case"input":Vi("invalid",v),Hm(v,k.value,k.defaultValue,k.checked,k.defaultChecked,k.type,k.name,!0),Gd(v);break;case"select":Vi("invalid",v);break;case"textarea":Vi("invalid",v),_l(v,k.value,k.defaultValue,k.children),Gd(v)}C=k.children,typeof C!="string"&&typeof C!="number"&&typeof C!="bigint"||v.textContent===""+C||k.suppressHydrationWarning===!0||Tg(v.textContent,C)?(k.popover!=null&&(Vi("beforetoggle",v),Vi("toggle",v)),k.onScroll!=null&&Vi("scroll",v),k.onScrollEnd!=null&&Vi("scrollend",v),k.onClick!=null&&(v.onclick=m0),v=!0):v=!1,v||Dc(m)}function Mx(m){for(ws=m.return;ws;)switch(ws.tag){case 5:case 13:oc=!1;return;case 27:case 3:oc=!0;return;default:ws=ws.return}}function xf(m){if(m!==ws)return!1;if(!Hi)return Mx(m),Hi=!0,!1;var v=m.tag,C;if((C=v!==3&&v!==27)&&((C=v===5)&&(C=m.type,C=!(C!=="form"&&C!=="button")||uv(m.type,m.memoizedProps)),C=!C),C&&ma&&Dc(m),Mx(m),v===13){if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(r(317));e:{for(m=m.nextSibling,v=0;m;){if(m.nodeType===8)if(C=m.data,C==="/$"){if(v===0){ma=Tu(m.nextSibling);break e}v--}else C!=="$"&&C!=="$!"&&C!=="$?"||v++;m=m.nextSibling}ma=null}}else v===27?(v=ma,Rh(m.type)?(m=i1,i1=null,ma=m):ma=v):ma=ws?Tu(m.stateNode.nextSibling):null;return!0}function yf(){ma=ws=null,Hi=!1}function fh(){var m=ou;return m!==null&&(qr===null?qr=m:qr.push.apply(qr,m),ou=null),m}function vf(m){ou===null?ou=[m]:ou.push(m)}var Px=ot(null),lu=null,cu=null;function lc(m,v,C){It(Px,v._currentValue),v._currentValue=C}function cc(m){m._currentValue=Px.current,mt(Px)}function Np(m,v,C){for(;m!==null;){var k=m.alternate;if((m.childLanes&v)!==v?(m.childLanes|=v,k!==null&&(k.childLanes|=v)):k!==null&&(k.childLanes&v)!==v&&(k.childLanes|=v),m===C)break;m=m.return}}function Dp(m,v,C,k){var G=m.child;for(G!==null&&(G.return=m);G!==null;){var ee=G.dependencies;if(ee!==null){var _e=G.child;ee=ee.firstContext;e:for(;ee!==null;){var Re=ee;ee=G;for(var at=0;at<v.length;at++)if(Re.context===v[at]){ee.lanes|=C,Re=ee.alternate,Re!==null&&(Re.lanes|=C),Np(ee.return,C,m),k||(_e=null);break e}ee=Re.next}}else if(G.tag===18){if(_e=G.return,_e===null)throw Error(r(341));_e.lanes|=C,ee=_e.alternate,ee!==null&&(ee.lanes|=C),Np(_e,C,m),_e=null}else _e=G.child;if(_e!==null)_e.return=G;else for(_e=G;_e!==null;){if(_e===m){_e=null;break}if(G=_e.sibling,G!==null){G.return=_e.return,_e=G;break}_e=_e.return}G=_e}}function ph(m,v,C,k){m=null;for(var G=v,ee=!1;G!==null;){if(!ee){if((G.flags&524288)!==0)ee=!0;else if((G.flags&262144)!==0)break}if(G.tag===10){var _e=G.alternate;if(_e===null)throw Error(r(387));if(_e=_e.memoizedProps,_e!==null){var Re=G.type;nl(G.pendingProps.value,_e.value)||(m!==null?m.push(Re):m=[Re])}}else if(G===Zn.current){if(_e=G.alternate,_e===null)throw Error(r(387));_e.memoizedState.memoizedState!==G.memoizedState.memoizedState&&(m!==null?m.push(Mg):m=[Mg])}G=G.return}m!==null&&Dp(v,m,C,k),v.flags|=262144}function _f(m){for(m=m.firstContext;m!==null;){if(!nl(m.context._currentValue,m.memoizedValue))return!0;m=m.next}return!1}function Ml(m){lu=m,cu=null,m=m.dependencies,m!==null&&(m.firstContext=null)}function Ya(m){return Nx(lu,m)}function uu(m,v){return lu===null&&Ml(m),Nx(m,v)}function Nx(m,v){var C=v._currentValue;if(v={context:v,memoizedValue:C,next:null},cu===null){if(m===null)throw Error(r(308));cu=v,m.dependencies={lanes:0,firstContext:v},m.flags|=524288}else cu=cu.next=v;return C}var _o=typeof AbortController<"u"?AbortController:function(){var m=[],v=this.signal={aborted:!1,addEventListener:function(C,k){m.push(k)}};this.abort=function(){v.aborted=!0,m.forEach(function(C){return C()})}},Op=e.unstable_scheduleCallback,ag=e.unstable_NormalPriority,$a={$$typeof:ie,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function bf(){return{controller:new _o,data:new Map,refCount:0}}function Zu(m){m.refCount--,m.refCount===0&&Op(ag,function(){m.controller.abort()})}var mh=null,wf=0,Xu=0,du=null;function Ip(m,v){if(mh===null){var C=mh=[];wf=0,Xu=Q_(),du={status:"pending",value:void 0,then:function(k){C.push(k)}}}return wf++,v.then(Sf,Sf),v}function Sf(){if(--wf===0&&mh!==null){du!==null&&(du.status="fulfilled");var m=mh;mh=null,Xu=0,du=null;for(var v=0;v<m.length;v++)(0,m[v])()}}function Ly(m,v){var C=[],k={status:"pending",value:null,reason:null,then:function(G){C.push(G)}};return m.then(function(){k.status="fulfilled",k.value=v;for(var G=0;G<C.length;G++)(0,C[G])(v)},function(G){for(k.status="rejected",k.reason=G,G=0;G<C.length;G++)(0,C[G])(void 0)}),k}var Ku=He.S;He.S=function(m,v){typeof v=="object"&&v!==null&&typeof v.then=="function"&&Ip(m,v),Ku!==null&&Ku(m,v)};var gh=ot(null);function Dx(){var m=gh.current;return m!==null?m:ur.pooledCache}function kp(m,v){v===null?It(gh,gh.current):It(gh,v.pool)}function Ox(){var m=Dx();return m===null?null:{parent:$a._currentValue,pool:m}}var Rp=Error(r(460)),Fy=Error(r(474)),Tf=Error(r(542)),xh={then:function(){}};function Ix(m){return m=m.status,m==="fulfilled"||m==="rejected"}function Oc(){}function kx(m,v,C){switch(C=m[C],C===void 0?m.push(v):C!==v&&(v.then(Oc,Oc),v=C),v.status){case"fulfilled":return v.value;case"rejected":throw m=v.reason,zp(m),m;default:if(typeof v.status=="string")v.then(Oc,Oc);else{if(m=ur,m!==null&&100<m.shellSuspendCounter)throw Error(r(482));m=v,m.status="pending",m.then(function(k){if(v.status==="pending"){var G=v;G.status="fulfilled",G.value=k}},function(k){if(v.status==="pending"){var G=v;G.status="rejected",G.reason=k}})}switch(v.status){case"fulfilled":return v.value;case"rejected":throw m=v.reason,zp(m),m}throw Ef=v,Rp}}var Ef=null;function sg(){if(Ef===null)throw Error(r(459));var m=Ef;return Ef=null,m}function zp(m){if(m===Rp||m===Tf)throw Error(r(483))}var bo=!1;function og(m){m.updateQueue={baseState:m.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function wo(m,v){m=m.updateQueue,v.updateQueue===m&&(v.updateQueue={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,callbacks:null})}function Ic(m){return{lane:m,tag:0,payload:null,callback:null,next:null}}function uc(m,v,C){var k=m.updateQueue;if(k===null)return null;if(k=k.shared,($n&2)!==0){var G=k.pending;return G===null?v.next=v:(v.next=G.next,G.next=v),k.pending=v,v=jr(m),ch(m,null,C),v}return ic(m,k,v,C),jr(m)}function Af(m,v,C){if(v=v.updateQueue,v!==null&&(v=v.shared,(C&4194048)!==0)){var k=v.lanes;k&=m.pendingLanes,C|=k,v.lanes=C,Kt(m,C)}}function Lp(m,v){var C=m.updateQueue,k=m.alternate;if(k!==null&&(k=k.updateQueue,C===k)){var G=null,ee=null;if(C=C.firstBaseUpdate,C!==null){do{var _e={lane:C.lane,tag:C.tag,payload:C.payload,callback:null,next:null};ee===null?G=ee=_e:ee=ee.next=_e,C=C.next}while(C!==null);ee===null?G=ee=v:ee=ee.next=v}else G=ee=v;C={baseState:k.baseState,firstBaseUpdate:G,lastBaseUpdate:ee,shared:k.shared,callbacks:k.callbacks},m.updateQueue=C;return}m=C.lastBaseUpdate,m===null?C.firstBaseUpdate=v:m.next=v,C.lastBaseUpdate=v}var Cf=!1;function Yu(){if(Cf){var m=du;if(m!==null)throw m}}function jf(m,v,C,k){Cf=!1;var G=m.updateQueue;bo=!1;var ee=G.firstBaseUpdate,_e=G.lastBaseUpdate,Re=G.shared.pending;if(Re!==null){G.shared.pending=null;var at=Re,Lt=at.next;at.next=null,_e===null?ee=Lt:_e.next=Lt,_e=at;var hn=m.alternate;hn!==null&&(hn=hn.updateQueue,Re=hn.lastBaseUpdate,Re!==_e&&(Re===null?hn.firstBaseUpdate=Lt:Re.next=Lt,hn.lastBaseUpdate=at))}if(ee!==null){var En=G.baseState;_e=0,hn=Lt=at=null,Re=ee;do{var Ht=Re.lane&-536870913,Wt=Ht!==Re.lane;if(Wt?(Bn&Ht)===Ht:(k&Ht)===Ht){Ht!==0&&Ht===Xu&&(Cf=!0),hn!==null&&(hn=hn.next={lane:0,tag:Re.tag,payload:Re.payload,callback:null,next:null});e:{var ni=m,Gr=Re;Ht=v;var Ea=C;switch(Gr.tag){case 1:if(ni=Gr.payload,typeof ni=="function"){En=ni.call(Ea,En,Ht);break e}En=ni;break e;case 3:ni.flags=ni.flags&-65537|128;case 0:if(ni=Gr.payload,Ht=typeof ni=="function"?ni.call(Ea,En,Ht):ni,Ht==null)break e;En=E({},En,Ht);break e;case 2:bo=!0}}Ht=Re.callback,Ht!==null&&(m.flags|=64,Wt&&(m.flags|=8192),Wt=G.callbacks,Wt===null?G.callbacks=[Ht]:Wt.push(Ht))}else Wt={lane:Ht,tag:Re.tag,payload:Re.payload,callback:Re.callback,next:null},hn===null?(Lt=hn=Wt,at=En):hn=hn.next=Wt,_e|=Ht;if(Re=Re.next,Re===null){if(Re=G.shared.pending,Re===null)break;Wt=Re,Re=Wt.next,Wt.next=null,G.lastBaseUpdate=Wt,G.shared.pending=null}}while(!0);hn===null&&(at=En),G.baseState=at,G.firstBaseUpdate=Lt,G.lastBaseUpdate=hn,ee===null&&(G.shared.lanes=0),Pi|=_e,m.lanes=_e,m.memoizedState=En}}function Fp(m,v){if(typeof m!="function")throw Error(r(191,m));m.call(v)}function Qu(m,v){var C=m.callbacks;if(C!==null)for(m.callbacks=null,m=0;m<C.length;m++)Fp(C[m],v)}var yh=ot(null),lg=ot(0);function kc(m,v){m=Ur,It(lg,m),It(yh,v),Ur=m|v.baseLanes}function Rx(){It(lg,Ur),It(yh,yh.current)}function Bp(){Ur=lg.current,mt(yh),mt(lg)}var dc=0,si=null,Gi=null,ja=null,Ju=!1,Rc=!1,zc=!1,Mf=0,ed=0,td=null,Pf=0;function Ma(){throw Error(r(321))}function mn(m,v){if(v===null)return!1;for(var C=0;C<v.length&&C<m.length;C++)if(!nl(m[C],v[C]))return!1;return!0}function vh(m,v,C,k,G,ee){return dc=ee,si=v,v.memoizedState=null,v.updateQueue=null,v.lanes=0,He.H=m===null||m.memoizedState===null?Ch:gg,zc=!1,ee=C(k,G),zc=!1,Rc&&(ee=hu(v,C,k,G)),nd(m),ee}function nd(m){He.H=Ah;var v=Gi!==null&&Gi.next!==null;if(dc=0,ja=Gi=si=null,Ju=!1,ed=0,td=null,v)throw Error(r(300));m===null||is||(m=m.dependencies,m!==null&&_f(m)&&(is=!0))}function hu(m,v,C,k){si=m;var G=0;do{if(Rc&&(td=null),ed=0,Rc=!1,25<=G)throw Error(r(301));if(G+=1,ja=Gi=null,m.updateQueue!=null){var ee=m.updateQueue;ee.lastEffect=null,ee.events=null,ee.stores=null,ee.memoCache!=null&&(ee.memoCache.index=0)}He.H=Wx,ee=v(C,k)}while(Rc);return ee}function rd(){var m=He.H,v=m.useState()[0];return v=typeof v.then=="function"?Up(v):v,m=m.useState()[0],(Gi!==null?Gi.memoizedState:null)!==m&&(si.flags|=1024),v}function Un(){var m=Mf!==0;return Mf=0,m}function Vp(m,v,C){v.updateQueue=m.updateQueue,v.flags&=-2053,m.lanes&=~C}function zx(m){if(Ju){for(m=m.memoizedState;m!==null;){var v=m.queue;v!==null&&(v.pending=null),m=m.next}Ju=!1}dc=0,ja=Gi=si=null,Rc=!1,ed=Mf=0,td=null}function So(){var m={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ja===null?si.memoizedState=ja=m:ja=ja.next=m,ja}function Ra(){if(Gi===null){var m=si.alternate;m=m!==null?m.memoizedState:null}else m=Gi.next;var v=ja===null?si.memoizedState:ja.next;if(v!==null)ja=v,Gi=m;else{if(m===null)throw si.alternate===null?Error(r(467)):Error(r(310));Gi=m,m={memoizedState:Gi.memoizedState,baseState:Gi.baseState,baseQueue:Gi.baseQueue,queue:Gi.queue,next:null},ja===null?si.memoizedState=ja=m:ja=ja.next=m}return ja}function cg(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Up(m){var v=ed;return ed+=1,td===null&&(td=[]),m=kx(td,m,v),v=si,(ja===null?v.memoizedState:ja.next)===null&&(v=v.alternate,He.H=v===null||v.memoizedState===null?Ch:gg),m}function $p(m){if(m!==null&&typeof m=="object"){if(typeof m.then=="function")return Up(m);if(m.$$typeof===ie)return Ya(m)}throw Error(r(438,String(m)))}function Lx(m){var v=null,C=si.updateQueue;if(C!==null&&(v=C.memoCache),v==null){var k=si.alternate;k!==null&&(k=k.updateQueue,k!==null&&(k=k.memoCache,k!=null&&(v={data:k.data.map(function(G){return G.slice()}),index:0})))}if(v==null&&(v={data:[],index:0}),C===null&&(C=cg(),si.updateQueue=C),C.memoCache=v,C=v.data[v.index],C===void 0)for(C=v.data[v.index]=Array(m),k=0;k<m;k++)C[k]=tt;return v.index++,C}function fu(m,v){return typeof v=="function"?v(m):v}function Nf(m){var v=Ra();return qp(v,Gi,m)}function qp(m,v,C){var k=m.queue;if(k===null)throw Error(r(311));k.lastRenderedReducer=C;var G=m.baseQueue,ee=k.pending;if(ee!==null){if(G!==null){var _e=G.next;G.next=ee.next,ee.next=_e}v.baseQueue=G=ee,k.pending=null}if(ee=m.baseState,G===null)m.memoizedState=ee;else{v=G.next;var Re=_e=null,at=null,Lt=v,hn=!1;do{var En=Lt.lane&-536870913;if(En!==Lt.lane?(Bn&En)===En:(dc&En)===En){var Ht=Lt.revertLane;if(Ht===0)at!==null&&(at=at.next={lane:0,revertLane:0,action:Lt.action,hasEagerState:Lt.hasEagerState,eagerState:Lt.eagerState,next:null}),En===Xu&&(hn=!0);else if((dc&Ht)===Ht){Lt=Lt.next,Ht===Xu&&(hn=!0);continue}else En={lane:0,revertLane:Lt.revertLane,action:Lt.action,hasEagerState:Lt.hasEagerState,eagerState:Lt.eagerState,next:null},at===null?(Re=at=En,_e=ee):at=at.next=En,si.lanes|=Ht,Pi|=Ht;En=Lt.action,zc&&C(ee,En),ee=Lt.hasEagerState?Lt.eagerState:C(ee,En)}else Ht={lane:En,revertLane:Lt.revertLane,action:Lt.action,hasEagerState:Lt.hasEagerState,eagerState:Lt.eagerState,next:null},at===null?(Re=at=Ht,_e=ee):at=at.next=Ht,si.lanes|=En,Pi|=En;Lt=Lt.next}while(Lt!==null&&Lt!==v);if(at===null?_e=ee:at.next=Re,!nl(ee,m.memoizedState)&&(is=!0,hn&&(C=du,C!==null)))throw C;m.memoizedState=ee,m.baseState=_e,m.baseQueue=at,k.lastRenderedState=ee}return G===null&&(k.lanes=0),[m.memoizedState,k.dispatch]}function Hp(m){var v=Ra(),C=v.queue;if(C===null)throw Error(r(311));C.lastRenderedReducer=m;var k=C.dispatch,G=C.pending,ee=v.memoizedState;if(G!==null){C.pending=null;var _e=G=G.next;do ee=m(ee,_e.action),_e=_e.next;while(_e!==G);nl(ee,v.memoizedState)||(is=!0),v.memoizedState=ee,v.baseQueue===null&&(v.baseState=ee),C.lastRenderedState=ee}return[ee,k]}function ug(m,v,C){var k=si,G=Ra(),ee=Hi;if(ee){if(C===void 0)throw Error(r(407));C=C()}else C=v();var _e=!nl((Gi||G).memoizedState,C);_e&&(G.memoizedState=C,is=!0),G=G.queue;var Re=id.bind(null,k,G,m);if(od(2048,8,Re,[m]),G.getSnapshot!==v||_e||ja!==null&&ja.memoizedState.tag&1){if(k.flags|=2048,Nl(9,Yi(),pu.bind(null,k,G,C,v),null),ur===null)throw Error(r(349));ee||(dc&124)!==0||To(k,v,C)}return C}function To(m,v,C){m.flags|=16384,m={getSnapshot:v,value:C},v=si.updateQueue,v===null?(v=cg(),si.updateQueue=v,v.stores=[m]):(C=v.stores,C===null?v.stores=[m]:C.push(m))}function pu(m,v,C,k){v.value=C,v.getSnapshot=k,Gp(v)&&Wp(m)}function id(m,v,C){return C(function(){Gp(v)&&Wp(m)})}function Gp(m){var v=m.getSnapshot;m=m.value;try{var C=v();return!nl(m,C)}catch{return!0}}function Wp(m){var v=jl(m,2);v!==null&&so(v,m,2)}function ad(m){var v=So();if(typeof m=="function"){var C=m;if(m=C(),zc){Yr(!0);try{C()}finally{Yr(!1)}}}return v.memoizedState=v.baseState=m,v.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fu,lastRenderedState:m},v}function Fx(m,v,C,k){return m.baseState=C,qp(m,Gi,typeof k=="function"?k:fu)}function Pl(m,v,C,k,G){if(Th(m))throw Error(r(485));if(m=v.action,m!==null){var ee={payload:G,action:m,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(_e){ee.listeners.push(_e)}};He.T!==null?C(!0):ee.isTransition=!1,k(ee),C=v.pending,C===null?(ee.next=v.pending=ee,ui(v,ee)):(ee.next=C.next,v.pending=C.next=ee)}}function ui(m,v){var C=v.action,k=v.payload,G=m.state;if(v.isTransition){var ee=He.T,_e={};He.T=_e;try{var Re=C(G,k),at=He.S;at!==null&&at(_e,Re),Df(m,v,Re)}catch(Lt){dg(m,v,Lt)}finally{He.T=ee}}else try{ee=C(G,k),Df(m,v,ee)}catch(Lt){dg(m,v,Lt)}}function Df(m,v,C){C!==null&&typeof C=="object"&&typeof C.then=="function"?C.then(function(k){mu(m,v,k)},function(k){return dg(m,v,k)}):mu(m,v,C)}function mu(m,v,C){v.status="fulfilled",v.value=C,Bx(v),m.state=C,v=m.pending,v!==null&&(C=v.next,C===v?m.pending=null:(C=C.next,v.next=C,ui(m,C)))}function dg(m,v,C){var k=m.pending;if(m.pending=null,k!==null){k=k.next;do v.status="rejected",v.reason=C,Bx(v),v=v.next;while(v!==k)}m.action=null}function Bx(m){m=m.listeners;for(var v=0;v<m.length;v++)(0,m[v])()}function Vx(m,v){return v}function By(m,v){if(Hi){var C=ur.formState;if(C!==null){e:{var k=si;if(Hi){if(ma){t:{for(var G=ma,ee=oc;G.nodeType!==8;){if(!ee){G=null;break t}if(G=Tu(G.nextSibling),G===null){G=null;break t}}ee=G.data,G=ee==="F!"||ee==="F"?G:null}if(G){ma=Tu(G.nextSibling),k=G.data==="F!";break e}}Dc(k)}k=!1}k&&(v=C[0])}}return C=So(),C.memoizedState=C.baseState=v,k={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vx,lastRenderedState:v},C.queue=k,C=Vr.bind(null,si,k),k.dispatch=C,k=ad(!1),ee=hc.bind(null,si,!1,k.queue),k=So(),G={state:v,dispatch:null,action:m,pending:null},k.queue=G,C=Pl.bind(null,si,G,ee,C),G.dispatch=C,k.memoizedState=m,[v,C,!1]}function _h(m){var v=Ra();return sd(v,Gi,m)}function sd(m,v,C){if(v=qp(m,v,Vx)[0],m=Nf(fu)[0],typeof v=="object"&&v!==null&&typeof v.then=="function")try{var k=Up(v)}catch(_e){throw _e===Rp?Tf:_e}else k=v;v=Ra();var G=v.queue,ee=G.dispatch;return C!==v.memoizedState&&(si.flags|=2048,Nl(9,Yi(),Xt.bind(null,G,C),null)),[k,ee,m]}function Xt(m,v){m.action=v}function fn(m){var v=Ra(),C=Gi;if(C!==null)return sd(v,C,m);Ra(),v=v.memoizedState,C=Ra();var k=C.queue.dispatch;return C.memoizedState=m,[v,k,!1]}function Nl(m,v,C,k){return m={tag:m,create:C,deps:k,inst:v,next:null},v=si.updateQueue,v===null&&(v=cg(),si.updateQueue=v),C=v.lastEffect,C===null?v.lastEffect=m.next=m:(k=C.next,C.next=m,m.next=k,v.lastEffect=m),m}function Yi(){return{destroy:void 0,resource:void 0}}function rt(){return Ra().memoizedState}function $o(m,v,C,k){var G=So();k=k===void 0?null:k,si.flags|=m,G.memoizedState=Nl(1|v,Yi(),C,k)}function od(m,v,C,k){var G=Ra();k=k===void 0?null:k;var ee=G.memoizedState.inst;Gi!==null&&k!==null&&mn(k,Gi.memoizedState.deps)?G.memoizedState=Nl(v,ee,C,k):(si.flags|=m,G.memoizedState=Nl(1|v,ee,C,k))}function Zp(m,v){$o(8390656,8,m,v)}function hg(m,v){od(2048,8,m,v)}function Ux(m,v){return od(4,2,m,v)}function $x(m,v){return od(4,4,m,v)}function bh(m,v){if(typeof v=="function"){m=m();var C=v(m);return function(){typeof C=="function"?C():v(null)}}if(v!=null)return m=m(),v.current=m,function(){v.current=null}}function Vy(m,v,C){C=C!=null?C.concat([m]):null,od(4,4,bh.bind(null,v,m),C)}function qx(){}function Hx(m,v){var C=Ra();v=v===void 0?null:v;var k=C.memoizedState;return v!==null&&mn(v,k[1])?k[0]:(C.memoizedState=[m,v],m)}function Xp(m,v){var C=Ra();v=v===void 0?null:v;var k=C.memoizedState;if(v!==null&&mn(v,k[1]))return k[0];if(k=m(),zc){Yr(!0);try{m()}finally{Yr(!1)}}return C.memoizedState=[k,v],k}function Kp(m,v,C){return C===void 0||(dc&1073741824)!==0?m.memoizedState=v:(m.memoizedState=C,m=xd(),si.lanes|=m,Pi|=m,C)}function fg(m,v,C,k){return nl(C,v)?C:yh.current!==null?(m=Kp(m,C,k),nl(m,v)||(is=!0),m):(dc&42)===0?(is=!0,m.memoizedState=C):(m=xd(),si.lanes|=m,Pi|=m,v)}function Gx(m,v,C,k,G){var ee=ut.p;ut.p=ee!==0&&8>ee?ee:8;var _e=He.T,Re={};He.T=Re,hc(m,!1,v,C);try{var at=G(),Lt=He.S;if(Lt!==null&&Lt(Re,at),at!==null&&typeof at=="object"&&typeof at.then=="function"){var hn=Ly(at,k);Sh(m,v,hn,Es(m))}else Sh(m,v,k,Es(m))}catch(En){Sh(m,v,{then:function(){},status:"rejected",reason:En},Es())}finally{ut.p=ee,He.T=_e}}function pg(){}function wh(m,v,C,k){if(m.tag!==5)throw Error(r(476));var G=ld(m).queue;Gx(m,G,v,Tt,C===null?pg:function(){return mg(m),C(k)})}function ld(m){var v=m.memoizedState;if(v!==null)return v;v={memoizedState:Tt,baseState:Tt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fu,lastRenderedState:Tt},next:null};var C={};return v.next={memoizedState:C,baseState:C,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fu,lastRenderedState:C},next:null},m.memoizedState=v,m=m.alternate,m!==null&&(m.memoizedState=v),v}function mg(m){var v=ld(m).next.queue;Sh(m,v,{},Es())}function Lc(){return Ya(Mg)}function Ls(){return Ra().memoizedState}function Uy(){return Ra().memoizedState}function Yp(m){for(var v=m.return;v!==null;){switch(v.tag){case 24:case 3:var C=Es();m=Ic(C);var k=uc(v,m,C);k!==null&&(so(k,v,C),Af(k,v,C)),v={cache:bf()},m.payload=v;return}v=v.return}}function Bi(m,v,C){var k=Es();C={lane:k,revertLane:0,action:C,hasEagerState:!1,eagerState:null,next:null},Th(m)?cd(v,C):(C=lh(m,v,C,k),C!==null&&(so(C,m,k),Eh(C,v,k)))}function Vr(m,v,C){var k=Es();Sh(m,v,C,k)}function Sh(m,v,C,k){var G={lane:k,revertLane:0,action:C,hasEagerState:!1,eagerState:null,next:null};if(Th(m))cd(v,G);else{var ee=m.alternate;if(m.lanes===0&&(ee===null||ee.lanes===0)&&(ee=v.lastRenderedReducer,ee!==null))try{var _e=v.lastRenderedState,Re=ee(_e,C);if(G.hasEagerState=!0,G.eagerState=Re,nl(Re,_e))return ic(m,v,G,0),ur===null&&iu(),!1}catch{}finally{}if(C=lh(m,v,G,k),C!==null)return so(C,m,k),Eh(C,v,k),!0}return!1}function hc(m,v,C,k){if(k={lane:2,revertLane:Q_(),action:k,hasEagerState:!1,eagerState:null,next:null},Th(m)){if(v)throw Error(r(479))}else v=lh(m,C,k,2),v!==null&&so(v,m,2)}function Th(m){var v=m.alternate;return m===si||v!==null&&v===si}function cd(m,v){Rc=Ju=!0;var C=m.pending;C===null?v.next=v:(v.next=C.next,C.next=v),m.pending=v}function Eh(m,v,C){if((C&4194048)!==0){var k=v.lanes;k&=m.pendingLanes,C|=k,v.lanes=C,Kt(m,C)}}var Ah={readContext:Ya,use:$p,useCallback:Ma,useContext:Ma,useEffect:Ma,useImperativeHandle:Ma,useLayoutEffect:Ma,useInsertionEffect:Ma,useMemo:Ma,useReducer:Ma,useRef:Ma,useState:Ma,useDebugValue:Ma,useDeferredValue:Ma,useTransition:Ma,useSyncExternalStore:Ma,useId:Ma,useHostTransitionStatus:Ma,useFormState:Ma,useActionState:Ma,useOptimistic:Ma,useMemoCache:Ma,useCacheRefresh:Ma},Ch={readContext:Ya,use:$p,useCallback:function(m,v){return So().memoizedState=[m,v===void 0?null:v],m},useContext:Ya,useEffect:Zp,useImperativeHandle:function(m,v,C){C=C!=null?C.concat([m]):null,$o(4194308,4,bh.bind(null,v,m),C)},useLayoutEffect:function(m,v){return $o(4194308,4,m,v)},useInsertionEffect:function(m,v){$o(4,2,m,v)},useMemo:function(m,v){var C=So();v=v===void 0?null:v;var k=m();if(zc){Yr(!0);try{m()}finally{Yr(!1)}}return C.memoizedState=[k,v],k},useReducer:function(m,v,C){var k=So();if(C!==void 0){var G=C(v);if(zc){Yr(!0);try{C(v)}finally{Yr(!1)}}}else G=v;return k.memoizedState=k.baseState=G,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:G},k.queue=m,m=m.dispatch=Bi.bind(null,si,m),[k.memoizedState,m]},useRef:function(m){var v=So();return m={current:m},v.memoizedState=m},useState:function(m){m=ad(m);var v=m.queue,C=Vr.bind(null,si,v);return v.dispatch=C,[m.memoizedState,C]},useDebugValue:qx,useDeferredValue:function(m,v){var C=So();return Kp(C,m,v)},useTransition:function(){var m=ad(!1);return m=Gx.bind(null,si,m.queue,!0,!1),So().memoizedState=m,[!1,m]},useSyncExternalStore:function(m,v,C){var k=si,G=So();if(Hi){if(C===void 0)throw Error(r(407));C=C()}else{if(C=v(),ur===null)throw Error(r(349));(Bn&124)!==0||To(k,v,C)}G.memoizedState=C;var ee={value:C,getSnapshot:v};return G.queue=ee,Zp(id.bind(null,k,ee,m),[m]),k.flags|=2048,Nl(9,Yi(),pu.bind(null,k,ee,C,v),null),C},useId:function(){var m=So(),v=ur.identifierPrefix;if(Hi){var C=sc,k=vo;C=(k&~(1<<32-pi(k)-1)).toString(32)+C,v="«"+v+"R"+C,C=Mf++,0<C&&(v+="H"+C.toString(32)),v+="»"}else C=Pf++,v="«"+v+"r"+C.toString(32)+"»";return m.memoizedState=v},useHostTransitionStatus:Lc,useFormState:By,useActionState:By,useOptimistic:function(m){var v=So();v.memoizedState=v.baseState=m;var C={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return v.queue=C,v=hc.bind(null,si,!0,C),C.dispatch=v,[m,v]},useMemoCache:Lx,useCacheRefresh:function(){return So().memoizedState=Yp.bind(null,si)}},gg={readContext:Ya,use:$p,useCallback:Hx,useContext:Ya,useEffect:hg,useImperativeHandle:Vy,useInsertionEffect:Ux,useLayoutEffect:$x,useMemo:Xp,useReducer:Nf,useRef:rt,useState:function(){return Nf(fu)},useDebugValue:qx,useDeferredValue:function(m,v){var C=Ra();return fg(C,Gi.memoizedState,m,v)},useTransition:function(){var m=Nf(fu)[0],v=Ra().memoizedState;return[typeof m=="boolean"?m:Up(m),v]},useSyncExternalStore:ug,useId:Ls,useHostTransitionStatus:Lc,useFormState:_h,useActionState:_h,useOptimistic:function(m,v){var C=Ra();return Fx(C,Gi,m,v)},useMemoCache:Lx,useCacheRefresh:Uy},Wx={readContext:Ya,use:$p,useCallback:Hx,useContext:Ya,useEffect:hg,useImperativeHandle:Vy,useInsertionEffect:Ux,useLayoutEffect:$x,useMemo:Xp,useReducer:Hp,useRef:rt,useState:function(){return Hp(fu)},useDebugValue:qx,useDeferredValue:function(m,v){var C=Ra();return Gi===null?Kp(C,m,v):fg(C,Gi.memoizedState,m,v)},useTransition:function(){var m=Hp(fu)[0],v=Ra().memoizedState;return[typeof m=="boolean"?m:Up(m),v]},useSyncExternalStore:ug,useId:Ls,useHostTransitionStatus:Lc,useFormState:fn,useActionState:fn,useOptimistic:function(m,v){var C=Ra();return Gi!==null?Fx(C,Gi,m,v):(C.baseState=m,[m,C.queue.dispatch])},useMemoCache:Lx,useCacheRefresh:Uy},Eo=null,sl=0;function jh(m){var v=sl;return sl+=1,Eo===null&&(Eo=[]),kx(Eo,m,v)}function fc(m,v){v=v.props.ref,m.ref=v!==void 0?v:null}function gu(m,v){throw v.$$typeof===P?Error(r(525)):(m=Object.prototype.toString.call(v),Error(r(31,m==="[object Object]"?"object with keys {"+Object.keys(v).join(", ")+"}":m)))}function no(m){var v=m._init;return v(m._payload)}function pc(m){function v(At,gt){if(m){var Rt=At.deletions;Rt===null?(At.deletions=[gt],At.flags|=16):Rt.push(gt)}}function C(At,gt){if(!m)return null;for(;gt!==null;)v(At,gt),gt=gt.sibling;return null}function k(At){for(var gt=new Map;At!==null;)At.key!==null?gt.set(At.key,At):gt.set(At.index,At),At=At.sibling;return gt}function G(At,gt){return At=ac(At,gt),At.index=0,At.sibling=null,At}function ee(At,gt,Rt){return At.index=Rt,m?(Rt=At.alternate,Rt!==null?(Rt=Rt.index,Rt<gt?(At.flags|=67108866,gt):Rt):(At.flags|=67108866,gt)):(At.flags|=1048576,gt)}function _e(At){return m&&At.alternate===null&&(At.flags|=67108866),At}function Re(At,gt,Rt,xn){return gt===null||gt.tag!==6?(gt=jx(Rt,At.mode,xn),gt.return=At,gt):(gt=G(gt,Rt),gt.return=At,gt)}function at(At,gt,Rt,xn){var xr=Rt.type;return xr===F?hn(At,gt,Rt.props.children,xn,Rt.key):gt!==null&&(gt.elementType===xr||typeof xr=="object"&&xr!==null&&xr.$$typeof===ke&&no(xr)===gt.type)?(gt=G(gt,Rt.props),fc(gt,Rt),gt.return=At,gt):(gt=ng(Rt.type,Rt.key,Rt.props,null,At.mode,xn),fc(gt,Rt),gt.return=At,gt)}function Lt(At,gt,Rt,xn){return gt===null||gt.tag!==4||gt.stateNode.containerInfo!==Rt.containerInfo||gt.stateNode.implementation!==Rt.implementation?(gt=rg(Rt,At.mode,xn),gt.return=At,gt):(gt=G(gt,Rt.children||[]),gt.return=At,gt)}function hn(At,gt,Rt,xn,xr){return gt===null||gt.tag!==7?(gt=uh(Rt,At.mode,xn,xr),gt.return=At,gt):(gt=G(gt,Rt),gt.return=At,gt)}function En(At,gt,Rt){if(typeof gt=="string"&&gt!==""||typeof gt=="number"||typeof gt=="bigint")return gt=jx(""+gt,At.mode,Rt),gt.return=At,gt;if(typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case I:return Rt=ng(gt.type,gt.key,gt.props,null,At.mode,Rt),fc(Rt,gt),Rt.return=At,Rt;case R:return gt=rg(gt,At.mode,Rt),gt.return=At,gt;case ke:var xn=gt._init;return gt=xn(gt._payload),En(At,gt,Rt)}if(vt(gt)||bt(gt))return gt=uh(gt,At.mode,Rt,null),gt.return=At,gt;if(typeof gt.then=="function")return En(At,jh(gt),Rt);if(gt.$$typeof===ie)return En(At,uu(At,gt),Rt);gu(At,gt)}return null}function Ht(At,gt,Rt,xn){var xr=gt!==null?gt.key:null;if(typeof Rt=="string"&&Rt!==""||typeof Rt=="number"||typeof Rt=="bigint")return xr!==null?null:Re(At,gt,""+Rt,xn);if(typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case I:return Rt.key===xr?at(At,gt,Rt,xn):null;case R:return Rt.key===xr?Lt(At,gt,Rt,xn):null;case ke:return xr=Rt._init,Rt=xr(Rt._payload),Ht(At,gt,Rt,xn)}if(vt(Rt)||bt(Rt))return xr!==null?null:hn(At,gt,Rt,xn,null);if(typeof Rt.then=="function")return Ht(At,gt,jh(Rt),xn);if(Rt.$$typeof===ie)return Ht(At,gt,uu(At,Rt),xn);gu(At,Rt)}return null}function Wt(At,gt,Rt,xn,xr){if(typeof xn=="string"&&xn!==""||typeof xn=="number"||typeof xn=="bigint")return At=At.get(Rt)||null,Re(gt,At,""+xn,xr);if(typeof xn=="object"&&xn!==null){switch(xn.$$typeof){case I:return At=At.get(xn.key===null?Rt:xn.key)||null,at(gt,At,xn,xr);case R:return At=At.get(xn.key===null?Rt:xn.key)||null,Lt(gt,At,xn,xr);case ke:var Oi=xn._init;return xn=Oi(xn._payload),Wt(At,gt,Rt,xn,xr)}if(vt(xn)||bt(xn))return At=At.get(Rt)||null,hn(gt,At,xn,xr,null);if(typeof xn.then=="function")return Wt(At,gt,Rt,jh(xn),xr);if(xn.$$typeof===ie)return Wt(At,gt,Rt,uu(gt,xn),xr);gu(gt,xn)}return null}function ni(At,gt,Rt,xn){for(var xr=null,Oi=null,Mr=gt,Wr=gt=0,Bs=null;Mr!==null&&Wr<Rt.length;Wr++){Mr.index>Wr?(Bs=Mr,Mr=null):Bs=Mr.sibling;var na=Ht(At,Mr,Rt[Wr],xn);if(na===null){Mr===null&&(Mr=Bs);break}m&&Mr&&na.alternate===null&&v(At,Mr),gt=ee(na,gt,Wr),Oi===null?xr=na:Oi.sibling=na,Oi=na,Mr=Bs}if(Wr===Rt.length)return C(At,Mr),Hi&&Wu(At,Wr),xr;if(Mr===null){for(;Wr<Rt.length;Wr++)Mr=En(At,Rt[Wr],xn),Mr!==null&&(gt=ee(Mr,gt,Wr),Oi===null?xr=Mr:Oi.sibling=Mr,Oi=Mr);return Hi&&Wu(At,Wr),xr}for(Mr=k(Mr);Wr<Rt.length;Wr++)Bs=Wt(Mr,At,Wr,Rt[Wr],xn),Bs!==null&&(m&&Bs.alternate!==null&&Mr.delete(Bs.key===null?Wr:Bs.key),gt=ee(Bs,gt,Wr),Oi===null?xr=Bs:Oi.sibling=Bs,Oi=Bs);return m&&Mr.forEach(function(bd){return v(At,bd)}),Hi&&Wu(At,Wr),xr}function Gr(At,gt,Rt,xn){if(Rt==null)throw Error(r(151));for(var xr=null,Oi=null,Mr=gt,Wr=gt=0,Bs=null,na=Rt.next();Mr!==null&&!na.done;Wr++,na=Rt.next()){Mr.index>Wr?(Bs=Mr,Mr=null):Bs=Mr.sibling;var bd=Ht(At,Mr,na.value,xn);if(bd===null){Mr===null&&(Mr=Bs);break}m&&Mr&&bd.alternate===null&&v(At,Mr),gt=ee(bd,gt,Wr),Oi===null?xr=bd:Oi.sibling=bd,Oi=bd,Mr=Bs}if(na.done)return C(At,Mr),Hi&&Wu(At,Wr),xr;if(Mr===null){for(;!na.done;Wr++,na=Rt.next())na=En(At,na.value,xn),na!==null&&(gt=ee(na,gt,Wr),Oi===null?xr=na:Oi.sibling=na,Oi=na);return Hi&&Wu(At,Wr),xr}for(Mr=k(Mr);!na.done;Wr++,na=Rt.next())na=Wt(Mr,At,Wr,na.value,xn),na!==null&&(m&&na.alternate!==null&&Mr.delete(na.key===null?Wr:na.key),gt=ee(na,gt,Wr),Oi===null?xr=na:Oi.sibling=na,Oi=na);return m&&Mr.forEach(function(O2){return v(At,O2)}),Hi&&Wu(At,Wr),xr}function Ea(At,gt,Rt,xn){if(typeof Rt=="object"&&Rt!==null&&Rt.type===F&&Rt.key===null&&(Rt=Rt.props.children),typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case I:e:{for(var xr=Rt.key;gt!==null;){if(gt.key===xr){if(xr=Rt.type,xr===F){if(gt.tag===7){C(At,gt.sibling),xn=G(gt,Rt.props.children),xn.return=At,At=xn;break e}}else if(gt.elementType===xr||typeof xr=="object"&&xr!==null&&xr.$$typeof===ke&&no(xr)===gt.type){C(At,gt.sibling),xn=G(gt,Rt.props),fc(xn,Rt),xn.return=At,At=xn;break e}C(At,gt);break}else v(At,gt);gt=gt.sibling}Rt.type===F?(xn=uh(Rt.props.children,At.mode,xn,Rt.key),xn.return=At,At=xn):(xn=ng(Rt.type,Rt.key,Rt.props,null,At.mode,xn),fc(xn,Rt),xn.return=At,At=xn)}return _e(At);case R:e:{for(xr=Rt.key;gt!==null;){if(gt.key===xr)if(gt.tag===4&&gt.stateNode.containerInfo===Rt.containerInfo&&gt.stateNode.implementation===Rt.implementation){C(At,gt.sibling),xn=G(gt,Rt.children||[]),xn.return=At,At=xn;break e}else{C(At,gt);break}else v(At,gt);gt=gt.sibling}xn=rg(Rt,At.mode,xn),xn.return=At,At=xn}return _e(At);case ke:return xr=Rt._init,Rt=xr(Rt._payload),Ea(At,gt,Rt,xn)}if(vt(Rt))return ni(At,gt,Rt,xn);if(bt(Rt)){if(xr=bt(Rt),typeof xr!="function")throw Error(r(150));return Rt=xr.call(Rt),Gr(At,gt,Rt,xn)}if(typeof Rt.then=="function")return Ea(At,gt,jh(Rt),xn);if(Rt.$$typeof===ie)return Ea(At,gt,uu(At,Rt),xn);gu(At,Rt)}return typeof Rt=="string"&&Rt!==""||typeof Rt=="number"||typeof Rt=="bigint"?(Rt=""+Rt,gt!==null&&gt.tag===6?(C(At,gt.sibling),xn=G(gt,Rt),xn.return=At,At=xn):(C(At,gt),xn=jx(Rt,At.mode,xn),xn.return=At,At=xn),_e(At)):C(At,gt)}return function(At,gt,Rt,xn){try{sl=0;var xr=Ea(At,gt,Rt,xn);return Eo=null,xr}catch(Mr){if(Mr===Rp||Mr===Tf)throw Mr;var Oi=Vo(29,Mr,null,At.mode);return Oi.lanes=xn,Oi.return=At,Oi}finally{}}}var ud=pc(!0),xu=pc(!1),qo=ot(null),ol=null;function Dl(m){var v=m.alternate;It(Qa,Qa.current&1),It(qo,m),ol===null&&(v===null||yh.current!==null||v.memoizedState!==null)&&(ol=m)}function xg(m){if(m.tag===22){if(It(Qa,Qa.current),It(qo,m),ol===null){var v=m.alternate;v!==null&&v.memoizedState!==null&&(ol=m)}}else la()}function la(){It(Qa,Qa.current),It(qo,qo.current)}function mc(m){mt(qo),ol===m&&(ol=null),mt(Qa)}var Qa=ot(0);function gc(m){for(var v=m;v!==null;){if(v.tag===13){var C=v.memoizedState;if(C!==null&&(C=C.dehydrated,C===null||C.data==="$?"||r1(C)))return v}else if(v.tag===19&&v.memoizedProps.revealOrder!==void 0){if((v.flags&128)!==0)return v}else if(v.child!==null){v.child.return=v,v=v.child;continue}if(v===m)break;for(;v.sibling===null;){if(v.return===null||v.return===m)return null;v=v.return}v.sibling.return=v.return,v=v.sibling}return null}function Mh(m,v,C,k){v=m.memoizedState,C=C(k,v),C=C==null?v:E({},v,C),m.memoizedState=C,m.lanes===0&&(m.updateQueue.baseState=C)}var Qp={enqueueSetState:function(m,v,C){m=m._reactInternals;var k=Es(),G=Ic(k);G.payload=v,C!=null&&(G.callback=C),v=uc(m,G,k),v!==null&&(so(v,m,k),Af(v,m,k))},enqueueReplaceState:function(m,v,C){m=m._reactInternals;var k=Es(),G=Ic(k);G.tag=1,G.payload=v,C!=null&&(G.callback=C),v=uc(m,G,k),v!==null&&(so(v,m,k),Af(v,m,k))},enqueueForceUpdate:function(m,v){m=m._reactInternals;var C=Es(),k=Ic(C);k.tag=2,v!=null&&(k.callback=v),v=uc(m,k,C),v!==null&&(so(v,m,C),Af(v,m,C))}};function Jp(m,v,C,k,G,ee,_e){return m=m.stateNode,typeof m.shouldComponentUpdate=="function"?m.shouldComponentUpdate(k,ee,_e):v.prototype&&v.prototype.isPureReactComponent?!rl(C,k)||!rl(G,ee):!0}function dd(m,v,C,k){m=v.state,typeof v.componentWillReceiveProps=="function"&&v.componentWillReceiveProps(C,k),typeof v.UNSAFE_componentWillReceiveProps=="function"&&v.UNSAFE_componentWillReceiveProps(C,k),v.state!==m&&Qp.enqueueReplaceState(v,v.state,null)}function yu(m,v){var C=v;if("ref"in v){C={};for(var k in v)k!=="ref"&&(C[k]=v[k])}if(m=m.defaultProps){C===v&&(C=E({},C));for(var G in m)C[G]===void 0&&(C[G]=m[G])}return C}var hd=typeof reportError=="function"?reportError:function(m){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var v=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof m=="object"&&m!==null&&typeof m.message=="string"?String(m.message):String(m),error:m});if(!window.dispatchEvent(v))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",m);return}console.error(m)};function Ph(m){hd(m)}function Of(m){console.error(m)}function yg(m){hd(m)}function Nh(m,v){try{var C=m.onUncaughtError;C(v.value,{componentStack:v.stack})}catch(k){setTimeout(function(){throw k})}}function Zx(m,v,C){try{var k=m.onCaughtError;k(C.value,{componentStack:C.stack,errorBoundary:v.tag===1?v.stateNode:null})}catch(G){setTimeout(function(){throw G})}}function If(m,v,C){return C=Ic(C),C.tag=3,C.payload={element:null},C.callback=function(){Nh(m,v)},C}function Xx(m){return m=Ic(m),m.tag=3,m}function Kx(m,v,C,k){var G=C.type.getDerivedStateFromError;if(typeof G=="function"){var ee=k.value;m.payload=function(){return G(ee)},m.callback=function(){Zx(v,C,k)}}var _e=C.stateNode;_e!==null&&typeof _e.componentDidCatch=="function"&&(m.callback=function(){Zx(v,C,k),typeof G!="function"&&(xa===null?xa=new Set([this]):xa.add(this));var Re=k.stack;this.componentDidCatch(k.value,{componentStack:Re!==null?Re:""})})}function $y(m,v,C,k,G){if(C.flags|=32768,k!==null&&typeof k=="object"&&typeof k.then=="function"){if(v=C.alternate,v!==null&&ph(v,C,G,!0),C=qo.current,C!==null){switch(C.tag){case 13:return ol===null?wu():C.alternate===null&&ti===0&&(ti=3),C.flags&=-257,C.flags|=65536,C.lanes=G,k===xh?C.flags|=16384:(v=C.updateQueue,v===null?C.updateQueue=new Set([k]):v.add(k),Z_(m,k,G)),!1;case 22:return C.flags|=65536,k===xh?C.flags|=16384:(v=C.updateQueue,v===null?(v={transitions:null,markerInstances:null,retryQueue:new Set([k])},C.updateQueue=v):(C=v.retryQueue,C===null?v.retryQueue=new Set([k]):C.add(k)),Z_(m,k,G)),!1}throw Error(r(435,C.tag))}return Z_(m,k,G),wu(),!1}if(Hi)return v=qo.current,v!==null?((v.flags&65536)===0&&(v.flags|=256),v.flags|=65536,v.lanes=G,k!==Pp&&(m=Error(r(422),{cause:k}),vf(xo(m,C)))):(k!==Pp&&(v=Error(r(423),{cause:k}),vf(xo(v,C))),m=m.current.alternate,m.flags|=65536,G&=-G,m.lanes|=G,k=xo(k,C),G=If(m.stateNode,k,G),Lp(m,G),ti!==4&&(ti=2)),!1;var ee=Error(r(520),{cause:k});if(ee=xo(ee,C),kr===null?kr=[ee]:kr.push(ee),ti!==4&&(ti=2),v===null)return!0;k=xo(k,C),C=v;do{switch(C.tag){case 3:return C.flags|=65536,m=G&-G,C.lanes|=m,m=If(C.stateNode,k,m),Lp(C,m),!1;case 1:if(v=C.type,ee=C.stateNode,(C.flags&128)===0&&(typeof v.getDerivedStateFromError=="function"||ee!==null&&typeof ee.componentDidCatch=="function"&&(xa===null||!xa.has(ee))))return C.flags|=65536,G&=-G,C.lanes|=G,G=Xx(G),Kx(G,m,C,k),Lp(C,G),!1}C=C.return}while(C!==null);return!1}var Yx=Error(r(461)),is=!1;function Ss(m,v,C,k){v.child=m===null?xu(v,null,C,k):ud(v,m.child,C,k)}function Qx(m,v,C,k,G){C=C.render;var ee=v.ref;if("ref"in k){var _e={};for(var Re in k)Re!=="ref"&&(_e[Re]=k[Re])}else _e=k;return Ml(v),k=vh(m,v,C,_e,ee,G),Re=Un(),m!==null&&!is?(Vp(m,v,G),ll(m,v,G)):(Hi&&Re&&hh(v),v.flags|=1,Ss(m,v,k,G),v.child)}function Jx(m,v,C,k,G){if(m===null){var ee=C.type;return typeof ee=="function"&&!jp(ee)&&ee.defaultProps===void 0&&C.compare===null?(v.tag=15,v.type=ee,e0(m,v,ee,k,G)):(m=ng(C.type,null,k,v,v.mode,G),m.ref=v.ref,m.return=v,v.child=m)}if(ee=m.child,!Rf(m,G)){var _e=ee.memoizedProps;if(C=C.compare,C=C!==null?C:rl,C(_e,k)&&m.ref===v.ref)return ll(m,v,G)}return v.flags|=1,m=ac(ee,k),m.ref=v.ref,m.return=v,v.child=m}function e0(m,v,C,k,G){if(m!==null){var ee=m.memoizedProps;if(rl(ee,k)&&m.ref===v.ref)if(is=!1,v.pendingProps=k=ee,Rf(m,G))(m.flags&131072)!==0&&(is=!0);else return v.lanes=m.lanes,ll(m,v,G)}return r0(m,v,C,k,G)}function t0(m,v,C){var k=v.pendingProps,G=k.children,ee=m!==null?m.memoizedState:null;if(k.mode==="hidden"){if((v.flags&128)!==0){if(k=ee!==null?ee.baseLanes|C:C,m!==null){for(G=v.child=m.child,ee=0;G!==null;)ee=ee|G.lanes|G.childLanes,G=G.sibling;v.childLanes=ee&~k}else v.childLanes=0,v.child=null;return n0(m,v,k,C)}if((C&536870912)!==0)v.memoizedState={baseLanes:0,cachePool:null},m!==null&&kp(v,ee!==null?ee.cachePool:null),ee!==null?kc(v,ee):Rx(),xg(v);else return v.lanes=v.childLanes=536870912,n0(m,v,ee!==null?ee.baseLanes|C:C,C)}else ee!==null?(kp(v,ee.cachePool),kc(v,ee),la(),v.memoizedState=null):(m!==null&&kp(v,null),Rx(),la());return Ss(m,v,G,C),v.child}function n0(m,v,C,k){var G=Dx();return G=G===null?null:{parent:$a._currentValue,pool:G},v.memoizedState={baseLanes:C,cachePool:G},m!==null&&kp(v,null),Rx(),xg(v),m!==null&&ph(m,v,k,!0),null}function vg(m,v){var C=v.ref;if(C===null)m!==null&&m.ref!==null&&(v.flags|=4194816);else{if(typeof C!="function"&&typeof C!="object")throw Error(r(284));(m===null||m.ref!==C)&&(v.flags|=4194816)}}function r0(m,v,C,k,G){return Ml(v),C=vh(m,v,C,k,void 0,G),k=Un(),m!==null&&!is?(Vp(m,v,G),ll(m,v,G)):(Hi&&k&&hh(v),v.flags|=1,Ss(m,v,C,G),v.child)}function Wi(m,v,C,k,G,ee){return Ml(v),v.updateQueue=null,C=hu(v,k,C,G),nd(m),k=Un(),m!==null&&!is?(Vp(m,v,ee),ll(m,v,ee)):(Hi&&k&&hh(v),v.flags|=1,Ss(m,v,C,ee),v.child)}function i0(m,v,C,k,G){if(Ml(v),v.stateNode===null){var ee=Gu,_e=C.contextType;typeof _e=="object"&&_e!==null&&(ee=Ya(_e)),ee=new C(k,ee),v.memoizedState=ee.state!==null&&ee.state!==void 0?ee.state:null,ee.updater=Qp,v.stateNode=ee,ee._reactInternals=v,ee=v.stateNode,ee.props=k,ee.state=v.memoizedState,ee.refs={},og(v),_e=C.contextType,ee.context=typeof _e=="object"&&_e!==null?Ya(_e):Gu,ee.state=v.memoizedState,_e=C.getDerivedStateFromProps,typeof _e=="function"&&(Mh(v,C,_e,k),ee.state=v.memoizedState),typeof C.getDerivedStateFromProps=="function"||typeof ee.getSnapshotBeforeUpdate=="function"||typeof ee.UNSAFE_componentWillMount!="function"&&typeof ee.componentWillMount!="function"||(_e=ee.state,typeof ee.componentWillMount=="function"&&ee.componentWillMount(),typeof ee.UNSAFE_componentWillMount=="function"&&ee.UNSAFE_componentWillMount(),_e!==ee.state&&Qp.enqueueReplaceState(ee,ee.state,null),jf(v,k,ee,G),Yu(),ee.state=v.memoizedState),typeof ee.componentDidMount=="function"&&(v.flags|=4194308),k=!0}else if(m===null){ee=v.stateNode;var Re=v.memoizedProps,at=yu(C,Re);ee.props=at;var Lt=ee.context,hn=C.contextType;_e=Gu,typeof hn=="object"&&hn!==null&&(_e=Ya(hn));var En=C.getDerivedStateFromProps;hn=typeof En=="function"||typeof ee.getSnapshotBeforeUpdate=="function",Re=v.pendingProps!==Re,hn||typeof ee.UNSAFE_componentWillReceiveProps!="function"&&typeof ee.componentWillReceiveProps!="function"||(Re||Lt!==_e)&&dd(v,ee,k,_e),bo=!1;var Ht=v.memoizedState;ee.state=Ht,jf(v,k,ee,G),Yu(),Lt=v.memoizedState,Re||Ht!==Lt||bo?(typeof En=="function"&&(Mh(v,C,En,k),Lt=v.memoizedState),(at=bo||Jp(v,C,at,k,Ht,Lt,_e))?(hn||typeof ee.UNSAFE_componentWillMount!="function"&&typeof ee.componentWillMount!="function"||(typeof ee.componentWillMount=="function"&&ee.componentWillMount(),typeof ee.UNSAFE_componentWillMount=="function"&&ee.UNSAFE_componentWillMount()),typeof ee.componentDidMount=="function"&&(v.flags|=4194308)):(typeof ee.componentDidMount=="function"&&(v.flags|=4194308),v.memoizedProps=k,v.memoizedState=Lt),ee.props=k,ee.state=Lt,ee.context=_e,k=at):(typeof ee.componentDidMount=="function"&&(v.flags|=4194308),k=!1)}else{ee=v.stateNode,wo(m,v),_e=v.memoizedProps,hn=yu(C,_e),ee.props=hn,En=v.pendingProps,Ht=ee.context,Lt=C.contextType,at=Gu,typeof Lt=="object"&&Lt!==null&&(at=Ya(Lt)),Re=C.getDerivedStateFromProps,(Lt=typeof Re=="function"||typeof ee.getSnapshotBeforeUpdate=="function")||typeof ee.UNSAFE_componentWillReceiveProps!="function"&&typeof ee.componentWillReceiveProps!="function"||(_e!==En||Ht!==at)&&dd(v,ee,k,at),bo=!1,Ht=v.memoizedState,ee.state=Ht,jf(v,k,ee,G),Yu();var Wt=v.memoizedState;_e!==En||Ht!==Wt||bo||m!==null&&m.dependencies!==null&&_f(m.dependencies)?(typeof Re=="function"&&(Mh(v,C,Re,k),Wt=v.memoizedState),(hn=bo||Jp(v,C,hn,k,Ht,Wt,at)||m!==null&&m.dependencies!==null&&_f(m.dependencies))?(Lt||typeof ee.UNSAFE_componentWillUpdate!="function"&&typeof ee.componentWillUpdate!="function"||(typeof ee.componentWillUpdate=="function"&&ee.componentWillUpdate(k,Wt,at),typeof ee.UNSAFE_componentWillUpdate=="function"&&ee.UNSAFE_componentWillUpdate(k,Wt,at)),typeof ee.componentDidUpdate=="function"&&(v.flags|=4),typeof ee.getSnapshotBeforeUpdate=="function"&&(v.flags|=1024)):(typeof ee.componentDidUpdate!="function"||_e===m.memoizedProps&&Ht===m.memoizedState||(v.flags|=4),typeof ee.getSnapshotBeforeUpdate!="function"||_e===m.memoizedProps&&Ht===m.memoizedState||(v.flags|=1024),v.memoizedProps=k,v.memoizedState=Wt),ee.props=k,ee.state=Wt,ee.context=at,k=hn):(typeof ee.componentDidUpdate!="function"||_e===m.memoizedProps&&Ht===m.memoizedState||(v.flags|=4),typeof ee.getSnapshotBeforeUpdate!="function"||_e===m.memoizedProps&&Ht===m.memoizedState||(v.flags|=1024),k=!1)}return ee=k,vg(m,v),k=(v.flags&128)!==0,ee||k?(ee=v.stateNode,C=k&&typeof C.getDerivedStateFromError!="function"?null:ee.render(),v.flags|=1,m!==null&&k?(v.child=ud(v,m.child,null,G),v.child=ud(v,null,C,G)):Ss(m,v,C,G),v.memoizedState=ee.state,m=v.child):m=ll(m,v,G),m}function qy(m,v,C,k){return yf(),v.flags|=256,Ss(m,v,C,k),v.child}var fd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function a0(m){return{baseLanes:m,cachePool:Ox()}}function pd(m,v,C){return m=m!==null?m.childLanes&~C:0,v&&(m|=rr),m}function s0(m,v,C){var k=v.pendingProps,G=!1,ee=(v.flags&128)!==0,_e;if((_e=ee)||(_e=m!==null&&m.memoizedState===null?!1:(Qa.current&2)!==0),_e&&(G=!0,v.flags&=-129),_e=(v.flags&32)!==0,v.flags&=-33,m===null){if(Hi){if(G?Dl(v):la(),Hi){var Re=ma,at;if(at=Re){e:{for(at=Re,Re=oc;at.nodeType!==8;){if(!Re){Re=null;break e}if(at=Tu(at.nextSibling),at===null){Re=null;break e}}Re=at}Re!==null?(v.memoizedState={dehydrated:Re,treeContext:su!==null?{id:vo,overflow:sc}:null,retryLane:536870912,hydrationErrors:null},at=Vo(18,null,null,0),at.stateNode=Re,at.return=v,v.child=at,ws=v,ma=null,at=!0):at=!1}at||Dc(v)}if(Re=v.memoizedState,Re!==null&&(Re=Re.dehydrated,Re!==null))return r1(Re)?v.lanes=32:v.lanes=536870912,null;mc(v)}return Re=k.children,k=k.fallback,G?(la(),G=v.mode,Re=md({mode:"hidden",children:Re},G),k=uh(k,G,C,null),Re.return=v,k.return=v,Re.sibling=k,v.child=Re,G=v.child,G.memoizedState=a0(C),G.childLanes=pd(m,_e,C),v.memoizedState=fd,k):(Dl(v),kf(v,Re))}if(at=m.memoizedState,at!==null&&(Re=at.dehydrated,Re!==null)){if(ee)v.flags&256?(Dl(v),v.flags&=-257,v=Ol(m,v,C)):v.memoizedState!==null?(la(),v.child=m.child,v.flags|=128,v=null):(la(),G=k.fallback,Re=v.mode,k=md({mode:"visible",children:k.children},Re),G=uh(G,Re,C,null),G.flags|=2,k.return=v,G.return=v,k.sibling=G,v.child=k,ud(v,m.child,null,C),k=v.child,k.memoizedState=a0(C),k.childLanes=pd(m,_e,C),v.memoizedState=fd,v=G);else if(Dl(v),r1(Re)){if(_e=Re.nextSibling&&Re.nextSibling.dataset,_e)var Lt=_e.dgst;_e=Lt,k=Error(r(419)),k.stack="",k.digest=_e,vf({value:k,source:null,stack:null}),v=Ol(m,v,C)}else if(is||ph(m,v,C,!1),_e=(C&m.childLanes)!==0,is||_e){if(_e=ur,_e!==null&&(k=C&-C,k=(k&42)!==0?1:el(k),k=(k&(_e.suspendedLanes|C))!==0?0:k,k!==0&&k!==at.retryLane))throw at.retryLane=k,jl(m,k),so(_e,m,k),Yx;Re.data==="$?"||wu(),v=Ol(m,v,C)}else Re.data==="$?"?(v.flags|=192,v.child=m.child,v=null):(m=at.treeContext,ma=Tu(Re.nextSibling),ws=v,Hi=!0,ou=null,oc=!1,m!==null&&(Uo[yo++]=vo,Uo[yo++]=sc,Uo[yo++]=su,vo=m.id,sc=m.overflow,su=v),v=kf(v,k.children),v.flags|=4096);return v}return G?(la(),G=k.fallback,Re=v.mode,at=m.child,Lt=at.sibling,k=ac(at,{mode:"hidden",children:k.children}),k.subtreeFlags=at.subtreeFlags&65011712,Lt!==null?G=ac(Lt,G):(G=uh(G,Re,C,null),G.flags|=2),G.return=v,k.return=v,k.sibling=G,v.child=k,k=G,G=v.child,Re=m.child.memoizedState,Re===null?Re=a0(C):(at=Re.cachePool,at!==null?(Lt=$a._currentValue,at=at.parent!==Lt?{parent:Lt,pool:Lt}:at):at=Ox(),Re={baseLanes:Re.baseLanes|C,cachePool:at}),G.memoizedState=Re,G.childLanes=pd(m,_e,C),v.memoizedState=fd,k):(Dl(v),C=m.child,m=C.sibling,C=ac(C,{mode:"visible",children:k.children}),C.return=v,C.sibling=null,m!==null&&(_e=v.deletions,_e===null?(v.deletions=[m],v.flags|=16):_e.push(m)),v.child=C,v.memoizedState=null,C)}function kf(m,v){return v=md({mode:"visible",children:v},m.mode),v.return=m,m.child=v}function md(m,v){return m=Vo(22,m,null,v),m.lanes=0,m.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},m}function Ol(m,v,C){return ud(v,m.child,null,C),m=kf(v,v.pendingProps.children),m.flags|=2,v.memoizedState=null,m}function em(m,v,C){m.lanes|=v;var k=m.alternate;k!==null&&(k.lanes|=v),Np(m.return,v,C)}function ca(m,v,C,k,G){var ee=m.memoizedState;ee===null?m.memoizedState={isBackwards:v,rendering:null,renderingStartTime:0,last:k,tail:C,tailMode:G}:(ee.isBackwards=v,ee.rendering=null,ee.renderingStartTime=0,ee.last=k,ee.tail=C,ee.tailMode=G)}function Il(m,v,C){var k=v.pendingProps,G=k.revealOrder,ee=k.tail;if(Ss(m,v,k.children,C),k=Qa.current,(k&2)!==0)k=k&1|2,v.flags|=128;else{if(m!==null&&(m.flags&128)!==0)e:for(m=v.child;m!==null;){if(m.tag===13)m.memoizedState!==null&&em(m,C,v);else if(m.tag===19)em(m,C,v);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===v)break e;for(;m.sibling===null;){if(m.return===null||m.return===v)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}k&=1}switch(It(Qa,k),G){case"forwards":for(C=v.child,G=null;C!==null;)m=C.alternate,m!==null&&gc(m)===null&&(G=C),C=C.sibling;C=G,C===null?(G=v.child,v.child=null):(G=C.sibling,C.sibling=null),ca(v,!1,G,C,ee);break;case"backwards":for(C=null,G=v.child,v.child=null;G!==null;){if(m=G.alternate,m!==null&&gc(m)===null){v.child=G;break}m=G.sibling,G.sibling=C,C=G,G=m}ca(v,!0,C,null,ee);break;case"together":ca(v,!1,null,null,void 0);break;default:v.memoizedState=null}return v.child}function ll(m,v,C){if(m!==null&&(v.dependencies=m.dependencies),Pi|=v.lanes,(C&v.childLanes)===0)if(m!==null){if(ph(m,v,C,!1),(C&v.childLanes)===0)return null}else return null;if(m!==null&&v.child!==m.child)throw Error(r(153));if(v.child!==null){for(m=v.child,C=ac(m,m.pendingProps),v.child=C,C.return=v;m.sibling!==null;)m=m.sibling,C=C.sibling=ac(m,m.pendingProps),C.return=v;C.sibling=null}return v.child}function Rf(m,v){return(m.lanes&v)!==0?!0:(m=m.dependencies,!!(m!==null&&_f(m)))}function Hy(m,v,C){switch(v.tag){case 3:Sr(v,v.stateNode.containerInfo),lc(v,$a,m.memoizedState.cache),yf();break;case 27:case 5:er(v);break;case 4:Sr(v,v.stateNode.containerInfo);break;case 10:lc(v,v.type,v.memoizedProps.value);break;case 13:var k=v.memoizedState;if(k!==null)return k.dehydrated!==null?(Dl(v),v.flags|=128,null):(C&v.child.childLanes)!==0?s0(m,v,C):(Dl(v),m=ll(m,v,C),m!==null?m.sibling:null);Dl(v);break;case 19:var G=(m.flags&128)!==0;if(k=(C&v.childLanes)!==0,k||(ph(m,v,C,!1),k=(C&v.childLanes)!==0),G){if(k)return Il(m,v,C);v.flags|=128}if(G=v.memoizedState,G!==null&&(G.rendering=null,G.tail=null,G.lastEffect=null),It(Qa,Qa.current),k)break;return null;case 22:case 23:return v.lanes=0,t0(m,v,C);case 24:lc(v,$a,m.memoizedState.cache)}return ll(m,v,C)}function Gy(m,v,C){if(m!==null)if(m.memoizedProps!==v.pendingProps)is=!0;else{if(!Rf(m,C)&&(v.flags&128)===0)return is=!1,Hy(m,v,C);is=(m.flags&131072)!==0}else is=!1,Hi&&(v.flags&1048576)!==0&&dh(v,Mp,v.index);switch(v.lanes=0,v.tag){case 16:e:{m=v.pendingProps;var k=v.elementType,G=k._init;if(k=G(k._payload),v.type=k,typeof k=="function")jp(k)?(m=yu(k,m),v.tag=1,v=i0(null,v,k,m,C)):(v.tag=0,v=r0(null,v,k,m,C));else{if(k!=null){if(G=k.$$typeof,G===ge){v.tag=11,v=Qx(null,v,k,m,C);break e}else if(G===me){v.tag=14,v=Jx(null,v,k,m,C);break e}}throw v=Nt(k)||k,Error(r(306,v,""))}}return v;case 0:return r0(m,v,v.type,v.pendingProps,C);case 1:return k=v.type,G=yu(k,v.pendingProps),i0(m,v,k,G,C);case 3:e:{if(Sr(v,v.stateNode.containerInfo),m===null)throw Error(r(387));k=v.pendingProps;var ee=v.memoizedState;G=ee.element,wo(m,v),jf(v,k,null,C);var _e=v.memoizedState;if(k=_e.cache,lc(v,$a,k),k!==ee.cache&&Dp(v,[$a],C,!0),Yu(),k=_e.element,ee.isDehydrated)if(ee={element:k,isDehydrated:!1,cache:_e.cache},v.updateQueue.baseState=ee,v.memoizedState=ee,v.flags&256){v=qy(m,v,k,C);break e}else if(k!==G){G=xo(Error(r(424)),v),vf(G),v=qy(m,v,k,C);break e}else{switch(m=v.stateNode.containerInfo,m.nodeType){case 9:m=m.body;break;default:m=m.nodeName==="HTML"?m.ownerDocument.body:m}for(ma=Tu(m.firstChild),ws=v,Hi=!0,ou=null,oc=!0,C=xu(v,null,k,C),v.child=C;C;)C.flags=C.flags&-3|4096,C=C.sibling}else{if(yf(),k===G){v=ll(m,v,C);break e}Ss(m,v,k,C)}v=v.child}return v;case 26:return vg(m,v),m===null?(C=pv(v.type,null,v.pendingProps,null))?v.memoizedState=C:Hi||(C=v.type,m=v.pendingProps,k=Eg(vn.current).createElement(C),k[ye]=v,k[Me]=m,Fs(k,C,m),zn(k),v.stateNode=k):v.memoizedState=pv(v.type,m.memoizedProps,v.pendingProps,m.memoizedState),null;case 27:return er(v),m===null&&Hi&&(k=v.stateNode=a1(v.type,v.pendingProps,vn.current),ws=v,oc=!0,G=ma,Rh(v.type)?(i1=G,ma=Tu(k.firstChild)):ma=G),Ss(m,v,v.pendingProps.children,C),vg(m,v),m===null&&(v.flags|=4194304),v.child;case 5:return m===null&&Hi&&((G=k=ma)&&(k=hm(k,v.type,v.pendingProps,oc),k!==null?(v.stateNode=k,ws=v,ma=Tu(k.firstChild),oc=!1,G=!0):G=!1),G||Dc(v)),er(v),G=v.type,ee=v.pendingProps,_e=m!==null?m.memoizedProps:null,k=ee.children,uv(G,ee)?k=null:_e!==null&&uv(G,_e)&&(v.flags|=32),v.memoizedState!==null&&(G=vh(m,v,rd,null,null,C),Mg._currentValue=G),vg(m,v),Ss(m,v,k,C),v.child;case 6:return m===null&&Hi&&((m=C=ma)&&(C=x2(C,v.pendingProps,oc),C!==null?(v.stateNode=C,ws=v,ma=null,m=!0):m=!1),m||Dc(v)),null;case 13:return s0(m,v,C);case 4:return Sr(v,v.stateNode.containerInfo),k=v.pendingProps,m===null?v.child=ud(v,null,k,C):Ss(m,v,k,C),v.child;case 11:return Qx(m,v,v.type,v.pendingProps,C);case 7:return Ss(m,v,v.pendingProps,C),v.child;case 8:return Ss(m,v,v.pendingProps.children,C),v.child;case 12:return Ss(m,v,v.pendingProps.children,C),v.child;case 10:return k=v.pendingProps,lc(v,v.type,k.value),Ss(m,v,k.children,C),v.child;case 9:return G=v.type._context,k=v.pendingProps.children,Ml(v),G=Ya(G),k=k(G),v.flags|=1,Ss(m,v,k,C),v.child;case 14:return Jx(m,v,v.type,v.pendingProps,C);case 15:return e0(m,v,v.type,v.pendingProps,C);case 19:return Il(m,v,C);case 31:return k=v.pendingProps,C=v.mode,k={mode:k.mode,children:k.children},m===null?(C=md(k,C),C.ref=v.ref,v.child=C,C.return=v,v=C):(C=ac(m.child,k),C.ref=v.ref,v.child=C,C.return=v,v=C),v;case 22:return t0(m,v,C);case 24:return Ml(v),k=Ya($a),m===null?(G=Dx(),G===null&&(G=ur,ee=bf(),G.pooledCache=ee,ee.refCount++,ee!==null&&(G.pooledCacheLanes|=C),G=ee),v.memoizedState={parent:k,cache:G},og(v),lc(v,$a,G)):((m.lanes&C)!==0&&(wo(m,v),jf(v,null,null,C),Yu()),G=m.memoizedState,ee=v.memoizedState,G.parent!==k?(G={parent:k,cache:k},v.memoizedState=G,v.lanes===0&&(v.memoizedState=v.updateQueue.baseState=G),lc(v,$a,k)):(k=ee.cache,lc(v,$a,k),k!==G.cache&&Dp(v,[$a],C,!0))),Ss(m,v,v.pendingProps.children,C),v.child;case 29:throw v.pendingProps}throw Error(r(156,v.tag))}function cl(m){m.flags|=4}function o0(m,v){if(v.type!=="stylesheet"||(v.state.loading&4)!==0)m.flags&=-16777217;else if(m.flags|=16777216,!y0(v)){if(v=qo.current,v!==null&&((Bn&4194048)===Bn?ol!==null:(Bn&62914560)!==Bn&&(Bn&536870912)===0||v!==ol))throw Ef=xh,Fy;m.flags|=8192}}function zf(m,v){v!==null&&(m.flags|=4),m.flags&16384&&(v=m.tag!==22?Yc():536870912,m.lanes|=v,_i|=v)}function ro(m,v){if(!Hi)switch(m.tailMode){case"hidden":v=m.tail;for(var C=null;v!==null;)v.alternate!==null&&(C=v),v=v.sibling;C===null?m.tail=null:C.sibling=null;break;case"collapsed":C=m.tail;for(var k=null;C!==null;)C.alternate!==null&&(k=C),C=C.sibling;k===null?v||m.tail===null?m.tail=null:m.tail.sibling=null:k.sibling=null}}function ga(m){var v=m.alternate!==null&&m.alternate.child===m.child,C=0,k=0;if(v)for(var G=m.child;G!==null;)C|=G.lanes|G.childLanes,k|=G.subtreeFlags&65011712,k|=G.flags&65011712,G.return=m,G=G.sibling;else for(G=m.child;G!==null;)C|=G.lanes|G.childLanes,k|=G.subtreeFlags,k|=G.flags,G.return=m,G=G.sibling;return m.subtreeFlags|=k,m.childLanes=C,v}function tm(m,v,C){var k=v.pendingProps;switch(mf(v),v.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ga(v),null;case 1:return ga(v),null;case 3:return C=v.stateNode,k=null,m!==null&&(k=m.memoizedState.cache),v.memoizedState.cache!==k&&(v.flags|=2048),cc($a),un(),C.pendingContext&&(C.context=C.pendingContext,C.pendingContext=null),(m===null||m.child===null)&&(xf(v)?cl(v):m===null||m.memoizedState.isDehydrated&&(v.flags&256)===0||(v.flags|=1024,fh())),ga(v),null;case 26:return C=v.memoizedState,m===null?(cl(v),C!==null?(ga(v),o0(v,C)):(ga(v),v.flags&=-16777217)):C?C!==m.memoizedState?(cl(v),ga(v),o0(v,C)):(ga(v),v.flags&=-16777217):(m.memoizedProps!==k&&cl(v),ga(v),v.flags&=-16777217),null;case 27:hr(v),C=vn.current;var G=v.type;if(m!==null&&v.stateNode!=null)m.memoizedProps!==k&&cl(v);else{if(!k){if(v.stateNode===null)throw Error(r(166));return ga(v),null}m=In.current,xf(v)?gf(v):(m=a1(G,k,C),v.stateNode=m,cl(v))}return ga(v),null;case 5:if(hr(v),C=v.type,m!==null&&v.stateNode!=null)m.memoizedProps!==k&&cl(v);else{if(!k){if(v.stateNode===null)throw Error(r(166));return ga(v),null}if(m=In.current,xf(v))gf(v);else{switch(G=Eg(vn.current),m){case 1:m=G.createElementNS("http://www.w3.org/2000/svg",C);break;case 2:m=G.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;default:switch(C){case"svg":m=G.createElementNS("http://www.w3.org/2000/svg",C);break;case"math":m=G.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;case"script":m=G.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof k.is=="string"?G.createElement("select",{is:k.is}):G.createElement("select"),k.multiple?m.multiple=!0:k.size&&(m.size=k.size);break;default:m=typeof k.is=="string"?G.createElement(C,{is:k.is}):G.createElement(C)}}m[ye]=v,m[Me]=k;e:for(G=v.child;G!==null;){if(G.tag===5||G.tag===6)m.appendChild(G.stateNode);else if(G.tag!==4&&G.tag!==27&&G.child!==null){G.child.return=G,G=G.child;continue}if(G===v)break e;for(;G.sibling===null;){if(G.return===null||G.return===v)break e;G=G.return}G.sibling.return=G.return,G=G.sibling}v.stateNode=m;e:switch(Fs(m,C,k),C){case"button":case"input":case"select":case"textarea":m=!!k.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&cl(v)}}return ga(v),v.flags&=-16777217,null;case 6:if(m&&v.stateNode!=null)m.memoizedProps!==k&&cl(v);else{if(typeof k!="string"&&v.stateNode===null)throw Error(r(166));if(m=vn.current,xf(v)){if(m=v.stateNode,C=v.memoizedProps,k=null,G=ws,G!==null)switch(G.tag){case 27:case 5:k=G.memoizedProps}m[ye]=v,m=!!(m.nodeValue===C||k!==null&&k.suppressHydrationWarning===!0||Tg(m.nodeValue,C)),m||Dc(v)}else m=Eg(m).createTextNode(k),m[ye]=v,v.stateNode=m}return ga(v),null;case 13:if(k=v.memoizedState,m===null||m.memoizedState!==null&&m.memoizedState.dehydrated!==null){if(G=xf(v),k!==null&&k.dehydrated!==null){if(m===null){if(!G)throw Error(r(318));if(G=v.memoizedState,G=G!==null?G.dehydrated:null,!G)throw Error(r(317));G[ye]=v}else yf(),(v.flags&128)===0&&(v.memoizedState=null),v.flags|=4;ga(v),G=!1}else G=fh(),m!==null&&m.memoizedState!==null&&(m.memoizedState.hydrationErrors=G),G=!0;if(!G)return v.flags&256?(mc(v),v):(mc(v),null)}if(mc(v),(v.flags&128)!==0)return v.lanes=C,v;if(C=k!==null,m=m!==null&&m.memoizedState!==null,C){k=v.child,G=null,k.alternate!==null&&k.alternate.memoizedState!==null&&k.alternate.memoizedState.cachePool!==null&&(G=k.alternate.memoizedState.cachePool.pool);var ee=null;k.memoizedState!==null&&k.memoizedState.cachePool!==null&&(ee=k.memoizedState.cachePool.pool),ee!==G&&(k.flags|=2048)}return C!==m&&C&&(v.child.flags|=8192),zf(v,v.updateQueue),ga(v),null;case 4:return un(),m===null&&f0(v.stateNode.containerInfo),ga(v),null;case 10:return cc(v.type),ga(v),null;case 19:if(mt(Qa),G=v.memoizedState,G===null)return ga(v),null;if(k=(v.flags&128)!==0,ee=G.rendering,ee===null)if(k)ro(G,!1);else{if(ti!==0||m!==null&&(m.flags&128)!==0)for(m=v.child;m!==null;){if(ee=gc(m),ee!==null){for(v.flags|=128,ro(G,!1),m=ee.updateQueue,v.updateQueue=m,zf(v,m),v.subtreeFlags=0,m=C,C=v.child;C!==null;)Ki(C,m),C=C.sibling;return It(Qa,Qa.current&1|2),v.child}m=m.sibling}G.tail!==null&&Ci()>za&&(v.flags|=128,k=!0,ro(G,!1),v.lanes=4194304)}else{if(!k)if(m=gc(ee),m!==null){if(v.flags|=128,k=!0,m=m.updateQueue,v.updateQueue=m,zf(v,m),ro(G,!0),G.tail===null&&G.tailMode==="hidden"&&!ee.alternate&&!Hi)return ga(v),null}else 2*Ci()-G.renderingStartTime>za&&C!==536870912&&(v.flags|=128,k=!0,ro(G,!1),v.lanes=4194304);G.isBackwards?(ee.sibling=v.child,v.child=ee):(m=G.last,m!==null?m.sibling=ee:v.child=ee,G.last=ee)}return G.tail!==null?(v=G.tail,G.rendering=v,G.tail=v.sibling,G.renderingStartTime=Ci(),v.sibling=null,m=Qa.current,It(Qa,k?m&1|2:m&1),v):(ga(v),null);case 22:case 23:return mc(v),Bp(),k=v.memoizedState!==null,m!==null?m.memoizedState!==null!==k&&(v.flags|=8192):k&&(v.flags|=8192),k?(C&536870912)!==0&&(v.flags&128)===0&&(ga(v),v.subtreeFlags&6&&(v.flags|=8192)):ga(v),C=v.updateQueue,C!==null&&zf(v,C.retryQueue),C=null,m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(C=m.memoizedState.cachePool.pool),k=null,v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(k=v.memoizedState.cachePool.pool),k!==C&&(v.flags|=2048),m!==null&&mt(gh),null;case 24:return C=null,m!==null&&(C=m.memoizedState.cache),v.memoizedState.cache!==C&&(v.flags|=2048),cc($a),ga(v),null;case 25:return null;case 30:return null}throw Error(r(156,v.tag))}function Lf(m,v){switch(mf(v),v.tag){case 1:return m=v.flags,m&65536?(v.flags=m&-65537|128,v):null;case 3:return cc($a),un(),m=v.flags,(m&65536)!==0&&(m&128)===0?(v.flags=m&-65537|128,v):null;case 26:case 27:case 5:return hr(v),null;case 13:if(mc(v),m=v.memoizedState,m!==null&&m.dehydrated!==null){if(v.alternate===null)throw Error(r(340));yf()}return m=v.flags,m&65536?(v.flags=m&-65537|128,v):null;case 19:return mt(Qa),null;case 4:return un(),null;case 10:return cc(v.type),null;case 22:case 23:return mc(v),Bp(),m!==null&&mt(gh),m=v.flags,m&65536?(v.flags=m&-65537|128,v):null;case 24:return cc($a),null;case 25:return null;default:return null}}function Fc(m,v){switch(mf(v),v.tag){case 3:cc($a),un();break;case 26:case 27:case 5:hr(v);break;case 4:un();break;case 13:mc(v);break;case 19:mt(Qa);break;case 10:cc(v.type);break;case 22:case 23:mc(v),Bp(),m!==null&&mt(gh);break;case 24:cc($a)}}function Ao(m,v){try{var C=v.updateQueue,k=C!==null?C.lastEffect:null;if(k!==null){var G=k.next;C=G;do{if((C.tag&m)===m){k=void 0;var ee=C.create,_e=C.inst;k=ee(),_e.destroy=k}C=C.next}while(C!==G)}}catch(Re){Pa(v,v.return,Re)}}function Ts(m,v,C){try{var k=v.updateQueue,G=k!==null?k.lastEffect:null;if(G!==null){var ee=G.next;k=ee;do{if((k.tag&m)===m){var _e=k.inst,Re=_e.destroy;if(Re!==void 0){_e.destroy=void 0,G=v;var at=C,Lt=Re;try{Lt()}catch(hn){Pa(G,at,hn)}}}k=k.next}while(k!==ee)}}catch(hn){Pa(v,v.return,hn)}}function vu(m){var v=m.updateQueue;if(v!==null){var C=m.stateNode;try{Qu(v,C)}catch(k){Pa(m,m.return,k)}}}function gd(m,v,C){C.props=yu(m.type,m.memoizedProps),C.state=m.memoizedState;try{C.componentWillUnmount()}catch(k){Pa(m,v,k)}}function x(m,v){try{var C=m.ref;if(C!==null){switch(m.tag){case 26:case 27:case 5:var k=m.stateNode;break;case 30:k=m.stateNode;break;default:k=m.stateNode}typeof C=="function"?m.refCleanup=C(k):C.current=k}}catch(G){Pa(m,v,G)}}function s(m,v){var C=m.ref,k=m.refCleanup;if(C!==null)if(typeof k=="function")try{k()}catch(G){Pa(m,v,G)}finally{m.refCleanup=null,m=m.alternate,m!=null&&(m.refCleanup=null)}else if(typeof C=="function")try{C(null)}catch(G){Pa(m,v,G)}else C.current=null}function u(m){var v=m.type,C=m.memoizedProps,k=m.stateNode;try{e:switch(v){case"button":case"input":case"select":case"textarea":C.autoFocus&&k.focus();break e;case"img":C.src?k.src=C.src:C.srcSet&&(k.srcset=C.srcSet)}}catch(G){Pa(m,m.return,G)}}function y(m,v,C){try{var k=m.stateNode;sv(k,m.type,C,v),k[Me]=v}catch(G){Pa(m,m.return,G)}}function S(m){return m.tag===5||m.tag===3||m.tag===26||m.tag===27&&Rh(m.type)||m.tag===4}function A(m){e:for(;;){for(;m.sibling===null;){if(m.return===null||S(m.return))return null;m=m.return}for(m.sibling.return=m.return,m=m.sibling;m.tag!==5&&m.tag!==6&&m.tag!==18;){if(m.tag===27&&Rh(m.type)||m.flags&2||m.child===null||m.tag===4)continue e;m.child.return=m,m=m.child}if(!(m.flags&2))return m.stateNode}}function M(m,v,C){var k=m.tag;if(k===5||k===6)m=m.stateNode,v?(C.nodeType===9?C.body:C.nodeName==="HTML"?C.ownerDocument.body:C).insertBefore(m,v):(v=C.nodeType===9?C.body:C.nodeName==="HTML"?C.ownerDocument.body:C,v.appendChild(m),C=C._reactRootContainer,C!=null||v.onclick!==null||(v.onclick=m0));else if(k!==4&&(k===27&&Rh(m.type)&&(C=m.stateNode,v=null),m=m.child,m!==null))for(M(m,v,C),m=m.sibling;m!==null;)M(m,v,C),m=m.sibling}function D(m,v,C){var k=m.tag;if(k===5||k===6)m=m.stateNode,v?C.insertBefore(m,v):C.appendChild(m);else if(k!==4&&(k===27&&Rh(m.type)&&(C=m.stateNode),m=m.child,m!==null))for(D(m,v,C),m=m.sibling;m!==null;)D(m,v,C),m=m.sibling}function z(m){var v=m.stateNode,C=m.memoizedProps;try{for(var k=m.type,G=v.attributes;G.length;)v.removeAttributeNode(G[0]);Fs(v,k,C),v[ye]=m,v[Me]=C}catch(ee){Pa(m,m.return,ee)}}var U=!1,H=!1,K=!1,X=typeof WeakSet=="function"?WeakSet:Set,J=null;function de(m,v){if(m=m.containerInfo,e1=_v,m=ru(m),Ex(m)){if("selectionStart"in m)var C={start:m.selectionStart,end:m.selectionEnd};else e:{C=(C=m.ownerDocument)&&C.defaultView||window;var k=C.getSelection&&C.getSelection();if(k&&k.rangeCount!==0){C=k.anchorNode;var G=k.anchorOffset,ee=k.focusNode;k=k.focusOffset;try{C.nodeType,ee.nodeType}catch{C=null;break e}var _e=0,Re=-1,at=-1,Lt=0,hn=0,En=m,Ht=null;t:for(;;){for(var Wt;En!==C||G!==0&&En.nodeType!==3||(Re=_e+G),En!==ee||k!==0&&En.nodeType!==3||(at=_e+k),En.nodeType===3&&(_e+=En.nodeValue.length),(Wt=En.firstChild)!==null;)Ht=En,En=Wt;for(;;){if(En===m)break t;if(Ht===C&&++Lt===G&&(Re=_e),Ht===ee&&++hn===k&&(at=_e),(Wt=En.nextSibling)!==null)break;En=Ht,Ht=En.parentNode}En=Wt}C=Re===-1||at===-1?null:{start:Re,end:at}}else C=null}C=C||{start:0,end:0}}else C=null;for(ov={focusedElem:m,selectionRange:C},_v=!1,J=v;J!==null;)if(v=J,m=v.child,(v.subtreeFlags&1024)!==0&&m!==null)m.return=v,J=m;else for(;J!==null;){switch(v=J,ee=v.alternate,m=v.flags,v.tag){case 0:break;case 11:case 15:break;case 1:if((m&1024)!==0&&ee!==null){m=void 0,C=v,G=ee.memoizedProps,ee=ee.memoizedState,k=C.stateNode;try{var ni=yu(C.type,G,C.elementType===C.type);m=k.getSnapshotBeforeUpdate(ni,ee),k.__reactInternalSnapshotBeforeUpdate=m}catch(Gr){Pa(C,C.return,Gr)}}break;case 3:if((m&1024)!==0){if(m=v.stateNode.containerInfo,C=m.nodeType,C===9)yd(m);else if(C===1)switch(m.nodeName){case"HEAD":case"HTML":case"BODY":yd(m);break;default:m.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((m&1024)!==0)throw Error(r(163))}if(m=v.sibling,m!==null){m.return=v.return,J=m;break}J=v.return}}function ce(m,v,C){var k=C.flags;switch(C.tag){case 0:case 11:case 15:_t(m,C),k&4&&Ao(5,C);break;case 1:if(_t(m,C),k&4)if(m=C.stateNode,v===null)try{m.componentDidMount()}catch(_e){Pa(C,C.return,_e)}else{var G=yu(C.type,v.memoizedProps);v=v.memoizedState;try{m.componentDidUpdate(G,v,m.__reactInternalSnapshotBeforeUpdate)}catch(_e){Pa(C,C.return,_e)}}k&64&&vu(C),k&512&&x(C,C.return);break;case 3:if(_t(m,C),k&64&&(m=C.updateQueue,m!==null)){if(v=null,C.child!==null)switch(C.child.tag){case 27:case 5:v=C.child.stateNode;break;case 1:v=C.child.stateNode}try{Qu(m,v)}catch(_e){Pa(C,C.return,_e)}}break;case 27:v===null&&k&4&&z(C);case 26:case 5:_t(m,C),v===null&&k&4&&u(C),k&512&&x(C,C.return);break;case 12:_t(m,C);break;case 13:_t(m,C),k&4&&ze(m,C),k&64&&(m=C.memoizedState,m!==null&&(m=m.dehydrated,m!==null&&(C=eA.bind(null,C),y2(m,C))));break;case 22:if(k=C.memoizedState!==null||U,!k){v=v!==null&&v.memoizedState!==null||H,G=U;var ee=H;U=k,(H=v)&&!ee?Bt(m,C,(C.subtreeFlags&8772)!==0):_t(m,C),U=G,H=ee}break;case 30:break;default:_t(m,C)}}function fe(m){var v=m.alternate;v!==null&&(m.alternate=null,fe(v)),m.child=null,m.deletions=null,m.sibling=null,m.tag===5&&(v=m.stateNode,v!==null&&Xe(v)),m.stateNode=null,m.return=null,m.dependencies=null,m.memoizedProps=null,m.memoizedState=null,m.pendingProps=null,m.stateNode=null,m.updateQueue=null}var ue=null,ve=!1;function Ee(m,v,C){for(C=C.child;C!==null;)Pe(m,v,C),C=C.sibling}function Pe(m,v,C){if(Qn&&typeof Qn.onCommitFiberUnmount=="function")try{Qn.onCommitFiberUnmount(tr,C)}catch{}switch(C.tag){case 26:H||s(C,v),Ee(m,v,C),C.memoizedState?C.memoizedState.count--:C.stateNode&&(C=C.stateNode,C.parentNode.removeChild(C));break;case 27:H||s(C,v);var k=ue,G=ve;Rh(C.type)&&(ue=C.stateNode,ve=!1),Ee(m,v,C),fm(C.stateNode),ue=k,ve=G;break;case 5:H||s(C,v);case 6:if(k=ue,G=ve,ue=null,Ee(m,v,C),ue=k,ve=G,ue!==null)if(ve)try{(ue.nodeType===9?ue.body:ue.nodeName==="HTML"?ue.ownerDocument.body:ue).removeChild(C.stateNode)}catch(ee){Pa(C,v,ee)}else try{ue.removeChild(C.stateNode)}catch(ee){Pa(C,v,ee)}break;case 18:ue!==null&&(ve?(m=ue,n1(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,C.stateNode),Dg(m)):n1(ue,C.stateNode));break;case 4:k=ue,G=ve,ue=C.stateNode.containerInfo,ve=!0,Ee(m,v,C),ue=k,ve=G;break;case 0:case 11:case 14:case 15:H||Ts(2,C,v),H||Ts(4,C,v),Ee(m,v,C);break;case 1:H||(s(C,v),k=C.stateNode,typeof k.componentWillUnmount=="function"&&gd(C,v,k)),Ee(m,v,C);break;case 21:Ee(m,v,C);break;case 22:H=(k=H)||C.memoizedState!==null,Ee(m,v,C),H=k;break;default:Ee(m,v,C)}}function ze(m,v){if(v.memoizedState===null&&(m=v.alternate,m!==null&&(m=m.memoizedState,m!==null&&(m=m.dehydrated,m!==null))))try{Dg(m)}catch(C){Pa(v,v.return,C)}}function Ie(m){switch(m.tag){case 13:case 19:var v=m.stateNode;return v===null&&(v=m.stateNode=new X),v;case 22:return m=m.stateNode,v=m._retryCache,v===null&&(v=m._retryCache=new X),v;default:throw Error(r(435,m.tag))}}function Oe(m,v){var C=Ie(m);v.forEach(function(k){var G=l2.bind(null,m,k);C.has(k)||(C.add(k),k.then(G,G))})}function Ce(m,v){var C=v.deletions;if(C!==null)for(var k=0;k<C.length;k++){var G=C[k],ee=m,_e=v,Re=_e;e:for(;Re!==null;){switch(Re.tag){case 27:if(Rh(Re.type)){ue=Re.stateNode,ve=!1;break e}break;case 5:ue=Re.stateNode,ve=!1;break e;case 3:case 4:ue=Re.stateNode.containerInfo,ve=!0;break e}Re=Re.return}if(ue===null)throw Error(r(160));Pe(ee,_e,G),ue=null,ve=!1,ee=G.alternate,ee!==null&&(ee.return=null),G.return=null}if(v.subtreeFlags&13878)for(v=v.child;v!==null;)$e(v,m),v=v.sibling}var Fe=null;function $e(m,v){var C=m.alternate,k=m.flags;switch(m.tag){case 0:case 11:case 14:case 15:Ce(v,m),st(m),k&4&&(Ts(3,m,m.return),Ao(3,m),Ts(5,m,m.return));break;case 1:Ce(v,m),st(m),k&512&&(H||C===null||s(C,C.return)),k&64&&U&&(m=m.updateQueue,m!==null&&(k=m.callbacks,k!==null&&(C=m.shared.hiddenCallbacks,m.shared.hiddenCallbacks=C===null?k:C.concat(k))));break;case 26:var G=Fe;if(Ce(v,m),st(m),k&512&&(H||C===null||s(C,C.return)),k&4){var ee=C!==null?C.memoizedState:null;if(k=m.memoizedState,C===null)if(k===null)if(m.stateNode===null){e:{k=m.type,C=m.memoizedProps,G=G.ownerDocument||G;t:switch(k){case"title":ee=G.getElementsByTagName("title")[0],(!ee||ee[it]||ee[ye]||ee.namespaceURI==="http://www.w3.org/2000/svg"||ee.hasAttribute("itemprop"))&&(ee=G.createElement(k),G.head.insertBefore(ee,G.querySelector("head > title"))),Fs(ee,k,C),ee[ye]=m,zn(ee),k=ee;break e;case"link":var _e=w2("link","href",G).get(k+(C.href||""));if(_e){for(var Re=0;Re<_e.length;Re++)if(ee=_e[Re],ee.getAttribute("href")===(C.href==null||C.href===""?null:C.href)&&ee.getAttribute("rel")===(C.rel==null?null:C.rel)&&ee.getAttribute("title")===(C.title==null?null:C.title)&&ee.getAttribute("crossorigin")===(C.crossOrigin==null?null:C.crossOrigin)){_e.splice(Re,1);break t}}ee=G.createElement(k),Fs(ee,k,C),G.head.appendChild(ee);break;case"meta":if(_e=w2("meta","content",G).get(k+(C.content||""))){for(Re=0;Re<_e.length;Re++)if(ee=_e[Re],ee.getAttribute("content")===(C.content==null?null:""+C.content)&&ee.getAttribute("name")===(C.name==null?null:C.name)&&ee.getAttribute("property")===(C.property==null?null:C.property)&&ee.getAttribute("http-equiv")===(C.httpEquiv==null?null:C.httpEquiv)&&ee.getAttribute("charset")===(C.charSet==null?null:C.charSet)){_e.splice(Re,1);break t}}ee=G.createElement(k),Fs(ee,k,C),G.head.appendChild(ee);break;default:throw Error(r(468,k))}ee[ye]=m,zn(ee),k=ee}m.stateNode=k}else S2(G,m.type,m.stateNode);else m.stateNode=d1(G,k,m.memoizedProps);else ee!==k?(ee===null?C.stateNode!==null&&(C=C.stateNode,C.parentNode.removeChild(C)):ee.count--,k===null?S2(G,m.type,m.stateNode):d1(G,k,m.memoizedProps)):k===null&&m.stateNode!==null&&y(m,m.memoizedProps,C.memoizedProps)}break;case 27:Ce(v,m),st(m),k&512&&(H||C===null||s(C,C.return)),C!==null&&k&4&&y(m,m.memoizedProps,C.memoizedProps);break;case 5:if(Ce(v,m),st(m),k&512&&(H||C===null||s(C,C.return)),m.flags&32){G=m.stateNode;try{Oo(G,"")}catch(Wt){Pa(m,m.return,Wt)}}k&4&&m.stateNode!=null&&(G=m.memoizedProps,y(m,G,C!==null?C.memoizedProps:G)),k&1024&&(K=!0);break;case 6:if(Ce(v,m),st(m),k&4){if(m.stateNode===null)throw Error(r(162));k=m.memoizedProps,C=m.stateNode;try{C.nodeValue=k}catch(Wt){Pa(m,m.return,Wt)}}break;case 3:if(gv=null,G=Fe,Fe=x0(v.containerInfo),Ce(v,m),Fe=G,st(m),k&4&&C!==null&&C.memoizedState.isDehydrated)try{Dg(v.containerInfo)}catch(Wt){Pa(m,m.return,Wt)}K&&(K=!1,et(m));break;case 4:k=Fe,Fe=x0(m.stateNode.containerInfo),Ce(v,m),st(m),Fe=k;break;case 12:Ce(v,m),st(m);break;case 13:Ce(v,m),st(m),m.child.flags&8192&&m.memoizedState!==null!=(C!==null&&C.memoizedState!==null)&&(Di=Ci()),k&4&&(k=m.updateQueue,k!==null&&(m.updateQueue=null,Oe(m,k)));break;case 22:G=m.memoizedState!==null;var at=C!==null&&C.memoizedState!==null,Lt=U,hn=H;if(U=Lt||G,H=hn||at,Ce(v,m),H=hn,U=Lt,st(m),k&8192)e:for(v=m.stateNode,v._visibility=G?v._visibility&-2:v._visibility|1,G&&(C===null||at||U||H||xt(m)),C=null,v=m;;){if(v.tag===5||v.tag===26){if(C===null){at=C=v;try{if(ee=at.stateNode,G)_e=ee.style,typeof _e.setProperty=="function"?_e.setProperty("display","none","important"):_e.display="none";else{Re=at.stateNode;var En=at.memoizedProps.style,Ht=En!=null&&En.hasOwnProperty("display")?En.display:null;Re.style.display=Ht==null||typeof Ht=="boolean"?"":(""+Ht).trim()}}catch(Wt){Pa(at,at.return,Wt)}}}else if(v.tag===6){if(C===null){at=v;try{at.stateNode.nodeValue=G?"":at.memoizedProps}catch(Wt){Pa(at,at.return,Wt)}}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===m)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===m)break e;for(;v.sibling===null;){if(v.return===null||v.return===m)break e;C===v&&(C=null),v=v.return}C===v&&(C=null),v.sibling.return=v.return,v=v.sibling}k&4&&(k=m.updateQueue,k!==null&&(C=k.retryQueue,C!==null&&(k.retryQueue=null,Oe(m,C))));break;case 19:Ce(v,m),st(m),k&4&&(k=m.updateQueue,k!==null&&(m.updateQueue=null,Oe(m,k)));break;case 30:break;case 21:break;default:Ce(v,m),st(m)}}function st(m){var v=m.flags;if(v&2){try{for(var C,k=m.return;k!==null;){if(S(k)){C=k;break}k=k.return}if(C==null)throw Error(r(160));switch(C.tag){case 27:var G=C.stateNode,ee=A(m);D(m,ee,G);break;case 5:var _e=C.stateNode;C.flags&32&&(Oo(_e,""),C.flags&=-33);var Re=A(m);D(m,Re,_e);break;case 3:case 4:var at=C.stateNode.containerInfo,Lt=A(m);M(m,Lt,at);break;default:throw Error(r(161))}}catch(hn){Pa(m,m.return,hn)}m.flags&=-3}v&4096&&(m.flags&=-4097)}function et(m){if(m.subtreeFlags&1024)for(m=m.child;m!==null;){var v=m;et(v),v.tag===5&&v.flags&1024&&v.stateNode.reset(),m=m.sibling}}function _t(m,v){if(v.subtreeFlags&8772)for(v=v.child;v!==null;)ce(m,v.alternate,v),v=v.sibling}function xt(m){for(m=m.child;m!==null;){var v=m;switch(v.tag){case 0:case 11:case 14:case 15:Ts(4,v,v.return),xt(v);break;case 1:s(v,v.return);var C=v.stateNode;typeof C.componentWillUnmount=="function"&&gd(v,v.return,C),xt(v);break;case 27:fm(v.stateNode);case 26:case 5:s(v,v.return),xt(v);break;case 22:v.memoizedState===null&&xt(v);break;case 30:xt(v);break;default:xt(v)}m=m.sibling}}function Bt(m,v,C){for(C=C&&(v.subtreeFlags&8772)!==0,v=v.child;v!==null;){var k=v.alternate,G=m,ee=v,_e=ee.flags;switch(ee.tag){case 0:case 11:case 15:Bt(G,ee,C),Ao(4,ee);break;case 1:if(Bt(G,ee,C),k=ee,G=k.stateNode,typeof G.componentDidMount=="function")try{G.componentDidMount()}catch(Lt){Pa(k,k.return,Lt)}if(k=ee,G=k.updateQueue,G!==null){var Re=k.stateNode;try{var at=G.shared.hiddenCallbacks;if(at!==null)for(G.shared.hiddenCallbacks=null,G=0;G<at.length;G++)Fp(at[G],Re)}catch(Lt){Pa(k,k.return,Lt)}}C&&_e&64&&vu(ee),x(ee,ee.return);break;case 27:z(ee);case 26:case 5:Bt(G,ee,C),C&&k===null&&_e&4&&u(ee),x(ee,ee.return);break;case 12:Bt(G,ee,C);break;case 13:Bt(G,ee,C),C&&_e&4&&ze(G,ee);break;case 22:ee.memoizedState===null&&Bt(G,ee,C),x(ee,ee.return);break;case 30:break;default:Bt(G,ee,C)}v=v.sibling}}function Je(m,v){var C=null;m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(C=m.memoizedState.cachePool.pool),m=null,v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(m=v.memoizedState.cachePool.pool),m!==C&&(m!=null&&m.refCount++,C!=null&&Zu(C))}function lt(m,v){m=null,v.alternate!==null&&(m=v.alternate.memoizedState.cache),v=v.memoizedState.cache,v!==m&&(v.refCount++,m!=null&&Zu(m))}function Ke(m,v,C,k){if(v.subtreeFlags&10256)for(v=v.child;v!==null;)Et(m,v,C,k),v=v.sibling}function Et(m,v,C,k){var G=v.flags;switch(v.tag){case 0:case 11:case 15:Ke(m,v,C,k),G&2048&&Ao(9,v);break;case 1:Ke(m,v,C,k);break;case 3:Ke(m,v,C,k),G&2048&&(m=null,v.alternate!==null&&(m=v.alternate.memoizedState.cache),v=v.memoizedState.cache,v!==m&&(v.refCount++,m!=null&&Zu(m)));break;case 12:if(G&2048){Ke(m,v,C,k),m=v.stateNode;try{var ee=v.memoizedProps,_e=ee.id,Re=ee.onPostCommit;typeof Re=="function"&&Re(_e,v.alternate===null?"mount":"update",m.passiveEffectDuration,-0)}catch(at){Pa(v,v.return,at)}}else Ke(m,v,C,k);break;case 13:Ke(m,v,C,k);break;case 23:break;case 22:ee=v.stateNode,_e=v.alternate,v.memoizedState!==null?ee._visibility&2?Ke(m,v,C,k):Dt(m,v):ee._visibility&2?Ke(m,v,C,k):(ee._visibility|=2,ct(m,v,C,k,(v.subtreeFlags&10256)!==0)),G&2048&&Je(_e,v);break;case 24:Ke(m,v,C,k),G&2048&&lt(v.alternate,v);break;default:Ke(m,v,C,k)}}function ct(m,v,C,k,G){for(G=G&&(v.subtreeFlags&10256)!==0,v=v.child;v!==null;){var ee=m,_e=v,Re=C,at=k,Lt=_e.flags;switch(_e.tag){case 0:case 11:case 15:ct(ee,_e,Re,at,G),Ao(8,_e);break;case 23:break;case 22:var hn=_e.stateNode;_e.memoizedState!==null?hn._visibility&2?ct(ee,_e,Re,at,G):Dt(ee,_e):(hn._visibility|=2,ct(ee,_e,Re,at,G)),G&&Lt&2048&&Je(_e.alternate,_e);break;case 24:ct(ee,_e,Re,at,G),G&&Lt&2048&&lt(_e.alternate,_e);break;default:ct(ee,_e,Re,at,G)}v=v.sibling}}function Dt(m,v){if(v.subtreeFlags&10256)for(v=v.child;v!==null;){var C=m,k=v,G=k.flags;switch(k.tag){case 22:Dt(C,k),G&2048&&Je(k.alternate,k);break;case 24:Dt(C,k),G&2048&&lt(k.alternate,k);break;default:Dt(C,k)}v=v.sibling}}var wt=8192;function Ot(m){if(m.subtreeFlags&wt)for(m=m.child;m!==null;)zt(m),m=m.sibling}function zt(m){switch(m.tag){case 26:Ot(m),m.flags&wt&&m.memoizedState!==null&&T2(Fe,m.memoizedState,m.memoizedProps);break;case 5:Ot(m);break;case 3:case 4:var v=Fe;Fe=x0(m.stateNode.containerInfo),Ot(m),Fe=v;break;case 22:m.memoizedState===null&&(v=m.alternate,v!==null&&v.memoizedState!==null?(v=wt,wt=16777216,Ot(m),wt=v):Ot(m));break;default:Ot(m)}}function yn(m){var v=m.alternate;if(v!==null&&(m=v.child,m!==null)){v.child=null;do v=m.sibling,m.sibling=null,m=v;while(m!==null)}}function Tn(m){var v=m.deletions;if((m.flags&16)!==0){if(v!==null)for(var C=0;C<v.length;C++){var k=v[C];J=k,Sn(k,m)}yn(m)}if(m.subtreeFlags&10256)for(m=m.child;m!==null;)gn(m),m=m.sibling}function gn(m){switch(m.tag){case 0:case 11:case 15:Tn(m),m.flags&2048&&Ts(9,m,m.return);break;case 3:Tn(m);break;case 12:Tn(m);break;case 22:var v=m.stateNode;m.memoizedState!==null&&v._visibility&2&&(m.return===null||m.return.tag!==13)?(v._visibility&=-3,Pn(m)):Tn(m);break;default:Tn(m)}}function Pn(m){var v=m.deletions;if((m.flags&16)!==0){if(v!==null)for(var C=0;C<v.length;C++){var k=v[C];J=k,Sn(k,m)}yn(m)}for(m=m.child;m!==null;){switch(v=m,v.tag){case 0:case 11:case 15:Ts(8,v,v.return),Pn(v);break;case 22:C=v.stateNode,C._visibility&2&&(C._visibility&=-3,Pn(v));break;default:Pn(v)}m=m.sibling}}function Sn(m,v){for(;J!==null;){var C=J;switch(C.tag){case 0:case 11:case 15:Ts(8,C,v);break;case 23:case 22:if(C.memoizedState!==null&&C.memoizedState.cachePool!==null){var k=C.memoizedState.cachePool.pool;k!=null&&k.refCount++}break;case 24:Zu(C.memoizedState.cache)}if(k=C.child,k!==null)k.return=C,J=k;else e:for(C=m;J!==null;){k=J;var G=k.sibling,ee=k.return;if(fe(k),k===C){J=null;break e}if(G!==null){G.return=ee,J=G;break e}J=ee}}}var qn={getCacheForType:function(m){var v=Ya($a),C=v.data.get(m);return C===void 0&&(C=m(),v.data.set(m,C)),C}},ir=typeof WeakMap=="function"?WeakMap:Map,$n=0,ur=null,Yn=null,Bn=0,Tr=0,ei=null,ar=!1,Er=!1,Fr=!1,Ur=0,ti=0,Pi=0,ta=0,Ni=0,rr=0,_i=0,kr=null,qr=null,Hr=!1,Di=0,za=1/0,bi=null,xa=null,di=0,Sa=null,io=null,Ho=0,ao=0,Go=null,xc=null,Wo=0,ul=null;function Es(){if(($n&2)!==0&&Bn!==0)return Bn&-Bn;if(He.T!==null){var m=Xu;return m!==0?m:Q_()}return Te()}function xd(){rr===0&&(rr=(Bn&536870912)===0||Hi?Is():536870912);var m=qo.current;return m!==null&&(m.flags|=32),rr}function so(m,v,C){(m===ur&&(Tr===2||Tr===9)||m.cancelPendingCommit!==null)&&(sm(m,0),hi(m,Bn,rr,!1)),Kl(m,C),(($n&2)===0||m!==ur)&&(m===ur&&(($n&2)===0&&(ta|=C),ti===4&&hi(m,Bn,rr,!1)),Su(m))}function nm(m,v,C){if(($n&6)!==0)throw Error(r(327));var k=!C&&(v&124)===0&&(v&m.expiredLanes)===0||vs(m,v),G=k?Xy(m,v):Zy(m,v,!0),ee=k;do{if(G===0){Er&&!k&&hi(m,v,0,!1);break}else{if(C=m.current.alternate,ee&&!im(C)){G=Zy(m,v,!1),ee=!1;continue}if(G===2){if(ee=v,m.errorRecoveryDisabledLanes&ee)var _e=0;else _e=m.pendingLanes&-536870913,_e=_e!==0?_e:_e&536870912?536870912:0;if(_e!==0){v=_e;e:{var Re=m;G=kr;var at=Re.current.memoizedState.isDehydrated;if(at&&(sm(Re,_e).flags|=256),_e=Zy(Re,_e,!1),_e!==2){if(Fr&&!at){Re.errorRecoveryDisabledLanes|=ee,ta|=ee,G=4;break e}ee=qr,qr=G,ee!==null&&(qr===null?qr=ee:qr.push.apply(qr,ee))}G=_e}if(ee=!1,G!==2)continue}}if(G===1){sm(m,0),hi(m,v,0,!0);break}e:{switch(k=m,ee=G,ee){case 0:case 1:throw Error(r(345));case 4:if((v&4194048)!==v)break;case 6:hi(k,v,rr,!ar);break e;case 2:qr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((v&62914560)===v&&(G=Di+300-Ci(),10<G)){if(hi(k,v,rr,!ar),Os(k,0,!0)!==0)break e;k.timeoutHandle=dv(rm.bind(null,k,C,qr,bi,Hr,v,rr,ta,_i,ar,ee,2,-0,0),G);break e}rm(k,C,qr,bi,Hr,v,rr,ta,_i,ar,ee,0,-0,0)}}break}while(!0);Su(m)}function rm(m,v,C,k,G,ee,_e,Re,at,Lt,hn,En,Ht,Wt){if(m.timeoutHandle=-1,En=v.subtreeFlags,(En&8192||(En&16785408)===16785408)&&(Cg={stylesheets:null,count:0,unsuspend:xv},zt(v),En=p1(),En!==null)){m.cancelPendingCommit=En(Yy.bind(null,m,v,ee,C,k,G,_e,Re,at,hn,1,Ht,Wt)),hi(m,ee,_e,!Lt);return}Yy(m,v,ee,C,k,G,_e,Re,at)}function im(m){for(var v=m;;){var C=v.tag;if((C===0||C===11||C===15)&&v.flags&16384&&(C=v.updateQueue,C!==null&&(C=C.stores,C!==null)))for(var k=0;k<C.length;k++){var G=C[k],ee=G.getSnapshot;G=G.value;try{if(!nl(ee(),G))return!1}catch{return!1}}if(C=v.child,v.subtreeFlags&16384&&C!==null)C.return=v,v=C;else{if(v===m)break;for(;v.sibling===null;){if(v.return===null||v.return===m)return!0;v=v.return}v.sibling.return=v.return,v=v.sibling}}return!0}function hi(m,v,C,k){v&=~Ni,v&=~ta,m.suspendedLanes|=v,m.pingedLanes&=~v,k&&(m.warmLanes|=v),k=m.expirationTimes;for(var G=v;0<G;){var ee=31-pi(G),_e=1<<ee;k[ee]=-1,G&=~_e}C!==0&&Yl(m,C,v)}function _u(){return($n&6)===0?(wg(0),!1):!0}function am(){if(Yn!==null){if(Tr===0)var m=Yn.return;else m=Yn,cu=lu=null,zx(m),Eo=null,sl=0,m=Yn;for(;m!==null;)Fc(m.alternate,m),m=m.return;Yn=null}}function sm(m,v){var C=m.timeoutHandle;C!==-1&&(m.timeoutHandle=-1,m2(C)),C=m.cancelPendingCommit,C!==null&&(m.cancelPendingCommit=null,C()),am(),ur=m,Yn=C=ac(m.current,null),Bn=v,Tr=0,ei=null,ar=!1,Er=vs(m,v),Fr=!1,_i=rr=Ni=ta=Pi=ti=0,qr=kr=null,Hr=!1,(v&8)!==0&&(v|=v&32);var k=m.entangledLanes;if(k!==0)for(m=m.entanglements,k&=v;0<k;){var G=31-pi(k),ee=1<<G;v|=m[G],k&=~ee}return Ur=v,iu(),C}function i2(m,v){si=null,He.H=Ah,v===Rp||v===Tf?(v=sg(),Tr=3):v===Fy?(v=sg(),Tr=4):Tr=v===Yx?8:v!==null&&typeof v=="object"&&typeof v.then=="function"?6:1,ei=v,Yn===null&&(ti=1,Nh(m,xo(v,m.current)))}function Wy(){var m=He.H;return He.H=Ah,m===null?Ah:m}function bu(){var m=He.A;return He.A=qn,m}function wu(){ti=4,ar||(Bn&4194048)!==Bn&&qo.current!==null||(Er=!0),(Pi&134217727)===0&&(ta&134217727)===0||ur===null||hi(ur,Bn,rr,!1)}function Zy(m,v,C){var k=$n;$n|=2;var G=Wy(),ee=bu();(ur!==m||Bn!==v)&&(bi=null,sm(m,v)),v=!1;var _e=ti;e:do try{if(Tr!==0&&Yn!==null){var Re=Yn,at=ei;switch(Tr){case 8:am(),_e=6;break e;case 3:case 2:case 9:case 6:qo.current===null&&(v=!0);var Lt=Tr;if(Tr=0,ei=null,om(m,Re,at,Lt),C&&Er){_e=0;break e}break;default:Lt=Tr,Tr=0,ei=null,om(m,Re,at,Lt)}}a2(),_e=ti;break}catch(hn){i2(m,hn)}while(!0);return v&&m.shellSuspendCounter++,cu=lu=null,$n=k,He.H=G,He.A=ee,Yn===null&&(ur=null,Bn=0,iu()),_e}function a2(){for(;Yn!==null;)_g(Yn)}function Xy(m,v){var C=$n;$n|=2;var k=Wy(),G=bu();ur!==m||Bn!==v?(bi=null,za=Ci()+500,sm(m,v)):Er=vs(m,v);e:do try{if(Tr!==0&&Yn!==null){v=Yn;var ee=ei;t:switch(Tr){case 1:Tr=0,ei=null,om(m,v,ee,1);break;case 2:case 9:if(Ix(ee)){Tr=0,ei=null,l0(v);break}v=function(){Tr!==2&&Tr!==9||ur!==m||(Tr=7),Su(m)},ee.then(v,v);break e;case 3:Tr=7;break e;case 4:Tr=5;break e;case 7:Ix(ee)?(Tr=0,ei=null,l0(v)):(Tr=0,ei=null,om(m,v,ee,7));break;case 5:var _e=null;switch(Yn.tag){case 26:_e=Yn.memoizedState;case 5:case 27:var Re=Yn;if(!_e||y0(_e)){Tr=0,ei=null;var at=Re.sibling;if(at!==null)Yn=at;else{var Lt=Re.return;Lt!==null?(Yn=Lt,lm(Lt)):Yn=null}break t}}Tr=0,ei=null,om(m,v,ee,5);break;case 6:Tr=0,ei=null,om(m,v,ee,6);break;case 8:am(),ti=6;break e;default:throw Error(r(462))}}$_();break}catch(hn){i2(m,hn)}while(!0);return cu=lu=null,He.H=k,He.A=G,$n=C,Yn!==null?0:(ur=null,Bn=0,iu(),ti)}function $_(){for(;Yn!==null&&!sa();)_g(Yn)}function _g(m){var v=Gy(m.alternate,m,Ur);m.memoizedProps=m.pendingProps,v===null?lm(m):Yn=v}function l0(m){var v=m,C=v.alternate;switch(v.tag){case 15:case 0:v=Wi(C,v,v.pendingProps,v.type,void 0,Bn);break;case 11:v=Wi(C,v,v.pendingProps,v.type.render,v.ref,Bn);break;case 5:zx(v);default:Fc(C,v),v=Yn=Ki(v,Ur),v=Gy(C,v,Ur)}m.memoizedProps=m.pendingProps,v===null?lm(m):Yn=v}function om(m,v,C,k){cu=lu=null,zx(v),Eo=null,sl=0;var G=v.return;try{if($y(m,G,v,C,Bn)){ti=1,Nh(m,xo(C,m.current)),Yn=null;return}}catch(ee){if(G!==null)throw Yn=G,ee;ti=1,Nh(m,xo(C,m.current)),Yn=null;return}v.flags&32768?(Hi||k===1?m=!0:Er||(Bn&536870912)!==0?m=!1:(ar=m=!0,(k===2||k===9||k===3||k===6)&&(k=qo.current,k!==null&&k.tag===13&&(k.flags|=16384))),Ky(v,m)):lm(v)}function lm(m){var v=m;do{if((v.flags&32768)!==0){Ky(v,ar);return}m=v.return;var C=tm(v.alternate,v,Ur);if(C!==null){Yn=C;return}if(v=v.sibling,v!==null){Yn=v;return}Yn=v=m}while(v!==null);ti===0&&(ti=5)}function Ky(m,v){do{var C=Lf(m.alternate,m);if(C!==null){C.flags&=32767,Yn=C;return}if(C=m.return,C!==null&&(C.flags|=32768,C.subtreeFlags=0,C.deletions=null),!v&&(m=m.sibling,m!==null)){Yn=m;return}Yn=m=C}while(m!==null);ti=6,Yn=null}function Yy(m,v,C,k,G,ee,_e,Re,at){m.cancelPendingCommit=null;do bg();while(di!==0);if(($n&6)!==0)throw Error(r(327));if(v!==null){if(v===m.current)throw Error(r(177));if(ee=v.lanes|v.childLanes,ee|=Bo,Hd(m,C,ee,_e,Re,at),m===ur&&(Yn=ur=null,Bn=0),io=v,Sa=m,Ho=C,ao=ee,Go=G,xc=k,(v.subtreeFlags&10256)!==0||(v.flags&10256)!==0?(m.callbackNode=null,m.callbackPriority=0,tA(Ds,function(){return W_(),null})):(m.callbackNode=null,m.callbackPriority=0),k=(v.flags&13878)!==0,(v.subtreeFlags&13878)!==0||k){k=He.T,He.T=null,G=ut.p,ut.p=2,_e=$n,$n|=4;try{de(m,v,C)}finally{$n=_e,ut.p=G,He.T=k}}di=1,q_(),H_(),Dh()}}function q_(){if(di===1){di=0;var m=Sa,v=io,C=(v.flags&13878)!==0;if((v.subtreeFlags&13878)!==0||C){C=He.T,He.T=null;var k=ut.p;ut.p=2;var G=$n;$n|=4;try{$e(v,m);var ee=ov,_e=ru(m.containerInfo),Re=ee.focusedElem,at=ee.selectionRange;if(_e!==Re&&Re&&Re.ownerDocument&&Ym(Re.ownerDocument.documentElement,Re)){if(at!==null&&Ex(Re)){var Lt=at.start,hn=at.end;if(hn===void 0&&(hn=Lt),"selectionStart"in Re)Re.selectionStart=Lt,Re.selectionEnd=Math.min(hn,Re.value.length);else{var En=Re.ownerDocument||document,Ht=En&&En.defaultView||window;if(Ht.getSelection){var Wt=Ht.getSelection(),ni=Re.textContent.length,Gr=Math.min(at.start,ni),Ea=at.end===void 0?Gr:Math.min(at.end,ni);!Wt.extend&&Gr>Ea&&(_e=Ea,Ea=Gr,Gr=_e);var At=nc(Re,Gr),gt=nc(Re,Ea);if(At&&gt&&(Wt.rangeCount!==1||Wt.anchorNode!==At.node||Wt.anchorOffset!==At.offset||Wt.focusNode!==gt.node||Wt.focusOffset!==gt.offset)){var Rt=En.createRange();Rt.setStart(At.node,At.offset),Wt.removeAllRanges(),Gr>Ea?(Wt.addRange(Rt),Wt.extend(gt.node,gt.offset)):(Rt.setEnd(gt.node,gt.offset),Wt.addRange(Rt))}}}}for(En=[],Wt=Re;Wt=Wt.parentNode;)Wt.nodeType===1&&En.push({element:Wt,left:Wt.scrollLeft,top:Wt.scrollTop});for(typeof Re.focus=="function"&&Re.focus(),Re=0;Re<En.length;Re++){var xn=En[Re];xn.element.scrollLeft=xn.left,xn.element.scrollTop=xn.top}}_v=!!e1,ov=e1=null}finally{$n=G,ut.p=k,He.T=C}}m.current=v,di=2}}function H_(){if(di===2){di=0;var m=Sa,v=io,C=(v.flags&8772)!==0;if((v.subtreeFlags&8772)!==0||C){C=He.T,He.T=null;var k=ut.p;ut.p=2;var G=$n;$n|=4;try{ce(m,v.alternate,v)}finally{$n=G,ut.p=k,He.T=C}}di=3}}function Dh(){if(di===4||di===3){di=0,Mi();var m=Sa,v=io,C=Ho,k=xc;(v.subtreeFlags&10256)!==0||(v.flags&10256)!==0?di=5:(di=0,io=Sa=null,G_(m,m.pendingLanes));var G=m.pendingLanes;if(G===0&&(xa=null),Fu(C),v=v.stateNode,Qn&&typeof Qn.onCommitFiberRoot=="function")try{Qn.onCommitFiberRoot(tr,v,void 0,(v.current.flags&128)===128)}catch{}if(k!==null){v=He.T,G=ut.p,ut.p=2,He.T=null;try{for(var ee=m.onRecoverableError,_e=0;_e<k.length;_e++){var Re=k[_e];ee(Re.value,{componentStack:Re.stack})}}finally{He.T=v,ut.p=G}}(Ho&3)!==0&&bg(),Su(m),G=m.pendingLanes,(C&4194090)!==0&&(G&42)!==0?m===ul?Wo++:(Wo=0,ul=m):Wo=0,wg(0)}}function G_(m,v){(m.pooledCacheLanes&=v)===0&&(v=m.pooledCache,v!=null&&(m.pooledCache=null,Zu(v)))}function bg(m){return q_(),H_(),Dh(),W_()}function W_(){if(di!==5)return!1;var m=Sa,v=ao;ao=0;var C=Fu(Ho),k=He.T,G=ut.p;try{ut.p=32>C?32:C,He.T=null,C=Go,Go=null;var ee=Sa,_e=Ho;if(di=0,io=Sa=null,Ho=0,($n&6)!==0)throw Error(r(331));var Re=$n;if($n|=4,gn(ee.current),Et(ee,ee.current,_e,C),$n=Re,wg(0,!1),Qn&&typeof Qn.onPostCommitFiberRoot=="function")try{Qn.onPostCommitFiberRoot(tr,ee)}catch{}return!0}finally{ut.p=G,He.T=k,G_(m,v)}}function s2(m,v,C){v=xo(C,v),v=If(m.stateNode,v,2),m=uc(m,v,2),m!==null&&(Kl(m,2),Su(m))}function Pa(m,v,C){if(m.tag===3)s2(m,m,C);else for(;v!==null;){if(v.tag===3){s2(v,m,C);break}else if(v.tag===1){var k=v.stateNode;if(typeof v.type.getDerivedStateFromError=="function"||typeof k.componentDidCatch=="function"&&(xa===null||!xa.has(k))){m=xo(C,m),C=Xx(2),k=uc(v,C,2),k!==null&&(Kx(C,k,v,m),Kl(k,2),Su(k));break}}v=v.return}}function Z_(m,v,C){var k=m.pingCache;if(k===null){k=m.pingCache=new ir;var G=new Set;k.set(v,G)}else G=k.get(v),G===void 0&&(G=new Set,k.set(v,G));G.has(C)||(Fr=!0,G.add(C),m=o2.bind(null,m,v,C),v.then(m,m))}function o2(m,v,C){var k=m.pingCache;k!==null&&k.delete(v),m.pingedLanes|=m.suspendedLanes&C,m.warmLanes&=~C,ur===m&&(Bn&C)===C&&(ti===4||ti===3&&(Bn&62914560)===Bn&&300>Ci()-Di?($n&2)===0&&sm(m,0):Ni|=C,_i===Bn&&(_i=0)),Su(m)}function X_(m,v){v===0&&(v=Yc()),m=jl(m,v),m!==null&&(Kl(m,v),Su(m))}function eA(m){var v=m.memoizedState,C=0;v!==null&&(C=v.retryLane),X_(m,C)}function l2(m,v){var C=0;switch(m.tag){case 13:var k=m.stateNode,G=m.memoizedState;G!==null&&(C=G.retryLane);break;case 19:k=m.stateNode;break;case 22:k=m.stateNode._retryCache;break;default:throw Error(r(314))}k!==null&&k.delete(v),X_(m,C)}function tA(m,v){return Ir(m,v)}var Qy=null,cm=null,Jy=!1,c0=!1,ev=!1,Ff=0;function Su(m){m!==cm&&m.next===null&&(cm===null?Qy=cm=m:cm=cm.next=m),c0=!0,Jy||(Jy=!0,nA())}function wg(m,v){if(!ev&&c0){ev=!0;do for(var C=!1,k=Qy;k!==null;){if(m!==0){var G=k.pendingLanes;if(G===0)var ee=0;else{var _e=k.suspendedLanes,Re=k.pingedLanes;ee=(1<<31-pi(42|m)+1)-1,ee&=G&~(_e&~Re),ee=ee&201326741?ee&201326741|1:ee?ee|2:0}ee!==0&&(C=!0,Sg(k,ee))}else ee=Bn,ee=Os(k,k===ur?ee:0,k.cancelPendingCommit!==null||k.timeoutHandle!==-1),(ee&3)===0||vs(k,ee)||(C=!0,Sg(k,ee));k=k.next}while(C);ev=!1}}function K_(){Oh()}function Oh(){c0=Jy=!1;var m=0;Ff!==0&&(p2()&&(m=Ff),Ff=0);for(var v=Ci(),C=null,k=Qy;k!==null;){var G=k.next,ee=hs(k,v);ee===0?(k.next=null,C===null?Qy=G:C.next=G,G===null&&(cm=C)):(C=k,(m!==0||(ee&3)!==0)&&(c0=!0)),k=G}wg(m)}function hs(m,v){for(var C=m.suspendedLanes,k=m.pingedLanes,G=m.expirationTimes,ee=m.pendingLanes&-62914561;0<ee;){var _e=31-pi(ee),Re=1<<_e,at=G[_e];at===-1?((Re&C)===0||(Re&k)!==0)&&(G[_e]=yi(Re,v)):at<=v&&(m.expiredLanes|=Re),ee&=~Re}if(v=ur,C=Bn,C=Os(m,m===v?C:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),k=m.callbackNode,C===0||m===v&&(Tr===2||Tr===9)||m.cancelPendingCommit!==null)return k!==null&&k!==null&&Zr(k),m.callbackNode=null,m.callbackPriority=0;if((C&3)===0||vs(m,C)){if(v=C&-C,v===m.callbackPriority)return v;switch(k!==null&&Zr(k),Fu(C)){case 2:case 8:C=Xa;break;case 32:C=Ds;break;case 268435456:C=Hn;break;default:C=Ds}return k=Y_.bind(null,m),C=Ir(C,k),m.callbackPriority=v,m.callbackNode=C,v}return k!==null&&k!==null&&Zr(k),m.callbackPriority=2,m.callbackNode=null,2}function Y_(m,v){if(di!==0&&di!==5)return m.callbackNode=null,m.callbackPriority=0,null;var C=m.callbackNode;if(bg()&&m.callbackNode!==C)return null;var k=Bn;return k=Os(m,m===ur?k:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),k===0?null:(nm(m,k,v),hs(m,Ci()),m.callbackNode!=null&&m.callbackNode===C?Y_.bind(null,m):null)}function Sg(m,v){if(bg())return null;nm(m,v,!0)}function nA(){hv(function(){($n&6)!==0?Ir(wa,K_):Oh()})}function Q_(){return Ff===0&&(Ff=Is()),Ff}function c2(m){return m==null||typeof m=="symbol"||typeof m=="boolean"?null:typeof m=="function"?m:Bu(""+m)}function u2(m,v){var C=v.ownerDocument.createElement("input");return C.name=v.name,C.value=v.value,m.id&&C.setAttribute("form",m.id),v.parentNode.insertBefore(C,v),m=new FormData(m),C.parentNode.removeChild(C),m}function u0(m,v,C,k,G){if(v==="submit"&&C&&C.stateNode===G){var ee=c2((G[Me]||null).action),_e=k.submitter;_e&&(v=(v=_e[Me]||null)?c2(v.formAction):_e.getAttribute("formAction"),v!==null&&(ee=v,_e=null));var Re=new Zd("action","action",null,k,G);m.push({event:Re,listeners:[{instance:null,listener:function(){if(k.defaultPrevented){if(Ff!==0){var at=_e?u2(G,_e):new FormData(G);wh(C,{pending:!0,data:at,method:G.method,action:ee},null,at)}}else typeof ee=="function"&&(Re.preventDefault(),at=_e?u2(G,_e):new FormData(G),wh(C,{pending:!0,data:at,method:G.method,action:ee},ee,at))},currentTarget:G}]})}}for(var tv=0;tv<en.length;tv++){var Ih=en[tv],d0=Ih.toLowerCase(),rA=Ih[0].toUpperCase()+Ih.slice(1);al(d0,"on"+rA)}al(eg,"onAnimationEnd"),al(il,"onAnimationIteration"),al(oh,"onAnimationStart"),al("dblclick","onDoubleClick"),al("focusin","onFocus"),al("focusout","onBlur"),al(ff,"onTransitionRun"),al(Cx,"onTransitionStart"),al(tg,"onTransitionCancel"),al(Lo,"onTransitionEnd"),or("onMouseEnter",["mouseout","mouseover"]),or("onMouseLeave",["mouseout","mouseover"]),or("onPointerEnter",["pointerout","pointerover"]),or("onPointerLeave",["pointerout","pointerover"]),Qr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Qr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Qr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Qr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Qr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Qr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var h0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(h0));function d2(m,v){v=(v&4)!==0;for(var C=0;C<m.length;C++){var k=m[C],G=k.event;k=k.listeners;e:{var ee=void 0;if(v)for(var _e=k.length-1;0<=_e;_e--){var Re=k[_e],at=Re.instance,Lt=Re.currentTarget;if(Re=Re.listener,at!==ee&&G.isPropagationStopped())break e;ee=Re,G.currentTarget=Lt;try{ee(G)}catch(hn){hd(hn)}G.currentTarget=null,ee=at}else for(_e=0;_e<k.length;_e++){if(Re=k[_e],at=Re.instance,Lt=Re.currentTarget,Re=Re.listener,at!==ee&&G.isPropagationStopped())break e;ee=Re,G.currentTarget=Lt;try{ee(G)}catch(hn){hd(hn)}G.currentTarget=null,ee=at}}}}function Vi(m,v){var C=v[Be];C===void 0&&(C=v[Be]=new Set);var k=m+"__bubble";C.has(k)||(h2(v,m,2,!1),C.add(k))}function J_(m,v,C){var k=0;v&&(k|=4),h2(C,m,k,v)}var nv="_reactListening"+Math.random().toString(36).slice(2);function f0(m){if(!m[nv]){m[nv]=!0,Ln.forEach(function(C){C!=="selectionchange"&&(iA.has(C)||J_(C,!1,m),J_(C,!0,m))});var v=m.nodeType===9?m:m.ownerDocument;v===null||v[nv]||(v[nv]=!0,J_("selectionchange",!1,v))}}function h2(m,v,C,k){switch(Ng(v)){case 2:var G=cA;break;case 8:G=j2;break;default:G=vd}C=G.bind(null,v,C,m),G=void 0,!Vu||v!=="touchstart"&&v!=="touchmove"&&v!=="wheel"||(G=!0),k?G!==void 0?m.addEventListener(v,C,{capture:!0,passive:G}):m.addEventListener(v,C,!0):G!==void 0?m.addEventListener(v,C,{passive:G}):m.addEventListener(v,C,!1)}function rv(m,v,C,k,G){var ee=k;if((v&1)===0&&(v&2)===0&&k!==null)e:for(;;){if(k===null)return;var _e=k.tag;if(_e===3||_e===4){var Re=k.stateNode.containerInfo;if(Re===G)break;if(_e===4)for(_e=k.return;_e!==null;){var at=_e.tag;if((at===3||at===4)&&_e.stateNode.containerInfo===G)return;_e=_e.return}for(;Re!==null;){if(_e=St(Re),_e===null)return;if(at=_e.tag,at===5||at===6||at===26||at===27){k=ee=_e;continue e}Re=Re.parentNode}}k=k.return}fp(function(){var Lt=ee,hn=of(C),En=[];e:{var Ht=Ap.get(m);if(Ht!==void 0){var Wt=Zd,ni=m;switch(m){case"keypress":if(mp(C)===0)break e;case"keydown":case"keyup":Wt=ai;break;case"focusin":ni="focus",Wt=Qd;break;case"focusout":ni="blur",Wt=Qd;break;case"beforeblur":case"afterblur":Wt=Qd;break;case"click":if(C.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Wt=$u;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Wt=bx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Wt=eh;break;case eg:case il:case oh:Wt=Ry;break;case Lo:Wt=_p;break;case"scroll":case"scrollend":Wt=ko;break;case"wheel":Wt=ka;break;case"copy":case"cut":case"paste":Wt=zy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Wt=tu;break;case"toggle":case"beforetoggle":Wt=bp}var Gr=(v&4)!==0,Ea=!Gr&&(m==="scroll"||m==="scrollend"),At=Gr?Ht!==null?Ht+"Capture":null:Ht;Gr=[];for(var gt=Lt,Rt;gt!==null;){var xn=gt;if(Rt=xn.stateNode,xn=xn.tag,xn!==5&&xn!==26&&xn!==27||Rt===null||At===null||(xn=Rr(gt,At),xn!=null&&Gr.push(kh(gt,xn,Rt))),Ea)break;gt=gt.return}0<Gr.length&&(Ht=new Wt(Ht,ni,null,C,hn),En.push({event:Ht,listeners:Gr}))}}if((v&7)===0){e:{if(Ht=m==="mouseover"||m==="pointerover",Wt=m==="mouseout"||m==="pointerout",Ht&&C!==_s&&(ni=C.relatedTarget||C.fromElement)&&(St(ni)||ni[De]))break e;if((Wt||Ht)&&(Ht=hn.window===hn?hn:(Ht=hn.ownerDocument)?Ht.defaultView||Ht.parentWindow:window,Wt?(ni=C.relatedTarget||C.toElement,Wt=Lt,ni=ni?St(ni):null,ni!==null&&(Ea=d(ni),Gr=ni.tag,ni!==Ea||Gr!==5&&Gr!==27&&Gr!==6)&&(ni=null)):(Wt=null,ni=Lt),Wt!==ni)){if(Gr=$u,xn="onMouseLeave",At="onMouseEnter",gt="mouse",(m==="pointerout"||m==="pointerover")&&(Gr=tu,xn="onPointerLeave",At="onPointerEnter",gt="pointer"),Ea=Wt==null?Ht:nn(Wt),Rt=ni==null?Ht:nn(ni),Ht=new Gr(xn,gt+"leave",Wt,C,hn),Ht.target=Ea,Ht.relatedTarget=Rt,xn=null,St(hn)===Lt&&(Gr=new Gr(At,gt+"enter",ni,C,hn),Gr.target=Rt,Gr.relatedTarget=Ea,xn=Gr),Ea=xn,Wt&&ni)t:{for(Gr=Wt,At=ni,gt=0,Rt=Gr;Rt;Rt=Ta(Rt))gt++;for(Rt=0,xn=At;xn;xn=Ta(xn))Rt++;for(;0<gt-Rt;)Gr=Ta(Gr),gt--;for(;0<Rt-gt;)At=Ta(At),Rt--;for(;gt--;){if(Gr===At||At!==null&&Gr===At.alternate)break t;Gr=Ta(Gr),At=Ta(At)}Gr=null}else Gr=null;Wt!==null&&um(En,Ht,Wt,Gr,!1),ni!==null&&Ea!==null&&um(En,Ea,ni,Gr,!0)}}e:{if(Ht=Lt?nn(Lt):window,Wt=Ht.nodeName&&Ht.nodeName.toLowerCase(),Wt==="select"||Wt==="input"&&Ht.type==="file")var xr=Al;else if(uf(Ht))if(Tx)xr=Sp;else{xr=ih;var Oi=rh}else Wt=Ht.nodeName,!Wt||Wt.toLowerCase()!=="input"||Ht.type!=="checkbox"&&Ht.type!=="radio"?Lt&&Ql(Lt.elementType)&&(xr=Al):xr=to;if(xr&&(xr=xr(m,Lt))){Kn(En,xr,C,hn);break e}Oi&&Oi(m,Ht,Lt),m==="focusout"&&Lt&&Ht.type==="number"&&Lt.memoizedProps.value!=null&&Ks(Ht,"number",Ht.value)}switch(Oi=Lt?nn(Lt):window,m){case"focusin":(uf(Oi)||Oi.contentEditable==="true")&&(ah=Oi,Qm=Lt,Ep=null);break;case"focusout":Ep=Qm=ah=null;break;case"mousedown":hf=!0;break;case"contextmenu":case"mouseup":case"dragend":hf=!1,Ax(En,C,hn);break;case"selectionchange":if(V_)break;case"keydown":case"keyup":Ax(En,C,hn)}var Mr;if(Hu)e:{switch(m){case"compositionstart":var Wr="onCompositionStart";break e;case"compositionend":Wr="onCompositionEnd";break e;case"compositionupdate":Wr="onCompositionUpdate";break e}Wr=void 0}else pa?Sx(m,C)&&(Wr="onCompositionEnd"):m==="keydown"&&C.keyCode===229&&(Wr="onCompositionStart");Wr&&(Rs&&C.locale!=="ko"&&(pa||Wr!=="onCompositionStart"?Wr==="onCompositionEnd"&&pa&&(Mr=Wd()):(Jc=hn,eu="value"in Jc?Jc.value:Jc.textContent,pa=!0)),Oi=iv(Lt,Wr),0<Oi.length&&(Wr=new xp(Wr,m,null,C,hn),En.push({event:Wr,listeners:Oi}),Mr?Wr.data=Mr:(Mr=th(C),Mr!==null&&(Wr.data=Mr)))),(Mr=Xm?eo(m,C):pr(m,C))&&(Wr=iv(Lt,"onBeforeInput"),0<Wr.length&&(Oi=new xp("onBeforeInput","beforeinput",null,C,hn),En.push({event:Oi,listeners:Wr}),Oi.data=Mr)),u0(En,m,Lt,C,hn)}d2(En,v)})}function kh(m,v,C){return{instance:m,listener:v,currentTarget:C}}function iv(m,v){for(var C=v+"Capture",k=[];m!==null;){var G=m,ee=G.stateNode;if(G=G.tag,G!==5&&G!==26&&G!==27||ee===null||(G=Rr(m,C),G!=null&&k.unshift(kh(m,G,ee)),G=Rr(m,v),G!=null&&k.push(kh(m,G,ee))),m.tag===3)return k;m=m.return}return[]}function Ta(m){if(m===null)return null;do m=m.return;while(m&&m.tag!==5&&m.tag!==27);return m||null}function um(m,v,C,k,G){for(var ee=v._reactName,_e=[];C!==null&&C!==k;){var Re=C,at=Re.alternate,Lt=Re.stateNode;if(Re=Re.tag,at!==null&&at===k)break;Re!==5&&Re!==26&&Re!==27||Lt===null||(at=Lt,G?(Lt=Rr(C,ee),Lt!=null&&_e.unshift(kh(C,Lt,at))):G||(Lt=Rr(C,ee),Lt!=null&&_e.push(kh(C,Lt,at)))),C=C.return}_e.length!==0&&m.push({event:v,listeners:_e})}var f2=/\r\n?/g,av=/\u0000|\uFFFD/g;function p0(m){return(typeof m=="string"?m:""+m).replace(f2,`
`).replace(av,"")}function Tg(m,v){return v=p0(v),p0(m)===v}function m0(){}function ya(m,v,C,k,G,ee){switch(C){case"children":typeof k=="string"?v==="body"||v==="textarea"&&k===""||Oo(m,k):(typeof k=="number"||typeof k=="bigint")&&v!=="body"&&Oo(m,""+k);break;case"className":ea(m,"class",k);break;case"tabIndex":ea(m,"tabindex",k);break;case"dir":case"role":case"viewBox":case"width":case"height":ea(m,C,k);break;case"style":Gm(m,k,ee);break;case"data":if(v!=="object"){ea(m,"data",k);break}case"src":case"href":if(k===""&&(v!=="a"||C!=="href")){m.removeAttribute(C);break}if(k==null||typeof k=="function"||typeof k=="symbol"||typeof k=="boolean"){m.removeAttribute(C);break}k=Bu(""+k),m.setAttribute(C,k);break;case"action":case"formAction":if(typeof k=="function"){m.setAttribute(C,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof ee=="function"&&(C==="formAction"?(v!=="input"&&ya(m,v,"name",G.name,G,null),ya(m,v,"formEncType",G.formEncType,G,null),ya(m,v,"formMethod",G.formMethod,G,null),ya(m,v,"formTarget",G.formTarget,G,null)):(ya(m,v,"encType",G.encType,G,null),ya(m,v,"method",G.method,G,null),ya(m,v,"target",G.target,G,null)));if(k==null||typeof k=="symbol"||typeof k=="boolean"){m.removeAttribute(C);break}k=Bu(""+k),m.setAttribute(C,k);break;case"onClick":k!=null&&(m.onclick=m0);break;case"onScroll":k!=null&&Vi("scroll",m);break;case"onScrollEnd":k!=null&&Vi("scrollend",m);break;case"dangerouslySetInnerHTML":if(k!=null){if(typeof k!="object"||!("__html"in k))throw Error(r(61));if(C=k.__html,C!=null){if(G.children!=null)throw Error(r(60));m.innerHTML=C}}break;case"multiple":m.multiple=k&&typeof k!="function"&&typeof k!="symbol";break;case"muted":m.muted=k&&typeof k!="function"&&typeof k!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(k==null||typeof k=="function"||typeof k=="boolean"||typeof k=="symbol"){m.removeAttribute("xlink:href");break}C=Bu(""+k),m.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",C);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":k!=null&&typeof k!="function"&&typeof k!="symbol"?m.setAttribute(C,""+k):m.removeAttribute(C);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":k&&typeof k!="function"&&typeof k!="symbol"?m.setAttribute(C,""):m.removeAttribute(C);break;case"capture":case"download":k===!0?m.setAttribute(C,""):k!==!1&&k!=null&&typeof k!="function"&&typeof k!="symbol"?m.setAttribute(C,k):m.removeAttribute(C);break;case"cols":case"rows":case"size":case"span":k!=null&&typeof k!="function"&&typeof k!="symbol"&&!isNaN(k)&&1<=k?m.setAttribute(C,k):m.removeAttribute(C);break;case"rowSpan":case"start":k==null||typeof k=="function"||typeof k=="symbol"||isNaN(k)?m.removeAttribute(C):m.setAttribute(C,k);break;case"popover":Vi("beforetoggle",m),Vi("toggle",m),Ti(m,"popover",k);break;case"xlinkActuate":Ar(m,"http://www.w3.org/1999/xlink","xlink:actuate",k);break;case"xlinkArcrole":Ar(m,"http://www.w3.org/1999/xlink","xlink:arcrole",k);break;case"xlinkRole":Ar(m,"http://www.w3.org/1999/xlink","xlink:role",k);break;case"xlinkShow":Ar(m,"http://www.w3.org/1999/xlink","xlink:show",k);break;case"xlinkTitle":Ar(m,"http://www.w3.org/1999/xlink","xlink:title",k);break;case"xlinkType":Ar(m,"http://www.w3.org/1999/xlink","xlink:type",k);break;case"xmlBase":Ar(m,"http://www.w3.org/XML/1998/namespace","xml:base",k);break;case"xmlLang":Ar(m,"http://www.w3.org/XML/1998/namespace","xml:lang",k);break;case"xmlSpace":Ar(m,"http://www.w3.org/XML/1998/namespace","xml:space",k);break;case"is":Ti(m,"is",k);break;case"innerText":case"textContent":break;default:(!(2<C.length)||C[0]!=="o"&&C[0]!=="O"||C[1]!=="n"&&C[1]!=="N")&&(C=hp.get(C)||C,Ti(m,C,k))}}function dm(m,v,C,k,G,ee){switch(C){case"style":Gm(m,k,ee);break;case"dangerouslySetInnerHTML":if(k!=null){if(typeof k!="object"||!("__html"in k))throw Error(r(61));if(C=k.__html,C!=null){if(G.children!=null)throw Error(r(60));m.innerHTML=C}}break;case"children":typeof k=="string"?Oo(m,k):(typeof k=="number"||typeof k=="bigint")&&Oo(m,""+k);break;case"onScroll":k!=null&&Vi("scroll",m);break;case"onScrollEnd":k!=null&&Vi("scrollend",m);break;case"onClick":k!=null&&(m.onclick=m0);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!cr.hasOwnProperty(C))e:{if(C[0]==="o"&&C[1]==="n"&&(G=C.endsWith("Capture"),v=C.slice(2,G?C.length-7:void 0),ee=m[Me]||null,ee=ee!=null?ee[C]:null,typeof ee=="function"&&m.removeEventListener(v,ee,G),typeof k=="function")){typeof ee!="function"&&ee!==null&&(C in m?m[C]=null:m.hasAttribute(C)&&m.removeAttribute(C)),m.addEventListener(v,k,G);break e}C in m?m[C]=k:k===!0?m.setAttribute(C,""):Ti(m,C,k)}}}function Fs(m,v,C){switch(v){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Vi("error",m),Vi("load",m);var k=!1,G=!1,ee;for(ee in C)if(C.hasOwnProperty(ee)){var _e=C[ee];if(_e!=null)switch(ee){case"src":k=!0;break;case"srcSet":G=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,v));default:ya(m,v,ee,_e,C,null)}}G&&ya(m,v,"srcSet",C.srcSet,C,null),k&&ya(m,v,"src",C.src,C,null);return;case"input":Vi("invalid",m);var Re=ee=_e=G=null,at=null,Lt=null;for(k in C)if(C.hasOwnProperty(k)){var hn=C[k];if(hn!=null)switch(k){case"name":G=hn;break;case"type":_e=hn;break;case"checked":at=hn;break;case"defaultChecked":Lt=hn;break;case"value":ee=hn;break;case"defaultValue":Re=hn;break;case"children":case"dangerouslySetInnerHTML":if(hn!=null)throw Error(r(137,v));break;default:ya(m,v,k,hn,C,null)}}Hm(m,ee,Re,at,Lt,_e,G,!1),Gd(m);return;case"select":Vi("invalid",m),k=_e=ee=null;for(G in C)if(C.hasOwnProperty(G)&&(Re=C[G],Re!=null))switch(G){case"value":ee=Re;break;case"defaultValue":_e=Re;break;case"multiple":k=Re;default:ya(m,v,G,Re,C,null)}v=ee,C=_e,m.multiple=!!k,v!=null?Ys(m,!!k,v,!1):C!=null&&Ys(m,!!k,C,!0);return;case"textarea":Vi("invalid",m),ee=G=k=null;for(_e in C)if(C.hasOwnProperty(_e)&&(Re=C[_e],Re!=null))switch(_e){case"value":k=Re;break;case"defaultValue":G=Re;break;case"children":ee=Re;break;case"dangerouslySetInnerHTML":if(Re!=null)throw Error(r(91));break;default:ya(m,v,_e,Re,C,null)}_l(m,k,G,ee),Gd(m);return;case"option":for(at in C)if(C.hasOwnProperty(at)&&(k=C[at],k!=null))switch(at){case"selected":m.selected=k&&typeof k!="function"&&typeof k!="symbol";break;default:ya(m,v,at,k,C,null)}return;case"dialog":Vi("beforetoggle",m),Vi("toggle",m),Vi("cancel",m),Vi("close",m);break;case"iframe":case"object":Vi("load",m);break;case"video":case"audio":for(k=0;k<h0.length;k++)Vi(h0[k],m);break;case"image":Vi("error",m),Vi("load",m);break;case"details":Vi("toggle",m);break;case"embed":case"source":case"link":Vi("error",m),Vi("load",m);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Lt in C)if(C.hasOwnProperty(Lt)&&(k=C[Lt],k!=null))switch(Lt){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,v));default:ya(m,v,Lt,k,C,null)}return;default:if(Ql(v)){for(hn in C)C.hasOwnProperty(hn)&&(k=C[hn],k!==void 0&&dm(m,v,hn,k,C,void 0));return}}for(Re in C)C.hasOwnProperty(Re)&&(k=C[Re],k!=null&&ya(m,v,Re,k,C,null))}function sv(m,v,C,k){switch(v){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var G=null,ee=null,_e=null,Re=null,at=null,Lt=null,hn=null;for(Wt in C){var En=C[Wt];if(C.hasOwnProperty(Wt)&&En!=null)switch(Wt){case"checked":break;case"value":break;case"defaultValue":at=En;default:k.hasOwnProperty(Wt)||ya(m,v,Wt,null,k,En)}}for(var Ht in k){var Wt=k[Ht];if(En=C[Ht],k.hasOwnProperty(Ht)&&(Wt!=null||En!=null))switch(Ht){case"type":ee=Wt;break;case"name":G=Wt;break;case"checked":Lt=Wt;break;case"defaultChecked":hn=Wt;break;case"value":_e=Wt;break;case"defaultValue":Re=Wt;break;case"children":case"dangerouslySetInnerHTML":if(Wt!=null)throw Error(r(137,v));break;default:Wt!==En&&ya(m,v,Ht,Wt,k,En)}}tl(m,_e,Re,at,Lt,hn,ee,G);return;case"select":Wt=_e=Re=Ht=null;for(ee in C)if(at=C[ee],C.hasOwnProperty(ee)&&at!=null)switch(ee){case"value":break;case"multiple":Wt=at;default:k.hasOwnProperty(ee)||ya(m,v,ee,null,k,at)}for(G in k)if(ee=k[G],at=C[G],k.hasOwnProperty(G)&&(ee!=null||at!=null))switch(G){case"value":Ht=ee;break;case"defaultValue":Re=ee;break;case"multiple":_e=ee;default:ee!==at&&ya(m,v,G,ee,k,at)}v=Re,C=_e,k=Wt,Ht!=null?Ys(m,!!C,Ht,!1):!!k!=!!C&&(v!=null?Ys(m,!!C,v,!0):Ys(m,!!C,C?[]:"",!1));return;case"textarea":Wt=Ht=null;for(Re in C)if(G=C[Re],C.hasOwnProperty(Re)&&G!=null&&!k.hasOwnProperty(Re))switch(Re){case"value":break;case"children":break;default:ya(m,v,Re,null,k,G)}for(_e in k)if(G=k[_e],ee=C[_e],k.hasOwnProperty(_e)&&(G!=null||ee!=null))switch(_e){case"value":Ht=G;break;case"defaultValue":Wt=G;break;case"children":break;case"dangerouslySetInnerHTML":if(G!=null)throw Error(r(91));break;default:G!==ee&&ya(m,v,_e,G,k,ee)}jc(m,Ht,Wt);return;case"option":for(var ni in C)if(Ht=C[ni],C.hasOwnProperty(ni)&&Ht!=null&&!k.hasOwnProperty(ni))switch(ni){case"selected":m.selected=!1;break;default:ya(m,v,ni,null,k,Ht)}for(at in k)if(Ht=k[at],Wt=C[at],k.hasOwnProperty(at)&&Ht!==Wt&&(Ht!=null||Wt!=null))switch(at){case"selected":m.selected=Ht&&typeof Ht!="function"&&typeof Ht!="symbol";break;default:ya(m,v,at,Ht,k,Wt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Gr in C)Ht=C[Gr],C.hasOwnProperty(Gr)&&Ht!=null&&!k.hasOwnProperty(Gr)&&ya(m,v,Gr,null,k,Ht);for(Lt in k)if(Ht=k[Lt],Wt=C[Lt],k.hasOwnProperty(Lt)&&Ht!==Wt&&(Ht!=null||Wt!=null))switch(Lt){case"children":case"dangerouslySetInnerHTML":if(Ht!=null)throw Error(r(137,v));break;default:ya(m,v,Lt,Ht,k,Wt)}return;default:if(Ql(v)){for(var Ea in C)Ht=C[Ea],C.hasOwnProperty(Ea)&&Ht!==void 0&&!k.hasOwnProperty(Ea)&&dm(m,v,Ea,void 0,k,Ht);for(hn in k)Ht=k[hn],Wt=C[hn],!k.hasOwnProperty(hn)||Ht===Wt||Ht===void 0&&Wt===void 0||dm(m,v,hn,Ht,k,Wt);return}}for(var At in C)Ht=C[At],C.hasOwnProperty(At)&&Ht!=null&&!k.hasOwnProperty(At)&&ya(m,v,At,null,k,Ht);for(En in k)Ht=k[En],Wt=C[En],!k.hasOwnProperty(En)||Ht===Wt||Ht==null&&Wt==null||ya(m,v,En,Ht,k,Wt)}var e1=null,ov=null;function Eg(m){return m.nodeType===9?m:m.ownerDocument}function lv(m){switch(m){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function cv(m,v){if(m===0)switch(v){case"svg":return 1;case"math":return 2;default:return 0}return m===1&&v==="foreignObject"?0:m}function uv(m,v){return m==="textarea"||m==="noscript"||typeof v.children=="string"||typeof v.children=="number"||typeof v.children=="bigint"||typeof v.dangerouslySetInnerHTML=="object"&&v.dangerouslySetInnerHTML!==null&&v.dangerouslySetInnerHTML.__html!=null}var g0=null;function p2(){var m=window.event;return m&&m.type==="popstate"?m===g0?!1:(g0=m,!0):(g0=null,!1)}var dv=typeof setTimeout=="function"?setTimeout:void 0,m2=typeof clearTimeout=="function"?clearTimeout:void 0,t1=typeof Promise=="function"?Promise:void 0,hv=typeof queueMicrotask=="function"?queueMicrotask:typeof t1<"u"?function(m){return t1.resolve(null).then(m).catch(g2)}:dv;function g2(m){setTimeout(function(){throw m})}function Rh(m){return m==="head"}function n1(m,v){var C=v,k=0,G=0;do{var ee=C.nextSibling;if(m.removeChild(C),ee&&ee.nodeType===8)if(C=ee.data,C==="/$"){if(0<k&&8>k){C=k;var _e=m.ownerDocument;if(C&1&&fm(_e.documentElement),C&2&&fm(_e.body),C&4)for(C=_e.head,fm(C),_e=C.firstChild;_e;){var Re=_e.nextSibling,at=_e.nodeName;_e[it]||at==="SCRIPT"||at==="STYLE"||at==="LINK"&&_e.rel.toLowerCase()==="stylesheet"||C.removeChild(_e),_e=Re}}if(G===0){m.removeChild(ee),Dg(v);return}G--}else C==="$"||C==="$?"||C==="$!"?G++:k=C.charCodeAt(0)-48;else k=0;C=ee}while(C);Dg(v)}function yd(m){var v=m.firstChild;for(v&&v.nodeType===10&&(v=v.nextSibling);v;){var C=v;switch(v=v.nextSibling,C.nodeName){case"HTML":case"HEAD":case"BODY":yd(C),Xe(C);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(C.rel.toLowerCase()==="stylesheet")continue}m.removeChild(C)}}function hm(m,v,C,k){for(;m.nodeType===1;){var G=C;if(m.nodeName.toLowerCase()!==v.toLowerCase()){if(!k&&(m.nodeName!=="INPUT"||m.type!=="hidden"))break}else if(k){if(!m[it])switch(v){case"meta":if(!m.hasAttribute("itemprop"))break;return m;case"link":if(ee=m.getAttribute("rel"),ee==="stylesheet"&&m.hasAttribute("data-precedence"))break;if(ee!==G.rel||m.getAttribute("href")!==(G.href==null||G.href===""?null:G.href)||m.getAttribute("crossorigin")!==(G.crossOrigin==null?null:G.crossOrigin)||m.getAttribute("title")!==(G.title==null?null:G.title))break;return m;case"style":if(m.hasAttribute("data-precedence"))break;return m;case"script":if(ee=m.getAttribute("src"),(ee!==(G.src==null?null:G.src)||m.getAttribute("type")!==(G.type==null?null:G.type)||m.getAttribute("crossorigin")!==(G.crossOrigin==null?null:G.crossOrigin))&&ee&&m.hasAttribute("async")&&!m.hasAttribute("itemprop"))break;return m;default:return m}}else if(v==="input"&&m.type==="hidden"){var ee=G.name==null?null:""+G.name;if(G.type==="hidden"&&m.getAttribute("name")===ee)return m}else return m;if(m=Tu(m.nextSibling),m===null)break}return null}function x2(m,v,C){if(v==="")return null;for(;m.nodeType!==3;)if((m.nodeType!==1||m.nodeName!=="INPUT"||m.type!=="hidden")&&!C||(m=Tu(m.nextSibling),m===null))return null;return m}function r1(m){return m.data==="$!"||m.data==="$?"&&m.ownerDocument.readyState==="complete"}function y2(m,v){var C=m.ownerDocument;if(m.data!=="$?"||C.readyState==="complete")v();else{var k=function(){v(),C.removeEventListener("DOMContentLoaded",k)};C.addEventListener("DOMContentLoaded",k),m._reactRetry=k}}function Tu(m){for(;m!=null;m=m.nextSibling){var v=m.nodeType;if(v===1||v===3)break;if(v===8){if(v=m.data,v==="$"||v==="$!"||v==="$?"||v==="F!"||v==="F")break;if(v==="/$")return null}}return m}var i1=null;function Bf(m){m=m.previousSibling;for(var v=0;m;){if(m.nodeType===8){var C=m.data;if(C==="$"||C==="$!"||C==="$?"){if(v===0)return m;v--}else C==="/$"&&v++}m=m.previousSibling}return null}function a1(m,v,C){switch(v=Eg(C),m){case"html":if(m=v.documentElement,!m)throw Error(r(452));return m;case"head":if(m=v.head,!m)throw Error(r(453));return m;case"body":if(m=v.body,!m)throw Error(r(454));return m;default:throw Error(r(451))}}function fm(m){for(var v=m.attributes;v.length;)m.removeAttributeNode(v[0]);Xe(m)}var kl=new Map,s1=new Set;function x0(m){return typeof m.getRootNode=="function"?m.getRootNode():m.nodeType===9?m:m.ownerDocument}var dl=ut.d;ut.d={f:aA,r:Rl,D:v2,C:fv,L:sA,m:oA,X:_2,S:l1,M:c1};function aA(){var m=dl.f(),v=_u();return m||v}function Rl(m){var v=qt(m);v!==null&&v.tag===5&&v.type==="form"?mg(v):dl.r(m)}var pm=typeof document>"u"?null:document;function o1(m,v,C){var k=pm;if(k&&typeof v=="string"&&v){var G=Do(v);G='link[rel="'+m+'"][href="'+G+'"]',typeof C=="string"&&(G+='[crossorigin="'+C+'"]'),s1.has(G)||(s1.add(G),m={rel:m,crossOrigin:C,href:v},k.querySelector(G)===null&&(v=k.createElement("link"),Fs(v,"link",m),zn(v),k.head.appendChild(v)))}}function v2(m){dl.D(m),o1("dns-prefetch",m,null)}function fv(m,v){dl.C(m,v),o1("preconnect",m,v)}function sA(m,v,C){dl.L(m,v,C);var k=pm;if(k&&m&&v){var G='link[rel="preload"][as="'+Do(v)+'"]';v==="image"&&C&&C.imageSrcSet?(G+='[imagesrcset="'+Do(C.imageSrcSet)+'"]',typeof C.imageSizes=="string"&&(G+='[imagesizes="'+Do(C.imageSizes)+'"]')):G+='[href="'+Do(m)+'"]';var ee=G;switch(v){case"style":ee=mm(m);break;case"script":ee=Vf(m)}kl.has(ee)||(m=E({rel:"preload",href:v==="image"&&C&&C.imageSrcSet?void 0:m,as:v},C),kl.set(ee,m),k.querySelector(G)!==null||v==="style"&&k.querySelector(Ag(ee))||v==="script"&&k.querySelector(zl(ee))||(v=k.createElement("link"),Fs(v,"link",m),zn(v),k.head.appendChild(v)))}}function oA(m,v){dl.m(m,v);var C=pm;if(C&&m){var k=v&&typeof v.as=="string"?v.as:"script",G='link[rel="modulepreload"][as="'+Do(k)+'"][href="'+Do(m)+'"]',ee=G;switch(k){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":ee=Vf(m)}if(!kl.has(ee)&&(m=E({rel:"modulepreload",href:m},v),kl.set(ee,m),C.querySelector(G)===null)){switch(k){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(C.querySelector(zl(ee)))return}k=C.createElement("link"),Fs(k,"link",m),zn(k),C.head.appendChild(k)}}}function l1(m,v,C){dl.S(m,v,C);var k=pm;if(k&&m){var G=Fn(k).hoistableStyles,ee=mm(m);v=v||"default";var _e=G.get(ee);if(!_e){var Re={loading:0,preload:null};if(_e=k.querySelector(Ag(ee)))Re.loading=5;else{m=E({rel:"stylesheet",href:m,"data-precedence":v},C),(C=kl.get(ee))&&h1(m,C);var at=_e=k.createElement("link");zn(at),Fs(at,"link",m),at._p=new Promise(function(Lt,hn){at.onload=Lt,at.onerror=hn}),at.addEventListener("load",function(){Re.loading|=1}),at.addEventListener("error",function(){Re.loading|=2}),Re.loading|=4,mv(_e,v,k)}_e={type:"stylesheet",instance:_e,count:1,state:Re},G.set(ee,_e)}}}function _2(m,v){dl.X(m,v);var C=pm;if(C&&m){var k=Fn(C).hoistableScripts,G=Vf(m),ee=k.get(G);ee||(ee=C.querySelector(zl(G)),ee||(m=E({src:m,async:!0},v),(v=kl.get(G))&&f1(m,v),ee=C.createElement("script"),zn(ee),Fs(ee,"link",m),C.head.appendChild(ee)),ee={type:"script",instance:ee,count:1,state:null},k.set(G,ee))}}function c1(m,v){dl.M(m,v);var C=pm;if(C&&m){var k=Fn(C).hoistableScripts,G=Vf(m),ee=k.get(G);ee||(ee=C.querySelector(zl(G)),ee||(m=E({src:m,async:!0,type:"module"},v),(v=kl.get(G))&&f1(m,v),ee=C.createElement("script"),zn(ee),Fs(ee,"link",m),C.head.appendChild(ee)),ee={type:"script",instance:ee,count:1,state:null},k.set(G,ee))}}function pv(m,v,C,k){var G=(G=vn.current)?x0(G):null;if(!G)throw Error(r(446));switch(m){case"meta":case"title":return null;case"style":return typeof C.precedence=="string"&&typeof C.href=="string"?(v=mm(C.href),C=Fn(G).hoistableStyles,k=C.get(v),k||(k={type:"style",instance:null,count:0,state:null},C.set(v,k)),k):{type:"void",instance:null,count:0,state:null};case"link":if(C.rel==="stylesheet"&&typeof C.href=="string"&&typeof C.precedence=="string"){m=mm(C.href);var ee=Fn(G).hoistableStyles,_e=ee.get(m);if(_e||(G=G.ownerDocument||G,_e={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},ee.set(m,_e),(ee=G.querySelector(Ag(m)))&&!ee._p&&(_e.instance=ee,_e.state.loading=5),kl.has(m)||(C={rel:"preload",as:"style",href:C.href,crossOrigin:C.crossOrigin,integrity:C.integrity,media:C.media,hrefLang:C.hrefLang,referrerPolicy:C.referrerPolicy},kl.set(m,C),ee||b2(G,m,C,_e.state))),v&&k===null)throw Error(r(528,""));return _e}if(v&&k!==null)throw Error(r(529,""));return null;case"script":return v=C.async,C=C.src,typeof C=="string"&&v&&typeof v!="function"&&typeof v!="symbol"?(v=Vf(C),C=Fn(G).hoistableScripts,k=C.get(v),k||(k={type:"script",instance:null,count:0,state:null},C.set(v,k)),k):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,m))}}function mm(m){return'href="'+Do(m)+'"'}function Ag(m){return'link[rel="stylesheet"]['+m+"]"}function u1(m){return E({},m,{"data-precedence":m.precedence,precedence:null})}function b2(m,v,C,k){m.querySelector('link[rel="preload"][as="style"]['+v+"]")?k.loading=1:(v=m.createElement("link"),k.preload=v,v.addEventListener("load",function(){return k.loading|=1}),v.addEventListener("error",function(){return k.loading|=2}),Fs(v,"link",C),zn(v),m.head.appendChild(v))}function Vf(m){return'[src="'+Do(m)+'"]'}function zl(m){return"script[async]"+m}function d1(m,v,C){if(v.count++,v.instance===null)switch(v.type){case"style":var k=m.querySelector('style[data-href~="'+Do(C.href)+'"]');if(k)return v.instance=k,zn(k),k;var G=E({},C,{"data-href":C.href,"data-precedence":C.precedence,href:null,precedence:null});return k=(m.ownerDocument||m).createElement("style"),zn(k),Fs(k,"style",G),mv(k,C.precedence,m),v.instance=k;case"stylesheet":G=mm(C.href);var ee=m.querySelector(Ag(G));if(ee)return v.state.loading|=4,v.instance=ee,zn(ee),ee;k=u1(C),(G=kl.get(G))&&h1(k,G),ee=(m.ownerDocument||m).createElement("link"),zn(ee);var _e=ee;return _e._p=new Promise(function(Re,at){_e.onload=Re,_e.onerror=at}),Fs(ee,"link",k),v.state.loading|=4,mv(ee,C.precedence,m),v.instance=ee;case"script":return ee=Vf(C.src),(G=m.querySelector(zl(ee)))?(v.instance=G,zn(G),G):(k=C,(G=kl.get(ee))&&(k=E({},C),f1(k,G)),m=m.ownerDocument||m,G=m.createElement("script"),zn(G),Fs(G,"link",k),m.head.appendChild(G),v.instance=G);case"void":return null;default:throw Error(r(443,v.type))}else v.type==="stylesheet"&&(v.state.loading&4)===0&&(k=v.instance,v.state.loading|=4,mv(k,C.precedence,m));return v.instance}function mv(m,v,C){for(var k=C.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),G=k.length?k[k.length-1]:null,ee=G,_e=0;_e<k.length;_e++){var Re=k[_e];if(Re.dataset.precedence===v)ee=Re;else if(ee!==G)break}ee?ee.parentNode.insertBefore(m,ee.nextSibling):(v=C.nodeType===9?C.head:C,v.insertBefore(m,v.firstChild))}function h1(m,v){m.crossOrigin==null&&(m.crossOrigin=v.crossOrigin),m.referrerPolicy==null&&(m.referrerPolicy=v.referrerPolicy),m.title==null&&(m.title=v.title)}function f1(m,v){m.crossOrigin==null&&(m.crossOrigin=v.crossOrigin),m.referrerPolicy==null&&(m.referrerPolicy=v.referrerPolicy),m.integrity==null&&(m.integrity=v.integrity)}var gv=null;function w2(m,v,C){if(gv===null){var k=new Map,G=gv=new Map;G.set(C,k)}else G=gv,k=G.get(C),k||(k=new Map,G.set(C,k));if(k.has(m))return k;for(k.set(m,null),C=C.getElementsByTagName(m),G=0;G<C.length;G++){var ee=C[G];if(!(ee[it]||ee[ye]||m==="link"&&ee.getAttribute("rel")==="stylesheet")&&ee.namespaceURI!=="http://www.w3.org/2000/svg"){var _e=ee.getAttribute(v)||"";_e=m+_e;var Re=k.get(_e);Re?Re.push(ee):k.set(_e,[ee])}}return k}function S2(m,v,C){m=m.ownerDocument||m,m.head.insertBefore(C,v==="title"?m.querySelector("head > title"):null)}function lA(m,v,C){if(C===1||v.itemProp!=null)return!1;switch(m){case"meta":case"title":return!0;case"style":if(typeof v.precedence!="string"||typeof v.href!="string"||v.href==="")break;return!0;case"link":if(typeof v.rel!="string"||typeof v.href!="string"||v.href===""||v.onLoad||v.onError)break;switch(v.rel){case"stylesheet":return m=v.disabled,typeof v.precedence=="string"&&m==null;default:return!0}case"script":if(v.async&&typeof v.async!="function"&&typeof v.async!="symbol"&&!v.onLoad&&!v.onError&&v.src&&typeof v.src=="string")return!0}return!1}function y0(m){return!(m.type==="stylesheet"&&(m.state.loading&3)===0)}var Cg=null;function xv(){}function T2(m,v,C){if(Cg===null)throw Error(r(475));var k=Cg;if(v.type==="stylesheet"&&(typeof C.media!="string"||matchMedia(C.media).matches!==!1)&&(v.state.loading&4)===0){if(v.instance===null){var G=mm(C.href),ee=m.querySelector(Ag(G));if(ee){m=ee._p,m!==null&&typeof m=="object"&&typeof m.then=="function"&&(k.count++,k=jg.bind(k),m.then(k,k)),v.state.loading|=4,v.instance=ee,zn(ee);return}ee=m.ownerDocument||m,C=u1(C),(G=kl.get(G))&&h1(C,G),ee=ee.createElement("link"),zn(ee);var _e=ee;_e._p=new Promise(function(Re,at){_e.onload=Re,_e.onerror=at}),Fs(ee,"link",C),v.instance=ee}k.stylesheets===null&&(k.stylesheets=new Map),k.stylesheets.set(v,m),(m=v.state.preload)&&(v.state.loading&3)===0&&(k.count++,v=jg.bind(k),m.addEventListener("load",v),m.addEventListener("error",v))}}function p1(){if(Cg===null)throw Error(r(475));var m=Cg;return m.stylesheets&&m.count===0&&m1(m,m.stylesheets),0<m.count?function(v){var C=setTimeout(function(){if(m.stylesheets&&m1(m,m.stylesheets),m.unsuspend){var k=m.unsuspend;m.unsuspend=null,k()}},6e4);return m.unsuspend=v,function(){m.unsuspend=null,clearTimeout(C)}}:null}function jg(){if(this.count--,this.count===0){if(this.stylesheets)m1(this,this.stylesheets);else if(this.unsuspend){var m=this.unsuspend;this.unsuspend=null,m()}}}var v0=null;function m1(m,v){m.stylesheets=null,m.unsuspend!==null&&(m.count++,v0=new Map,v.forEach(E2,m),v0=null,jg.call(m))}function E2(m,v){if(!(v.state.loading&4)){var C=v0.get(m);if(C)var k=C.get(null);else{C=new Map,v0.set(m,C);for(var G=m.querySelectorAll("link[data-precedence],style[data-precedence]"),ee=0;ee<G.length;ee++){var _e=G[ee];(_e.nodeName==="LINK"||_e.getAttribute("media")!=="not all")&&(C.set(_e.dataset.precedence,_e),k=_e)}k&&C.set(null,k)}G=v.instance,_e=G.getAttribute("data-precedence"),ee=C.get(_e)||k,ee===k&&C.set(null,G),C.set(_e,G),this.count++,k=jg.bind(this),G.addEventListener("load",k),G.addEventListener("error",k),ee?ee.parentNode.insertBefore(G,ee.nextSibling):(m=m.nodeType===9?m.head:m,m.insertBefore(G,m.firstChild)),v.state.loading|=4}}var Mg={$$typeof:ie,Provider:null,Consumer:null,_currentValue:Tt,_currentValue2:Tt,_threadCount:0};function A2(m,v,C,k,G,ee,_e,Re){this.tag=1,this.containerInfo=m,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ks(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ks(0),this.hiddenUpdates=ks(null),this.identifierPrefix=k,this.onUncaughtError=G,this.onCaughtError=ee,this.onRecoverableError=_e,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Re,this.incompleteTransitions=new Map}function g1(m,v,C,k,G,ee,_e,Re,at,Lt,hn,En){return m=new A2(m,v,C,_e,Re,at,Lt,En),v=1,ee===!0&&(v|=24),ee=Vo(3,null,null,v),m.current=ee,ee.stateNode=m,v=bf(),v.refCount++,m.pooledCache=v,v.refCount++,ee.memoizedState={element:k,isDehydrated:C,cache:v},og(ee),m}function yv(m){return m?(m=Gu,m):Gu}function x1(m,v,C,k,G,ee){G=yv(G),k.context===null?k.context=G:k.pendingContext=G,k=Ic(v),k.payload={element:C},ee=ee===void 0?null:ee,ee!==null&&(k.callback=ee),C=uc(m,k,v),C!==null&&(so(C,m,v),Af(C,m,v))}function vv(m,v){if(m=m.memoizedState,m!==null&&m.dehydrated!==null){var C=m.retryLane;m.retryLane=C!==0&&C<v?C:v}}function y1(m,v){vv(m,v),(m=m.alternate)&&vv(m,v)}function C2(m){if(m.tag===13){var v=jl(m,67108864);v!==null&&so(v,m,67108864),y1(m,67108864)}}var _v=!0;function cA(m,v,C,k){var G=He.T;He.T=null;var ee=ut.p;try{ut.p=2,vd(m,v,C,k)}finally{ut.p=ee,He.T=G}}function j2(m,v,C,k){var G=He.T;He.T=null;var ee=ut.p;try{ut.p=8,vd(m,v,C,k)}finally{ut.p=ee,He.T=G}}function vd(m,v,C,k){if(_v){var G=gm(k);if(G===null)rv(m,v,k,Uf,C),v1(m,k);else if(M2(G,m,v,C,k))k.stopPropagation();else if(v1(m,k),v&4&&-1<wv.indexOf(m)){for(;G!==null;){var ee=qt(G);if(ee!==null)switch(ee.tag){case 3:if(ee=ee.stateNode,ee.current.memoizedState.isDehydrated){var _e=cs(ee.pendingLanes);if(_e!==0){var Re=ee;for(Re.pendingLanes|=2,Re.entangledLanes|=2;_e;){var at=1<<31-pi(_e);Re.entanglements[1]|=at,_e&=~at}Su(ee),($n&6)===0&&(za=Ci()+500,wg(0))}}break;case 13:Re=jl(ee,2),Re!==null&&so(Re,ee,2),_u(),y1(ee,2)}if(ee=gm(k),ee===null&&rv(m,v,k,Uf,C),ee===G)break;G=ee}G!==null&&k.stopPropagation()}else rv(m,v,k,null,C)}}function gm(m){return m=of(m),Pg(m)}var Uf=null;function Pg(m){if(Uf=null,m=St(m),m!==null){var v=d(m);if(v===null)m=null;else{var C=v.tag;if(C===13){if(m=p(v),m!==null)return m;m=null}else if(C===3){if(v.stateNode.current.memoizedState.isDehydrated)return v.tag===3?v.stateNode.containerInfo:null;m=null}else v!==m&&(m=null)}}return Uf=m,null}function Ng(m){switch(m){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ls()){case wa:return 2;case Xa:return 8;case Ds:case Ft:return 32;case Hn:return 268435456;default:return 32}default:return 32}}var bv=!1,zh=null,Lh=null,Fh=null,_0=new Map,b0=new Map,Bh=[],wv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function v1(m,v){switch(m){case"focusin":case"focusout":zh=null;break;case"dragenter":case"dragleave":Lh=null;break;case"mouseover":case"mouseout":Fh=null;break;case"pointerover":case"pointerout":_0.delete(v.pointerId);break;case"gotpointercapture":case"lostpointercapture":b0.delete(v.pointerId)}}function w0(m,v,C,k,G,ee){return m===null||m.nativeEvent!==ee?(m={blockedOn:v,domEventName:C,eventSystemFlags:k,nativeEvent:ee,targetContainers:[G]},v!==null&&(v=qt(v),v!==null&&C2(v)),m):(m.eventSystemFlags|=k,v=m.targetContainers,G!==null&&v.indexOf(G)===-1&&v.push(G),m)}function M2(m,v,C,k,G){switch(v){case"focusin":return zh=w0(zh,m,v,C,k,G),!0;case"dragenter":return Lh=w0(Lh,m,v,C,k,G),!0;case"mouseover":return Fh=w0(Fh,m,v,C,k,G),!0;case"pointerover":var ee=G.pointerId;return _0.set(ee,w0(_0.get(ee)||null,m,v,C,k,G)),!0;case"gotpointercapture":return ee=G.pointerId,b0.set(ee,w0(b0.get(ee)||null,m,v,C,k,G)),!0}return!1}function Sv(m){var v=St(m.target);if(v!==null){var C=d(v);if(C!==null){if(v=C.tag,v===13){if(v=p(C),v!==null){m.blockedOn=v,te(m.priority,function(){if(C.tag===13){var k=Es();k=el(k);var G=jl(C,k);G!==null&&so(G,C,k),y1(C,k)}});return}}else if(v===3&&C.stateNode.current.memoizedState.isDehydrated){m.blockedOn=C.tag===3?C.stateNode.containerInfo:null;return}}}m.blockedOn=null}function S0(m){if(m.blockedOn!==null)return!1;for(var v=m.targetContainers;0<v.length;){var C=gm(m.nativeEvent);if(C===null){C=m.nativeEvent;var k=new C.constructor(C.type,C);_s=k,C.target.dispatchEvent(k),_s=null}else return v=qt(C),v!==null&&C2(v),m.blockedOn=C,!1;v.shift()}return!0}function _1(m,v,C){S0(m)&&C.delete(v)}function P2(){bv=!1,zh!==null&&S0(zh)&&(zh=null),Lh!==null&&S0(Lh)&&(Lh=null),Fh!==null&&S0(Fh)&&(Fh=null),_0.forEach(_1),b0.forEach(_1)}function T0(m,v){m.blockedOn===v&&(m.blockedOn=null,bv||(bv=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,P2)))}var E0=null;function N2(m){E0!==m&&(E0=m,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){E0===m&&(E0=null);for(var v=0;v<m.length;v+=3){var C=m[v],k=m[v+1],G=m[v+2];if(typeof k!="function"){if(Pg(k||C)===null)continue;break}var ee=qt(C);ee!==null&&(m.splice(v,3),v-=3,wh(ee,{pending:!0,data:G,method:C.method,action:k},k,G))}}))}function Dg(m){function v(at){return T0(at,m)}zh!==null&&T0(zh,m),Lh!==null&&T0(Lh,m),Fh!==null&&T0(Fh,m),_0.forEach(v),b0.forEach(v);for(var C=0;C<Bh.length;C++){var k=Bh[C];k.blockedOn===m&&(k.blockedOn=null)}for(;0<Bh.length&&(C=Bh[0],C.blockedOn===null);)Sv(C),C.blockedOn===null&&Bh.shift();if(C=(m.ownerDocument||m).$$reactFormReplay,C!=null)for(k=0;k<C.length;k+=3){var G=C[k],ee=C[k+1],_e=G[Me]||null;if(typeof ee=="function")_e||N2(C);else if(_e){var Re=null;if(ee&&ee.hasAttribute("formAction")){if(G=ee,_e=ee[Me]||null)Re=_e.formAction;else if(Pg(G)!==null)continue}else Re=_e.action;typeof Re=="function"?C[k+1]=Re:(C.splice(k,3),k-=3),N2(C)}}}function Tv(m){this._internalRoot=m}_d.prototype.render=Tv.prototype.render=function(m){var v=this._internalRoot;if(v===null)throw Error(r(409));var C=v.current,k=Es();x1(C,k,m,v,null,null)},_d.prototype.unmount=Tv.prototype.unmount=function(){var m=this._internalRoot;if(m!==null){this._internalRoot=null;var v=m.containerInfo;x1(m.current,2,null,m,null,null),_u(),v[De]=null}};function _d(m){this._internalRoot=m}_d.prototype.unstable_scheduleHydration=function(m){if(m){var v=Te();m={blockedOn:null,target:m,priority:v};for(var C=0;C<Bh.length&&v!==0&&v<Bh[C].priority;C++);Bh.splice(C,0,m),C===0&&Sv(m)}};var b1=t.version;if(b1!=="19.1.0")throw Error(r(527,b1,"19.1.0"));ut.findDOMNode=function(m){var v=m._reactInternals;if(v===void 0)throw typeof m.render=="function"?Error(r(188)):(m=Object.keys(m).join(","),Error(r(268,m)));return m=b(v),m=m!==null?T(m):null,m=m===null?null:m.stateNode,m};var D2={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:He,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var A0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!A0.isDisabled&&A0.supportsFiber)try{tr=A0.inject(D2),Qn=A0}catch{}}return W1.createRoot=function(m,v){if(!l(m))throw Error(r(299));var C=!1,k="",G=Ph,ee=Of,_e=yg,Re=null;return v!=null&&(v.unstable_strictMode===!0&&(C=!0),v.identifierPrefix!==void 0&&(k=v.identifierPrefix),v.onUncaughtError!==void 0&&(G=v.onUncaughtError),v.onCaughtError!==void 0&&(ee=v.onCaughtError),v.onRecoverableError!==void 0&&(_e=v.onRecoverableError),v.unstable_transitionCallbacks!==void 0&&(Re=v.unstable_transitionCallbacks)),v=g1(m,1,!1,null,null,C,k,G,ee,_e,Re,null),m[De]=v.current,f0(m),new Tv(v)},W1.hydrateRoot=function(m,v,C){if(!l(m))throw Error(r(299));var k=!1,G="",ee=Ph,_e=Of,Re=yg,at=null,Lt=null;return C!=null&&(C.unstable_strictMode===!0&&(k=!0),C.identifierPrefix!==void 0&&(G=C.identifierPrefix),C.onUncaughtError!==void 0&&(ee=C.onUncaughtError),C.onCaughtError!==void 0&&(_e=C.onCaughtError),C.onRecoverableError!==void 0&&(Re=C.onRecoverableError),C.unstable_transitionCallbacks!==void 0&&(at=C.unstable_transitionCallbacks),C.formState!==void 0&&(Lt=C.formState)),v=g1(m,1,!0,v,C??null,k,G,ee,_e,Re,at,Lt),v.context=yv(null),C=v.current,k=Es(),k=el(k),G=Ic(k),G.callback=null,uc(C,G,k),C=k,v.current.lanes=C,Kl(v,C),Su(v),m[De]=v.current,f0(m),new _d(v)},W1.version="19.1.0",W1}var CR;function hee(){if(CR)return iC.exports;CR=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),iC.exports=dee(),iC.exports}var fee=hee();const pee=Gs(fee);var lC={exports:{}},cC={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jR;function mee(){if(jR)return cC;jR=1;var e=b_();function t(b,T){return b===T&&(b!==0||1/b===1/T)||b!==b&&T!==T}var n=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,l=e.useRef,d=e.useEffect,p=e.useMemo,a=e.useDebugValue;return cC.useSyncExternalStoreWithSelector=function(b,T,E,P,I){var R=l(null);if(R.current===null){var F={hasValue:!1,value:null};R.current=F}else F=R.current;R=p(function(){function $(ae){if(!Z){if(Z=!0,ne=ae,ae=P(ae),I!==void 0&&F.hasValue){var se=F.value;if(I(se,ae))return ie=se}return ie=ae}if(se=ie,n(ne,ae))return se;var me=P(ae);return I!==void 0&&I(se,me)?(ne=ae,se):(ne=ae,ie=me)}var Z=!1,ne,ie,ge=E===void 0?null:E;return[function(){return $(T())},ge===null?void 0:function(){return $(ge())}]},[T,E,P,I]);var W=r(b,R[0],R[1]);return d(function(){F.hasValue=!0,F.value=W},[W]),a(W),W},cC}var MR;function gee(){return MR||(MR=1,lC.exports=mee()),lC.exports}var xee=gee();function yee(e){e()}function vee(){let e=null,t=null;return{clear(){e=null,t=null},notify(){yee(()=>{let n=e;for(;n;)n.callback(),n=n.next})},get(){const n=[];let r=e;for(;r;)n.push(r),r=r.next;return n},subscribe(n){let r=!0;const l=t={callback:n,next:null,prev:t};return l.prev?l.prev.next=l:e=l,function(){!r||e===null||(r=!1,l.next?l.next.prev=l.prev:t=l.prev,l.prev?l.prev.next=l.next:e=l.next)}}}}var PR={notify(){},get:()=>[]};function _ee(e,t){let n,r=PR,l=0,d=!1;function p(W){E();const $=r.subscribe(W);let Z=!1;return()=>{Z||(Z=!0,$(),P())}}function a(){r.notify()}function b(){F.onStateChange&&F.onStateChange()}function T(){return d}function E(){l++,n||(n=e.subscribe(b),r=vee())}function P(){l--,n&&l===0&&(n(),n=void 0,r.clear(),r=PR)}function I(){d||(d=!0,E())}function R(){d&&(d=!1,P())}const F={addNestedSub:p,notifyNestedSubs:a,handleChangeWrapper:b,isSubscribed:T,trySubscribe:I,tryUnsubscribe:R,getListeners:()=>r};return F}var bee=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",wee=bee(),See=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Tee=See(),Eee=()=>wee||Tee?V.useLayoutEffect:V.useEffect,Aee=Eee(),uC=Symbol.for("react-redux-context"),dC=typeof globalThis<"u"?globalThis:{};function Cee(){if(!V.createContext)return{};const e=dC[uC]??(dC[uC]=new Map);let t=e.get(V.createContext);return t||(t=V.createContext(null),e.set(V.createContext,t)),t}var ex=Cee();function jee(e){const{children:t,context:n,serverState:r,store:l}=e,d=V.useMemo(()=>{const b=_ee(l);return{store:l,subscription:b,getServerState:r?()=>r:void 0}},[l,r]),p=V.useMemo(()=>l.getState(),[l]);Aee(()=>{const{subscription:b}=d;return b.onStateChange=b.notifyNestedSubs,b.trySubscribe(),p!==l.getState()&&b.notifyNestedSubs(),()=>{b.tryUnsubscribe(),b.onStateChange=void 0}},[d,p]);const a=n||ex;return V.createElement(a.Provider,{value:d},t)}var cV=jee;function pP(e=ex){return function(){return V.useContext(e)}}var uV=pP();function dV(e=ex){const t=e===ex?uV:pP(e),n=()=>{const{store:r}=t();return r};return Object.assign(n,{withTypes:()=>n}),n}var Mee=dV();function Pee(e=ex){const t=e===ex?Mee:dV(e),n=()=>t().dispatch;return Object.assign(n,{withTypes:()=>n}),n}var br=Pee(),Nee=(e,t)=>e===t;function Dee(e=ex){const t=e===ex?uV:pP(e),n=(r,l={})=>{const{equalityFn:d=Nee}=typeof l=="function"?{equalityFn:l}:l,p=t(),{store:a,subscription:b,getServerState:T}=p;V.useRef(!0);const E=V.useCallback({[r.name](I){return r(I)}}[r.name],[r]),P=xee.useSyncExternalStoreWithSelector(b.addNestedSub,a.getState,T||a.getState,E,d);return V.useDebugValue(P),P};return Object.assign(n,{withTypes:()=>n}),n}var ln=Dee();function hl(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Oee=typeof Symbol=="function"&&Symbol.observable||"@@observable",NR=Oee,hC=()=>Math.random().toString(36).substring(7).split("").join("."),Iee={INIT:`@@redux/INIT${hC()}`,REPLACE:`@@redux/REPLACE${hC()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${hC()}`},ST=Iee;function mP(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function hV(e,t,n){if(typeof e!="function")throw new Error(hl(2));if(typeof t=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(hl(0));if(typeof t=="function"&&typeof n>"u"&&(n=t,t=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(hl(1));return n(hV)(e,t)}let r=e,l=t,d=new Map,p=d,a=0,b=!1;function T(){p===d&&(p=new Map,d.forEach(($,Z)=>{p.set(Z,$)}))}function E(){if(b)throw new Error(hl(3));return l}function P($){if(typeof $!="function")throw new Error(hl(4));if(b)throw new Error(hl(5));let Z=!0;T();const ne=a++;return p.set(ne,$),function(){if(Z){if(b)throw new Error(hl(6));Z=!1,T(),p.delete(ne),d=null}}}function I($){if(!mP($))throw new Error(hl(7));if(typeof $.type>"u")throw new Error(hl(8));if(typeof $.type!="string")throw new Error(hl(17));if(b)throw new Error(hl(9));try{b=!0,l=r(l,$)}finally{b=!1}return(d=p).forEach(ne=>{ne()}),$}function R($){if(typeof $!="function")throw new Error(hl(10));r=$,I({type:ST.REPLACE})}function F(){const $=P;return{subscribe(Z){if(typeof Z!="object"||Z===null)throw new Error(hl(11));function ne(){const ge=Z;ge.next&&ge.next(E())}return ne(),{unsubscribe:$(ne)}},[NR](){return this}}}return I({type:ST.INIT}),{dispatch:I,subscribe:P,getState:E,replaceReducer:R,[NR]:F}}function kee(e){Object.keys(e).forEach(t=>{const n=e[t];if(typeof n(void 0,{type:ST.INIT})>"u")throw new Error(hl(12));if(typeof n(void 0,{type:ST.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(hl(13))})}function fV(e){const t=Object.keys(e),n={};for(let d=0;d<t.length;d++){const p=t[d];typeof e[p]=="function"&&(n[p]=e[p])}const r=Object.keys(n);let l;try{kee(n)}catch(d){l=d}return function(p={},a){if(l)throw l;let b=!1;const T={};for(let E=0;E<r.length;E++){const P=r[E],I=n[P],R=p[P],F=I(R,a);if(typeof F>"u")throw a&&a.type,new Error(hl(14));T[P]=F,b=b||F!==R}return b=b||r.length!==Object.keys(p).length,b?T:p}}function TT(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,n)=>(...r)=>t(n(...r)))}function Ree(...e){return t=>(n,r)=>{const l=t(n,r);let d=()=>{throw new Error(hl(15))};const p={getState:l.getState,dispatch:(b,...T)=>d(b,...T)},a=e.map(b=>b(p));return d=TT(...a)(l.dispatch),{...l,dispatch:d}}}function pV(e){return mP(e)&&"type"in e&&typeof e.type=="string"}var mV=Symbol.for("immer-nothing"),DR=Symbol.for("immer-draftable"),zu=Symbol.for("immer-state");function Gh(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var o_=Object.getPrototypeOf;function ly(e){return!!e&&!!e[zu]}function Mm(e){var t;return e?gV(e)||Array.isArray(e)||!!e[DR]||!!((t=e.constructor)!=null&&t[DR])||LE(e)||FE(e):!1}var zee=Object.prototype.constructor.toString();function gV(e){if(!e||typeof e!="object")return!1;const t=o_(e);if(t===null)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===zee}function ET(e,t){zE(e)===0?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function zE(e){const t=e[zu];return t?t.type_:Array.isArray(e)?1:LE(e)?2:FE(e)?3:0}function sM(e,t){return zE(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function xV(e,t,n){const r=zE(e);r===2?e.set(t,n):r===3?e.add(n):e[t]=n}function Lee(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function LE(e){return e instanceof Map}function FE(e){return e instanceof Set}function k0(e){return e.copy_||e.base_}function oM(e,t){if(LE(e))return new Map(e);if(FE(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=gV(e);if(t===!0||t==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(e);delete r[zu];let l=Reflect.ownKeys(r);for(let d=0;d<l.length;d++){const p=l[d],a=r[p];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(r[p]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[p]})}return Object.create(o_(e),r)}else{const r=o_(e);if(r!==null&&n)return{...e};const l=Object.create(r);return Object.assign(l,e)}}function gP(e,t=!1){return BE(e)||ly(e)||!Mm(e)||(zE(e)>1&&(e.set=e.add=e.clear=e.delete=Fee),Object.freeze(e),t&&Object.entries(e).forEach(([n,r])=>gP(r,!0))),e}function Fee(){Gh(2)}function BE(e){return Object.isFrozen(e)}var Bee={};function cy(e){const t=Bee[e];return t||Gh(0,e),t}var Xb;function yV(){return Xb}function Vee(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function OR(e,t){t&&(cy("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function lM(e){cM(e),e.drafts_.forEach(Uee),e.drafts_=null}function cM(e){e===Xb&&(Xb=e.parent_)}function IR(e){return Xb=Vee(Xb,e)}function Uee(e){const t=e[zu];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function kR(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[zu].modified_&&(lM(t),Gh(4)),Mm(e)&&(e=AT(t,e),t.parent_||CT(t,e)),t.patches_&&cy("Patches").generateReplacementPatches_(n[zu].base_,e,t.patches_,t.inversePatches_)):e=AT(t,n,[]),lM(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==mV?e:void 0}function AT(e,t,n){if(BE(t))return t;const r=t[zu];if(!r)return ET(t,(l,d)=>RR(e,r,t,l,d,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return CT(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const l=r.copy_;let d=l,p=!1;r.type_===3&&(d=new Set(l),l.clear(),p=!0),ET(d,(a,b)=>RR(e,r,l,a,b,n,p)),CT(e,l,!1),n&&e.patches_&&cy("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function RR(e,t,n,r,l,d,p){if(ly(l)){const a=d&&t&&t.type_!==3&&!sM(t.assigned_,r)?d.concat(r):void 0,b=AT(e,l,a);if(xV(n,r,b),ly(b))e.canAutoFreeze_=!1;else return}else p&&n.add(l);if(Mm(l)&&!BE(l)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;AT(e,l),(!t||!t.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&CT(e,l)}}function CT(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&gP(t,n)}function $ee(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:yV(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let l=r,d=xP;n&&(l=[r],d=Kb);const{revoke:p,proxy:a}=Proxy.revocable(l,d);return r.draft_=a,r.revoke_=p,a}var xP={get(e,t){if(t===zu)return e;const n=k0(e);if(!sM(n,t))return qee(e,n,t);const r=n[t];return e.finalized_||!Mm(r)?r:r===fC(e.base_,t)?(pC(e),e.copy_[t]=dM(r,e)):r},has(e,t){return t in k0(e)},ownKeys(e){return Reflect.ownKeys(k0(e))},set(e,t,n){const r=vV(k0(e),t);if(r!=null&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const l=fC(k0(e),t),d=l==null?void 0:l[zu];if(d&&d.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(Lee(n,l)&&(n!==void 0||sM(e.base_,t)))return!0;pC(e),uM(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return fC(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,pC(e),uM(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=k0(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:r.enumerable,value:n[t]}},defineProperty(){Gh(11)},getPrototypeOf(e){return o_(e.base_)},setPrototypeOf(){Gh(12)}},Kb={};ET(xP,(e,t)=>{Kb[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Kb.deleteProperty=function(e,t){return Kb.set.call(this,e,t,void 0)};Kb.set=function(e,t,n){return xP.set.call(this,e[0],t,n,e[0])};function fC(e,t){const n=e[zu];return(n?k0(n):e)[t]}function qee(e,t,n){var l;const r=vV(t,n);return r?"value"in r?r.value:(l=r.get)==null?void 0:l.call(e.draft_):void 0}function vV(e,t){if(!(t in e))return;let n=o_(e);for(;n;){const r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=o_(n)}}function uM(e){e.modified_||(e.modified_=!0,e.parent_&&uM(e.parent_))}function pC(e){e.copy_||(e.copy_=oM(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Hee=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,n,r)=>{if(typeof t=="function"&&typeof n!="function"){const d=n;n=t;const p=this;return function(b=d,...T){return p.produce(b,E=>n.call(this,E,...T))}}typeof n!="function"&&Gh(6),r!==void 0&&typeof r!="function"&&Gh(7);let l;if(Mm(t)){const d=IR(this),p=dM(t,void 0);let a=!0;try{l=n(p),a=!1}finally{a?lM(d):cM(d)}return OR(d,r),kR(l,d)}else if(!t||typeof t!="object"){if(l=n(t),l===void 0&&(l=t),l===mV&&(l=void 0),this.autoFreeze_&&gP(l,!0),r){const d=[],p=[];cy("Patches").generateReplacementPatches_(t,l,d,p),r(d,p)}return l}else Gh(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(p,...a)=>this.produceWithPatches(p,b=>t(b,...a));let r,l;return[this.produce(t,n,(p,a)=>{r=p,l=a}),r,l]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Mm(e)||Gh(8),ly(e)&&(e=Tm(e));const t=IR(this),n=dM(e,void 0);return n[zu].isManual_=!0,cM(t),n}finishDraft(e,t){const n=e&&e[zu];(!n||!n.isManual_)&&Gh(9);const{scope_:r}=n;return OR(r,t),kR(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const l=t[n];if(l.path.length===0&&l.op==="replace"){e=l.value;break}}n>-1&&(t=t.slice(n+1));const r=cy("Patches").applyPatches_;return ly(e)?r(e,t):this.produce(e,l=>r(l,t))}};function dM(e,t){const n=LE(e)?cy("MapSet").proxyMap_(e,t):FE(e)?cy("MapSet").proxySet_(e,t):$ee(e,t);return(t?t.scope_:yV()).drafts_.push(n),n}function Tm(e){return ly(e)||Gh(10,e),_V(e)}function _V(e){if(!Mm(e)||BE(e))return e;const t=e[zu];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=oM(e,t.scope_.immer_.useStrictShallowCopy_)}else n=oM(e,!0);return ET(n,(r,l)=>{xV(n,r,_V(l))}),t&&(t.finalized_=!1),n}var Lu=new Hee,bV=Lu.produce;Lu.produceWithPatches.bind(Lu);Lu.setAutoFreeze.bind(Lu);Lu.setUseStrictShallowCopy.bind(Lu);Lu.applyPatches.bind(Lu);Lu.createDraft.bind(Lu);Lu.finishDraft.bind(Lu);function Gee(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Wee(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Zee(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(n=>typeof n=="function")){const n=e.map(r=>typeof r=="function"?`function ${r.name||"unnamed"}()`:typeof r).join(", ");throw new TypeError(`${t}[${n}]`)}}var zR=e=>Array.isArray(e)?e:[e];function Xee(e){const t=Array.isArray(e[0])?e[0]:e;return Zee(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Kee(e,t){const n=[],{length:r}=e;for(let l=0;l<r;l++)n.push(e[l].apply(null,t));return n}var Yee=class{constructor(e){this.value=e}deref(){return this.value}},Qee=typeof WeakRef<"u"?WeakRef:Yee,Jee=0,LR=1;function mS(){return{s:Jee,v:void 0,o:null,p:null}}function wV(e,t={}){let n=mS();const{resultEqualityCheck:r}=t;let l,d=0;function p(){var P;let a=n;const{length:b}=arguments;for(let I=0,R=b;I<R;I++){const F=arguments[I];if(typeof F=="function"||typeof F=="object"&&F!==null){let W=a.o;W===null&&(a.o=W=new WeakMap);const $=W.get(F);$===void 0?(a=mS(),W.set(F,a)):a=$}else{let W=a.p;W===null&&(a.p=W=new Map);const $=W.get(F);$===void 0?(a=mS(),W.set(F,a)):a=$}}const T=a;let E;if(a.s===LR)E=a.v;else if(E=e.apply(null,arguments),d++,r){const I=((P=l==null?void 0:l.deref)==null?void 0:P.call(l))??l;I!=null&&r(I,E)&&(E=I,d!==0&&d--),l=typeof E=="object"&&E!==null||typeof E=="function"?new Qee(E):E}return T.s=LR,T.v=E,E}return p.clearCache=()=>{n=mS(),p.resetResultsCount()},p.resultsCount=()=>d,p.resetResultsCount=()=>{d=0},p}function ete(e,...t){const n=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,r=(...l)=>{let d=0,p=0,a,b={},T=l.pop();typeof T=="object"&&(b=T,T=l.pop()),Gee(T,`createSelector expects an output function after the inputs, but received: [${typeof T}]`);const E={...n,...b},{memoize:P,memoizeOptions:I=[],argsMemoize:R=wV,argsMemoizeOptions:F=[]}=E,W=zR(I),$=zR(F),Z=Xee(l),ne=P(function(){return d++,T.apply(null,arguments)},...W),ie=R(function(){p++;const ae=Kee(Z,arguments);return a=ne.apply(null,ae),a},...$);return Object.assign(ie,{resultFunc:T,memoizedResultFunc:ne,dependencies:Z,dependencyRecomputations:()=>p,resetDependencyRecomputations:()=>{p=0},lastResult:()=>a,recomputations:()=>d,resetRecomputations:()=>{d=0},memoize:P,argsMemoize:R})};return Object.assign(r,{withTypes:()=>r}),r}var tn=ete(wV),tte=Object.assign((e,t=tn)=>{Wee(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const n=Object.keys(e),r=n.map(d=>e[d]);return t(r,(...d)=>d.reduce((p,a,b)=>(p[n[b]]=a,p),{}))},{withTypes:()=>tte});function SV(e){return({dispatch:n,getState:r})=>l=>d=>typeof d=="function"?d(n,r,e):l(d)}var nte=SV(),rte=SV,ite=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?TT:TT.apply(null,arguments)},ate=e=>e&&typeof e.match=="function";function Xl(e,t){function n(...r){if(t){let l=t(...r);if(!l)throw new Error(ku(0));return{type:e,payload:l.payload,..."meta"in l&&{meta:l.meta},..."error"in l&&{error:l.error}}}return{type:e,payload:r[0]}}return n.toString=()=>`${e}`,n.type=e,n.match=r=>pV(r)&&r.type===e,n}var TV=class yb extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,yb.prototype)}static get[Symbol.species](){return yb}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new yb(...t[0].concat(this)):new yb(...t.concat(this))}};function FR(e){return Mm(e)?bV(e,()=>{}):e}function gS(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}function ste(e){return typeof e=="boolean"}var ote=()=>function(t){const{thunk:n=!0,immutableCheck:r=!0,serializableCheck:l=!0,actionCreatorCheck:d=!0}=t??{};let p=new TV;return n&&(ste(n)?p.push(nte):p.push(rte(n.extraArgument))),p},lte="RTK_autoBatch",BR=e=>t=>{setTimeout(t,e)},cte=(e={type:"raf"})=>t=>(...n)=>{const r=t(...n);let l=!0,d=!1,p=!1;const a=new Set,b=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:BR(10):e.type==="callback"?e.queueNotification:BR(e.timeout),T=()=>{p=!1,d&&(d=!1,a.forEach(E=>E()))};return Object.assign({},r,{subscribe(E){const P=()=>l&&E(),I=r.subscribe(P);return a.add(E),()=>{I(),a.delete(E)}},dispatch(E){var P;try{return l=!((P=E==null?void 0:E.meta)!=null&&P[lte]),d=!l,d&&(p||(p=!0,b(T))),r.dispatch(E)}finally{l=!0}}})},ute=e=>function(n){const{autoBatch:r=!0}=n??{};let l=new TV(e);return r&&l.push(cte(typeof r=="object"?r:void 0)),l};function EV(e){const t=ote(),{reducer:n=void 0,middleware:r,devTools:l=!0,duplicateMiddlewareCheck:d=!0,preloadedState:p=void 0,enhancers:a=void 0}=e||{};let b;if(typeof n=="function")b=n;else if(mP(n))b=fV(n);else throw new Error(ku(1));let T;typeof r=="function"?T=r(t):T=t();let E=TT;l&&(E=ite({trace:!1,...typeof l=="object"&&l}));const P=Ree(...T),I=ute(P);let R=typeof a=="function"?a(I):I();const F=E(...R);return hV(b,p,F)}function AV(e){const t={},n=[];let r;const l={addCase(d,p){const a=typeof d=="string"?d:d.type;if(!a)throw new Error(ku(28));if(a in t)throw new Error(ku(29));return t[a]=p,l},addMatcher(d,p){return n.push({matcher:d,reducer:p}),l},addDefaultCase(d){return r=d,l}};return e(l),[t,n,r]}function dte(e){return typeof e=="function"}function hte(e,t){let[n,r,l]=AV(t),d;if(dte(e))d=()=>FR(e());else{const a=FR(e);d=()=>a}function p(a=d(),b){let T=[n[b.type],...r.filter(({matcher:E})=>E(b)).map(({reducer:E})=>E)];return T.filter(E=>!!E).length===0&&(T=[l]),T.reduce((E,P)=>{if(P)if(ly(E)){const R=P(E,b);return R===void 0?E:R}else{if(Mm(E))return bV(E,I=>P(I,b));{const I=P(E,b);if(I===void 0){if(E===null)return E;throw Error("A case reducer on a non-draftable value must not return undefined")}return I}}return E},a)}return p.getInitialState=d,p}var fte=(e,t)=>ate(e)?e.match(t):e(t);function pte(...e){return t=>e.some(n=>fte(n,t))}var mte="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",CV=(e=21)=>{let t="",n=e;for(;n--;)t+=mte[Math.random()*64|0];return t},gte=["name","message","stack","code"],mC=class{constructor(e,t){Au(this,"_type");this.payload=e,this.meta=t}},VR=class{constructor(e,t){Au(this,"_type");this.payload=e,this.meta=t}},xte=e=>{if(typeof e=="object"&&e!==null){const t={};for(const n of gte)typeof e[n]=="string"&&(t[n]=e[n]);return t}return{message:String(e)}},UR="External signal was aborted",xi=(()=>{function e(t,n,r){const l=Xl(t+"/fulfilled",(b,T,E,P)=>({payload:b,meta:{...P||{},arg:E,requestId:T,requestStatus:"fulfilled"}})),d=Xl(t+"/pending",(b,T,E)=>({payload:void 0,meta:{...E||{},arg:T,requestId:b,requestStatus:"pending"}})),p=Xl(t+"/rejected",(b,T,E,P,I)=>({payload:P,error:(r&&r.serializeError||xte)(b||"Rejected"),meta:{...I||{},arg:E,requestId:T,rejectedWithValue:!!P,requestStatus:"rejected",aborted:(b==null?void 0:b.name)==="AbortError",condition:(b==null?void 0:b.name)==="ConditionError"}}));function a(b,{signal:T}={}){return(E,P,I)=>{const R=r!=null&&r.idGenerator?r.idGenerator(b):CV(),F=new AbortController;let W,$;function Z(ie){$=ie,F.abort()}T&&(T.aborted?Z(UR):T.addEventListener("abort",()=>Z(UR),{once:!0}));const ne=async function(){var ae,se;let ie;try{let me=(ae=r==null?void 0:r.condition)==null?void 0:ae.call(r,b,{getState:P,extra:I});if(vte(me)&&(me=await me),me===!1||F.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const ke=new Promise((qe,tt)=>{W=()=>{tt({name:"AbortError",message:$||"Aborted"})},F.signal.addEventListener("abort",W)});E(d(R,b,(se=r==null?void 0:r.getPendingMeta)==null?void 0:se.call(r,{requestId:R,arg:b},{getState:P,extra:I}))),ie=await Promise.race([ke,Promise.resolve(n(b,{dispatch:E,getState:P,extra:I,requestId:R,signal:F.signal,abort:Z,rejectWithValue:(qe,tt)=>new mC(qe,tt),fulfillWithValue:(qe,tt)=>new VR(qe,tt)})).then(qe=>{if(qe instanceof mC)throw qe;return qe instanceof VR?l(qe.payload,R,b,qe.meta):l(qe,R,b)})])}catch(me){ie=me instanceof mC?p(null,R,b,me.payload,me.meta):p(me,R,b)}finally{W&&F.signal.removeEventListener("abort",W)}return r&&!r.dispatchConditionRejection&&p.match(ie)&&ie.meta.condition||E(ie),ie}();return Object.assign(ne,{abort:Z,requestId:R,arg:b,unwrap(){return ne.then(yte)}})}}return Object.assign(a,{pending:d,rejected:p,fulfilled:l,settled:pte(p,l),typePrefix:t})}return e.withTypes=()=>e,e})();function yte(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function vte(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var _te=Symbol.for("rtk-slice-createasyncthunk");function bte(e,t){return`${e}/${t}`}function wte({creators:e}={}){var n;const t=(n=e==null?void 0:e.asyncThunk)==null?void 0:n[_te];return function(l){const{name:d,reducerPath:p=d}=l;if(!d)throw new Error(ku(11));const a=(typeof l.reducers=="function"?l.reducers(Tte()):l.reducers)||{},b=Object.keys(a),T={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},E={addCase(ge,ae){const se=typeof ge=="string"?ge:ge.type;if(!se)throw new Error(ku(12));if(se in T.sliceCaseReducersByType)throw new Error(ku(13));return T.sliceCaseReducersByType[se]=ae,E},addMatcher(ge,ae){return T.sliceMatchers.push({matcher:ge,reducer:ae}),E},exposeAction(ge,ae){return T.actionCreators[ge]=ae,E},exposeCaseReducer(ge,ae){return T.sliceCaseReducersByName[ge]=ae,E}};b.forEach(ge=>{const ae=a[ge],se={reducerName:ge,type:bte(d,ge),createNotation:typeof l.reducers=="function"};Ate(ae)?jte(se,ae,E,t):Ete(se,ae,E)});function P(){const[ge={},ae=[],se=void 0]=typeof l.extraReducers=="function"?AV(l.extraReducers):[l.extraReducers],me={...ge,...T.sliceCaseReducersByType};return hte(l.initialState,ke=>{for(let qe in me)ke.addCase(qe,me[qe]);for(let qe of T.sliceMatchers)ke.addMatcher(qe.matcher,qe.reducer);for(let qe of ae)ke.addMatcher(qe.matcher,qe.reducer);se&&ke.addDefaultCase(se)})}const I=ge=>ge,R=new Map,F=new WeakMap;let W;function $(ge,ae){return W||(W=P()),W(ge,ae)}function Z(){return W||(W=P()),W.getInitialState()}function ne(ge,ae=!1){function se(ke){let qe=ke[ge];return typeof qe>"u"&&ae&&(qe=gS(F,se,Z)),qe}function me(ke=I){const qe=gS(R,ae,()=>new WeakMap);return gS(qe,ke,()=>{const tt={};for(const[nt,bt]of Object.entries(l.selectors??{}))tt[nt]=Ste(bt,ke,()=>gS(F,ke,Z),ae);return tt})}return{reducerPath:ge,getSelectors:me,get selectors(){return me(se)},selectSlice:se}}const ie={name:d,reducer:$,actions:T.actionCreators,caseReducers:T.sliceCaseReducersByName,getInitialState:Z,...ne(p),injectInto(ge,{reducerPath:ae,...se}={}){const me=ae??p;return ge.inject({reducerPath:me,reducer:$},se),{...ie,...ne(me,!0)}}};return ie}}function Ste(e,t,n,r){function l(d,...p){let a=t(d);return typeof a>"u"&&r&&(a=n()),e(a,...p)}return l.unwrapped=e,l}var Ia=wte();function Tte(){function e(t,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...n}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...n){return t(...n)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:n}},asyncThunk:e}}function Ete({type:e,reducerName:t,createNotation:n},r,l){let d,p;if("reducer"in r){if(n&&!Cte(r))throw new Error(ku(17));d=r.reducer,p=r.prepare}else d=r;l.addCase(e,d).exposeCaseReducer(t,d).exposeAction(t,p?Xl(e,p):Xl(e))}function Ate(e){return e._reducerDefinitionType==="asyncThunk"}function Cte(e){return e._reducerDefinitionType==="reducerWithPrepare"}function jte({type:e,reducerName:t},n,r,l){if(!l)throw new Error(ku(18));const{payloadCreator:d,fulfilled:p,pending:a,rejected:b,settled:T,options:E}=n,P=l(e,d,E);r.exposeAction(t,P),p&&r.addCase(P.fulfilled,p),a&&r.addCase(P.pending,a),b&&r.addCase(P.rejected,b),T&&r.addMatcher(P.settled,T),r.exposeCaseReducer(t,{fulfilled:p||xS,pending:a||xS,rejected:b||xS,settled:T||xS})}function xS(){}var Mte="task",jV="listener",MV="completed",yP="cancelled",Pte=`task-${yP}`,Nte=`task-${MV}`,hM=`${jV}-${yP}`,Dte=`${jV}-${MV}`,VE=class{constructor(e){Au(this,"name","TaskAbortError");Au(this,"message");this.code=e,this.message=`${Mte} ${yP} (reason: ${e})`}},vP=(e,t)=>{if(typeof e!="function")throw new TypeError(ku(32))},jT=()=>{},PV=(e,t=jT)=>(e.catch(t),e),NV=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Q0=(e,t)=>{const n=e.signal;n.aborted||("reason"in n||Object.defineProperty(n,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},J0=e=>{if(e.aborted){const{reason:t}=e;throw new VE(t)}};function DV(e,t){let n=jT;return new Promise((r,l)=>{const d=()=>l(new VE(e.reason));if(e.aborted){d();return}n=NV(e,d),t.finally(()=>n()).then(r,l)}).finally(()=>{n=jT})}var Ote=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(n){return{status:n instanceof VE?"cancelled":"rejected",error:n}}finally{t==null||t()}},MT=e=>t=>PV(DV(e,t).then(n=>(J0(e),n))),OV=e=>{const t=MT(e);return n=>t(new Promise(r=>setTimeout(r,n)))},{assign:t_}=Object,$R={},UE="listenerMiddleware",Ite=(e,t)=>{const n=r=>NV(e,()=>Q0(r,e.reason));return(r,l)=>{vP(r);const d=new AbortController;n(d);const p=Ote(async()=>{J0(e),J0(d.signal);const a=await r({pause:MT(d.signal),delay:OV(d.signal),signal:d.signal});return J0(d.signal),a},()=>Q0(d,Nte));return l!=null&&l.autoJoin&&t.push(p.catch(jT)),{result:MT(e)(p),cancel(){Q0(d,Pte)}}}},kte=(e,t)=>{const n=async(r,l)=>{J0(t);let d=()=>{};const a=[new Promise((b,T)=>{let E=e({predicate:r,effect:(P,I)=>{I.unsubscribe(),b([P,I.getState(),I.getOriginalState()])}});d=()=>{E(),T()}})];l!=null&&a.push(new Promise(b=>setTimeout(b,l,null)));try{const b=await DV(t,Promise.race(a));return J0(t),b}finally{d()}};return(r,l)=>PV(n(r,l))},IV=e=>{let{type:t,actionCreator:n,matcher:r,predicate:l,effect:d}=e;if(t)l=Xl(t).match;else if(n)t=n.type,l=n.match;else if(r)l=r;else if(!l)throw new Error(ku(21));return vP(d),{predicate:l,type:t,effect:d}},kV=t_(e=>{const{type:t,predicate:n,effect:r}=IV(e);return{id:CV(),effect:r,type:t,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(ku(22))}}},{withTypes:()=>kV}),qR=(e,t)=>{const{type:n,effect:r,predicate:l}=IV(t);return Array.from(e.values()).find(d=>(typeof n=="string"?d.type===n:d.predicate===l)&&d.effect===r)},fM=e=>{e.pending.forEach(t=>{Q0(t,hM)})},Rte=e=>()=>{e.forEach(fM),e.clear()},HR=(e,t,n)=>{try{e(t,n)}catch(r){setTimeout(()=>{throw r},0)}},RV=t_(Xl(`${UE}/add`),{withTypes:()=>RV}),zte=Xl(`${UE}/removeAll`),zV=t_(Xl(`${UE}/remove`),{withTypes:()=>zV}),Lte=(...e)=>{console.error(`${UE}/error`,...e)},jw=(e={})=>{const t=new Map,{extra:n,onError:r=Lte}=e;vP(r);const l=E=>(E.unsubscribe=()=>t.delete(E.id),t.set(E.id,E),P=>{E.unsubscribe(),P!=null&&P.cancelActive&&fM(E)}),d=E=>{const P=qR(t,E)??kV(E);return l(P)};t_(d,{withTypes:()=>d});const p=E=>{const P=qR(t,E);return P&&(P.unsubscribe(),E.cancelActive&&fM(P)),!!P};t_(p,{withTypes:()=>p});const a=async(E,P,I,R)=>{const F=new AbortController,W=kte(d,F.signal),$=[];try{E.pending.add(F),await Promise.resolve(E.effect(P,t_({},I,{getOriginalState:R,condition:(Z,ne)=>W(Z,ne).then(Boolean),take:W,delay:OV(F.signal),pause:MT(F.signal),extra:n,signal:F.signal,fork:Ite(F.signal,$),unsubscribe:E.unsubscribe,subscribe:()=>{t.set(E.id,E)},cancelActiveListeners:()=>{E.pending.forEach((Z,ne,ie)=>{Z!==F&&(Q0(Z,hM),ie.delete(Z))})},cancel:()=>{Q0(F,hM),E.pending.delete(F)},throwIfCancelled:()=>{J0(F.signal)}})))}catch(Z){Z instanceof VE||HR(r,Z,{raisedBy:"effect"})}finally{await Promise.all($),Q0(F,Dte),E.pending.delete(F)}},b=Rte(t);return{middleware:E=>P=>I=>{if(!pV(I))return P(I);if(RV.match(I))return d(I.payload);if(zte.match(I)){b();return}if(zV.match(I))return p(I.payload);let R=E.getState();const F=()=>{if(R===$R)throw new Error(ku(23));return R};let W;try{if(W=P(I),t.size>0){const $=E.getState(),Z=Array.from(t.values());for(const ne of Z){let ie=!1;try{ie=ne.predicate(I,$,R)}catch(ge){ie=!1,HR(r,ge,{raisedBy:"predicate"})}ie&&a(ne,I,E,F)}}}finally{R=$R}return W},startListening:d,stopListening:p,clearListeners:b}};function ku(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}function LV(e,t){return function(){return e.apply(t,arguments)}}const{toString:Fte}=Object.prototype,{getPrototypeOf:_P}=Object,{iterator:$E,toStringTag:FV}=Symbol,qE=(e=>t=>{const n=Fte.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Qh=e=>(e=e.toLowerCase(),t=>qE(t)===e),HE=e=>t=>typeof t===e,{isArray:w_}=Array,Yb=HE("undefined");function Bte(e){return e!==null&&!Yb(e)&&e.constructor!==null&&!Yb(e.constructor)&&Hc(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const BV=Qh("ArrayBuffer");function Vte(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&BV(e.buffer),t}const Ute=HE("string"),Hc=HE("function"),VV=HE("number"),GE=e=>e!==null&&typeof e=="object",$te=e=>e===!0||e===!1,WS=e=>{if(qE(e)!=="object")return!1;const t=_P(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(FV in e)&&!($E in e)},qte=Qh("Date"),Hte=Qh("File"),Gte=Qh("Blob"),Wte=Qh("FileList"),Zte=e=>GE(e)&&Hc(e.pipe),Xte=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Hc(e.append)&&((t=qE(e))==="formdata"||t==="object"&&Hc(e.toString)&&e.toString()==="[object FormData]"))},Kte=Qh("URLSearchParams"),[Yte,Qte,Jte,ene]=["ReadableStream","Request","Response","Headers"].map(Qh),tne=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Mw(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,l;if(typeof e!="object"&&(e=[e]),w_(e))for(r=0,l=e.length;r<l;r++)t.call(null,e[r],r,e);else{const d=n?Object.getOwnPropertyNames(e):Object.keys(e),p=d.length;let a;for(r=0;r<p;r++)a=d[r],t.call(null,e[a],a,e)}}function UV(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,l;for(;r-- >0;)if(l=n[r],t===l.toLowerCase())return l;return null}const V0=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,$V=e=>!Yb(e)&&e!==V0;function pM(){const{caseless:e}=$V(this)&&this||{},t={},n=(r,l)=>{const d=e&&UV(t,l)||l;WS(t[d])&&WS(r)?t[d]=pM(t[d],r):WS(r)?t[d]=pM({},r):w_(r)?t[d]=r.slice():t[d]=r};for(let r=0,l=arguments.length;r<l;r++)arguments[r]&&Mw(arguments[r],n);return t}const nne=(e,t,n,{allOwnKeys:r}={})=>(Mw(t,(l,d)=>{n&&Hc(l)?e[d]=LV(l,n):e[d]=l},{allOwnKeys:r}),e),rne=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),ine=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},ane=(e,t,n,r)=>{let l,d,p;const a={};if(t=t||{},e==null)return t;do{for(l=Object.getOwnPropertyNames(e),d=l.length;d-- >0;)p=l[d],(!r||r(p,e,t))&&!a[p]&&(t[p]=e[p],a[p]=!0);e=n!==!1&&_P(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},sne=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},one=e=>{if(!e)return null;if(w_(e))return e;let t=e.length;if(!VV(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},lne=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&_P(Uint8Array)),cne=(e,t)=>{const r=(e&&e[$E]).call(e);let l;for(;(l=r.next())&&!l.done;){const d=l.value;t.call(e,d[0],d[1])}},une=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},dne=Qh("HTMLFormElement"),hne=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,l){return r.toUpperCase()+l}),GR=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),fne=Qh("RegExp"),qV=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Mw(n,(l,d)=>{let p;(p=t(l,d,e))!==!1&&(r[d]=p||l)}),Object.defineProperties(e,r)},pne=e=>{qV(e,(t,n)=>{if(Hc(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(Hc(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},mne=(e,t)=>{const n={},r=l=>{l.forEach(d=>{n[d]=!0})};return w_(e)?r(e):r(String(e).split(t)),n},gne=()=>{},xne=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function yne(e){return!!(e&&Hc(e.append)&&e[FV]==="FormData"&&e[$E])}const vne=e=>{const t=new Array(10),n=(r,l)=>{if(GE(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[l]=r;const d=w_(r)?[]:{};return Mw(r,(p,a)=>{const b=n(p,l+1);!Yb(b)&&(d[a]=b)}),t[l]=void 0,d}}return r};return n(e,0)},_ne=Qh("AsyncFunction"),bne=e=>e&&(GE(e)||Hc(e))&&Hc(e.then)&&Hc(e.catch),HV=((e,t)=>e?setImmediate:t?((n,r)=>(V0.addEventListener("message",({source:l,data:d})=>{l===V0&&d===n&&r.length&&r.shift()()},!1),l=>{r.push(l),V0.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Hc(V0.postMessage)),wne=typeof queueMicrotask<"u"?queueMicrotask.bind(V0):typeof process<"u"&&process.nextTick||HV,Sne=e=>e!=null&&Hc(e[$E]),rn={isArray:w_,isArrayBuffer:BV,isBuffer:Bte,isFormData:Xte,isArrayBufferView:Vte,isString:Ute,isNumber:VV,isBoolean:$te,isObject:GE,isPlainObject:WS,isReadableStream:Yte,isRequest:Qte,isResponse:Jte,isHeaders:ene,isUndefined:Yb,isDate:qte,isFile:Hte,isBlob:Gte,isRegExp:fne,isFunction:Hc,isStream:Zte,isURLSearchParams:Kte,isTypedArray:lne,isFileList:Wte,forEach:Mw,merge:pM,extend:nne,trim:tne,stripBOM:rne,inherits:ine,toFlatObject:ane,kindOf:qE,kindOfTest:Qh,endsWith:sne,toArray:one,forEachEntry:cne,matchAll:une,isHTMLForm:dne,hasOwnProperty:GR,hasOwnProp:GR,reduceDescriptors:qV,freezeMethods:pne,toObjectSet:mne,toCamelCase:hne,noop:gne,toFiniteNumber:xne,findKey:UV,global:V0,isContextDefined:$V,isSpecCompliantForm:yne,toJSONObject:vne,isAsyncFn:_ne,isThenable:bne,setImmediate:HV,asap:wne,isIterable:Sne};function ji(e,t,n,r,l){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),l&&(this.response=l,this.status=l.status?l.status:null)}rn.inherits(ji,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:rn.toJSONObject(this.config),code:this.code,status:this.status}}});const GV=ji.prototype,WV={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{WV[e]={value:e}});Object.defineProperties(ji,WV);Object.defineProperty(GV,"isAxiosError",{value:!0});ji.from=(e,t,n,r,l,d)=>{const p=Object.create(GV);return rn.toFlatObject(e,p,function(b){return b!==Error.prototype},a=>a!=="isAxiosError"),ji.call(p,e.message,t,n,r,l),p.cause=e,p.name=e.name,d&&Object.assign(p,d),p};const Tne=null;function mM(e){return rn.isPlainObject(e)||rn.isArray(e)}function ZV(e){return rn.endsWith(e,"[]")?e.slice(0,-2):e}function WR(e,t,n){return e?e.concat(t).map(function(l,d){return l=ZV(l),!n&&d?"["+l+"]":l}).join(n?".":""):t}function Ene(e){return rn.isArray(e)&&!e.some(mM)}const Ane=rn.toFlatObject(rn,{},null,function(t){return/^is[A-Z]/.test(t)});function WE(e,t,n){if(!rn.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=rn.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(W,$){return!rn.isUndefined($[W])});const r=n.metaTokens,l=n.visitor||E,d=n.dots,p=n.indexes,b=(n.Blob||typeof Blob<"u"&&Blob)&&rn.isSpecCompliantForm(t);if(!rn.isFunction(l))throw new TypeError("visitor must be a function");function T(F){if(F===null)return"";if(rn.isDate(F))return F.toISOString();if(!b&&rn.isBlob(F))throw new ji("Blob is not supported. Use a Buffer instead.");return rn.isArrayBuffer(F)||rn.isTypedArray(F)?b&&typeof Blob=="function"?new Blob([F]):Buffer.from(F):F}function E(F,W,$){let Z=F;if(F&&!$&&typeof F=="object"){if(rn.endsWith(W,"{}"))W=r?W:W.slice(0,-2),F=JSON.stringify(F);else if(rn.isArray(F)&&Ene(F)||(rn.isFileList(F)||rn.endsWith(W,"[]"))&&(Z=rn.toArray(F)))return W=ZV(W),Z.forEach(function(ie,ge){!(rn.isUndefined(ie)||ie===null)&&t.append(p===!0?WR([W],ge,d):p===null?W:W+"[]",T(ie))}),!1}return mM(F)?!0:(t.append(WR($,W,d),T(F)),!1)}const P=[],I=Object.assign(Ane,{defaultVisitor:E,convertValue:T,isVisitable:mM});function R(F,W){if(!rn.isUndefined(F)){if(P.indexOf(F)!==-1)throw Error("Circular reference detected in "+W.join("."));P.push(F),rn.forEach(F,function(Z,ne){(!(rn.isUndefined(Z)||Z===null)&&l.call(t,Z,rn.isString(ne)?ne.trim():ne,W,I))===!0&&R(Z,W?W.concat(ne):[ne])}),P.pop()}}if(!rn.isObject(e))throw new TypeError("data must be an object");return R(e),t}function ZR(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function bP(e,t){this._pairs=[],e&&WE(e,this,t)}const XV=bP.prototype;XV.append=function(t,n){this._pairs.push([t,n])};XV.toString=function(t){const n=t?function(r){return t.call(this,r,ZR)}:ZR;return this._pairs.map(function(l){return n(l[0])+"="+n(l[1])},"").join("&")};function Cne(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function KV(e,t,n){if(!t)return e;const r=n&&n.encode||Cne;rn.isFunction(n)&&(n={serialize:n});const l=n&&n.serialize;let d;if(l?d=l(t,n):d=rn.isURLSearchParams(t)?t.toString():new bP(t,n).toString(r),d){const p=e.indexOf("#");p!==-1&&(e=e.slice(0,p)),e+=(e.indexOf("?")===-1?"?":"&")+d}return e}class XR{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){rn.forEach(this.handlers,function(r){r!==null&&t(r)})}}const YV={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},jne=typeof URLSearchParams<"u"?URLSearchParams:bP,Mne=typeof FormData<"u"?FormData:null,Pne=typeof Blob<"u"?Blob:null,Nne={isBrowser:!0,classes:{URLSearchParams:jne,FormData:Mne,Blob:Pne},protocols:["http","https","file","blob","url","data"]},wP=typeof window<"u"&&typeof document<"u",gM=typeof navigator=="object"&&navigator||void 0,Dne=wP&&(!gM||["ReactNative","NativeScript","NS"].indexOf(gM.product)<0),One=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Ine=wP&&window.location.href||"http://localhost",kne=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:wP,hasStandardBrowserEnv:Dne,hasStandardBrowserWebWorkerEnv:One,navigator:gM,origin:Ine},Symbol.toStringTag,{value:"Module"})),Gl={...kne,...Nne};function Rne(e,t){return WE(e,new Gl.classes.URLSearchParams,Object.assign({visitor:function(n,r,l,d){return Gl.isNode&&rn.isBuffer(n)?(this.append(r,n.toString("base64")),!1):d.defaultVisitor.apply(this,arguments)}},t))}function zne(e){return rn.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Lne(e){const t={},n=Object.keys(e);let r;const l=n.length;let d;for(r=0;r<l;r++)d=n[r],t[d]=e[d];return t}function QV(e){function t(n,r,l,d){let p=n[d++];if(p==="__proto__")return!0;const a=Number.isFinite(+p),b=d>=n.length;return p=!p&&rn.isArray(l)?l.length:p,b?(rn.hasOwnProp(l,p)?l[p]=[l[p],r]:l[p]=r,!a):((!l[p]||!rn.isObject(l[p]))&&(l[p]=[]),t(n,r,l[p],d)&&rn.isArray(l[p])&&(l[p]=Lne(l[p])),!a)}if(rn.isFormData(e)&&rn.isFunction(e.entries)){const n={};return rn.forEachEntry(e,(r,l)=>{t(zne(r),l,n,0)}),n}return null}function Fne(e,t,n){if(rn.isString(e))try{return(t||JSON.parse)(e),rn.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const Pw={transitional:YV,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",l=r.indexOf("application/json")>-1,d=rn.isObject(t);if(d&&rn.isHTMLForm(t)&&(t=new FormData(t)),rn.isFormData(t))return l?JSON.stringify(QV(t)):t;if(rn.isArrayBuffer(t)||rn.isBuffer(t)||rn.isStream(t)||rn.isFile(t)||rn.isBlob(t)||rn.isReadableStream(t))return t;if(rn.isArrayBufferView(t))return t.buffer;if(rn.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(d){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Rne(t,this.formSerializer).toString();if((a=rn.isFileList(t))||r.indexOf("multipart/form-data")>-1){const b=this.env&&this.env.FormData;return WE(a?{"files[]":t}:t,b&&new b,this.formSerializer)}}return d||l?(n.setContentType("application/json",!1),Fne(t)):t}],transformResponse:[function(t){const n=this.transitional||Pw.transitional,r=n&&n.forcedJSONParsing,l=this.responseType==="json";if(rn.isResponse(t)||rn.isReadableStream(t))return t;if(t&&rn.isString(t)&&(r&&!this.responseType||l)){const p=!(n&&n.silentJSONParsing)&&l;try{return JSON.parse(t)}catch(a){if(p)throw a.name==="SyntaxError"?ji.from(a,ji.ERR_BAD_RESPONSE,this,null,this.response):a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Gl.classes.FormData,Blob:Gl.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};rn.forEach(["delete","get","head","post","put","patch"],e=>{Pw.headers[e]={}});const Bne=rn.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Vne=e=>{const t={};let n,r,l;return e&&e.split(`
`).forEach(function(p){l=p.indexOf(":"),n=p.substring(0,l).trim().toLowerCase(),r=p.substring(l+1).trim(),!(!n||t[n]&&Bne[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},KR=Symbol("internals");function Z1(e){return e&&String(e).trim().toLowerCase()}function ZS(e){return e===!1||e==null?e:rn.isArray(e)?e.map(ZS):String(e)}function Une(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const $ne=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function gC(e,t,n,r,l){if(rn.isFunction(r))return r.call(this,t,n);if(l&&(t=n),!!rn.isString(t)){if(rn.isString(r))return t.indexOf(r)!==-1;if(rn.isRegExp(r))return r.test(t)}}function qne(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function Hne(e,t){const n=rn.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(l,d,p){return this[r].call(this,t,l,d,p)},configurable:!0})})}let Gc=class{constructor(t){t&&this.set(t)}set(t,n,r){const l=this;function d(a,b,T){const E=Z1(b);if(!E)throw new Error("header name must be a non-empty string");const P=rn.findKey(l,E);(!P||l[P]===void 0||T===!0||T===void 0&&l[P]!==!1)&&(l[P||b]=ZS(a))}const p=(a,b)=>rn.forEach(a,(T,E)=>d(T,E,b));if(rn.isPlainObject(t)||t instanceof this.constructor)p(t,n);else if(rn.isString(t)&&(t=t.trim())&&!$ne(t))p(Vne(t),n);else if(rn.isObject(t)&&rn.isIterable(t)){let a={},b,T;for(const E of t){if(!rn.isArray(E))throw TypeError("Object iterator must return a key-value pair");a[T=E[0]]=(b=a[T])?rn.isArray(b)?[...b,E[1]]:[b,E[1]]:E[1]}p(a,n)}else t!=null&&d(n,t,r);return this}get(t,n){if(t=Z1(t),t){const r=rn.findKey(this,t);if(r){const l=this[r];if(!n)return l;if(n===!0)return Une(l);if(rn.isFunction(n))return n.call(this,l,r);if(rn.isRegExp(n))return n.exec(l);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Z1(t),t){const r=rn.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||gC(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let l=!1;function d(p){if(p=Z1(p),p){const a=rn.findKey(r,p);a&&(!n||gC(r,r[a],a,n))&&(delete r[a],l=!0)}}return rn.isArray(t)?t.forEach(d):d(t),l}clear(t){const n=Object.keys(this);let r=n.length,l=!1;for(;r--;){const d=n[r];(!t||gC(this,this[d],d,t,!0))&&(delete this[d],l=!0)}return l}normalize(t){const n=this,r={};return rn.forEach(this,(l,d)=>{const p=rn.findKey(r,d);if(p){n[p]=ZS(l),delete n[d];return}const a=t?qne(d):String(d).trim();a!==d&&delete n[d],n[a]=ZS(l),r[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return rn.forEach(this,(r,l)=>{r!=null&&r!==!1&&(n[l]=t&&rn.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(l=>r.set(l)),r}static accessor(t){const r=(this[KR]=this[KR]={accessors:{}}).accessors,l=this.prototype;function d(p){const a=Z1(p);r[a]||(Hne(l,p),r[a]=!0)}return rn.isArray(t)?t.forEach(d):d(t),this}};Gc.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);rn.reduceDescriptors(Gc.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});rn.freezeMethods(Gc);function xC(e,t){const n=this||Pw,r=t||n,l=Gc.from(r.headers);let d=r.data;return rn.forEach(e,function(a){d=a.call(n,d,l.normalize(),t?t.status:void 0)}),l.normalize(),d}function JV(e){return!!(e&&e.__CANCEL__)}function S_(e,t,n){ji.call(this,e??"canceled",ji.ERR_CANCELED,t,n),this.name="CanceledError"}rn.inherits(S_,ji,{__CANCEL__:!0});function eU(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new ji("Request failed with status code "+n.status,[ji.ERR_BAD_REQUEST,ji.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function Gne(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Wne(e,t){e=e||10;const n=new Array(e),r=new Array(e);let l=0,d=0,p;return t=t!==void 0?t:1e3,function(b){const T=Date.now(),E=r[d];p||(p=T),n[l]=b,r[l]=T;let P=d,I=0;for(;P!==l;)I+=n[P++],P=P%e;if(l=(l+1)%e,l===d&&(d=(d+1)%e),T-p<t)return;const R=E&&T-E;return R?Math.round(I*1e3/R):void 0}}function Zne(e,t){let n=0,r=1e3/t,l,d;const p=(T,E=Date.now())=>{n=E,l=null,d&&(clearTimeout(d),d=null),e.apply(null,T)};return[(...T)=>{const E=Date.now(),P=E-n;P>=r?p(T,E):(l=T,d||(d=setTimeout(()=>{d=null,p(l)},r-P)))},()=>l&&p(l)]}const PT=(e,t,n=3)=>{let r=0;const l=Wne(50,250);return Zne(d=>{const p=d.loaded,a=d.lengthComputable?d.total:void 0,b=p-r,T=l(b),E=p<=a;r=p;const P={loaded:p,total:a,progress:a?p/a:void 0,bytes:b,rate:T||void 0,estimated:T&&a&&E?(a-p)/T:void 0,event:d,lengthComputable:a!=null,[t?"download":"upload"]:!0};e(P)},n)},YR=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},QR=e=>(...t)=>rn.asap(()=>e(...t)),Xne=Gl.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Gl.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Gl.origin),Gl.navigator&&/(msie|trident)/i.test(Gl.navigator.userAgent)):()=>!0,Kne=Gl.hasStandardBrowserEnv?{write(e,t,n,r,l,d){const p=[e+"="+encodeURIComponent(t)];rn.isNumber(n)&&p.push("expires="+new Date(n).toGMTString()),rn.isString(r)&&p.push("path="+r),rn.isString(l)&&p.push("domain="+l),d===!0&&p.push("secure"),document.cookie=p.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Yne(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Qne(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function tU(e,t,n){let r=!Yne(t);return e&&(r||n==!1)?Qne(e,t):t}const JR=e=>e instanceof Gc?{...e}:e;function uy(e,t){t=t||{};const n={};function r(T,E,P,I){return rn.isPlainObject(T)&&rn.isPlainObject(E)?rn.merge.call({caseless:I},T,E):rn.isPlainObject(E)?rn.merge({},E):rn.isArray(E)?E.slice():E}function l(T,E,P,I){if(rn.isUndefined(E)){if(!rn.isUndefined(T))return r(void 0,T,P,I)}else return r(T,E,P,I)}function d(T,E){if(!rn.isUndefined(E))return r(void 0,E)}function p(T,E){if(rn.isUndefined(E)){if(!rn.isUndefined(T))return r(void 0,T)}else return r(void 0,E)}function a(T,E,P){if(P in t)return r(T,E);if(P in e)return r(void 0,T)}const b={url:d,method:d,data:d,baseURL:p,transformRequest:p,transformResponse:p,paramsSerializer:p,timeout:p,timeoutMessage:p,withCredentials:p,withXSRFToken:p,adapter:p,responseType:p,xsrfCookieName:p,xsrfHeaderName:p,onUploadProgress:p,onDownloadProgress:p,decompress:p,maxContentLength:p,maxBodyLength:p,beforeRedirect:p,transport:p,httpAgent:p,httpsAgent:p,cancelToken:p,socketPath:p,responseEncoding:p,validateStatus:a,headers:(T,E,P)=>l(JR(T),JR(E),P,!0)};return rn.forEach(Object.keys(Object.assign({},e,t)),function(E){const P=b[E]||l,I=P(e[E],t[E],E);rn.isUndefined(I)&&P!==a||(n[E]=I)}),n}const nU=e=>{const t=uy({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:l,xsrfCookieName:d,headers:p,auth:a}=t;t.headers=p=Gc.from(p),t.url=KV(tU(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),a&&p.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let b;if(rn.isFormData(n)){if(Gl.hasStandardBrowserEnv||Gl.hasStandardBrowserWebWorkerEnv)p.setContentType(void 0);else if((b=p.getContentType())!==!1){const[T,...E]=b?b.split(";").map(P=>P.trim()).filter(Boolean):[];p.setContentType([T||"multipart/form-data",...E].join("; "))}}if(Gl.hasStandardBrowserEnv&&(r&&rn.isFunction(r)&&(r=r(t)),r||r!==!1&&Xne(t.url))){const T=l&&d&&Kne.read(d);T&&p.set(l,T)}return t},Jne=typeof XMLHttpRequest<"u",ere=Jne&&function(e){return new Promise(function(n,r){const l=nU(e);let d=l.data;const p=Gc.from(l.headers).normalize();let{responseType:a,onUploadProgress:b,onDownloadProgress:T}=l,E,P,I,R,F;function W(){R&&R(),F&&F(),l.cancelToken&&l.cancelToken.unsubscribe(E),l.signal&&l.signal.removeEventListener("abort",E)}let $=new XMLHttpRequest;$.open(l.method.toUpperCase(),l.url,!0),$.timeout=l.timeout;function Z(){if(!$)return;const ie=Gc.from("getAllResponseHeaders"in $&&$.getAllResponseHeaders()),ae={data:!a||a==="text"||a==="json"?$.responseText:$.response,status:$.status,statusText:$.statusText,headers:ie,config:e,request:$};eU(function(me){n(me),W()},function(me){r(me),W()},ae),$=null}"onloadend"in $?$.onloadend=Z:$.onreadystatechange=function(){!$||$.readyState!==4||$.status===0&&!($.responseURL&&$.responseURL.indexOf("file:")===0)||setTimeout(Z)},$.onabort=function(){$&&(r(new ji("Request aborted",ji.ECONNABORTED,e,$)),$=null)},$.onerror=function(){r(new ji("Network Error",ji.ERR_NETWORK,e,$)),$=null},$.ontimeout=function(){let ge=l.timeout?"timeout of "+l.timeout+"ms exceeded":"timeout exceeded";const ae=l.transitional||YV;l.timeoutErrorMessage&&(ge=l.timeoutErrorMessage),r(new ji(ge,ae.clarifyTimeoutError?ji.ETIMEDOUT:ji.ECONNABORTED,e,$)),$=null},d===void 0&&p.setContentType(null),"setRequestHeader"in $&&rn.forEach(p.toJSON(),function(ge,ae){$.setRequestHeader(ae,ge)}),rn.isUndefined(l.withCredentials)||($.withCredentials=!!l.withCredentials),a&&a!=="json"&&($.responseType=l.responseType),T&&([I,F]=PT(T,!0),$.addEventListener("progress",I)),b&&$.upload&&([P,R]=PT(b),$.upload.addEventListener("progress",P),$.upload.addEventListener("loadend",R)),(l.cancelToken||l.signal)&&(E=ie=>{$&&(r(!ie||ie.type?new S_(null,e,$):ie),$.abort(),$=null)},l.cancelToken&&l.cancelToken.subscribe(E),l.signal&&(l.signal.aborted?E():l.signal.addEventListener("abort",E)));const ne=Gne(l.url);if(ne&&Gl.protocols.indexOf(ne)===-1){r(new ji("Unsupported protocol "+ne+":",ji.ERR_BAD_REQUEST,e));return}$.send(d||null)})},tre=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,l;const d=function(T){if(!l){l=!0,a();const E=T instanceof Error?T:this.reason;r.abort(E instanceof ji?E:new S_(E instanceof Error?E.message:E))}};let p=t&&setTimeout(()=>{p=null,d(new ji(`timeout ${t} of ms exceeded`,ji.ETIMEDOUT))},t);const a=()=>{e&&(p&&clearTimeout(p),p=null,e.forEach(T=>{T.unsubscribe?T.unsubscribe(d):T.removeEventListener("abort",d)}),e=null)};e.forEach(T=>T.addEventListener("abort",d));const{signal:b}=r;return b.unsubscribe=()=>rn.asap(a),b}},nre=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,l;for(;r<n;)l=r+t,yield e.slice(r,l),r=l},rre=async function*(e,t){for await(const n of ire(e))yield*nre(n,t)},ire=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},e6=(e,t,n,r)=>{const l=rre(e,t);let d=0,p,a=b=>{p||(p=!0,r&&r(b))};return new ReadableStream({async pull(b){try{const{done:T,value:E}=await l.next();if(T){a(),b.close();return}let P=E.byteLength;if(n){let I=d+=P;n(I)}b.enqueue(new Uint8Array(E))}catch(T){throw a(T),T}},cancel(b){return a(b),l.return()}},{highWaterMark:2})},ZE=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",rU=ZE&&typeof ReadableStream=="function",are=ZE&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),iU=(e,...t)=>{try{return!!e(...t)}catch{return!1}},sre=rU&&iU(()=>{let e=!1;const t=new Request(Gl.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),t6=64*1024,xM=rU&&iU(()=>rn.isReadableStream(new Response("").body)),NT={stream:xM&&(e=>e.body)};ZE&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!NT[t]&&(NT[t]=rn.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new ji(`Response type '${t}' is not supported`,ji.ERR_NOT_SUPPORT,r)})})})(new Response);const ore=async e=>{if(e==null)return 0;if(rn.isBlob(e))return e.size;if(rn.isSpecCompliantForm(e))return(await new Request(Gl.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(rn.isArrayBufferView(e)||rn.isArrayBuffer(e))return e.byteLength;if(rn.isURLSearchParams(e)&&(e=e+""),rn.isString(e))return(await are(e)).byteLength},lre=async(e,t)=>{const n=rn.toFiniteNumber(e.getContentLength());return n??ore(t)},cre=ZE&&(async e=>{let{url:t,method:n,data:r,signal:l,cancelToken:d,timeout:p,onDownloadProgress:a,onUploadProgress:b,responseType:T,headers:E,withCredentials:P="same-origin",fetchOptions:I}=nU(e);T=T?(T+"").toLowerCase():"text";let R=tre([l,d&&d.toAbortSignal()],p),F;const W=R&&R.unsubscribe&&(()=>{R.unsubscribe()});let $;try{if(b&&sre&&n!=="get"&&n!=="head"&&($=await lre(E,r))!==0){let ae=new Request(t,{method:"POST",body:r,duplex:"half"}),se;if(rn.isFormData(r)&&(se=ae.headers.get("content-type"))&&E.setContentType(se),ae.body){const[me,ke]=YR($,PT(QR(b)));r=e6(ae.body,t6,me,ke)}}rn.isString(P)||(P=P?"include":"omit");const Z="credentials"in Request.prototype;F=new Request(t,{...I,signal:R,method:n.toUpperCase(),headers:E.normalize().toJSON(),body:r,duplex:"half",credentials:Z?P:void 0});let ne=await fetch(F);const ie=xM&&(T==="stream"||T==="response");if(xM&&(a||ie&&W)){const ae={};["status","statusText","headers"].forEach(qe=>{ae[qe]=ne[qe]});const se=rn.toFiniteNumber(ne.headers.get("content-length")),[me,ke]=a&&YR(se,PT(QR(a),!0))||[];ne=new Response(e6(ne.body,t6,me,()=>{ke&&ke(),W&&W()}),ae)}T=T||"text";let ge=await NT[rn.findKey(NT,T)||"text"](ne,e);return!ie&&W&&W(),await new Promise((ae,se)=>{eU(ae,se,{data:ge,headers:Gc.from(ne.headers),status:ne.status,statusText:ne.statusText,config:e,request:F})})}catch(Z){throw W&&W(),Z&&Z.name==="TypeError"&&/Load failed|fetch/i.test(Z.message)?Object.assign(new ji("Network Error",ji.ERR_NETWORK,e,F),{cause:Z.cause||Z}):ji.from(Z,Z&&Z.code,e,F)}}),yM={http:Tne,xhr:ere,fetch:cre};rn.forEach(yM,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const n6=e=>`- ${e}`,ure=e=>rn.isFunction(e)||e===null||e===!1,aU={getAdapter:e=>{e=rn.isArray(e)?e:[e];const{length:t}=e;let n,r;const l={};for(let d=0;d<t;d++){n=e[d];let p;if(r=n,!ure(n)&&(r=yM[(p=String(n)).toLowerCase()],r===void 0))throw new ji(`Unknown adapter '${p}'`);if(r)break;l[p||"#"+d]=r}if(!r){const d=Object.entries(l).map(([a,b])=>`adapter ${a} `+(b===!1?"is not supported by the environment":"is not available in the build"));let p=t?d.length>1?`since :
`+d.map(n6).join(`
`):" "+n6(d[0]):"as no adapter specified";throw new ji("There is no suitable adapter to dispatch the request "+p,"ERR_NOT_SUPPORT")}return r},adapters:yM};function yC(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new S_(null,e)}function r6(e){return yC(e),e.headers=Gc.from(e.headers),e.data=xC.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),aU.getAdapter(e.adapter||Pw.adapter)(e).then(function(r){return yC(e),r.data=xC.call(e,e.transformResponse,r),r.headers=Gc.from(r.headers),r},function(r){return JV(r)||(yC(e),r&&r.response&&(r.response.data=xC.call(e,e.transformResponse,r.response),r.response.headers=Gc.from(r.response.headers))),Promise.reject(r)})}const sU="1.9.0",XE={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{XE[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const i6={};XE.transitional=function(t,n,r){function l(d,p){return"[Axios v"+sU+"] Transitional option '"+d+"'"+p+(r?". "+r:"")}return(d,p,a)=>{if(t===!1)throw new ji(l(p," has been removed"+(n?" in "+n:"")),ji.ERR_DEPRECATED);return n&&!i6[p]&&(i6[p]=!0,console.warn(l(p," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(d,p,a):!0}};XE.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function dre(e,t,n){if(typeof e!="object")throw new ji("options must be an object",ji.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let l=r.length;for(;l-- >0;){const d=r[l],p=t[d];if(p){const a=e[d],b=a===void 0||p(a,d,e);if(b!==!0)throw new ji("option "+d+" must be "+b,ji.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new ji("Unknown option "+d,ji.ERR_BAD_OPTION)}}const XS={assertOptions:dre,validators:XE},Hf=XS.validators;let ey=class{constructor(t){this.defaults=t||{},this.interceptors={request:new XR,response:new XR}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let l={};Error.captureStackTrace?Error.captureStackTrace(l):l=new Error;const d=l.stack?l.stack.replace(/^.+\n/,""):"";try{r.stack?d&&!String(r.stack).endsWith(d.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+d):r.stack=d}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=uy(this.defaults,n);const{transitional:r,paramsSerializer:l,headers:d}=n;r!==void 0&&XS.assertOptions(r,{silentJSONParsing:Hf.transitional(Hf.boolean),forcedJSONParsing:Hf.transitional(Hf.boolean),clarifyTimeoutError:Hf.transitional(Hf.boolean)},!1),l!=null&&(rn.isFunction(l)?n.paramsSerializer={serialize:l}:XS.assertOptions(l,{encode:Hf.function,serialize:Hf.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),XS.assertOptions(n,{baseUrl:Hf.spelling("baseURL"),withXsrfToken:Hf.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let p=d&&rn.merge(d.common,d[n.method]);d&&rn.forEach(["delete","get","head","post","put","patch","common"],F=>{delete d[F]}),n.headers=Gc.concat(p,d);const a=[];let b=!0;this.interceptors.request.forEach(function(W){typeof W.runWhen=="function"&&W.runWhen(n)===!1||(b=b&&W.synchronous,a.unshift(W.fulfilled,W.rejected))});const T=[];this.interceptors.response.forEach(function(W){T.push(W.fulfilled,W.rejected)});let E,P=0,I;if(!b){const F=[r6.bind(this),void 0];for(F.unshift.apply(F,a),F.push.apply(F,T),I=F.length,E=Promise.resolve(n);P<I;)E=E.then(F[P++],F[P++]);return E}I=a.length;let R=n;for(P=0;P<I;){const F=a[P++],W=a[P++];try{R=F(R)}catch($){W.call(this,$);break}}try{E=r6.call(this,R)}catch(F){return Promise.reject(F)}for(P=0,I=T.length;P<I;)E=E.then(T[P++],T[P++]);return E}getUri(t){t=uy(this.defaults,t);const n=tU(t.baseURL,t.url,t.allowAbsoluteUrls);return KV(n,t.params,t.paramsSerializer)}};rn.forEach(["delete","get","head","options"],function(t){ey.prototype[t]=function(n,r){return this.request(uy(r||{},{method:t,url:n,data:(r||{}).data}))}});rn.forEach(["post","put","patch"],function(t){function n(r){return function(d,p,a){return this.request(uy(a||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:d,data:p}))}}ey.prototype[t]=n(),ey.prototype[t+"Form"]=n(!0)});let hre=class oU{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(d){n=d});const r=this;this.promise.then(l=>{if(!r._listeners)return;let d=r._listeners.length;for(;d-- >0;)r._listeners[d](l);r._listeners=null}),this.promise.then=l=>{let d;const p=new Promise(a=>{r.subscribe(a),d=a}).then(l);return p.cancel=function(){r.unsubscribe(d)},p},t(function(d,p,a){r.reason||(r.reason=new S_(d,p,a),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new oU(function(l){t=l}),cancel:t}}};function fre(e){return function(n){return e.apply(null,n)}}function pre(e){return rn.isObject(e)&&e.isAxiosError===!0}const vM={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(vM).forEach(([e,t])=>{vM[t]=e});function lU(e){const t=new ey(e),n=LV(ey.prototype.request,t);return rn.extend(n,ey.prototype,t,{allOwnKeys:!0}),rn.extend(n,t,null,{allOwnKeys:!0}),n.create=function(l){return lU(uy(e,l))},n}const qs=lU(Pw);qs.Axios=ey;qs.CanceledError=S_;qs.CancelToken=hre;qs.isCancel=JV;qs.VERSION=sU;qs.toFormData=WE;qs.AxiosError=ji;qs.Cancel=qs.CanceledError;qs.all=function(t){return Promise.all(t)};qs.spread=fre;qs.isAxiosError=pre;qs.mergeConfig=uy;qs.AxiosHeaders=Gc;qs.formToJSON=e=>QV(rn.isHTMLForm(e)?new FormData(e):e);qs.getAdapter=aU.getAdapter;qs.HttpStatusCode=vM;qs.default=qs;const{Axios:g6e,AxiosError:x6e,CanceledError:y6e,isCancel:v6e,CancelToken:_6e,VERSION:b6e,all:w6e,Cancel:S6e,isAxiosError:T6e,spread:E6e,toFormData:A6e,AxiosHeaders:C6e,HttpStatusCode:j6e,formToJSON:M6e,getAdapter:P6e,mergeConfig:N6e}=qs;/*! Capacitor: https://capacitorjs.com/ - MIT License */var l_;(function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"})(l_||(l_={}));class vC extends Error{constructor(t,n,r){super(t),this.message=t,this.code=n,this.data=r}}const mre=e=>{var t,n;return e!=null&&e.androidBridge?"android":!((n=(t=e==null?void 0:e.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},gre=e=>{const t=e.CapacitorCustomPlatform||null,n=e.Capacitor||{},r=n.Plugins=n.Plugins||{},l=()=>t!==null?t.name:mre(e),d=()=>l()!=="web",p=P=>{const I=T.get(P);return!!(I!=null&&I.platforms.has(l())||a(P))},a=P=>{var I;return(I=n.PluginHeaders)===null||I===void 0?void 0:I.find(R=>R.name===P)},b=P=>e.console.error(P),T=new Map,E=(P,I={})=>{const R=T.get(P);if(R)return console.warn(`Capacitor plugin "${P}" already registered. Cannot register plugins twice.`),R.proxy;const F=l(),W=a(P);let $;const Z=async()=>(!$&&F in I?$=typeof I[F]=="function"?$=await I[F]():$=I[F]:t!==null&&!$&&"web"in I&&($=typeof I.web=="function"?$=await I.web():$=I.web),$),ne=(ke,qe)=>{var tt,nt;if(W){const bt=W==null?void 0:W.methods.find(jt=>qe===jt.name);if(bt)return bt.rtype==="promise"?jt=>n.nativePromise(P,qe.toString(),jt):(jt,Nt)=>n.nativeCallback(P,qe.toString(),jt,Nt);if(ke)return(tt=ke[qe])===null||tt===void 0?void 0:tt.bind(ke)}else{if(ke)return(nt=ke[qe])===null||nt===void 0?void 0:nt.bind(ke);throw new vC(`"${P}" plugin is not implemented on ${F}`,l_.Unimplemented)}},ie=ke=>{let qe;const tt=(...nt)=>{const bt=Z().then(jt=>{const Nt=ne(jt,ke);if(Nt){const vt=Nt(...nt);return qe=vt==null?void 0:vt.remove,vt}else throw new vC(`"${P}.${ke}()" is not implemented on ${F}`,l_.Unimplemented)});return ke==="addListener"&&(bt.remove=async()=>qe()),bt};return tt.toString=()=>`${ke.toString()}() { [capacitor code] }`,Object.defineProperty(tt,"name",{value:ke,writable:!1,configurable:!1}),tt},ge=ie("addListener"),ae=ie("removeListener"),se=(ke,qe)=>{const tt=ge({eventName:ke},qe),nt=async()=>{const jt=await tt;ae({eventName:ke,callbackId:jt},qe)},bt=new Promise(jt=>tt.then(()=>jt({remove:nt})));return bt.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await nt()},bt},me=new Proxy({},{get(ke,qe){switch(qe){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return W?se:ge;case"removeListener":return ae;default:return ie(qe)}}});return r[P]=me,T.set(P,{name:P,proxy:me,platforms:new Set([...Object.keys(I),...W?[F]:[]])}),me};return n.convertFileSrc||(n.convertFileSrc=P=>P),n.getPlatform=l,n.handleError=b,n.isNativePlatform=d,n.isPluginAvailable=p,n.registerPlugin=E,n.Exception=vC,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},xre=e=>e.Capacitor=gre(e),dy=xre(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Nw=dy.registerPlugin;class cU{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(t,n){let r=!1;this.listeners[t]||(this.listeners[t]=[],r=!0),this.listeners[t].push(n);const d=this.windowListeners[t];d&&!d.registered&&this.addWindowListener(d),r&&this.sendRetainedArgumentsForEvent(t);const p=async()=>this.removeListener(t,n);return Promise.resolve({remove:p})}async removeAllListeners(){this.listeners={};for(const t in this.windowListeners)this.removeWindowListener(this.windowListeners[t]);this.windowListeners={}}notifyListeners(t,n,r){const l=this.listeners[t];if(!l){if(r){let d=this.retainedEventArguments[t];d||(d=[]),d.push(n),this.retainedEventArguments[t]=d}return}l.forEach(d=>d(n))}hasListeners(t){var n;return!!(!((n=this.listeners[t])===null||n===void 0)&&n.length)}registerWindowListener(t,n){this.windowListeners[n]={registered:!1,windowEventName:t,pluginEventName:n,handler:r=>{this.notifyListeners(n,r)}}}unimplemented(t="not implemented"){return new dy.Exception(t,l_.Unimplemented)}unavailable(t="not available"){return new dy.Exception(t,l_.Unavailable)}async removeListener(t,n){const r=this.listeners[t];if(!r)return;const l=r.indexOf(n);this.listeners[t].splice(l,1),this.listeners[t].length||this.removeWindowListener(this.windowListeners[t])}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}sendRetainedArgumentsForEvent(t){const n=this.retainedEventArguments[t];n&&(delete this.retainedEventArguments[t],n.forEach(r=>{this.notifyListeners(t,r)}))}}const a6=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),s6=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class yre extends cU{async getCookies(){const t=document.cookie,n={};return t.split(";").forEach(r=>{if(r.length<=0)return;let[l,d]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");l=s6(l).trim(),d=s6(d).trim(),n[l]=d}),n}async setCookie(t){try{const n=a6(t.key),r=a6(t.value),l=`; expires=${(t.expires||"").replace("expires=","")}`,d=(t.path||"/").replace("path=",""),p=t.url!=null&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${n}=${r||""}${l}; path=${d}; ${p};`}catch(n){return Promise.reject(n)}}async deleteCookie(t){try{document.cookie=`${t.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const t=document.cookie.split(";")||[];for(const n of t)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(t){return Promise.reject(t)}}async clearAllCookies(){try{await this.clearCookies()}catch(t){return Promise.reject(t)}}}Nw("CapacitorCookies",{web:()=>new yre});const vre=async e=>new Promise((t,n)=>{const r=new FileReader;r.onload=()=>{const l=r.result;t(l.indexOf(",")>=0?l.split(",")[1]:l)},r.onerror=l=>n(l),r.readAsDataURL(e)}),_re=(e={})=>{const t=Object.keys(e);return Object.keys(e).map(l=>l.toLocaleLowerCase()).reduce((l,d,p)=>(l[d]=e[t[p]],l),{})},bre=(e,t=!0)=>e?Object.entries(e).reduce((r,l)=>{const[d,p]=l;let a,b;return Array.isArray(p)?(b="",p.forEach(T=>{a=t?encodeURIComponent(T):T,b+=`${d}=${a}&`}),b.slice(0,-1)):(a=t?encodeURIComponent(p):p,b=`${d}=${a}`),`${r}&${b}`},"").substr(1):null,wre=(e,t={})=>{const n=Object.assign({method:e.method||"GET",headers:e.headers},t),l=_re(e.headers)["content-type"]||"";if(typeof e.data=="string")n.body=e.data;else if(l.includes("application/x-www-form-urlencoded")){const d=new URLSearchParams;for(const[p,a]of Object.entries(e.data||{}))d.set(p,a);n.body=d.toString()}else if(l.includes("multipart/form-data")||e.data instanceof FormData){const d=new FormData;if(e.data instanceof FormData)e.data.forEach((a,b)=>{d.append(b,a)});else for(const a of Object.keys(e.data))d.append(a,e.data[a]);n.body=d;const p=new Headers(n.headers);p.delete("content-type"),n.headers=p}else(l.includes("application/json")||typeof e.data=="object")&&(n.body=JSON.stringify(e.data));return n};class Sre extends cU{async request(t){const n=wre(t,t.webFetchExtra),r=bre(t.params,t.shouldEncodeUrlParams),l=r?`${t.url}?${r}`:t.url,d=await fetch(l,n),p=d.headers.get("content-type")||"";let{responseType:a="text"}=d.ok?t:{};p.includes("application/json")&&(a="json");let b,T;switch(a){case"arraybuffer":case"blob":T=await d.blob(),b=await vre(T);break;case"json":b=await d.json();break;case"document":case"text":default:b=await d.text()}const E={};return d.headers.forEach((P,I)=>{E[I]=P}),{data:b,headers:E,status:d.status,url:d.url}}async get(t){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))}async post(t){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))}async put(t){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))}async patch(t){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))}async delete(t){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))}}Nw("CapacitorHttp",{web:()=>new Sre});dy.getPlatform();const _y=dy.isNativePlatform(),Tre="modulepreload",Ere=function(e){return"/"+e},o6={},SP=function(t,n,r){let l=Promise.resolve();if(n&&n.length>0){let p=function(T){return Promise.all(T.map(E=>Promise.resolve(E).then(P=>({status:"fulfilled",value:P}),P=>({status:"rejected",reason:P}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),b=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));l=p(n.map(T=>{if(T=Ere(T),T in o6)return;o6[T]=!0;const E=T.endsWith(".css"),P=E?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${T}"]${P}`))return;const I=document.createElement("link");if(I.rel=E?"stylesheet":Tre,E||(I.as="script"),I.crossOrigin="",I.href=T,b&&I.setAttribute("nonce",b),document.head.appendChild(I),E)return new Promise((R,F)=>{I.addEventListener("load",R),I.addEventListener("error",()=>F(new Error(`Unable to preload CSS for ${T}`)))})}))}function d(p){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=p,window.dispatchEvent(a),!a.defaultPrevented)throw p}return l.then(p=>{for(const a of p||[])a.status==="rejected"&&d(a.reason);return t().catch(d)})},uU=Nw("Preferences",{web:()=>SP(()=>import("./web-BwUcos0D.js"),[]).then(e=>new e.PreferencesWeb)}),DT="token";async function Are(){if(dy.isNativePlatform()){const{value:e}=await uU.get({key:DT});return e||null}return localStorage.getItem(DT)}async function TP(e){dy.isNativePlatform()?await uU.set({key:DT,value:e}):localStorage.setItem(DT,e)}const Cre=_y?"https://apidev.communidades.com/api":"https://api.communidades.com/api",Rn=qs.create({baseURL:Cre,withCredentials:!_y,timeout:15e3});Rn.interceptors.request.use(async e=>{if(_y){const t=await Are();t&&(e.headers.Authorization=`Bearer ${t}`)}return e});async function jre(e){return(await Rn.post("/businesses",e,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0})).data}async function Mre(e,t){return(await Rn.put(`/businesses/${e}`,t,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0})).data}const Pre=async(e={})=>{const t=new URLSearchParams(e).toString();return(await Rn.get(`/businesses?${t}`)).data};async function EP(e){return(await Rn.get(`/businesses/${e}`)).data}async function Nre(e){return(await Rn.delete(`/businesses/${e}`)).data}async function Dre(){return(await Rn.get("/businesses/mine")).data}async function Ore(e){return(await Rn.get("/users/search",{params:{name:e}})).data.users}const Ire=async e=>(await Rn.get(`/businesses/community/${e}`)).data.businesses,kre=async(e={})=>{const t=new URLSearchParams(e).toString();return(await Rn.get(`/businesses/map?${t}`)).data.businesses},AP=async(e,t={})=>{const n=new URLSearchParams({...t,_:Date.now()}).toString(),{data:r}=await Rn.get(`/businesses/map/${e}?${n}`,{headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});return r.businesses},Tc=Xl("RESET_APP"),l6={visible:!1,message:"",type:"success"},dU=Ia({name:"feedback",initialState:l6,reducers:{mostrarFeedback:(e,t)=>{e.visible=!0,e.message=t.payload.message,e.type=t.payload.type||"success"},ocultarFeedback:e=>{e.visible=!1,e.message=""}},extraReducers:e=>{e.addCase(Tc,()=>l6)}}),{mostrarFeedback:Jt,ocultarFeedback:Rre}=dU.actions,zre=dU.reducer,Yf=xi("negocios/fetch",async({page:e=1,all:t=!1}={},{rejectWithValue:n,dispatch:r,getState:l})=>{var d;try{const a=(d=l().ubicacion)==null?void 0:d.coords;if(!(a!=null&&a.lat)||!(a!=null&&a.lng))return n("Ubicación no disponible");const b={lat:a.lat,lng:a.lng,page:e,limit:t?9999:15},T=await Pre(b);return{negocios:T.businesses,totalPages:Math.ceil(T.total/T.perPage),currentPage:T.page}}catch(p){return r(Jt({message:"No se pudieron cargar los negocios",type:"error"})),n(p.message||"Error al cargar negocios")}}),_C=xi("negocios/fetchPorComunidad",async(e,{rejectWithValue:t,dispatch:n})=>{try{const r=await Ire(e);return Array.isArray(r)?r:r.businesses||[]}catch(r){return n(Jt({message:"No se pudieron cargar los negocios de la comunidad",type:"error"})),t(r.message||"Error al cargar negocios")}},{condition:(e,{getState:t})=>{const{negocios:n}=t();return!n.loaded||n.lista.length===0}}),c6=xi("negocios/fetchMapa",async(e={},{rejectWithValue:t,dispatch:n})=>{try{const r=await kre(e);return Array.isArray(r)?r:r.businesses||[]}catch(r){return n(Jt({message:"No se pudieron cargar negocios para el mapa",type:"error"})),t(r.message||"Error al cargar mapa")}}),u6=xi("negocios/fetchMapaPorComunidad",async({communityId:e,coords:t},{rejectWithValue:n,dispatch:r})=>{try{const l=await AP(e,{lat:t.lat,lng:t.lng});return Array.isArray(l)?l:l.businesses||[]}catch(l){return r(Jt({message:"No se pudieron cargar negocios de la comunidad para el mapa",type:"error"})),n(l.message||"Error al cargar negocios")}}),Eb=xi("negocios/fetchMine",async(e,{rejectWithValue:t,dispatch:n})=>{try{const r=await Dre();return Array.isArray(r)?r:r.businesses||[]}catch(r){return n(Jt({message:"No se pudieron cargar tus negocios",type:"error"})),t(r.message||"Error al cargar tus negocios")}},{condition:(e,{getState:t})=>{const{negocios:n}=t();return!n.misLoaded}}),CP=xi("negocios/delete",async(e,{rejectWithValue:t,dispatch:n})=>{try{return await Nre(e),n(Jt({message:"Negocio eliminado con éxito",type:"success"})),e}catch(r){return n(Jt({message:"No se pudo eliminar el negocio",type:"error"})),t(r.message||"Error al eliminar el negocio")}}),Lre=xi("negocios/create",async(e,{rejectWithValue:t,dispatch:n})=>{var r,l;n(Jt({message:"Procesando...",type:"loading"}));try{const d=await jre(e);return n(Jt({message:"Negocio creado con éxito",type:"success"})),d}catch(d){return n(Jt({message:((l=(r=d==null?void 0:d.response)==null?void 0:r.data)==null?void 0:l.message)||"Error al crear negocio",type:"error"})),t(d.message||"Error al crear negocio")}}),Fre=xi("negocios/update",async({id:e,formData:t},{rejectWithValue:n,dispatch:r})=>{var l,d;r(Jt({message:"Procesando...",type:"loading"}));try{const p=await Mre(e,t);return r(Jt({message:"Negocio actualizado con éxito",type:"success"})),p}catch(p){return r(Jt({message:((d=(l=p==null?void 0:p.response)==null?void 0:l.data)==null?void 0:d.message)||"Error al actualizar negocio",type:"error"})),n(p.message||"Error al actualizar negocio")}}),d6={lista:[],negociosMapa:[],misNegocios:[],loading:!1,misLoading:!1,error:null,busqueda:"",categoria:"todas",loaded:!1,misLoaded:!1,totalPages:1,currentPage:1},hU=Ia({name:"negocios",initialState:d6,reducers:{setBusqueda:(e,t)=>{e.busqueda=t.payload},setCategoria:(e,t)=>{e.categoria=t.payload}},extraReducers:e=>{e.addCase(Yf.pending,t=>{t.loading=!0,t.error=null}).addCase(Yf.fulfilled,(t,n)=>{t.loading=!1,t.lista=n.payload.negocios||[],t.totalPages=n.payload.totalPages,t.currentPage=n.payload.currentPage,t.loaded=!0}).addCase(Yf.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(_C.pending,t=>{t.loading=!0,t.error=null,t.lista=[]}).addCase(_C.fulfilled,(t,n)=>{t.loading=!1,t.lista=Array.isArray(n.payload)?n.payload:[],t.loaded=!0}).addCase(_C.rejected,(t,n)=>{t.loading=!1,t.error=n.payload,t.lista=[]}).addCase(c6.fulfilled,(t,n)=>{t.negociosMapa=Array.isArray(n.payload)?n.payload:[]}).addCase(c6.rejected,(t,n)=>{t.negociosMapa=[],t.error=n.payload}).addCase(u6.fulfilled,(t,n)=>{t.negociosMapa=Array.isArray(n.payload)?n.payload:[]}).addCase(u6.rejected,(t,n)=>{t.negociosMapa=[],t.error=n.payload}).addCase(Eb.pending,t=>{t.misLoading=!0,t.error=null}).addCase(Eb.fulfilled,(t,n)=>{t.misLoading=!1,t.misNegocios=Array.isArray(n.payload)?n.payload:[],t.misLoaded=!0}).addCase(Eb.rejected,(t,n)=>{t.misLoading=!1,t.error=n.payload,t.misLoaded=!0}).addCase(CP.fulfilled,(t,n)=>{t.misNegocios=t.misNegocios.filter(r=>r._id!==n.payload)}).addCase(Tc,()=>d6)}}),{setBusqueda:D6e,setCategoria:Bre}=hU.actions,Vre=hU.reducer;async function Ure(e){return(await Rn.post("/events",e,{withCredentials:!0})).data}async function $re({lat:e,lng:t,page:n=1,limit:r=15}={}){const l={};return e&&t&&(l.lat=e,l.lng=t),l.page=n,l.limit=r,(await Rn.get("/events",{params:l,withCredentials:!0})).data}async function fU(e){return(await Rn.get(`/events/${e}`,{withCredentials:!0})).data}async function qre(e,t){return(await Rn.put(`/events/${e}`,t,{withCredentials:!0})).data}async function Hre(e){return(await Rn.delete(`/events/${e}`,{withCredentials:!0})).data}async function Gre(){return(await Rn.get("/events/mine",{withCredentials:!0})).data.events}const h6={lista:[],misEventos:[],loading:!1,misLoading:!1,error:null,busqueda:"",loaded:!1,misLoaded:!1,paginaActual:1,limite:15,totalPaginas:1,totalResultados:0,categoria:"todas"},Kg=xi("eventos/fetch",async({page:e=1,limit:t=15}={},{rejectWithValue:n,dispatch:r,getState:l})=>{try{const{coords:d}=l().ubicacion,p=d==null?void 0:d.lat,a=d==null?void 0:d.lng;return await $re({page:e,limit:t,lat:p,lng:a})}catch(d){return r(Jt({message:"No se pudieron cargar los eventos",type:"error"})),n(d.message||"Error al cargar eventos")}}),KS=xi("eventos/fetchMine",async(e,{rejectWithValue:t,dispatch:n})=>{try{const r=await Gre();return Array.isArray(r)?r:r.events||[]}catch(r){return n(Jt({message:"No se pudieron cargar tus eventos",type:"error"})),t(r.message||"Error al cargar tus eventos")}},{condition:(e,{getState:t})=>!t().eventos.misLoaded}),Wre=xi("eventos/createEvent",async(e,{rejectWithValue:t,dispatch:n})=>{var r,l,d,p;n(Jt({message:"Procesando...",type:"loading"}));try{const a=await Ure(e);return n(Jt({message:"Evento creado exitosamente",type:"success"})),a}catch(a){return n(Jt({message:((l=(r=a==null?void 0:a.response)==null?void 0:r.data)==null?void 0:l.message)||a.message,type:"error"})),t(((p=(d=a==null?void 0:a.response)==null?void 0:d.data)==null?void 0:p.message)||a.message)}}),Zre=xi("eventos/updateEvent",async({id:e,formData:t},{rejectWithValue:n,dispatch:r})=>{var l,d,p,a;r(Jt({message:"Procesando...",type:"loading"}));try{const b=await qre(e,t);return r(Jt({message:"Evento actualizado correctamente",type:"success"})),b}catch(b){return r(Jt({message:((d=(l=b==null?void 0:b.response)==null?void 0:l.data)==null?void 0:d.message)||b.message,type:"error"})),n(((a=(p=b==null?void 0:b.response)==null?void 0:p.data)==null?void 0:a.message)||b.message)}}),KE=xi("eventos/deleteEvento",async(e,{rejectWithValue:t,dispatch:n})=>{try{return await Hre(e),n(Jt({message:"Evento eliminado con éxito",type:"success"})),e}catch(r){return n(Jt({message:"No se pudo eliminar el evento",type:"error"})),t(r.message||"Error al eliminar evento")}}),pU=Ia({name:"eventos",initialState:h6,reducers:{setBusqueda:(e,t)=>{e.busqueda=t.payload},setPaginaActual:(e,t)=>{e.paginaActual=t.payload},setCategoria:(e,t)=>{e.categoria=t.payload}},extraReducers:e=>{e.addCase(Tc,()=>h6).addCase(Kg.pending,t=>{t.loading=!0,t.error=null}).addCase(Kg.fulfilled,(t,n)=>{const{events:r,totalPages:l,total:d=0,page:p=1}=n.payload;t.loading=!1,t.lista=r||[],t.totalPaginas=l||1,t.totalResultados=d,t.paginaActual=p,t.loaded=!0}).addCase(Kg.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(KS.pending,t=>{t.misLoading=!0,t.error=null}).addCase(KS.fulfilled,(t,n)=>{t.misLoading=!1,t.misEventos=Array.isArray(n.payload)?n.payload:[],t.misLoaded=!0}).addCase(KS.rejected,(t,n)=>{t.misLoading=!1,t.error=n.payload,t.misLoaded=!0}).addCase(KE.fulfilled,(t,n)=>{t.lista=t.lista.filter(r=>r._id!==n.payload),t.misEventos=t.misEventos.filter(r=>r._id!==n.payload)})}}),{setBusqueda:O6e,setPaginaActual:f6,setCategoria:Xre}=pU.actions,Kre=pU.reducer;async function Yre(e){const{data:t}=await Rn.post("/auth/login",e);return _y&&(t!=null&&t.token)&&await TP(t.token),t.user||(t==null?void 0:t.usuario)||null}async function Qre(e){const{data:t}=await Rn.post("/auth/register",e);return _y&&(t!=null&&t.token)&&await TP(t.token),t.user||(t==null?void 0:t.usuario)||null}async function Jre(){const{data:e}=await Rn.get("/auth/profile");return{user:e.user||(e==null?void 0:e.usuario)||null}}async function mU(){const{data:e}=await Rn.get("/auth/me");return e}async function eie(e,t){const n=t instanceof FormData,{data:r}=await Rn.put(`/users/${e}`,t,{headers:n?{"Content-Type":"multipart/form-data"}:{"Content-Type":"application/json"}});return r.user||(r==null?void 0:r.usuario)||null}async function gU(e){const{data:t}=await Rn.post("/auth/verify-email/resend",{email:e});return t}const bC={usuario:null,loading:!1,error:null},Ab=xi("auth/fetchCurrentUser",async(e,t)=>{var n;try{return(await Jre()).user}catch(r){return t.rejectWithValue(((n=r.response)==null?void 0:n.data)||r.message)}}),YS=xi("auth/updateUser",async({userId:e,userData:t},n)=>{var r;try{return await eie(e,t)}catch(l){return n.rejectWithValue(((r=l.response)==null?void 0:r.data)||l.message)}}),xU=Ia({name:"auth",initialState:bC,reducers:{login:(e,t)=>{e.usuario=t.payload},logout:()=>bC},extraReducers:e=>{e.addCase(Tc,()=>bC).addCase(Ab.pending,t=>{t.loading=!0,t.error=null}).addCase(Ab.fulfilled,(t,n)=>{t.loading=!1,t.usuario=n.payload}).addCase(Ab.rejected,(t,n)=>{t.loading=!1,t.usuario=null,t.error=n.payload}).addCase(YS.pending,t=>{t.loading=!0,t.error=null}).addCase(YS.fulfilled,(t,n)=>{t.loading=!1,t.usuario=n.payload}).addCase(YS.rejected,(t,n)=>{t.loading=!1,t.error=n.payload})}}),{login:_M,logout:yU}=xU.actions,tie=xU.reducer;async function nie({lat:e,lng:t,page:n=1,limit:r=15}={}){const l={};return e&&t&&(l.lat=e,l.lng=t),l.page=n,l.limit=r,(await Rn.get("/communities",{params:l})).data}async function vU(e){return(await Rn.get(`/communities/${e}`)).data}async function rie(e){return(await Rn.post("/communities",e)).data}async function iie(e,t){return(await Rn.put(`/communities/${e}`,t)).data}async function aie(e){return(await Rn.delete(`/communities/${e}`)).data}async function sie(){return(await Rn.get("/communities/mine")).data}const zd=xi("comunidades/fetchAll",async({lat:e,lng:t,page:n=1}={},{rejectWithValue:r,dispatch:l})=>{try{const d=await nie({lat:e,lng:t,page:n});return{comunidades:d.communities,totalPages:Math.ceil(d.total/d.perPage),currentPage:d.page}}catch(d){return l(Jt({message:"No se pudieron cargar las comunidades",type:"error"})),r(d.message||"Error desconocido")}},{condition:(e,{getState:t})=>!t().comunidades.loaded}),Cb=xi("comunidades/fetchMine",async(e,{rejectWithValue:t,dispatch:n})=>{try{return(await sie()).communities}catch(r){return n(Jt({message:"No se pudieron cargar tus comunidades",type:"error"})),t(r.message||"Error desconocido")}},{condition:(e,{getState:t})=>!t().comunidades.misLoaded}),QS=xi("comunidades/fetchById",async(e,{rejectWithValue:t,dispatch:n})=>{try{return(await vU(e)).community}catch(r){return n(Jt({message:"No se pudo cargar la comunidad",type:"error"})),t(r.message||"No se pudo cargar la comunidad")}}),oie=xi("comunidades/create",async(e,{rejectWithValue:t,dispatch:n})=>{var r,l,d,p;n(Jt({message:"Procesando...",type:"loading"}));try{const a=await rie(e);return n(Jt({message:"Comunidad creada exitosamente",type:"success"})),a}catch(a){return n(Jt({message:((l=(r=a==null?void 0:a.response)==null?void 0:r.data)==null?void 0:l.message)||"Error al crear comunidad",type:"error"})),t(((p=(d=a==null?void 0:a.response)==null?void 0:d.data)==null?void 0:p.message)||a.message)}}),lie=xi("comunidades/update",async({id:e,formData:t},{rejectWithValue:n,dispatch:r})=>{var l,d,p,a;r(Jt({message:"Procesando...",type:"loading"}));try{const b=await iie(e,t);return r(Jt({message:"Comunidad actualizada exitosamente",type:"success"})),b}catch(b){return r(Jt({message:((d=(l=b==null?void 0:b.response)==null?void 0:l.data)==null?void 0:d.message)||"Error al actualizar comunidad",type:"error"})),n(((a=(p=b==null?void 0:b.response)==null?void 0:p.data)==null?void 0:a.message)||b.message)}}),_U=xi("comunidades/delete",async(e,{rejectWithValue:t,dispatch:n})=>{var r,l,d,p;n(Jt({message:"Eliminando...",type:"loading"}));try{const a=await aie(e);return n(Jt({message:(a==null?void 0:a.msg)||"Comunidad eliminada",type:"success"})),{id:e}}catch(a){return n(Jt({message:((l=(r=a==null?void 0:a.response)==null?void 0:r.data)==null?void 0:l.message)||"Error al eliminar comunidad",type:"error"})),t(((p=(d=a==null?void 0:a.response)==null?void 0:d.data)==null?void 0:p.message)||a.message)}}),wC={lista:[],misComunidades:[],comunidadActual:null,loadingLista:!1,loadingMis:!1,loadingDetalle:!1,error:null,busqueda:"",loaded:!1,misLoaded:!1,totalPages:1,currentPage:1},bU=Ia({name:"comunidades",initialState:wC,reducers:{resetMisComunidades:()=>wC,setBusqueda:(e,t)=>{e.busqueda=t.payload},limpiarComunidadActual:e=>{e.comunidadActual=null}},extraReducers:e=>{e.addCase(Tc,()=>wC).addCase(zd.pending,t=>{t.loadingLista=!0,t.error=null}).addCase(zd.fulfilled,(t,n)=>{t.loadingLista=!1,t.lista=n.payload.comunidades,t.totalPages=n.payload.totalPages,t.currentPage=n.payload.currentPage,t.loaded=!0}).addCase(zd.rejected,(t,n)=>{t.loadingLista=!1,t.error=n.payload}).addCase(Cb.pending,t=>{t.loadingMis=!0,t.error=null}).addCase(Cb.fulfilled,(t,n)=>{t.loadingMis=!1,t.misComunidades=n.payload,t.misLoaded=!0}).addCase(Cb.rejected,(t,n)=>{t.loadingMis=!1,t.error=n.payload}).addCase(QS.pending,t=>{t.loadingDetalle=!0,t.error=null,t.comunidadActual=null}).addCase(QS.fulfilled,(t,n)=>{t.loadingDetalle=!1,t.comunidadActual=n.payload}).addCase(QS.rejected,(t,n)=>{t.loadingDetalle=!1,t.error=n.payload,t.comunidadActual=null}).addCase(_U.fulfilled,(t,n)=>{var l;const r=n.payload.id;t.lista=t.lista.filter(d=>d._id!==r),t.misComunidades=t.misComunidades.filter(d=>d._id!==r),((l=t.comunidadActual)==null?void 0:l._id)===r&&(t.comunidadActual=null)})}}),{setBusqueda:I6e,limpiarComunidadActual:k6e,resetMisComunidades:R6e}=bU.actions,cie=bU.reducer;async function uie(e,t={}){const{lat:n,lng:r}=t||{};return(await Rn.get("/busqueda",{params:{q:e,lat:n,lng:r}})).data}const SC={termino:"",resultados:[],loading:!1,error:null},jb=xi("busquedaGlobal/fetch",async(e,{rejectWithValue:t,dispatch:n,getState:r})=>{var l;try{const p=(l=r().ubicacion)==null?void 0:l.coords,a=await uie(e,p);return{termino:e,resultados:a}}catch(d){return n(Jt({message:"Ocurrió un error al realizar la búsqueda",type:"error"})),t(d.message||"Error al buscar globalmente")}}),wU=Ia({name:"busquedaGlobal",initialState:SC,reducers:{limpiarBusquedaGlobal:()=>SC},extraReducers:e=>{e.addCase(Tc,()=>SC).addCase(jb.pending,t=>{t.loading=!0,t.error=null}).addCase(jb.fulfilled,(t,n)=>{t.loading=!1,t.termino=n.payload.termino,t.resultados=n.payload.resultados}).addCase(jb.rejected,(t,n)=>{t.loading=!1,t.error=n.payload||n.error.message})}}),{limpiarBusquedaGlobal:Qb}=wU.actions,die=wU.reducer;async function hie(){return(await Rn.get("/categories")).data}async function fie(e){return(await Rn.get(`/categories/${e}`)).data}async function pie(e){return(await Rn.post("/categories",e)).data}async function mie(e,t){return(await Rn.put(`/categories/${e}`,t)).data}async function gie(e){return(await Rn.delete(`/categories/${e}`)).data}const p6={data:[],loading:!1,error:null,loaded:!1},Em=xi("categorias/fetchCategorias",async(e,{rejectWithValue:t,dispatch:n})=>{try{return(await hie()).categories}catch(r){return n(Jt({message:"No se pudieron cargar las categorías",type:"error"})),t(r.message||"Error al cargar categorías")}},{condition:(e,{getState:t})=>{const{categorias:n}=t();return!n.loaded}}),xie=Ia({name:"categorias",initialState:p6,reducers:{},extraReducers:e=>{e.addCase(Tc,()=>p6).addCase(Em.pending,t=>{t.loading=!0,t.error=null}).addCase(Em.fulfilled,(t,n)=>{t.loading=!1,t.data=n.payload,t.loaded=!0}).addCase(Em.rejected,(t,n)=>{t.loading=!1,t.error=n.payload})}}),yie=xie.reducer;async function vie(e){return(await Rn.post("/promotions",e)).data}async function _ie(){const e=await Rn.get("/promotions");return Array.isArray(e.data.promotions)?e.data.promotions:Array.isArray(e.data)?e.data:(console.warn("⚠️ Formato inesperado en /promotions:",e.data),[])}async function bie(e){return(await Rn.get(`/promotions?community=${e}`)).data.promotions}async function wie(e){return(await Rn.get(`/promotions/${e}`)).data}async function SU(e,t){return(await Rn.put(`/promotions/${e}`,t)).data}async function TU(e){return(await Rn.delete(`/promotions/${e}`)).data}async function Sie(){return(await Rn.get("/promotions/mine")).data.promotions}async function Tie(e){return(await Rn.get(`/businesses/${e}/promotions`)).data}const TC=xi("promociones/fetchPorComunidad",async(e,{rejectWithValue:t,dispatch:n})=>{try{return await bie(e)}catch(r){return n(Jt({message:"No se pudieron cargar las promociones",type:"error"})),t(r.message||"Error al cargar promociones")}}),Mb=xi("promociones/fetchMisPromos",async(e,{rejectWithValue:t,dispatch:n})=>{try{return await Sie()}catch(r){return n(Jt({message:"No se pudieron cargar tus promociones",type:"error"})),t(r.message||"Error al cargar mis promociones")}},{condition:(e,{getState:t})=>{const{promociones:n}=t();return!n.loaded}}),EU=xi("promociones/create",async(e,{rejectWithValue:t,dispatch:n})=>{n(Jt({message:"Procesando...",type:"loading"}));try{const r=await vie(e);return n(Jt({message:"Promoción creada con éxito",type:"success"})),r}catch(r){return n(Jt({message:"No se pudo crear la promoción",type:"error"})),t(r.message||"Error al crear promoción")}}),Eie=xi("promociones/update",async({id:e,formData:t},{rejectWithValue:n,dispatch:r})=>{r(Jt({message:"Procesando...",type:"loading"}));try{const l=await SU(e,t);return r(Jt({message:"Promoción actualizada con éxito",type:"success"})),l}catch(l){return r(Jt({message:"No se pudo actualizar la promoción",type:"error"})),n(l.message||"Error al actualizar promoción")}}),AU=xi("promociones/delete",async(e,{rejectWithValue:t,dispatch:n})=>{try{return await TU(e),n(Jt({message:"Promoción eliminada con éxito",type:"success"})),e}catch(r){return n(Jt({message:"No se pudo eliminar la promoción",type:"error"})),t(r.message||"Error al eliminar promoción")}}),JS=xi("promociones/fetchAll",async(e,{rejectWithValue:t,dispatch:n})=>{try{return await _ie()}catch(r){return n(Jt({message:"No se pudieron cargar las promociones",type:"error"})),t(r.message||"Error al cargar todas las promociones")}}),m6={lista:[],loading:!1,error:null,loaded:!1},Aie=Ia({name:"promociones",initialState:m6,reducers:{},extraReducers:e=>{e.addCase(TC.pending,t=>{t.loading=!0,t.error=null}).addCase(TC.fulfilled,(t,n)=>{t.loading=!1,t.lista=n.payload}).addCase(TC.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(Mb.pending,t=>{t.loading=!0,t.error=null}).addCase(Mb.fulfilled,(t,n)=>{t.loading=!1,t.lista=n.payload,t.loaded=!0}).addCase(Mb.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(EU.fulfilled,(t,n)=>{t.lista.push(n.payload)}).addCase(Eie.fulfilled,(t,n)=>{const r=t.lista.findIndex(l=>l._id===n.payload._id);r!==-1&&(t.lista[r]=n.payload)}).addCase(AU.fulfilled,(t,n)=>{t.lista=t.lista.filter(r=>r._id!==n.payload)}).addCase(JS.pending,t=>{t.loading=!0,t.error=null}).addCase(JS.fulfilled,(t,n)=>{t.loading=!1,t.lista=n.payload}).addCase(JS.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(Tc,()=>m6)}}),Cie=Aie.reducer,Pb=xi("notificaciones/cargar",async(e,{rejectWithValue:t,dispatch:n})=>{try{const r=await Rn.get("/notifications");return Array.isArray(r.data)?r.data:r.data.notifications||[]}catch{return n(Jt({message:"No se pudieron cargar tus notificaciones",type:"error"})),t("Error al cargar notificaciones")}},{condition:(e,{getState:t})=>{const{notificaciones:n}=t();return!n.loaded}}),CU=xi("notificaciones/marcarLeida",async(e,{rejectWithValue:t,dispatch:n})=>{try{return await Rn.patch(`/notifications/${e}/read`),e}catch{return n(Jt({message:"No se pudo marcar la notificación como leída",type:"error"})),t("Error al marcar notificación")}}),jU=xi("notificaciones/marcarTodasLeidas",async(e,{rejectWithValue:t,dispatch:n})=>{try{return await Rn.patch("/notifications/read-all"),!0}catch{return n(Jt({message:"No se pudieron marcar todas las notificaciones",type:"error"})),t("Error al marcar todas las notificaciones")}}),g6={items:[],loading:!1,error:null,loaded:!1},jie=Ia({name:"notificaciones",initialState:g6,reducers:{},extraReducers:e=>{e.addCase(Pb.pending,t=>{t.loading=!0,t.error=null}).addCase(Pb.fulfilled,(t,n)=>{t.items=n.payload,t.loading=!1,t.loaded=!0}).addCase(Pb.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(CU.fulfilled,(t,n)=>{t.items=t.items.map(r=>r._id===n.payload?{...r,read:!0}:r)}).addCase(jU.fulfilled,t=>{t.items=t.items.map(n=>({...n,read:!0}))}).addCase(Tc,()=>g6)}}),Mie=jie.reducer,Nb=xi("follow/fetchFollowings",async(e=null,{rejectWithValue:t,dispatch:n})=>{try{const r=e?`?type=${e}`:"";return(await Rn.get(`/users/me/following${r}`)).data.items}catch{return n(Jt({message:"No se pudieron cargar tus seguimientos",type:"error"})),t("Error fetching followings")}}),x6={items:[],loading:!1,error:null},MU=Ia({name:"follow",initialState:x6,reducers:{clearFollowings(e){e.items=[],e.loading=!1,e.error=null}},extraReducers:e=>{e.addCase(Tc,()=>x6).addCase(Nb.pending,t=>{t.loading=!0,t.error=null}).addCase(Nb.fulfilled,(t,n)=>{t.loading=!1,t.items=n.payload}).addCase(Nb.rejected,(t,n)=>{t.loading=!1,t.error=n.payload})}}),{clearFollowings:z6e}=MU.actions,Pie=MU.reducer,y6={items:[],loading:!1,error:null},ty=xi("conversations/fetchAll",async(e,{rejectWithValue:t,dispatch:n})=>{var r,l;try{return(await Rn.get("/conversations/me")).data}catch(d){return n(Jt({message:"No se pudieron cargar tus conversaciones",type:"error"})),t(((l=(r=d.response)==null?void 0:r.data)==null?void 0:l.msg)||"Error al cargar conversaciones")}}),Nie=Ia({name:"conversations",initialState:y6,reducers:{},extraReducers:e=>{e.addCase(Tc,()=>y6).addCase(ty.pending,t=>{t.loading=!0,t.error=null}).addCase(ty.fulfilled,(t,n)=>{t.loading=!1,t.items=n.payload}).addCase(ty.rejected,(t,n)=>{t.loading=!1,t.error=n.payload})}}),Die=Nie.reducer,eT=xi("messages/fetchAll",async(e,{rejectWithValue:t,dispatch:n})=>{var r,l;try{return(await Rn.get(`/messages/${e}`)).data}catch(d){return n(Jt({message:"No se pudieron cargar los mensajes",type:"error"})),t(((l=(r=d.response)==null?void 0:r.data)==null?void 0:l.msg)||"Error al cargar mensajes")}}),tT=xi("messages/send",async({conversationId:e,text:t},{rejectWithValue:n,dispatch:r})=>{var l,d;try{return(await Rn.post("/messages",{conversationId:e,text:t})).data}catch(p){return r(Jt({message:"No se pudo enviar el mensaje",type:"error"})),n(((d=(l=p.response)==null?void 0:l.data)==null?void 0:d.msg)||"Error al enviar mensaje")}}),PU=xi("messages/markRead",async(e,{rejectWithValue:t,dispatch:n})=>{var r,l;try{return await Rn.put(`/messages/${e}/read`),e}catch(d){return n(Jt({message:"No se pudo marcar el mensaje como leído",type:"error"})),t(((l=(r=d.response)==null?void 0:r.data)==null?void 0:l.msg)||"Error al marcar mensaje")}}),v6={items:[],loading:!1,error:null,sending:!1},NU=Ia({name:"messages",initialState:v6,reducers:{clearMessages:e=>{e.items=[]}},extraReducers:e=>{e.addCase(Tc,()=>v6).addCase(eT.pending,t=>{t.loading=!0,t.error=null}).addCase(eT.fulfilled,(t,n)=>{t.loading=!1,t.items=n.payload}).addCase(eT.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(tT.pending,t=>{t.sending=!0,t.error=null}).addCase(tT.fulfilled,(t,n)=>{t.sending=!1,t.items.push(n.payload)}).addCase(tT.rejected,(t,n)=>{t.sending=!1,t.error=n.payload}).addCase(PU.fulfilled,(t,n)=>{const r=t.items.findIndex(l=>l._id===n.payload);r!==-1&&(t.items[r].isRead=!0)})}}),{clearMessages:Oie}=NU.actions,Iie=NU.reducer,kie=e=>Rn.get(`/community-views/${e}/metrics`),Rie=(e,t,n)=>Rn.get(`/community-views/${e}/metrics/filter`,{params:{startDate:t,endDate:n}}),zie=(e,t,n)=>Rn.get(`/community-views/${e}/metrics/daily`,{params:{startDate:t,endDate:n}}),Lie=(e,t,n,r=5)=>Rn.get(`/community-views/${e}/metrics/top-viewers`,{params:{startDate:t,endDate:n,limit:r}}),Fie=e=>Rn.get(`/business-views/${e}/metrics`),Bie=(e,t,n)=>Rn.get(`/business-views/${e}/metrics/filter`,{params:{startDate:t,endDate:n}}),Vie=(e,t,n)=>Rn.get(`/business-views/${e}/metrics/daily`,{params:{startDate:t,endDate:n}}),Uie=(e,t,n,r=5)=>Rn.get(`/business-views/${e}/metrics/top-viewers`,{params:{startDate:t,endDate:n,limit:r}}),$ie=e=>Rn.get(`/event-views/${e}/metrics`),qie=(e,t,n)=>Rn.get(`/event-views/${e}/metrics/filter`,{params:{startDate:t,endDate:n}}),Hie=(e,t,n)=>Rn.get(`/event-views/${e}/metrics/daily`,{params:{startDate:t,endDate:n}}),Gie=(e,t,n,r=5)=>Rn.get(`/event-views/${e}/metrics/top-viewers`,{params:{startDate:t,endDate:n,limit:r}}),YE={community:{getMetrics:kie,getMetricsByDate:Rie,getDailyViews:zie,getTopViewers:Lie},business:{getMetrics:Fie,getMetricsByDate:Bie,getDailyViews:Vie,getTopViewers:Uie},event:{getMetrics:$ie,getMetricsByDate:qie,getDailyViews:Hie,getTopViewers:Gie}},_6={entities:{},loading:!1,error:null},Db=xi("metrics/fetchMetrics",async({entityType:e,entityId:t},{rejectWithValue:n,dispatch:r})=>{try{const l=await YE[e].getMetrics(t);return{entityId:t,data:l.data}}catch(l){return r(Jt({message:"No se pudieron cargar las métricas generales",type:"error"})),n(l.message||"Error al obtener métricas")}}),EC=xi("metrics/fetchMetricsByDate",async({entityType:e,entityId:t,startDate:n,endDate:r},{rejectWithValue:l,dispatch:d})=>{try{const p=await YE[e].getMetricsByDate(t,n,r);return{entityId:t,startDate:n,endDate:r,data:p.data}}catch(p){return d(Jt({message:"No se pudieron cargar las métricas filtradas",type:"error"})),l(p.message||"Error al obtener métricas")}}),nT=xi("metrics/fetchDailyViews",async({entityType:e,entityId:t,startDate:n,endDate:r},{rejectWithValue:l,dispatch:d})=>{try{const p=await YE[e].getDailyViews(t,n,r);return{entityId:t,startDate:n,endDate:r,data:p.data}}catch(p){return d(Jt({message:"No se pudieron cargar las vistas diarias",type:"error"})),l(p.message||"Error al obtener vistas diarias")}}),rT=xi("metrics/fetchTopViewers",async({entityType:e,entityId:t,startDate:n,endDate:r,limit:l},{rejectWithValue:d,dispatch:p})=>{try{const a=await YE[e].getTopViewers(t,n,r,l);return{entityId:t,startDate:n,endDate:r,data:a.data}}catch(a){return p(Jt({message:"No se pudo cargar el ranking de visitantes",type:"error"})),d(a.message||"Error al obtener ranking")}}),DU=Ia({name:"metrics",initialState:_6,reducers:{clearMetrics(e){e.entities={},e.error=null}},extraReducers:e=>{e.addCase(Tc,()=>_6).addCase(Db.pending,t=>{t.loading=!0,t.error=null}).addCase(Db.fulfilled,(t,n)=>{t.loading=!1;const{entityId:r,data:l}=n.payload;t.entities[r]||(t.entities[r]={}),t.entities[r].general=l}).addCase(Db.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(EC.pending,t=>{t.loading=!0,t.error=null}).addCase(EC.fulfilled,(t,n)=>{t.loading=!1;const{entityId:r,data:l,startDate:d,endDate:p}=n.payload;t.entities[r]||(t.entities[r]={});const a=`${d}_${p}`;t.entities[r].filtered||(t.entities[r].filtered={}),t.entities[r].filtered[a]=l}).addCase(EC.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(nT.pending,t=>{t.loading=!0,t.error=null}).addCase(nT.fulfilled,(t,n)=>{t.loading=!1;const{entityId:r,data:l,startDate:d,endDate:p}=n.payload;t.entities[r]||(t.entities[r]={});const a=`${d}_${p}`;t.entities[r].daily||(t.entities[r].daily={}),t.entities[r].daily[a]=l}).addCase(nT.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(rT.pending,t=>{t.loading=!0,t.error=null}).addCase(rT.fulfilled,(t,n)=>{t.loading=!1;const{entityId:r,data:l,startDate:d,endDate:p}=n.payload;t.entities[r]||(t.entities[r]={});const a=`${d}_${p}`;t.entities[r].topViewers||(t.entities[r].topViewers={}),t.entities[r].topViewers[a]=l}).addCase(rT.rejected,(t,n)=>{t.loading=!1,t.error=n.payload})}}),{clearMetrics:L6e}=DU.actions,Wie=DU.reducer,b6={isOpen:!1},OU=Ia({name:"mobileMenu",initialState:b6,reducers:{abrirMenu:e=>{e.isOpen=!0},cerrarMenu:e=>{e.isOpen=!1},toggleMenu:e=>{e.isOpen=!e.isOpen}},extraReducers:e=>{e.addCase(Tc,()=>b6)}}),{abrirMenu:F6e,cerrarMenu:bM,toggleMenu:Sd}=OU.actions,Zie=OU.reducer,Xie={comunidad:null,negocios:[],loaded:!1},wM=xi("comunidadSeleccionada/cargarNegocios",async({communityId:e,coords:t},{rejectWithValue:n,dispatch:r})=>{try{const l=await AP(e,t);return Array.isArray(l)?l:l.businesses||[]}catch(l){return r(Jt({message:"No se pudieron cargar los negocios de la comunidad",type:"error"})),n(l.message||"Error al cargar negocios")}}),AC=e=>{if(!(typeof window>"u"))try{window.localStorage.setItem("comunidadSeleccionada",JSON.stringify(e))}catch{}},IU=Ia({name:"comunidadSeleccionada",initialState:Xie,reducers:{setComunidadSeleccionada:(e,t)=>{const r={comunidad:t.payload||null,negocios:[],loaded:!1};return AC(r),r},setNegociosDeComunidad:(e,t)=>{const n=t.payload,r={...e,negocios:n,loaded:!0};return AC(r),r},limpiarComunidadSeleccionada:()=>(typeof window<"u"&&window.localStorage.removeItem("comunidadSeleccionada"),{comunidad:null,negocios:[],loaded:!1})},extraReducers:e=>{e.addCase(wM.fulfilled,(t,n)=>{t.negocios=n.payload,t.loaded=!0,AC(t)}).addCase(wM.rejected,t=>{t.loaded=!0})}}),{setComunidadSeleccionada:X1,setNegociosDeComunidad:B6e,limpiarComunidadSeleccionada:V6e}=IU.actions,Kie=IU.reducer,Ob=xi("ubicacion/obtener",async()=>new Promise(e=>{if(!navigator.geolocation)return console.warn("Geolocalización no disponible, usando Dallas"),e({lat:32.7767,lng:-96.797});navigator.geolocation.getCurrentPosition(t=>{const n=t.coords.latitude,r=t.coords.longitude;e({lat:n,lng:r})},t=>{console.warn("Error o permiso denegado:",t),e({lat:32.7767,lng:-96.797})},{timeout:1e4})})),Yie=Ia({name:"ubicacion",initialState:{coords:null,cargando:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(Ob.pending,t=>{t.cargando=!0,t.error=null}).addCase(Ob.fulfilled,(t,n)=>{t.coords=n.payload,t.cargando=!1}).addCase(Ob.rejected,(t,n)=>{t.error=n.payload,t.cargando=!1})}}),Qie=Yie.reducer,Jie=async e=>{const{data:t}=await Rn.post(`/user-promos/${e}`);return t},eae=async()=>{const{data:e}=await Rn.get("/user-promos");return e},tae=async e=>{const{data:t}=await Rn.post("/user-promos/redeem",{code:e});return t},iT=xi("userPromos/fetch",async(e,{rejectWithValue:t})=>{try{return await eae()}catch{return t("Error al obtener tus promociones guardadas")}}),kU=xi("userPromos/claim",async(e,{dispatch:t,rejectWithValue:n})=>{var r,l;try{const d=await Jie(e);return t(Jt({message:"¡Promoción guardada!",type:"success"})),d.userPromo}catch(d){return t(Jt({message:((l=(r=d==null?void 0:d.response)==null?void 0:r.data)==null?void 0:l.message)||"No se pudo guardar la promoción",type:"error"})),n("Error al guardar promoción")}}),RU=xi("userPromos/redeem",async(e,{dispatch:t,rejectWithValue:n})=>{var r,l;try{const d=await tae(e);return t(Jt({message:"Código redimido con éxito",type:"success"})),d.userPromo}catch(d){return t(Jt({message:((l=(r=d==null?void 0:d.response)==null?void 0:r.data)==null?void 0:l.message)||"Error al redimir código",type:"error"})),n("Error al redimir código")}}),nae=Ia({name:"userPromos",initialState:{lista:[],loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(iT.pending,t=>{t.loading=!0}).addCase(iT.fulfilled,(t,n)=>{t.loading=!1,t.lista=n.payload}).addCase(iT.rejected,(t,n)=>{t.loading=!1,t.error=n.payload}).addCase(kU.fulfilled,(t,n)=>{t.lista.push(n.payload)}).addCase(RU.fulfilled,(t,n)=>{const r=t.lista.findIndex(l=>l.code===n.payload.code);r!==-1&&(t.lista[r]=n.payload)})}}),rae=nae.reducer,iae=EV({reducer:{negocios:Vre,eventos:Kre,auth:tie,comunidades:cie,busquedaGlobal:die,categorias:yie,promociones:Cie,notificaciones:Mie,follow:Pie,conversations:Die,messages:Iie,metrics:Wie,feedback:zre,mobileMenu:Zie,comunidadSeleccionada:Kie,ubicacion:Qie,userPromos:rae}});var CC,w6;function aae(){if(w6)return CC;w6=1;var e=typeof Element<"u",t=typeof Map=="function",n=typeof Set=="function",r=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function l(d,p){if(d===p)return!0;if(d&&p&&typeof d=="object"&&typeof p=="object"){if(d.constructor!==p.constructor)return!1;var a,b,T;if(Array.isArray(d)){if(a=d.length,a!=p.length)return!1;for(b=a;b--!==0;)if(!l(d[b],p[b]))return!1;return!0}var E;if(t&&d instanceof Map&&p instanceof Map){if(d.size!==p.size)return!1;for(E=d.entries();!(b=E.next()).done;)if(!p.has(b.value[0]))return!1;for(E=d.entries();!(b=E.next()).done;)if(!l(b.value[1],p.get(b.value[0])))return!1;return!0}if(n&&d instanceof Set&&p instanceof Set){if(d.size!==p.size)return!1;for(E=d.entries();!(b=E.next()).done;)if(!p.has(b.value[0]))return!1;return!0}if(r&&ArrayBuffer.isView(d)&&ArrayBuffer.isView(p)){if(a=d.length,a!=p.length)return!1;for(b=a;b--!==0;)if(d[b]!==p[b])return!1;return!0}if(d.constructor===RegExp)return d.source===p.source&&d.flags===p.flags;if(d.valueOf!==Object.prototype.valueOf&&typeof d.valueOf=="function"&&typeof p.valueOf=="function")return d.valueOf()===p.valueOf();if(d.toString!==Object.prototype.toString&&typeof d.toString=="function"&&typeof p.toString=="function")return d.toString()===p.toString();if(T=Object.keys(d),a=T.length,a!==Object.keys(p).length)return!1;for(b=a;b--!==0;)if(!Object.prototype.hasOwnProperty.call(p,T[b]))return!1;if(e&&d instanceof Element)return!1;for(b=a;b--!==0;)if(!((T[b]==="_owner"||T[b]==="__v"||T[b]==="__o")&&d.$$typeof)&&!l(d[T[b]],p[T[b]]))return!1;return!0}return d!==d&&p!==p}return CC=function(p,a){try{return l(p,a)}catch(b){if((b.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw b}},CC}var sae=aae();const oae=Gs(sae);var jC,S6;function lae(){if(S6)return jC;S6=1;var e=function(t,n,r,l,d,p,a,b){if(!t){var T;if(n===void 0)T=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var E=[r,l,d,p,a,b],P=0;T=new Error(n.replace(/%s/g,function(){return E[P++]})),T.name="Invariant Violation"}throw T.framesToPop=1,T}};return jC=e,jC}var cae=lae();const T6=Gs(cae);var MC,E6;function uae(){return E6||(E6=1,MC=function(t,n,r,l){var d=r?r.call(l,t,n):void 0;if(d!==void 0)return!!d;if(t===n)return!0;if(typeof t!="object"||!t||typeof n!="object"||!n)return!1;var p=Object.keys(t),a=Object.keys(n);if(p.length!==a.length)return!1;for(var b=Object.prototype.hasOwnProperty.bind(n),T=0;T<p.length;T++){var E=p[T];if(!b(E))return!1;var P=t[E],I=n[E];if(d=r?r.call(l,P,I,E):void 0,d===!1||d===void 0&&P!==I)return!1}return!0}),MC}var dae=uae();const hae=Gs(dae);var zU=(e=>(e.BASE="base",e.BODY="body",e.HEAD="head",e.HTML="html",e.LINK="link",e.META="meta",e.NOSCRIPT="noscript",e.SCRIPT="script",e.STYLE="style",e.TITLE="title",e.FRAGMENT="Symbol(react.fragment)",e))(zU||{}),PC={link:{rel:["amphtml","canonical","alternate"]},script:{type:["application/ld+json"]},meta:{charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]}},A6=Object.values(zU),jP={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},fae=Object.entries(jP).reduce((e,[t,n])=>(e[n]=t,e),{}),Zh="data-rh",n_={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate",PRIORITIZE_SEO_TAGS:"prioritizeSeoTags"},r_=(e,t)=>{for(let n=e.length-1;n>=0;n-=1){const r=e[n];if(Object.prototype.hasOwnProperty.call(r,t))return r[t]}return null},pae=e=>{let t=r_(e,"title");const n=r_(e,n_.TITLE_TEMPLATE);if(Array.isArray(t)&&(t=t.join("")),n&&t)return n.replace(/%s/g,()=>t);const r=r_(e,n_.DEFAULT_TITLE);return t||r||void 0},mae=e=>r_(e,n_.ON_CHANGE_CLIENT_STATE)||(()=>{}),NC=(e,t)=>t.filter(n=>typeof n[e]<"u").map(n=>n[e]).reduce((n,r)=>({...n,...r}),{}),gae=(e,t)=>t.filter(n=>typeof n.base<"u").map(n=>n.base).reverse().reduce((n,r)=>{if(!n.length){const l=Object.keys(r);for(let d=0;d<l.length;d+=1){const a=l[d].toLowerCase();if(e.indexOf(a)!==-1&&r[a])return n.concat(r)}}return n},[]),xae=e=>console&&typeof console.warn=="function"&&console.warn(e),K1=(e,t,n)=>{const r={};return n.filter(l=>Array.isArray(l[e])?!0:(typeof l[e]<"u"&&xae(`Helmet: ${e} should be of type "Array". Instead found type "${typeof l[e]}"`),!1)).map(l=>l[e]).reverse().reduce((l,d)=>{const p={};d.filter(b=>{let T;const E=Object.keys(b);for(let I=0;I<E.length;I+=1){const R=E[I],F=R.toLowerCase();t.indexOf(F)!==-1&&!(T==="rel"&&b[T].toLowerCase()==="canonical")&&!(F==="rel"&&b[F].toLowerCase()==="stylesheet")&&(T=F),t.indexOf(R)!==-1&&(R==="innerHTML"||R==="cssText"||R==="itemprop")&&(T=R)}if(!T||!b[T])return!1;const P=b[T].toLowerCase();return r[T]||(r[T]={}),p[T]||(p[T]={}),r[T][P]?!1:(p[T][P]=!0,!0)}).reverse().forEach(b=>l.push(b));const a=Object.keys(p);for(let b=0;b<a.length;b+=1){const T=a[b],E={...r[T],...p[T]};r[T]=E}return l},[]).reverse()},yae=(e,t)=>{if(Array.isArray(e)&&e.length){for(let n=0;n<e.length;n+=1)if(e[n][t])return!0}return!1},vae=e=>({baseTag:gae(["href"],e),bodyAttributes:NC("bodyAttributes",e),defer:r_(e,n_.DEFER),encode:r_(e,n_.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:NC("htmlAttributes",e),linkTags:K1("link",["rel","href"],e),metaTags:K1("meta",["name","charset","http-equiv","property","itemprop"],e),noscriptTags:K1("noscript",["innerHTML"],e),onChangeClientState:mae(e),scriptTags:K1("script",["src","innerHTML"],e),styleTags:K1("style",["cssText"],e),title:pae(e),titleAttributes:NC("titleAttributes",e),prioritizeSeoTags:yae(e,n_.PRIORITIZE_SEO_TAGS)}),LU=e=>Array.isArray(e)?e.join(""):e,_ae=(e,t)=>{const n=Object.keys(e);for(let r=0;r<n.length;r+=1)if(t[n[r]]&&t[n[r]].includes(e[n[r]]))return!0;return!1},DC=(e,t)=>Array.isArray(e)?e.reduce((n,r)=>(_ae(r,t)?n.priority.push(r):n.default.push(r),n),{priority:[],default:[]}):{default:e,priority:[]},C6=(e,t)=>({...e,[t]:void 0}),bae=["noscript","script","style"],SM=(e,t=!0)=>t===!1?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),FU=e=>Object.keys(e).reduce((t,n)=>{const r=typeof e[n]<"u"?`${n}="${e[n]}"`:`${n}`;return t?`${t} ${r}`:r},""),wae=(e,t,n,r)=>{const l=FU(n),d=LU(t);return l?`<${e} ${Zh}="true" ${l}>${SM(d,r)}</${e}>`:`<${e} ${Zh}="true">${SM(d,r)}</${e}>`},Sae=(e,t,n=!0)=>t.reduce((r,l)=>{const d=l,p=Object.keys(d).filter(T=>!(T==="innerHTML"||T==="cssText")).reduce((T,E)=>{const P=typeof d[E]>"u"?E:`${E}="${SM(d[E],n)}"`;return T?`${T} ${P}`:P},""),a=d.innerHTML||d.cssText||"",b=bae.indexOf(e)===-1;return`${r}<${e} ${Zh}="true" ${p}${b?"/>":`>${a}</${e}>`}`},""),BU=(e,t={})=>Object.keys(e).reduce((n,r)=>{const l=jP[r];return n[l||r]=e[r],n},t),Tae=(e,t,n)=>{const r={key:t,[Zh]:!0},l=BU(n,r);return[$s.createElement("title",l,t)]},aT=(e,t)=>t.map((n,r)=>{const l={key:r,[Zh]:!0};return Object.keys(n).forEach(d=>{const a=jP[d]||d;if(a==="innerHTML"||a==="cssText"){const b=n.innerHTML||n.cssText;l.dangerouslySetInnerHTML={__html:b}}else l[a]=n[d]}),$s.createElement(e,l)}),Nd=(e,t,n=!0)=>{switch(e){case"title":return{toComponent:()=>Tae(e,t.title,t.titleAttributes),toString:()=>wae(e,t.title,t.titleAttributes,n)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>BU(t),toString:()=>FU(t)};default:return{toComponent:()=>aT(e,t),toString:()=>Sae(e,t,n)}}},Eae=({metaTags:e,linkTags:t,scriptTags:n,encode:r})=>{const l=DC(e,PC.meta),d=DC(t,PC.link),p=DC(n,PC.script);return{priorityMethods:{toComponent:()=>[...aT("meta",l.priority),...aT("link",d.priority),...aT("script",p.priority)],toString:()=>`${Nd("meta",l.priority,r)} ${Nd("link",d.priority,r)} ${Nd("script",p.priority,r)}`},metaTags:l.default,linkTags:d.default,scriptTags:p.default}},Aae=e=>{const{baseTag:t,bodyAttributes:n,encode:r=!0,htmlAttributes:l,noscriptTags:d,styleTags:p,title:a="",titleAttributes:b,prioritizeSeoTags:T}=e;let{linkTags:E,metaTags:P,scriptTags:I}=e,R={toComponent:()=>{},toString:()=>""};return T&&({priorityMethods:R,linkTags:E,metaTags:P,scriptTags:I}=Eae(e)),{priority:R,base:Nd("base",t,r),bodyAttributes:Nd("bodyAttributes",n,r),htmlAttributes:Nd("htmlAttributes",l,r),link:Nd("link",E,r),meta:Nd("meta",P,r),noscript:Nd("noscript",d,r),script:Nd("script",I,r),style:Nd("style",p,r),title:Nd("title",{title:a,titleAttributes:b},r)}},TM=Aae,yS=[],VU=!!(typeof window<"u"&&window.document&&window.document.createElement),EM=class{constructor(e,t){Au(this,"instances",[]);Au(this,"canUseDOM",VU);Au(this,"context");Au(this,"value",{setHelmet:e=>{this.context.helmet=e},helmetInstances:{get:()=>this.canUseDOM?yS:this.instances,add:e=>{(this.canUseDOM?yS:this.instances).push(e)},remove:e=>{const t=(this.canUseDOM?yS:this.instances).indexOf(e);(this.canUseDOM?yS:this.instances).splice(t,1)}}});this.context=e,this.canUseDOM=t||!1,t||(e.helmet=TM({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},Cae={},UU=$s.createContext(Cae),Y0,$U=(Y0=class extends V.Component{constructor(n){super(n);Au(this,"helmetData");this.helmetData=new EM(this.props.context||{},Y0.canUseDOM)}render(){return $s.createElement(UU.Provider,{value:this.helmetData.value},this.props.children)}},Au(Y0,"canUseDOM",VU),Y0),zv=(e,t)=>{const n=document.head||document.querySelector("head"),r=n.querySelectorAll(`${e}[${Zh}]`),l=[].slice.call(r),d=[];let p;return t&&t.length&&t.forEach(a=>{const b=document.createElement(e);for(const T in a)if(Object.prototype.hasOwnProperty.call(a,T))if(T==="innerHTML")b.innerHTML=a.innerHTML;else if(T==="cssText")b.styleSheet?b.styleSheet.cssText=a.cssText:b.appendChild(document.createTextNode(a.cssText));else{const E=T,P=typeof a[E]>"u"?"":a[E];b.setAttribute(T,P)}b.setAttribute(Zh,"true"),l.some((T,E)=>(p=E,b.isEqualNode(T)))?l.splice(p,1):d.push(b)}),l.forEach(a=>{var b;return(b=a.parentNode)==null?void 0:b.removeChild(a)}),d.forEach(a=>n.appendChild(a)),{oldTags:l,newTags:d}},AM=(e,t)=>{const n=document.getElementsByTagName(e)[0];if(!n)return;const r=n.getAttribute(Zh),l=r?r.split(","):[],d=[...l],p=Object.keys(t);for(const a of p){const b=t[a]||"";n.getAttribute(a)!==b&&n.setAttribute(a,b),l.indexOf(a)===-1&&l.push(a);const T=d.indexOf(a);T!==-1&&d.splice(T,1)}for(let a=d.length-1;a>=0;a-=1)n.removeAttribute(d[a]);l.length===d.length?n.removeAttribute(Zh):n.getAttribute(Zh)!==p.join(",")&&n.setAttribute(Zh,p.join(","))},jae=(e,t)=>{typeof e<"u"&&document.title!==e&&(document.title=LU(e)),AM("title",t)},j6=(e,t)=>{const{baseTag:n,bodyAttributes:r,htmlAttributes:l,linkTags:d,metaTags:p,noscriptTags:a,onChangeClientState:b,scriptTags:T,styleTags:E,title:P,titleAttributes:I}=e;AM("body",r),AM("html",l),jae(P,I);const R={baseTag:zv("base",n),linkTags:zv("link",d),metaTags:zv("meta",p),noscriptTags:zv("noscript",a),scriptTags:zv("script",T),styleTags:zv("style",E)},F={},W={};Object.keys(R).forEach($=>{const{newTags:Z,oldTags:ne}=R[$];Z.length&&(F[$]=Z),ne.length&&(W[$]=R[$].oldTags)}),t&&t(),b(e,F,W)},Y1=null,Mae=e=>{Y1&&cancelAnimationFrame(Y1),e.defer?Y1=requestAnimationFrame(()=>{j6(e,()=>{Y1=null})}):(j6(e),Y1=null)},Pae=Mae,M6=class extends V.Component{constructor(){super(...arguments);Au(this,"rendered",!1)}shouldComponentUpdate(t){return!hae(t,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:t}=this.props.context;t.remove(this),this.emitChange()}emitChange(){const{helmetInstances:t,setHelmet:n}=this.props.context;let r=null;const l=vae(t.get().map(d=>{const p={...d.props};return delete p.context,p}));$U.canUseDOM?Pae(l):TM&&(r=TM(l)),n(r)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:t}=this.props.context;t.add(this),this.emitChange()}render(){return this.init(),null}},aM,Oa=(aM=class extends V.Component{shouldComponentUpdate(e){return!oae(C6(this.props,"helmetData"),C6(e,"helmetData"))}mapNestedChildrenToProps(e,t){if(!t)return null;switch(e.type){case"script":case"noscript":return{innerHTML:t};case"style":return{cssText:t};default:throw new Error(`<${e.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren(e,t,n,r){return{...t,[e.type]:[...t[e.type]||[],{...n,...this.mapNestedChildrenToProps(e,r)}]}}mapObjectTypeChildren(e,t,n,r){switch(e.type){case"title":return{...t,[e.type]:r,titleAttributes:{...n}};case"body":return{...t,bodyAttributes:{...n}};case"html":return{...t,htmlAttributes:{...n}};default:return{...t,[e.type]:{...n}}}}mapArrayTypeChildrenToProps(e,t){let n={...t};return Object.keys(e).forEach(r=>{n={...n,[r]:e[r]}}),n}warnOnInvalidChildren(e,t){return T6(A6.some(n=>e.type===n),typeof e.type=="function"?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${A6.join(", ")} are allowed. Helmet does not support rendering <${e.type}> elements. Refer to our API for more information.`),T6(!t||typeof t=="string"||Array.isArray(t)&&!t.some(n=>typeof n!="string"),`Helmet expects a string as a child of <${e.type}>. Did you forget to wrap your children in braces? ( <${e.type}>{\`\`}</${e.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(e,t){let n={};return $s.Children.forEach(e,r=>{if(!r||!r.props)return;const{children:l,...d}=r.props,p=Object.keys(d).reduce((b,T)=>(b[fae[T]||T]=d[T],b),{});let{type:a}=r;switch(typeof a=="symbol"?a=a.toString():this.warnOnInvalidChildren(r,l),a){case"Symbol(react.fragment)":t=this.mapChildrenToProps(l,t);break;case"link":case"meta":case"noscript":case"script":case"style":n=this.flattenArrayTypeChildren(r,n,p,l);break;default:t=this.mapObjectTypeChildren(r,t,p,l);break}}),this.mapArrayTypeChildrenToProps(n,t)}render(){const{children:e,...t}=this.props;let n={...t},{helmetData:r}=t;if(e&&(n=this.mapChildrenToProps(e,n)),r&&!(r instanceof EM)){const l=r;r=new EM(l.context,!0),delete n.helmetData}return r?$s.createElement(M6,{...n,context:r.value}):$s.createElement(UU.Consumer,null,l=>$s.createElement(M6,{...n,context:l}))}},Au(aM,"defaultProps",{defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1}),aM),Q1={},P6;function Nae(){if(P6)return Q1;P6=1,Object.defineProperty(Q1,"__esModule",{value:!0}),Q1.parse=p,Q1.serialize=T;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,l=Object.prototype.toString,d=(()=>{const I=function(){};return I.prototype=Object.create(null),I})();function p(I,R){const F=new d,W=I.length;if(W<2)return F;const $=(R==null?void 0:R.decode)||E;let Z=0;do{const ne=I.indexOf("=",Z);if(ne===-1)break;const ie=I.indexOf(";",Z),ge=ie===-1?W:ie;if(ne>ge){Z=I.lastIndexOf(";",ne-1)+1;continue}const ae=a(I,Z,ne),se=b(I,ne,ae),me=I.slice(ae,se);if(F[me]===void 0){let ke=a(I,ne+1,ge),qe=b(I,ge,ke);const tt=$(I.slice(ke,qe));F[me]=tt}Z=ge+1}while(Z<W);return F}function a(I,R,F){do{const W=I.charCodeAt(R);if(W!==32&&W!==9)return R}while(++R<F);return F}function b(I,R,F){for(;R>F;){const W=I.charCodeAt(--R);if(W!==32&&W!==9)return R+1}return F}function T(I,R,F){const W=(F==null?void 0:F.encode)||encodeURIComponent;if(!e.test(I))throw new TypeError(`argument name is invalid: ${I}`);const $=W(R);if(!t.test($))throw new TypeError(`argument val is invalid: ${R}`);let Z=I+"="+$;if(!F)return Z;if(F.maxAge!==void 0){if(!Number.isInteger(F.maxAge))throw new TypeError(`option maxAge is invalid: ${F.maxAge}`);Z+="; Max-Age="+F.maxAge}if(F.domain){if(!n.test(F.domain))throw new TypeError(`option domain is invalid: ${F.domain}`);Z+="; Domain="+F.domain}if(F.path){if(!r.test(F.path))throw new TypeError(`option path is invalid: ${F.path}`);Z+="; Path="+F.path}if(F.expires){if(!P(F.expires)||!Number.isFinite(F.expires.valueOf()))throw new TypeError(`option expires is invalid: ${F.expires}`);Z+="; Expires="+F.expires.toUTCString()}if(F.httpOnly&&(Z+="; HttpOnly"),F.secure&&(Z+="; Secure"),F.partitioned&&(Z+="; Partitioned"),F.priority)switch(typeof F.priority=="string"?F.priority.toLowerCase():void 0){case"low":Z+="; Priority=Low";break;case"medium":Z+="; Priority=Medium";break;case"high":Z+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${F.priority}`)}if(F.sameSite)switch(typeof F.sameSite=="string"?F.sameSite.toLowerCase():F.sameSite){case!0:case"strict":Z+="; SameSite=Strict";break;case"lax":Z+="; SameSite=Lax";break;case"none":Z+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${F.sameSite}`)}return Z}function E(I){if(I.indexOf("%")===-1)return I;try{return decodeURIComponent(I)}catch{return I}}function P(I){return l.call(I)==="[object Date]"}return Q1}Nae();/**
 * react-router v7.6.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var qU=e=>{throw TypeError(e)},Dae=(e,t,n)=>t.has(e)||qU("Cannot "+n),OC=(e,t,n)=>(Dae(e,t,"read from private field"),n?n.call(e):t.get(e)),Oae=(e,t,n)=>t.has(e)?qU("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),N6="popstate";function Iae(e={}){function t(r,l){let{pathname:d,search:p,hash:a}=r.location;return Jb("",{pathname:d,search:p,hash:a},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function n(r,l){return typeof l=="string"?l:tx(l)}return Rae(t,n,null,e)}function Xi(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Ms(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function kae(){return Math.random().toString(36).substring(2,10)}function D6(e,t){return{usr:e.state,key:e.key,idx:t}}function Jb(e,t,n=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?dx(t):t,state:n,key:t&&t.key||r||kae()}}function tx({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function dx(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function Rae(e,t,n,r={}){let{window:l=document.defaultView,v5Compat:d=!1}=r,p=l.history,a="POP",b=null,T=E();T==null&&(T=0,p.replaceState({...p.state,idx:T},""));function E(){return(p.state||{idx:null}).idx}function P(){a="POP";let $=E(),Z=$==null?null:$-T;T=$,b&&b({action:a,location:W.location,delta:Z})}function I($,Z){a="PUSH";let ne=Jb(W.location,$,Z);T=E()+1;let ie=D6(ne,T),ge=W.createHref(ne);try{p.pushState(ie,"",ge)}catch(ae){if(ae instanceof DOMException&&ae.name==="DataCloneError")throw ae;l.location.assign(ge)}d&&b&&b({action:a,location:W.location,delta:1})}function R($,Z){a="REPLACE";let ne=Jb(W.location,$,Z);T=E();let ie=D6(ne,T),ge=W.createHref(ne);p.replaceState(ie,"",ge),d&&b&&b({action:a,location:W.location,delta:0})}function F($){return HU($)}let W={get action(){return a},get location(){return e(l,p)},listen($){if(b)throw new Error("A history only accepts one active listener");return l.addEventListener(N6,P),b=$,()=>{l.removeEventListener(N6,P),b=null}},createHref($){return t(l,$)},createURL:F,encodeLocation($){let Z=F($);return{pathname:Z.pathname,search:Z.search,hash:Z.hash}},push:I,replace:R,go($){return p.go($)}};return W}function HU(e,t=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Xi(n,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:tx(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}var vb,O6=class{constructor(e){if(Oae(this,vb,new Map),e)for(let[t,n]of e)this.set(t,n)}get(e){if(OC(this,vb).has(e))return OC(this,vb).get(e);if(e.defaultValue!==void 0)return e.defaultValue;throw new Error("No value found for context")}set(e,t){OC(this,vb).set(e,t)}};vb=new WeakMap;var zae=new Set(["lazy","caseSensitive","path","id","index","children"]);function Lae(e){return zae.has(e)}var Fae=new Set(["lazy","caseSensitive","path","id","index","unstable_middleware","children"]);function Bae(e){return Fae.has(e)}function Vae(e){return e.index===!0}function OT(e,t,n=[],r={}){return e.map((l,d)=>{let p=[...n,String(d)],a=typeof l.id=="string"?l.id:p.join("-");if(Xi(l.index!==!0||!l.children,"Cannot specify children on an index route"),Xi(!r[a],`Found a route id collision on id "${a}".  Route id's must be globally unique within Data Router usages`),Vae(l)){let b={...l,...t(l),id:a};return r[a]=b,b}else{let b={...l,...t(l),id:a,children:void 0};return r[a]=b,l.children&&(b.children=OT(l.children,t,p,r)),b}})}function Wg(e,t,n="/"){return sT(e,t,n,!1)}function sT(e,t,n,r){let l=typeof t=="string"?dx(t):t,d=Fd(l.pathname||"/",n);if(d==null)return null;let p=GU(e);$ae(p);let a=null;for(let b=0;a==null&&b<p.length;++b){let T=ese(d);a=Qae(p[b],T,r)}return a}function Uae(e,t){let{route:n,pathname:r,params:l}=e;return{id:n.id,pathname:r,params:l,data:t[n.id],handle:n.handle}}function GU(e,t=[],n=[],r=""){let l=(d,p,a)=>{let b={relativePath:a===void 0?d.path||"":a,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};b.relativePath.startsWith("/")&&(Xi(b.relativePath.startsWith(r),`Absolute route path "${b.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(r.length));let T=Qf([r,b.relativePath]),E=n.concat(b);d.children&&d.children.length>0&&(Xi(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${T}".`),GU(d.children,t,E,T)),!(d.path==null&&!d.index)&&t.push({path:T,score:Kae(T,d.index),routesMeta:E})};return e.forEach((d,p)=>{var a;if(d.path===""||!((a=d.path)!=null&&a.includes("?")))l(d,p);else for(let b of WU(d.path))l(d,p,b)}),t}function WU(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,l=n.endsWith("?"),d=n.replace(/\?$/,"");if(r.length===0)return l?[d,""]:[d];let p=WU(r.join("/")),a=[];return a.push(...p.map(b=>b===""?d:[d,b].join("/"))),l&&a.push(...p),a.map(b=>e.startsWith("/")&&b===""?"/":b)}function $ae(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:Yae(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var qae=/^:[\w-]+$/,Hae=3,Gae=2,Wae=1,Zae=10,Xae=-2,I6=e=>e==="*";function Kae(e,t){let n=e.split("/"),r=n.length;return n.some(I6)&&(r+=Xae),t&&(r+=Gae),n.filter(l=>!I6(l)).reduce((l,d)=>l+(qae.test(d)?Hae:d===""?Wae:Zae),r)}function Yae(e,t){return e.length===t.length&&e.slice(0,-1).every((r,l)=>r===t[l])?e[e.length-1]-t[t.length-1]:0}function Qae(e,t,n=!1){let{routesMeta:r}=e,l={},d="/",p=[];for(let a=0;a<r.length;++a){let b=r[a],T=a===r.length-1,E=d==="/"?t:t.slice(d.length)||"/",P=IT({path:b.relativePath,caseSensitive:b.caseSensitive,end:T},E),I=b.route;if(!P&&T&&n&&!r[r.length-1].route.index&&(P=IT({path:b.relativePath,caseSensitive:b.caseSensitive,end:!1},E)),!P)return null;Object.assign(l,P.params),p.push({params:l,pathname:Qf([d,P.pathname]),pathnameBase:rse(Qf([d,P.pathnameBase])),route:I}),P.pathnameBase!=="/"&&(d=Qf([d,P.pathnameBase]))}return p}function IT(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=Jae(e.path,e.caseSensitive,e.end),l=t.match(n);if(!l)return null;let d=l[0],p=d.replace(/(.)\/+$/,"$1"),a=l.slice(1);return{params:r.reduce((T,{paramName:E,isOptional:P},I)=>{if(E==="*"){let F=a[I]||"";p=d.slice(0,d.length-F.length).replace(/(.)\/+$/,"$1")}const R=a[I];return P&&!R?T[E]=void 0:T[E]=(R||"").replace(/%2F/g,"/"),T},{}),pathname:d,pathnameBase:p,pattern:e}}function Jae(e,t=!1,n=!0){Ms(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],l="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(p,a,b)=>(r.push({paramName:a,isOptional:b!=null}),b?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),l+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?l+="\\/*$":e!==""&&e!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,t?void 0:"i"),r]}function ese(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Ms(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Fd(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function tse(e,t="/"){let{pathname:n,search:r="",hash:l=""}=typeof e=="string"?dx(e):e;return{pathname:n?n.startsWith("/")?n:nse(n,t):t,search:ise(r),hash:ase(l)}}function nse(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(l=>{l===".."?n.length>1&&n.pop():l!=="."&&n.push(l)}),n.length>1?n.join("/"):"/"}function IC(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function ZU(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function QE(e){let t=ZU(e);return t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase)}function JE(e,t,n,r=!1){let l;typeof e=="string"?l=dx(e):(l={...e},Xi(!l.pathname||!l.pathname.includes("?"),IC("?","pathname","search",l)),Xi(!l.pathname||!l.pathname.includes("#"),IC("#","pathname","hash",l)),Xi(!l.search||!l.search.includes("#"),IC("#","search","hash",l)));let d=e===""||l.pathname==="",p=d?"/":l.pathname,a;if(p==null)a=n;else{let P=t.length-1;if(!r&&p.startsWith("..")){let I=p.split("/");for(;I[0]==="..";)I.shift(),P-=1;l.pathname=I.join("/")}a=P>=0?t[P]:"/"}let b=tse(l,a),T=p&&p!=="/"&&p.endsWith("/"),E=(d||p===".")&&n.endsWith("/");return!b.pathname.endsWith("/")&&(T||E)&&(b.pathname+="/"),b}var Qf=e=>e.join("/").replace(/\/\/+/g,"/"),rse=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),ise=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,ase=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,kT=class{constructor(e,t,n,r=!1){this.status=e,this.statusText=t||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function ew(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var XU=["POST","PUT","PATCH","DELETE"],sse=new Set(XU),ose=["GET",...XU],lse=new Set(ose),cse=new Set([301,302,303,307,308]),use=new Set([307,308]),kC={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},dse={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},J1={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},MP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,hse=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),KU="remix-router-transitions",YU=Symbol("ResetLoaderData");function fse(e){const t=e.window?e.window:typeof window<"u"?window:void 0,n=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u";Xi(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let r=e.hydrationRouteProperties||[],l=e.mapRouteProperties||hse,d={},p=OT(e.routes,l,void 0,d),a,b=e.basename||"/",T=e.dataStrategy||yse,E={unstable_middleware:!1,...e.future},P=null,I=new Set,R=null,F=null,W=null,$=e.hydrationData!=null,Z=Wg(p,e.history.location,b),ne=!1,ie=null,ge;if(Z==null&&!e.patchRoutesOnNavigation){let Te=Dd(404,{pathname:e.history.location.pathname}),{matches:te,route:le}=G6(p);ge=!0,Z=te,ie={[le.id]:Te}}else if(Z&&!e.hydrationData&&Yl(Z,p,e.history.location.pathname).active&&(Z=null),Z)if(Z.some(Te=>Te.route.lazy))ge=!1;else if(!Z.some(Te=>Te.route.loader))ge=!0;else{let Te=e.hydrationData?e.hydrationData.loaderData:null,te=e.hydrationData?e.hydrationData.errors:null;if(te){let le=Z.findIndex(ye=>te[ye.route.id]!==void 0);ge=Z.slice(0,le+1).every(ye=>!jM(ye.route,Te,te))}else ge=Z.every(le=>!jM(le.route,Te,te))}else{ge=!1,Z=[];let Te=Yl(null,p,e.history.location.pathname);Te.active&&Te.matches&&(ne=!0,Z=Te.matches)}let ae,se={historyAction:e.history.action,location:e.history.location,matches:Z,initialized:ge,navigation:kC,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||ie,fetchers:new Map,blockers:new Map},me="POP",ke=!1,qe,tt=!1,nt=new Map,bt=null,jt=!1,Nt=!1,vt=new Set,He=new Map,ut=0,Tt=-1,Yt=new Map,Ge=new Set,ot=new Map,mt=new Map,It=new Set,In=new Map,Mn,vn=null;function Zn(){if(P=e.history.listen(({action:Te,location:te,delta:le})=>{if(Mn){Mn(),Mn=void 0;return}Ms(In.size===0||le!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ye=yi({currentLocation:se.location,nextLocation:te,historyAction:Te});if(ye&&le!=null){let Me=new Promise(De=>{Mn=De});e.history.go(le*-1),vs(ye,{state:"blocked",location:te,proceed(){vs(ye,{state:"proceeding",proceed:void 0,reset:void 0,location:te}),Me.then(()=>e.history.go(le))},reset(){let De=new Map(se.blockers);De.set(ye,J1),er({blockers:De})}});return}return Zr(Te,te)}),n){Mse(t,nt);let Te=()=>Pse(t,nt);t.addEventListener("pagehide",Te),bt=()=>t.removeEventListener("pagehide",Te)}return se.initialized||Zr("POP",se.location,{initialHydration:!0}),ae}function Sr(){P&&P(),bt&&bt(),I.clear(),qe&&qe.abort(),se.fetchers.forEach((Te,te)=>pi(te)),se.blockers.forEach((Te,te)=>Os(te))}function un(Te){return I.add(Te),()=>I.delete(Te)}function er(Te,te={}){se={...se,...Te};let le=[],ye=[];se.fetchers.forEach((Me,De)=>{Me.state==="idle"&&(It.has(De)?le.push(De):ye.push(De))}),It.forEach(Me=>{!se.fetchers.has(Me)&&!He.has(Me)&&le.push(Me)}),[...I].forEach(Me=>Me(se,{deletedFetchers:le,viewTransitionOpts:te.viewTransitionOpts,flushSync:te.flushSync===!0})),le.forEach(Me=>pi(Me)),ye.forEach(Me=>se.fetchers.delete(Me))}function hr(Te,te,{flushSync:le}={}){var Ye,it;let ye=se.actionData!=null&&se.navigation.formMethod!=null&&Nu(se.navigation.formMethod)&&se.navigation.state==="loading"&&((Ye=Te.state)==null?void 0:Ye._isRedirect)!==!0,Me;te.actionData?Object.keys(te.actionData).length>0?Me=te.actionData:Me=null:ye?Me=se.actionData:Me=null;let De=te.loaderData?q6(se.loaderData,te.loaderData,te.matches||[],te.errors):se.loaderData,Be=se.blockers;Be.size>0&&(Be=new Map(Be),Be.forEach((Xe,St)=>Be.set(St,J1)));let Le=ke===!0||se.navigation.formMethod!=null&&Nu(se.navigation.formMethod)&&((it=Te.state)==null?void 0:it._isRedirect)!==!0;a&&(p=a,a=void 0),jt||me==="POP"||(me==="PUSH"?e.history.push(Te,Te.state):me==="REPLACE"&&e.history.replace(Te,Te.state));let Ue;if(me==="POP"){let Xe=nt.get(se.location.pathname);Xe&&Xe.has(Te.pathname)?Ue={currentLocation:se.location,nextLocation:Te}:nt.has(Te.pathname)&&(Ue={currentLocation:Te,nextLocation:se.location})}else if(tt){let Xe=nt.get(se.location.pathname);Xe?Xe.add(Te.pathname):(Xe=new Set([Te.pathname]),nt.set(se.location.pathname,Xe)),Ue={currentLocation:se.location,nextLocation:Te}}er({...te,actionData:Me,loaderData:De,historyAction:me,location:Te,initialized:!0,navigation:kC,revalidation:"idle",restoreScrollPosition:Hd(Te,te.matches||se.matches),preventScrollReset:Le,blockers:Be},{viewTransitionOpts:Ue,flushSync:le===!0}),me="POP",ke=!1,tt=!1,jt=!1,Nt=!1,vn==null||vn.resolve(),vn=null}async function dn(Te,te){if(typeof Te=="number"){e.history.go(Te);return}let le=CM(se.location,se.matches,b,Te,te==null?void 0:te.fromRouteId,te==null?void 0:te.relative),{path:ye,submission:Me,error:De}=k6(!1,le,te),Be=se.location,Le=Jb(se.location,ye,te&&te.state);Le={...Le,...e.history.encodeLocation(Le)};let Ue=te&&te.replace!=null?te.replace:void 0,Ye="PUSH";Ue===!0?Ye="REPLACE":Ue===!1||Me!=null&&Nu(Me.formMethod)&&Me.formAction===se.location.pathname+se.location.search&&(Ye="REPLACE");let it=te&&"preventScrollReset"in te?te.preventScrollReset===!0:void 0,Xe=(te&&te.flushSync)===!0,St=yi({currentLocation:Be,nextLocation:Le,historyAction:Ye});if(St){vs(St,{state:"blocked",location:Le,proceed(){vs(St,{state:"proceeding",proceed:void 0,reset:void 0,location:Le}),dn(Te,te)},reset(){let qt=new Map(se.blockers);qt.set(St,J1),er({blockers:qt})}});return}await Zr(Ye,Le,{submission:Me,pendingError:De,preventScrollReset:it,replace:te&&te.replace,enableViewTransition:te&&te.viewTransition,flushSync:Xe})}function Ir(){vn||(vn=Nse()),pn(),er({revalidation:"loading"});let Te=vn.promise;return se.navigation.state==="submitting"?Te:se.navigation.state==="idle"?(Zr(se.historyAction,se.location,{startUninterruptedRevalidation:!0}),Te):(Zr(me||se.historyAction,se.navigation.location,{overrideNavigation:se.navigation,enableViewTransition:tt===!0}),Te)}async function Zr(Te,te,le){qe&&qe.abort(),qe=null,me=Te,jt=(le&&le.startUninterruptedRevalidation)===!0,Kl(se.location,se.matches),ke=(le&&le.preventScrollReset)===!0,tt=(le&&le.enableViewTransition)===!0;let ye=a||p,Me=le&&le.overrideNavigation,De=le!=null&&le.initialHydration&&se.matches&&se.matches.length>0&&!ne?se.matches:Wg(ye,te,b),Be=(le&&le.flushSync)===!0;if(De&&se.initialized&&!Nt&&Tse(se.location,te)&&!(le&&le.submission&&Nu(le.submission.formMethod))){hr(te,{matches:De},{flushSync:Be});return}let Le=Yl(De,ye,te.pathname);if(Le.active&&Le.matches&&(De=Le.matches),!De){let{error:Fn,notFoundMatches:zn,route:Ln}=Is(te.pathname);hr(te,{matches:zn,loaderData:{},errors:{[Ln.id]:Fn}},{flushSync:Be});return}qe=new AbortController;let Ue=Gv(e.history,te,qe.signal,le&&le.submission),Ye=new O6(e.unstable_getContext?await e.unstable_getContext():void 0),it;if(le&&le.pendingError)it=[F0(De).route.id,{type:"error",error:le.pendingError}];else if(le&&le.submission&&Nu(le.submission.formMethod)){let Fn=await sa(Ue,te,le.submission,De,Ye,Le.active,le&&le.initialHydration===!0,{replace:le.replace,flushSync:Be});if(Fn.shortCircuited)return;if(Fn.pendingActionResult){let[zn,Ln]=Fn.pendingActionResult;if(Pu(Ln)&&ew(Ln.error)&&Ln.error.status===404){qe=null,hr(te,{matches:Fn.matches,loaderData:{},errors:{[zn]:Ln.error}});return}}De=Fn.matches||De,it=Fn.pendingActionResult,Me=RC(te,le.submission),Be=!1,Le.active=!1,Ue=Gv(e.history,Ue.url,Ue.signal)}let{shortCircuited:Xe,matches:St,loaderData:qt,errors:nn}=await Mi(Ue,te,De,Ye,Le.active,Me,le&&le.submission,le&&le.fetcherSubmission,le&&le.replace,le&&le.initialHydration===!0,Be,it);Xe||(qe=null,hr(te,{matches:St||De,...H6(it),loaderData:qt,errors:nn}))}async function sa(Te,te,le,ye,Me,De,Be,Le={}){pn();let Ue=Cse(te,le);if(er({navigation:Ue},{flushSync:Le.flushSync===!0}),De){let Xe=await Kt(ye,te.pathname,Te.signal);if(Xe.type==="aborted")return{shortCircuited:!0};if(Xe.type==="error"){let St=F0(Xe.partialMatches).route.id;return{matches:Xe.partialMatches,pendingActionResult:[St,{type:"error",error:Xe.error}]}}else if(Xe.matches)ye=Xe.matches;else{let{notFoundMatches:St,error:qt,route:nn}=Is(te.pathname);return{matches:St,pendingActionResult:[nn.id,{type:"error",error:qt}]}}}let Ye,it=_b(ye,te);if(!it.route.action&&!it.route.lazy)Ye={type:"error",error:Dd(405,{method:Te.method,pathname:te.pathname,routeId:it.route.id})};else{let Xe=i_(l,d,Te,ye,it,Be?[]:r,Me),St=await Hn(Te,Xe,Me,null);if(Ye=St[it.route.id],!Ye){for(let qt of ye)if(St[qt.route.id]){Ye=St[qt.route.id];break}}if(Te.signal.aborted)return{shortCircuited:!0}}if(U0(Ye)){let Xe;return Le&&Le.replace!=null?Xe=Le.replace:Xe=V6(Ye.response.headers.get("Location"),new URL(Te.url),b)===se.location.pathname+se.location.search,await Ft(Te,Ye,!0,{submission:le,replace:Xe}),{shortCircuited:!0}}if(Pu(Ye)){let Xe=F0(ye,it.route.id);return(Le&&Le.replace)!==!0&&(me="PUSH"),{matches:ye,pendingActionResult:[Xe.route.id,Ye,it.route.id]}}return{matches:ye,pendingActionResult:[it.route.id,Ye]}}async function Mi(Te,te,le,ye,Me,De,Be,Le,Ue,Ye,it,Xe){let St=De||RC(te,Be),qt=Be||Le||Z6(St),nn=!jt&&!Ye;if(Me){if(nn){let qi=Ci(Xe);er({navigation:St,...qi!==void 0?{actionData:qi}:{}},{flushSync:it})}let Ar=await Kt(le,te.pathname,Te.signal);if(Ar.type==="aborted")return{shortCircuited:!0};if(Ar.type==="error"){let qi=F0(Ar.partialMatches).route.id;return{matches:Ar.partialMatches,loaderData:{},errors:{[qi]:Ar.error}}}else if(Ar.matches)le=Ar.matches;else{let{error:qi,notFoundMatches:us,route:fa}=Is(te.pathname);return{matches:us,loaderData:{},errors:{[fa.id]:qi}}}}let Fn=a||p,{dsMatches:zn,revalidatingFetchers:Ln}=R6(Te,ye,l,d,e.history,se,le,qt,te,Ye?[]:r,Ye===!0,Nt,vt,It,ot,Ge,Fn,b,Xe);if(Tt=++ut,!e.dataStrategy&&!zn.some(Ar=>Ar.shouldLoad)&&Ln.length===0){let Ar=Ka();return hr(te,{matches:le,loaderData:{},errors:Xe&&Pu(Xe[1])?{[Xe[0]]:Xe[1].error}:null,...H6(Xe),...Ar?{fetchers:new Map(se.fetchers)}:{}},{flushSync:it}),{shortCircuited:!0}}if(nn){let Ar={};if(!Me){Ar.navigation=St;let qi=Ci(Xe);qi!==void 0&&(Ar.actionData=qi)}Ln.length>0&&(Ar.fetchers=ls(Ln)),er(Ar,{flushSync:it})}Ln.forEach(Ar=>{Ji(Ar.key),Ar.controller&&He.set(Ar.key,Ar.controller)});let cr=()=>Ln.forEach(Ar=>Ji(Ar.key));qe&&qe.signal.addEventListener("abort",cr);let{loaderResults:Qr,fetcherResults:or}=await Zt(zn,Ln,Te,ye);if(Te.signal.aborted)return{shortCircuited:!0};qe&&qe.signal.removeEventListener("abort",cr),Ln.forEach(Ar=>He.delete(Ar.key));let Lr=vS(Qr);if(Lr)return await Ft(Te,Lr.result,!0,{replace:Ue}),{shortCircuited:!0};if(Lr=vS(or),Lr)return Ge.add(Lr.key),await Ft(Te,Lr.result,!0,{replace:Ue}),{shortCircuited:!0};let{loaderData:Cr,errors:Jr}=$6(se,le,Qr,Xe,Ln,or);Ye&&se.errors&&(Jr={...se.errors,...Jr});let mi=Ka(),Ti=La(Tt),ea=mi||Ti||Ln.length>0;return{matches:le,loaderData:Cr,errors:Jr,...ea?{fetchers:new Map(se.fetchers)}:{}}}function Ci(Te){if(Te&&!Pu(Te[1]))return{[Te[0]]:Te[1].data};if(se.actionData)return Object.keys(se.actionData).length===0?null:se.actionData}function ls(Te){return Te.forEach(te=>{let le=se.fetchers.get(te.key),ye=eb(void 0,le?le.data:void 0);se.fetchers.set(te.key,ye)}),new Map(se.fetchers)}async function wa(Te,te,le,ye){Ji(Te);let Me=(ye&&ye.flushSync)===!0,De=a||p,Be=CM(se.location,se.matches,b,le,te,ye==null?void 0:ye.relative),Le=Wg(De,Be,b),Ue=Yl(Le,De,Be);if(Ue.active&&Ue.matches&&(Le=Ue.matches),!Le){Qn(Te,te,Dd(404,{pathname:Be}),{flushSync:Me});return}let{path:Ye,submission:it,error:Xe}=k6(!0,Be,ye);if(Xe){Qn(Te,te,Xe,{flushSync:Me});return}let St=_b(Le,Ye),qt=new O6(e.unstable_getContext?await e.unstable_getContext():void 0),nn=(ye&&ye.preventScrollReset)===!0;if(it&&Nu(it.formMethod)){await Xa(Te,te,Ye,St,Le,qt,Ue.active,Me,nn,it);return}ot.set(Te,{routeId:te,path:Ye}),await Ds(Te,te,Ye,St,Le,qt,Ue.active,Me,nn,it)}async function Xa(Te,te,le,ye,Me,De,Be,Le,Ue,Ye){pn(),ot.delete(Te);function it(ci){if(!ci.route.action&&!ci.route.lazy){let Ca=Dd(405,{method:Ye.formMethod,pathname:le,routeId:te});return Qn(Te,te,Ca,{flushSync:Le}),!0}return!1}if(!Be&&it(ye))return;let Xe=se.fetchers.get(Te);tr(Te,jse(Ye,Xe),{flushSync:Le});let St=new AbortController,qt=Gv(e.history,le,St.signal,Ye);if(Be){let ci=await Kt(Me,le,qt.signal,Te);if(ci.type==="aborted")return;if(ci.type==="error"){Qn(Te,te,ci.error,{flushSync:Le});return}else if(ci.matches){if(Me=ci.matches,ye=_b(Me,le),it(ye))return}else{Qn(Te,te,Dd(404,{pathname:le}),{flushSync:Le});return}}He.set(Te,St);let nn=ut,Fn=i_(l,d,qt,Me,ye,r,De),Ln=(await Hn(qt,Fn,De,Te))[ye.route.id];if(qt.signal.aborted){He.get(Te)===St&&He.delete(Te);return}if(It.has(Te)){if(U0(Ln)||Pu(Ln)){tr(Te,Bg(void 0));return}}else{if(U0(Ln))if(He.delete(Te),Tt>nn){tr(Te,Bg(void 0));return}else return Ge.add(Te),tr(Te,eb(Ye)),Ft(qt,Ln,!1,{fetcherSubmission:Ye,preventScrollReset:Ue});if(Pu(Ln)){Qn(Te,te,Ln.error);return}}let cr=se.navigation.location||se.location,Qr=Gv(e.history,cr,St.signal),or=a||p,Lr=se.navigation.state!=="idle"?Wg(or,se.navigation.location,b):se.matches;Xi(Lr,"Didn't find any matches after fetcher action");let Cr=++ut;Yt.set(Te,Cr);let Jr=eb(Ye,Ln.data);se.fetchers.set(Te,Jr);let{dsMatches:mi,revalidatingFetchers:Ti}=R6(Qr,De,l,d,e.history,se,Lr,Ye,cr,r,!1,Nt,vt,It,ot,Ge,or,b,[ye.route.id,Ln]);Ti.filter(ci=>ci.key!==Te).forEach(ci=>{let Ca=ci.key,No=se.fetchers.get(Ca),rs=eb(void 0,No?No.data:void 0);se.fetchers.set(Ca,rs),Ji(Ca),ci.controller&&He.set(Ca,ci.controller)}),er({fetchers:new Map(se.fetchers)});let ea=()=>Ti.forEach(ci=>Ji(ci.key));St.signal.addEventListener("abort",ea);let{loaderResults:Ar,fetcherResults:qi}=await Zt(mi,Ti,Qr,De);if(St.signal.aborted)return;if(St.signal.removeEventListener("abort",ea),Yt.delete(Te),He.delete(Te),Ti.forEach(ci=>He.delete(ci.key)),se.fetchers.has(Te)){let ci=Bg(Ln.data);se.fetchers.set(Te,ci)}let us=vS(Ar);if(us)return Ft(Qr,us.result,!1,{preventScrollReset:Ue});if(us=vS(qi),us)return Ge.add(us.key),Ft(Qr,us.result,!1,{preventScrollReset:Ue});let{loaderData:fa,errors:Fa}=$6(se,Lr,Ar,void 0,Ti,qi);La(Cr),se.navigation.state==="loading"&&Cr>Tt?(Xi(me,"Expected pending action"),qe&&qe.abort(),hr(se.navigation.location,{matches:Lr,loaderData:fa,errors:Fa,fetchers:new Map(se.fetchers)})):(er({errors:Fa,loaderData:q6(se.loaderData,fa,Lr,Fa),fetchers:new Map(se.fetchers)}),Nt=!1)}async function Ds(Te,te,le,ye,Me,De,Be,Le,Ue,Ye){let it=se.fetchers.get(Te);tr(Te,eb(Ye,it?it.data:void 0),{flushSync:Le});let Xe=new AbortController,St=Gv(e.history,le,Xe.signal);if(Be){let Ln=await Kt(Me,le,St.signal,Te);if(Ln.type==="aborted")return;if(Ln.type==="error"){Qn(Te,te,Ln.error,{flushSync:Le});return}else if(Ln.matches)Me=Ln.matches,ye=_b(Me,le);else{Qn(Te,te,Dd(404,{pathname:le}),{flushSync:Le});return}}He.set(Te,Xe);let qt=ut,nn=i_(l,d,St,Me,ye,r,De),zn=(await Hn(St,nn,De,Te))[ye.route.id];if(He.get(Te)===Xe&&He.delete(Te),!St.signal.aborted){if(It.has(Te)){tr(Te,Bg(void 0));return}if(U0(zn))if(Tt>qt){tr(Te,Bg(void 0));return}else{Ge.add(Te),await Ft(St,zn,!1,{preventScrollReset:Ue});return}if(Pu(zn)){Qn(Te,te,zn.error);return}tr(Te,Bg(zn.data))}}async function Ft(Te,te,le,{submission:ye,fetcherSubmission:Me,preventScrollReset:De,replace:Be}={}){te.response.headers.has("X-Remix-Revalidate")&&(Nt=!0);let Le=te.response.headers.get("Location");Xi(Le,"Expected a Location header on the redirect Response"),Le=V6(Le,new URL(Te.url),b);let Ue=Jb(se.location,Le,{_isRedirect:!0});if(n){let nn=!1;if(te.response.headers.has("X-Remix-Reload-Document"))nn=!0;else if(MP.test(Le)){const Fn=HU(Le,!0);nn=Fn.origin!==t.location.origin||Fd(Fn.pathname,b)==null}if(nn){Be?t.location.replace(Le):t.location.assign(Le);return}}qe=null;let Ye=Be===!0||te.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:it,formAction:Xe,formEncType:St}=se.navigation;!ye&&!Me&&it&&Xe&&St&&(ye=Z6(se.navigation));let qt=ye||Me;if(use.has(te.response.status)&&qt&&Nu(qt.formMethod))await Zr(Ye,Ue,{submission:{...qt,formAction:Le},preventScrollReset:De||ke,enableViewTransition:le?tt:void 0});else{let nn=RC(Ue,ye);await Zr(Ye,Ue,{overrideNavigation:nn,fetcherSubmission:Me,preventScrollReset:De||ke,enableViewTransition:le?tt:void 0})}}async function Hn(Te,te,le,ye){let Me,De={};try{Me=await vse(T,Te,te,ye,le,!1)}catch(Be){return te.filter(Le=>Le.shouldLoad).forEach(Le=>{De[Le.route.id]={type:"error",error:Be}}),De}if(Te.signal.aborted)return De;for(let[Be,Le]of Object.entries(Me))if(Ese(Le)){let Ue=Le.result;De[Be]={type:"redirect",response:wse(Ue,Te,Be,te,b)}}else De[Be]=await bse(Le);return De}async function Zt(Te,te,le,ye){let Me=Hn(le,Te,ye,null),De=Promise.all(te.map(async Ue=>{if(Ue.matches&&Ue.match&&Ue.request&&Ue.controller){let it=(await Hn(Ue.request,Ue.matches,ye,Ue.key))[Ue.match.route.id];return{[Ue.key]:it}}else return Promise.resolve({[Ue.key]:{type:"error",error:Dd(404,{pathname:Ue.path})}})})),Be=await Me,Le=(await De).reduce((Ue,Ye)=>Object.assign(Ue,Ye),{});return{loaderResults:Be,fetcherResults:Le}}function pn(){Nt=!0,ot.forEach((Te,te)=>{He.has(te)&&vt.add(te),Ji(te)})}function tr(Te,te,le={}){se.fetchers.set(Te,te),er({fetchers:new Map(se.fetchers)},{flushSync:(le&&le.flushSync)===!0})}function Qn(Te,te,le,ye={}){let Me=F0(se.matches,te);pi(Te),er({errors:{[Me.route.id]:le},fetchers:new Map(se.fetchers)},{flushSync:(ye&&ye.flushSync)===!0})}function Yr(Te){return mt.set(Te,(mt.get(Te)||0)+1),It.has(Te)&&It.delete(Te),se.fetchers.get(Te)||dse}function pi(Te){let te=se.fetchers.get(Te);He.has(Te)&&!(te&&te.state==="loading"&&Yt.has(Te))&&Ji(Te),ot.delete(Te),Yt.delete(Te),Ge.delete(Te),It.delete(Te),vt.delete(Te),se.fetchers.delete(Te)}function Ua(Te){let te=(mt.get(Te)||0)-1;te<=0?(mt.delete(Te),It.add(Te)):mt.set(Te,te),er({fetchers:new Map(se.fetchers)})}function Ji(Te){let te=He.get(Te);te&&(te.abort(),He.delete(Te))}function Xs(Te){for(let te of Te){let le=Yr(te),ye=Bg(le.data);se.fetchers.set(te,ye)}}function Ka(){let Te=[],te=!1;for(let le of Ge){let ye=se.fetchers.get(le);Xi(ye,`Expected fetcher: ${le}`),ye.state==="loading"&&(Ge.delete(le),Te.push(le),te=!0)}return Xs(Te),te}function La(Te){let te=[];for(let[le,ye]of Yt)if(ye<Te){let Me=se.fetchers.get(le);Xi(Me,`Expected fetcher: ${le}`),Me.state==="loading"&&(Ji(le),Yt.delete(le),te.push(le))}return Xs(te),te.length>0}function cs(Te,te){let le=se.blockers.get(Te)||J1;return In.get(Te)!==te&&In.set(Te,te),le}function Os(Te){se.blockers.delete(Te),In.delete(Te)}function vs(Te,te){let le=se.blockers.get(Te)||J1;Xi(le.state==="unblocked"&&te.state==="blocked"||le.state==="blocked"&&te.state==="blocked"||le.state==="blocked"&&te.state==="proceeding"||le.state==="blocked"&&te.state==="unblocked"||le.state==="proceeding"&&te.state==="unblocked",`Invalid blocker state transition: ${le.state} -> ${te.state}`);let ye=new Map(se.blockers);ye.set(Te,te),er({blockers:ye})}function yi({currentLocation:Te,nextLocation:te,historyAction:le}){if(In.size===0)return;In.size>1&&Ms(!1,"A router only supports one blocker at a time");let ye=Array.from(In.entries()),[Me,De]=ye[ye.length-1],Be=se.blockers.get(Me);if(!(Be&&Be.state==="proceeding")&&De({currentLocation:Te,nextLocation:te,historyAction:le}))return Me}function Is(Te){let te=Dd(404,{pathname:Te}),le=a||p,{matches:ye,route:Me}=G6(le);return{notFoundMatches:ye,route:Me,error:te}}function Yc(Te,te,le){if(R=Te,W=te,F=le||null,!$&&se.navigation===kC){$=!0;let ye=Hd(se.location,se.matches);ye!=null&&er({restoreScrollPosition:ye})}return()=>{R=null,W=null,F=null}}function ks(Te,te){return F&&F(Te,te.map(ye=>Uae(ye,se.loaderData)))||Te.key}function Kl(Te,te){if(R&&W){let le=ks(Te,te);R[le]=W()}}function Hd(Te,te){if(R){let le=ks(Te,te),ye=R[le];if(typeof ye=="number")return ye}return null}function Yl(Te,te,le){if(e.patchRoutesOnNavigation)if(Te){if(Object.keys(Te[0].params).length>0)return{active:!0,matches:sT(te,le,b,!0)}}else return{active:!0,matches:sT(te,le,b,!0)||[]};return{active:!1,matches:null}}async function Kt(Te,te,le,ye){if(!e.patchRoutesOnNavigation)return{type:"success",matches:Te};let Me=Te;for(;;){let De=a==null,Be=a||p,Le=d;try{await e.patchRoutesOnNavigation({signal:le,path:te,matches:Me,fetcherKey:ye,patch:(it,Xe)=>{le.aborted||z6(it,Xe,Be,Le,l)}})}catch(it){return{type:"error",error:it,partialMatches:Me}}finally{De&&!le.aborted&&(p=[...p])}if(le.aborted)return{type:"aborted"};let Ue=Wg(Be,te,b);if(Ue)return{type:"success",matches:Ue};let Ye=sT(Be,te,b,!0);if(!Ye||Me.length===Ye.length&&Me.every((it,Xe)=>it.route.id===Ye[Xe].route.id))return{type:"success",matches:null};Me=Ye}}function el(Te){d={},a=OT(Te,l,void 0,d)}function Fu(Te,te){let le=a==null;z6(Te,te,a||p,d,l),le&&(p=[...p],er({}))}return ae={get basename(){return b},get future(){return E},get state(){return se},get routes(){return p},get window(){return t},initialize:Zn,subscribe:un,enableScrollRestoration:Yc,navigate:dn,fetch:wa,revalidate:Ir,createHref:Te=>e.history.createHref(Te),encodeLocation:Te=>e.history.encodeLocation(Te),getFetcher:Yr,deleteFetcher:Ua,dispose:Sr,getBlocker:cs,deleteBlocker:Os,patchRoutes:Fu,_internalFetchControllers:He,_internalSetRoutes:el},ae}function pse(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function CM(e,t,n,r,l,d){let p,a;if(l){p=[];for(let T of t)if(p.push(T),T.route.id===l){a=T;break}}else p=t,a=t[t.length-1];let b=JE(r||".",QE(p),Fd(e.pathname,n)||e.pathname,d==="path");if(r==null&&(b.search=e.search,b.hash=e.hash),(r==null||r===""||r===".")&&a){let T=PP(b.search);if(a.route.index&&!T)b.search=b.search?b.search.replace(/^\?/,"?index&"):"?index";else if(!a.route.index&&T){let E=new URLSearchParams(b.search),P=E.getAll("index");E.delete("index"),P.filter(R=>R).forEach(R=>E.append("index",R));let I=E.toString();b.search=I?`?${I}`:""}}return n!=="/"&&(b.pathname=b.pathname==="/"?n:Qf([n,b.pathname])),tx(b)}function k6(e,t,n){if(!n||!pse(n))return{path:t};if(n.formMethod&&!Ase(n.formMethod))return{path:t,error:Dd(405,{method:n.formMethod})};let r=()=>({path:t,error:Dd(400,{type:"invalid-body"})}),d=(n.formMethod||"get").toUpperCase(),p=r$(t);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!Nu(d))return r();let P=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((I,[R,F])=>`${I}${R}=${F}
`,""):String(n.body);return{path:t,submission:{formMethod:d,formAction:p,formEncType:n.formEncType,formData:void 0,json:void 0,text:P}}}else if(n.formEncType==="application/json"){if(!Nu(d))return r();try{let P=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:t,submission:{formMethod:d,formAction:p,formEncType:n.formEncType,formData:void 0,json:P,text:void 0}}}catch{return r()}}}Xi(typeof FormData=="function","FormData is not available in this environment");let a,b;if(n.formData)a=PM(n.formData),b=n.formData;else if(n.body instanceof FormData)a=PM(n.body),b=n.body;else if(n.body instanceof URLSearchParams)a=n.body,b=U6(a);else if(n.body==null)a=new URLSearchParams,b=new FormData;else try{a=new URLSearchParams(n.body),b=U6(a)}catch{return r()}let T={formMethod:d,formAction:p,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:b,json:void 0,text:void 0};if(Nu(T.formMethod))return{path:t,submission:T};let E=dx(t);return e&&E.search&&PP(E.search)&&a.append("index",""),E.search=`?${a}`,{path:tx(E),submission:T}}function R6(e,t,n,r,l,d,p,a,b,T,E,P,I,R,F,W,$,Z,ne){var bt;let ie=ne?Pu(ne[1])?ne[1].error:ne[1].data:void 0,ge=l.createURL(d.location),ae=l.createURL(b),se;if(E&&d.errors){let jt=Object.keys(d.errors)[0];se=p.findIndex(Nt=>Nt.route.id===jt)}else if(ne&&Pu(ne[1])){let jt=ne[0];se=p.findIndex(Nt=>Nt.route.id===jt)-1}let me=ne?ne[1].statusCode:void 0,ke=me&&me>=400,qe={currentUrl:ge,currentParams:((bt=d.matches[0])==null?void 0:bt.params)||{},nextUrl:ae,nextParams:p[0].params,...a,actionResult:ie,actionStatus:me},tt=p.map((jt,Nt)=>{let{route:vt}=jt,He=null;if(se!=null&&Nt>se?He=!1:vt.lazy?He=!0:vt.loader==null?He=!1:E?He=jM(vt,d.loaderData,d.errors):mse(d.loaderData,d.matches[Nt],jt)&&(He=!0),He!==null)return MM(n,r,e,jt,T,t,He);let ut=ke?!1:P||ge.pathname+ge.search===ae.pathname+ae.search||ge.search!==ae.search||gse(d.matches[Nt],jt),Tt={...qe,defaultShouldRevalidate:ut},Yt=RT(jt,Tt);return MM(n,r,e,jt,T,t,Yt,Tt)}),nt=[];return F.forEach((jt,Nt)=>{if(E||!p.some(ot=>ot.route.id===jt.routeId)||R.has(Nt))return;let vt=Wg($,jt.path,Z);if(!vt){nt.push({key:Nt,routeId:jt.routeId,path:jt.path,matches:null,match:null,request:null,controller:null});return}if(W.has(Nt))return;let He=d.fetchers.get(Nt),ut=_b(vt,jt.path),Tt=new AbortController,Yt=Gv(l,jt.path,Tt.signal),Ge=null;if(I.has(Nt))I.delete(Nt),Ge=i_(n,r,Yt,vt,ut,T,t);else if(He&&He.state!=="idle"&&He.data===void 0)P&&(Ge=i_(n,r,Yt,vt,ut,T,t));else{let ot={...qe,defaultShouldRevalidate:ke?!1:P};RT(ut,ot)&&(Ge=i_(n,r,Yt,vt,ut,T,t,ot))}Ge&&nt.push({key:Nt,routeId:jt.routeId,path:jt.path,matches:Ge,match:ut,request:Yt,controller:Tt})}),{dsMatches:tt,revalidatingFetchers:nt}}function jM(e,t,n){if(e.lazy)return!0;if(!e.loader)return!1;let r=t!=null&&e.id in t,l=n!=null&&n[e.id]!==void 0;return!r&&l?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!r&&!l}function mse(e,t,n){let r=!t||n.route.id!==t.route.id,l=!e.hasOwnProperty(n.route.id);return r||l}function gse(e,t){let n=e.route.path;return e.pathname!==t.pathname||n!=null&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}function RT(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if(typeof n=="boolean")return n}return t.defaultShouldRevalidate}function z6(e,t,n,r,l){let d;if(e){let b=r[e];Xi(b,`No route found to patch children into: routeId = ${e}`),b.children||(b.children=[]),d=b.children}else d=n;let p=t.filter(b=>!d.some(T=>QU(b,T))),a=OT(p,l,[e||"_","patch",String((d==null?void 0:d.length)||"0")],r);d.push(...a)}function QU(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((n,r)=>{var l;return(l=t.children)==null?void 0:l.some(d=>QU(n,d))}):!1}var L6=new WeakMap,JU=({key:e,route:t,manifest:n,mapRouteProperties:r})=>{let l=n[t.id];if(Xi(l,"No route found in manifest"),!l.lazy||typeof l.lazy!="object")return;let d=l.lazy[e];if(!d)return;let p=L6.get(l);p||(p={},L6.set(l,p));let a=p[e];if(a)return a;let b=(async()=>{let T=Lae(e),P=l[e]!==void 0&&e!=="hasErrorBoundary";if(T)Ms(!T,"Route property "+e+" is not a supported lazy route property. This property will be ignored."),p[e]=Promise.resolve();else if(P)Ms(!1,`Route "${l.id}" has a static property "${e}" defined. The lazy property will be ignored.`);else{let I=await d();I!=null&&(Object.assign(l,{[e]:I}),Object.assign(l,r(l)))}typeof l.lazy=="object"&&(l.lazy[e]=void 0,Object.values(l.lazy).every(I=>I===void 0)&&(l.lazy=void 0))})();return p[e]=b,b},F6=new WeakMap;function xse(e,t,n,r,l){let d=n[e.id];if(Xi(d,"No route found in manifest"),!e.lazy)return{lazyRoutePromise:void 0,lazyHandlerPromise:void 0};if(typeof e.lazy=="function"){let E=F6.get(d);if(E)return{lazyRoutePromise:E,lazyHandlerPromise:E};let P=(async()=>{Xi(typeof e.lazy=="function","No lazy route function found");let I=await e.lazy(),R={};for(let F in I){let W=I[F];if(W===void 0)continue;let $=Bae(F),ne=d[F]!==void 0&&F!=="hasErrorBoundary";$?Ms(!$,"Route property "+F+" is not a supported property to be returned from a lazy route function. This property will be ignored."):ne?Ms(!ne,`Route "${d.id}" has a static property "${F}" defined but its lazy function is also returning a value for this property. The lazy route property "${F}" will be ignored.`):R[F]=W}Object.assign(d,R),Object.assign(d,{...r(d),lazy:void 0})})();return F6.set(d,P),P.catch(()=>{}),{lazyRoutePromise:P,lazyHandlerPromise:P}}let p=Object.keys(e.lazy),a=[],b;for(let E of p){if(l&&l.includes(E))continue;let P=JU({key:E,route:e,manifest:n,mapRouteProperties:r});P&&(a.push(P),E===t&&(b=P))}let T=a.length>0?Promise.all(a).then(()=>{}):void 0;return T==null||T.catch(()=>{}),b==null||b.catch(()=>{}),{lazyRoutePromise:T,lazyHandlerPromise:b}}async function B6(e){let t=e.matches.filter(l=>l.shouldLoad),n={};return(await Promise.all(t.map(l=>l.resolve()))).forEach((l,d)=>{n[t[d].route.id]=l}),n}async function yse(e){return e.matches.some(t=>t.route.unstable_middleware)?e$(e,!1,()=>B6(e),(t,n)=>({[n]:{type:"error",result:t}})):B6(e)}async function e$(e,t,n,r){let{matches:l,request:d,params:p,context:a}=e,b={handlerResult:void 0};try{let T=l.flatMap(P=>P.route.unstable_middleware?P.route.unstable_middleware.map(I=>[P.route.id,I]):[]),E=await t$({request:d,params:p,context:a},T,t,b,n);return t?E:b.handlerResult}catch(T){if(!b.middlewareError)throw T;let E=await r(b.middlewareError.error,b.middlewareError.routeId);return b.handlerResult?Object.assign(b.handlerResult,E):E}}async function t$(e,t,n,r,l,d=0){let{request:p}=e;if(p.signal.aborted)throw p.signal.reason?p.signal.reason:new Error(`Request aborted without an \`AbortSignal.reason\`: ${p.method} ${p.url}`);let a=t[d];if(!a)return r.handlerResult=await l(),r.handlerResult;let[b,T]=a,E=!1,P,I=async()=>{if(E)throw new Error("You may only call `next()` once per middleware");E=!0,await t$(e,t,n,r,l,d+1)};try{let R=await T({request:e.request,params:e.params,context:e.context},I);return E?R===void 0?P:R:I()}catch(R){throw r.middlewareError?r.middlewareError.error!==R&&(r.middlewareError={routeId:b,error:R}):r.middlewareError={routeId:b,error:R},R}}function n$(e,t,n,r,l){let d=JU({key:"unstable_middleware",route:r.route,manifest:t,mapRouteProperties:e}),p=xse(r.route,Nu(n.method)?"action":"loader",t,e,l);return{middleware:d,route:p.lazyRoutePromise,handler:p.lazyHandlerPromise}}function MM(e,t,n,r,l,d,p,a=null){let b=!1,T=n$(e,t,n,r,l);return{...r,_lazyPromises:T,shouldLoad:p,unstable_shouldRevalidateArgs:a,unstable_shouldCallHandler(E){return b=!0,a?typeof E=="boolean"?RT(r,{...a,defaultShouldRevalidate:E}):RT(r,a):p},resolve(E){return b||p||E&&n.method==="GET"&&(r.route.lazy||r.route.loader)?_se({request:n,match:r,lazyHandlerPromise:T==null?void 0:T.handler,lazyRoutePromise:T==null?void 0:T.route,handlerOverride:E,scopedContext:d}):Promise.resolve({type:"data",result:void 0})}}}function i_(e,t,n,r,l,d,p,a=null){return r.map(b=>b.route.id!==l.route.id?{...b,shouldLoad:!1,unstable_shouldRevalidateArgs:a,unstable_shouldCallHandler:()=>!1,_lazyPromises:n$(e,t,n,b,d),resolve:()=>Promise.resolve({type:"data",result:void 0})}:MM(e,t,n,b,d,p,!0,a))}async function vse(e,t,n,r,l,d){n.some(T=>{var E;return(E=T._lazyPromises)==null?void 0:E.middleware})&&await Promise.all(n.map(T=>{var E;return(E=T._lazyPromises)==null?void 0:E.middleware}));let p={request:t,params:n[0].params,context:l,matches:n},b=await e({...p,fetcherKey:r,unstable_runClientMiddleware:T=>{let E=p;return e$(E,!1,()=>T({...E,fetcherKey:r,unstable_runClientMiddleware:()=>{throw new Error("Cannot call `unstable_runClientMiddleware()` from within an `unstable_runClientMiddleware` handler")}}),(P,I)=>({[I]:{type:"error",result:P}}))}});try{await Promise.all(n.flatMap(T=>{var E,P;return[(E=T._lazyPromises)==null?void 0:E.handler,(P=T._lazyPromises)==null?void 0:P.route]}))}catch{}return b}async function _se({request:e,match:t,lazyHandlerPromise:n,lazyRoutePromise:r,handlerOverride:l,scopedContext:d}){let p,a,b=Nu(e.method),T=b?"action":"loader",E=P=>{let I,R=new Promise(($,Z)=>I=Z);a=()=>I(),e.signal.addEventListener("abort",a);let F=$=>typeof P!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${T}" [routeId: ${t.route.id}]`)):P({request:e,params:t.params,context:d},...$!==void 0?[$]:[]),W=(async()=>{try{return{type:"data",result:await(l?l(Z=>F(Z)):F())}}catch($){return{type:"error",result:$}}})();return Promise.race([W,R])};try{let P=b?t.route.action:t.route.loader;if(n||r)if(P){let I,[R]=await Promise.all([E(P).catch(F=>{I=F}),n,r]);if(I!==void 0)throw I;p=R}else{await n;let I=b?t.route.action:t.route.loader;if(I)[p]=await Promise.all([E(I),r]);else if(T==="action"){let R=new URL(e.url),F=R.pathname+R.search;throw Dd(405,{method:e.method,pathname:F,routeId:t.route.id})}else return{type:"data",result:void 0}}else if(P)p=await E(P);else{let I=new URL(e.url),R=I.pathname+I.search;throw Dd(404,{pathname:R})}}catch(P){return{type:"error",result:P}}finally{a&&e.signal.removeEventListener("abort",a)}return p}async function bse(e){var r,l,d,p,a,b;let{result:t,type:n}=e;if(i$(t)){let T;try{let E=t.headers.get("Content-Type");E&&/\bapplication\/json\b/.test(E)?t.body==null?T=null:T=await t.json():T=await t.text()}catch(E){return{type:"error",error:E}}return n==="error"?{type:"error",error:new kT(t.status,t.statusText,T),statusCode:t.status,headers:t.headers}:{type:"data",data:T,statusCode:t.status,headers:t.headers}}return n==="error"?W6(t)?t.data instanceof Error?{type:"error",error:t.data,statusCode:(r=t.init)==null?void 0:r.status,headers:(l=t.init)!=null&&l.headers?new Headers(t.init.headers):void 0}:{type:"error",error:new kT(((d=t.init)==null?void 0:d.status)||500,void 0,t.data),statusCode:ew(t)?t.status:void 0,headers:(p=t.init)!=null&&p.headers?new Headers(t.init.headers):void 0}:{type:"error",error:t,statusCode:ew(t)?t.status:void 0}:W6(t)?{type:"data",data:t.data,statusCode:(a=t.init)==null?void 0:a.status,headers:(b=t.init)!=null&&b.headers?new Headers(t.init.headers):void 0}:{type:"data",data:t}}function wse(e,t,n,r,l){let d=e.headers.get("Location");if(Xi(d,"Redirects returned/thrown from loaders/actions must have a Location header"),!MP.test(d)){let p=r.slice(0,r.findIndex(a=>a.route.id===n)+1);d=CM(new URL(t.url),p,l,d),e.headers.set("Location",d)}return e}function V6(e,t,n){if(MP.test(e)){let r=e,l=r.startsWith("//")?new URL(t.protocol+r):new URL(r),d=Fd(l.pathname,n)!=null;if(l.origin===t.origin&&d)return l.pathname+l.search+l.hash}return e}function Gv(e,t,n,r){let l=e.createURL(r$(t)).toString(),d={signal:n};if(r&&Nu(r.formMethod)){let{formMethod:p,formEncType:a}=r;d.method=p.toUpperCase(),a==="application/json"?(d.headers=new Headers({"Content-Type":a}),d.body=JSON.stringify(r.json)):a==="text/plain"?d.body=r.text:a==="application/x-www-form-urlencoded"&&r.formData?d.body=PM(r.formData):d.body=r.formData}return new Request(l,d)}function PM(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,typeof r=="string"?r:r.name);return t}function U6(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function Sse(e,t,n,r=!1,l=!1){let d={},p=null,a,b=!1,T={},E=n&&Pu(n[1])?n[1].error:void 0;return e.forEach(P=>{if(!(P.route.id in t))return;let I=P.route.id,R=t[I];if(Xi(!U0(R),"Cannot handle redirect results in processLoaderData"),Pu(R)){let F=R.error;if(E!==void 0&&(F=E,E=void 0),p=p||{},l)p[I]=F;else{let W=F0(e,I);p[W.route.id]==null&&(p[W.route.id]=F)}r||(d[I]=YU),b||(b=!0,a=ew(R.error)?R.error.status:500),R.headers&&(T[I]=R.headers)}else d[I]=R.data,R.statusCode&&R.statusCode!==200&&!b&&(a=R.statusCode),R.headers&&(T[I]=R.headers)}),E!==void 0&&n&&(p={[n[0]]:E},n[2]&&(d[n[2]]=void 0)),{loaderData:d,errors:p,statusCode:a||200,loaderHeaders:T}}function $6(e,t,n,r,l,d){let{loaderData:p,errors:a}=Sse(t,n,r);return l.filter(b=>!b.matches||b.matches.some(T=>T.shouldLoad)).forEach(b=>{let{key:T,match:E,controller:P}=b,I=d[T];if(Xi(I,"Did not find corresponding fetcher result"),!(P&&P.signal.aborted))if(Pu(I)){let R=F0(e.matches,E==null?void 0:E.route.id);a&&a[R.route.id]||(a={...a,[R.route.id]:I.error}),e.fetchers.delete(T)}else if(U0(I))Xi(!1,"Unhandled fetcher revalidation redirect");else{let R=Bg(I.data);e.fetchers.set(T,R)}}),{loaderData:p,errors:a}}function q6(e,t,n,r){let l=Object.entries(t).filter(([,d])=>d!==YU).reduce((d,[p,a])=>(d[p]=a,d),{});for(let d of n){let p=d.route.id;if(!t.hasOwnProperty(p)&&e.hasOwnProperty(p)&&d.route.loader&&(l[p]=e[p]),r&&r.hasOwnProperty(p))break}return l}function H6(e){return e?Pu(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function F0(e,t){return(t?e.slice(0,e.findIndex(r=>r.route.id===t)+1):[...e]).reverse().find(r=>r.route.hasErrorBoundary===!0)||e[0]}function G6(e){let t=e.length===1?e[0]:e.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function Dd(e,{pathname:t,routeId:n,method:r,type:l,message:d}={}){let p="Unknown Server Error",a="Unknown @remix-run/router error";return e===400?(p="Bad Request",r&&t&&n?a=`You made a ${r} request to "${t}" but did not provide a \`loader\` for route "${n}", so there is no way to handle the request.`:l==="invalid-body"&&(a="Unable to encode submission body")):e===403?(p="Forbidden",a=`Route "${n}" does not match URL "${t}"`):e===404?(p="Not Found",a=`No route matches URL "${t}"`):e===405&&(p="Method Not Allowed",r&&t&&n?a=`You made a ${r.toUpperCase()} request to "${t}" but did not provide an \`action\` for route "${n}", so there is no way to handle the request.`:r&&(a=`Invalid request method "${r.toUpperCase()}"`)),new kT(e||500,p,new Error(a),!0)}function vS(e){let t=Object.entries(e);for(let n=t.length-1;n>=0;n--){let[r,l]=t[n];if(U0(l))return{key:r,result:l}}}function r$(e){let t=typeof e=="string"?dx(e):e;return tx({...t,hash:""})}function Tse(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function Ese(e){return i$(e.result)&&cse.has(e.result.status)}function Pu(e){return e.type==="error"}function U0(e){return(e&&e.type)==="redirect"}function W6(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function i$(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function Ase(e){return lse.has(e.toUpperCase())}function Nu(e){return sse.has(e.toUpperCase())}function PP(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function _b(e,t){let n=typeof t=="string"?dx(t).search:t.search;if(e[e.length-1].route.index&&PP(n||""))return e[e.length-1];let r=ZU(e);return r[r.length-1]}function Z6(e){let{formMethod:t,formAction:n,formEncType:r,text:l,formData:d,json:p}=e;if(!(!t||!n||!r)){if(l!=null)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:l};if(d!=null)return{formMethod:t,formAction:n,formEncType:r,formData:d,json:void 0,text:void 0};if(p!==void 0)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:p,text:void 0}}}function RC(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function Cse(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function eb(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function jse(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function Bg(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function Mse(e,t){try{let n=e.sessionStorage.getItem(KU);if(n){let r=JSON.parse(n);for(let[l,d]of Object.entries(r||{}))d&&Array.isArray(d)&&t.set(l,new Set(d||[]))}}catch{}}function Pse(e,t){if(t.size>0){let n={};for(let[r,l]of t)n[r]=[...l];try{e.sessionStorage.setItem(KU,JSON.stringify(n))}catch(r){Ms(!1,`Failed to save applied view transitions in sessionStorage (${r}).`)}}}function Nse(){let e,t,n=new Promise((r,l)=>{e=async d=>{r(d);try{await n}catch{}},t=async d=>{l(d);try{await n}catch{}}});return{promise:n,resolve:e,reject:t}}var by=V.createContext(null);by.displayName="DataRouter";var Dw=V.createContext(null);Dw.displayName="DataRouterState";var NP=V.createContext({isTransitioning:!1});NP.displayName="ViewTransition";var a$=V.createContext(new Map);a$.displayName="Fetchers";var Dse=V.createContext(null);Dse.displayName="Await";var Jh=V.createContext(null);Jh.displayName="Navigation";var e3=V.createContext(null);e3.displayName="Location";var Vd=V.createContext({outlet:null,matches:[],isDataRoute:!1});Vd.displayName="Route";var DP=V.createContext(null);DP.displayName="RouteError";function Ose(e,{relative:t}={}){Xi(T_(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=V.useContext(Jh),{hash:l,pathname:d,search:p}=Ow(e,{relative:t}),a=d;return n!=="/"&&(a=d==="/"?n:Qf([n,d])),r.createHref({pathname:a,search:p,hash:l})}function T_(){return V.useContext(e3)!=null}function yl(){return Xi(T_(),"useLocation() may be used only in the context of a <Router> component."),V.useContext(e3).location}var s$="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function o$(e){V.useContext(Jh).static||V.useLayoutEffect(e)}function aa(){let{isDataRoute:e}=V.useContext(Vd);return e?Zse():Ise()}function Ise(){Xi(T_(),"useNavigate() may be used only in the context of a <Router> component.");let e=V.useContext(by),{basename:t,navigator:n}=V.useContext(Jh),{matches:r}=V.useContext(Vd),{pathname:l}=yl(),d=JSON.stringify(QE(r)),p=V.useRef(!1);return o$(()=>{p.current=!0}),V.useCallback((b,T={})=>{if(Ms(p.current,s$),!p.current)return;if(typeof b=="number"){n.go(b);return}let E=JE(b,JSON.parse(d),l,T.relative==="path");e==null&&t!=="/"&&(E.pathname=E.pathname==="/"?t:Qf([t,E.pathname])),(T.replace?n.replace:n.push)(E,T.state,T)},[t,n,d,l,e])}var kse=V.createContext(null);function Rse(e){let t=V.useContext(Vd).outlet;return t&&V.createElement(kse.Provider,{value:e},t)}function Ec(){let{matches:e}=V.useContext(Vd),t=e[e.length-1];return t?t.params:{}}function Ow(e,{relative:t}={}){let{matches:n}=V.useContext(Vd),{pathname:r}=yl(),l=JSON.stringify(QE(n));return V.useMemo(()=>JE(e,JSON.parse(l),r,t==="path"),[e,l,r,t])}function zse(e,t,n,r){Xi(T_(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l,static:d}=V.useContext(Jh),{matches:p}=V.useContext(Vd),a=p[p.length-1],b=a?a.params:{},T=a?a.pathname:"/",E=a?a.pathnameBase:"/",P=a&&a.route;{let ne=P&&P.path||"";l$(T,!P||ne.endsWith("*")||ne.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${T}" (under <Route path="${ne}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${ne}"> to <Route path="${ne==="/"?"*":`${ne}/*`}">.`)}let I=yl(),R;R=I;let F=R.pathname||"/",W=F;if(E!=="/"){let ne=E.replace(/^\//,"").split("/");W="/"+F.replace(/^\//,"").split("/").slice(ne.length).join("/")}let $=!d&&n&&n.matches&&n.matches.length>0?n.matches:Wg(e,{pathname:W});return Ms(P||$!=null,`No routes matched location "${R.pathname}${R.search}${R.hash}" `),Ms($==null||$[$.length-1].route.element!==void 0||$[$.length-1].route.Component!==void 0||$[$.length-1].route.lazy!==void 0,`Matched leaf route at location "${R.pathname}${R.search}${R.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),Use($&&$.map(ne=>Object.assign({},ne,{params:Object.assign({},b,ne.params),pathname:Qf([E,l.encodeLocation?l.encodeLocation(ne.pathname).pathname:ne.pathname]),pathnameBase:ne.pathnameBase==="/"?E:Qf([E,l.encodeLocation?l.encodeLocation(ne.pathnameBase).pathname:ne.pathnameBase])})),p,n,r)}function Lse(){let e=Wse(),t=ew(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:r},d={padding:"2px 4px",backgroundColor:r},p=null;return console.error("Error handled by React Router default ErrorBoundary:",e),p=V.createElement(V.Fragment,null,V.createElement("p",null,"💿 Hey developer 👋"),V.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",V.createElement("code",{style:d},"ErrorBoundary")," or"," ",V.createElement("code",{style:d},"errorElement")," prop on your route.")),V.createElement(V.Fragment,null,V.createElement("h2",null,"Unexpected Application Error!"),V.createElement("h3",{style:{fontStyle:"italic"}},t),n?V.createElement("pre",{style:l},n):null,p)}var Fse=V.createElement(Lse,null),Bse=class extends V.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?V.createElement(Vd.Provider,{value:this.props.routeContext},V.createElement(DP.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Vse({routeContext:e,match:t,children:n}){let r=V.useContext(by);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),V.createElement(Vd.Provider,{value:e},n)}function Use(e,t=[],n=null,r=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let l=e,d=n==null?void 0:n.errors;if(d!=null){let b=l.findIndex(T=>T.route.id&&(d==null?void 0:d[T.route.id])!==void 0);Xi(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),l=l.slice(0,Math.min(l.length,b+1))}let p=!1,a=-1;if(n)for(let b=0;b<l.length;b++){let T=l[b];if((T.route.HydrateFallback||T.route.hydrateFallbackElement)&&(a=b),T.route.id){let{loaderData:E,errors:P}=n,I=T.route.loader&&!E.hasOwnProperty(T.route.id)&&(!P||P[T.route.id]===void 0);if(T.route.lazy||I){p=!0,a>=0?l=l.slice(0,a+1):l=[l[0]];break}}}return l.reduceRight((b,T,E)=>{let P,I=!1,R=null,F=null;n&&(P=d&&T.route.id?d[T.route.id]:void 0,R=T.route.errorElement||Fse,p&&(a<0&&E===0?(l$("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),I=!0,F=null):a===E&&(I=!0,F=T.route.hydrateFallbackElement||null)));let W=t.concat(l.slice(0,E+1)),$=()=>{let Z;return P?Z=R:I?Z=F:T.route.Component?Z=V.createElement(T.route.Component,null):T.route.element?Z=T.route.element:Z=b,V.createElement(Vse,{match:T,routeContext:{outlet:b,matches:W,isDataRoute:n!=null},children:Z})};return n&&(T.route.ErrorBoundary||T.route.errorElement||E===0)?V.createElement(Bse,{location:n.location,revalidation:n.revalidation,component:R,error:P,children:$(),routeContext:{outlet:null,matches:W,isDataRoute:!0}}):$()},null)}function OP(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function $se(e){let t=V.useContext(by);return Xi(t,OP(e)),t}function qse(e){let t=V.useContext(Dw);return Xi(t,OP(e)),t}function Hse(e){let t=V.useContext(Vd);return Xi(t,OP(e)),t}function IP(e){let t=Hse(e),n=t.matches[t.matches.length-1];return Xi(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function Gse(){return IP("useRouteId")}function Wse(){var r;let e=V.useContext(DP),t=qse("useRouteError"),n=IP("useRouteError");return e!==void 0?e:(r=t.errors)==null?void 0:r[n]}function Zse(){let{router:e}=$se("useNavigate"),t=IP("useNavigate"),n=V.useRef(!1);return o$(()=>{n.current=!0}),V.useCallback(async(l,d={})=>{Ms(n.current,s$),n.current&&(typeof l=="number"?e.navigate(l):await e.navigate(l,{fromRouteId:t,...d}))},[e,t])}var X6={};function l$(e,t,n){!t&&!X6[e]&&(X6[e]=!0,Ms(!1,n))}var K6={};function Y6(e,t){!e&&!K6[t]&&(K6[t]=!0,console.warn(t))}function Xse(e){let t={hasErrorBoundary:e.hasErrorBoundary||e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&(e.element&&Ms(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(t,{element:V.createElement(e.Component),Component:void 0})),e.HydrateFallback&&(e.hydrateFallbackElement&&Ms(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(t,{hydrateFallbackElement:V.createElement(e.HydrateFallback),HydrateFallback:void 0})),e.ErrorBoundary&&(e.errorElement&&Ms(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(t,{errorElement:V.createElement(e.ErrorBoundary),ErrorBoundary:void 0})),t}var Kse=["HydrateFallback","hydrateFallbackElement"],Yse=class{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",t(n))}})}};function Qse({router:e,flushSync:t}){let[n,r]=V.useState(e.state),[l,d]=V.useState(),[p,a]=V.useState({isTransitioning:!1}),[b,T]=V.useState(),[E,P]=V.useState(),[I,R]=V.useState(),F=V.useRef(new Map),W=V.useCallback((ie,{deletedFetchers:ge,flushSync:ae,viewTransitionOpts:se})=>{ie.fetchers.forEach((ke,qe)=>{ke.data!==void 0&&F.current.set(qe,ke.data)}),ge.forEach(ke=>F.current.delete(ke)),Y6(ae===!1||t!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let me=e.window!=null&&e.window.document!=null&&typeof e.window.document.startViewTransition=="function";if(Y6(se==null||me,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!se||!me){t&&ae?t(()=>r(ie)):V.startTransition(()=>r(ie));return}if(t&&ae){t(()=>{E&&(b&&b.resolve(),E.skipTransition()),a({isTransitioning:!0,flushSync:!0,currentLocation:se.currentLocation,nextLocation:se.nextLocation})});let ke=e.window.document.startViewTransition(()=>{t(()=>r(ie))});ke.finished.finally(()=>{t(()=>{T(void 0),P(void 0),d(void 0),a({isTransitioning:!1})})}),t(()=>P(ke));return}E?(b&&b.resolve(),E.skipTransition(),R({state:ie,currentLocation:se.currentLocation,nextLocation:se.nextLocation})):(d(ie),a({isTransitioning:!0,flushSync:!1,currentLocation:se.currentLocation,nextLocation:se.nextLocation}))},[e.window,t,E,b]);V.useLayoutEffect(()=>e.subscribe(W),[e,W]),V.useEffect(()=>{p.isTransitioning&&!p.flushSync&&T(new Yse)},[p]),V.useEffect(()=>{if(b&&l&&e.window){let ie=l,ge=b.promise,ae=e.window.document.startViewTransition(async()=>{V.startTransition(()=>r(ie)),await ge});ae.finished.finally(()=>{T(void 0),P(void 0),d(void 0),a({isTransitioning:!1})}),P(ae)}},[l,b,e.window]),V.useEffect(()=>{b&&l&&n.location.key===l.location.key&&b.resolve()},[b,E,n.location,l]),V.useEffect(()=>{!p.isTransitioning&&I&&(d(I.state),a({isTransitioning:!0,flushSync:!1,currentLocation:I.currentLocation,nextLocation:I.nextLocation}),R(void 0))},[p.isTransitioning,I]);let $=V.useMemo(()=>({createHref:e.createHref,encodeLocation:e.encodeLocation,go:ie=>e.navigate(ie),push:(ie,ge,ae)=>e.navigate(ie,{state:ge,preventScrollReset:ae==null?void 0:ae.preventScrollReset}),replace:(ie,ge,ae)=>e.navigate(ie,{replace:!0,state:ge,preventScrollReset:ae==null?void 0:ae.preventScrollReset})}),[e]),Z=e.basename||"/",ne=V.useMemo(()=>({router:e,navigator:$,static:!1,basename:Z}),[e,$,Z]);return V.createElement(V.Fragment,null,V.createElement(by.Provider,{value:ne},V.createElement(Dw.Provider,{value:n},V.createElement(a$.Provider,{value:F.current},V.createElement(NP.Provider,{value:p},V.createElement(toe,{basename:Z,location:n.location,navigationType:n.historyAction,navigator:$},V.createElement(Jse,{routes:e.routes,future:e.future,state:n})))))),null)}var Jse=V.memo(eoe);function eoe({routes:e,future:t,state:n}){return zse(e,void 0,n,t)}function c_({to:e,replace:t,state:n,relative:r}){Xi(T_(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=V.useContext(Jh);Ms(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:d}=V.useContext(Vd),{pathname:p}=yl(),a=aa(),b=JE(e,QE(d),p,r==="path"),T=JSON.stringify(b);return V.useEffect(()=>{a(JSON.parse(T),{replace:t,state:n,relative:r})},[a,T,r,t,n]),null}function t3(e){return Rse(e.context)}function toe({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:l,static:d=!1}){Xi(!T_(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=e.replace(/^\/*/,"/"),a=V.useMemo(()=>({basename:p,navigator:l,static:d,future:{}}),[p,l,d]);typeof n=="string"&&(n=dx(n));let{pathname:b="/",search:T="",hash:E="",state:P=null,key:I="default"}=n,R=V.useMemo(()=>{let F=Fd(b,p);return F==null?null:{location:{pathname:F,search:T,hash:E,state:P,key:I},navigationType:r}},[p,b,T,E,P,I,r]);return Ms(R!=null,`<Router basename="${p}"> is not able to match the URL "${b}${T}${E}" because it does not start with the basename, so the <Router> won't render anything.`),R==null?null:V.createElement(Jh.Provider,{value:a},V.createElement(e3.Provider,{children:t,value:R}))}var oT="get",lT="application/x-www-form-urlencoded";function n3(e){return e!=null&&typeof e.tagName=="string"}function noe(e){return n3(e)&&e.tagName.toLowerCase()==="button"}function roe(e){return n3(e)&&e.tagName.toLowerCase()==="form"}function ioe(e){return n3(e)&&e.tagName.toLowerCase()==="input"}function aoe(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function soe(e,t){return e.button===0&&(!t||t==="_self")&&!aoe(e)}function NM(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(l=>[n,l]):[[n,r]])},[]))}function ooe(e,t){let n=NM(e);return t&&t.forEach((r,l)=>{n.has(l)||t.getAll(l).forEach(d=>{n.append(l,d)})}),n}var _S=null;function loe(){if(_S===null)try{new FormData(document.createElement("form"),0),_S=!1}catch{_S=!0}return _S}var coe=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function zC(e){return e!=null&&!coe.has(e)?(Ms(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${lT}"`),null):e}function uoe(e,t){let n,r,l,d,p;if(roe(e)){let a=e.getAttribute("action");r=a?Fd(a,t):null,n=e.getAttribute("method")||oT,l=zC(e.getAttribute("enctype"))||lT,d=new FormData(e)}else if(noe(e)||ioe(e)&&(e.type==="submit"||e.type==="image")){let a=e.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let b=e.getAttribute("formaction")||a.getAttribute("action");if(r=b?Fd(b,t):null,n=e.getAttribute("formmethod")||a.getAttribute("method")||oT,l=zC(e.getAttribute("formenctype"))||zC(a.getAttribute("enctype"))||lT,d=new FormData(a,e),!loe()){let{name:T,type:E,value:P}=e;if(E==="image"){let I=T?`${T}.`:"";d.append(`${I}x`,"0"),d.append(`${I}y`,"0")}else T&&d.append(T,P)}}else{if(n3(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=oT,r=null,l=lT,p=e}return d&&l==="text/plain"&&(p=d,d=void 0),{action:r,method:n.toLowerCase(),encType:l,formData:d,body:p}}function kP(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function doe(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function hoe(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function foe(e,t,n){let r=await Promise.all(e.map(async l=>{let d=t.routes[l.route.id];if(d){let p=await doe(d,n);return p.links?p.links():[]}return[]}));return xoe(r.flat(1).filter(hoe).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function Q6(e,t,n,r,l,d){let p=(b,T)=>n[T]?b.route.id!==n[T].route.id:!0,a=(b,T)=>{var E;return n[T].pathname!==b.pathname||((E=n[T].route.path)==null?void 0:E.endsWith("*"))&&n[T].params["*"]!==b.params["*"]};return d==="assets"?t.filter((b,T)=>p(b,T)||a(b,T)):d==="data"?t.filter((b,T)=>{var P;let E=r.routes[b.route.id];if(!E||!E.hasLoader)return!1;if(p(b,T)||a(b,T))return!0;if(b.route.shouldRevalidate){let I=b.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:((P=n[0])==null?void 0:P.params)||{},nextUrl:new URL(e,window.origin),nextParams:b.params,defaultShouldRevalidate:!0});if(typeof I=="boolean")return I}return!0}):[]}function poe(e,t,{includeHydrateFallback:n}={}){return moe(e.map(r=>{let l=t.routes[r.route.id];if(!l)return[];let d=[l.module];return l.clientActionModule&&(d=d.concat(l.clientActionModule)),l.clientLoaderModule&&(d=d.concat(l.clientLoaderModule)),n&&l.hydrateFallbackModule&&(d=d.concat(l.hydrateFallbackModule)),l.imports&&(d=d.concat(l.imports)),d}).flat(1))}function moe(e){return[...new Set(e)]}function goe(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function xoe(e,t){let n=new Set;return new Set(t),e.reduce((r,l)=>{let d=JSON.stringify(goe(l));return n.has(d)||(n.add(d),r.push({key:d,link:l})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var yoe=new Set([100,101,204,205]);function voe(e,t){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname="_root.data":t&&Fd(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function c$(){let e=V.useContext(by);return kP(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function _oe(){let e=V.useContext(Dw);return kP(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var RP=V.createContext(void 0);RP.displayName="FrameworkContext";function u$(){let e=V.useContext(RP);return kP(e,"You must render this element inside a <HydratedRouter> element"),e}function boe(e,t){let n=V.useContext(RP),[r,l]=V.useState(!1),[d,p]=V.useState(!1),{onFocus:a,onBlur:b,onMouseEnter:T,onMouseLeave:E,onTouchStart:P}=t,I=V.useRef(null);V.useEffect(()=>{if(e==="render"&&p(!0),e==="viewport"){let W=Z=>{Z.forEach(ne=>{p(ne.isIntersecting)})},$=new IntersectionObserver(W,{threshold:.5});return I.current&&$.observe(I.current),()=>{$.disconnect()}}},[e]),V.useEffect(()=>{if(r){let W=setTimeout(()=>{p(!0)},100);return()=>{clearTimeout(W)}}},[r]);let R=()=>{l(!0)},F=()=>{l(!1),p(!1)};return n?e!=="intent"?[d,I,{}]:[d,I,{onFocus:tb(a,R),onBlur:tb(b,F),onMouseEnter:tb(T,R),onMouseLeave:tb(E,F),onTouchStart:tb(P,R)}]:[!1,I,{}]}function tb(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function woe({page:e,...t}){let{router:n}=c$(),r=V.useMemo(()=>Wg(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?V.createElement(Toe,{page:e,matches:r,...t}):null}function Soe(e){let{manifest:t,routeModules:n}=u$(),[r,l]=V.useState([]);return V.useEffect(()=>{let d=!1;return foe(e,t,n).then(p=>{d||l(p)}),()=>{d=!0}},[e,t,n]),r}function Toe({page:e,matches:t,...n}){let r=yl(),{manifest:l,routeModules:d}=u$(),{basename:p}=c$(),{loaderData:a,matches:b}=_oe(),T=V.useMemo(()=>Q6(e,t,b,l,r,"data"),[e,t,b,l,r]),E=V.useMemo(()=>Q6(e,t,b,l,r,"assets"),[e,t,b,l,r]),P=V.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let F=new Set,W=!1;if(t.forEach(Z=>{var ie;let ne=l.routes[Z.route.id];!ne||!ne.hasLoader||(!T.some(ge=>ge.route.id===Z.route.id)&&Z.route.id in a&&((ie=d[Z.route.id])!=null&&ie.shouldRevalidate)||ne.hasClientLoader?W=!0:F.add(Z.route.id))}),F.size===0)return[];let $=voe(e,p);return W&&F.size>0&&$.searchParams.set("_routes",t.filter(Z=>F.has(Z.route.id)).map(Z=>Z.route.id).join(",")),[$.pathname+$.search]},[p,a,r,l,T,t,e,d]),I=V.useMemo(()=>poe(E,l),[E,l]),R=Soe(E);return V.createElement(V.Fragment,null,P.map(F=>V.createElement("link",{key:F,rel:"prefetch",as:"fetch",href:F,...n})),I.map(F=>V.createElement("link",{key:F,rel:"modulepreload",href:F,...n})),R.map(({key:F,link:W})=>V.createElement("link",{key:F,...W})))}function Eoe(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var d$=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{d$&&(window.__reactRouterVersion="7.6.0")}catch{}function Aoe(e,t){return fse({basename:t==null?void 0:t.basename,unstable_getContext:t==null?void 0:t.unstable_getContext,future:t==null?void 0:t.future,history:Iae({window:t==null?void 0:t.window}),hydrationData:Coe(),routes:e,mapRouteProperties:Xse,hydrationRouteProperties:Kse,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function Coe(){let e=window==null?void 0:window.__staticRouterHydrationData;return e&&e.errors&&(e={...e,errors:joe(e.errors)}),e}function joe(e){if(!e)return null;let t=Object.entries(e),n={};for(let[r,l]of t)if(l&&l.__type==="RouteErrorResponse")n[r]=new kT(l.status,l.statusText,l.data,l.internal===!0);else if(l&&l.__type==="Error"){if(l.__subType){let d=window[l.__subType];if(typeof d=="function")try{let p=new d(l.message);p.stack="",n[r]=p}catch{}}if(n[r]==null){let d=new Error(l.message);d.stack="",n[r]=d}}else n[r]=l;return n}var h$=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Wn=V.forwardRef(function({onClick:t,discover:n="render",prefetch:r="none",relative:l,reloadDocument:d,replace:p,state:a,target:b,to:T,preventScrollReset:E,viewTransition:P,...I},R){let{basename:F}=V.useContext(Jh),W=typeof T=="string"&&h$.test(T),$,Z=!1;if(typeof T=="string"&&W&&($=T,d$))try{let qe=new URL(window.location.href),tt=T.startsWith("//")?new URL(qe.protocol+T):new URL(T),nt=Fd(tt.pathname,F);tt.origin===qe.origin&&nt!=null?T=nt+tt.search+tt.hash:Z=!0}catch{Ms(!1,`<Link to="${T}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let ne=Ose(T,{relative:l}),[ie,ge,ae]=boe(r,I),se=Noe(T,{replace:p,state:a,target:b,preventScrollReset:E,relative:l,viewTransition:P});function me(qe){t&&t(qe),qe.defaultPrevented||se(qe)}let ke=V.createElement("a",{...I,...ae,href:$||ne,onClick:Z||d?t:me,ref:Eoe(R,ge),target:b,"data-discover":!W&&n==="render"?"true":void 0});return ie&&!W?V.createElement(V.Fragment,null,ke,V.createElement(woe,{page:ne})):ke});Wn.displayName="Link";var Ib=V.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:r="",end:l=!1,style:d,to:p,viewTransition:a,children:b,...T},E){let P=Ow(p,{relative:T.relative}),I=yl(),R=V.useContext(Dw),{navigator:F,basename:W}=V.useContext(Jh),$=R!=null&&Roe(P)&&a===!0,Z=F.encodeLocation?F.encodeLocation(P).pathname:P.pathname,ne=I.pathname,ie=R&&R.navigation&&R.navigation.location?R.navigation.location.pathname:null;n||(ne=ne.toLowerCase(),ie=ie?ie.toLowerCase():null,Z=Z.toLowerCase()),ie&&W&&(ie=Fd(ie,W)||ie);const ge=Z!=="/"&&Z.endsWith("/")?Z.length-1:Z.length;let ae=ne===Z||!l&&ne.startsWith(Z)&&ne.charAt(ge)==="/",se=ie!=null&&(ie===Z||!l&&ie.startsWith(Z)&&ie.charAt(Z.length)==="/"),me={isActive:ae,isPending:se,isTransitioning:$},ke=ae?t:void 0,qe;typeof r=="function"?qe=r(me):qe=[r,ae?"active":null,se?"pending":null,$?"transitioning":null].filter(Boolean).join(" ");let tt=typeof d=="function"?d(me):d;return V.createElement(Wn,{...T,"aria-current":ke,className:qe,ref:E,style:tt,to:p,viewTransition:a},typeof b=="function"?b(me):b)});Ib.displayName="NavLink";var Moe=V.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:l,state:d,method:p=oT,action:a,onSubmit:b,relative:T,preventScrollReset:E,viewTransition:P,...I},R)=>{let F=Ioe(),W=koe(a,{relative:T}),$=p.toLowerCase()==="get"?"get":"post",Z=typeof a=="string"&&h$.test(a),ne=ie=>{if(b&&b(ie),ie.defaultPrevented)return;ie.preventDefault();let ge=ie.nativeEvent.submitter,ae=(ge==null?void 0:ge.getAttribute("formmethod"))||p;F(ge||ie.currentTarget,{fetcherKey:t,method:ae,navigate:n,replace:l,state:d,relative:T,preventScrollReset:E,viewTransition:P})};return V.createElement("form",{ref:R,method:$,action:W,onSubmit:r?b:ne,...I,"data-discover":!Z&&e==="render"?"true":void 0})});Moe.displayName="Form";function Poe(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function f$(e){let t=V.useContext(by);return Xi(t,Poe(e)),t}function Noe(e,{target:t,replace:n,state:r,preventScrollReset:l,relative:d,viewTransition:p}={}){let a=aa(),b=yl(),T=Ow(e,{relative:d});return V.useCallback(E=>{if(soe(E,t)){E.preventDefault();let P=n!==void 0?n:tx(b)===tx(T);a(e,{replace:P,state:r,preventScrollReset:l,relative:d,viewTransition:p})}},[b,a,T,n,r,t,e,l,d,p])}function p$(e){Ms(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=V.useRef(NM(e)),n=V.useRef(!1),r=yl(),l=V.useMemo(()=>ooe(r.search,n.current?null:t.current),[r.search]),d=aa(),p=V.useCallback((a,b)=>{const T=NM(typeof a=="function"?a(l):a);n.current=!0,d("?"+T,b)},[d,l]);return[l,p]}var Doe=0,Ooe=()=>`__${String(++Doe)}__`;function Ioe(){let{router:e}=f$("useSubmit"),{basename:t}=V.useContext(Jh),n=Gse();return V.useCallback(async(r,l={})=>{let{action:d,method:p,encType:a,formData:b,body:T}=uoe(r,t);if(l.navigate===!1){let E=l.fetcherKey||Ooe();await e.fetch(E,n,l.action||d,{preventScrollReset:l.preventScrollReset,formData:b,body:T,formMethod:l.method||p,formEncType:l.encType||a,flushSync:l.flushSync})}else await e.navigate(l.action||d,{preventScrollReset:l.preventScrollReset,formData:b,body:T,formMethod:l.method||p,formEncType:l.encType||a,replace:l.replace,state:l.state,fromRouteId:n,flushSync:l.flushSync,viewTransition:l.viewTransition})},[e,t,n])}function koe(e,{relative:t}={}){let{basename:n}=V.useContext(Jh),r=V.useContext(Vd);Xi(r,"useFormAction must be used inside a RouteContext");let[l]=r.matches.slice(-1),d={...Ow(e||".",{relative:t})},p=yl();if(e==null){d.search=p.search;let a=new URLSearchParams(d.search),b=a.getAll("index");if(b.some(E=>E==="")){a.delete("index"),b.filter(P=>P).forEach(P=>a.append("index",P));let E=a.toString();d.search=E?`?${E}`:""}}return(!e||e===".")&&l.route.index&&(d.search=d.search?d.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(d.pathname=d.pathname==="/"?n:Qf([n,d.pathname])),tx(d)}function Roe(e,t={}){let n=V.useContext(NP);Xi(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=f$("useViewTransitionState"),l=Ow(e,{relative:t.relative});if(!n.isTransitioning)return!1;let d=Fd(n.currentLocation.pathname,r)||n.currentLocation.pathname,p=Fd(n.nextLocation.pathname,r)||n.nextLocation.pathname;return IT(l.pathname,p)!=null||IT(l.pathname,d)!=null}[...yoe];var r3=lV();/**
 * react-router v7.6.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zoe(e){return V.createElement(Qse,{flushSync:r3.flushSync,...e})}const DM="/assets/spin1-Dr_dhiAJ.svg",OM="/assets/spin2-CxUhHCO7.svg",IM="/assets/spin3-Bt6LhQiE.svg",kM="/assets/spin4-DyayBApX.svg",RM="/assets/spin5-B8sCvNCo.svg",J6=[DM,OM,IM,kM,RM];function wy({className:e=""}){const[t,n]=V.useState(0);return V.useEffect(()=>{const r=setInterval(()=>{n(l=>(l+1)%J6.length)},300);return()=>clearInterval(r)},[]),f.jsx("div",{className:`flex items-center justify-center ${e}`,children:f.jsx("img",{src:J6[t],alt:"...",className:"w-24 h-24 animate-pulse"})})}function Loe({children:e}){const t=br(),[n,r]=V.useState(!0);return V.useEffect(()=>{let l=!0;return(async()=>{try{await t(Ab())}finally{l&&r(!1)}})(),()=>{l=!1}},[t]),n?f.jsx("div",{className:"w-full min-h-screen grid place-items-center bg-white",children:f.jsx(wy,{})}):f.jsx(f.Fragment,{children:e})}const Foe=e=>e.auth.usuario,zP=e=>e.auth.loading,m$=e=>!!e.auth.usuario;function LC({children:e}){const t=ln(zP),n=ln(m$);return t?null:n?f.jsx(c_,{to:"/dashboard/perfil",replace:!0}):e}const Boe=Nw("App",{web:()=>SP(()=>import("./web-MJONx66k.js"),[]).then(e=>new e.AppWeb)}),i3=Nw("Browser",{web:()=>SP(()=>import("./web-C7pyFBCU.js"),[]).then(e=>new e.BrowserWeb)});function Voe(e){Boe.addListener("appUrlOpen",async({url:t})=>{var n;try{if(!t)return;const r=new URL(t),l=(n=r.hash)!=null&&n.startsWith("#")?r.hash.slice(1):"",d=new URLSearchParams(l),p=d.get("token"),a=d.get("returnTo")||"/";if(p){await TP(p);try{await i3.close()}catch{}e(a)}}catch(r){console.error("Deep link parse error:",r)}})}function Uoe(){const e=aa();return V.useEffect(()=>{_y&&Voe(e)},[e]),null}function $oe(){const e=br();return V.useEffect(()=>{e(Ab())},[e]),null}var g$={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ez=$s.createContext&&$s.createContext(g$),qoe=["attr","size","title"];function Hoe(e,t){if(e==null)return{};var n=Goe(e,t),r,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(l=0;l<d.length;l++)r=d[l],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Goe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function zT(){return zT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zT.apply(this,arguments)}function tz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function LT(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?tz(Object(n),!0).forEach(function(r){Woe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tz(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Woe(e,t,n){return t=Zoe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zoe(e){var t=Xoe(e,"string");return typeof t=="symbol"?t:t+""}function Xoe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function x$(e){return e&&e.map((t,n)=>$s.createElement(t.tag,LT({key:n},t.attr),x$(t.child)))}function sn(e){return t=>$s.createElement(Koe,zT({attr:LT({},e.attr)},t),x$(e.child))}function Koe(e){var t=n=>{var{attr:r,size:l,title:d}=e,p=Hoe(e,qoe),a=l||n.size||"1em",b;return n.className&&(b=n.className),e.className&&(b=(b?b+" ":"")+e.className),$s.createElement("svg",zT({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,p,{className:b,style:LT(LT({color:e.color||n.color},n.style),e.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),d&&$s.createElement("title",null,d),e.children)};return ez!==void 0?$s.createElement(ez.Consumer,null,n=>t(n)):t(g$)}function Yoe(e){return sn({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M923 283.6a260.04 260.04 0 0 0-56.9-82.8 264.4 264.4 0 0 0-84-55.5A265.34 265.34 0 0 0 679.7 125c-49.3 0-97.4 13.5-139.2 39-10 6.1-19.5 12.8-28.5 20.1-9-7.3-18.5-14-28.5-20.1-41.8-25.5-89.9-39-139.2-39-35.5 0-69.9 6.8-102.4 20.3-31.4 13-59.7 31.7-84 55.5a258.44 258.44 0 0 0-56.9 82.8c-13.9 32.3-21 66.6-21 101.9 0 33.3 6.8 68 20.3 103.3 11.3 29.5 27.5 60.1 48.2 91 32.8 48.9 77.9 99.9 133.9 151.6 92.8 85.7 184.7 144.9 188.6 147.3l23.7 15.2c10.5 6.7 24 6.7 34.5 0l23.7-15.2c3.9-2.5 95.7-61.6 188.6-147.3 56-51.7 101.1-102.7 133.9-151.6 20.7-30.9 37-61.5 48.2-91 13.5-35.3 20.3-70 20.3-103.3.1-35.3-7-69.6-20.9-101.9z"},child:[]}]})(e)}function Qoe(e){return sn({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0 0 51.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"},child:[]},{tag:"path",attr:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"},child:[]}]})(e)}function Joe(e){return sn({attr:{viewBox:"0 0 1024 1024",fill:"currentColor",fillRule:"evenodd"},child:[{tag:"path",attr:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64Zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372Zm128.013 198.826c.023.007.042.018.083.059l45.02 45.019c.04.04.05.06.058.083a.118.118 0 0 1 0 .07c-.007.022-.018.041-.059.082L557.254 512l127.861 127.862a.268.268 0 0 1 .05.06l.009.023a.118.118 0 0 1 0 .07c-.007.022-.018.041-.059.082l-45.019 45.02c-.04.04-.06.05-.083.058a.118.118 0 0 1-.07 0c-.022-.007-.041-.018-.082-.059L512 557.254 384.14 685.115c-.042.041-.06.052-.084.059a.118.118 0 0 1-.07 0c-.022-.007-.041-.018-.082-.059l-45.02-45.019c-.04-.04-.05-.06-.058-.083a.118.118 0 0 1 0-.07c.007-.022.018-.041.059-.082L466.745 512l-127.86-127.86a.268.268 0 0 1-.05-.061l-.009-.023a.118.118 0 0 1 0-.07c.007-.022.018-.041.059-.082l45.019-45.02c.04-.04.06-.05.083-.058a.118.118 0 0 1 .07 0c.022.007.041.018.082.059L512 466.745l127.862-127.86c.04-.041.06-.052.083-.059a.118.118 0 0 1 .07 0Z"},child:[]}]})(e)}function ele(e){return sn({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M923 283.6a260.04 260.04 0 0 0-56.9-82.8 264.4 264.4 0 0 0-84-55.5A265.34 265.34 0 0 0 679.7 125c-49.3 0-97.4 13.5-139.2 39-10 6.1-19.5 12.8-28.5 20.1-9-7.3-18.5-14-28.5-20.1-41.8-25.5-89.9-39-139.2-39-35.5 0-69.9 6.8-102.4 20.3-31.4 13-59.7 31.7-84 55.5a258.44 258.44 0 0 0-56.9 82.8c-13.9 32.3-21 66.6-21 101.9 0 33.3 6.8 68 20.3 103.3 11.3 29.5 27.5 60.1 48.2 91 32.8 48.9 77.9 99.9 133.9 151.6 92.8 85.7 184.7 144.9 188.6 147.3l23.7 15.2c10.5 6.7 24 6.7 34.5 0l23.7-15.2c3.9-2.5 95.7-61.6 188.6-147.3 56-51.7 101.1-102.7 133.9-151.6 20.7-30.9 37-61.5 48.2-91 13.5-35.3 20.3-70 20.3-103.3.1-35.3-7-69.6-20.9-101.9zM512 814.8S156 586.7 156 385.5C156 283.6 240.3 201 344.3 201c73.1 0 136.5 40.8 167.7 100.4C543.2 241.8 606.6 201 679.7 201c104 0 188.3 82.6 188.3 184.5 0 201.2-356 429.3-356 429.3z"},child:[]}]})(e)}function tle(e){return sn({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M512 1024c-69.1 0-136.2-13.5-199.3-40.2C251.7 958 197 921 150 874c-47-47-84-101.7-109.8-162.7C13.5 648.2 0 581.1 0 512c0-19.9 16.1-36 36-36s36 16.1 36 36c0 59.4 11.6 117 34.6 171.3 22.2 52.4 53.9 99.5 94.3 139.9 40.4 40.4 87.5 72.2 139.9 94.3C395 940.4 452.6 952 512 952c59.4 0 117-11.6 171.3-34.6 52.4-22.2 99.5-53.9 139.9-94.3 40.4-40.4 72.2-87.5 94.3-139.9C940.4 629 952 571.4 952 512c0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 0 0-94.3-139.9 437.71 437.71 0 0 0-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.2C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3s-13.5 136.2-40.2 199.3C958 772.3 921 827 874 874c-47 47-101.8 83.9-162.7 109.7-63.1 26.8-130.2 40.3-199.3 40.3z"},child:[]}]})(e)}function nle(){const e=br(),{visible:t,message:n,type:r}=ln(a=>a.feedback),l=V.useRef(null);if(V.useEffect(()=>{if(!(!t||r==="loading"))return l.current=setTimeout(()=>{e(Rre())},3e3),()=>clearTimeout(l.current)},[t,r,e]),!t)return null;const d={success:"bg-green-500 text-white",error:"bg-red-500 text-white",loading:"bg-sky-500 text-white"},p={success:f.jsx(Qoe,{className:"text-white  text-lg"}),error:f.jsx(Joe,{className:"text-white  text-lg"}),loading:f.jsx(tle,{className:"animate-spin text-white  text-lg"})};return f.jsx("div",{className:"fixed bottom-5 right-5 z-[999] flex items-end justify-end",children:f.jsxs("div",{className:`rounded-xl px-5 py-4  text-xs font-semibold flex items-center gap-3 
          shadow-2xl shadow-black/30 animate-slide-in-up
          ${d[r]}
        `,children:[p[r],f.jsx("span",{children:n})]})})}function rle(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"22 12 18 12 15 21 9 3 6 12 2 12"},child:[]}]})(e)}function ile(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"20",x2:"12",y2:"10"},child:[]},{tag:"line",attr:{x1:"18",y1:"20",x2:"18",y2:"4"},child:[]},{tag:"line",attr:{x1:"6",y1:"20",x2:"6",y2:"16"},child:[]}]})(e)}function ale(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"},child:[]},{tag:"path",attr:{d:"M13.73 21a2 2 0 0 1-3.46 0"},child:[]}]})(e)}function sle(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"16",y1:"2",x2:"16",y2:"6"},child:[]},{tag:"line",attr:{x1:"8",y1:"2",x2:"8",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"10",x2:"21",y2:"10"},child:[]}]})(e)}function ole(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"},child:[]},{tag:"polyline",attr:{points:"22 4 12 14.01 9 11.01"},child:[]}]})(e)}function lle(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"6 9 12 15 18 9"},child:[]}]})(e)}function nz(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 18 9 12 15 6"},child:[]}]})(e)}function kb(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 18 15 12 9 6"},child:[]}]})(e)}function LP(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"18 15 12 9 6 15"},child:[]}]})(e)}function FP(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"},child:[]}]})(e)}function rz(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"},child:[]}]})(e)}function cle(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"10",r:"3"},child:[]}]})(e)}function ule(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"3",y1:"12",x2:"21",y2:"12"},child:[]},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"18",x2:"21",y2:"18"},child:[]}]})(e)}function y$(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"},child:[]}]})(e)}function dle(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21.21 15.89A10 10 0 1 1 8 2.83"},child:[]},{tag:"path",attr:{d:"M22 12A10 10 0 0 0 12 2v10z"},child:[]}]})(e)}function hle(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"},child:[]},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"},child:[]}]})(e)}function fle(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"},child:[]},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"},child:[]},{tag:"path",attr:{d:"M16 10a4 4 0 0 1-8 0"},child:[]}]})(e)}function BP(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"3 6 5 6 21 6"},child:[]},{tag:"path",attr:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"},child:[]},{tag:"line",attr:{x1:"10",y1:"11",x2:"10",y2:"17"},child:[]},{tag:"line",attr:{x1:"14",y1:"11",x2:"14",y2:"17"},child:[]}]})(e)}function ple(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 6 13.5 15.5 8.5 10.5 1 18"},child:[]},{tag:"polyline",attr:{points:"17 6 23 6 23 12"},child:[]}]})(e)}function mle(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(e)}function v$(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M23 21v-2a4 4 0 0 0-3-3.87"},child:[]},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"},child:[]}]})(e)}function gle(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(e)}function VP(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"},child:[]}]})(e)}function Iw(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"},child:[]}]})(e)}function FT(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"},child:[]}]})(e)}function _$(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"},child:[]}]})(e)}function xle(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 19H5V5h7V3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"},child:[]}]})(e)}function yle(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"},child:[]}]})(e)}function BT(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M20 4H4v2h16V4zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6h1zm-9 4H6v-4h6v4z"},child:[]}]})(e)}function vle(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM9.5 16.5v-9l7 4.5-7 4.5z"},child:[]}]})(e)}function _le(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"},child:[]}]})(e)}function ble(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"},child:[]}]})(e)}function wle(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"},child:[]}]})(e)}function Sle(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"},child:[]}]})(e)}function Tle(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"},child:[]}]})(e)}function b$(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"},child:[]},{tag:"path",attr:{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},child:[]}]})(e)}function Ele(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M12 5V2L8 6l4 4V7c3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93 0-4.42-3.58-8-8-8zM6 13c0-1.65.67-3.15 1.76-4.24L6.34 7.34A8.014 8.014 0 0 0 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91z"},child:[]}]})(e)}function a3(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"},child:[]}]})(e)}function Ale(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"},child:[]}]})(e)}function Cle(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M15 17h2v-3h1v-2l-1-5H2l-1 5v2h1v6h9v-6h4v3zm-6 1H4v-4h5v4zM2 4h15v2H2z"},child:[]},{tag:"path",attr:{d:"M20 18v-3h-2v3h-3v2h3v3h2v-3h3v-2z"},child:[]}]})(e)}function w$(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m12 2-5.5 9h11z"},child:[]},{tag:"circle",attr:{cx:"17.5",cy:"17.5",r:"4.5"},child:[]},{tag:"path",attr:{d:"M3 13.5h8v8H3z"},child:[]}]})(e)}function hy(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m21.41 11.58-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58.55 0 1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.55-.23-1.06-.59-1.42zM5.5 7C4.67 7 4 6.33 4 5.5S4.67 4 5.5 4 7 4.67 7 5.5 6.33 7 5.5 7z"},child:[]}]})(e)}function iz(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"m10 17 5-5-5-5v10z"},child:[]},{tag:"path",attr:{fill:"none",d:"M0 24V0h24v24H0z"},child:[]}]})(e)}function jle(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"},child:[]}]})(e)}function VT(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 12.75c1.63 0 3.07.39 4.24.9 1.08.48 1.76 1.56 1.76 2.73V18H6v-1.61c0-1.18.68-2.26 1.76-2.73 1.17-.52 2.61-.91 4.24-.91zM4 13c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm1.13 1.1c-.37-.06-.74-.1-1.13-.1-.99 0-1.93.21-2.78.58A2.01 2.01 0 0 0 0 16.43V18h4.5v-1.61c0-.83.23-1.61.63-2.29zM20 13c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm4 3.43c0-.81-.48-1.53-1.22-1.85A6.95 6.95 0 0 0 20 14c-.39 0-.76.04-1.13.1.4.68.63 1.46.63 2.29V18H24v-1.57zM12 6c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"},child:[]}]})(e)}function S$(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"},child:[]}]})(e)}function UP(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"},child:[]}]})(e)}function Mle(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m22 9.24-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"},child:[]}]})(e)}function Ple(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"},child:[]}]})(e)}function T$(e){return sn({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M11.71 17.99A5.993 5.993 0 0 1 6 12c0-3.31 2.69-6 6-6 3.22 0 5.84 2.53 5.99 5.71l-2.1-.63a3.999 3.999 0 1 0-4.81 4.81l.63 2.1zM22 12c0 .3-.01.6-.04.9l-1.97-.59c.01-.1.01-.21.01-.31 0-4.42-3.58-8-8-8s-8 3.58-8 8 3.58 8 8 8c.1 0 .21 0 .31-.01l.59 1.97c-.3.03-.6.04-.9.04-5.52 0-10-4.48-10-10S6.48 2 12 2s10 4.48 10 10zm-3.77 4.26L22 15l-10-3 3 10 1.26-3.77 4.27 4.27 1.98-1.98-4.28-4.26z"},child:[]}]})(e)}const s3="/assets/logo_icono-B8EfLitt.svg",Nle="/assets/logo_negro-CzpicBu0.svg",Rm="/assets/icono-BU47RJ2L.svg";var bS={},az;function Dle(){if(az)return bS;az=1,bS.match=d,bS.parse=p;var e=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,t=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,n=/^(?:(min|max)-)?(.+)/,r=/(em|rem|px|cm|mm|in|pt|pc)?$/,l=/(dpi|dpcm|dppx)?$/;function d(E,P){return p(E).some(function(I){var R=I.inverse,F=I.type==="all"||P.type===I.type;if(F&&R||!(F||R))return!1;var W=I.expressions.every(function($){var Z=$.feature,ne=$.modifier,ie=$.value,ge=P[Z];if(!ge)return!1;switch(Z){case"orientation":case"scan":return ge.toLowerCase()===ie.toLowerCase();case"width":case"height":case"device-width":case"device-height":ie=T(ie),ge=T(ge);break;case"resolution":ie=b(ie),ge=b(ge);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":ie=a(ie),ge=a(ge);break;case"grid":case"color":case"color-index":case"monochrome":ie=parseInt(ie,10)||1,ge=parseInt(ge,10)||0;break}switch(ne){case"min":return ge>=ie;case"max":return ge<=ie;default:return ge===ie}});return W&&!R||!W&&R})}function p(E){return E.split(",").map(function(P){P=P.trim();var I=P.match(e),R=I[1],F=I[2],W=I[3]||"",$={};return $.inverse=!!R&&R.toLowerCase()==="not",$.type=F?F.toLowerCase():"all",W=W.match(/\([^\)]+\)/g)||[],$.expressions=W.map(function(Z){var ne=Z.match(t),ie=ne[1].toLowerCase().match(n);return{modifier:ie[1],feature:ie[2],value:ne[2]}}),$})}function a(E){var P=Number(E),I;return P||(I=E.match(/^(\d+)\s*\/\s*(\d+)$/),P=I[1]/I[2]),P}function b(E){var P=parseFloat(E),I=String(E).match(l)[1];switch(I){case"dpcm":return P/2.54;case"dppx":return P*96;default:return P}}function T(E){var P=parseFloat(E),I=String(E).match(r)[1];switch(I){case"em":return P*16;case"rem":return P*16;case"cm":return P*96/2.54;case"mm":return P*96/2.54/10;case"in":return P*96;case"pt":return P*72;case"pc":return P*72/12;default:return P}}return bS}var FC,sz;function Ole(){if(sz)return FC;sz=1;var e=Dle().match,t=typeof window<"u"?window.matchMedia:null;function n(l,d,p){var a=this,b;t&&!p&&(b=t.call(window,l)),b?(this.matches=b.matches,this.media=b.media,b.addListener(P)):(this.matches=e(l,d),this.media=l),this.addListener=T,this.removeListener=E,this.dispose=I;function T(R){b&&b.addListener(R)}function E(R){b&&b.removeListener(R)}function P(R){a.matches=R.matches,a.media=R.media}function I(){b&&b.removeListener(P)}}function r(l,d,p){return new n(l,d,p)}return FC=r,FC}var Ile=Ole();const kle=Gs(Ile);var Rle=/[A-Z]/g,zle=/^ms-/,BC={};function Lle(e){return"-"+e.toLowerCase()}function E$(e){if(BC.hasOwnProperty(e))return BC[e];var t=e.replace(Rle,Lle);return BC[e]=zle.test(t)?"-"+t:t}function Fle(e,t){if(e===t)return!0;if(!e||!t)return!1;const n=Object.keys(e),r=Object.keys(t),l=n.length;if(r.length!==l)return!1;for(let d=0;d<l;d++){const p=n[d];if(e[p]!==t[p]||!Object.prototype.hasOwnProperty.call(t,p))return!1}return!0}var VC={exports:{}},UC,oz;function Ble(){if(oz)return UC;oz=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return UC=e,UC}var $C,lz;function Vle(){if(lz)return $C;lz=1;var e=Ble();function t(){}function n(){}return n.resetWarningCache=t,$C=function(){function r(p,a,b,T,E,P){if(P!==e){var I=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw I.name="Invariant Violation",I}}r.isRequired=r;function l(){return r}var d={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:l,element:r,elementType:r,instanceOf:l,node:r,objectOf:l,oneOf:l,oneOfType:l,shape:l,exact:l,checkPropTypes:n,resetWarningCache:t};return d.PropTypes=d,d},$C}var cz;function Ule(){return cz||(cz=1,VC.exports=Vle()()),VC.exports}var $le=Ule();const zr=Gs($le),vc=zr.oneOfType([zr.string,zr.number]),A$={all:zr.bool,grid:zr.bool,aural:zr.bool,braille:zr.bool,handheld:zr.bool,print:zr.bool,projection:zr.bool,screen:zr.bool,tty:zr.bool,tv:zr.bool,embossed:zr.bool},qle={orientation:zr.oneOf(["portrait","landscape"]),scan:zr.oneOf(["progressive","interlace"]),aspectRatio:zr.string,deviceAspectRatio:zr.string,height:vc,deviceHeight:vc,width:vc,deviceWidth:vc,color:zr.bool,colorIndex:zr.bool,monochrome:zr.bool,resolution:vc,type:Object.keys(A$)},{type:U6e,...Hle}=qle,Gle={minAspectRatio:zr.string,maxAspectRatio:zr.string,minDeviceAspectRatio:zr.string,maxDeviceAspectRatio:zr.string,minHeight:vc,maxHeight:vc,minDeviceHeight:vc,maxDeviceHeight:vc,minWidth:vc,maxWidth:vc,minDeviceWidth:vc,maxDeviceWidth:vc,minColor:zr.number,maxColor:zr.number,minColorIndex:zr.number,maxColorIndex:zr.number,minMonochrome:zr.number,maxMonochrome:zr.number,minResolution:vc,maxResolution:vc,...Hle},Wle={...A$,...Gle};var Zle={all:Wle};const Xle=e=>`not ${e}`,Kle=(e,t)=>{const n=E$(e);return typeof t=="number"&&(t=`${t}px`),t===!0?n:t===!1?Xle(n):`(${n}: ${t})`},Yle=e=>e.join(" and "),Qle=e=>{const t=[];return Object.keys(Zle.all).forEach(n=>{const r=e[n];r!=null&&t.push(Kle(n,r))}),Yle(t)},Jle=V.createContext(void 0),ece=e=>e.query||Qle(e),uz=e=>e?Object.keys(e).reduce((n,r)=>(n[E$(r)]=e[r],n),{}):void 0,C$=()=>{const e=V.useRef(!1);return V.useEffect(()=>{e.current=!0},[]),e.current},tce=e=>{const t=V.useContext(Jle),n=()=>uz(e)||uz(t),[r,l]=V.useState(n);return V.useEffect(()=>{const d=n();Fle(r,d)||l(d)},[e,t]),r},nce=e=>{const t=()=>ece(e),[n,r]=V.useState(t);return V.useEffect(()=>{const l=t();n!==l&&r(l)},[e]),n},rce=(e,t)=>{const n=()=>kle(e,t||{},!!t),[r,l]=V.useState(n),d=C$();return V.useEffect(()=>{if(d){const p=n();return l(p),()=>{p&&p.dispose()}}},[e,t]),r},ice=e=>{const[t,n]=V.useState(e.matches);return V.useEffect(()=>{const r=l=>{n(l.matches)};return e.addListener(r),n(e.matches),()=>{e.removeListener(r)}},[e]),t},ace=(e,t,n)=>{const r=tce(t),l=nce(e);if(!l)throw new Error("Invalid or missing MediaQuery!");const d=rce(l,r),p=ice(d);return C$(),V.useEffect(()=>{},[p]),V.useEffect(()=>()=>{d&&d.dispose()},[]),p};function sce({className:e="",onClick:t}){const n=br(),r=aa(),{items:l,loaded:d}=ln(R=>R.notificaciones),[p,a]=V.useState(!1),b=V.useRef(null),T=ace({minWidth:768});V.useEffect(()=>{d||n(Pb())},[n,d]),V.useEffect(()=>{function R(F){b.current&&!b.current.contains(F.target)&&a(!1)}return T&&p?document.addEventListener("mousedown",R):document.removeEventListener("mousedown",R),()=>{document.removeEventListener("mousedown",R)}},[p,T]);const E=l.filter(R=>!R.read).length,P=()=>{T?a(R=>!R):r("/dashboard/notificaciones"),t&&t()},I=()=>{n(jU())};return f.jsxs("div",{className:"relative inline-block text-left",ref:b,children:[f.jsxs("button",{onClick:P,className:`relative p-2 hover:text-orange-500 transition-colors duration-200 ${e}`,"aria-label":"Notificaciones",children:[f.jsx(ale,{className:"w-6 h-6"}),E>0&&f.jsx("span",{className:"absolute -top-1.5 -right-1.5 bg-red-500 w-4 h-4 flex items-center justify-center text-white text-[10px] rounded-full leading-tight shadow-md",children:E})]}),T&&p&&f.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-xl shadow-xl z-50",children:[f.jsxs("div",{className:"max-h-80 overflow-y-auto",children:[l.length===0&&f.jsx("p",{className:"p-4 text-gray-500  text-xs text-center",children:"No tienes notificaciones."}),l.map(R=>f.jsx(Wn,{to:R.link,onClick:()=>a(!1),className:`flex items-start gap-2 px-4 py-3  text-xs transition-colors duration-200 border-b border-gray-100 ${R.read?"text-gray-500":"text-gray-700 font-extralight"} hover:bg-gray-50 hover:text-gray-800`,children:f.jsx("span",{className:"flex-1",children:R.message})},R._id))]}),f.jsxs("div",{className:"p-3 border-t border-gray-200 flex justify-between items-center",children:[f.jsx("button",{onClick:I,className:"text-xs text-gray-600 hover:text-orange-500 transition",children:"Marcar todas como leídas"}),f.jsx(Wn,{to:"/dashboard/notificaciones",className:"text-orange-500  text-xs font-semibold",onClick:()=>a(!1),children:"Ver todas"})]})]})]})}function oce({isOpen:e,setIsOpen:t}){const n=V.useRef(null),r=V.useRef(null),[l,d]=V.useState({top:0,left:0,width:0,height:0}),p=()=>{var b;const a=(b=n.current)==null?void 0:b.getBoundingClientRect();a&&d({top:a.bottom+6,left:a.left,width:a.width,height:a.height})};return V.useEffect(()=>{if(!e)return;p();const a=()=>p(),b=()=>p();return window.addEventListener("scroll",a,{passive:!0}),window.addEventListener("resize",b),()=>{window.removeEventListener("scroll",a),window.removeEventListener("resize",b)}},[e]),V.useEffect(()=>{if(!e)return;const a=()=>{t(!1)};return window.addEventListener("scroll",a,{passive:!0}),()=>{window.removeEventListener("scroll",a)}},[e,t]),V.useEffect(()=>{function a(T){var P,I;const E=T.target;(P=r.current)!=null&&P.contains(E)||(I=n.current)!=null&&I.contains(E)||t(!1)}e&&(document.addEventListener("mousedown",a),document.addEventListener("keydown",b,!1));function b(T){T.key==="Escape"&&t(!1)}return()=>{document.removeEventListener("mousedown",a),document.removeEventListener("keydown",b,!1)}},[e,t]),f.jsxs("div",{className:"relative",children:[f.jsxs("button",{ref:n,type:"button",onClick:()=>t(a=>!a),className:"flex items-center gap-1 text-xs font-semibold transition px-3 py-2 rounded ml-4 text-white bg-yellow-400 hover:bg-orange-500","aria-haspopup":"menu","aria-expanded":e,children:["+ PUBLICAR",f.jsx(lle,{className:"text-base"})]}),e&&r3.createPortal(f.jsxs("div",{ref:r,role:"menu",className:"border border-gray-200 shadow-lg rounded w-48 z-[9999] bg-white",style:{position:"fixed",top:l.top,left:l.left},children:[f.jsx(Wn,{to:"/dashboard/mis-negocios/crear",className:"block px-4 py-2 text-xs text-gray-700 hover:bg-gray-100",onClick:()=>t(!1),children:"Crear Negocio"}),f.jsx(Wn,{to:"/dashboard/mis-eventos/crear",className:"block px-4 py-2 text-xs text-gray-700 hover:bg-gray-100",onClick:()=>t(!1),children:"Crear Evento"})]}),document.body)]})}function lce(){const[e,t]=V.useState(window.innerWidth);return V.useEffect(()=>{const n=()=>t(window.innerWidth);return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),{isMobile:e<768,isDesktop:e>=768,width:e}}function cce({className:e="",onClick:t}){const r=ln(l=>{var d;return((d=l.conversations)==null?void 0:d.items)||[]}).filter(l=>l.lastMessageIsRead===!1).length;return f.jsxs(Wn,{to:"/dashboard/inbox",onClick:t,className:`relative p-2 hover:text-orange-500 transition-colors duration-200 ${e}`,"aria-label":"Mensajes",children:[f.jsx(y$,{className:"w-6 h-6"}),r>0&&f.jsx("span",{className:"absolute -top-1.5 -right-1.5 bg-red-500 w-4 h-4 flex items-center justify-center text-white text-[10px] rounded-full leading-tight shadow-md",children:r})]})}function uce(e){return sn({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M21 13.2422V20H22V22H2V20H3V13.2422C1.79401 12.435 1 11.0602 1 9.5C1 8.67286 1.22443 7.87621 1.63322 7.19746L4.3453 2.5C4.52393 2.1906 4.85406 2 5.21132 2H18.7887C19.1459 2 19.4761 2.1906 19.6547 2.5L22.3575 7.18172C22.7756 7.87621 23 8.67286 23 9.5C23 11.0602 22.206 12.435 21 13.2422ZM19 13.9725C18.8358 13.9907 18.669 14 18.5 14C17.2409 14 16.0789 13.478 15.25 12.6132C14.4211 13.478 13.2591 14 12 14C10.7409 14 9.5789 13.478 8.75 12.6132C7.9211 13.478 6.75911 14 5.5 14C5.331 14 5.16417 13.9907 5 13.9725V20H19V13.9725ZM5.78865 4L3.35598 8.21321C3.12409 8.59843 3 9.0389 3 9.5C3 10.8807 4.11929 12 5.5 12C6.53096 12 7.44467 11.3703 7.82179 10.4295C8.1574 9.59223 9.3426 9.59223 9.67821 10.4295C10.0553 11.3703 10.969 12 12 12C13.031 12 13.9447 11.3703 14.3218 10.4295C14.6574 9.59223 15.8426 9.59223 16.1782 10.4295C16.5553 11.3703 17.469 12 18.5 12C19.8807 12 21 10.8807 21 9.5C21 9.0389 20.8759 8.59843 20.6347 8.19746L18.2113 4H5.78865Z"},child:[]}]})(e)}function j$(e){return sn({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M12.598 16 9.39893 8H7.39893L5.39893 13 5.39795 13.002 4.19897 16H6.35303L6.75293 15H10.043L10.443 16H12.598ZM7.552 13 8.39893 10.8851 9.24402 13H7.552ZM17 8H19V16H16C14.3431 16 13 14.6569 13 13 13 11.3431 14.3431 10 16 10H17V8ZM16 12C15.4478 12 15 12.4478 15 13 15 13.5522 15.4478 14 16 14H17V12H16ZM21 3H3C2.44775 3 2 3.44775 2 4V20C2 20.5522 2.44775 21 3 21H21C21.5522 21 22 20.5522 22 20V4C22 3.44775 21.5522 3 21 3ZM4 19V5H20V19H4Z"},child:[]}]})(e)}function dce(e){return sn({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M6.45455 19L2 22.5V4C2 3.44772 2.44772 3 3 3H21C21.5523 3 22 3.44772 22 4V18C22 18.5523 21.5523 19 21 19H6.45455ZM5.76282 17H20V5H4V18.3851L5.76282 17ZM11 10H13V12H11V10ZM7 10H9V12H7V10ZM15 10H17V12H15V10Z"},child:[]}]})(e)}function hce(e){return sn({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M2 8.99374C2 5.68349 4.67654 3 8.00066 3H15.9993C19.3134 3 22 5.69478 22 8.99374V21H8.00066C4.68659 21 2 18.3052 2 15.0063V8.99374ZM20 19V8.99374C20 6.79539 18.2049 5 15.9993 5H8.00066C5.78458 5 4 6.78458 4 8.99374V15.0063C4 17.2046 5.79512 19 8.00066 19H20ZM14 11H16V13H14V11ZM8 11H10V13H8V11Z"},child:[]}]})(e)}function fce(e){return sn({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M16.9337 8.96494C16.426 5.03562 13.0675 2 9 2 4.58172 2 1 5.58172 1 10 1 11.8924 1.65707 13.6313 2.7555 15.0011 3.56351 16.0087 4.00033 17.1252 4.00025 18.3061L4 22H13L13.001 19H15C16.1046 19 17 18.1046 17 17V14.071L18.9593 13.2317C19.3025 13.0847 19.3324 12.7367 19.1842 12.5037L16.9337 8.96494ZM3 10C3 6.68629 5.68629 4 9 4 12.0243 4 14.5665 6.25141 14.9501 9.22118L15.0072 9.66262 16.5497 12.0881 15 12.7519V17H11.0017L11.0007 20H6.00013L6.00025 18.3063C6.00036 16.6672 5.40965 15.114 4.31578 13.7499 3.46818 12.6929 3 11.3849 3 10ZM21.1535 18.1024 19.4893 16.9929C20.4436 15.5642 21 13.8471 21 12.0001 21 10.153 20.4436 8.4359 19.4893 7.00722L21.1535 5.89771C22.32 7.64386 23 9.74254 23 12.0001 23 14.2576 22.32 16.3562 21.1535 18.1024Z"},child:[]}]})(e)}function M$(e){return sn({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M2.00488 3.99979C2.00488 3.4475 2.4526 2.99979 3.00488 2.99979H21.0049C21.5572 2.99979 22.0049 3.4475 22.0049 3.99979V9.49979C20.6242 9.49979 19.5049 10.6191 19.5049 11.9998C19.5049 13.3805 20.6242 14.4998 22.0049 14.4998V19.9998C22.0049 20.5521 21.5572 20.9998 21.0049 20.9998H3.00488C2.4526 20.9998 2.00488 20.5521 2.00488 19.9998V3.99979ZM8.09024 18.9998C8.29615 18.4172 8.85177 17.9998 9.50488 17.9998C10.158 17.9998 10.7136 18.4172 10.9195 18.9998H20.0049V16.032C18.5232 15.2957 17.5049 13.7666 17.5049 11.9998C17.5049 10.2329 18.5232 8.7039 20.0049 7.96755V4.99979H10.9195C10.7136 5.58238 10.158 5.99979 9.50488 5.99979C8.85177 5.99979 8.29615 5.58238 8.09024 4.99979H4.00488V18.9998H8.09024ZM9.50488 10.9998C8.67646 10.9998 8.00488 10.3282 8.00488 9.49979C8.00488 8.67136 8.67646 7.99979 9.50488 7.99979C10.3333 7.99979 11.0049 8.67136 11.0049 9.49979C11.0049 10.3282 10.3333 10.9998 9.50488 10.9998ZM9.50488 15.9998C8.67646 15.9998 8.00488 15.3282 8.00488 14.4998C8.00488 13.6714 8.67646 12.9998 9.50488 12.9998C10.3333 12.9998 11.0049 13.6714 11.0049 14.4998C11.0049 15.3282 10.3333 15.9998 9.50488 15.9998Z"},child:[]}]})(e)}function P$(){const e=ln(Z=>Z.auth.usuario),t=ln(Z=>Z.mobileMenu.isOpen),[n,r]=V.useState(!1),[l,d]=V.useState(!0),p=V.useRef(0),[a,b]=V.useState(!0),T=V.useRef(0),E=br(),P=aa(),{isMobile:I,isDesktop:R}=lce();V.useEffect(()=>{document.body.style.overflow=t?"hidden":"auto"},[t]),V.useEffect(()=>{if(!I)return;const Z=()=>{const ne=window.scrollY,ie=ne-p.current,ge=ne<50,ae=window.innerHeight+ne>=document.body.offsetHeight-50;if(ge||ae){d(!0),p.current=ne;return}Math.abs(ie)<10||(d(ie<0),p.current=ne)};return window.addEventListener("scroll",Z,{passive:!0}),()=>window.removeEventListener("scroll",Z)},[I]),V.useEffect(()=>{if(!R)return;const Z=()=>{if(t){b(!0);return}const ne=window.scrollY,ie=ne-T.current,ge=ne<50,ae=window.innerHeight+ne>=document.body.offsetHeight-50;if(ge||ae){b(!0),T.current=ne;return}Math.abs(ie)<48||(b(ie<0),T.current=ne)};return window.addEventListener("scroll",Z,{passive:!0}),()=>window.removeEventListener("scroll",Z)},[R,t]);const F=[{to:"/negocios",icon:f.jsx(BT,{}),label:"Negocios"},{to:"/eventos",icon:f.jsx(FT,{}),label:"Eventos"},{to:"/comunidades",icon:f.jsx(VT,{}),label:"Comunidades"},{to:"/promociones",icon:f.jsx(hy,{}),label:"Promociones"}],W=[{to:"/about",label:"Sobre nosotros"},{to:"/contact",label:"Contáctanos"},{to:"/legal-privacy",label:"Privacidad"},{to:"/legal-terms",label:"Términos"}],$=()=>{E(yU()),P("/")};return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"hidden md:block w-full bg-orange-500 text-white text-center py-1 text-xs z-50",children:"✨ Juntos construimos una comunidad que apoya, inspira y crece unida"}),f.jsxs("header",{className:`shadow sticky top-0 z-50 transition-transform duration-300 ${I?l?"translate-y-0":"-translate-y-full":"translate-y-0"} ${t?"bg-orange-600":"bg-white"}`,children:[f.jsxs("div",{className:"flex items-center justify-between px-4 lg:px-10 py-1",children:[f.jsxs(Wn,{to:"/",children:[f.jsx("img",{src:s3,alt:"Communidades logo",className:`2xl:h-20 h-12 hidden md:block ${t?"filter brightness-0 invert":""}`}),f.jsx("img",{src:Nle,alt:"Communidades logo",className:`h-12 md:hidden py-1 ${t?"filter brightness-0 invert":""}`})]}),f.jsxs("nav",{className:"hidden md:flex gap-6 items-center",children:[F.map(Z=>f.jsxs(Wn,{to:Z.to,className:`flex md:flex-col lg:flex-row items-center justify-center gap-0 md:gap-0.5 lg:gap-1 transition font-medium ${t?"text-white hover:text-yellow-200":"text-gray-800 hover:text-orange-500"}`,children:[f.jsx("span",{className:" text-lg md: text-lg lg:text-base",children:Z.icon}),f.jsx("span",{className:"text-[10px] md:text-xs",children:Z.label})]},Z.to)),f.jsx(Wn,{to:e?"/dashboard/perfil":"/login",className:`${t?"bg-white text-orange-600 hover:bg-yellow-100":"bg-yellow-400 text-black hover:bg-orange-500"} text-xs font-bold px-4 py-2 rounded transition`,children:e?"PERFIL":"ENTRAR"})]}),f.jsxs("div",{className:"flex items-center gap-2 md:hidden",children:[e&&f.jsx(cce,{className:`text-md p-2 rounded transition ${t?"text-white":"text-black"}`,onClick:()=>E(bM())}),e&&f.jsx(sce,{className:`text-md p-2 rounded transition ${t?"text-white":"text-black"}`,onClick:()=>E(bM())}),f.jsx("button",{onClick:()=>E(Sd()),className:`text-md p-2 rounded transition ${t?"text-white":"text-black"}`,"aria-label":"Abrir menú",children:t?f.jsx(gle,{}):f.jsx(ule,{})})]})]}),f.jsx("div",{className:`
            hidden md:block border-t border-gray-200
            ${t?"bg-orange-500":"bg-gray-100"}
            overflow-hidden transition-all 
            ${a?"max-h-12 opacity-100 py-1":"max-h-0 opacity-0 py-0"}
          `,"aria-hidden":!a,children:f.jsx("div",{className:"max-w-screen-2xl mx-auto px-4 lg:px-10",children:f.jsxs("div",{className:"flex justify-center relative",children:[W.map((Z,ne)=>f.jsxs(Wn,{to:Z.to,className:`text-xs font-medium px-3 py-2 transition relative ${t?"text-white hover:text-yellow-200":"text-gray-600 hover:text-orange-500"}`,children:[Z.label,ne<W.length-1&&f.jsx("span",{className:"absolute right-0 top-1/2 -translate-y-1/2 w-px h-4 bg-gray-300"})]},Z.to)),f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(oce,{isOpen:n,setIsOpen:r})})]})})})]}),f.jsx("div",{className:`fixed inset-0 z-30 bg-black/70 backdrop-blur-sm transition-opacity duration-300 ${t?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,children:f.jsxs("div",{className:`absolute left-0 top-0 w-full h-full
            bg-gradient-to-br from-orange-400 via-orange-500 to-red-700
            text-white p-6 py-20 transform transition-transform duration-300
            ${t?"translate-x-0":"-translate-x-full"}
            flex flex-col justify-between font-sans`,children:[f.jsx("div",{className:"flex flex-col gap-6",children:f.jsxs("nav",{className:"flex flex-col gap-4",children:[f.jsxs(Wn,{to:e?"/dashboard/perfil":"/login",onClick:()=>E(Sd()),className:"flex items-center gap-3 text-base font-medium hover:text-yellow-300 transition relative z-10",children:[f.jsx(S$,{className:"text-sm"}),e?"Mi Perfil":"Iniciar Sesión"]}),f.jsxs(Wn,{to:"/negocios",onClick:()=>E(Sd()),className:"flex items-center gap-3 text-base font-medium hover:text-yellow-300 transition relative z-10",children:[f.jsx(BT,{className:"text-sm"}),"Negocios"]}),f.jsxs(Wn,{to:"/eventos",onClick:()=>E(Sd()),className:"flex items-center gap-3 text-base font-medium hover:text-yellow-300 transition relative z-10",children:[f.jsx(FT,{className:"text-sm"}),"Eventos"]}),f.jsxs(Wn,{to:"/dashboard/mis-banners",onClick:()=>E(Sd()),className:"flex items-center gap-3 text-base font-medium hover:text-yellow-300 transition relative z-10",children:[f.jsx(T$,{className:"text-sm"}),"Mis banners"]}),f.jsxs(Wn,{to:"/promociones",onClick:()=>E(Sd()),className:"flex items-center gap-3 text-base font-medium hover:text-yellow-300 transition relative z-10",children:[f.jsx(hy,{className:"text-sm"}),"Promociones"]}),f.jsxs(Wn,{to:"/comunidades",onClick:()=>E(Sd()),className:"flex items-center gap-3 text-base font-medium hover:text-yellow-300 transition relative z-10",children:[f.jsx(VT,{className:"text-sm"}),"Comunidades"]}),(e==null?void 0:e.role)==="admin"&&f.jsxs(f.Fragment,{children:[f.jsxs(Wn,{to:"/dashboard-admin/banners",onClick:()=>E(Sd()),className:"flex items-center gap-3 text-base font-medium hover:text-yellow-300 transition relative z-10",children:[f.jsx(j$,{className:"text-sm"}),"Ads / Banners"]}),f.jsxs(Wn,{to:"/premium",onClick:()=>E(Sd()),className:"relative w-fit flex items-center gap-2 text-xs font-semibold text-white rounded-lg pr-4 py-2 overflow-hidden transition",children:[f.jsx("span",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-shimmer"}),f.jsx(kb,{className:"text-base relative z-10"}),f.jsx("span",{className:"relative text-green-400 z-10",children:"Suscripción Premium"})]})]})]})}),f.jsxs("div",{className:"flex flex-col gap-2 mt-6 border-t border-orange-300 pt-4 relative z-10",children:[f.jsxs(Wn,{to:"/about",onClick:()=>E(Sd()),className:"flex items-center gap-2 text-xs font-normal hover:text-yellow-300 transition",children:[f.jsx(kb,{className:"text-base"}),"Acerca de nosotros"]}),f.jsxs(Wn,{to:"/contact",onClick:()=>E(Sd()),className:"flex items-center gap-2 text-xs font-normal hover:text-yellow-300 transition",children:[f.jsx(kb,{className:"text-base"}),"Contáctanos"]})]}),f.jsx("div",{className:"flex justify-center mt-8 relative z-10",children:f.jsxs("div",{className:"relative inline-block orbit-wrapper",children:[f.jsx("img",{src:Rm,alt:"Logo Communidades",className:"h-24 opacity-90 relative z-20 logo-pulse select-none pointer-events-none",draggable:"false"}),f.jsx("span",{className:"orbit-sphere sphere1"}),f.jsx("span",{className:"orbit-sphere sphere2"}),f.jsx("span",{className:"orbit-sphere sphere3"})]})}),f.jsx("div",{className:"w-full px-3 py-4",children:f.jsxs("button",{onClick:$,className:"w-full flex gap-2 text-xs text-white relative z-10 transition rounded-full py-2",children:[f.jsx(_$,{className:"text-lg text-white"}),f.jsx("span",{children:"Cerrar sesión"})]})}),f.jsxs(Wn,{to:"/dashboard/mis-negocios/crear",onClick:()=>E(Sd()),className:`\r
              relative z-10\r
              flex items-center justify-center gap-2\r
              bg-white text-orange-600\r
              font-semibold\r
              px-4 py-3\r
              rounded-xl\r
              shadow-lg\r
              transition\r
              text-base\r
              hover:bg-yellow-100\r
              active:scale-95\r
            `,children:[f.jsx(ble,{className:"text-xs"}),"Crear Negocio"]}),f.jsx("div",{className:`\r
              absolute bottom-0 left-0 w-full h-[90vh]\r
              bg-gradient-to-t from-black/60 to-transparent\r
              z-0\r
            `})]})})]})}function pce(e){return sn({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M80 299.3V512H196V299.3h86.5l18-97.8H196V166.9c0-51.7 20.3-71.5 72.7-71.5c16.3 0 29.4 .4 37 1.2V7.9C291.4 4 256.4 0 236.2 0C129.3 0 80 50.5 80 159.4v42.1H14v97.8H80z"},child:[]}]})(e)}function mce(e){return sn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"},child:[]}]})(e)}function gce(e){return sn({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"},child:[]}]})(e)}const xce="/assets/logo3-Cz7ucCPQ.svg",yce="/assets/icono_logo2-DjDL8V0l.svg";function vce(e){return sn({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M279.14 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z"},child:[]}]})(e)}function o3(e){return sn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"},child:[]}]})(e)}function l3(e){return sn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"},child:[]}]})(e)}function N$(e){return sn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448,209.91a210.06,210.06,0,0,1-122.77-39.25V349.38A162.55,162.55,0,1,1,185,188.31V278.2a74.62,74.62,0,1,0,52.23,71.18V0l88,0a121.18,121.18,0,0,0,1.86,22.17h0A122.18,122.18,0,0,0,381,102.39a121.43,121.43,0,0,0,67,20.14Z"},child:[]}]})(e)}function $P(e){return sn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"},child:[]}]})(e)}function c3(e){return sn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"},child:[]}]})(e)}function D$(e){return sn({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"},child:[]}]})(e)}function _ce(e){return sn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M413.1 222.5l22.2 22.2c9.4 9.4 9.4 24.6 0 33.9L241 473c-9.4 9.4-24.6 9.4-33.9 0L12.7 278.6c-9.4-9.4-9.4-24.6 0-33.9l22.2-22.2c9.5-9.5 25-9.3 34.3.4L184 343.4V56c0-13.3 10.7-24 24-24h32c13.3 0 24 10.7 24 24v287.4l114.8-120.5c9.3-9.8 24.8-10 34.3-.4z"},child:[]}]})(e)}function bce(e){return sn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M436 480h-20V24c0-13.255-10.745-24-24-24H56C42.745 0 32 10.745 32 24v456H12c-6.627 0-12 5.373-12 12v20h448v-20c0-6.627-5.373-12-12-12zM128 76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76zm0 96c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40zm52 148h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12zm76 160h-64v-84c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v84zm64-172c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40z"},child:[]}]})(e)}function wce(e){return sn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 144v288c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V144c0-26.5 21.5-48 48-48h88l12.3-32.9c7-18.7 24.9-31.1 44.9-31.1h125.5c20 0 37.9 12.4 44.9 31.1L376 96h88c26.5 0 48 21.5 48 48zM376 288c0-66.2-53.8-120-120-120s-120 53.8-120 120 53.8 120 120 120 120-53.8 120-120zm-32 0c0 48.5-39.5 88-88 88s-88-39.5-88-88 39.5-88 88-88 88 39.5 88 88z"},child:[]}]})(e)}function Sce(e){return sn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M499.99 176h-59.87l-16.64-41.6C406.38 91.63 365.57 64 319.5 64h-127c-46.06 0-86.88 27.63-103.99 70.4L71.87 176H12.01C4.2 176-1.53 183.34.37 190.91l6 24C7.7 220.25 12.5 224 18.01 224h20.07C24.65 235.73 16 252.78 16 272v48c0 16.12 6.16 30.67 16 41.93V416c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32v-32h256v32c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32v-54.07c9.84-11.25 16-25.8 16-41.93v-48c0-19.22-8.65-36.27-22.07-48H494c5.51 0 10.31-3.75 11.64-9.09l6-24c1.89-7.57-3.84-14.91-11.65-14.91zm-352.06-17.83c7.29-18.22 24.94-30.17 44.57-30.17h127c19.63 0 37.28 11.95 44.57 30.17L384 208H128l19.93-49.83zM96 319.8c-19.2 0-32-12.76-32-31.9S76.8 256 96 256s48 28.71 48 47.85-28.8 15.95-48 15.95zm320 0c-19.2 0-48 3.19-48-15.95S396.8 256 416 256s32 12.76 32 31.9-12.8 31.9-32 31.9z"},child:[]}]})(e)}function jd(e){return sn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},child:[]}]})(e)}function Tce(e){return sn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"},child:[]}]})(e)}function Ece(e){return sn({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"},child:[]}]})(e)}function Ace(e){return sn({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"},child:[]}]})(e)}function Cce(e){return sn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"},child:[]}]})(e)}function jce(e){return sn({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M416 192c0-88.4-93.1-160-208-160S0 103.6 0 192c0 34.3 14.1 65.9 38 92-13.4 30.2-35.5 54.2-35.8 54.5-2.2 2.3-2.8 5.7-1.5 8.7S4.8 352 8 352c36.6 0 66.9-12.3 88.7-25 32.2 15.7 70.3 25 111.3 25 114.9 0 208-71.6 208-160zm122 220c23.9-26 38-57.7 38-92 0-66.9-53.5-124.2-129.3-148.1.9 6.6 1.3 13.3 1.3 20.1 0 105.9-107.7 192-240 192-10.8 0-21.3-.8-31.7-1.9C207.8 439.6 281.8 480 368 480c41 0 79.1-9.2 111.3-25 21.8 12.7 52.1 25 88.7 25 3.2 0 6.1-1.9 7.3-4.8 1.3-2.9.7-6.3-1.5-8.7-.3-.3-22.4-24.2-35.8-54.5z"},child:[]}]})(e)}function O$(e){return sn({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M104 96H56c-13.3 0-24 10.7-24 24v104H8c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h24v104c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24V120c0-13.3-10.7-24-24-24zm528 128h-24V120c0-13.3-10.7-24-24-24h-48c-13.3 0-24 10.7-24 24v272c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24V288h24c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM456 32h-48c-13.3 0-24 10.7-24 24v168H256V56c0-13.3-10.7-24-24-24h-48c-13.3 0-24 10.7-24 24v400c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24V288h128v168c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24V56c0-13.3-10.7-24-24-24z"},child:[]}]})(e)}function qP(e){return sn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"},child:[]}]})(e)}function dz(e){return sn({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(e)}function I$(e){return sn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M488 64h-8v20c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12V64H96v20c0 6.6-5.4 12-12 12H44c-6.6 0-12-5.4-12-12V64h-8C10.7 64 0 74.7 0 88v336c0 13.3 10.7 24 24 24h8v-20c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v20h320v-20c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v20h8c13.3 0 24-10.7 24-24V88c0-13.3-10.7-24-24-24zM96 372c0 6.6-5.4 12-12 12H44c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40zm0-96c0 6.6-5.4 12-12 12H44c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40zm0-96c0 6.6-5.4 12-12 12H44c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40zm272 208c0 6.6-5.4 12-12 12H156c-6.6 0-12-5.4-12-12v-96c0-6.6 5.4-12 12-12h200c6.6 0 12 5.4 12 12v96zm0-168c0 6.6-5.4 12-12 12H156c-6.6 0-12-5.4-12-12v-96c0-6.6 5.4-12 12-12h200c6.6 0 12 5.4 12 12v96zm112 152c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40zm0-96c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40zm0-96c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40z"},child:[]}]})(e)}function k$(e){return sn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M437.2 403.5L320 215V64h8c13.3 0 24-10.7 24-24V24c0-13.3-10.7-24-24-24H120c-13.3 0-24 10.7-24 24v16c0 13.3 10.7 24 24 24h8v151L10.8 403.5C-18.5 450.6 15.3 512 70.9 512h306.2c55.7 0 89.4-61.5 60.1-108.5zM137.9 320l48.2-77.6c3.7-5.2 5.8-11.6 5.8-18.4V64h64v160c0 6.9 2.2 13.2 5.8 18.4l48.2 77.6h-172z"},child:[]}]})(e)}function R$(e){return sn({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M485.5 0L576 160H474.9L405.7 0h79.8zm-128 0l69.2 160H149.3L218.5 0h139zm-267 0h79.8l-69.2 160H0L90.5 0zM0 192h100.7l123 251.7c1.5 3.1-2.7 5.9-5 3.3L0 192zm148.2 0h279.6l-137 318.2c-1 2.4-4.5 2.4-5.5 0L148.2 192zm204.1 251.7l123-251.7H576L357.3 446.9c-2.3 2.7-6.5-.1-5-3.2z"},child:[]}]})(e)}function Mce(e){return sn({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M248 8C111.03 8 0 119.03 0 256s111.03 248 248 248 248-111.03 248-248S384.97 8 248 8zm82.29 357.6c-3.9 3.88-7.99 7.95-11.31 11.28-2.99 3-5.1 6.7-6.17 10.71-1.51 5.66-2.73 11.38-4.77 16.87l-17.39 46.85c-13.76 3-28 4.69-42.65 4.69v-27.38c1.69-12.62-7.64-36.26-22.63-51.25-6-6-9.37-14.14-9.37-22.63v-32.01c0-11.64-6.27-22.34-16.46-27.97-14.37-7.95-34.81-19.06-48.81-26.11-11.48-5.78-22.1-13.14-31.65-21.75l-.8-.72a114.792 114.792 0 0 1-18.06-20.74c-9.38-13.77-24.66-36.42-34.59-51.14 20.47-45.5 57.36-82.04 103.2-101.89l24.01 12.01C203.48 89.74 216 82.01 216 70.11v-11.3c7.99-1.29 16.12-2.11 24.39-2.42l28.3 28.3c6.25 6.25 6.25 16.38 0 22.63L264 112l-10.34 10.34c-3.12 3.12-3.12 8.19 0 11.31l4.69 4.69c3.12 3.12 3.12 8.19 0 11.31l-8 8a8.008 8.008 0 0 1-5.66 2.34h-8.99c-2.08 0-4.08.81-5.58 2.27l-9.92 9.65a8.008 8.008 0 0 0-1.58 9.31l15.59 31.19c2.66 5.32-1.21 11.58-7.15 11.58h-5.64c-1.93 0-3.79-.7-5.24-1.96l-9.28-8.06a16.017 16.017 0 0 0-15.55-3.1l-31.17 10.39a11.95 11.95 0 0 0-8.17 11.34c0 4.53 2.56 8.66 6.61 10.69l11.08 5.54c9.41 4.71 19.79 7.16 30.31 7.16s22.59 27.29 32 32h66.75c8.49 0 16.62 3.37 22.63 9.37l13.69 13.69a30.503 30.503 0 0 1 8.93 21.57 46.536 46.536 0 0 1-13.72 32.98zM417 274.25c-5.79-1.45-10.84-5-14.15-9.97l-17.98-26.97a23.97 23.97 0 0 1 0-26.62l19.59-29.38c2.32-3.47 5.5-6.29 9.24-8.15l12.98-6.49C440.2 193.59 448 223.87 448 256c0 8.67-.74 17.16-1.82 25.54L417 274.25z"},child:[]}]})(e)}function tw(e){return sn({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"},child:[]}]})(e)}function z$(e){return sn({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M622.34 153.2L343.4 67.5c-15.2-4.67-31.6-4.67-46.79 0L17.66 153.2c-23.54 7.23-23.54 38.36 0 45.59l48.63 14.94c-10.67 13.19-17.23 29.28-17.88 46.9C38.78 266.15 32 276.11 32 288c0 10.78 5.68 19.85 13.86 25.65L20.33 428.53C18.11 438.52 25.71 448 35.94 448h56.11c10.24 0 17.84-9.48 15.62-19.47L82.14 313.65C90.32 307.85 96 298.78 96 288c0-11.57-6.47-21.25-15.66-26.87.76-15.02 8.44-28.3 20.69-36.72L296.6 284.5c9.06 2.78 26.44 6.25 46.79 0l278.95-85.7c23.55-7.24 23.55-38.36 0-45.6zM352.79 315.09c-28.53 8.76-52.84 3.92-65.59 0l-145.02-44.55L128 384c0 35.35 85.96 64 192 64s192-28.65 192-64l-14.18-113.47-145.03 44.56z"},child:[]}]})(e)}function Pce(e){return sn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M192 208c0-17.67-14.33-32-32-32h-16c-35.35 0-64 28.65-64 64v48c0 35.35 28.65 64 64 64h16c17.67 0 32-14.33 32-32V208zm176 144c35.35 0 64-28.65 64-64v-48c0-35.35-28.65-64-64-64h-16c-17.67 0-32 14.33-32 32v112c0 17.67 14.33 32 32 32h16zM256 0C113.18 0 4.58 118.83 0 256v16c0 8.84 7.16 16 16 16h16c8.84 0 16-7.16 16-16v-16c0-114.69 93.31-208 208-208s208 93.31 208 208h-.12c.08 2.43.12 165.72.12 165.72 0 23.35-18.93 42.28-42.28 42.28H320c0-26.51-21.49-48-48-48h-32c-26.51 0-48 21.49-48 48s21.49 48 48 48h181.72c49.86 0 90.28-40.42 90.28-90.28V256C507.42 118.83 398.82 0 256 0z"},child:[]}]})(e)}function L$(e){return sn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M320.2 243.8l-49.7 99.4c-6 12.1-23.4 11.7-28.9-.6l-56.9-126.3-30 71.7H60.6l182.5 186.5c7.1 7.3 18.6 7.3 25.7 0L451.4 288H342.3l-22.1-44.2zM473.7 73.9l-2.4-2.5c-51.5-52.6-135.8-52.6-187.4 0L256 100l-27.9-28.5c-51.5-52.7-135.9-52.7-187.4 0l-2.4 2.4C-10.4 123.7-12.5 203 31 256h102.4l35.9-86.2c5.4-12.9 23.6-13.2 29.4-.4l58.2 129.3 49-97.9c5.9-11.8 22.7-11.8 28.6 0l27.6 55.2H481c43.5-53 41.4-132.3-7.3-182.1z"},child:[]}]})(e)}function F$(e){return sn({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function Nce(e){return sn({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M480 416v16c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V176c0-26.51 21.49-48 48-48h16v208c0 44.112 35.888 80 80 80h336zm96-80V80c0-26.51-21.49-48-48-48H144c-26.51 0-48 21.49-48 48v256c0 26.51 21.49 48 48 48h384c26.51 0 48-21.49 48-48zM256 128c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-96 144l55.515-55.515c4.686-4.686 12.284-4.686 16.971 0L272 256l135.515-135.515c4.686-4.686 12.284-4.686 16.971 0L512 208v112H160v-48z"},child:[]}]})(e)}function Dce(e){return sn({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M152.1 236.2c-3.5-12.1-7.8-33.2-7.8-33.2h-.5s-4.3 21.1-7.8 33.2l-11.1 37.5H163zM616 96H336v320h280c13.3 0 24-10.7 24-24V120c0-13.3-10.7-24-24-24zm-24 120c0 6.6-5.4 12-12 12h-11.4c-6.9 23.6-21.7 47.4-42.7 69.9 8.4 6.4 17.1 12.5 26.1 18 5.5 3.4 7.3 10.5 4.1 16.2l-7.9 13.9c-3.4 5.9-10.9 7.8-16.7 4.3-12.6-7.8-24.5-16.1-35.4-24.9-10.9 8.7-22.7 17.1-35.4 24.9-5.8 3.5-13.3 1.6-16.7-4.3l-7.9-13.9c-3.2-5.6-1.4-12.8 4.2-16.2 9.3-5.7 18-11.7 26.1-18-7.9-8.4-14.9-17-21-25.7-4-5.7-2.2-13.6 3.7-17.1l6.5-3.9 7.3-4.3c5.4-3.2 12.4-1.7 16 3.4 5 7 10.8 14 17.4 20.9 13.5-14.2 23.8-28.9 30-43.2H412c-6.6 0-12-5.4-12-12v-16c0-6.6 5.4-12 12-12h64v-16c0-6.6 5.4-12 12-12h16c6.6 0 12 5.4 12 12v16h64c6.6 0 12 5.4 12 12zM0 120v272c0 13.3 10.7 24 24 24h280V96H24c-13.3 0-24 10.7-24 24zm58.9 216.1L116.4 167c1.7-4.9 6.2-8.1 11.4-8.1h32.5c5.1 0 9.7 3.3 11.4 8.1l57.5 169.1c2.6 7.8-3.1 15.9-11.4 15.9h-22.9a12 12 0 0 1-11.5-8.6l-9.4-31.9h-60.2l-9.1 31.8c-1.5 5.1-6.2 8.7-11.5 8.7H70.3c-8.2 0-14-8.1-11.4-15.9z"},child:[]}]})(e)}function Oce(e){return sn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"},child:[]}]})(e)}function B$(e){return sn({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M608 32H32C14.33 32 0 46.33 0 64v384c0 17.67 14.33 32 32 32h576c17.67 0 32-14.33 32-32V64c0-17.67-14.33-32-32-32zM176 327.88V344c0 4.42-3.58 8-8 8h-16c-4.42 0-8-3.58-8-8v-16.29c-11.29-.58-22.27-4.52-31.37-11.35-3.9-2.93-4.1-8.77-.57-12.14l11.75-11.21c2.77-2.64 6.89-2.76 10.13-.73 3.87 2.42 8.26 3.72 12.82 3.72h28.11c6.5 0 11.8-5.92 11.8-13.19 0-5.95-3.61-11.19-8.77-12.73l-45-13.5c-18.59-5.58-31.58-23.42-31.58-43.39 0-24.52 19.05-44.44 42.67-45.07V152c0-4.42 3.58-8 8-8h16c4.42 0 8 3.58 8 8v16.29c11.29.58 22.27 4.51 31.37 11.35 3.9 2.93 4.1 8.77.57 12.14l-11.75 11.21c-2.77 2.64-6.89 2.76-10.13.73-3.87-2.43-8.26-3.72-12.82-3.72h-28.11c-6.5 0-11.8 5.92-11.8 13.19 0 5.95 3.61 11.19 8.77 12.73l45 13.5c18.59 5.58 31.58 23.42 31.58 43.39 0 24.53-19.05 44.44-42.67 45.07zM416 312c0 4.42-3.58 8-8 8H296c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h112c4.42 0 8 3.58 8 8v16zm160 0c0 4.42-3.58 8-8 8h-80c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h80c4.42 0 8 3.58 8 8v16zm0-96c0 4.42-3.58 8-8 8H296c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h272c4.42 0 8 3.58 8 8v16z"},child:[]}]})(e)}function Ice(e){return sn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M167.02 309.34c-40.12 2.58-76.53 17.86-97.19 72.3-2.35 6.21-8 9.98-14.59 9.98-11.11 0-45.46-27.67-55.25-34.35C0 439.62 37.93 512 128 512c75.86 0 128-43.77 128-120.19 0-3.11-.65-6.08-.97-9.13l-88.01-73.34zM457.89 0c-15.16 0-29.37 6.71-40.21 16.45C213.27 199.05 192 203.34 192 257.09c0 13.7 3.25 26.76 8.73 38.7l63.82 53.18c7.21 1.8 14.64 3.03 22.39 3.03 62.11 0 98.11-45.47 211.16-256.46 7.38-14.35 13.9-29.85 13.9-45.99C512 20.64 486 0 457.89 0z"},child:[]}]})(e)}function zM(e){return sn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M204.3 5C104.9 24.4 24.8 104.3 5.2 203.4c-37 187 131.7 326.4 258.8 306.7 41.2-6.4 61.4-54.6 42.5-91.7-23.1-45.4 9.9-98.4 60.9-98.4h79.7c35.8 0 64.8-29.6 64.9-65.3C511.5 97.1 368.1-26.9 204.3 5zM96 320c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm32-128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128-64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"},child:[]}]})(e)}function V$(e){return sn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 224c-79.41 0-192 122.76-192 200.25 0 34.9 26.81 55.75 71.74 55.75 48.84 0 81.09-25.08 120.26-25.08 39.51 0 71.85 25.08 120.26 25.08 44.93 0 71.74-20.85 71.74-55.75C448 346.76 335.41 224 256 224zm-147.28-12.61c-10.4-34.65-42.44-57.09-71.56-50.13-29.12 6.96-44.29 40.69-33.89 75.34 10.4 34.65 42.44 57.09 71.56 50.13 29.12-6.96 44.29-40.69 33.89-75.34zm84.72-20.78c30.94-8.14 46.42-49.94 34.58-93.36s-46.52-72.01-77.46-63.87-46.42 49.94-34.58 93.36c11.84 43.42 46.53 72.02 77.46 63.87zm281.39-29.34c-29.12-6.96-61.15 15.48-71.56 50.13-10.4 34.65 4.77 68.38 33.89 75.34 29.12 6.96 61.15-15.48 71.56-50.13 10.4-34.65-4.77-68.38-33.89-75.34zm-156.27 29.34c30.94 8.14 65.62-20.45 77.46-63.87 11.84-43.42-3.64-85.21-34.58-93.36s-65.62 20.45-77.46 63.87c-11.84 43.42 3.64 85.22 34.58 93.36z"},child:[]}]})(e)}function kce(e){return sn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.39 361.8l-112-48a24 24 0 0 0-28 6.9l-49.6 60.6A370.66 370.66 0 0 1 130.6 204.11l60.6-49.6a23.94 23.94 0 0 0 6.9-28l-48-112A24.16 24.16 0 0 0 122.6.61l-104 24A24 24 0 0 0 0 48c0 256.5 207.9 464 464 464a24 24 0 0 0 23.4-18.6l24-104a24.29 24.29 0 0 0-14.01-27.6z"},child:[]}]})(e)}function Rce(e){return sn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M493.4 24.6l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-36 76.7-98.9 140.5-177.2 177.2l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48C3.9 366.5-2 378.1.6 389.4l24 104C27.1 504.2 36.7 512 48 512c256.1 0 464-207.5 464-464 0-11.2-7.7-20.9-18.6-23.4z"},child:[]}]})(e)}function HP(e){return sn({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M202.021 0C122.202 0 70.503 32.703 29.914 91.026c-7.363 10.58-5.093 25.086 5.178 32.874l43.138 32.709c10.373 7.865 25.132 6.026 33.253-4.148 25.049-31.381 43.63-49.449 82.757-49.449 30.764 0 68.816 19.799 68.816 49.631 0 22.552-18.617 34.134-48.993 51.164-35.423 19.86-82.299 44.576-82.299 106.405V320c0 13.255 10.745 24 24 24h72.471c13.255 0 24-10.745 24-24v-5.773c0-42.86 125.268-44.645 125.268-160.627C377.504 66.256 286.902 0 202.021 0zM192 373.459c-38.196 0-69.271 31.075-69.271 69.271 0 38.195 31.075 69.27 69.271 69.27s69.271-31.075 69.271-69.271-31.075-69.27-69.271-69.27z"},child:[]}]})(e)}function zce(e){return sn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505.12019,19.09375c-1.18945-5.53125-6.65819-11-12.207-12.1875C460.716,0,435.507,0,410.40747,0,307.17523,0,245.26909,55.20312,199.05238,128H94.83772c-16.34763.01562-35.55658,11.875-42.88664,26.48438L2.51562,253.29688A28.4,28.4,0,0,0,0,264a24.00867,24.00867,0,0,0,24.00582,24H127.81618l-22.47457,22.46875c-11.36521,11.36133-12.99607,32.25781,0,45.25L156.24582,406.625c11.15623,11.1875,32.15619,13.15625,45.27726,0l22.47457-22.46875V488a24.00867,24.00867,0,0,0,24.00581,24,28.55934,28.55934,0,0,0,10.707-2.51562l98.72834-49.39063c14.62888-7.29687,26.50776-26.5,26.50776-42.85937V312.79688c72.59753-46.3125,128.03493-108.40626,128.03493-211.09376C512.07526,76.5,512.07526,51.29688,505.12019,19.09375ZM384.04033,168A40,40,0,1,1,424.05,128,40.02322,40.02322,0,0,1,384.04033,168Z"},child:[]}]})(e)}function U$(e){return sn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M352 320c-22.608 0-43.387 7.819-59.79 20.895l-102.486-64.054a96.551 96.551 0 0 0 0-41.683l102.486-64.054C308.613 184.181 329.392 192 352 192c53.019 0 96-42.981 96-96S405.019 0 352 0s-96 42.981-96 96c0 7.158.79 14.13 2.276 20.841L155.79 180.895C139.387 167.819 118.608 160 96 160c-53.019 0-96 42.981-96 96s42.981 96 96 96c22.608 0 43.387-7.819 59.79-20.895l102.486 64.054A96.301 96.301 0 0 0 256 416c0 53.019 42.981 96 96 96s96-42.981 96-96-42.981-96-96-96z"},child:[]}]})(e)}function Lce(e){return sn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M466.5 83.7l-192-80a48.15 48.15 0 0 0-36.9 0l-192 80C27.7 91.1 16 108.6 16 128c0 198.5 114.5 335.7 221.5 380.3 11.8 4.9 25.1 4.9 36.9 0C360.1 472.6 496 349.3 496 128c0-19.4-11.7-36.9-29.5-44.3zM256.1 446.3l-.1-381 175.9 73.3c-3.3 151.4-82.1 261.1-175.8 307.7z"},child:[]}]})(e)}function Fce(e){return sn({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 352h-16V243.9c0-12.7-5.1-24.9-14.1-33.9L494 110.1c-9-9-21.2-14.1-33.9-14.1H416V48c0-26.5-21.5-48-48-48H112C85.5 0 64 21.5 64 48v48H8c-4.4 0-8 3.6-8 8v16c0 4.4 3.6 8 8 8h272c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H40c-4.4 0-8 3.6-8 8v16c0 4.4 3.6 8 8 8h208c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H8c-4.4 0-8 3.6-8 8v16c0 4.4 3.6 8 8 8h208c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H64v128c0 53 43 96 96 96s96-43 96-96h128c0 53 43 96 96 96s96-43 96-96h48c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zM160 464c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm320 0c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm80-208H416V144h44.1l99.9 99.9V256z"},child:[]}]})(e)}function Bce(e){return sn({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M568.25 192c-29.04.13-135.01 6.16-213.84 83-33.12 29.63-53.36 63.3-66.41 94.86-13.05-31.56-33.29-65.23-66.41-94.86-78.83-76.84-184.8-82.87-213.84-83-4.41-.02-7.79 3.4-7.75 7.82.23 27.92 7.14 126.14 88.77 199.3C172.79 480.94 256 480 288 480s115.19.95 199.23-80.88c81.64-73.17 88.54-171.38 88.77-199.3.04-4.42-3.34-7.84-7.75-7.82zM287.98 302.6c12.82-18.85 27.6-35.78 44.09-50.52 19.09-18.61 39.58-33.3 60.26-45.18-16.44-70.5-51.72-133.05-96.73-172.22-4.11-3.58-11.02-3.58-15.14 0-44.99 39.14-80.27 101.63-96.74 172.07 20.37 11.7 40.5 26.14 59.22 44.39a282.768 282.768 0 0 1 45.04 51.46z"},child:[]}]})(e)}function LM(e){return sn({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"},child:[]}]})(e)}function Vce(e){return sn({attr:{viewBox:"0 0 616 512"},child:[{tag:"path",attr:{d:"M602 118.6L537.1 15C531.3 5.7 521 0 510 0H106C95 0 84.7 5.7 78.9 15L14 118.6c-33.5 53.5-3.8 127.9 58.8 136.4 4.5.6 9.1.9 13.7.9 29.6 0 55.8-13 73.8-33.1 18 20.1 44.3 33.1 73.8 33.1 29.6 0 55.8-13 73.8-33.1 18 20.1 44.3 33.1 73.8 33.1 29.6 0 55.8-13 73.8-33.1 18.1 20.1 44.3 33.1 73.8 33.1 4.7 0 9.2-.3 13.7-.9 62.8-8.4 92.6-82.8 59-136.4zM529.5 288c-10 0-19.9-1.5-29.5-3.8V384H116v-99.8c-9.6 2.2-19.5 3.8-29.5 3.8-6 0-12.1-.4-18-1.2-5.6-.8-11.1-2.1-16.4-3.6V480c0 17.7 14.3 32 32 32h448c17.7 0 32-14.3 32-32V283.2c-5.4 1.6-10.8 2.9-16.4 3.6-6.1.8-12.1 1.2-18.2 1.2z"},child:[]}]})(e)}function Uce(e){return sn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(e)}function $ce(e){return sn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"},child:[]}]})(e)}function $$(e){return sn({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(e)}function q$(e){return sn({attr:{viewBox:"0 0 416 512"},child:[{tag:"path",attr:{d:"M207.9 15.2c.8 4.7 16.1 94.5 16.1 128.8 0 52.3-27.8 89.6-68.9 104.6L168 486.7c.7 13.7-10.2 25.3-24 25.3H80c-13.7 0-24.7-11.5-24-25.3l12.9-238.1C27.7 233.6 0 196.2 0 144 0 109.6 15.3 19.9 16.1 15.2 19.3-5.1 61.4-5.4 64 16.3v141.2c1.3 3.4 15.1 3.2 16 0 1.4-25.3 7.9-139.2 8-141.8 3.3-20.8 44.7-20.8 47.9 0 .2 2.7 6.6 116.5 8 141.8.9 3.2 14.8 3.4 16 0V16.3c2.6-21.6 44.8-21.4 48-1.1zm119.2 285.7l-15 185.1c-1.2 14 9.9 26 23.9 26h56c13.3 0 24-10.7 24-24V24c0-13.2-10.7-24-24-24-82.5 0-221.4 178.5-64.9 300.9z"},child:[]}]})(e)}function qce(e){return sn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"},child:[]}]})(e)}function Hce(e){return sn({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm8-152c-13.2 0-24 10.8-24 24s10.8 24 24 24c23.8 0 46.3 10.5 61.6 28.8 8.1 9.8 23.2 11.9 33.8 3.1 10.2-8.5 11.6-23.6 3.1-33.8C330 320.8 294.1 304 256 304zm-88-64c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32zm160-64c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32-14.3-32-32-32zm-165.6 98.8C151 290.1 126 325.4 126 342.9c0 22.7 18.8 41.1 42 41.1s42-18.4 42-41.1c0-17.5-25-52.8-36.4-68.1-2.8-3.7-8.4-3.7-11.2 0z"},child:[]}]})(e)}function Kh({children:e,direction:t="up",duration:n=700,delay:r=0,once:l=!0,className:d=""}){const p=V.useRef(),[a,b]=V.useState(!1),E={up:"translate-y-6",down:"-translate-y-6",left:"translate-x-6",right:"-translate-x-6"}[t]||"translate-y-6";return V.useEffect(()=>{const P=new IntersectionObserver(([I])=>{I.isIntersecting&&(b(!0),l&&P.disconnect())},{threshold:.1});return p.current&&P.observe(p.current),()=>P.disconnect()},[l]),f.jsx("div",{ref:p,className:`
        transition-all ease-out
        duration-[${n}ms]
        delay-[${r}ms]
        ${a?"opacity-100 scale-100 translate-x-0 translate-y-0":`opacity-0 ${E} scale-95`}
        ${d}
      `,children:e})}function Gce(){return f.jsxs("footer",{className:"bg-[#FB8500] text-white mt-auto",children:[f.jsxs("div",{className:`\r
          max-w-7xl mx-auto px-6 py-12 \r
          grid \r
          grid-cols-2\r
          sm:grid-cols-2\r
          md:grid-cols-2\r
          lg:grid-cols-4\r
          gap-8 sm:gap-12\r
        `,children:[f.jsxs("div",{className:"space-y-3 border-white/20 pt-4 lg:border-t-0 lg:border-r lg:border-white/20 lg:pl-6 lg:pr-6",children:[f.jsx("h3",{className:"text-base font-bold uppercase tracking-wide",children:"Institucional"}),f.jsxs("ul",{className:"flex flex-col gap-2  text-xs",children:[f.jsx("li",{children:f.jsx(Wn,{to:"/about",className:"hover:underline",children:"Sobre nosotros"})}),f.jsx("li",{children:f.jsx(Wn,{to:"/contact",className:"hover:underline",children:"Contacto"})})]})]}),f.jsxs("div",{className:"space-y-3  border-white/20 pt-4 lg:border-t-0 lg:border-r lg:border-white/20 lg:pl-6 lg:pr-6",children:[f.jsx("h3",{className:"text-base font-bold uppercase tracking-wide",children:"Legal"}),f.jsxs("ul",{className:"flex flex-col gap-2  text-xs",children:[f.jsx("li",{children:f.jsx(Wn,{to:"/legal-privacy",className:"hover:underline",children:"Privacidad"})}),f.jsx("li",{children:f.jsx(Wn,{to:"/legal-terms",className:"hover:underline",children:"Términos"})})]})]}),f.jsxs("div",{className:"space-y-3 pt-4  border-t lg:border-t-0 border-white/20 lg:border-r lg:pr-6",children:[f.jsx("h3",{className:"text-base font-bold uppercase tracking-wide",children:"Navegación"}),f.jsx("ul",{className:"flex flex-col gap-2  text-xs",children:[{to:"/",label:"Inicio"},{to:"/negocios",label:"Negocios"},{to:"/eventos",label:"Eventos"},{to:"/comunidades",label:"Comunidades"},{to:"/promociones",label:"Promos"}].map(e=>f.jsxs("li",{className:"flex items-center gap-2",children:[f.jsx(gce,{className:"text-xs"}),f.jsx(Wn,{to:e.to,className:"hover:underline",children:e.label})]},e.to))})]}),f.jsxs("div",{className:"space-y-3 border-t border-white/20 pt-4 lg:border-t-0  lg:pl-6",children:[f.jsx("h3",{className:"text-base font-bold uppercase tracking-wide",children:"Síguenos"}),f.jsx("p",{className:"  text-xs leading-snug max-w-xs",children:"Conectá con nosotros en redes."}),f.jsxs("div",{className:"flex gap-3 flex-wrap pt-1",children:[f.jsx("a",{href:"https://www.facebook.com/profile.php?id=61576800572394",target:"_blank",rel:"noreferrer","aria-label":"Facebook",className:"hover:opacity-80",children:f.jsx(pce,{className:"text-white  text-lg"})}),f.jsx("a",{href:"https://www.tiktok.com/@comunnidades_latino?lang=en",target:"_blank",rel:"noreferrer","aria-label":"TikTok",className:"hover:opacity-80",children:f.jsx(N$,{className:"text-white  text-lg"})}),f.jsx("a",{href:"https://www.instagram.com/communidades_/",target:"_blank",rel:"noreferrer","aria-label":"Instagram",className:"hover:opacity-80",children:f.jsx(mce,{className:"text-white  text-lg"})})]}),f.jsx("p",{className:"text-xs text-white/80 italic hidden md:block",children:'"Unidos creamos comunidad y compartimos cultura."'})]})]}),f.jsx("div",{className:"border-t border-white/20 my-4 mx-6"}),f.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-center max-w-7xl mx-auto px-6 py-4 gap-3",children:[f.jsx(Kh,{direction:"up",duration:600,delay:150,children:f.jsx("div",{className:"bg-[#141414] hidden md:flex rounded-md p-1.5 items-center shadow-md",children:f.jsx("img",{src:xce,alt:"Communidades logo",className:"h-4 md:h-5"})})}),f.jsx(Kh,{direction:"down",duration:600,delay:200,children:f.jsx("div",{className:"bg-black md:hidden flex rounded-md p-1.5 items-center shadow-md transition-transform duration-300 hover:scale-105",children:f.jsx("img",{src:yce,alt:"Communidades logo",className:"h-15"})})}),f.jsxs("div",{className:"text-center text-xs font-light text-white/70 md:text-right",children:["© ",new Date().getFullYear()," communidades. Todos los derechos reservados."]})]})]})}function hz({image:e,desktopImage:t,tabletImage:n,mobileImage:r,link:l,className:d="",imgClassName:p="",target:a="_blank",rel:b="noopener noreferrer",ariaLabel:T="Publicidad",onClick:E,sizes:P="100vw",loading:I="lazy",decoding:R="async"}){const F=e||t||n||r||"",W=f.jsxs("picture",{className:"block w-full h-full",children:[t&&f.jsx("source",{media:"(min-width: 1024px)",srcSet:t,sizes:P}),n&&f.jsx("source",{media:"(min-width: 640px)",srcSet:n,sizes:P}),r&&f.jsx("source",{media:"(max-width: 639px)",srcSet:r,sizes:P}),f.jsx("img",{src:F,alt:T,className:`max-h-full max-w-full object-contain w-full h-full ${p}`,loading:I,decoding:R})]});return l?f.jsx("a",{href:l,target:a,rel:b,className:`ads-banner block  transition p-0 ${d}`,onClick:E,"aria-label":T,children:W}):f.jsx("div",{className:`ads-banner block  transition p-0 ${d}`,"aria-label":T,children:W})}const qC={home_top:{title:"¡Anúnciate en Communidades!",imageUrl:"/fallbacks/home_top.png",redirectUrl:"https://communidades.com/anunciate",imageAlt:"Anúnciate aquí",_id:"fb-home_top",isFallback:!0}},Lv=new Map;function Wce({clientId:e,adUnit:t,style:n}){const r=V.useRef(null);return V.useEffect(()=>{if(!window.__adsense_loaded__){const d=document.createElement("script");d.async=!0,d.src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js",d.setAttribute("data-ad-client",e),d.setAttribute("crossorigin","anonymous"),document.head.appendChild(d),window.__adsense_loaded__=!0}const l=setInterval(()=>{if(window.adsbygoogle&&r.current)try{(window.adsbygoogle=window.adsbygoogle||[]).push({}),clearInterval(l)}catch{}},300);return()=>clearInterval(l)},[e]),f.jsx("ins",{ref:r,className:"adsbygoogle",style:n||{display:"block",width:"100%"},"data-ad-client":e,"data-ad-slot":t,"data-ad-format":"auto","data-full-width-responsive":"true"})}function fz(e){return(e==null?void 0:e.banners)??(e==null?void 0:e.ads)??(e==null?void 0:e.data)??[]}function FM({placement:e,communityId:t,categoryId:n,businessId:r,adUnit:l,enableGoogleAds:d=!0,adsenseClient:p="ca-pub-XXXXXXXXXXXXXXX",className:a="",containerStyle:b,imgClassName:T="",openInNewTabDefault:E=!0,askDbFallbackIfNoAds:P=!0,fixedHeight:I=null}){var qe,tt,nt,bt,jt,Nt,vt;const[R,F]=V.useState(null),[W,$]=V.useState(!1),Z=ln(He=>{var ut,Tt;return(Tt=(ut=He.comunidadSeleccionada)==null?void 0:ut.comunidad)==null?void 0:Tt._id}),ne=t??Z??null,ie=V.useMemo(()=>JSON.stringify({placement:e,communityId:ne||null,categoryId:n||null,businessId:r||null,adUnit:l||null,askDbFallbackIfNoAds:!!P,enableGoogleAds:!!d,adsenseClient:p||null}),[e,ne,n,r,l,P,d,p]),ge=V.useMemo(()=>`banner-${e}-${Math.random().toString(36).slice(2)}`,[e]),ae=typeof I=="number"?`${I}px`:typeof I=="string"?I:null,se=ae?{height:ae,maxHeight:ae,...b}:b,me=V.useRef(0);if(V.useEffect(()=>{let He=!0;const ut=++me.current;if(Lv.has(ie)){const ot=Lv.get(ie);if(ot==="google"){He&&ut===me.current&&$(!0);return}if(ot==="static"){He&&ut===me.current&&($(!1),F(qC[e]||null));return}if(ot){He&&ut===me.current&&($(!1),F(ot));return}}const Tt={placement:e,limit:1,strategy:"weighted",...ne?{communityId:ne}:{},...n?{categoryId:n}:{},...r?{businessId:r}:{}},Yt=async()=>{try{const{data:ot}=await Rn.get("ads/active",{params:{...Tt,includeFallback:"false"},headers:{"Cache-Control":"no-cache"}});if(!He||ut!==me.current)return!1;const It=fz(ot)[0];return It?(Lv.set(ie,It),$(!1),F(It),!0):!1}catch{return!1}},Ge=async()=>{if(!P)return!1;try{const{data:ot}=await Rn.get("ads/active",{params:{...Tt,includeFallback:"true"},headers:{"Cache-Control":"no-cache"}});if(!He||ut!==me.current)return!1;const It=fz(ot)[0];return It?(Lv.set(ie,It),$(!1),F(It),!0):!1}catch{return!1}};return(async()=>{if(!await Yt()&&!await Ge()){if(d&&p&&l){Lv.set(ie,"google"),He&&ut===me.current&&$(!0);return}Lv.set(ie,"static"),He&&ut===me.current&&($(!1),F(qC[e]||null))}})(),()=>{He=!1}},[ie,e,ne,n,r,d,p,l,P]),V.useEffect(()=>{if(!(R!=null&&R._id)||R!=null&&R.isFallback)return;const He=document.getElementById(ge);if(!He)return;let ut=!1;const Tt=new IntersectionObserver(Yt=>{Yt.forEach(Ge=>{Ge.isIntersecting&&!ut&&(ut=!0,Rn.post(`ads/banners/${R._id}/track?type=impression`).catch(()=>{}),Tt.disconnect())})},{threshold:.5});return Tt.observe(He),()=>Tt.disconnect()},[R,ge,e]),R){const He=R.imageDesktopUrl||((qe=R.sources)==null?void 0:qe.desktop)||R.imageUrl||((tt=R.sources)==null?void 0:tt.default)||null,ut=R.imageTabletUrl||((nt=R.sources)==null?void 0:nt.tablet)||R.imageUrl||((bt=R.sources)==null?void 0:bt.default)||null,Tt=R.imageMobileUrl||((jt=R.sources)==null?void 0:jt.mobile)||R.imageUrl||((Nt=R.sources)==null?void 0:Nt.default)||null,Yt=R.imageUrl||((vt=R.sources)==null?void 0:vt.default)||He||ut||Tt||null,Ge=typeof R.openInNewTab=="boolean"?R.openInNewTab?"_blank":"_self":E?"_blank":"_self";return f.jsx("div",{id:ge,className:a,style:se,children:f.jsx("div",{className:"h-full w-full overflow-hidden flex items-center justify-center",children:f.jsx(hz,{image:Yt,desktopImage:He,tabletImage:ut,mobileImage:Tt,link:R.redirectUrl,className:"h-full w-full",imgClassName:`h-full w-full object-contain ${T||""}`,target:Ge,ariaLabel:R.imageAlt||R.title,onClick:()=>{!R.isFallback&&R._id&&Rn.post(`ads/banners/${R._id}/track?type=click`).catch(()=>{})}})})})}if(W)return f.jsx("div",{id:ge,className:a,style:se,children:f.jsx("div",{className:"max-h-[116px] w-full overflow-hidden",children:f.jsx(Wce,{clientId:p,adUnit:l,style:{display:"block",width:"100%",...ae?{height:ae,maxHeight:ae}:{}}})})});const ke=qC[e];return ke?f.jsx("div",{id:ge,className:a,style:se,children:f.jsx("div",{className:"max-h-[116px] w-full overflow-hidden flex items-center justify-center",children:f.jsx(hz,{image:ke.imageUrl,link:ke.redirectUrl,className:"max-h-[116px] w-full",imgClassName:`max-h-[116px] w-full object-contain ${T||""}`})})}):null}function Zce({communityId:e}){return f.jsx("aside",{className:"hidden lg:flex flex-col w-[300px] min-h-full gap-6 lg:w-[200px] xl:w-[240px] 2xl:w-[280px]",children:[0,1].map(t=>f.jsx("div",{className:"flex-1 min-h-screen relative",children:f.jsx("div",{className:"sticky top-[120px] p-2",children:f.jsx(FM,{placement:t===0?"sidebar_right_1":"sidebar_right_2",communityId:e,adUnit:t===0?"1234567892":"1234567893",enableGoogleAds:!0,className:"bg-gradient-to-r from-[#fff7ec] to-[#f3e8ff]   shadow-2xl",containerStyle:{minHeight:"250px"},fixedHeight:"250px",imgClassName:"max-h-[246px] "})})},t))})}function Xce(){return V.useEffect(()=>{const e={essential:!0,analytics:!0,ads:!0};localStorage.setItem("cookiePrefs",JSON.stringify(e)),window.gtag&&window.gtag("consent","update",{ad_storage:"granted",analytics_storage:"granted"})},[]),null}function Kce(){const e=br(),{coords:t,cargando:n}=ln(p=>p.ubicacion),r=V.useRef(!1),l=V.useRef(!1);V.useEffect(()=>{!t&&!n&&e(Ob())},[e,t,n]);const d=()=>t?{lat:t.lat,lng:t.lng}:{};V.useEffect(()=>{if(r.current)return;r.current=!0;const p=d();e(Yf({...p,page:1,force:!0})),e(Kg({...p,page:1,force:!0})),e(zd({...p,page:1,force:!0}))},[e]),V.useEffect(()=>{if(!t||l.current)return;l.current=!0;const p={lat:t.lat,lng:t.lng};e(Yf({...p,page:1,force:!0})),e(Kg({...p,page:1,force:!0})),e(zd({...p,page:1,force:!0}))},[t,e])}function fy(e){"@babel/helpers - typeof";return fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fy(e)}function Yce(e,t){if(fy(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(fy(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function H$(e){var t=Yce(e,"string");return fy(t)=="symbol"?t:t+""}function bb(e,t,n){return(t=H$(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function Xr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pz(Object(n),!0).forEach(function(r){bb(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pz(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Qce(e){if(Array.isArray(e))return e}function Jce(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,l,d,p,a=[],b=!0,T=!1;try{if(d=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;b=!1}else for(;!(b=(r=d.call(n)).done)&&(a.push(r.value),a.length!==t);b=!0);}catch(E){T=!0,l=E}finally{try{if(!b&&n.return!=null&&(p=n.return(),Object(p)!==p))return}finally{if(T)throw l}}return a}}function BM(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function G$(e,t){if(e){if(typeof e=="string")return BM(e,t);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?BM(e,t):void 0}}function eue(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Am(e,t){return Qce(e)||Jce(e,t)||G$(e,t)||eue()}function tue(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function zm(e,t){if(e==null)return{};var n,r,l=tue(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var nue=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function rue(e){var t=e.defaultInputValue,n=t===void 0?"":t,r=e.defaultMenuIsOpen,l=r===void 0?!1:r,d=e.defaultValue,p=d===void 0?null:d,a=e.inputValue,b=e.menuIsOpen,T=e.onChange,E=e.onInputChange,P=e.onMenuClose,I=e.onMenuOpen,R=e.value,F=zm(e,nue),W=V.useState(a!==void 0?a:n),$=Am(W,2),Z=$[0],ne=$[1],ie=V.useState(b!==void 0?b:l),ge=Am(ie,2),ae=ge[0],se=ge[1],me=V.useState(R!==void 0?R:p),ke=Am(me,2),qe=ke[0],tt=ke[1],nt=V.useCallback(function(Tt,Yt){typeof T=="function"&&T(Tt,Yt),tt(Tt)},[T]),bt=V.useCallback(function(Tt,Yt){var Ge;typeof E=="function"&&(Ge=E(Tt,Yt)),ne(Ge!==void 0?Ge:Tt)},[E]),jt=V.useCallback(function(){typeof I=="function"&&I(),se(!0)},[I]),Nt=V.useCallback(function(){typeof P=="function"&&P(),se(!1)},[P]),vt=a!==void 0?a:Z,He=b!==void 0?b:ae,ut=R!==void 0?R:qe;return Xr(Xr({},F),{},{inputValue:vt,menuIsOpen:He,onChange:nt,onInputChange:bt,onMenuClose:Nt,onMenuOpen:jt,value:ut})}function ri(){return ri=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ri.apply(null,arguments)}function iue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mz(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,H$(r.key),r)}}function aue(e,t,n){return t&&mz(e.prototype,t),n&&mz(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function VM(e,t){return VM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},VM(e,t)}function sue(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VM(e,t)}function UT(e){return UT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},UT(e)}function W$(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(W$=function(){return!!e})()}function oue(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lue(e,t){if(t&&(fy(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oue(e)}function cue(e){var t=W$();return function(){var n,r=UT(e);if(t){var l=UT(this).constructor;n=Reflect.construct(r,arguments,l)}else n=r.apply(this,arguments);return lue(this,n)}}function uue(e){if(Array.isArray(e))return BM(e)}function due(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function hue(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GP(e){return uue(e)||due(e)||G$(e)||hue()}function fue(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function pue(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var mue=function(){function e(n){var r=this;this._insertTag=function(l){var d;r.tags.length===0?r.insertionPoint?d=r.insertionPoint.nextSibling:r.prepend?d=r.container.firstChild:d=r.before:d=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(l,d),r.tags.push(l)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(r){r.forEach(this._insertTag)},t.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(pue(this));var l=this.tags[this.tags.length-1];if(this.isSpeedy){var d=fue(l);try{d.insertRule(r,d.cssRules.length)}catch{}}else l.appendChild(document.createTextNode(r));this.ctr++},t.flush=function(){this.tags.forEach(function(r){var l;return(l=r.parentNode)==null?void 0:l.removeChild(r)}),this.tags=[],this.ctr=0},e}(),Vl="-ms-",$T="-moz-",va="-webkit-",Z$="comm",WP="rule",ZP="decl",gue="@import",X$="@keyframes",xue="@layer",yue=Math.abs,u3=String.fromCharCode,vue=Object.assign;function _ue(e,t){return gl(e,0)^45?(((t<<2^gl(e,0))<<2^gl(e,1))<<2^gl(e,2))<<2^gl(e,3):0}function K$(e){return e.trim()}function bue(e,t){return(e=t.exec(e))?e[0]:e}function _a(e,t,n){return e.replace(t,n)}function UM(e,t){return e.indexOf(t)}function gl(e,t){return e.charCodeAt(t)|0}function nw(e,t,n){return e.slice(t,n)}function Zf(e){return e.length}function XP(e){return e.length}function wS(e,t){return t.push(e),e}function wue(e,t){return e.map(t).join("")}var d3=1,u_=1,Y$=0,Wc=0,ho=0,E_="";function h3(e,t,n,r,l,d,p){return{value:e,root:t,parent:n,type:r,props:l,children:d,line:d3,column:u_,length:p,return:""}}function nb(e,t){return vue(h3("",null,null,"",null,null,0),e,{length:-e.length},t)}function Sue(){return ho}function Tue(){return ho=Wc>0?gl(E_,--Wc):0,u_--,ho===10&&(u_=1,d3--),ho}function Ru(){return ho=Wc<Y$?gl(E_,Wc++):0,u_++,ho===10&&(u_=1,d3++),ho}function Jf(){return gl(E_,Wc)}function cT(){return Wc}function kw(e,t){return nw(E_,e,t)}function rw(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Q$(e){return d3=u_=1,Y$=Zf(E_=e),Wc=0,[]}function J$(e){return E_="",e}function uT(e){return K$(kw(Wc-1,$M(e===91?e+2:e===40?e+1:e)))}function Eue(e){for(;(ho=Jf())&&ho<33;)Ru();return rw(e)>2||rw(ho)>3?"":" "}function Aue(e,t){for(;--t&&Ru()&&!(ho<48||ho>102||ho>57&&ho<65||ho>70&&ho<97););return kw(e,cT()+(t<6&&Jf()==32&&Ru()==32))}function $M(e){for(;Ru();)switch(ho){case e:return Wc;case 34:case 39:e!==34&&e!==39&&$M(ho);break;case 40:e===41&&$M(e);break;case 92:Ru();break}return Wc}function Cue(e,t){for(;Ru()&&e+ho!==57;)if(e+ho===84&&Jf()===47)break;return"/*"+kw(t,Wc-1)+"*"+u3(e===47?e:Ru())}function jue(e){for(;!rw(Jf());)Ru();return kw(e,Wc)}function Mue(e){return J$(dT("",null,null,null,[""],e=Q$(e),0,[0],e))}function dT(e,t,n,r,l,d,p,a,b){for(var T=0,E=0,P=p,I=0,R=0,F=0,W=1,$=1,Z=1,ne=0,ie="",ge=l,ae=d,se=r,me=ie;$;)switch(F=ne,ne=Ru()){case 40:if(F!=108&&gl(me,P-1)==58){UM(me+=_a(uT(ne),"&","&\f"),"&\f")!=-1&&(Z=-1);break}case 34:case 39:case 91:me+=uT(ne);break;case 9:case 10:case 13:case 32:me+=Eue(F);break;case 92:me+=Aue(cT()-1,7);continue;case 47:switch(Jf()){case 42:case 47:wS(Pue(Cue(Ru(),cT()),t,n),b);break;default:me+="/"}break;case 123*W:a[T++]=Zf(me)*Z;case 125*W:case 59:case 0:switch(ne){case 0:case 125:$=0;case 59+E:Z==-1&&(me=_a(me,/\f/g,"")),R>0&&Zf(me)-P&&wS(R>32?xz(me+";",r,n,P-1):xz(_a(me," ","")+";",r,n,P-2),b);break;case 59:me+=";";default:if(wS(se=gz(me,t,n,T,E,l,a,ie,ge=[],ae=[],P),d),ne===123)if(E===0)dT(me,t,se,se,ge,d,P,a,ae);else switch(I===99&&gl(me,3)===110?100:I){case 100:case 108:case 109:case 115:dT(e,se,se,r&&wS(gz(e,se,se,0,0,l,a,ie,l,ge=[],P),ae),l,ae,P,a,r?ge:ae);break;default:dT(me,se,se,se,[""],ae,0,a,ae)}}T=E=R=0,W=Z=1,ie=me="",P=p;break;case 58:P=1+Zf(me),R=F;default:if(W<1){if(ne==123)--W;else if(ne==125&&W++==0&&Tue()==125)continue}switch(me+=u3(ne),ne*W){case 38:Z=E>0?1:(me+="\f",-1);break;case 44:a[T++]=(Zf(me)-1)*Z,Z=1;break;case 64:Jf()===45&&(me+=uT(Ru())),I=Jf(),E=P=Zf(ie=me+=jue(cT())),ne++;break;case 45:F===45&&Zf(me)==2&&(W=0)}}return d}function gz(e,t,n,r,l,d,p,a,b,T,E){for(var P=l-1,I=l===0?d:[""],R=XP(I),F=0,W=0,$=0;F<r;++F)for(var Z=0,ne=nw(e,P+1,P=yue(W=p[F])),ie=e;Z<R;++Z)(ie=K$(W>0?I[Z]+" "+ne:_a(ne,/&\f/g,I[Z])))&&(b[$++]=ie);return h3(e,t,n,l===0?WP:a,b,T,E)}function Pue(e,t,n){return h3(e,t,n,Z$,u3(Sue()),nw(e,2,-2),0)}function xz(e,t,n,r){return h3(e,t,n,ZP,nw(e,0,r),nw(e,r+1,-1),r)}function a_(e,t){for(var n="",r=XP(e),l=0;l<r;l++)n+=t(e[l],l,e,t)||"";return n}function Nue(e,t,n,r){switch(e.type){case xue:if(e.children.length)break;case gue:case ZP:return e.return=e.return||e.value;case Z$:return"";case X$:return e.return=e.value+"{"+a_(e.children,r)+"}";case WP:e.value=e.props.join(",")}return Zf(n=a_(e.children,r))?e.return=e.value+"{"+n+"}":""}function Due(e){var t=XP(e);return function(n,r,l,d){for(var p="",a=0;a<t;a++)p+=e[a](n,r,l,d)||"";return p}}function Oue(e){return function(t){t.root||(t=t.return)&&e(t)}}function Iue(e){var t=Object.create(null);return function(n){return t[n]===void 0&&(t[n]=e(n)),t[n]}}var kue=function(t,n,r){for(var l=0,d=0;l=d,d=Jf(),l===38&&d===12&&(n[r]=1),!rw(d);)Ru();return kw(t,Wc)},Rue=function(t,n){var r=-1,l=44;do switch(rw(l)){case 0:l===38&&Jf()===12&&(n[r]=1),t[r]+=kue(Wc-1,n,r);break;case 2:t[r]+=uT(l);break;case 4:if(l===44){t[++r]=Jf()===58?"&\f":"",n[r]=t[r].length;break}default:t[r]+=u3(l)}while(l=Ru());return t},zue=function(t,n){return J$(Rue(Q$(t),n))},yz=new WeakMap,Lue=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var n=t.value,r=t.parent,l=t.column===r.column&&t.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(t.props.length===1&&n.charCodeAt(0)!==58&&!yz.get(r))&&!l){yz.set(t,!0);for(var d=[],p=zue(n,d),a=r.props,b=0,T=0;b<p.length;b++)for(var E=0;E<a.length;E++,T++)t.props[T]=d[b]?p[b].replace(/&\f/g,a[E]):a[E]+" "+p[b]}}},Fue=function(t){if(t.type==="decl"){var n=t.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(t.return="",t.value="")}};function eq(e,t){switch(_ue(e,t)){case 5103:return va+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return va+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return va+e+$T+e+Vl+e+e;case 6828:case 4268:return va+e+Vl+e+e;case 6165:return va+e+Vl+"flex-"+e+e;case 5187:return va+e+_a(e,/(\w+).+(:[^]+)/,va+"box-$1$2"+Vl+"flex-$1$2")+e;case 5443:return va+e+Vl+"flex-item-"+_a(e,/flex-|-self/,"")+e;case 4675:return va+e+Vl+"flex-line-pack"+_a(e,/align-content|flex-|-self/,"")+e;case 5548:return va+e+Vl+_a(e,"shrink","negative")+e;case 5292:return va+e+Vl+_a(e,"basis","preferred-size")+e;case 6060:return va+"box-"+_a(e,"-grow","")+va+e+Vl+_a(e,"grow","positive")+e;case 4554:return va+_a(e,/([^-])(transform)/g,"$1"+va+"$2")+e;case 6187:return _a(_a(_a(e,/(zoom-|grab)/,va+"$1"),/(image-set)/,va+"$1"),e,"")+e;case 5495:case 3959:return _a(e,/(image-set\([^]*)/,va+"$1$`$1");case 4968:return _a(_a(e,/(.+:)(flex-)?(.*)/,va+"box-pack:$3"+Vl+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+va+e+e;case 4095:case 3583:case 4068:case 2532:return _a(e,/(.+)-inline(.+)/,va+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Zf(e)-1-t>6)switch(gl(e,t+1)){case 109:if(gl(e,t+4)!==45)break;case 102:return _a(e,/(.+:)(.+)-([^]+)/,"$1"+va+"$2-$3$1"+$T+(gl(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~UM(e,"stretch")?eq(_a(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(gl(e,t+1)!==115)break;case 6444:switch(gl(e,Zf(e)-3-(~UM(e,"!important")&&10))){case 107:return _a(e,":",":"+va)+e;case 101:return _a(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+va+(gl(e,14)===45?"inline-":"")+"box$3$1"+va+"$2$3$1"+Vl+"$2box$3")+e}break;case 5936:switch(gl(e,t+11)){case 114:return va+e+Vl+_a(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return va+e+Vl+_a(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return va+e+Vl+_a(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return va+e+Vl+e+e}return e}var Bue=function(t,n,r,l){if(t.length>-1&&!t.return)switch(t.type){case ZP:t.return=eq(t.value,t.length);break;case X$:return a_([nb(t,{value:_a(t.value,"@","@"+va)})],l);case WP:if(t.length)return wue(t.props,function(d){switch(bue(d,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return a_([nb(t,{props:[_a(d,/:(read-\w+)/,":"+$T+"$1")]})],l);case"::placeholder":return a_([nb(t,{props:[_a(d,/:(plac\w+)/,":"+va+"input-$1")]}),nb(t,{props:[_a(d,/:(plac\w+)/,":"+$T+"$1")]}),nb(t,{props:[_a(d,/:(plac\w+)/,Vl+"input-$1")]})],l)}return""})}},Vue=[Bue],Uue=function(t){var n=t.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(W){var $=W.getAttribute("data-emotion");$.indexOf(" ")!==-1&&(document.head.appendChild(W),W.setAttribute("data-s",""))})}var l=t.stylisPlugins||Vue,d={},p,a=[];p=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(W){for(var $=W.getAttribute("data-emotion").split(" "),Z=1;Z<$.length;Z++)d[$[Z]]=!0;a.push(W)});var b,T=[Lue,Fue];{var E,P=[Nue,Oue(function(W){E.insert(W)})],I=Due(T.concat(l,P)),R=function($){return a_(Mue($),I)};b=function($,Z,ne,ie){E=ne,R($?$+"{"+Z.styles+"}":Z.styles),ie&&(F.inserted[Z.name]=!0)}}var F={key:n,sheet:new mue({key:n,container:p,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:d,registered:{},insert:b};return F.sheet.hydrate(a),F},HC={exports:{}},Aa={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vz;function $ue(){if(vz)return Aa;vz=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,n=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,l=e?Symbol.for("react.strict_mode"):60108,d=e?Symbol.for("react.profiler"):60114,p=e?Symbol.for("react.provider"):60109,a=e?Symbol.for("react.context"):60110,b=e?Symbol.for("react.async_mode"):60111,T=e?Symbol.for("react.concurrent_mode"):60111,E=e?Symbol.for("react.forward_ref"):60112,P=e?Symbol.for("react.suspense"):60113,I=e?Symbol.for("react.suspense_list"):60120,R=e?Symbol.for("react.memo"):60115,F=e?Symbol.for("react.lazy"):60116,W=e?Symbol.for("react.block"):60121,$=e?Symbol.for("react.fundamental"):60117,Z=e?Symbol.for("react.responder"):60118,ne=e?Symbol.for("react.scope"):60119;function ie(ae){if(typeof ae=="object"&&ae!==null){var se=ae.$$typeof;switch(se){case t:switch(ae=ae.type,ae){case b:case T:case r:case d:case l:case P:return ae;default:switch(ae=ae&&ae.$$typeof,ae){case a:case E:case F:case R:case p:return ae;default:return se}}case n:return se}}}function ge(ae){return ie(ae)===T}return Aa.AsyncMode=b,Aa.ConcurrentMode=T,Aa.ContextConsumer=a,Aa.ContextProvider=p,Aa.Element=t,Aa.ForwardRef=E,Aa.Fragment=r,Aa.Lazy=F,Aa.Memo=R,Aa.Portal=n,Aa.Profiler=d,Aa.StrictMode=l,Aa.Suspense=P,Aa.isAsyncMode=function(ae){return ge(ae)||ie(ae)===b},Aa.isConcurrentMode=ge,Aa.isContextConsumer=function(ae){return ie(ae)===a},Aa.isContextProvider=function(ae){return ie(ae)===p},Aa.isElement=function(ae){return typeof ae=="object"&&ae!==null&&ae.$$typeof===t},Aa.isForwardRef=function(ae){return ie(ae)===E},Aa.isFragment=function(ae){return ie(ae)===r},Aa.isLazy=function(ae){return ie(ae)===F},Aa.isMemo=function(ae){return ie(ae)===R},Aa.isPortal=function(ae){return ie(ae)===n},Aa.isProfiler=function(ae){return ie(ae)===d},Aa.isStrictMode=function(ae){return ie(ae)===l},Aa.isSuspense=function(ae){return ie(ae)===P},Aa.isValidElementType=function(ae){return typeof ae=="string"||typeof ae=="function"||ae===r||ae===T||ae===d||ae===l||ae===P||ae===I||typeof ae=="object"&&ae!==null&&(ae.$$typeof===F||ae.$$typeof===R||ae.$$typeof===p||ae.$$typeof===a||ae.$$typeof===E||ae.$$typeof===$||ae.$$typeof===Z||ae.$$typeof===ne||ae.$$typeof===W)},Aa.typeOf=ie,Aa}var _z;function tq(){return _z||(_z=1,HC.exports=$ue()),HC.exports}var GC,bz;function que(){if(bz)return GC;bz=1;var e=tq(),t={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},n={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},l={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},d={};d[e.ForwardRef]=r,d[e.Memo]=l;function p(F){return e.isMemo(F)?l:d[F.$$typeof]||t}var a=Object.defineProperty,b=Object.getOwnPropertyNames,T=Object.getOwnPropertySymbols,E=Object.getOwnPropertyDescriptor,P=Object.getPrototypeOf,I=Object.prototype;function R(F,W,$){if(typeof W!="string"){if(I){var Z=P(W);Z&&Z!==I&&R(F,Z,$)}var ne=b(W);T&&(ne=ne.concat(T(W)));for(var ie=p(F),ge=p(W),ae=0;ae<ne.length;++ae){var se=ne[ae];if(!n[se]&&!($&&$[se])&&!(ge&&ge[se])&&!(ie&&ie[se])){var me=E(W,se);try{a(F,se,me)}catch{}}}}return F}return GC=R,GC}var Hue=que();const Gue=Gs(Hue);var Wue=!0;function Zue(e,t,n){var r="";return n.split(" ").forEach(function(l){e[l]!==void 0?t.push(e[l]+";"):l&&(r+=l+" ")}),r}var nq=function(t,n,r){var l=t.key+"-"+n.name;(r===!1||Wue===!1)&&t.registered[l]===void 0&&(t.registered[l]=n.styles)},Xue=function(t,n,r){nq(t,n,r);var l=t.key+"-"+n.name;if(t.inserted[n.name]===void 0){var d=n;do t.insert(n===d?"."+l:"",d,t.sheet,!0),d=d.next;while(d!==void 0)}};function Kue(e){for(var t=0,n,r=0,l=e.length;l>=4;++r,l-=4)n=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(l){case 3:t^=(e.charCodeAt(r+2)&255)<<16;case 2:t^=(e.charCodeAt(r+1)&255)<<8;case 1:t^=e.charCodeAt(r)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var Yue={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Que=/[A-Z]|^ms/g,Jue=/_EMO_([^_]+?)_([^]*?)_EMO_/g,rq=function(t){return t.charCodeAt(1)===45},wz=function(t){return t!=null&&typeof t!="boolean"},WC=Iue(function(e){return rq(e)?e:e.replace(Que,"-$&").toLowerCase()}),Sz=function(t,n){switch(t){case"animation":case"animationName":if(typeof n=="string")return n.replace(Jue,function(r,l,d){return Xf={name:l,styles:d,next:Xf},l})}return Yue[t]!==1&&!rq(t)&&typeof n=="number"&&n!==0?n+"px":n};function iw(e,t,n){if(n==null)return"";var r=n;if(r.__emotion_styles!==void 0)return r;switch(typeof n){case"boolean":return"";case"object":{var l=n;if(l.anim===1)return Xf={name:l.name,styles:l.styles,next:Xf},l.name;var d=n;if(d.styles!==void 0){var p=d.next;if(p!==void 0)for(;p!==void 0;)Xf={name:p.name,styles:p.styles,next:Xf},p=p.next;var a=d.styles+";";return a}return ede(e,t,n)}case"function":{if(e!==void 0){var b=Xf,T=n(e);return Xf=b,iw(e,t,T)}break}}var E=n;return E}function ede(e,t,n){var r="";if(Array.isArray(n))for(var l=0;l<n.length;l++)r+=iw(e,t,n[l])+";";else for(var d in n){var p=n[d];if(typeof p!="object"){var a=p;wz(a)&&(r+=WC(d)+":"+Sz(d,a)+";")}else if(Array.isArray(p)&&typeof p[0]=="string"&&t==null)for(var b=0;b<p.length;b++)wz(p[b])&&(r+=WC(d)+":"+Sz(d,p[b])+";");else{var T=iw(e,t,p);switch(d){case"animation":case"animationName":{r+=WC(d)+":"+T+";";break}default:r+=d+"{"+T+"}"}}}return r}var Tz=/label:\s*([^\s;{]+)\s*(;|$)/g,Xf;function iq(e,t,n){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var r=!0,l="";Xf=void 0;var d=e[0];if(d==null||d.raw===void 0)r=!1,l+=iw(n,t,d);else{var p=d;l+=p[0]}for(var a=1;a<e.length;a++)if(l+=iw(n,t,e[a]),r){var b=d;l+=b[a]}Tz.lastIndex=0;for(var T="",E;(E=Tz.exec(l))!==null;)T+="-"+E[1];var P=Kue(l)+T;return{name:P,styles:l,next:Xf}}var tde=function(t){return t()},nde=bR.useInsertionEffect?bR.useInsertionEffect:!1,rde=nde||tde,aq=V.createContext(typeof HTMLElement<"u"?Uue({key:"css"}):null);aq.Provider;var ide=function(t){return V.forwardRef(function(n,r){var l=V.useContext(aq);return t(n,l,r)})},ade=V.createContext({}),KP={}.hasOwnProperty,qM="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",sde=function(t,n){var r={};for(var l in n)KP.call(n,l)&&(r[l]=n[l]);return r[qM]=t,r},ode=function(t){var n=t.cache,r=t.serialized,l=t.isStringTag;return nq(n,r,l),rde(function(){return Xue(n,r,l)}),null},lde=ide(function(e,t,n){var r=e.css;typeof r=="string"&&t.registered[r]!==void 0&&(r=t.registered[r]);var l=e[qM],d=[r],p="";typeof e.className=="string"?p=Zue(t.registered,d,e.className):e.className!=null&&(p=e.className+" ");var a=iq(d,void 0,V.useContext(ade));p+=t.key+"-"+a.name;var b={};for(var T in e)KP.call(e,T)&&T!=="css"&&T!==qM&&(b[T]=e[T]);return b.className=p,n&&(b.ref=n),V.createElement(V.Fragment,null,V.createElement(ode,{cache:t,serialized:a,isStringTag:typeof l=="string"}),V.createElement(l,b))}),cde=lde,Br=function(t,n){var r=arguments;if(n==null||!KP.call(n,"css"))return V.createElement.apply(void 0,r);var l=r.length,d=new Array(l);d[0]=cde,d[1]=sde(t,n);for(var p=2;p<l;p++)d[p]=r[p];return V.createElement.apply(null,d)};(function(e){var t;t||(t=e.JSX||(e.JSX={}))})(Br||(Br={}));function YP(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return iq(t)}function ude(){var e=YP.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function dde(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}const hde=Math.min,fde=Math.max,qT=Math.round,SS=Math.floor,HT=e=>({x:e,y:e});function pde(e){const{x:t,y:n,width:r,height:l}=e;return{width:r,height:l,top:n,left:t,right:t+r,bottom:n+l,x:t,y:n}}function f3(){return typeof window<"u"}function sq(e){return lq(e)?(e.nodeName||"").toLowerCase():"#document"}function Pm(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function oq(e){var t;return(t=(lq(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function lq(e){return f3()?e instanceof Node||e instanceof Pm(e).Node:!1}function mde(e){return f3()?e instanceof Element||e instanceof Pm(e).Element:!1}function QP(e){return f3()?e instanceof HTMLElement||e instanceof Pm(e).HTMLElement:!1}function Ez(e){return!f3()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Pm(e).ShadowRoot}function cq(e){const{overflow:t,overflowX:n,overflowY:r,display:l}=JP(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(l)}function gde(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function xde(e){return["html","body","#document"].includes(sq(e))}function JP(e){return Pm(e).getComputedStyle(e)}function yde(e){if(sq(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Ez(e)&&e.host||oq(e);return Ez(t)?t.host:t}function uq(e){const t=yde(e);return xde(t)?e.ownerDocument?e.ownerDocument.body:e.body:QP(t)&&cq(t)?t:uq(t)}function GT(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const l=uq(e),d=l===((r=e.ownerDocument)==null?void 0:r.body),p=Pm(l);if(d){const a=HM(p);return t.concat(p,p.visualViewport||[],cq(l)?l:[],a&&n?GT(a):[])}return t.concat(l,GT(l,[],n))}function HM(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function vde(e){const t=JP(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const l=QP(e),d=l?e.offsetWidth:n,p=l?e.offsetHeight:r,a=qT(n)!==d||qT(r)!==p;return a&&(n=d,r=p),{width:n,height:r,$:a}}function eN(e){return mde(e)?e:e.contextElement}function Az(e){const t=eN(e);if(!QP(t))return HT(1);const n=t.getBoundingClientRect(),{width:r,height:l,$:d}=vde(t);let p=(d?qT(n.width):n.width)/r,a=(d?qT(n.height):n.height)/l;return(!p||!Number.isFinite(p))&&(p=1),(!a||!Number.isFinite(a))&&(a=1),{x:p,y:a}}const _de=HT(0);function bde(e){const t=Pm(e);return!gde()||!t.visualViewport?_de:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function wde(e,t,n){return!1}function Cz(e,t,n,r){t===void 0&&(t=!1);const l=e.getBoundingClientRect(),d=eN(e);let p=HT(1);t&&(p=Az(e));const a=wde()?bde(d):HT(0);let b=(l.left+a.x)/p.x,T=(l.top+a.y)/p.y,E=l.width/p.x,P=l.height/p.y;if(d){const I=Pm(d),R=r;let F=I,W=HM(F);for(;W&&r&&R!==F;){const $=Az(W),Z=W.getBoundingClientRect(),ne=JP(W),ie=Z.left+(W.clientLeft+parseFloat(ne.paddingLeft))*$.x,ge=Z.top+(W.clientTop+parseFloat(ne.paddingTop))*$.y;b*=$.x,T*=$.y,E*=$.x,P*=$.y,b+=ie,T+=ge,F=Pm(W),W=HM(F)}}return pde({width:E,height:P,x:b,y:T})}function dq(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Sde(e,t){let n=null,r;const l=oq(e);function d(){var a;clearTimeout(r),(a=n)==null||a.disconnect(),n=null}function p(a,b){a===void 0&&(a=!1),b===void 0&&(b=1),d();const T=e.getBoundingClientRect(),{left:E,top:P,width:I,height:R}=T;if(a||t(),!I||!R)return;const F=SS(P),W=SS(l.clientWidth-(E+I)),$=SS(l.clientHeight-(P+R)),Z=SS(E),ie={rootMargin:-F+"px "+-W+"px "+-$+"px "+-Z+"px",threshold:fde(0,hde(1,b))||1};let ge=!0;function ae(se){const me=se[0].intersectionRatio;if(me!==b){if(!ge)return p();me?p(!1,me):r=setTimeout(()=>{p(!1,1e-7)},1e3)}me===1&&!dq(T,e.getBoundingClientRect())&&p(),ge=!1}try{n=new IntersectionObserver(ae,{...ie,root:l.ownerDocument})}catch{n=new IntersectionObserver(ae,ie)}n.observe(e)}return p(!0),d}function Tde(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:l=!0,ancestorResize:d=!0,elementResize:p=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:b=!1}=r,T=eN(e),E=l||d?[...T?GT(T):[],...GT(t)]:[];E.forEach(Z=>{l&&Z.addEventListener("scroll",n,{passive:!0}),d&&Z.addEventListener("resize",n)});const P=T&&a?Sde(T,n):null;let I=-1,R=null;p&&(R=new ResizeObserver(Z=>{let[ne]=Z;ne&&ne.target===T&&R&&(R.unobserve(t),cancelAnimationFrame(I),I=requestAnimationFrame(()=>{var ie;(ie=R)==null||ie.observe(t)})),n()}),T&&!b&&R.observe(T),R.observe(t));let F,W=b?Cz(e):null;b&&$();function $(){const Z=Cz(e);W&&!dq(W,Z)&&n(),W=Z,F=requestAnimationFrame($)}return n(),()=>{var Z;E.forEach(ne=>{l&&ne.removeEventListener("scroll",n),d&&ne.removeEventListener("resize",n)}),P==null||P(),(Z=R)==null||Z.disconnect(),R=null,b&&cancelAnimationFrame(F)}}var GM=V.useLayoutEffect,Ede=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],WT=function(){};function Ade(e,t){return t?t[0]==="-"?e+t:e+"__"+t:e}function Cde(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),l=2;l<n;l++)r[l-2]=arguments[l];var d=[].concat(r);if(t&&e)for(var p in t)t.hasOwnProperty(p)&&t[p]&&d.push("".concat(Ade(e,p)));return d.filter(function(a){return a}).map(function(a){return String(a).trim()}).join(" ")}var jz=function(t){return Rde(t)?t.filter(Boolean):fy(t)==="object"&&t!==null?[t]:[]},hq=function(t){t.className,t.clearValue,t.cx,t.getStyles,t.getClassNames,t.getValue,t.hasValue,t.isMulti,t.isRtl,t.options,t.selectOption,t.selectProps,t.setValue,t.theme;var n=zm(t,Ede);return Xr({},n)},Ps=function(t,n,r){var l=t.cx,d=t.getStyles,p=t.getClassNames,a=t.className;return{css:d(n,t),className:l(r??{},p(n,t),a)}};function p3(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function jde(e){return p3(e)?window.innerHeight:e.clientHeight}function fq(e){return p3(e)?window.pageYOffset:e.scrollTop}function ZT(e,t){if(p3(e)){window.scrollTo(0,t);return}e.scrollTop=t}function Mde(e){var t=getComputedStyle(e),n=t.position==="absolute",r=/(auto|scroll)/;if(t.position==="fixed")return document.documentElement;for(var l=e;l=l.parentElement;)if(t=getComputedStyle(l),!(n&&t.position==="static")&&r.test(t.overflow+t.overflowY+t.overflowX))return l;return document.documentElement}function Pde(e,t,n,r){return n*((e=e/r-1)*e*e+1)+t}function TS(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:WT,l=fq(e),d=t-l,p=10,a=0;function b(){a+=p;var T=Pde(a,l,d,n);ZT(e,T),a<n?window.requestAnimationFrame(b):r(e)}b()}function Mz(e,t){var n=e.getBoundingClientRect(),r=t.getBoundingClientRect(),l=t.offsetHeight/3;r.bottom+l>n.bottom?ZT(e,Math.min(t.offsetTop+t.clientHeight-e.offsetHeight+l,e.scrollHeight)):r.top-l<n.top&&ZT(e,Math.max(t.offsetTop-l,0))}function Nde(e){var t=e.getBoundingClientRect();return{bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width}}function Pz(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function Dde(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var pq=!1,Ode={get passive(){return pq=!0}},ES=typeof window<"u"?window:{};ES.addEventListener&&ES.removeEventListener&&(ES.addEventListener("p",WT,Ode),ES.removeEventListener("p",WT,!1));var Ide=pq;function kde(e){return e!=null}function Rde(e){return Array.isArray(e)}function AS(e,t,n){return e?t:n}var zde=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),l=1;l<n;l++)r[l-1]=arguments[l];var d=Object.entries(t).filter(function(p){var a=Am(p,1),b=a[0];return!r.includes(b)});return d.reduce(function(p,a){var b=Am(a,2),T=b[0],E=b[1];return p[T]=E,p},{})},Lde=["children","innerProps"],Fde=["children","innerProps"];function Bde(e){var t=e.maxHeight,n=e.menuEl,r=e.minHeight,l=e.placement,d=e.shouldScroll,p=e.isFixedPosition,a=e.controlHeight,b=Mde(n),T={placement:"bottom",maxHeight:t};if(!n||!n.offsetParent)return T;var E=b.getBoundingClientRect(),P=E.height,I=n.getBoundingClientRect(),R=I.bottom,F=I.height,W=I.top,$=n.offsetParent.getBoundingClientRect(),Z=$.top,ne=p?window.innerHeight:jde(b),ie=fq(b),ge=parseInt(getComputedStyle(n).marginBottom,10),ae=parseInt(getComputedStyle(n).marginTop,10),se=Z-ae,me=ne-W,ke=se+ie,qe=P-ie-W,tt=R-ne+ie+ge,nt=ie+W-ae,bt=160;switch(l){case"auto":case"bottom":if(me>=F)return{placement:"bottom",maxHeight:t};if(qe>=F&&!p)return d&&TS(b,tt,bt),{placement:"bottom",maxHeight:t};if(!p&&qe>=r||p&&me>=r){d&&TS(b,tt,bt);var jt=p?me-ge:qe-ge;return{placement:"bottom",maxHeight:jt}}if(l==="auto"||p){var Nt=t,vt=p?se:ke;return vt>=r&&(Nt=Math.min(vt-ge-a,t)),{placement:"top",maxHeight:Nt}}if(l==="bottom")return d&&ZT(b,tt),{placement:"bottom",maxHeight:t};break;case"top":if(se>=F)return{placement:"top",maxHeight:t};if(ke>=F&&!p)return d&&TS(b,nt,bt),{placement:"top",maxHeight:t};if(!p&&ke>=r||p&&se>=r){var He=t;return(!p&&ke>=r||p&&se>=r)&&(He=p?se-ae:ke-ae),d&&TS(b,nt,bt),{placement:"top",maxHeight:He}}return{placement:"bottom",maxHeight:t};default:throw new Error('Invalid placement provided "'.concat(l,'".'))}return T}function Vde(e){var t={bottom:"top",top:"bottom"};return e?t[e]:"bottom"}var mq=function(t){return t==="auto"?"bottom":t},Ude=function(t,n){var r,l=t.placement,d=t.theme,p=d.borderRadius,a=d.spacing,b=d.colors;return Xr((r={label:"menu"},bb(r,Vde(l),"100%"),bb(r,"position","absolute"),bb(r,"width","100%"),bb(r,"zIndex",1),r),n?{}:{backgroundColor:b.neutral0,borderRadius:p,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:a.menuGutter,marginTop:a.menuGutter})},gq=V.createContext(null),$de=function(t){var n=t.children,r=t.minMenuHeight,l=t.maxMenuHeight,d=t.menuPlacement,p=t.menuPosition,a=t.menuShouldScrollIntoView,b=t.theme,T=V.useContext(gq)||{},E=T.setPortalPlacement,P=V.useRef(null),I=V.useState(l),R=Am(I,2),F=R[0],W=R[1],$=V.useState(null),Z=Am($,2),ne=Z[0],ie=Z[1],ge=b.spacing.controlHeight;return GM(function(){var ae=P.current;if(ae){var se=p==="fixed",me=a&&!se,ke=Bde({maxHeight:l,menuEl:ae,minHeight:r,placement:d,shouldScroll:me,isFixedPosition:se,controlHeight:ge});W(ke.maxHeight),ie(ke.placement),E==null||E(ke.placement)}},[l,d,p,a,r,E,ge]),n({ref:P,placerProps:Xr(Xr({},t),{},{placement:ne||mq(d),maxHeight:F})})},qde=function(t){var n=t.children,r=t.innerRef,l=t.innerProps;return Br("div",ri({},Ps(t,"menu",{menu:!0}),{ref:r},l),n)},Hde=qde,Gde=function(t,n){var r=t.maxHeight,l=t.theme.spacing.baseUnit;return Xr({maxHeight:r,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},n?{}:{paddingBottom:l,paddingTop:l})},Wde=function(t){var n=t.children,r=t.innerProps,l=t.innerRef,d=t.isMulti;return Br("div",ri({},Ps(t,"menuList",{"menu-list":!0,"menu-list--is-multi":d}),{ref:l},r),n)},xq=function(t,n){var r=t.theme,l=r.spacing.baseUnit,d=r.colors;return Xr({textAlign:"center"},n?{}:{color:d.neutral40,padding:"".concat(l*2,"px ").concat(l*3,"px")})},Zde=xq,Xde=xq,Kde=function(t){var n=t.children,r=n===void 0?"No options":n,l=t.innerProps,d=zm(t,Lde);return Br("div",ri({},Ps(Xr(Xr({},d),{},{children:r,innerProps:l}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),l),r)},Yde=function(t){var n=t.children,r=n===void 0?"Loading...":n,l=t.innerProps,d=zm(t,Fde);return Br("div",ri({},Ps(Xr(Xr({},d),{},{children:r,innerProps:l}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),l),r)},Qde=function(t){var n=t.rect,r=t.offset,l=t.position;return{left:n.left,position:l,top:r,width:n.width,zIndex:1}},Jde=function(t){var n=t.appendTo,r=t.children,l=t.controlElement,d=t.innerProps,p=t.menuPlacement,a=t.menuPosition,b=V.useRef(null),T=V.useRef(null),E=V.useState(mq(p)),P=Am(E,2),I=P[0],R=P[1],F=V.useMemo(function(){return{setPortalPlacement:R}},[]),W=V.useState(null),$=Am(W,2),Z=$[0],ne=$[1],ie=V.useCallback(function(){if(l){var me=Nde(l),ke=a==="fixed"?0:window.pageYOffset,qe=me[I]+ke;(qe!==(Z==null?void 0:Z.offset)||me.left!==(Z==null?void 0:Z.rect.left)||me.width!==(Z==null?void 0:Z.rect.width))&&ne({offset:qe,rect:me})}},[l,a,I,Z==null?void 0:Z.offset,Z==null?void 0:Z.rect.left,Z==null?void 0:Z.rect.width]);GM(function(){ie()},[ie]);var ge=V.useCallback(function(){typeof T.current=="function"&&(T.current(),T.current=null),l&&b.current&&(T.current=Tde(l,b.current,ie,{elementResize:"ResizeObserver"in window}))},[l,ie]);GM(function(){ge()},[ge]);var ae=V.useCallback(function(me){b.current=me,ge()},[ge]);if(!n&&a!=="fixed"||!Z)return null;var se=Br("div",ri({ref:ae},Ps(Xr(Xr({},t),{},{offset:Z.offset,position:a,rect:Z.rect}),"menuPortal",{"menu-portal":!0}),d),r);return Br(gq.Provider,{value:F},n?r3.createPortal(se,n):se)},ehe=function(t){var n=t.isDisabled,r=t.isRtl;return{label:"container",direction:r?"rtl":void 0,pointerEvents:n?"none":void 0,position:"relative"}},the=function(t){var n=t.children,r=t.innerProps,l=t.isDisabled,d=t.isRtl;return Br("div",ri({},Ps(t,"container",{"--is-disabled":l,"--is-rtl":d}),r),n)},nhe=function(t,n){var r=t.theme.spacing,l=t.isMulti,d=t.hasValue,p=t.selectProps.controlShouldRenderValue;return Xr({alignItems:"center",display:l&&d&&p?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},n?{}:{padding:"".concat(r.baseUnit/2,"px ").concat(r.baseUnit*2,"px")})},rhe=function(t){var n=t.children,r=t.innerProps,l=t.isMulti,d=t.hasValue;return Br("div",ri({},Ps(t,"valueContainer",{"value-container":!0,"value-container--is-multi":l,"value-container--has-value":d}),r),n)},ihe=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},ahe=function(t){var n=t.children,r=t.innerProps;return Br("div",ri({},Ps(t,"indicatorsContainer",{indicators:!0}),r),n)},Nz,she=["size"],ohe=["innerProps","isRtl","size"],lhe={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},yq=function(t){var n=t.size,r=zm(t,she);return Br("svg",ri({height:n,width:n,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:lhe},r))},tN=function(t){return Br(yq,ri({size:20},t),Br("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},vq=function(t){return Br(yq,ri({size:20},t),Br("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},_q=function(t,n){var r=t.isFocused,l=t.theme,d=l.spacing.baseUnit,p=l.colors;return Xr({label:"indicatorContainer",display:"flex",transition:"color 150ms"},n?{}:{color:r?p.neutral60:p.neutral20,padding:d*2,":hover":{color:r?p.neutral80:p.neutral40}})},che=_q,uhe=function(t){var n=t.children,r=t.innerProps;return Br("div",ri({},Ps(t,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),r),n||Br(vq,null))},dhe=_q,hhe=function(t){var n=t.children,r=t.innerProps;return Br("div",ri({},Ps(t,"clearIndicator",{indicator:!0,"clear-indicator":!0}),r),n||Br(tN,null))},fhe=function(t,n){var r=t.isDisabled,l=t.theme,d=l.spacing.baseUnit,p=l.colors;return Xr({label:"indicatorSeparator",alignSelf:"stretch",width:1},n?{}:{backgroundColor:r?p.neutral10:p.neutral20,marginBottom:d*2,marginTop:d*2})},phe=function(t){var n=t.innerProps;return Br("span",ri({},n,Ps(t,"indicatorSeparator",{"indicator-separator":!0})))},mhe=ude(Nz||(Nz=dde([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),ghe=function(t,n){var r=t.isFocused,l=t.size,d=t.theme,p=d.colors,a=d.spacing.baseUnit;return Xr({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:l,lineHeight:1,marginRight:l,textAlign:"center",verticalAlign:"middle"},n?{}:{color:r?p.neutral60:p.neutral20,padding:a*2})},ZC=function(t){var n=t.delay,r=t.offset;return Br("span",{css:YP({animation:"".concat(mhe," 1s ease-in-out ").concat(n,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:r?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},xhe=function(t){var n=t.innerProps,r=t.isRtl,l=t.size,d=l===void 0?4:l,p=zm(t,ohe);return Br("div",ri({},Ps(Xr(Xr({},p),{},{innerProps:n,isRtl:r,size:d}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),n),Br(ZC,{delay:0,offset:r}),Br(ZC,{delay:160,offset:!0}),Br(ZC,{delay:320,offset:!r}))},yhe=function(t,n){var r=t.isDisabled,l=t.isFocused,d=t.theme,p=d.colors,a=d.borderRadius,b=d.spacing;return Xr({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:b.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},n?{}:{backgroundColor:r?p.neutral5:p.neutral0,borderColor:r?p.neutral10:l?p.primary:p.neutral20,borderRadius:a,borderStyle:"solid",borderWidth:1,boxShadow:l?"0 0 0 1px ".concat(p.primary):void 0,"&:hover":{borderColor:l?p.primary:p.neutral30}})},vhe=function(t){var n=t.children,r=t.isDisabled,l=t.isFocused,d=t.innerRef,p=t.innerProps,a=t.menuIsOpen;return Br("div",ri({ref:d},Ps(t,"control",{control:!0,"control--is-disabled":r,"control--is-focused":l,"control--menu-is-open":a}),p,{"aria-disabled":r||void 0}),n)},_he=vhe,bhe=["data"],whe=function(t,n){var r=t.theme.spacing;return n?{}:{paddingBottom:r.baseUnit*2,paddingTop:r.baseUnit*2}},She=function(t){var n=t.children,r=t.cx,l=t.getStyles,d=t.getClassNames,p=t.Heading,a=t.headingProps,b=t.innerProps,T=t.label,E=t.theme,P=t.selectProps;return Br("div",ri({},Ps(t,"group",{group:!0}),b),Br(p,ri({},a,{selectProps:P,theme:E,getStyles:l,getClassNames:d,cx:r}),T),Br("div",null,n))},The=function(t,n){var r=t.theme,l=r.colors,d=r.spacing;return Xr({label:"group",cursor:"default",display:"block"},n?{}:{color:l.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:d.baseUnit*3,paddingRight:d.baseUnit*3,textTransform:"uppercase"})},Ehe=function(t){var n=hq(t);n.data;var r=zm(n,bhe);return Br("div",ri({},Ps(t,"groupHeading",{"group-heading":!0}),r))},Ahe=She,Che=["innerRef","isDisabled","isHidden","inputClassName"],jhe=function(t,n){var r=t.isDisabled,l=t.value,d=t.theme,p=d.spacing,a=d.colors;return Xr(Xr({visibility:r?"hidden":"visible",transform:l?"translateZ(0)":""},Mhe),n?{}:{margin:p.baseUnit/2,paddingBottom:p.baseUnit/2,paddingTop:p.baseUnit/2,color:a.neutral80})},bq={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},Mhe={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Xr({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},bq)},Phe=function(t){return Xr({label:"input",color:"inherit",background:0,opacity:t?0:1,width:"100%"},bq)},Nhe=function(t){var n=t.cx,r=t.value,l=hq(t),d=l.innerRef,p=l.isDisabled,a=l.isHidden,b=l.inputClassName,T=zm(l,Che);return Br("div",ri({},Ps(t,"input",{"input-container":!0}),{"data-value":r||""}),Br("input",ri({className:n({input:!0},b),ref:d,style:Phe(a),disabled:p},T)))},Dhe=Nhe,Ohe=function(t,n){var r=t.theme,l=r.spacing,d=r.borderRadius,p=r.colors;return Xr({label:"multiValue",display:"flex",minWidth:0},n?{}:{backgroundColor:p.neutral10,borderRadius:d/2,margin:l.baseUnit/2})},Ihe=function(t,n){var r=t.theme,l=r.borderRadius,d=r.colors,p=t.cropWithEllipsis;return Xr({overflow:"hidden",textOverflow:p||p===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},n?{}:{borderRadius:l/2,color:d.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},khe=function(t,n){var r=t.theme,l=r.spacing,d=r.borderRadius,p=r.colors,a=t.isFocused;return Xr({alignItems:"center",display:"flex"},n?{}:{borderRadius:d/2,backgroundColor:a?p.dangerLight:void 0,paddingLeft:l.baseUnit,paddingRight:l.baseUnit,":hover":{backgroundColor:p.dangerLight,color:p.danger}})},wq=function(t){var n=t.children,r=t.innerProps;return Br("div",r,n)},Rhe=wq,zhe=wq;function Lhe(e){var t=e.children,n=e.innerProps;return Br("div",ri({role:"button"},n),t||Br(tN,{size:14}))}var Fhe=function(t){var n=t.children,r=t.components,l=t.data,d=t.innerProps,p=t.isDisabled,a=t.removeProps,b=t.selectProps,T=r.Container,E=r.Label,P=r.Remove;return Br(T,{data:l,innerProps:Xr(Xr({},Ps(t,"multiValue",{"multi-value":!0,"multi-value--is-disabled":p})),d),selectProps:b},Br(E,{data:l,innerProps:Xr({},Ps(t,"multiValueLabel",{"multi-value__label":!0})),selectProps:b},n),Br(P,{data:l,innerProps:Xr(Xr({},Ps(t,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(n||"option")},a),selectProps:b}))},Bhe=Fhe,Vhe=function(t,n){var r=t.isDisabled,l=t.isFocused,d=t.isSelected,p=t.theme,a=p.spacing,b=p.colors;return Xr({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},n?{}:{backgroundColor:d?b.primary:l?b.primary25:"transparent",color:r?b.neutral20:d?b.neutral0:"inherit",padding:"".concat(a.baseUnit*2,"px ").concat(a.baseUnit*3,"px"),":active":{backgroundColor:r?void 0:d?b.primary:b.primary50}})},Uhe=function(t){var n=t.children,r=t.isDisabled,l=t.isFocused,d=t.isSelected,p=t.innerRef,a=t.innerProps;return Br("div",ri({},Ps(t,"option",{option:!0,"option--is-disabled":r,"option--is-focused":l,"option--is-selected":d}),{ref:p,"aria-disabled":r},a),n)},$he=Uhe,qhe=function(t,n){var r=t.theme,l=r.spacing,d=r.colors;return Xr({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},n?{}:{color:d.neutral50,marginLeft:l.baseUnit/2,marginRight:l.baseUnit/2})},Hhe=function(t){var n=t.children,r=t.innerProps;return Br("div",ri({},Ps(t,"placeholder",{placeholder:!0}),r),n)},Ghe=Hhe,Whe=function(t,n){var r=t.isDisabled,l=t.theme,d=l.spacing,p=l.colors;return Xr({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},n?{}:{color:r?p.neutral40:p.neutral80,marginLeft:d.baseUnit/2,marginRight:d.baseUnit/2})},Zhe=function(t){var n=t.children,r=t.isDisabled,l=t.innerProps;return Br("div",ri({},Ps(t,"singleValue",{"single-value":!0,"single-value--is-disabled":r}),l),n)},Xhe=Zhe,Khe={ClearIndicator:hhe,Control:_he,DropdownIndicator:uhe,DownChevron:vq,CrossIcon:tN,Group:Ahe,GroupHeading:Ehe,IndicatorsContainer:ahe,IndicatorSeparator:phe,Input:Dhe,LoadingIndicator:xhe,Menu:Hde,MenuList:Wde,MenuPortal:Jde,LoadingMessage:Yde,NoOptionsMessage:Kde,MultiValue:Bhe,MultiValueContainer:Rhe,MultiValueLabel:zhe,MultiValueRemove:Lhe,Option:$he,Placeholder:Ghe,SelectContainer:the,SingleValue:Xhe,ValueContainer:rhe},Yhe=function(t){return Xr(Xr({},Khe),t.components)},Dz=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function Qhe(e,t){return!!(e===t||Dz(e)&&Dz(t))}function Jhe(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!Qhe(e[n],t[n]))return!1;return!0}function efe(e,t){t===void 0&&(t=Jhe);var n=null;function r(){for(var l=[],d=0;d<arguments.length;d++)l[d]=arguments[d];if(n&&n.lastThis===this&&t(l,n.lastArgs))return n.lastResult;var p=e.apply(this,l);return n={lastResult:p,lastArgs:l,lastThis:this},p}return r.clear=function(){n=null},r}var tfe={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},nfe=function(t){return Br("span",ri({css:tfe},t))},Oz=nfe,rfe={guidance:function(t){var n=t.isSearchable,r=t.isMulti,l=t.tabSelectsValue,d=t.context,p=t.isInitialFocus;switch(d){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(l?", press Tab to select the option and exit the menu":"",".");case"input":return p?"".concat(t["aria-label"]||"Select"," is focused ").concat(n?",type to refine list":"",", press Down to open the menu, ").concat(r?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(t){var n=t.action,r=t.label,l=r===void 0?"":r,d=t.labels,p=t.isDisabled;switch(n){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(l,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(d.length>1?"s":""," ").concat(d.join(","),", selected.");case"select-option":return p?"option ".concat(l," is disabled. Select another option."):"option ".concat(l,", selected.");default:return""}},onFocus:function(t){var n=t.context,r=t.focused,l=t.options,d=t.label,p=d===void 0?"":d,a=t.selectValue,b=t.isDisabled,T=t.isSelected,E=t.isAppleDevice,P=function(W,$){return W&&W.length?"".concat(W.indexOf($)+1," of ").concat(W.length):""};if(n==="value"&&a)return"value ".concat(p," focused, ").concat(P(a,r),".");if(n==="menu"&&E){var I=b?" disabled":"",R="".concat(T?" selected":"").concat(I);return"".concat(p).concat(R,", ").concat(P(l,r),".")}return""},onFilter:function(t){var n=t.inputValue,r=t.resultsMessage;return"".concat(r).concat(n?" for search term "+n:"",".")}},ife=function(t){var n=t.ariaSelection,r=t.focusedOption,l=t.focusedValue,d=t.focusableOptions,p=t.isFocused,a=t.selectValue,b=t.selectProps,T=t.id,E=t.isAppleDevice,P=b.ariaLiveMessages,I=b.getOptionLabel,R=b.inputValue,F=b.isMulti,W=b.isOptionDisabled,$=b.isSearchable,Z=b.menuIsOpen,ne=b.options,ie=b.screenReaderStatus,ge=b.tabSelectsValue,ae=b.isLoading,se=b["aria-label"],me=b["aria-live"],ke=V.useMemo(function(){return Xr(Xr({},rfe),P||{})},[P]),qe=V.useMemo(function(){var vt="";if(n&&ke.onChange){var He=n.option,ut=n.options,Tt=n.removedValue,Yt=n.removedValues,Ge=n.value,ot=function(Sr){return Array.isArray(Sr)?null:Sr},mt=Tt||He||ot(Ge),It=mt?I(mt):"",In=ut||Yt||void 0,Mn=In?In.map(I):[],vn=Xr({isDisabled:mt&&W(mt,a),label:It,labels:Mn},n);vt=ke.onChange(vn)}return vt},[n,ke,W,a,I]),tt=V.useMemo(function(){var vt="",He=r||l,ut=!!(r&&a&&a.includes(r));if(He&&ke.onFocus){var Tt={focused:He,label:I(He),isDisabled:W(He,a),isSelected:ut,options:d,context:He===r?"menu":"value",selectValue:a,isAppleDevice:E};vt=ke.onFocus(Tt)}return vt},[r,l,I,W,ke,d,a,E]),nt=V.useMemo(function(){var vt="";if(Z&&ne.length&&!ae&&ke.onFilter){var He=ie({count:d.length});vt=ke.onFilter({inputValue:R,resultsMessage:He})}return vt},[d,R,Z,ke,ne,ie,ae]),bt=(n==null?void 0:n.action)==="initial-input-focus",jt=V.useMemo(function(){var vt="";if(ke.guidance){var He=l?"value":Z?"menu":"input";vt=ke.guidance({"aria-label":se,context:He,isDisabled:r&&W(r,a),isMulti:F,isSearchable:$,tabSelectsValue:ge,isInitialFocus:bt})}return vt},[se,r,l,F,W,$,Z,ke,a,ge,bt]),Nt=Br(V.Fragment,null,Br("span",{id:"aria-selection"},qe),Br("span",{id:"aria-focused"},tt),Br("span",{id:"aria-results"},nt),Br("span",{id:"aria-guidance"},jt));return Br(V.Fragment,null,Br(Oz,{id:T},bt&&Nt),Br(Oz,{"aria-live":me,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},p&&!bt&&Nt))},afe=ife,WM=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],sfe=new RegExp("["+WM.map(function(e){return e.letters}).join("")+"]","g"),Sq={};for(var XC=0;XC<WM.length;XC++)for(var KC=WM[XC],YC=0;YC<KC.letters.length;YC++)Sq[KC.letters[YC]]=KC.base;var Tq=function(t){return t.replace(sfe,function(n){return Sq[n]})},ofe=efe(Tq),Iz=function(t){return t.replace(/^\s+|\s+$/g,"")},lfe=function(t){return"".concat(t.label," ").concat(t.value)},cfe=function(t){return function(n,r){if(n.data.__isNew__)return!0;var l=Xr({ignoreCase:!0,ignoreAccents:!0,stringify:lfe,trim:!0,matchFrom:"any"},t),d=l.ignoreCase,p=l.ignoreAccents,a=l.stringify,b=l.trim,T=l.matchFrom,E=b?Iz(r):r,P=b?Iz(a(n)):a(n);return d&&(E=E.toLowerCase(),P=P.toLowerCase()),p&&(E=ofe(E),P=Tq(P)),T==="start"?P.substr(0,E.length)===E:P.indexOf(E)>-1}},ufe=["innerRef"];function dfe(e){var t=e.innerRef,n=zm(e,ufe),r=zde(n,"onExited","in","enter","exit","appear");return Br("input",ri({ref:t},r,{css:YP({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var hfe=function(t){t.cancelable&&t.preventDefault(),t.stopPropagation()};function ffe(e){var t=e.isEnabled,n=e.onBottomArrive,r=e.onBottomLeave,l=e.onTopArrive,d=e.onTopLeave,p=V.useRef(!1),a=V.useRef(!1),b=V.useRef(0),T=V.useRef(null),E=V.useCallback(function($,Z){if(T.current!==null){var ne=T.current,ie=ne.scrollTop,ge=ne.scrollHeight,ae=ne.clientHeight,se=T.current,me=Z>0,ke=ge-ae-ie,qe=!1;ke>Z&&p.current&&(r&&r($),p.current=!1),me&&a.current&&(d&&d($),a.current=!1),me&&Z>ke?(n&&!p.current&&n($),se.scrollTop=ge,qe=!0,p.current=!0):!me&&-Z>ie&&(l&&!a.current&&l($),se.scrollTop=0,qe=!0,a.current=!0),qe&&hfe($)}},[n,r,l,d]),P=V.useCallback(function($){E($,$.deltaY)},[E]),I=V.useCallback(function($){b.current=$.changedTouches[0].clientY},[]),R=V.useCallback(function($){var Z=b.current-$.changedTouches[0].clientY;E($,Z)},[E]),F=V.useCallback(function($){if($){var Z=Ide?{passive:!1}:!1;$.addEventListener("wheel",P,Z),$.addEventListener("touchstart",I,Z),$.addEventListener("touchmove",R,Z)}},[R,I,P]),W=V.useCallback(function($){$&&($.removeEventListener("wheel",P,!1),$.removeEventListener("touchstart",I,!1),$.removeEventListener("touchmove",R,!1))},[R,I,P]);return V.useEffect(function(){if(t){var $=T.current;return F($),function(){W($)}}},[t,F,W]),function($){T.current=$}}var kz=["boxSizing","height","overflow","paddingRight","position"],Rz={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function zz(e){e.cancelable&&e.preventDefault()}function Lz(e){e.stopPropagation()}function Fz(){var e=this.scrollTop,t=this.scrollHeight,n=e+this.offsetHeight;e===0?this.scrollTop=1:n===t&&(this.scrollTop=e-1)}function Bz(){return"ontouchstart"in window||navigator.maxTouchPoints}var Vz=!!(typeof window<"u"&&window.document&&window.document.createElement),rb=0,Fv={capture:!1,passive:!1};function pfe(e){var t=e.isEnabled,n=e.accountForScrollbars,r=n===void 0?!0:n,l=V.useRef({}),d=V.useRef(null),p=V.useCallback(function(b){if(Vz){var T=document.body,E=T&&T.style;if(r&&kz.forEach(function(F){var W=E&&E[F];l.current[F]=W}),r&&rb<1){var P=parseInt(l.current.paddingRight,10)||0,I=document.body?document.body.clientWidth:0,R=window.innerWidth-I+P||0;Object.keys(Rz).forEach(function(F){var W=Rz[F];E&&(E[F]=W)}),E&&(E.paddingRight="".concat(R,"px"))}T&&Bz()&&(T.addEventListener("touchmove",zz,Fv),b&&(b.addEventListener("touchstart",Fz,Fv),b.addEventListener("touchmove",Lz,Fv))),rb+=1}},[r]),a=V.useCallback(function(b){if(Vz){var T=document.body,E=T&&T.style;rb=Math.max(rb-1,0),r&&rb<1&&kz.forEach(function(P){var I=l.current[P];E&&(E[P]=I)}),T&&Bz()&&(T.removeEventListener("touchmove",zz,Fv),b&&(b.removeEventListener("touchstart",Fz,Fv),b.removeEventListener("touchmove",Lz,Fv)))}},[r]);return V.useEffect(function(){if(t){var b=d.current;return p(b),function(){a(b)}}},[t,p,a]),function(b){d.current=b}}var mfe=function(t){var n=t.target;return n.ownerDocument.activeElement&&n.ownerDocument.activeElement.blur()},gfe={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function xfe(e){var t=e.children,n=e.lockEnabled,r=e.captureEnabled,l=r===void 0?!0:r,d=e.onBottomArrive,p=e.onBottomLeave,a=e.onTopArrive,b=e.onTopLeave,T=ffe({isEnabled:l,onBottomArrive:d,onBottomLeave:p,onTopArrive:a,onTopLeave:b}),E=pfe({isEnabled:n}),P=function(R){T(R),E(R)};return Br(V.Fragment,null,n&&Br("div",{onClick:mfe,css:gfe}),t(P))}var yfe={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},vfe=function(t){var n=t.name,r=t.onFocus;return Br("input",{required:!0,name:n,tabIndex:-1,"aria-hidden":"true",onFocus:r,css:yfe,value:"",onChange:function(){}})},_fe=vfe;function nN(e){var t;return typeof window<"u"&&window.navigator!=null?e.test(((t=window.navigator.userAgentData)===null||t===void 0?void 0:t.platform)||window.navigator.platform):!1}function bfe(){return nN(/^iPhone/i)}function Eq(){return nN(/^Mac/i)}function wfe(){return nN(/^iPad/i)||Eq()&&navigator.maxTouchPoints>1}function Sfe(){return bfe()||wfe()}function Tfe(){return Eq()||Sfe()}var Efe=function(t){return t.label},Afe=function(t){return t.label},Cfe=function(t){return t.value},jfe=function(t){return!!t.isDisabled},Mfe={clearIndicator:dhe,container:ehe,control:yhe,dropdownIndicator:che,group:whe,groupHeading:The,indicatorsContainer:ihe,indicatorSeparator:fhe,input:jhe,loadingIndicator:ghe,loadingMessage:Xde,menu:Ude,menuList:Gde,menuPortal:Qde,multiValue:Ohe,multiValueLabel:Ihe,multiValueRemove:khe,noOptionsMessage:Zde,option:Vhe,placeholder:qhe,singleValue:Whe,valueContainer:nhe},Pfe={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},Nfe=4,Aq=4,Dfe=38,Ofe=Aq*2,Ife={baseUnit:Aq,controlHeight:Dfe,menuGutter:Ofe},QC={borderRadius:Nfe,colors:Pfe,spacing:Ife},kfe={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:Pz(),captureMenuScroll:!Pz(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:cfe(),formatGroupLabel:Efe,getOptionLabel:Afe,getOptionValue:Cfe,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:jfe,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!Dde(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(t){var n=t.count;return"".concat(n," result").concat(n!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function Uz(e,t,n,r){var l=Mq(e,t,n),d=Pq(e,t,n),p=jq(e,t),a=XT(e,t);return{type:"option",data:t,isDisabled:l,isSelected:d,label:p,value:a,index:r}}function hT(e,t){return e.options.map(function(n,r){if("options"in n){var l=n.options.map(function(p,a){return Uz(e,p,t,a)}).filter(function(p){return qz(e,p)});return l.length>0?{type:"group",data:n,options:l,index:r}:void 0}var d=Uz(e,n,t,r);return qz(e,d)?d:void 0}).filter(kde)}function Cq(e){return e.reduce(function(t,n){return n.type==="group"?t.push.apply(t,GP(n.options.map(function(r){return r.data}))):t.push(n.data),t},[])}function $z(e,t){return e.reduce(function(n,r){return r.type==="group"?n.push.apply(n,GP(r.options.map(function(l){return{data:l.data,id:"".concat(t,"-").concat(r.index,"-").concat(l.index)}}))):n.push({data:r.data,id:"".concat(t,"-").concat(r.index)}),n},[])}function Rfe(e,t){return Cq(hT(e,t))}function qz(e,t){var n=e.inputValue,r=n===void 0?"":n,l=t.data,d=t.isSelected,p=t.label,a=t.value;return(!Dq(e)||!d)&&Nq(e,{label:p,value:a,data:l},r)}function zfe(e,t){var n=e.focusedValue,r=e.selectValue,l=r.indexOf(n);if(l>-1){var d=t.indexOf(n);if(d>-1)return n;if(l<t.length)return t[l]}return null}function Lfe(e,t){var n=e.focusedOption;return n&&t.indexOf(n)>-1?n:t[0]}var JC=function(t,n){var r,l=(r=t.find(function(d){return d.data===n}))===null||r===void 0?void 0:r.id;return l||null},jq=function(t,n){return t.getOptionLabel(n)},XT=function(t,n){return t.getOptionValue(n)};function Mq(e,t,n){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(t,n):!1}function Pq(e,t,n){if(n.indexOf(t)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(t,n);var r=XT(e,t);return n.some(function(l){return XT(e,l)===r})}function Nq(e,t,n){return e.filterOption?e.filterOption(t,n):!0}var Dq=function(t){var n=t.hideSelectedOptions,r=t.isMulti;return n===void 0?r:n},Ffe=1,Oq=function(e){sue(n,e);var t=cue(n);function n(r){var l;if(iue(this,n),l=t.call(this,r),l.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:""},l.blockOptionHover=!1,l.isComposing=!1,l.commonProps=void 0,l.initialTouchX=0,l.initialTouchY=0,l.openAfterFocus=!1,l.scrollToFocusedOptionOnUpdate=!1,l.userIsDragging=void 0,l.isAppleDevice=Tfe(),l.controlRef=null,l.getControlRef=function(b){l.controlRef=b},l.focusedOptionRef=null,l.getFocusedOptionRef=function(b){l.focusedOptionRef=b},l.menuListRef=null,l.getMenuListRef=function(b){l.menuListRef=b},l.inputRef=null,l.getInputRef=function(b){l.inputRef=b},l.focus=l.focusInput,l.blur=l.blurInput,l.onChange=function(b,T){var E=l.props,P=E.onChange,I=E.name;T.name=I,l.ariaOnChange(b,T),P(b,T)},l.setValue=function(b,T,E){var P=l.props,I=P.closeMenuOnSelect,R=P.isMulti,F=P.inputValue;l.onInputChange("",{action:"set-value",prevInputValue:F}),I&&(l.setState({inputIsHiddenAfterUpdate:!R}),l.onMenuClose()),l.setState({clearFocusValueOnUpdate:!0}),l.onChange(b,{action:T,option:E})},l.selectOption=function(b){var T=l.props,E=T.blurInputOnSelect,P=T.isMulti,I=T.name,R=l.state.selectValue,F=P&&l.isOptionSelected(b,R),W=l.isOptionDisabled(b,R);if(F){var $=l.getOptionValue(b);l.setValue(R.filter(function(Z){return l.getOptionValue(Z)!==$}),"deselect-option",b)}else if(!W)P?l.setValue([].concat(GP(R),[b]),"select-option",b):l.setValue(b,"select-option");else{l.ariaOnChange(b,{action:"select-option",option:b,name:I});return}E&&l.blurInput()},l.removeValue=function(b){var T=l.props.isMulti,E=l.state.selectValue,P=l.getOptionValue(b),I=E.filter(function(F){return l.getOptionValue(F)!==P}),R=AS(T,I,I[0]||null);l.onChange(R,{action:"remove-value",removedValue:b}),l.focusInput()},l.clearValue=function(){var b=l.state.selectValue;l.onChange(AS(l.props.isMulti,[],null),{action:"clear",removedValues:b})},l.popValue=function(){var b=l.props.isMulti,T=l.state.selectValue,E=T[T.length-1],P=T.slice(0,T.length-1),I=AS(b,P,P[0]||null);E&&l.onChange(I,{action:"pop-value",removedValue:E})},l.getFocusedOptionId=function(b){return JC(l.state.focusableOptionsWithIds,b)},l.getFocusableOptionsWithIds=function(){return $z(hT(l.props,l.state.selectValue),l.getElementId("option"))},l.getValue=function(){return l.state.selectValue},l.cx=function(){for(var b=arguments.length,T=new Array(b),E=0;E<b;E++)T[E]=arguments[E];return Cde.apply(void 0,[l.props.classNamePrefix].concat(T))},l.getOptionLabel=function(b){return jq(l.props,b)},l.getOptionValue=function(b){return XT(l.props,b)},l.getStyles=function(b,T){var E=l.props.unstyled,P=Mfe[b](T,E);P.boxSizing="border-box";var I=l.props.styles[b];return I?I(P,T):P},l.getClassNames=function(b,T){var E,P;return(E=(P=l.props.classNames)[b])===null||E===void 0?void 0:E.call(P,T)},l.getElementId=function(b){return"".concat(l.state.instancePrefix,"-").concat(b)},l.getComponents=function(){return Yhe(l.props)},l.buildCategorizedOptions=function(){return hT(l.props,l.state.selectValue)},l.getCategorizedOptions=function(){return l.props.menuIsOpen?l.buildCategorizedOptions():[]},l.buildFocusableOptions=function(){return Cq(l.buildCategorizedOptions())},l.getFocusableOptions=function(){return l.props.menuIsOpen?l.buildFocusableOptions():[]},l.ariaOnChange=function(b,T){l.setState({ariaSelection:Xr({value:b},T)})},l.onMenuMouseDown=function(b){b.button===0&&(b.stopPropagation(),b.preventDefault(),l.focusInput())},l.onMenuMouseMove=function(b){l.blockOptionHover=!1},l.onControlMouseDown=function(b){if(!b.defaultPrevented){var T=l.props.openMenuOnClick;l.state.isFocused?l.props.menuIsOpen?b.target.tagName!=="INPUT"&&b.target.tagName!=="TEXTAREA"&&l.onMenuClose():T&&l.openMenu("first"):(T&&(l.openAfterFocus=!0),l.focusInput()),b.target.tagName!=="INPUT"&&b.target.tagName!=="TEXTAREA"&&b.preventDefault()}},l.onDropdownIndicatorMouseDown=function(b){if(!(b&&b.type==="mousedown"&&b.button!==0)&&!l.props.isDisabled){var T=l.props,E=T.isMulti,P=T.menuIsOpen;l.focusInput(),P?(l.setState({inputIsHiddenAfterUpdate:!E}),l.onMenuClose()):l.openMenu("first"),b.preventDefault()}},l.onClearIndicatorMouseDown=function(b){b&&b.type==="mousedown"&&b.button!==0||(l.clearValue(),b.preventDefault(),l.openAfterFocus=!1,b.type==="touchend"?l.focusInput():setTimeout(function(){return l.focusInput()}))},l.onScroll=function(b){typeof l.props.closeMenuOnScroll=="boolean"?b.target instanceof HTMLElement&&p3(b.target)&&l.props.onMenuClose():typeof l.props.closeMenuOnScroll=="function"&&l.props.closeMenuOnScroll(b)&&l.props.onMenuClose()},l.onCompositionStart=function(){l.isComposing=!0},l.onCompositionEnd=function(){l.isComposing=!1},l.onTouchStart=function(b){var T=b.touches,E=T&&T.item(0);E&&(l.initialTouchX=E.clientX,l.initialTouchY=E.clientY,l.userIsDragging=!1)},l.onTouchMove=function(b){var T=b.touches,E=T&&T.item(0);if(E){var P=Math.abs(E.clientX-l.initialTouchX),I=Math.abs(E.clientY-l.initialTouchY),R=5;l.userIsDragging=P>R||I>R}},l.onTouchEnd=function(b){l.userIsDragging||(l.controlRef&&!l.controlRef.contains(b.target)&&l.menuListRef&&!l.menuListRef.contains(b.target)&&l.blurInput(),l.initialTouchX=0,l.initialTouchY=0)},l.onControlTouchEnd=function(b){l.userIsDragging||l.onControlMouseDown(b)},l.onClearIndicatorTouchEnd=function(b){l.userIsDragging||l.onClearIndicatorMouseDown(b)},l.onDropdownIndicatorTouchEnd=function(b){l.userIsDragging||l.onDropdownIndicatorMouseDown(b)},l.handleInputChange=function(b){var T=l.props.inputValue,E=b.currentTarget.value;l.setState({inputIsHiddenAfterUpdate:!1}),l.onInputChange(E,{action:"input-change",prevInputValue:T}),l.props.menuIsOpen||l.onMenuOpen()},l.onInputFocus=function(b){l.props.onFocus&&l.props.onFocus(b),l.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(l.openAfterFocus||l.props.openMenuOnFocus)&&l.openMenu("first"),l.openAfterFocus=!1},l.onInputBlur=function(b){var T=l.props.inputValue;if(l.menuListRef&&l.menuListRef.contains(document.activeElement)){l.inputRef.focus();return}l.props.onBlur&&l.props.onBlur(b),l.onInputChange("",{action:"input-blur",prevInputValue:T}),l.onMenuClose(),l.setState({focusedValue:null,isFocused:!1})},l.onOptionHover=function(b){if(!(l.blockOptionHover||l.state.focusedOption===b)){var T=l.getFocusableOptions(),E=T.indexOf(b);l.setState({focusedOption:b,focusedOptionId:E>-1?l.getFocusedOptionId(b):null})}},l.shouldHideSelectedOptions=function(){return Dq(l.props)},l.onValueInputFocus=function(b){b.preventDefault(),b.stopPropagation(),l.focus()},l.onKeyDown=function(b){var T=l.props,E=T.isMulti,P=T.backspaceRemovesValue,I=T.escapeClearsValue,R=T.inputValue,F=T.isClearable,W=T.isDisabled,$=T.menuIsOpen,Z=T.onKeyDown,ne=T.tabSelectsValue,ie=T.openMenuOnFocus,ge=l.state,ae=ge.focusedOption,se=ge.focusedValue,me=ge.selectValue;if(!W&&!(typeof Z=="function"&&(Z(b),b.defaultPrevented))){switch(l.blockOptionHover=!0,b.key){case"ArrowLeft":if(!E||R)return;l.focusValue("previous");break;case"ArrowRight":if(!E||R)return;l.focusValue("next");break;case"Delete":case"Backspace":if(R)return;if(se)l.removeValue(se);else{if(!P)return;E?l.popValue():F&&l.clearValue()}break;case"Tab":if(l.isComposing||b.shiftKey||!$||!ne||!ae||ie&&l.isOptionSelected(ae,me))return;l.selectOption(ae);break;case"Enter":if(b.keyCode===229)break;if($){if(!ae||l.isComposing)return;l.selectOption(ae);break}return;case"Escape":$?(l.setState({inputIsHiddenAfterUpdate:!1}),l.onInputChange("",{action:"menu-close",prevInputValue:R}),l.onMenuClose()):F&&I&&l.clearValue();break;case" ":if(R)return;if(!$){l.openMenu("first");break}if(!ae)return;l.selectOption(ae);break;case"ArrowUp":$?l.focusOption("up"):l.openMenu("last");break;case"ArrowDown":$?l.focusOption("down"):l.openMenu("first");break;case"PageUp":if(!$)return;l.focusOption("pageup");break;case"PageDown":if(!$)return;l.focusOption("pagedown");break;case"Home":if(!$)return;l.focusOption("first");break;case"End":if(!$)return;l.focusOption("last");break;default:return}b.preventDefault()}},l.state.instancePrefix="react-select-"+(l.props.instanceId||++Ffe),l.state.selectValue=jz(r.value),r.menuIsOpen&&l.state.selectValue.length){var d=l.getFocusableOptionsWithIds(),p=l.buildFocusableOptions(),a=p.indexOf(l.state.selectValue[0]);l.state.focusableOptionsWithIds=d,l.state.focusedOption=p[a],l.state.focusedOptionId=JC(d,p[a])}return l}return aue(n,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&Mz(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(l){var d=this.props,p=d.isDisabled,a=d.menuIsOpen,b=this.state.isFocused;(b&&!p&&l.isDisabled||b&&a&&!l.menuIsOpen)&&this.focusInput(),b&&p&&!l.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!b&&!p&&l.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(Mz(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(l,d){this.props.onInputChange(l,d)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(l){var d=this,p=this.state,a=p.selectValue,b=p.isFocused,T=this.buildFocusableOptions(),E=l==="first"?0:T.length-1;if(!this.props.isMulti){var P=T.indexOf(a[0]);P>-1&&(E=P)}this.scrollToFocusedOptionOnUpdate=!(b&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:T[E],focusedOptionId:this.getFocusedOptionId(T[E])},function(){return d.onMenuOpen()})}},{key:"focusValue",value:function(l){var d=this.state,p=d.selectValue,a=d.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var b=p.indexOf(a);a||(b=-1);var T=p.length-1,E=-1;if(p.length){switch(l){case"previous":b===0?E=0:b===-1?E=T:E=b-1;break;case"next":b>-1&&b<T&&(E=b+1);break}this.setState({inputIsHidden:E!==-1,focusedValue:p[E]})}}}},{key:"focusOption",value:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",d=this.props.pageSize,p=this.state.focusedOption,a=this.getFocusableOptions();if(a.length){var b=0,T=a.indexOf(p);p||(T=-1),l==="up"?b=T>0?T-1:a.length-1:l==="down"?b=(T+1)%a.length:l==="pageup"?(b=T-d,b<0&&(b=0)):l==="pagedown"?(b=T+d,b>a.length-1&&(b=a.length-1)):l==="last"&&(b=a.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:a[b],focusedValue:null,focusedOptionId:this.getFocusedOptionId(a[b])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(QC):Xr(Xr({},QC),this.props.theme):QC}},{key:"getCommonProps",value:function(){var l=this.clearValue,d=this.cx,p=this.getStyles,a=this.getClassNames,b=this.getValue,T=this.selectOption,E=this.setValue,P=this.props,I=P.isMulti,R=P.isRtl,F=P.options,W=this.hasValue();return{clearValue:l,cx:d,getStyles:p,getClassNames:a,getValue:b,hasValue:W,isMulti:I,isRtl:R,options:F,selectOption:T,selectProps:P,setValue:E,theme:this.getTheme()}}},{key:"hasValue",value:function(){var l=this.state.selectValue;return l.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var l=this.props,d=l.isClearable,p=l.isMulti;return d===void 0?p:d}},{key:"isOptionDisabled",value:function(l,d){return Mq(this.props,l,d)}},{key:"isOptionSelected",value:function(l,d){return Pq(this.props,l,d)}},{key:"filterOption",value:function(l,d){return Nq(this.props,l,d)}},{key:"formatOptionLabel",value:function(l,d){if(typeof this.props.formatOptionLabel=="function"){var p=this.props.inputValue,a=this.state.selectValue;return this.props.formatOptionLabel(l,{context:d,inputValue:p,selectValue:a})}else return this.getOptionLabel(l)}},{key:"formatGroupLabel",value:function(l){return this.props.formatGroupLabel(l)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var l=this.props,d=l.isDisabled,p=l.isSearchable,a=l.inputId,b=l.inputValue,T=l.tabIndex,E=l.form,P=l.menuIsOpen,I=l.required,R=this.getComponents(),F=R.Input,W=this.state,$=W.inputIsHidden,Z=W.ariaSelection,ne=this.commonProps,ie=a||this.getElementId("input"),ge=Xr(Xr(Xr({"aria-autocomplete":"list","aria-expanded":P,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":I,role:"combobox","aria-activedescendant":this.isAppleDevice?void 0:this.state.focusedOptionId||""},P&&{"aria-controls":this.getElementId("listbox")}),!p&&{"aria-readonly":!0}),this.hasValue()?(Z==null?void 0:Z.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return p?V.createElement(F,ri({},ne,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:ie,innerRef:this.getInputRef,isDisabled:d,isHidden:$,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:T,form:E,type:"text",value:b},ge)):V.createElement(dfe,ri({id:ie,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:WT,onFocus:this.onInputFocus,disabled:d,tabIndex:T,inputMode:"none",form:E,value:""},ge))}},{key:"renderPlaceholderOrValue",value:function(){var l=this,d=this.getComponents(),p=d.MultiValue,a=d.MultiValueContainer,b=d.MultiValueLabel,T=d.MultiValueRemove,E=d.SingleValue,P=d.Placeholder,I=this.commonProps,R=this.props,F=R.controlShouldRenderValue,W=R.isDisabled,$=R.isMulti,Z=R.inputValue,ne=R.placeholder,ie=this.state,ge=ie.selectValue,ae=ie.focusedValue,se=ie.isFocused;if(!this.hasValue()||!F)return Z?null:V.createElement(P,ri({},I,{key:"placeholder",isDisabled:W,isFocused:se,innerProps:{id:this.getElementId("placeholder")}}),ne);if($)return ge.map(function(ke,qe){var tt=ke===ae,nt="".concat(l.getOptionLabel(ke),"-").concat(l.getOptionValue(ke));return V.createElement(p,ri({},I,{components:{Container:a,Label:b,Remove:T},isFocused:tt,isDisabled:W,key:nt,index:qe,removeProps:{onClick:function(){return l.removeValue(ke)},onTouchEnd:function(){return l.removeValue(ke)},onMouseDown:function(jt){jt.preventDefault()}},data:ke}),l.formatOptionLabel(ke,"value"))});if(Z)return null;var me=ge[0];return V.createElement(E,ri({},I,{data:me,isDisabled:W}),this.formatOptionLabel(me,"value"))}},{key:"renderClearIndicator",value:function(){var l=this.getComponents(),d=l.ClearIndicator,p=this.commonProps,a=this.props,b=a.isDisabled,T=a.isLoading,E=this.state.isFocused;if(!this.isClearable()||!d||b||!this.hasValue()||T)return null;var P={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return V.createElement(d,ri({},p,{innerProps:P,isFocused:E}))}},{key:"renderLoadingIndicator",value:function(){var l=this.getComponents(),d=l.LoadingIndicator,p=this.commonProps,a=this.props,b=a.isDisabled,T=a.isLoading,E=this.state.isFocused;if(!d||!T)return null;var P={"aria-hidden":"true"};return V.createElement(d,ri({},p,{innerProps:P,isDisabled:b,isFocused:E}))}},{key:"renderIndicatorSeparator",value:function(){var l=this.getComponents(),d=l.DropdownIndicator,p=l.IndicatorSeparator;if(!d||!p)return null;var a=this.commonProps,b=this.props.isDisabled,T=this.state.isFocused;return V.createElement(p,ri({},a,{isDisabled:b,isFocused:T}))}},{key:"renderDropdownIndicator",value:function(){var l=this.getComponents(),d=l.DropdownIndicator;if(!d)return null;var p=this.commonProps,a=this.props.isDisabled,b=this.state.isFocused,T={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return V.createElement(d,ri({},p,{innerProps:T,isDisabled:a,isFocused:b}))}},{key:"renderMenu",value:function(){var l=this,d=this.getComponents(),p=d.Group,a=d.GroupHeading,b=d.Menu,T=d.MenuList,E=d.MenuPortal,P=d.LoadingMessage,I=d.NoOptionsMessage,R=d.Option,F=this.commonProps,W=this.state.focusedOption,$=this.props,Z=$.captureMenuScroll,ne=$.inputValue,ie=$.isLoading,ge=$.loadingMessage,ae=$.minMenuHeight,se=$.maxMenuHeight,me=$.menuIsOpen,ke=$.menuPlacement,qe=$.menuPosition,tt=$.menuPortalTarget,nt=$.menuShouldBlockScroll,bt=$.menuShouldScrollIntoView,jt=$.noOptionsMessage,Nt=$.onMenuScrollToTop,vt=$.onMenuScrollToBottom;if(!me)return null;var He=function(It,In){var Mn=It.type,vn=It.data,Zn=It.isDisabled,Sr=It.isSelected,un=It.label,er=It.value,hr=W===vn,dn=Zn?void 0:function(){return l.onOptionHover(vn)},Ir=Zn?void 0:function(){return l.selectOption(vn)},Zr="".concat(l.getElementId("option"),"-").concat(In),sa={id:Zr,onClick:Ir,onMouseMove:dn,onMouseOver:dn,tabIndex:-1,role:"option","aria-selected":l.isAppleDevice?void 0:Sr};return V.createElement(R,ri({},F,{innerProps:sa,data:vn,isDisabled:Zn,isSelected:Sr,key:Zr,label:un,type:Mn,value:er,isFocused:hr,innerRef:hr?l.getFocusedOptionRef:void 0}),l.formatOptionLabel(It.data,"menu"))},ut;if(this.hasOptions())ut=this.getCategorizedOptions().map(function(mt){if(mt.type==="group"){var It=mt.data,In=mt.options,Mn=mt.index,vn="".concat(l.getElementId("group"),"-").concat(Mn),Zn="".concat(vn,"-heading");return V.createElement(p,ri({},F,{key:vn,data:It,options:In,Heading:a,headingProps:{id:Zn,data:mt.data},label:l.formatGroupLabel(mt.data)}),mt.options.map(function(Sr){return He(Sr,"".concat(Mn,"-").concat(Sr.index))}))}else if(mt.type==="option")return He(mt,"".concat(mt.index))});else if(ie){var Tt=ge({inputValue:ne});if(Tt===null)return null;ut=V.createElement(P,F,Tt)}else{var Yt=jt({inputValue:ne});if(Yt===null)return null;ut=V.createElement(I,F,Yt)}var Ge={minMenuHeight:ae,maxMenuHeight:se,menuPlacement:ke,menuPosition:qe,menuShouldScrollIntoView:bt},ot=V.createElement($de,ri({},F,Ge),function(mt){var It=mt.ref,In=mt.placerProps,Mn=In.placement,vn=In.maxHeight;return V.createElement(b,ri({},F,Ge,{innerRef:It,innerProps:{onMouseDown:l.onMenuMouseDown,onMouseMove:l.onMenuMouseMove},isLoading:ie,placement:Mn}),V.createElement(xfe,{captureEnabled:Z,onTopArrive:Nt,onBottomArrive:vt,lockEnabled:nt},function(Zn){return V.createElement(T,ri({},F,{innerRef:function(un){l.getMenuListRef(un),Zn(un)},innerProps:{role:"listbox","aria-multiselectable":F.isMulti,id:l.getElementId("listbox")},isLoading:ie,maxHeight:vn,focusedOption:W}),ut)}))});return tt||qe==="fixed"?V.createElement(E,ri({},F,{appendTo:tt,controlElement:this.controlRef,menuPlacement:ke,menuPosition:qe}),ot):ot}},{key:"renderFormField",value:function(){var l=this,d=this.props,p=d.delimiter,a=d.isDisabled,b=d.isMulti,T=d.name,E=d.required,P=this.state.selectValue;if(E&&!this.hasValue()&&!a)return V.createElement(_fe,{name:T,onFocus:this.onValueInputFocus});if(!(!T||a))if(b)if(p){var I=P.map(function(W){return l.getOptionValue(W)}).join(p);return V.createElement("input",{name:T,type:"hidden",value:I})}else{var R=P.length>0?P.map(function(W,$){return V.createElement("input",{key:"i-".concat($),name:T,type:"hidden",value:l.getOptionValue(W)})}):V.createElement("input",{name:T,type:"hidden",value:""});return V.createElement("div",null,R)}else{var F=P[0]?this.getOptionValue(P[0]):"";return V.createElement("input",{name:T,type:"hidden",value:F})}}},{key:"renderLiveRegion",value:function(){var l=this.commonProps,d=this.state,p=d.ariaSelection,a=d.focusedOption,b=d.focusedValue,T=d.isFocused,E=d.selectValue,P=this.getFocusableOptions();return V.createElement(afe,ri({},l,{id:this.getElementId("live-region"),ariaSelection:p,focusedOption:a,focusedValue:b,isFocused:T,selectValue:E,focusableOptions:P,isAppleDevice:this.isAppleDevice}))}},{key:"render",value:function(){var l=this.getComponents(),d=l.Control,p=l.IndicatorsContainer,a=l.SelectContainer,b=l.ValueContainer,T=this.props,E=T.className,P=T.id,I=T.isDisabled,R=T.menuIsOpen,F=this.state.isFocused,W=this.commonProps=this.getCommonProps();return V.createElement(a,ri({},W,{className:E,innerProps:{id:P,onKeyDown:this.onKeyDown},isDisabled:I,isFocused:F}),this.renderLiveRegion(),V.createElement(d,ri({},W,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:I,isFocused:F,menuIsOpen:R}),V.createElement(b,ri({},W,{isDisabled:I}),this.renderPlaceholderOrValue(),this.renderInput()),V.createElement(p,ri({},W,{isDisabled:I}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(l,d){var p=d.prevProps,a=d.clearFocusValueOnUpdate,b=d.inputIsHiddenAfterUpdate,T=d.ariaSelection,E=d.isFocused,P=d.prevWasFocused,I=d.instancePrefix,R=l.options,F=l.value,W=l.menuIsOpen,$=l.inputValue,Z=l.isMulti,ne=jz(F),ie={};if(p&&(F!==p.value||R!==p.options||W!==p.menuIsOpen||$!==p.inputValue)){var ge=W?Rfe(l,ne):[],ae=W?$z(hT(l,ne),"".concat(I,"-option")):[],se=a?zfe(d,ne):null,me=Lfe(d,ge),ke=JC(ae,me);ie={selectValue:ne,focusedOption:me,focusedOptionId:ke,focusableOptionsWithIds:ae,focusedValue:se,clearFocusValueOnUpdate:!1}}var qe=b!=null&&l!==p?{inputIsHidden:b,inputIsHiddenAfterUpdate:void 0}:{},tt=T,nt=E&&P;return E&&!nt&&(tt={value:AS(Z,ne,ne[0]||null),options:ne,action:"initial-input-focus"},nt=!P),(T==null?void 0:T.action)==="initial-input-focus"&&(tt=null),Xr(Xr(Xr({},ie),qe),{},{prevProps:l,ariaSelection:tt,prevWasFocused:nt})}}]),n}(V.Component);Oq.defaultProps=kfe;var Bfe=V.forwardRef(function(e,t){var n=rue(e);return V.createElement(Oq,ri({ref:t},n))}),gs=Bfe;const Hz={control:(e,t)=>({...e,backgroundColor:"#fcfcfcff",borderColor:t.isFocused?"#16dbf9ff":"#16eaf9ff",boxShadow:t.isFocused?"0 0 0 2px rgba(22, 151, 249, 0.17)":"0 0 0 2px rgba(22, 211, 249, 0.15)",borderRadius:"0.5rem",minHeight:"2.5rem",fontSize:"0.75rem",paddingLeft:"0.25rem",paddingRight:"0.25rem",transition:"all 0.2s ease-in-out"}),menu:e=>({...e,backgroundColor:"#f9fafb",borderRadius:"0.5rem",boxShadow:"0 10px 15px -3px rgba(0,0,0,0.1)",padding:"0.25rem",zIndex:30,fontSize:"0.75rem"}),option:(e,t)=>({...e,backgroundColor:t.isFocused?"#16f99e9c":"transparent",color:"#111827",cursor:"pointer",borderRadius:"0.375rem",padding:"0.5rem 0.75rem"}),singleValue:e=>({...e,color:"#111827"}),placeholder:e=>({...e,color:"#50545aff",fontStyle:"italic"}),input:e=>({...e,color:"#111827"}),dropdownIndicator:e=>({...e,color:"#9ca3af","&:hover":{color:"#6b7280"}}),indicatorSeparator:()=>({display:"none"}),menuList:e=>({...e,maxHeight:"220px",overflowY:"auto",scrollbarWidth:"thin","&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#eee4a0ff",borderRadius:"4px"},"&::-webkit-scrollbar-track":{backgroundColor:"transparent"}})},nx="/assets/ilust1-3EyL7Rdw.svg",rN=V.createContext({});function iN(e){const t=V.useRef(null);return t.current===null&&(t.current=e()),t.current}const aN=typeof window<"u",Iq=aN?V.useLayoutEffect:V.useEffect,m3=V.createContext(null);function sN(e,t){e.indexOf(t)===-1&&e.push(t)}function oN(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const Nm=(e,t,n)=>n>t?t:n<e?e:n;let lN=()=>{};const Dm={},kq=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function Rq(e){return typeof e=="object"&&e!==null}const zq=e=>/^0[^.\s]+$/u.test(e);function cN(e){let t;return()=>(t===void 0&&(t=e()),t)}const Ld=e=>e,Vfe=(e,t)=>n=>t(e(n)),Rw=(...e)=>e.reduce(Vfe),aw=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r};class uN{constructor(){this.subscriptions=[]}add(t){return sN(this.subscriptions,t),()=>oN(this.subscriptions,t)}notify(t,n,r){const l=this.subscriptions.length;if(l)if(l===1)this.subscriptions[0](t,n,r);else for(let d=0;d<l;d++){const p=this.subscriptions[d];p&&p(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const ep=e=>e*1e3,tp=e=>e/1e3;function Lq(e,t){return t?e*(1e3/t):0}const Fq=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,Ufe=1e-7,$fe=12;function qfe(e,t,n,r,l){let d,p,a=0;do p=t+(n-t)/2,d=Fq(p,r,l)-e,d>0?n=p:t=p;while(Math.abs(d)>Ufe&&++a<$fe);return p}function zw(e,t,n,r){if(e===t&&n===r)return Ld;const l=d=>qfe(d,0,1,e,n);return d=>d===0||d===1?d:Fq(l(d),t,r)}const Bq=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Vq=e=>t=>1-e(1-t),Uq=zw(.33,1.53,.69,.99),dN=Vq(Uq),$q=Bq(dN),qq=e=>(e*=2)<1?.5*dN(e):.5*(2-Math.pow(2,-10*(e-1))),hN=e=>1-Math.sin(Math.acos(e)),Hq=Vq(hN),Gq=Bq(hN),Hfe=zw(.42,0,1,1),Gfe=zw(0,0,.58,1),Wq=zw(.42,0,.58,1),Wfe=e=>Array.isArray(e)&&typeof e[0]!="number",Zq=e=>Array.isArray(e)&&typeof e[0]=="number",Zfe={linear:Ld,easeIn:Hfe,easeInOut:Wq,easeOut:Gfe,circIn:hN,circInOut:Gq,circOut:Hq,backIn:dN,backInOut:$q,backOut:Uq,anticipate:qq},Xfe=e=>typeof e=="string",Gz=e=>{if(Zq(e)){lN(e.length===4);const[t,n,r,l]=e;return zw(t,n,r,l)}else if(Xfe(e))return Zfe[e];return e},CS=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],Wz={value:null};function Kfe(e,t){let n=new Set,r=new Set,l=!1,d=!1;const p=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1},b=0;function T(P){p.has(P)&&(E.schedule(P),e()),b++,P(a)}const E={schedule:(P,I=!1,R=!1)=>{const W=R&&l?n:r;return I&&p.add(P),W.has(P)||W.add(P),P},cancel:P=>{r.delete(P),p.delete(P)},process:P=>{if(a=P,l){d=!0;return}l=!0,[n,r]=[r,n],n.forEach(T),t&&Wz.value&&Wz.value.frameloop[t].push(b),b=0,n.clear(),l=!1,d&&(d=!1,E.process(P))}};return E}const Yfe=40;function Xq(e,t){let n=!1,r=!0;const l={delta:0,timestamp:0,isProcessing:!1},d=()=>n=!0,p=CS.reduce((ie,ge)=>(ie[ge]=Kfe(d,t?ge:void 0),ie),{}),{setup:a,read:b,resolveKeyframes:T,preUpdate:E,update:P,preRender:I,render:R,postRender:F}=p,W=()=>{const ie=Dm.useManualTiming?l.timestamp:performance.now();n=!1,Dm.useManualTiming||(l.delta=r?1e3/60:Math.max(Math.min(ie-l.timestamp,Yfe),1)),l.timestamp=ie,l.isProcessing=!0,a.process(l),b.process(l),T.process(l),E.process(l),P.process(l),I.process(l),R.process(l),F.process(l),l.isProcessing=!1,n&&t&&(r=!1,e(W))},$=()=>{n=!0,r=!0,l.isProcessing||e(W)};return{schedule:CS.reduce((ie,ge)=>{const ae=p[ge];return ie[ge]=(se,me=!1,ke=!1)=>(n||$(),ae.schedule(se,me,ke)),ie},{}),cancel:ie=>{for(let ge=0;ge<CS.length;ge++)p[CS[ge]].cancel(ie)},state:l,steps:p}}const{schedule:ys,cancel:rx,state:fl,steps:e4}=Xq(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ld,!0);let fT;function Qfe(){fT=void 0}const $c={now:()=>(fT===void 0&&$c.set(fl.isProcessing||Dm.useManualTiming?fl.timestamp:performance.now()),fT),set:e=>{fT=e,queueMicrotask(Qfe)}},Kq=e=>t=>typeof t=="string"&&t.startsWith(e),fN=Kq("--"),Jfe=Kq("var(--"),pN=e=>Jfe(e)?epe.test(e.split("/*")[0].trim()):!1,epe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,A_={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},sw={...A_,transform:e=>Nm(0,1,e)},jS={...A_,default:1},Rb=e=>Math.round(e*1e5)/1e5,mN=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function tpe(e){return e==null}const npe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,gN=(e,t)=>n=>!!(typeof n=="string"&&npe.test(n)&&n.startsWith(e)||t&&!tpe(n)&&Object.prototype.hasOwnProperty.call(n,t)),Yq=(e,t,n)=>r=>{if(typeof r!="string")return r;const[l,d,p,a]=r.match(mN);return{[e]:parseFloat(l),[t]:parseFloat(d),[n]:parseFloat(p),alpha:a!==void 0?parseFloat(a):1}},rpe=e=>Nm(0,255,e),t4={...A_,transform:e=>Math.round(rpe(e))},$0={test:gN("rgb","red"),parse:Yq("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+t4.transform(e)+", "+t4.transform(t)+", "+t4.transform(n)+", "+Rb(sw.transform(r))+")"};function ipe(e){let t="",n="",r="",l="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),l=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),l=e.substring(4,5),t+=t,n+=n,r+=r,l+=l),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:l?parseInt(l,16)/255:1}}const ZM={test:gN("#"),parse:ipe,transform:$0.transform},Lw=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Vg=Lw("deg"),np=Lw("%"),oi=Lw("px"),ape=Lw("vh"),spe=Lw("vw"),Zz={...np,parse:e=>np.parse(e)/100,transform:e=>np.transform(e*100)},Wv={test:gN("hsl","hue"),parse:Yq("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+np.transform(Rb(t))+", "+np.transform(Rb(n))+", "+Rb(sw.transform(r))+")"},Ul={test:e=>$0.test(e)||ZM.test(e)||Wv.test(e),parse:e=>$0.test(e)?$0.parse(e):Wv.test(e)?Wv.parse(e):ZM.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?$0.transform(e):Wv.transform(e)},ope=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function lpe(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(mN))==null?void 0:t.length)||0)+(((n=e.match(ope))==null?void 0:n.length)||0)>0}const Qq="number",Jq="color",cpe="var",upe="var(",Xz="${}",dpe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ow(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},l=[];let d=0;const a=t.replace(dpe,b=>(Ul.test(b)?(r.color.push(d),l.push(Jq),n.push(Ul.parse(b))):b.startsWith(upe)?(r.var.push(d),l.push(cpe),n.push(b)):(r.number.push(d),l.push(Qq),n.push(parseFloat(b))),++d,Xz)).split(Xz);return{values:n,split:a,indexes:r,types:l}}function eH(e){return ow(e).values}function tH(e){const{split:t,types:n}=ow(e),r=t.length;return l=>{let d="";for(let p=0;p<r;p++)if(d+=t[p],l[p]!==void 0){const a=n[p];a===Qq?d+=Rb(l[p]):a===Jq?d+=Ul.transform(l[p]):d+=l[p]}return d}}const hpe=e=>typeof e=="number"?0:e;function fpe(e){const t=eH(e);return tH(e)(t.map(hpe))}const ix={test:lpe,parse:eH,createTransformer:tH,getAnimatableNone:fpe};function n4(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function ppe({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let l=0,d=0,p=0;if(!t)l=d=p=n;else{const a=n<.5?n*(1+t):n+t-n*t,b=2*n-a;l=n4(b,a,e+1/3),d=n4(b,a,e),p=n4(b,a,e-1/3)}return{red:Math.round(l*255),green:Math.round(d*255),blue:Math.round(p*255),alpha:r}}function KT(e,t){return n=>n>0?t:e}const ms=(e,t,n)=>e+(t-e)*n,r4=(e,t,n)=>{const r=e*e,l=n*(t*t-r)+r;return l<0?0:Math.sqrt(l)},mpe=[ZM,$0,Wv],gpe=e=>mpe.find(t=>t.test(e));function Kz(e){const t=gpe(e);if(!t)return!1;let n=t.parse(e);return t===Wv&&(n=ppe(n)),n}const Yz=(e,t)=>{const n=Kz(e),r=Kz(t);if(!n||!r)return KT(e,t);const l={...n};return d=>(l.red=r4(n.red,r.red,d),l.green=r4(n.green,r.green,d),l.blue=r4(n.blue,r.blue,d),l.alpha=ms(n.alpha,r.alpha,d),$0.transform(l))},XM=new Set(["none","hidden"]);function xpe(e,t){return XM.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}function ype(e,t){return n=>ms(e,t,n)}function xN(e){return typeof e=="number"?ype:typeof e=="string"?pN(e)?KT:Ul.test(e)?Yz:bpe:Array.isArray(e)?nH:typeof e=="object"?Ul.test(e)?Yz:vpe:KT}function nH(e,t){const n=[...e],r=n.length,l=e.map((d,p)=>xN(d)(d,t[p]));return d=>{for(let p=0;p<r;p++)n[p]=l[p](d);return n}}function vpe(e,t){const n={...e,...t},r={};for(const l in n)e[l]!==void 0&&t[l]!==void 0&&(r[l]=xN(e[l])(e[l],t[l]));return l=>{for(const d in r)n[d]=r[d](l);return n}}function _pe(e,t){const n=[],r={color:0,var:0,number:0};for(let l=0;l<t.values.length;l++){const d=t.types[l],p=e.indexes[d][r[d]],a=e.values[p]??0;n[l]=a,r[d]++}return n}const bpe=(e,t)=>{const n=ix.createTransformer(t),r=ow(e),l=ow(t);return r.indexes.var.length===l.indexes.var.length&&r.indexes.color.length===l.indexes.color.length&&r.indexes.number.length>=l.indexes.number.length?XM.has(e)&&!l.values.length||XM.has(t)&&!r.values.length?xpe(e,t):Rw(nH(_pe(r,l),l.values),n):KT(e,t)};function rH(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?ms(e,t,n):xN(e)(e,t)}const wpe=e=>{const t=({timestamp:n})=>e(n);return{start:(n=!0)=>ys.update(t,n),stop:()=>rx(t),now:()=>fl.isProcessing?fl.timestamp:$c.now()}},iH=(e,t,n=10)=>{let r="";const l=Math.max(Math.round(t/n),2);for(let d=0;d<l;d++)r+=e(d/(l-1))+", ";return`linear(${r.substring(0,r.length-2)})`},YT=2e4;function yN(e){let t=0;const n=50;let r=e.next(t);for(;!r.done&&t<YT;)t+=n,r=e.next(t);return t>=YT?1/0:t}function Spe(e,t=100,n){const r=n({...e,keyframes:[0,t]}),l=Math.min(yN(r),YT);return{type:"keyframes",ease:d=>r.next(l*d).value/t,duration:tp(l)}}const Tpe=5;function aH(e,t,n){const r=Math.max(t-Tpe,0);return Lq(n-e(r),t-r)}const Cs={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Qz=.001;function Epe({duration:e=Cs.duration,bounce:t=Cs.bounce,velocity:n=Cs.velocity,mass:r=Cs.mass}){let l,d,p=1-t;p=Nm(Cs.minDamping,Cs.maxDamping,p),e=Nm(Cs.minDuration,Cs.maxDuration,tp(e)),p<1?(l=T=>{const E=T*p,P=E*e,I=E-n,R=KM(T,p),F=Math.exp(-P);return Qz-I/R*F},d=T=>{const P=T*p*e,I=P*n+n,R=Math.pow(p,2)*Math.pow(T,2)*e,F=Math.exp(-P),W=KM(Math.pow(T,2),p);return(-l(T)+Qz>0?-1:1)*((I-R)*F)/W}):(l=T=>{const E=Math.exp(-T*e),P=(T-n)*e+1;return-.001+E*P},d=T=>{const E=Math.exp(-T*e),P=(n-T)*(e*e);return E*P});const a=5/e,b=Cpe(l,d,a);if(e=ep(e),isNaN(b))return{stiffness:Cs.stiffness,damping:Cs.damping,duration:e};{const T=Math.pow(b,2)*r;return{stiffness:T,damping:p*2*Math.sqrt(r*T),duration:e}}}const Ape=12;function Cpe(e,t,n){let r=n;for(let l=1;l<Ape;l++)r=r-e(r)/t(r);return r}function KM(e,t){return e*Math.sqrt(1-t*t)}const jpe=["duration","bounce"],Mpe=["stiffness","damping","mass"];function Jz(e,t){return t.some(n=>e[n]!==void 0)}function Ppe(e){let t={velocity:Cs.velocity,stiffness:Cs.stiffness,damping:Cs.damping,mass:Cs.mass,isResolvedFromDuration:!1,...e};if(!Jz(e,Mpe)&&Jz(e,jpe))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(n*1.2),l=r*r,d=2*Nm(.05,1,1-(e.bounce||0))*Math.sqrt(l);t={...t,mass:Cs.mass,stiffness:l,damping:d}}else{const n=Epe(e);t={...t,...n,mass:Cs.mass},t.isResolvedFromDuration=!0}return t}function QT(e=Cs.visualDuration,t=Cs.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:l}=n;const d=n.keyframes[0],p=n.keyframes[n.keyframes.length-1],a={done:!1,value:d},{stiffness:b,damping:T,mass:E,duration:P,velocity:I,isResolvedFromDuration:R}=Ppe({...n,velocity:-tp(n.velocity||0)}),F=I||0,W=T/(2*Math.sqrt(b*E)),$=p-d,Z=tp(Math.sqrt(b/E)),ne=Math.abs($)<5;r||(r=ne?Cs.restSpeed.granular:Cs.restSpeed.default),l||(l=ne?Cs.restDelta.granular:Cs.restDelta.default);let ie;if(W<1){const ae=KM(Z,W);ie=se=>{const me=Math.exp(-W*Z*se);return p-me*((F+W*Z*$)/ae*Math.sin(ae*se)+$*Math.cos(ae*se))}}else if(W===1)ie=ae=>p-Math.exp(-Z*ae)*($+(F+Z*$)*ae);else{const ae=Z*Math.sqrt(W*W-1);ie=se=>{const me=Math.exp(-W*Z*se),ke=Math.min(ae*se,300);return p-me*((F+W*Z*$)*Math.sinh(ke)+ae*$*Math.cosh(ke))/ae}}const ge={calculatedDuration:R&&P||null,next:ae=>{const se=ie(ae);if(R)a.done=ae>=P;else{let me=ae===0?F:0;W<1&&(me=ae===0?ep(F):aH(ie,ae,se));const ke=Math.abs(me)<=r,qe=Math.abs(p-se)<=l;a.done=ke&&qe}return a.value=a.done?p:se,a},toString:()=>{const ae=Math.min(yN(ge),YT),se=iH(me=>ge.next(ae*me).value,ae,30);return ae+"ms "+se},toTransition:()=>{}};return ge}QT.applyToOptions=e=>{const t=Spe(e,100,QT);return e.ease=t.ease,e.duration=ep(t.duration),e.type="keyframes",e};function YM({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:l=10,bounceStiffness:d=500,modifyTarget:p,min:a,max:b,restDelta:T=.5,restSpeed:E}){const P=e[0],I={done:!1,value:P},R=ke=>a!==void 0&&ke<a||b!==void 0&&ke>b,F=ke=>a===void 0?b:b===void 0||Math.abs(a-ke)<Math.abs(b-ke)?a:b;let W=n*t;const $=P+W,Z=p===void 0?$:p($);Z!==$&&(W=Z-P);const ne=ke=>-W*Math.exp(-ke/r),ie=ke=>Z+ne(ke),ge=ke=>{const qe=ne(ke),tt=ie(ke);I.done=Math.abs(qe)<=T,I.value=I.done?Z:tt};let ae,se;const me=ke=>{R(I.value)&&(ae=ke,se=QT({keyframes:[I.value,F(I.value)],velocity:aH(ie,ke,I.value),damping:l,stiffness:d,restDelta:T,restSpeed:E}))};return me(0),{calculatedDuration:null,next:ke=>{let qe=!1;return!se&&ae===void 0&&(qe=!0,ge(ke),me(ke)),ae!==void 0&&ke>=ae?se.next(ke-ae):(!qe&&ge(ke),I)}}}function Npe(e,t,n){const r=[],l=n||Dm.mix||rH,d=e.length-1;for(let p=0;p<d;p++){let a=l(e[p],e[p+1]);if(t){const b=Array.isArray(t)?t[p]||Ld:t;a=Rw(b,a)}r.push(a)}return r}function Dpe(e,t,{clamp:n=!0,ease:r,mixer:l}={}){const d=e.length;if(lN(d===t.length),d===1)return()=>t[0];if(d===2&&t[0]===t[1])return()=>t[1];const p=e[0]===e[1];e[0]>e[d-1]&&(e=[...e].reverse(),t=[...t].reverse());const a=Npe(t,r,l),b=a.length,T=E=>{if(p&&E<e[0])return t[0];let P=0;if(b>1)for(;P<e.length-2&&!(E<e[P+1]);P++);const I=aw(e[P],e[P+1],E);return a[P](I)};return n?E=>T(Nm(e[0],e[d-1],E)):T}function Ope(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const l=aw(0,t,r);e.push(ms(n,1,l))}}function Ipe(e){const t=[0];return Ope(t,e.length-1),t}function kpe(e,t){return e.map(n=>n*t)}function Rpe(e,t){return e.map(()=>t||Wq).splice(0,e.length-1)}function zb({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const l=Wfe(r)?r.map(Gz):Gz(r),d={done:!1,value:t[0]},p=kpe(n&&n.length===t.length?n:Ipe(t),e),a=Dpe(p,t,{ease:Array.isArray(l)?l:Rpe(t,l)});return{calculatedDuration:e,next:b=>(d.value=a(b),d.done=b>=e,d)}}const zpe=e=>e!==null;function vN(e,{repeat:t,repeatType:n="loop"},r,l=1){const d=e.filter(zpe),a=l<0||t&&n!=="loop"&&t%2===1?0:d.length-1;return!a||r===void 0?d[a]:r}const Lpe={decay:YM,inertia:YM,tween:zb,keyframes:zb,spring:QT};function sH(e){typeof e.type=="string"&&(e.type=Lpe[e.type])}class _N{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const Fpe=e=>e/100;class bN extends _N{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var r,l;const{motionValue:n}=this.options;n&&n.updatedAt!==$c.now()&&this.tick($c.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(l=(r=this.options).onStop)==null||l.call(r))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;sH(t);const{type:n=zb,repeat:r=0,repeatDelay:l=0,repeatType:d,velocity:p=0}=t;let{keyframes:a}=t;const b=n||zb;b!==zb&&typeof a[0]!="number"&&(this.mixKeyframes=Rw(Fpe,rH(a[0],a[1])),a=[0,100]);const T=b({...t,keyframes:a});d==="mirror"&&(this.mirroredGenerator=b({...t,keyframes:[...a].reverse(),velocity:-p})),T.calculatedDuration===null&&(T.calculatedDuration=yN(T));const{calculatedDuration:E}=T;this.calculatedDuration=E,this.resolvedDuration=E+l,this.totalDuration=this.resolvedDuration*(r+1)-l,this.generator=T}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:r,totalDuration:l,mixKeyframes:d,mirroredGenerator:p,resolvedDuration:a,calculatedDuration:b}=this;if(this.startTime===null)return r.next(0);const{delay:T=0,keyframes:E,repeat:P,repeatType:I,repeatDelay:R,type:F,onUpdate:W,finalKeyframe:$}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-l/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const Z=this.currentTime-T*(this.playbackSpeed>=0?1:-1),ne=this.playbackSpeed>=0?Z<0:Z>l;this.currentTime=Math.max(Z,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=l);let ie=this.currentTime,ge=r;if(P){const ke=Math.min(this.currentTime,l)/a;let qe=Math.floor(ke),tt=ke%1;!tt&&ke>=1&&(tt=1),tt===1&&qe--,qe=Math.min(qe,P+1),!!(qe%2)&&(I==="reverse"?(tt=1-tt,R&&(tt-=R/a)):I==="mirror"&&(ge=p)),ie=Nm(0,1,tt)*a}const ae=ne?{done:!1,value:E[0]}:ge.next(ie);d&&(ae.value=d(ae.value));let{done:se}=ae;!ne&&b!==null&&(se=this.playbackSpeed>=0?this.currentTime>=l:this.currentTime<=0);const me=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&se);return me&&F!==YM&&(ae.value=vN(E,this.options,$,this.speed)),W&&W(ae.value),me&&this.finish(),ae}then(t,n){return this.finished.then(t,n)}get duration(){return tp(this.calculatedDuration)}get time(){return tp(this.currentTime)}set time(t){var n;t=ep(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime($c.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=tp(this.currentTime))}play(){var l,d;if(this.isStopped)return;const{driver:t=wpe,startTime:n}=this.options;this.driver||(this.driver=t(p=>this.tick(p))),(d=(l=this.options).onPlay)==null||d.call(l);const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=n??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime($c.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(t=this.options).onComplete)==null||n.call(t)}cancel(){var t,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(t=this.options).onCancel)==null||n.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),t.observe(this)}}function Bpe(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const q0=e=>e*180/Math.PI,QM=e=>{const t=q0(Math.atan2(e[1],e[0]));return JM(t)},Vpe={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:QM,rotateZ:QM,skewX:e=>q0(Math.atan(e[1])),skewY:e=>q0(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},JM=e=>(e=e%360,e<0&&(e+=360),e),eL=QM,tL=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),nL=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),Upe={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:tL,scaleY:nL,scale:e=>(tL(e)+nL(e))/2,rotateX:e=>JM(q0(Math.atan2(e[6],e[5]))),rotateY:e=>JM(q0(Math.atan2(-e[2],e[0]))),rotateZ:eL,rotate:eL,skewX:e=>q0(Math.atan(e[4])),skewY:e=>q0(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function e5(e){return e.includes("scale")?1:0}function t5(e,t){if(!e||e==="none")return e5(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,l;if(n)r=Upe,l=n;else{const a=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=Vpe,l=a}if(!l)return e5(t);const d=r[t],p=l[1].split(",").map(qpe);return typeof d=="function"?d(p):p[d]}const $pe=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return t5(n,t)};function qpe(e){return parseFloat(e.trim())}const C_=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],j_=new Set(C_),rL=e=>e===A_||e===oi,Hpe=new Set(["x","y","z"]),Gpe=C_.filter(e=>!Hpe.has(e));function Wpe(e){const t=[];return Gpe.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}const ny={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>t5(t,"x"),y:(e,{transform:t})=>t5(t,"y")};ny.translateX=ny.x;ny.translateY=ny.y;const ry=new Set;let n5=!1,r5=!1,i5=!1;function oH(){if(r5){const e=Array.from(ry).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),n=new Map;t.forEach(r=>{const l=Wpe(r);l.length&&(n.set(r,l),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const l=n.get(r);l&&l.forEach(([d,p])=>{var a;(a=r.getValue(d))==null||a.set(p)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}r5=!1,n5=!1,ry.forEach(e=>e.complete(i5)),ry.clear()}function lH(){ry.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(r5=!0)})}function Zpe(){i5=!0,lH(),oH(),i5=!1}class wN{constructor(t,n,r,l,d,p=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=r,this.motionValue=l,this.element=d,this.isAsync=p}scheduleResolve(){this.state="scheduled",this.isAsync?(ry.add(this),n5||(n5=!0,ys.read(lH),ys.resolveKeyframes(oH))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:r,motionValue:l}=this;if(t[0]===null){const d=l==null?void 0:l.get(),p=t[t.length-1];if(d!==void 0)t[0]=d;else if(r&&n){const a=r.readValue(n,p);a!=null&&(t[0]=a)}t[0]===void 0&&(t[0]=p),l&&d===void 0&&l.set(t[0])}Bpe(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),ry.delete(this)}cancel(){this.state==="scheduled"&&(ry.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const Xpe=e=>e.startsWith("--");function Kpe(e,t,n){Xpe(t)?e.style.setProperty(t,n):e.style[t]=n}const Ype=cN(()=>window.ScrollTimeline!==void 0),Qpe={};function Jpe(e,t){const n=cN(e);return()=>Qpe[t]??n()}const cH=Jpe(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),wb=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,iL={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:wb([0,.65,.55,1]),circOut:wb([.55,0,1,.45]),backIn:wb([.31,.01,.66,-.59]),backOut:wb([.33,1.53,.69,.99])};function uH(e,t){if(e)return typeof e=="function"?cH()?iH(e,t):"ease-out":Zq(e)?wb(e):Array.isArray(e)?e.map(n=>uH(n,t)||iL.easeOut):iL[e]}function eme(e,t,n,{delay:r=0,duration:l=300,repeat:d=0,repeatType:p="loop",ease:a="easeOut",times:b}={},T=void 0){const E={[t]:n};b&&(E.offset=b);const P=uH(a,l);Array.isArray(P)&&(E.easing=P);const I={delay:r,duration:l,easing:Array.isArray(P)?"linear":P,fill:"both",iterations:d+1,direction:p==="reverse"?"alternate":"normal"};return T&&(I.pseudoElement=T),e.animate(E,I)}function dH(e){return typeof e=="function"&&"applyToOptions"in e}function tme({type:e,...t}){return dH(e)&&cH()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class nme extends _N{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:n,name:r,keyframes:l,pseudoElement:d,allowFlatten:p=!1,finalKeyframe:a,onComplete:b}=t;this.isPseudoElement=!!d,this.allowFlatten=p,this.options=t,lN(typeof t.type!="string");const T=tme(t);this.animation=eme(n,r,l,T,d),T.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!d){const E=vN(l,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(E):Kpe(n,r,E),this.animation.cancel()}b==null||b(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,n;(n=(t=this.animation).finish)==null||n.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,n;this.isPseudoElement||(n=(t=this.animation).commitStyles)==null||n.call(t)}get duration(){var n,r;const t=((r=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:r.call(n).duration)||0;return tp(Number(t))}get time(){return tp(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=ep(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&Ype()?(this.animation.timeline=t,Ld):n(this)}}const hH={anticipate:qq,backInOut:$q,circInOut:Gq};function rme(e){return e in hH}function ime(e){typeof e.ease=="string"&&rme(e.ease)&&(e.ease=hH[e.ease])}const aL=10;class ame extends nme{constructor(t){ime(t),sH(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:r,onComplete:l,element:d,...p}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const a=new bN({...p,autoplay:!1}),b=ep(this.finishedTime??this.time);n.setWithVelocity(a.sample(b-aL).value,a.sample(b).value,aL),a.stop()}}const sL=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(ix.test(e)||e==="0")&&!e.startsWith("url("));function sme(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function ome(e,t,n,r){const l=e[0];if(l===null)return!1;if(t==="display"||t==="visibility")return!0;const d=e[e.length-1],p=sL(l,t),a=sL(d,t);return!p||!a?!1:sme(e)||(n==="spring"||dH(n))&&r}function SN(e){return Rq(e)&&"offsetHeight"in e}const lme=new Set(["opacity","clipPath","filter","transform"]),cme=cN(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function ume(e){var T;const{motionValue:t,name:n,repeatDelay:r,repeatType:l,damping:d,type:p}=e;if(!SN((T=t==null?void 0:t.owner)==null?void 0:T.current))return!1;const{onUpdate:a,transformTemplate:b}=t.owner.getProps();return cme()&&n&&lme.has(n)&&(n!=="transform"||!b)&&!a&&!r&&l!=="mirror"&&d!==0&&p!=="inertia"}const dme=40;class hme extends _N{constructor({autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:l=0,repeatDelay:d=0,repeatType:p="loop",keyframes:a,name:b,motionValue:T,element:E,...P}){var F;super(),this.stop=()=>{var W,$;this._animation&&(this._animation.stop(),(W=this.stopTimeline)==null||W.call(this)),($=this.keyframeResolver)==null||$.cancel()},this.createdAt=$c.now();const I={autoplay:t,delay:n,type:r,repeat:l,repeatDelay:d,repeatType:p,name:b,motionValue:T,element:E,...P},R=(E==null?void 0:E.KeyframeResolver)||wN;this.keyframeResolver=new R(a,(W,$,Z)=>this.onKeyframesResolved(W,$,I,!Z),b,T,E),(F=this.keyframeResolver)==null||F.scheduleResolve()}onKeyframesResolved(t,n,r,l){this.keyframeResolver=void 0;const{name:d,type:p,velocity:a,delay:b,isHandoff:T,onUpdate:E}=r;this.resolvedAt=$c.now(),ome(t,d,p,a)||((Dm.instantAnimations||!b)&&(E==null||E(vN(t,r,n))),t[0]=t[t.length-1],r.duration=0,r.repeat=0);const I={startTime:l?this.resolvedAt?this.resolvedAt-this.createdAt>dme?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:t},R=!T&&ume(I)?new ame({...I,element:I.motionValue.owner.current}):new bN(I);R.finished.then(()=>this.notifyFinished()).catch(Ld),this.pendingTimeline&&(this.stopTimeline=R.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=R}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),Zpe()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}const fme=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function pme(e){const t=fme.exec(e);if(!t)return[,];const[,n,r,l]=t;return[`--${n??r}`,l]}function fH(e,t,n=1){const[r,l]=pme(e);if(!r)return;const d=window.getComputedStyle(t).getPropertyValue(r);if(d){const p=d.trim();return kq(p)?parseFloat(p):p}return pN(l)?fH(l,t,n+1):l}function TN(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const pH=new Set(["width","height","top","left","right","bottom",...C_]),mme={test:e=>e==="auto",parse:e=>e},mH=e=>t=>t.test(e),gH=[A_,oi,np,Vg,spe,ape,mme],oL=e=>gH.find(mH(e));function gme(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||zq(e):!0}const xme=new Set(["brightness","contrast","saturate","opacity"]);function yme(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match(mN)||[];if(!r)return e;const l=n.replace(r,"");let d=xme.has(t)?1:0;return r!==n&&(d*=100),t+"("+d+l+")"}const vme=/\b([a-z-]*)\(.*?\)/gu,a5={...ix,getAnimatableNone:e=>{const t=e.match(vme);return t?t.map(yme).join(" "):e}},lL={...A_,transform:Math.round},_me={rotate:Vg,rotateX:Vg,rotateY:Vg,rotateZ:Vg,scale:jS,scaleX:jS,scaleY:jS,scaleZ:jS,skew:Vg,skewX:Vg,skewY:Vg,distance:oi,translateX:oi,translateY:oi,translateZ:oi,x:oi,y:oi,z:oi,perspective:oi,transformPerspective:oi,opacity:sw,originX:Zz,originY:Zz,originZ:oi},EN={borderWidth:oi,borderTopWidth:oi,borderRightWidth:oi,borderBottomWidth:oi,borderLeftWidth:oi,borderRadius:oi,radius:oi,borderTopLeftRadius:oi,borderTopRightRadius:oi,borderBottomRightRadius:oi,borderBottomLeftRadius:oi,width:oi,maxWidth:oi,height:oi,maxHeight:oi,top:oi,right:oi,bottom:oi,left:oi,padding:oi,paddingTop:oi,paddingRight:oi,paddingBottom:oi,paddingLeft:oi,margin:oi,marginTop:oi,marginRight:oi,marginBottom:oi,marginLeft:oi,backgroundPositionX:oi,backgroundPositionY:oi,..._me,zIndex:lL,fillOpacity:sw,strokeOpacity:sw,numOctaves:lL},bme={...EN,color:Ul,backgroundColor:Ul,outlineColor:Ul,fill:Ul,stroke:Ul,borderColor:Ul,borderTopColor:Ul,borderRightColor:Ul,borderBottomColor:Ul,borderLeftColor:Ul,filter:a5,WebkitFilter:a5},xH=e=>bme[e];function yH(e,t){let n=xH(e);return n!==a5&&(n=ix),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const wme=new Set(["auto","none","0"]);function Sme(e,t,n){let r=0,l;for(;r<e.length&&!l;){const d=e[r];typeof d=="string"&&!wme.has(d)&&ow(d).values.length&&(l=e[r]),r++}if(l&&n)for(const d of t)e[d]=yH(n,l)}class Tme extends wN{constructor(t,n,r,l,d){super(t,n,r,l,d,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let b=0;b<t.length;b++){let T=t[b];if(typeof T=="string"&&(T=T.trim(),pN(T))){const E=fH(T,n.current);E!==void 0&&(t[b]=E),b===t.length-1&&(this.finalKeyframe=T)}}if(this.resolveNoneKeyframes(),!pH.has(r)||t.length!==2)return;const[l,d]=t,p=oL(l),a=oL(d);if(p!==a)if(rL(p)&&rL(a))for(let b=0;b<t.length;b++){const T=t[b];typeof T=="string"&&(t[b]=parseFloat(T))}else ny[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,r=[];for(let l=0;l<t.length;l++)(t[l]===null||gme(t[l]))&&r.push(l);r.length&&Sme(t,r,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=ny[r](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const l=n[n.length-1];l!==void 0&&t.getValue(r,l).jump(l,!1)}measureEndState(){var a;const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const l=t.getValue(n);l&&l.jump(this.measuredOrigin,!1);const d=r.length-1,p=r[d];r[d]=ny[n](t.measureViewportBox(),window.getComputedStyle(t.current)),p!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=p),(a=this.removedTransforms)!=null&&a.length&&this.removedTransforms.forEach(([b,T])=>{t.getValue(b).set(T)}),this.resolveNoneKeyframes()}}function Eme(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let r=document;const l=(n==null?void 0:n[e])??r.querySelectorAll(e);return l?Array.from(l):[]}return Array.from(e)}const vH=(e,t)=>t&&typeof e=="number"?t.transform(e):e,cL=30,Ame=e=>!isNaN(parseFloat(e));class Cme{constructor(t,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,l=!0)=>{var p,a;const d=$c.now();if(this.updatedAt!==d&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((p=this.events.change)==null||p.notify(this.current),this.dependents))for(const b of this.dependents)b.dirty();l&&((a=this.events.renderRequest)==null||a.notify(this.current))},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=$c.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=Ame(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new uN);const r=this.events[t].add(n);return t==="change"?()=>{r(),ys.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=$c.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>cL)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,cL);return Lq(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,n;(t=this.dependents)==null||t.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function d_(e,t){return new Cme(e,t)}const{schedule:AN}=Xq(queueMicrotask,!1),Hh={x:!1,y:!1};function _H(){return Hh.x||Hh.y}function jme(e){return e==="x"||e==="y"?Hh[e]?null:(Hh[e]=!0,()=>{Hh[e]=!1}):Hh.x||Hh.y?null:(Hh.x=Hh.y=!0,()=>{Hh.x=Hh.y=!1})}function bH(e,t){const n=Eme(e),r=new AbortController,l={passive:!0,...t,signal:r.signal};return[n,l,()=>r.abort()]}function uL(e){return!(e.pointerType==="touch"||_H())}function Mme(e,t,n={}){const[r,l,d]=bH(e,n),p=a=>{if(!uL(a))return;const{target:b}=a,T=t(b,a);if(typeof T!="function"||!b)return;const E=P=>{uL(P)&&(T(P),b.removeEventListener("pointerleave",E))};b.addEventListener("pointerleave",E,l)};return r.forEach(a=>{a.addEventListener("pointerenter",p,l)}),d}const wH=(e,t)=>t?e===t?!0:wH(e,t.parentElement):!1,CN=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,Pme=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Nme(e){return Pme.has(e.tagName)||e.tabIndex!==-1}const pT=new WeakSet;function dL(e){return t=>{t.key==="Enter"&&e(t)}}function i4(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const Dme=(e,t)=>{const n=e.currentTarget;if(!n)return;const r=dL(()=>{if(pT.has(n))return;i4(n,"down");const l=dL(()=>{i4(n,"up")}),d=()=>i4(n,"cancel");n.addEventListener("keyup",l,t),n.addEventListener("blur",d,t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function hL(e){return CN(e)&&!_H()}function Ome(e,t,n={}){const[r,l,d]=bH(e,n),p=a=>{const b=a.currentTarget;if(!hL(a))return;pT.add(b);const T=t(b,a),E=(R,F)=>{window.removeEventListener("pointerup",P),window.removeEventListener("pointercancel",I),pT.has(b)&&pT.delete(b),hL(R)&&typeof T=="function"&&T(R,{success:F})},P=R=>{E(R,b===window||b===document||n.useGlobalTarget||wH(b,R.target))},I=R=>{E(R,!1)};window.addEventListener("pointerup",P,l),window.addEventListener("pointercancel",I,l)};return r.forEach(a=>{(n.useGlobalTarget?window:a).addEventListener("pointerdown",p,l),SN(a)&&(a.addEventListener("focus",T=>Dme(T,l)),!Nme(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),d}function SH(e){return Rq(e)&&"ownerSVGElement"in e}function Ime(e){return SH(e)&&e.tagName==="svg"}const Wl=e=>!!(e&&e.getVelocity),kme=[...gH,Ul,ix],Rme=e=>kme.find(mH(e)),jN=V.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class zme extends V.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=n.offsetParent,l=SN(r)&&r.offsetWidth||0,d=this.props.sizeRef.current;d.height=n.offsetHeight||0,d.width=n.offsetWidth||0,d.top=n.offsetTop,d.left=n.offsetLeft,d.right=l-d.width-d.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Lme({children:e,isPresent:t,anchorX:n}){const r=V.useId(),l=V.useRef(null),d=V.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:p}=V.useContext(jN);return V.useInsertionEffect(()=>{const{width:a,height:b,top:T,left:E,right:P}=d.current;if(t||!l.current||!a||!b)return;const I=n==="left"?`left: ${E}`:`right: ${P}`;l.current.dataset.motionPopId=r;const R=document.createElement("style");return p&&(R.nonce=p),document.head.appendChild(R),R.sheet&&R.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${b}px !important;
            ${I}px !important;
            top: ${T}px !important;
          }
        `),()=>{document.head.contains(R)&&document.head.removeChild(R)}},[t]),f.jsx(zme,{isPresent:t,childRef:l,sizeRef:d,children:V.cloneElement(e,{ref:l})})}const Fme=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:l,presenceAffectsLayout:d,mode:p,anchorX:a})=>{const b=iN(Bme),T=V.useId();let E=!0,P=V.useMemo(()=>(E=!1,{id:T,initial:t,isPresent:n,custom:l,onExitComplete:I=>{b.set(I,!0);for(const R of b.values())if(!R)return;r&&r()},register:I=>(b.set(I,!1),()=>b.delete(I))}),[n,b,r]);return d&&E&&(P={...P}),V.useMemo(()=>{b.forEach((I,R)=>b.set(R,!1))},[n]),V.useEffect(()=>{!n&&!b.size&&r&&r()},[n]),p==="popLayout"&&(e=f.jsx(Lme,{isPresent:n,anchorX:a,children:e})),f.jsx(m3.Provider,{value:P,children:e})};function Bme(){return new Map}function TH(e=!0){const t=V.useContext(m3);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:l}=t,d=V.useId();V.useEffect(()=>{if(e)return l(d)},[e]);const p=V.useCallback(()=>e&&r&&r(d),[d,r,e]);return!n&&r?[!1,p]:[!0]}const MS=e=>e.key||"";function fL(e){const t=[];return V.Children.forEach(e,n=>{V.isValidElement(n)&&t.push(n)}),t}const ax=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:l=!0,mode:d="sync",propagate:p=!1,anchorX:a="left"})=>{const[b,T]=TH(p),E=V.useMemo(()=>fL(e),[e]),P=p&&!b?[]:E.map(MS),I=V.useRef(!0),R=V.useRef(E),F=iN(()=>new Map),[W,$]=V.useState(E),[Z,ne]=V.useState(E);Iq(()=>{I.current=!1,R.current=E;for(let ae=0;ae<Z.length;ae++){const se=MS(Z[ae]);P.includes(se)?F.delete(se):F.get(se)!==!0&&F.set(se,!1)}},[Z,P.length,P.join("-")]);const ie=[];if(E!==W){let ae=[...E];for(let se=0;se<Z.length;se++){const me=Z[se],ke=MS(me);P.includes(ke)||(ae.splice(se,0,me),ie.push(me))}return d==="wait"&&ie.length&&(ae=ie),ne(fL(ae)),$(E),null}const{forceRender:ge}=V.useContext(rN);return f.jsx(f.Fragment,{children:Z.map(ae=>{const se=MS(ae),me=p&&!b?!1:E===Z||P.includes(se),ke=()=>{if(F.has(se))F.set(se,!0);else return;let qe=!0;F.forEach(tt=>{tt||(qe=!1)}),qe&&(ge==null||ge(),ne(R.current),p&&(T==null||T()),r&&r())};return f.jsx(Fme,{isPresent:me,initial:!I.current||n?void 0:!1,custom:t,presenceAffectsLayout:l,mode:d,onExitComplete:me?void 0:ke,anchorX:a,children:ae},se)})})},EH=V.createContext({strict:!1}),pL={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},h_={};for(const e in pL)h_[e]={isEnabled:t=>pL[e].some(n=>!!t[n])};function Vme(e){for(const t in e)h_[t]={...h_[t],...e[t]}}const Ume=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function JT(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Ume.has(e)}let AH=e=>!JT(e);function $me(e){e&&(AH=t=>t.startsWith("on")?!JT(t):e(t))}try{$me(require("@emotion/is-prop-valid").default)}catch{}function qme(e,t,n){const r={};for(const l in e)l==="values"&&typeof e.values=="object"||(AH(l)||n===!0&&JT(l)||!t&&!JT(l)||e.draggable&&l.startsWith("onDrag"))&&(r[l]=e[l]);return r}function Hme(e){if(typeof Proxy>"u")return e;const t=new Map,n=(...r)=>e(...r);return new Proxy(n,{get:(r,l)=>l==="create"?e:(t.has(l)||t.set(l,e(l)),t.get(l))})}const g3=V.createContext({});function x3(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function lw(e){return typeof e=="string"||Array.isArray(e)}const MN=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],PN=["initial",...MN];function y3(e){return x3(e.animate)||PN.some(t=>lw(e[t]))}function CH(e){return!!(y3(e)||e.variants)}function Gme(e,t){if(y3(e)){const{initial:n,animate:r}=e;return{initial:n===!1||lw(n)?n:void 0,animate:lw(r)?r:void 0}}return e.inherit!==!1?t:{}}function Wme(e){const{initial:t,animate:n}=Gme(e,V.useContext(g3));return V.useMemo(()=>({initial:t,animate:n}),[mL(t),mL(n)])}function mL(e){return Array.isArray(e)?e.join(" "):e}const Zme=Symbol.for("motionComponentSymbol");function Zv(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Xme(e,t,n){return V.useCallback(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):Zv(n)&&(n.current=r))},[t])}const NN=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Kme="framerAppearId",jH="data-"+NN(Kme),MH=V.createContext({});function Yme(e,t,n,r,l){var W,$;const{visualElement:d}=V.useContext(g3),p=V.useContext(EH),a=V.useContext(m3),b=V.useContext(jN).reducedMotion,T=V.useRef(null);r=r||p.renderer,!T.current&&r&&(T.current=r(e,{visualState:t,parent:d,props:n,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:b}));const E=T.current,P=V.useContext(MH);E&&!E.projection&&l&&(E.type==="html"||E.type==="svg")&&Qme(T.current,n,l,P);const I=V.useRef(!1);V.useInsertionEffect(()=>{E&&I.current&&E.update(n,a)});const R=n[jH],F=V.useRef(!!R&&!((W=window.MotionHandoffIsComplete)!=null&&W.call(window,R))&&(($=window.MotionHasOptimisedAnimation)==null?void 0:$.call(window,R)));return Iq(()=>{E&&(I.current=!0,window.MotionIsMounted=!0,E.updateFeatures(),AN.render(E.render),F.current&&E.animationState&&E.animationState.animateChanges())}),V.useEffect(()=>{E&&(!F.current&&E.animationState&&E.animationState.animateChanges(),F.current&&(queueMicrotask(()=>{var Z;(Z=window.MotionHandoffMarkAsComplete)==null||Z.call(window,R)}),F.current=!1))}),E}function Qme(e,t,n,r){const{layoutId:l,layout:d,drag:p,dragConstraints:a,layoutScroll:b,layoutRoot:T,layoutCrossfade:E}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:PH(e.parent)),e.projection.setOptions({layoutId:l,layout:d,alwaysMeasureLayout:!!p||a&&Zv(a),visualElement:e,animationType:typeof d=="string"?d:"both",initialPromotionConfig:r,crossfade:E,layoutScroll:b,layoutRoot:T})}function PH(e){if(e)return e.options.allowProjection!==!1?e.projection:PH(e.parent)}function Jme({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:r,Component:l}){e&&Vme(e);function d(a,b){let T;const E={...V.useContext(jN),...a,layoutId:ege(a)},{isStatic:P}=E,I=Wme(a),R=r(a,P);if(!P&&aN){tge();const F=nge(E);T=F.MeasureLayout,I.visualElement=Yme(l,R,E,t,F.ProjectionNode)}return f.jsxs(g3.Provider,{value:I,children:[T&&I.visualElement?f.jsx(T,{visualElement:I.visualElement,...E}):null,n(l,a,Xme(R,I.visualElement,b),R,P,I.visualElement)]})}d.displayName=`motion.${typeof l=="string"?l:`create(${l.displayName??l.name??""})`}`;const p=V.forwardRef(d);return p[Zme]=l,p}function ege({layoutId:e}){const t=V.useContext(rN).id;return t&&e!==void 0?t+"-"+e:e}function tge(e,t){V.useContext(EH).strict}function nge(e){const{drag:t,layout:n}=h_;if(!t&&!n)return{};const r={...t,...n};return{MeasureLayout:t!=null&&t.isEnabled(e)||n!=null&&n.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const cw={};function rge(e){for(const t in e)cw[t]=e[t],fN(t)&&(cw[t].isCSSVariable=!0)}function NH(e,{layout:t,layoutId:n}){return j_.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!cw[e]||e==="opacity")}const ige={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},age=C_.length;function sge(e,t,n){let r="",l=!0;for(let d=0;d<age;d++){const p=C_[d],a=e[p];if(a===void 0)continue;let b=!0;if(typeof a=="number"?b=a===(p.startsWith("scale")?1:0):b=parseFloat(a)===0,!b||n){const T=vH(a,EN[p]);if(!b){l=!1;const E=ige[p]||p;r+=`${E}(${T}) `}n&&(t[p]=T)}}return r=r.trim(),n?r=n(t,l?"":r):l&&(r="none"),r}function DN(e,t,n){const{style:r,vars:l,transformOrigin:d}=e;let p=!1,a=!1;for(const b in t){const T=t[b];if(j_.has(b)){p=!0;continue}else if(fN(b)){l[b]=T;continue}else{const E=vH(T,EN[b]);b.startsWith("origin")?(a=!0,d[b]=E):r[b]=E}}if(t.transform||(p||n?r.transform=sge(t,e.transform,n):r.transform&&(r.transform="none")),a){const{originX:b="50%",originY:T="50%",originZ:E=0}=d;r.transformOrigin=`${b} ${T} ${E}`}}const ON=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function DH(e,t,n){for(const r in t)!Wl(t[r])&&!NH(r,n)&&(e[r]=t[r])}function oge({transformTemplate:e},t){return V.useMemo(()=>{const n=ON();return DN(n,t,e),Object.assign({},n.vars,n.style)},[t])}function lge(e,t){const n=e.style||{},r={};return DH(r,n,e),Object.assign(r,oge(e,t)),r}function cge(e,t){const n={},r=lge(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const uge={offset:"stroke-dashoffset",array:"stroke-dasharray"},dge={offset:"strokeDashoffset",array:"strokeDasharray"};function hge(e,t,n=1,r=0,l=!0){e.pathLength=1;const d=l?uge:dge;e[d.offset]=oi.transform(-r);const p=oi.transform(t),a=oi.transform(n);e[d.array]=`${p} ${a}`}function OH(e,{attrX:t,attrY:n,attrScale:r,pathLength:l,pathSpacing:d=1,pathOffset:p=0,...a},b,T,E){if(DN(e,a,T),b){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:P,style:I}=e;P.transform&&(I.transform=P.transform,delete P.transform),(I.transform||P.transformOrigin)&&(I.transformOrigin=P.transformOrigin??"50% 50%",delete P.transformOrigin),I.transform&&(I.transformBox=(E==null?void 0:E.transformBox)??"fill-box",delete P.transformBox),t!==void 0&&(P.x=t),n!==void 0&&(P.y=n),r!==void 0&&(P.scale=r),l!==void 0&&hge(P,l,d,p,!1)}const IH=()=>({...ON(),attrs:{}}),kH=e=>typeof e=="string"&&e.toLowerCase()==="svg";function fge(e,t,n,r){const l=V.useMemo(()=>{const d=IH();return OH(d,t,kH(r),e.transformTemplate,e.style),{...d.attrs,style:{...d.style}}},[t]);if(e.style){const d={};DH(d,e.style,e),l.style={...d,...l.style}}return l}const pge=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function IN(e){return typeof e!="string"||e.includes("-")?!1:!!(pge.indexOf(e)>-1||/[A-Z]/u.test(e))}function mge(e=!1){return(n,r,l,{latestValues:d},p)=>{const b=(IN(n)?fge:cge)(r,d,p,n),T=qme(r,typeof n=="string",e),E=n!==V.Fragment?{...T,...b,ref:l}:{},{children:P}=r,I=V.useMemo(()=>Wl(P)?P.get():P,[P]);return V.createElement(n,{...E,children:I})}}function gL(e){const t=[{},{}];return e==null||e.values.forEach((n,r)=>{t[0][r]=n.get(),t[1][r]=n.getVelocity()}),t}function kN(e,t,n,r){if(typeof t=="function"){const[l,d]=gL(r);t=t(n!==void 0?n:e.custom,l,d)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[l,d]=gL(r);t=t(n!==void 0?n:e.custom,l,d)}return t}function mT(e){return Wl(e)?e.get():e}function gge({scrapeMotionValuesFromProps:e,createRenderState:t},n,r,l){return{latestValues:xge(n,r,l,e),renderState:t()}}const RH=e=>(t,n)=>{const r=V.useContext(g3),l=V.useContext(m3),d=()=>gge(e,t,r,l);return n?d():iN(d)};function xge(e,t,n,r){const l={},d=r(e,{});for(const I in d)l[I]=mT(d[I]);let{initial:p,animate:a}=e;const b=y3(e),T=CH(e);t&&T&&!b&&e.inherit!==!1&&(p===void 0&&(p=t.initial),a===void 0&&(a=t.animate));let E=n?n.initial===!1:!1;E=E||p===!1;const P=E?a:p;if(P&&typeof P!="boolean"&&!x3(P)){const I=Array.isArray(P)?P:[P];for(let R=0;R<I.length;R++){const F=kN(e,I[R]);if(F){const{transitionEnd:W,transition:$,...Z}=F;for(const ne in Z){let ie=Z[ne];if(Array.isArray(ie)){const ge=E?ie.length-1:0;ie=ie[ge]}ie!==null&&(l[ne]=ie)}for(const ne in W)l[ne]=W[ne]}}}return l}function RN(e,t,n){var d;const{style:r}=e,l={};for(const p in r)(Wl(r[p])||t.style&&Wl(t.style[p])||NH(p,e)||((d=n==null?void 0:n.getValue(p))==null?void 0:d.liveStyle)!==void 0)&&(l[p]=r[p]);return l}const yge={useVisualState:RH({scrapeMotionValuesFromProps:RN,createRenderState:ON})};function zH(e,t,n){const r=RN(e,t,n);for(const l in e)if(Wl(e[l])||Wl(t[l])){const d=C_.indexOf(l)!==-1?"attr"+l.charAt(0).toUpperCase()+l.substring(1):l;r[d]=e[l]}return r}const vge={useVisualState:RH({scrapeMotionValuesFromProps:zH,createRenderState:IH})};function _ge(e,t){return function(r,{forwardMotionProps:l}={forwardMotionProps:!1}){const p={...IN(r)?vge:yge,preloadedFeatures:e,useRender:mge(l),createVisualElement:t,Component:r};return Jme(p)}}function uw(e,t,n){const r=e.getProps();return kN(r,t,n!==void 0?n:r.custom,e)}const s5=e=>Array.isArray(e);function bge(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,d_(n))}function wge(e){return s5(e)?e[e.length-1]||0:e}function Sge(e,t){const n=uw(e,t);let{transitionEnd:r={},transition:l={},...d}=n||{};d={...d,...r};for(const p in d){const a=wge(d[p]);bge(e,p,a)}}function Tge(e){return!!(Wl(e)&&e.add)}function o5(e,t){const n=e.getValue("willChange");if(Tge(n))return n.add(t);if(!n&&Dm.WillChange){const r=new Dm.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function LH(e){return e.props[jH]}const Ege=e=>e!==null;function Age(e,{repeat:t,repeatType:n="loop"},r){const l=e.filter(Ege),d=t&&n!=="loop"&&t%2===1?0:l.length-1;return l[d]}const Cge={type:"spring",stiffness:500,damping:25,restSpeed:10},jge=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),Mge={type:"keyframes",duration:.8},Pge={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Nge=(e,{keyframes:t})=>t.length>2?Mge:j_.has(e)?e.startsWith("scale")?jge(t[1]):Cge:Pge;function Dge({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:l,repeat:d,repeatType:p,repeatDelay:a,from:b,elapsed:T,...E}){return!!Object.keys(E).length}const zN=(e,t,n,r={},l,d)=>p=>{const a=TN(r,e)||{},b=a.delay||r.delay||0;let{elapsed:T=0}=r;T=T-ep(b);const E={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...a,delay:-T,onUpdate:I=>{t.set(I),a.onUpdate&&a.onUpdate(I)},onComplete:()=>{p(),a.onComplete&&a.onComplete()},name:e,motionValue:t,element:d?void 0:l};Dge(a)||Object.assign(E,Nge(e,E)),E.duration&&(E.duration=ep(E.duration)),E.repeatDelay&&(E.repeatDelay=ep(E.repeatDelay)),E.from!==void 0&&(E.keyframes[0]=E.from);let P=!1;if((E.type===!1||E.duration===0&&!E.repeatDelay)&&(E.duration=0,E.delay===0&&(P=!0)),(Dm.instantAnimations||Dm.skipAnimations)&&(P=!0,E.duration=0,E.delay=0),E.allowFlatten=!a.type&&!a.ease,P&&!d&&t.get()!==void 0){const I=Age(E.keyframes,a);if(I!==void 0){ys.update(()=>{E.onUpdate(I),E.onComplete()});return}}return a.isSync?new bN(E):new hme(E)};function Oge({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function FH(e,t,{delay:n=0,transitionOverride:r,type:l}={}){let{transition:d=e.getDefaultTransition(),transitionEnd:p,...a}=t;r&&(d=r);const b=[],T=l&&e.animationState&&e.animationState.getState()[l];for(const E in a){const P=e.getValue(E,e.latestValues[E]??null),I=a[E];if(I===void 0||T&&Oge(T,E))continue;const R={delay:n,...TN(d||{},E)},F=P.get();if(F!==void 0&&!P.isAnimating&&!Array.isArray(I)&&I===F&&!R.velocity)continue;let W=!1;if(window.MotionHandoffAnimation){const Z=LH(e);if(Z){const ne=window.MotionHandoffAnimation(Z,E,ys);ne!==null&&(R.startTime=ne,W=!0)}}o5(e,E),P.start(zN(E,P,I,e.shouldReduceMotion&&pH.has(E)?{type:!1}:R,e,W));const $=P.animation;$&&b.push($)}return p&&Promise.all(b).then(()=>{ys.update(()=>{p&&Sge(e,p)})}),b}function l5(e,t,n={}){var b;const r=uw(e,t,n.type==="exit"?(b=e.presenceContext)==null?void 0:b.custom:void 0);let{transition:l=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(l=n.transitionOverride);const d=r?()=>Promise.all(FH(e,r,n)):()=>Promise.resolve(),p=e.variantChildren&&e.variantChildren.size?(T=0)=>{const{delayChildren:E=0,staggerChildren:P,staggerDirection:I}=l;return Ige(e,t,E+T,P,I,n)}:()=>Promise.resolve(),{when:a}=l;if(a){const[T,E]=a==="beforeChildren"?[d,p]:[p,d];return T().then(()=>E())}else return Promise.all([d(),p(n.delay)])}function Ige(e,t,n=0,r=0,l=1,d){const p=[],a=(e.variantChildren.size-1)*r,b=l===1?(T=0)=>T*r:(T=0)=>a-T*r;return Array.from(e.variantChildren).sort(kge).forEach((T,E)=>{T.notify("AnimationStart",t),p.push(l5(T,t,{...d,delay:n+b(E)}).then(()=>T.notify("AnimationComplete",t)))}),Promise.all(p)}function kge(e,t){return e.sortNodePosition(t)}function Rge(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const l=t.map(d=>l5(e,d,n));r=Promise.all(l)}else if(typeof t=="string")r=l5(e,t,n);else{const l=typeof t=="function"?uw(e,t,n.custom):t;r=Promise.all(FH(e,l,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}function BH(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const zge=PN.length;function VH(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?VH(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<zge;n++){const r=PN[n],l=e.props[r];(lw(l)||l===!1)&&(t[r]=l)}return t}const Lge=[...MN].reverse(),Fge=MN.length;function Bge(e){return t=>Promise.all(t.map(({animation:n,options:r})=>Rge(e,n,r)))}function Vge(e){let t=Bge(e),n=xL(),r=!0;const l=b=>(T,E)=>{var I;const P=uw(e,E,b==="exit"?(I=e.presenceContext)==null?void 0:I.custom:void 0);if(P){const{transition:R,transitionEnd:F,...W}=P;T={...T,...W,...F}}return T};function d(b){t=b(e)}function p(b){const{props:T}=e,E=VH(e.parent)||{},P=[],I=new Set;let R={},F=1/0;for(let $=0;$<Fge;$++){const Z=Lge[$],ne=n[Z],ie=T[Z]!==void 0?T[Z]:E[Z],ge=lw(ie),ae=Z===b?ne.isActive:null;ae===!1&&(F=$);let se=ie===E[Z]&&ie!==T[Z]&&ge;if(se&&r&&e.manuallyAnimateOnMount&&(se=!1),ne.protectedKeys={...R},!ne.isActive&&ae===null||!ie&&!ne.prevProp||x3(ie)||typeof ie=="boolean")continue;const me=Uge(ne.prevProp,ie);let ke=me||Z===b&&ne.isActive&&!se&&ge||$>F&&ge,qe=!1;const tt=Array.isArray(ie)?ie:[ie];let nt=tt.reduce(l(Z),{});ae===!1&&(nt={});const{prevResolvedValues:bt={}}=ne,jt={...bt,...nt},Nt=ut=>{ke=!0,I.has(ut)&&(qe=!0,I.delete(ut)),ne.needsAnimating[ut]=!0;const Tt=e.getValue(ut);Tt&&(Tt.liveStyle=!1)};for(const ut in jt){const Tt=nt[ut],Yt=bt[ut];if(R.hasOwnProperty(ut))continue;let Ge=!1;s5(Tt)&&s5(Yt)?Ge=!BH(Tt,Yt):Ge=Tt!==Yt,Ge?Tt!=null?Nt(ut):I.add(ut):Tt!==void 0&&I.has(ut)?Nt(ut):ne.protectedKeys[ut]=!0}ne.prevProp=ie,ne.prevResolvedValues=nt,ne.isActive&&(R={...R,...nt}),r&&e.blockInitialAnimation&&(ke=!1),ke&&(!(se&&me)||qe)&&P.push(...tt.map(ut=>({animation:ut,options:{type:Z}})))}if(I.size){const $={};if(typeof T.initial!="boolean"){const Z=uw(e,Array.isArray(T.initial)?T.initial[0]:T.initial);Z&&Z.transition&&($.transition=Z.transition)}I.forEach(Z=>{const ne=e.getBaseTarget(Z),ie=e.getValue(Z);ie&&(ie.liveStyle=!0),$[Z]=ne??null}),P.push({animation:$})}let W=!!P.length;return r&&(T.initial===!1||T.initial===T.animate)&&!e.manuallyAnimateOnMount&&(W=!1),r=!1,W?t(P):Promise.resolve()}function a(b,T){var P;if(n[b].isActive===T)return Promise.resolve();(P=e.variantChildren)==null||P.forEach(I=>{var R;return(R=I.animationState)==null?void 0:R.setActive(b,T)}),n[b].isActive=T;const E=p(b);for(const I in n)n[I].protectedKeys={};return E}return{animateChanges:p,setActive:a,setAnimateFunction:d,getState:()=>n,reset:()=>{n=xL(),r=!0}}}function Uge(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!BH(t,e):!1}function O0(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function xL(){return{animate:O0(!0),whileInView:O0(),whileHover:O0(),whileTap:O0(),whileDrag:O0(),whileFocus:O0(),exit:O0()}}class hx{constructor(t){this.isMounted=!1,this.node=t}update(){}}class $ge extends hx{constructor(t){super(t),t.animationState||(t.animationState=Vge(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();x3(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let qge=0;class Hge extends hx{constructor(){super(...arguments),this.id=qge++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const l=this.node.animationState.setActive("exit",!t);n&&!t&&l.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const Gge={animation:{Feature:$ge},exit:{Feature:Hge}};function dw(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}function Fw(e){return{point:{x:e.pageX,y:e.pageY}}}const Wge=e=>t=>CN(t)&&e(t,Fw(t));function Lb(e,t,n,r){return dw(e,t,Wge(n),r)}function UH({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function Zge({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function Xge(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}const $H=1e-4,Kge=1-$H,Yge=1+$H,qH=.01,Qge=0-qH,Jge=0+qH;function _c(e){return e.max-e.min}function exe(e,t,n){return Math.abs(e-t)<=n}function yL(e,t,n,r=.5){e.origin=r,e.originPoint=ms(t.min,t.max,e.origin),e.scale=_c(n)/_c(t),e.translate=ms(n.min,n.max,e.origin)-e.originPoint,(e.scale>=Kge&&e.scale<=Yge||isNaN(e.scale))&&(e.scale=1),(e.translate>=Qge&&e.translate<=Jge||isNaN(e.translate))&&(e.translate=0)}function Fb(e,t,n,r){yL(e.x,t.x,n.x,r?r.originX:void 0),yL(e.y,t.y,n.y,r?r.originY:void 0)}function vL(e,t,n){e.min=n.min+t.min,e.max=e.min+_c(t)}function txe(e,t,n){vL(e.x,t.x,n.x),vL(e.y,t.y,n.y)}function _L(e,t,n){e.min=t.min-n.min,e.max=e.min+_c(t)}function Bb(e,t,n){_L(e.x,t.x,n.x),_L(e.y,t.y,n.y)}const bL=()=>({translate:0,scale:1,origin:0,originPoint:0}),Xv=()=>({x:bL(),y:bL()}),wL=()=>({min:0,max:0}),Us=()=>({x:wL(),y:wL()});function Pd(e){return[e("x"),e("y")]}function a4(e){return e===void 0||e===1}function c5({scale:e,scaleX:t,scaleY:n}){return!a4(e)||!a4(t)||!a4(n)}function R0(e){return c5(e)||HH(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function HH(e){return SL(e.x)||SL(e.y)}function SL(e){return e&&e!=="0%"}function eE(e,t,n){const r=e-n,l=t*r;return n+l}function TL(e,t,n,r,l){return l!==void 0&&(e=eE(e,l,r)),eE(e,n,r)+t}function u5(e,t=0,n=1,r,l){e.min=TL(e.min,t,n,r,l),e.max=TL(e.max,t,n,r,l)}function GH(e,{x:t,y:n}){u5(e.x,t.translate,t.scale,t.originPoint),u5(e.y,n.translate,n.scale,n.originPoint)}const EL=.999999999999,AL=1.0000000000001;function nxe(e,t,n,r=!1){const l=n.length;if(!l)return;t.x=t.y=1;let d,p;for(let a=0;a<l;a++){d=n[a],p=d.projectionDelta;const{visualElement:b}=d.options;b&&b.props.style&&b.props.style.display==="contents"||(r&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Yv(e,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),p&&(t.x*=p.x.scale,t.y*=p.y.scale,GH(e,p)),r&&R0(d.latestValues)&&Yv(e,d.latestValues))}t.x<AL&&t.x>EL&&(t.x=1),t.y<AL&&t.y>EL&&(t.y=1)}function Kv(e,t){e.min=e.min+t,e.max=e.max+t}function CL(e,t,n,r,l=.5){const d=ms(e.min,e.max,l);u5(e,t,n,d,r)}function Yv(e,t){CL(e.x,t.x,t.scaleX,t.scale,t.originX),CL(e.y,t.y,t.scaleY,t.scale,t.originY)}function WH(e,t){return UH(Xge(e.getBoundingClientRect(),t))}function rxe(e,t,n){const r=WH(e,n),{scroll:l}=t;return l&&(Kv(r.x,l.offset.x),Kv(r.y,l.offset.y)),r}const ZH=({current:e})=>e?e.ownerDocument.defaultView:null,jL=(e,t)=>Math.abs(e-t);function ixe(e,t){const n=jL(e.x,t.x),r=jL(e.y,t.y);return Math.sqrt(n**2+r**2)}class XH{constructor(t,n,{transformPagePoint:r,contextWindow:l,dragSnapToOrigin:d=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const P=o4(this.lastMoveEventInfo,this.history),I=this.startEvent!==null,R=ixe(P.offset,{x:0,y:0})>=3;if(!I&&!R)return;const{point:F}=P,{timestamp:W}=fl;this.history.push({...F,timestamp:W});const{onStart:$,onMove:Z}=this.handlers;I||($&&$(this.lastMoveEvent,P),this.startEvent=this.lastMoveEvent),Z&&Z(this.lastMoveEvent,P)},this.handlePointerMove=(P,I)=>{this.lastMoveEvent=P,this.lastMoveEventInfo=s4(I,this.transformPagePoint),ys.update(this.updatePoint,!0)},this.handlePointerUp=(P,I)=>{this.end();const{onEnd:R,onSessionEnd:F,resumeAnimation:W}=this.handlers;if(this.dragSnapToOrigin&&W&&W(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const $=o4(P.type==="pointercancel"?this.lastMoveEventInfo:s4(I,this.transformPagePoint),this.history);this.startEvent&&R&&R(P,$),F&&F(P,$)},!CN(t))return;this.dragSnapToOrigin=d,this.handlers=n,this.transformPagePoint=r,this.contextWindow=l||window;const p=Fw(t),a=s4(p,this.transformPagePoint),{point:b}=a,{timestamp:T}=fl;this.history=[{...b,timestamp:T}];const{onSessionStart:E}=n;E&&E(t,o4(a,this.history)),this.removeListeners=Rw(Lb(this.contextWindow,"pointermove",this.handlePointerMove),Lb(this.contextWindow,"pointerup",this.handlePointerUp),Lb(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),rx(this.updatePoint)}}function s4(e,t){return t?{point:t(e.point)}:e}function ML(e,t){return{x:e.x-t.x,y:e.y-t.y}}function o4({point:e},t){return{point:e,delta:ML(e,KH(t)),offset:ML(e,axe(t)),velocity:sxe(t,.1)}}function axe(e){return e[0]}function KH(e){return e[e.length-1]}function sxe(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const l=KH(e);for(;n>=0&&(r=e[n],!(l.timestamp-r.timestamp>ep(t)));)n--;if(!r)return{x:0,y:0};const d=tp(l.timestamp-r.timestamp);if(d===0)return{x:0,y:0};const p={x:(l.x-r.x)/d,y:(l.y-r.y)/d};return p.x===1/0&&(p.x=0),p.y===1/0&&(p.y=0),p}function oxe(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?ms(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?ms(n,e,r.max):Math.min(e,n)),e}function PL(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function lxe(e,{top:t,left:n,bottom:r,right:l}){return{x:PL(e.x,n,l),y:PL(e.y,t,r)}}function NL(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function cxe(e,t){return{x:NL(e.x,t.x),y:NL(e.y,t.y)}}function uxe(e,t){let n=.5;const r=_c(e),l=_c(t);return l>r?n=aw(t.min,t.max-r,e.min):r>l&&(n=aw(e.min,e.max-l,t.min)),Nm(0,1,n)}function dxe(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const d5=.35;function hxe(e=d5){return e===!1?e=0:e===!0&&(e=d5),{x:DL(e,"left","right"),y:DL(e,"top","bottom")}}function DL(e,t,n){return{min:OL(e,t),max:OL(e,n)}}function OL(e,t){return typeof e=="number"?e:e[t]||0}const fxe=new WeakMap;class pxe{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Us(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const l=E=>{const{dragSnapToOrigin:P}=this.getProps();P?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Fw(E).point)},d=(E,P)=>{const{drag:I,dragPropagation:R,onDragStart:F}=this.getProps();if(I&&!R&&(this.openDragLock&&this.openDragLock(),this.openDragLock=jme(I),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Pd($=>{let Z=this.getAxisMotionValue($).get()||0;if(np.test(Z)){const{projection:ne}=this.visualElement;if(ne&&ne.layout){const ie=ne.layout.layoutBox[$];ie&&(Z=_c(ie)*(parseFloat(Z)/100))}}this.originPoint[$]=Z}),F&&ys.postRender(()=>F(E,P)),o5(this.visualElement,"transform");const{animationState:W}=this.visualElement;W&&W.setActive("whileDrag",!0)},p=(E,P)=>{const{dragPropagation:I,dragDirectionLock:R,onDirectionLock:F,onDrag:W}=this.getProps();if(!I&&!this.openDragLock)return;const{offset:$}=P;if(R&&this.currentDirection===null){this.currentDirection=mxe($),this.currentDirection!==null&&F&&F(this.currentDirection);return}this.updateAxis("x",P.point,$),this.updateAxis("y",P.point,$),this.visualElement.render(),W&&W(E,P)},a=(E,P)=>this.stop(E,P),b=()=>Pd(E=>{var P;return this.getAnimationState(E)==="paused"&&((P=this.getAxisMotionValue(E).animation)==null?void 0:P.play())}),{dragSnapToOrigin:T}=this.getProps();this.panSession=new XH(t,{onSessionStart:l,onStart:d,onMove:p,onSessionEnd:a,resumeAnimation:b},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:T,contextWindow:ZH(this.visualElement)})}stop(t,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:l}=n;this.startAnimation(l);const{onDragEnd:d}=this.getProps();d&&ys.postRender(()=>d(t,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:l}=this.getProps();if(!r||!PS(t,l,this.currentDirection))return;const d=this.getAxisMotionValue(t);let p=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(p=oxe(p,this.constraints[t],this.elastic[t])),d.set(p)}resolveConstraints(){var d;const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(d=this.visualElement.projection)==null?void 0:d.layout,l=this.constraints;t&&Zv(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=lxe(r.layoutBox,t):this.constraints=!1,this.elastic=hxe(n),l!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Pd(p=>{this.constraints!==!1&&this.getAxisMotionValue(p)&&(this.constraints[p]=dxe(r.layoutBox[p],this.constraints[p]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!Zv(t))return!1;const r=t.current,{projection:l}=this.visualElement;if(!l||!l.layout)return!1;const d=rxe(r,l.root,this.visualElement.getTransformPagePoint());let p=cxe(l.layout.layoutBox,d);if(n){const a=n(Zge(p));this.hasMutatedConstraints=!!a,a&&(p=UH(a))}return p}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:l,dragTransition:d,dragSnapToOrigin:p,onDragTransitionEnd:a}=this.getProps(),b=this.constraints||{},T=Pd(E=>{if(!PS(E,n,this.currentDirection))return;let P=b&&b[E]||{};p&&(P={min:0,max:0});const I=l?200:1e6,R=l?40:1e7,F={type:"inertia",velocity:r?t[E]:0,bounceStiffness:I,bounceDamping:R,timeConstant:750,restDelta:1,restSpeed:10,...d,...P};return this.startAxisValueAnimation(E,F)});return Promise.all(T).then(a)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return o5(this.visualElement,t),r.start(zN(t,r,0,n,this.visualElement,!1))}stopAnimation(){Pd(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Pd(t=>{var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),l=r[n];return l||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){Pd(n=>{const{drag:r}=this.getProps();if(!PS(n,r,this.currentDirection))return;const{projection:l}=this.visualElement,d=this.getAxisMotionValue(n);if(l&&l.layout){const{min:p,max:a}=l.layout.layoutBox[n];d.set(t[n]-ms(p,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!Zv(n)||!r||!this.constraints)return;this.stopAnimation();const l={x:0,y:0};Pd(p=>{const a=this.getAxisMotionValue(p);if(a&&this.constraints!==!1){const b=a.get();l[p]=uxe({min:b,max:b},this.constraints[p])}});const{transformTemplate:d}=this.visualElement.getProps();this.visualElement.current.style.transform=d?d({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Pd(p=>{if(!PS(p,t,null))return;const a=this.getAxisMotionValue(p),{min:b,max:T}=this.constraints[p];a.set(ms(b,T,l[p]))})}addListeners(){if(!this.visualElement.current)return;fxe.set(this.visualElement,this);const t=this.visualElement.current,n=Lb(t,"pointerdown",b=>{const{drag:T,dragListener:E=!0}=this.getProps();T&&E&&this.start(b)}),r=()=>{const{dragConstraints:b}=this.getProps();Zv(b)&&b.current&&(this.constraints=this.resolveRefConstraints())},{projection:l}=this.visualElement,d=l.addEventListener("measure",r);l&&!l.layout&&(l.root&&l.root.updateScroll(),l.updateLayout()),ys.read(r);const p=dw(window,"resize",()=>this.scalePositionWithinConstraints()),a=l.addEventListener("didUpdate",({delta:b,hasLayoutChanged:T})=>{this.isDragging&&T&&(Pd(E=>{const P=this.getAxisMotionValue(E);P&&(this.originPoint[E]+=b[E].translate,P.set(P.get()+b[E].translate))}),this.visualElement.render())});return()=>{p(),n(),d(),a&&a()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:l=!1,dragConstraints:d=!1,dragElastic:p=d5,dragMomentum:a=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:l,dragConstraints:d,dragElastic:p,dragMomentum:a}}}function PS(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function mxe(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class gxe extends hx{constructor(t){super(t),this.removeGroupControls=Ld,this.removeListeners=Ld,this.controls=new pxe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ld}unmount(){this.removeGroupControls(),this.removeListeners()}}const IL=e=>(t,n)=>{e&&ys.postRender(()=>e(t,n))};class xxe extends hx{constructor(){super(...arguments),this.removePointerDownListener=Ld}onPointerDown(t){this.session=new XH(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:ZH(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:l}=this.node.getProps();return{onSessionStart:IL(t),onStart:IL(n),onMove:r,onEnd:(d,p)=>{delete this.session,l&&ys.postRender(()=>l(d,p))}}}mount(){this.removePointerDownListener=Lb(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const gT={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function kL(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const ib={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(oi.test(e))e=parseFloat(e);else return e;const n=kL(e,t.target.x),r=kL(e,t.target.y);return`${n}% ${r}%`}},yxe={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,l=ix.parse(e);if(l.length>5)return r;const d=ix.createTransformer(e),p=typeof l[0]!="number"?1:0,a=n.x.scale*t.x,b=n.y.scale*t.y;l[0+p]/=a,l[1+p]/=b;const T=ms(a,b,.5);return typeof l[2+p]=="number"&&(l[2+p]/=T),typeof l[3+p]=="number"&&(l[3+p]/=T),d(l)}};class vxe extends V.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:l}=this.props,{projection:d}=t;rge(_xe),d&&(n.group&&n.group.add(d),r&&r.register&&l&&r.register(d),d.root.didUpdate(),d.addEventListener("animationComplete",()=>{this.safeToRemove()}),d.setOptions({...d.options,onExitComplete:()=>this.safeToRemove()})),gT.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:l,isPresent:d}=this.props,{projection:p}=r;return p&&(p.isPresent=d,l||t.layoutDependency!==n||n===void 0||t.isPresent!==d?p.willUpdate():this.safeToRemove(),t.isPresent!==d&&(d?p.promote():p.relegate()||ys.postRender(()=>{const a=p.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),AN.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:l}=t;l&&(l.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(l),r&&r.deregister&&r.deregister(l))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function YH(e){const[t,n]=TH(),r=V.useContext(rN);return f.jsx(vxe,{...e,layoutGroup:r,switchLayoutGroup:V.useContext(MH),isPresent:t,safeToRemove:n})}const _xe={borderRadius:{...ib,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:ib,borderTopRightRadius:ib,borderBottomLeftRadius:ib,borderBottomRightRadius:ib,boxShadow:yxe};function bxe(e,t,n){const r=Wl(e)?e:d_(e);return r.start(zN("",r,t,n)),r.animation}const wxe=(e,t)=>e.depth-t.depth;class Sxe{constructor(){this.children=[],this.isDirty=!1}add(t){sN(this.children,t),this.isDirty=!0}remove(t){oN(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(wxe),this.isDirty=!1,this.children.forEach(t)}}function Txe(e,t){const n=$c.now(),r=({timestamp:l})=>{const d=l-n;d>=t&&(rx(r),e(d-t))};return ys.setup(r,!0),()=>rx(r)}const QH=["TopLeft","TopRight","BottomLeft","BottomRight"],Exe=QH.length,RL=e=>typeof e=="string"?parseFloat(e):e,zL=e=>typeof e=="number"||oi.test(e);function Axe(e,t,n,r,l,d){l?(e.opacity=ms(0,n.opacity??1,Cxe(r)),e.opacityExit=ms(t.opacity??1,0,jxe(r))):d&&(e.opacity=ms(t.opacity??1,n.opacity??1,r));for(let p=0;p<Exe;p++){const a=`border${QH[p]}Radius`;let b=LL(t,a),T=LL(n,a);if(b===void 0&&T===void 0)continue;b||(b=0),T||(T=0),b===0||T===0||zL(b)===zL(T)?(e[a]=Math.max(ms(RL(b),RL(T),r),0),(np.test(T)||np.test(b))&&(e[a]+="%")):e[a]=T}(t.rotate||n.rotate)&&(e.rotate=ms(t.rotate||0,n.rotate||0,r))}function LL(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const Cxe=JH(0,.5,Hq),jxe=JH(.5,.95,Ld);function JH(e,t,n){return r=>r<e?0:r>t?1:n(aw(e,t,r))}function FL(e,t){e.min=t.min,e.max=t.max}function Td(e,t){FL(e.x,t.x),FL(e.y,t.y)}function BL(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function VL(e,t,n,r,l){return e-=t,e=eE(e,1/n,r),l!==void 0&&(e=eE(e,1/l,r)),e}function Mxe(e,t=0,n=1,r=.5,l,d=e,p=e){if(np.test(t)&&(t=parseFloat(t),t=ms(p.min,p.max,t/100)-p.min),typeof t!="number")return;let a=ms(d.min,d.max,r);e===d&&(a-=t),e.min=VL(e.min,t,n,a,l),e.max=VL(e.max,t,n,a,l)}function UL(e,t,[n,r,l],d,p){Mxe(e,t[n],t[r],t[l],t.scale,d,p)}const Pxe=["x","scaleX","originX"],Nxe=["y","scaleY","originY"];function $L(e,t,n,r){UL(e.x,t,Pxe,n?n.x:void 0,r?r.x:void 0),UL(e.y,t,Nxe,n?n.y:void 0,r?r.y:void 0)}function qL(e){return e.translate===0&&e.scale===1}function eG(e){return qL(e.x)&&qL(e.y)}function HL(e,t){return e.min===t.min&&e.max===t.max}function Dxe(e,t){return HL(e.x,t.x)&&HL(e.y,t.y)}function GL(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function tG(e,t){return GL(e.x,t.x)&&GL(e.y,t.y)}function WL(e){return _c(e.x)/_c(e.y)}function ZL(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class Oxe{constructor(){this.members=[]}add(t){sN(this.members,t),t.scheduleRender()}remove(t){if(oN(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(l=>t===l);if(n===0)return!1;let r;for(let l=n;l>=0;l--){const d=this.members[l];if(d.isPresent!==!1){r=d;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:l}=t.options;l===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Ixe(e,t,n){let r="";const l=e.x.translate/t.x,d=e.y.translate/t.y,p=(n==null?void 0:n.z)||0;if((l||d||p)&&(r=`translate3d(${l}px, ${d}px, ${p}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:T,rotate:E,rotateX:P,rotateY:I,skewX:R,skewY:F}=n;T&&(r=`perspective(${T}px) ${r}`),E&&(r+=`rotate(${E}deg) `),P&&(r+=`rotateX(${P}deg) `),I&&(r+=`rotateY(${I}deg) `),R&&(r+=`skewX(${R}deg) `),F&&(r+=`skewY(${F}deg) `)}const a=e.x.scale*t.x,b=e.y.scale*t.y;return(a!==1||b!==1)&&(r+=`scale(${a}, ${b})`),r||"none"}const l4=["","X","Y","Z"],kxe={visibility:"hidden"},Rxe=1e3;let zxe=0;function c4(e,t,n,r){const{latestValues:l}=t;l[e]&&(n[e]=l[e],t.setStaticValue(e,0),r&&(r[e]=0))}function nG(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=LH(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:l,layoutId:d}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",ys,!(l||d))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&nG(r)}function rG({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:l}){return class{constructor(p={},a=t==null?void 0:t()){this.id=zxe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Bxe),this.nodes.forEach(Hxe),this.nodes.forEach(Gxe),this.nodes.forEach(Vxe)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=p,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let b=0;b<this.path.length;b++)this.path[b].shouldResetTransform=!0;this.root===this&&(this.nodes=new Sxe)}addEventListener(p,a){return this.eventHandlers.has(p)||this.eventHandlers.set(p,new uN),this.eventHandlers.get(p).add(a)}notifyListeners(p,...a){const b=this.eventHandlers.get(p);b&&b.notify(...a)}hasListeners(p){return this.eventHandlers.has(p)}mount(p){if(this.instance)return;this.isSVG=SH(p)&&!Ime(p),this.instance=p;const{layoutId:a,layout:b,visualElement:T}=this.options;if(T&&!T.current&&T.mount(p),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(b||a)&&(this.isLayoutDirty=!0),e){let E;const P=()=>this.root.updateBlockedByResize=!1;e(p,()=>{this.root.updateBlockedByResize=!0,E&&E(),E=Txe(P,250),gT.hasAnimatedSinceResize&&(gT.hasAnimatedSinceResize=!1,this.nodes.forEach(KL))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&T&&(a||b)&&this.addEventListener("didUpdate",({delta:E,hasLayoutChanged:P,hasRelativeLayoutChanged:I,layout:R})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const F=this.options.transition||T.getDefaultTransition()||Yxe,{onLayoutAnimationStart:W,onLayoutAnimationComplete:$}=T.getProps(),Z=!this.targetLayout||!tG(this.targetLayout,R),ne=!P&&I;if(this.options.layoutRoot||this.resumeFrom||ne||P&&(Z||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const ie={...TN(F,"layout"),onPlay:W,onComplete:$};(T.shouldReduceMotion||this.options.layoutRoot)&&(ie.delay=0,ie.type=!1),this.startAnimation(ie),this.setAnimationOrigin(E,ne)}else P||KL(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=R})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const p=this.getStack();p&&p.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),rx(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Wxe),this.animationId++)}getTransformTemplate(){const{visualElement:p}=this.options;return p&&p.getProps().transformTemplate}willUpdate(p=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&nG(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let E=0;E<this.path.length;E++){const P=this.path[E];P.shouldResetTransform=!0,P.updateScroll("snapshot"),P.options.layoutRoot&&P.willUpdate(!1)}const{layoutId:a,layout:b}=this.options;if(a===void 0&&!b)return;const T=this.getTransformTemplate();this.prevTransformTemplateValue=T?T(this.latestValues,""):void 0,this.updateSnapshot(),p&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(XL);return}this.isUpdating||this.nodes.forEach($xe),this.isUpdating=!1,this.nodes.forEach(qxe),this.nodes.forEach(Lxe),this.nodes.forEach(Fxe),this.clearAllSnapshots();const a=$c.now();fl.delta=Nm(0,1e3/60,a-fl.timestamp),fl.timestamp=a,fl.isProcessing=!0,e4.update.process(fl),e4.preRender.process(fl),e4.render.process(fl),fl.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,AN.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Uxe),this.sharedNodes.forEach(Zxe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ys.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ys.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!_c(this.snapshot.measuredBox.x)&&!_c(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let b=0;b<this.path.length;b++)this.path[b].updateScroll();const p=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Us(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,p?p.layoutBox:void 0)}updateScroll(p="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===p&&(a=!1),a&&this.instance){const b=r(this.instance);this.scroll={animationId:this.root.animationId,phase:p,isRoot:b,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:b}}}resetTransform(){if(!l)return;const p=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!eG(this.projectionDelta),b=this.getTransformTemplate(),T=b?b(this.latestValues,""):void 0,E=T!==this.prevTransformTemplateValue;p&&this.instance&&(a||R0(this.latestValues)||E)&&(l(this.instance,T),this.shouldResetTransform=!1,this.scheduleRender())}measure(p=!0){const a=this.measurePageBox();let b=this.removeElementScroll(a);return p&&(b=this.removeTransform(b)),Qxe(b),{animationId:this.root.animationId,measuredBox:a,layoutBox:b,latestValues:{},source:this.id}}measurePageBox(){var T;const{visualElement:p}=this.options;if(!p)return Us();const a=p.measureViewportBox();if(!(((T=this.scroll)==null?void 0:T.wasRoot)||this.path.some(Jxe))){const{scroll:E}=this.root;E&&(Kv(a.x,E.offset.x),Kv(a.y,E.offset.y))}return a}removeElementScroll(p){var b;const a=Us();if(Td(a,p),(b=this.scroll)!=null&&b.wasRoot)return a;for(let T=0;T<this.path.length;T++){const E=this.path[T],{scroll:P,options:I}=E;E!==this.root&&P&&I.layoutScroll&&(P.wasRoot&&Td(a,p),Kv(a.x,P.offset.x),Kv(a.y,P.offset.y))}return a}applyTransform(p,a=!1){const b=Us();Td(b,p);for(let T=0;T<this.path.length;T++){const E=this.path[T];!a&&E.options.layoutScroll&&E.scroll&&E!==E.root&&Yv(b,{x:-E.scroll.offset.x,y:-E.scroll.offset.y}),R0(E.latestValues)&&Yv(b,E.latestValues)}return R0(this.latestValues)&&Yv(b,this.latestValues),b}removeTransform(p){const a=Us();Td(a,p);for(let b=0;b<this.path.length;b++){const T=this.path[b];if(!T.instance||!R0(T.latestValues))continue;c5(T.latestValues)&&T.updateSnapshot();const E=Us(),P=T.measurePageBox();Td(E,P),$L(a,T.latestValues,T.snapshot?T.snapshot.layoutBox:void 0,E)}return R0(this.latestValues)&&$L(a,this.latestValues),a}setTargetDelta(p){this.targetDelta=p,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(p){this.options={...this.options,...p,crossfade:p.crossfade!==void 0?p.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==fl.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(p=!1){var I;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const b=!!this.resumingFrom||this!==a;if(!(p||b&&this.isSharedProjectionDirty||this.isProjectionDirty||(I=this.parent)!=null&&I.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:E,layoutId:P}=this.options;if(!(!this.layout||!(E||P))){if(this.resolvedRelativeTargetAt=fl.timestamp,!this.targetDelta&&!this.relativeTarget){const R=this.getClosestProjectingParent();R&&R.layout&&this.animationProgress!==1?(this.relativeParent=R,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Us(),this.relativeTargetOrigin=Us(),Bb(this.relativeTargetOrigin,this.layout.layoutBox,R.layout.layoutBox),Td(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Us(),this.targetWithTransforms=Us()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),txe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Td(this.target,this.layout.layoutBox),GH(this.target,this.targetDelta)):Td(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const R=this.getClosestProjectingParent();R&&!!R.resumingFrom==!!this.resumingFrom&&!R.options.layoutScroll&&R.target&&this.animationProgress!==1?(this.relativeParent=R,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Us(),this.relativeTargetOrigin=Us(),Bb(this.relativeTargetOrigin,this.target,R.target),Td(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||c5(this.parent.latestValues)||HH(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var F;const p=this.getLead(),a=!!this.resumingFrom||this!==p;let b=!0;if((this.isProjectionDirty||(F=this.parent)!=null&&F.isProjectionDirty)&&(b=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(b=!1),this.resolvedRelativeTargetAt===fl.timestamp&&(b=!1),b)return;const{layout:T,layoutId:E}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(T||E))return;Td(this.layoutCorrected,this.layout.layoutBox);const P=this.treeScale.x,I=this.treeScale.y;nxe(this.layoutCorrected,this.treeScale,this.path,a),p.layout&&!p.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(p.target=p.layout.layoutBox,p.targetWithTransforms=Us());const{target:R}=p;if(!R){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(BL(this.prevProjectionDelta.x,this.projectionDelta.x),BL(this.prevProjectionDelta.y,this.projectionDelta.y)),Fb(this.projectionDelta,this.layoutCorrected,R,this.latestValues),(this.treeScale.x!==P||this.treeScale.y!==I||!ZL(this.projectionDelta.x,this.prevProjectionDelta.x)||!ZL(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",R))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(p=!0){var a;if((a=this.options.visualElement)==null||a.scheduleRender(),p){const b=this.getStack();b&&b.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Xv(),this.projectionDelta=Xv(),this.projectionDeltaWithTransform=Xv()}setAnimationOrigin(p,a=!1){const b=this.snapshot,T=b?b.latestValues:{},E={...this.latestValues},P=Xv();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const I=Us(),R=b?b.source:void 0,F=this.layout?this.layout.source:void 0,W=R!==F,$=this.getStack(),Z=!$||$.members.length<=1,ne=!!(W&&!Z&&this.options.crossfade===!0&&!this.path.some(Kxe));this.animationProgress=0;let ie;this.mixTargetDelta=ge=>{const ae=ge/1e3;YL(P.x,p.x,ae),YL(P.y,p.y,ae),this.setTargetDelta(P),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Bb(I,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Xxe(this.relativeTarget,this.relativeTargetOrigin,I,ae),ie&&Dxe(this.relativeTarget,ie)&&(this.isProjectionDirty=!1),ie||(ie=Us()),Td(ie,this.relativeTarget)),W&&(this.animationValues=E,Axe(E,T,this.latestValues,ae,ne,Z)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=ae},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(p){var a,b,T;this.notifyListeners("animationStart"),(a=this.currentAnimation)==null||a.stop(),(T=(b=this.resumingFrom)==null?void 0:b.currentAnimation)==null||T.stop(),this.pendingAnimation&&(rx(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ys.update(()=>{gT.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=d_(0)),this.currentAnimation=bxe(this.motionValue,[0,1e3],{...p,isSync:!0,onUpdate:E=>{this.mixTargetDelta(E),p.onUpdate&&p.onUpdate(E)},onStop:()=>{},onComplete:()=>{p.onComplete&&p.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const p=this.getStack();p&&p.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Rxe),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const p=this.getLead();let{targetWithTransforms:a,target:b,layout:T,latestValues:E}=p;if(!(!a||!b||!T)){if(this!==p&&this.layout&&T&&iG(this.options.animationType,this.layout.layoutBox,T.layoutBox)){b=this.target||Us();const P=_c(this.layout.layoutBox.x);b.x.min=p.target.x.min,b.x.max=b.x.min+P;const I=_c(this.layout.layoutBox.y);b.y.min=p.target.y.min,b.y.max=b.y.min+I}Td(a,b),Yv(a,E),Fb(this.projectionDeltaWithTransform,this.layoutCorrected,a,E)}}registerSharedNode(p,a){this.sharedNodes.has(p)||this.sharedNodes.set(p,new Oxe),this.sharedNodes.get(p).add(a);const T=a.options.initialPromotionConfig;a.promote({transition:T?T.transition:void 0,preserveFollowOpacity:T&&T.shouldPreserveFollowOpacity?T.shouldPreserveFollowOpacity(a):void 0})}isLead(){const p=this.getStack();return p?p.lead===this:!0}getLead(){var a;const{layoutId:p}=this.options;return p?((a=this.getStack())==null?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:p}=this.options;return p?(a=this.getStack())==null?void 0:a.prevLead:void 0}getStack(){const{layoutId:p}=this.options;if(p)return this.root.sharedNodes.get(p)}promote({needsReset:p,transition:a,preserveFollowOpacity:b}={}){const T=this.getStack();T&&T.promote(this,b),p&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const p=this.getStack();return p?p.relegate(this):!1}resetSkewAndRotation(){const{visualElement:p}=this.options;if(!p)return;let a=!1;const{latestValues:b}=p;if((b.z||b.rotate||b.rotateX||b.rotateY||b.rotateZ||b.skewX||b.skewY)&&(a=!0),!a)return;const T={};b.z&&c4("z",p,T,this.animationValues);for(let E=0;E<l4.length;E++)c4(`rotate${l4[E]}`,p,T,this.animationValues),c4(`skew${l4[E]}`,p,T,this.animationValues);p.render();for(const E in T)p.setStaticValue(E,T[E]),this.animationValues&&(this.animationValues[E]=T[E]);p.scheduleRender()}getProjectionStyles(p){if(!this.instance||this.isSVG)return;if(!this.isVisible)return kxe;const a={visibility:""},b=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,a.opacity="",a.pointerEvents=mT(p==null?void 0:p.pointerEvents)||"",a.transform=b?b(this.latestValues,""):"none",a;const T=this.getLead();if(!this.projectionDelta||!this.layout||!T.target){const R={};return this.options.layoutId&&(R.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,R.pointerEvents=mT(p==null?void 0:p.pointerEvents)||""),this.hasProjected&&!R0(this.latestValues)&&(R.transform=b?b({},""):"none",this.hasProjected=!1),R}const E=T.animationValues||T.latestValues;this.applyTransformsToTarget(),a.transform=Ixe(this.projectionDeltaWithTransform,this.treeScale,E),b&&(a.transform=b(E,a.transform));const{x:P,y:I}=this.projectionDelta;a.transformOrigin=`${P.origin*100}% ${I.origin*100}% 0`,T.animationValues?a.opacity=T===this?E.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:E.opacityExit:a.opacity=T===this?E.opacity!==void 0?E.opacity:"":E.opacityExit!==void 0?E.opacityExit:0;for(const R in cw){if(E[R]===void 0)continue;const{correct:F,applyTo:W,isCSSVariable:$}=cw[R],Z=a.transform==="none"?E[R]:F(E[R],T);if(W){const ne=W.length;for(let ie=0;ie<ne;ie++)a[W[ie]]=Z}else $?this.options.visualElement.renderState.vars[R]=Z:a[R]=Z}return this.options.layoutId&&(a.pointerEvents=T===this?mT(p==null?void 0:p.pointerEvents)||"":"none"),a}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(p=>{var a;return(a=p.currentAnimation)==null?void 0:a.stop()}),this.root.nodes.forEach(XL),this.root.sharedNodes.clear()}}}function Lxe(e){e.updateLayout()}function Fxe(e){var n;const t=((n=e.resumeFrom)==null?void 0:n.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:l}=e.layout,{animationType:d}=e.options,p=t.source!==e.layout.source;d==="size"?Pd(P=>{const I=p?t.measuredBox[P]:t.layoutBox[P],R=_c(I);I.min=r[P].min,I.max=I.min+R}):iG(d,t.layoutBox,r)&&Pd(P=>{const I=p?t.measuredBox[P]:t.layoutBox[P],R=_c(r[P]);I.max=I.min+R,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[P].max=e.relativeTarget[P].min+R)});const a=Xv();Fb(a,r,t.layoutBox);const b=Xv();p?Fb(b,e.applyTransform(l,!0),t.measuredBox):Fb(b,r,t.layoutBox);const T=!eG(a);let E=!1;if(!e.resumeFrom){const P=e.getClosestProjectingParent();if(P&&!P.resumeFrom){const{snapshot:I,layout:R}=P;if(I&&R){const F=Us();Bb(F,t.layoutBox,I.layoutBox);const W=Us();Bb(W,r,R.layoutBox),tG(F,W)||(E=!0),P.options.layoutRoot&&(e.relativeTarget=W,e.relativeTargetOrigin=F,e.relativeParent=P)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:b,layoutDelta:a,hasLayoutChanged:T,hasRelativeLayoutChanged:E})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function Bxe(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Vxe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Uxe(e){e.clearSnapshot()}function XL(e){e.clearMeasurements()}function $xe(e){e.isLayoutDirty=!1}function qxe(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function KL(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Hxe(e){e.resolveTargetDelta()}function Gxe(e){e.calcProjection()}function Wxe(e){e.resetSkewAndRotation()}function Zxe(e){e.removeLeadSnapshot()}function YL(e,t,n){e.translate=ms(t.translate,0,n),e.scale=ms(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function QL(e,t,n,r){e.min=ms(t.min,n.min,r),e.max=ms(t.max,n.max,r)}function Xxe(e,t,n,r){QL(e.x,t.x,n.x,r),QL(e.y,t.y,n.y,r)}function Kxe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Yxe={duration:.45,ease:[.4,0,.1,1]},JL=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),e8=JL("applewebkit/")&&!JL("chrome/")?Math.round:Ld;function t8(e){e.min=e8(e.min),e.max=e8(e.max)}function Qxe(e){t8(e.x),t8(e.y)}function iG(e,t,n){return e==="position"||e==="preserve-aspect"&&!exe(WL(t),WL(n),.2)}function Jxe(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const e0e=rG({attachResizeListener:(e,t)=>dw(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),u4={current:void 0},aG=rG({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!u4.current){const e=new e0e({});e.mount(window),e.setOptions({layoutScroll:!0}),u4.current=e}return u4.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),t0e={pan:{Feature:xxe},drag:{Feature:gxe,ProjectionNode:aG,MeasureLayout:YH}};function n8(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",n==="Start");const l="onHover"+n,d=r[l];d&&ys.postRender(()=>d(t,Fw(t)))}class n0e extends hx{mount(){const{current:t}=this.node;t&&(this.unmount=Mme(t,(n,r)=>(n8(this.node,r,"Start"),l=>n8(this.node,l,"End"))))}unmount(){}}class r0e extends hx{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Rw(dw(this.node.current,"focus",()=>this.onFocus()),dw(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function r8(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",n==="Start");const l="onTap"+(n==="End"?"":n),d=r[l];d&&ys.postRender(()=>d(t,Fw(t)))}class i0e extends hx{mount(){const{current:t}=this.node;t&&(this.unmount=Ome(t,(n,r)=>(r8(this.node,r,"Start"),(l,{success:d})=>r8(this.node,l,d?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const h5=new WeakMap,d4=new WeakMap,a0e=e=>{const t=h5.get(e.target);t&&t(e)},s0e=e=>{e.forEach(a0e)};function o0e({root:e,...t}){const n=e||document;d4.has(n)||d4.set(n,{});const r=d4.get(n),l=JSON.stringify(t);return r[l]||(r[l]=new IntersectionObserver(s0e,{root:e,...t})),r[l]}function l0e(e,t,n){const r=o0e(t);return h5.set(e,n),r.observe(e),()=>{h5.delete(e),r.unobserve(e)}}const c0e={some:0,all:1};class u0e extends hx{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:l="some",once:d}=t,p={root:n?n.current:void 0,rootMargin:r,threshold:typeof l=="number"?l:c0e[l]},a=b=>{const{isIntersecting:T}=b;if(this.isInView===T||(this.isInView=T,d&&!T&&this.hasEnteredView))return;T&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",T);const{onViewportEnter:E,onViewportLeave:P}=this.node.getProps(),I=T?E:P;I&&I(b)};return l0e(this.node.current,p,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(d0e(t,n))&&this.startObserver()}unmount(){}}function d0e({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const h0e={inView:{Feature:u0e},tap:{Feature:i0e},focus:{Feature:r0e},hover:{Feature:n0e}},f0e={layout:{ProjectionNode:aG,MeasureLayout:YH}},f5={current:null},sG={current:!1};function p0e(){if(sG.current=!0,!!aN)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>f5.current=e.matches;e.addListener(t),t()}else f5.current=!1}const m0e=new WeakMap;function g0e(e,t,n){for(const r in t){const l=t[r],d=n[r];if(Wl(l))e.addValue(r,l);else if(Wl(d))e.addValue(r,d_(l,{owner:e}));else if(d!==l)if(e.hasValue(r)){const p=e.getValue(r);p.liveStyle===!0?p.jump(l):p.hasAnimated||p.set(l)}else{const p=e.getStaticValue(r);e.addValue(r,d_(p!==void 0?p:l,{owner:e}))}}for(const r in n)t[r]===void 0&&e.removeValue(r);return t}const i8=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class x0e{scrapeMotionValuesFromProps(t,n,r){return{}}constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:l,blockInitialAnimation:d,visualState:p},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=wN,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const I=$c.now();this.renderScheduledAt<I&&(this.renderScheduledAt=I,ys.render(this.render,!1,!0))};const{latestValues:b,renderState:T}=p;this.latestValues=b,this.baseTarget={...b},this.initialValues=n.initial?{...b}:{},this.renderState=T,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=l,this.options=a,this.blockInitialAnimation=!!d,this.isControllingVariants=y3(n),this.isVariantNode=CH(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:E,...P}=this.scrapeMotionValuesFromProps(n,{},this);for(const I in P){const R=P[I];b[I]!==void 0&&Wl(R)&&R.set(b[I],!1)}}mount(t){this.current=t,m0e.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),sG.current||p0e(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:f5.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),rx(this.notifyUpdate),rx(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=j_.has(t);r&&this.onBindTransform&&this.onBindTransform();const l=n.on("change",a=>{this.latestValues[t]=a,this.props.onUpdate&&ys.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),d=n.on("renderRequest",this.scheduleRender);let p;window.MotionCheckAppearSync&&(p=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{l(),d(),p&&p(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in h_){const n=h_[t];if(!n)continue;const{isEnabled:r,Feature:l}=n;if(!this.features[t]&&l&&r(this.props)&&(this.features[t]=new l(this)),this.features[t]){const d=this.features[t];d.isMounted?d.update():(d.mount(),d.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Us()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<i8.length;r++){const l=i8[r];this.propEventSubscriptions[l]&&(this.propEventSubscriptions[l](),delete this.propEventSubscriptions[l]);const d="on"+l,p=t[d];p&&(this.propEventSubscriptions[l]=this.on(l,p))}this.prevMotionValues=g0e(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const r=this.values.get(t);n!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=d_(n===null?void 0:n,{owner:this}),this.addValue(t,r)),r}readValue(t,n){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(kq(r)||zq(r))?r=parseFloat(r):!Rme(r)&&ix.test(n)&&(r=yH(t,n)),this.setBaseTarget(t,Wl(r)?r.get():r)),Wl(r)?r.get():r}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var d;const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const p=kN(this.props,n,(d=this.presenceContext)==null?void 0:d.custom);p&&(r=p[t])}if(n&&r!==void 0)return r;const l=this.getBaseTargetFromProps(this.props,t);return l!==void 0&&!Wl(l)?l:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new uN),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}}class oG extends x0e{constructor(){super(...arguments),this.KeyframeResolver=Tme}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Wl(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function lG(e,{style:t,vars:n},r,l){Object.assign(e.style,t,l&&l.getProjectionStyles(r));for(const d in n)e.style.setProperty(d,n[d])}function y0e(e){return window.getComputedStyle(e)}class v0e extends oG{constructor(){super(...arguments),this.type="html",this.renderInstance=lG}readValueFromInstance(t,n){var r;if(j_.has(n))return(r=this.projection)!=null&&r.isProjecting?e5(n):$pe(t,n);{const l=y0e(t),d=(fN(n)?l.getPropertyValue(n):l[n])||0;return typeof d=="string"?d.trim():d}}measureInstanceViewportBox(t,{transformPagePoint:n}){return WH(t,n)}build(t,n,r){DN(t,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,n,r){return RN(t,n,r)}}const cG=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function _0e(e,t,n,r){lG(e,t,void 0,r);for(const l in t.attrs)e.setAttribute(cG.has(l)?l:NN(l),t.attrs[l])}class b0e extends oG{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Us}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(j_.has(n)){const r=xH(n);return r&&r.default||0}return n=cG.has(n)?n:NN(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,r){return zH(t,n,r)}build(t,n,r){OH(t,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,n,r,l){_0e(t,n,r,l)}mount(t){this.isSVGTag=kH(t.tagName),super.mount(t)}}const w0e=(e,t)=>IN(e)?new b0e(t):new v0e(t,{allowProjection:e!==V.Fragment}),S0e=_ge({...Gge,...h0e,...t0e,...f0e},w0e),Ko=Hme(S0e);function a8(){const e=br(),t=ln(P=>{var I;return(I=P.comunidades)==null?void 0:I.lista}),n=Array.isArray(t)?t:[],r=ln(P=>{var I;return((I=P.comunidadSeleccionada)==null?void 0:I.comunidad)||null}),[l,d]=V.useState(!1),p=V.useRef(null);V.useEffect(()=>{if(r)return;let P=null;if(typeof window<"u")try{const R=window.localStorage.getItem("comunidadSeleccionada");P=R?JSON.parse(R):null}catch{P=null}const I=(P==null?void 0:P.comunidad)||null;if(I){if(n.length>0){const R=n.find(F=>(F==null?void 0:F._id)===I._id);if(R){e(X1(R));return}e(X1(n[0]));return}e(X1(I));return}n.length>0&&e(X1(n[0]))},[n,r,e]);const a=V.useMemo(()=>n.map(P=>({label:(P==null?void 0:P.name)??"Sin nombre",value:(P==null?void 0:P._id)??""})),[n]),b=V.useMemo(()=>!r||!Array.isArray(a)?null:a.find(P=>P.value===r._id)||null,[r,a]),T=P=>{const I=P&&n.find(R=>(R==null?void 0:R._id)===P.value)||null;e(X1(I)),d(!1)},E=!r;return V.useEffect(()=>{const P=I=>{p.current&&!p.current.contains(I.target)&&d(!1)};return l&&document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[l]),f.jsxs(f.Fragment,{children:[f.jsx("aside",{className:"hidden 2xl:flex flex-col justify-between  2xl:w-[12vw] mt-20 p-2 shadow-lg h-[60vh] overflow-hidden relative bg-gradient-to-b from-[#fff7ec] to-[#f3e8ff]",children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("img",{src:nx,alt:"Comunidades conectadas",className:"w-[60%] mx-auto mt-6 opacity-90"}),f.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"¿De qué comunidad sos?"}),f.jsx("p",{className:"text-xs text-gray-500 mt-1 leading-tight",children:"Elegí una para ver contenido relevante."})]}),f.jsx(gs,{value:b,onChange:T,options:a,placeholder:"Elegí con cuál te sentís parte",isSearchable:!1,styles:Hz,classNamePrefix:"rs",noOptionsMessage:()=>"Sin resultados"})]})}),f.jsxs("div",{className:"2xl:hidden",children:[f.jsx(ax,{children:!l&&f.jsx(Ko.button,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.3},onClick:()=>d(!0),className:`fixed z-50 border shadow-xl text-sky-600 flex items-center justify-center rounded-full transition-all duration-300 ${E?"bottom-6 right-6 p-4 bg-sky-200 animate-pulse scale-110":"bottom-6 left-4 p-2 bg-gray-100 scale-75"}`,title:"Selecciona tu comunidad",children:f.jsx(Mce,{className:"w-6 h-6"})},"boton-flotante")}),f.jsx(ax,{children:l&&f.jsxs(Ko.div,{ref:p,initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},transition:{duration:.35},className:"fixed bottom-5 2xl:bottom-20 right-4 z-50 w-[90vw] max-w-[360px] bg-gradient-to-b from-[#fff7ec] to-[#f3e8ff] p-4 rounded-2xl shadow-2xl border border-sky-300 h-[40vh] min-h-[350px] flex flex-col justify-between",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Comunidad"}),f.jsx(gs,{value:b,onChange:T,options:a,placeholder:"¿De qué comunidad eres?",isClearable:!0,isSearchable:!1,styles:Hz,classNamePrefix:"rs",noOptionsMessage:()=>"Sin resultados"})]}),f.jsx("img",{src:nx,alt:"Comunidades conectadas",className:"w-[50%] mx-auto mt-6 opacity-90"}),f.jsx("button",{onClick:()=>d(!1),className:"text-xs text-gray-500 self-end mt-4",children:"Cerrar"})]},"dropdown-flotante")})]})]})}function T0e(){const e=yl();Kce();const t=ln(l=>{var d,p;return(p=(d=l.comunidadSeleccionada)==null?void 0:d.comunidad)==null?void 0:p._id});V.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"smooth"})},[e.pathname]);const r=["/login","/register","/dashboard","/premium","/suscribirse","/suscripcion-exitosa","/suscripcion-cancelada","/inbox","/inbox/conversation"].some(l=>e.pathname.startsWith(l));return f.jsxs("div",{className:"flex flex-col min-h-screen",children:[f.jsx(P$,{}),!r&&f.jsx("div",{className:"w-full bg-gradient-to-r from-[#fff7ec] to-[#f3e8ff] text-center py-2",children:f.jsx(FM,{placement:"home_top",communityId:t,adUnit:"1234567890",enableGoogleAds:!0,className:"mx-auto max-w-[1400px]",containerStyle:{minHeight:"120px"},fixedHeight:"120px",imgClassName:"max-h-[116px]"})}),f.jsxs("main",{className:"flex w-full max-w-full   mx-auto gap-4 flex-grow px-2 md:px-4",children:[!r&&f.jsx("div",{className:"hidden 2xl:block w-[230px] shrink-0",children:f.jsx(a8,{})}),f.jsx("div",{className:"flex-1 flex flex-col md:gap-12 py-8 overflow-hidden mx-auto 2xl:max-w-[1440px]",children:f.jsx(t3,{})}),!r&&f.jsx("div",{className:"hidden lg:block",children:f.jsx(Zce,{communityId:t})})]}),!r&&f.jsx("div",{className:"2xl:hidden",children:f.jsx(a8,{})}),!r&&f.jsx("div",{className:"w-full bg-gradient-to-r from-[#fff7ec] to-[#f3e8ff] text-center py-2",children:f.jsx(FM,{placement:"home_bottom",communityId:t,adUnit:"1234567891",enableGoogleAds:!0,className:"mx-auto max-w-[1400px]",containerStyle:{minHeight:"120px"},fixedHeight:"120px",imgClassName:"max-h-[116px]"})}),f.jsx(Gce,{}),f.jsx(Xce,{})]})}function uG({value:e}){return f.jsxs("span",{className:"flex items-center gap-1 px-2 py-[1px] text-[10px] font-semibold uppercase italic tracking-tight",style:{background:"linear-gradient(to right, #fbbf24, #fde68a)",clipPath:"polygon(0% 0%, 85% 0%, 100% 50%, 85% 100%, 0% 100%, 10% 50%)"},children:[f.jsx("span",{className:"text-white font-bold drop-shadow-[1px_1px_1px_rgba(0,0,0,0.6)]",children:e}),f.jsx("span",{className:"text-neutral-800 font-semibold",children:"OFF"})]})}function dG(){return f.jsxs("span",{className:"flex items-center gap-1 px-2 py-[1px] text-[10px] font-semibold uppercase italic tracking-tight text-black shadow-[1px_1px_2px_rgba(0,0,0,0.4)]",style:{background:"linear-gradient(to right, #d8b4fe, #f3e8ff)",clipPath:"polygon(0% 0%, 85% 0%, 100% 50%, 85% 100%, 0% 100%, 10% 50%)"},children:[f.jsx("svg",{className:"w-3 h-3 text-white drop-shadow-[1px_1px_1px_rgba(0,0,0,0.5)]",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{d:"M11.3 1.046a.75.75 0 011.255.794L10.805 7h3.445a.75.75 0 01.6 1.2l-6.5 8.5a.75.75 0 01-1.31-.684L8.695 11H5.25a.75.75 0 01-.6-1.2l6.65-8.754z"})}),"Nuevo"]})}function LN({size:e=24}){return f.jsx("svg",{style:{width:e,height:e},className:"text-gray-400 m-auto",fill:"none",stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:`M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10\r
        10-4.48 10-10S17.52 2 12 2zm0 18c-1.85 0-3.55-.63-4.9-1.69.01-2.5 3.27-3.88 4.9-3.88\r
        1.63 0 4.89 1.38 4.9 3.88C15.55 19.37 13.85 20 12 20zm0-8a3 3 0 100-6 3 3 0 000 6z`})})}function FN({title:e,image:t,logo:n,description:r,isVerified:l=!1,isNew:d=!1,hasDiscount:p=!1,descuento:a="20%",modo:b="horizontal-compact",category:T,isPremium:E=!1}){const P=!!t,I={vertical:"flex flex-col mb-8 h-auto w-[100%] md:w-full max-w-[280px] sm:max-w-[250px] md:max-w-[250px] lg:max-w-[320px]","horizontal-full":"flex h-36 w-full max-w-6xl mx-auto","horizontal-compact":"flex h-36 w-[85%] md:w-full max-w-[350px] flex-shrink-0"};return f.jsxs("div",{className:`relative rounded-2xl overflow-hidden transition duration-300 ease-in-out group 
        ${I[b]}
        border  hover:shadow-xl 
        ${E?"border-yellow-400 shadow-[0_0_4px_4px_rgba(234,179,8,0.3)]":"border-gray-200 shadow-sm"}`,children:[f.jsxs("div",{className:b==="vertical"?"relative w-full h-42 md:h-36 bg-gray-200 overflow-hidden":"relative w-1/3 h-full bg-gray-200 overflow-hidden flex items-center justify-center",children:[P?f.jsx("div",{className:"w-full h-full bg-cover bg-center transform transition-transform duration-500 group-hover:scale-110",style:{backgroundImage:`url(${t})`}}):f.jsx(LN,{}),f.jsx("div",{className:"absolute inset-0 bg-black/10 opacity-0 group-hover:opacity-100 transition duration-300"}),f.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-16 bg-gradient-to-t from-black/40 to-transparent z-0"}),f.jsxs("div",{className:"absolute top-2 left-2 flex gap-1 z-10",children:[p&&f.jsx(uG,{value:a}),d&&f.jsx(dG,{})]}),T&&f.jsx("div",{className:`absolute top-2 right-2 text-xs font-semibold px-2 py-0.5 rounded-full shadow-sm z-10
        ${E?"bg-orange-500 text-white":"bg-white text-gray-800"}`,children:T}),f.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition duration-300 z-10",children:f.jsx("button",{className:"bg-orange-500 text-white text-xs px-3 py-1 rounded-full shadow-md hover:bg-orange-600 transition",children:"Ver más"})}),n&&f.jsx("div",{className:`absolute bottom-2 right-2 rounded-full border border-white shadow-md bg-white overflow-hidden z-10
        ${E?"w-12 h-12":"w-10 h-10"}`,children:f.jsx("div",{className:"w-full h-full bg-cover bg-center",style:{backgroundImage:`url("${n}")`}})}),E&&f.jsx("div",{className:"absolute bottom-2 left-2 text-yellow-500 rounded-full p-1 shadow-md z-10",children:f.jsx(R$,{className:"w-5 h-5"})})]}),f.jsx("div",{className:`relative ${b==="vertical"?"px-4 py-3":"w-2/3 p-4 flex flex-col justify-between"} ${E?"bg-black text-white":""}`,children:f.jsxs("div",{className:"flex flex-col gap-1 truncate min-h-[40px] max-h-[40px]",children:[f.jsx("div",{className:"flex items-center gap-1",children:f.jsx("p",{className:"text-[15px] font-semibold leading-snug overflow-hidden text-ellipsis whitespace-normal [display:-webkit-box] [-webkit-line-clamp:2] [-webkit-box-orient:vertical]",title:e,children:e})}),r&&f.jsx("p",{className:"text-xs font-normal truncate",children:r})]})})]})}function M_({children:e,className:t=""}){const n=V.useRef(null),[r,l]=V.useState(!1),d=p=>{const a=n.current;if(a){const b=a.offsetWidth*.6;a.scrollBy({left:p==="left"?-b:b,behavior:"smooth"})}};return V.useEffect(()=>{const p=n.current;if(!p)return;const a=()=>{l(p.scrollWidth>p.clientWidth)};return a(),window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[e]),f.jsxs("div",{className:"relative w-full z-0 px-4",children:[f.jsx("div",{className:"absolute left-1 top-1/2 -translate-y-1/2 z-20 md:hidden pointer-events-none",children:f.jsx(nz,{size:20,className:"text-white opacity-90 drop-shadow"})}),f.jsx("div",{className:"absolute right-1 top-1/2 -translate-y-1/2 z-20 md:hidden pointer-events-none",children:f.jsx(kb,{size:20,className:"text-white opacity-90 drop-shadow"})}),r&&f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:()=>d("left"),className:"hidden md:flex absolute left-2 top-1/2 -translate-y-1/2 z-20 bg-white p-2 rounded-full shadow hover:bg-gray-100 transition pointer-events-auto",children:f.jsx(nz,{size:20})}),f.jsx("button",{onClick:()=>d("right"),className:"hidden md:flex absolute right-2 top-1/2 -translate-y-1/2 z-20 bg-white p-2 rounded-full shadow hover:bg-gray-100 transition pointer-events-auto",children:f.jsx(kb,{size:20})})]}),f.jsx("div",{className:"w-full overflow-x-hidden px-2",children:f.jsx("div",{ref:n,className:`z-10 flex gap-4 px-4 overflow-x-auto scroll-smooth touch-pan-x whitespace-nowrap
            snap-x snap-mandatory
            [-ms-overflow-style:none] [scrollbar-width:none] [&::-webkit-scrollbar]:hidden ${t}`,children:e})})]})}function BN(){return f.jsxs("section",{className:"space-y-4 animate-pulse",children:[f.jsx("div",{className:"h-8 w-48 md:w-52 bg-gray-200 rounded"}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Array.from({length:3}).map((e,t)=>f.jsx("div",{className:`w-full bg-gray-100 rounded-xl h-60 md:h-40 ${t===0?"":"hidden md:block"}`},t))})]})}function hG({negocios:e=[],loading:t,imagen:n}){if(t)return f.jsx(BN,{});const r=e.slice(0,6);return r.length===0?null:f.jsx("section",{className:"space-y-4",children:f.jsx(M_,{children:r.map(l=>f.jsx(Wn,{to:`/negocios/${l._id}`,className:"flex-shrink-0 snap-start min-w-[280px] sm:min-w-[250px] md:min-w-[250px] lg:min-w-[320px]",children:f.jsx(FN,{isPremium:l.isPremium,title:l.name,image:l.featuredImage,isNew:!1,hasDiscount:!1,isVerified:l.isVerified,modo:"vertical",logo:l.profileImage})},l._id))})})}function fG({eventos:e=[],loading:t,imagen:n}){if(t)return f.jsx(BN,{});const r=e.filter(l=>{const d=new Date(l.date);return!isNaN(d)&&d>new Date}).slice(0,6);return r.length===0?null:f.jsx("section",{className:"space-y-4",children:f.jsx(M_,{children:r.map(l=>{const{_id:d,title:p,featuredImage:a}=l;return f.jsx(Wn,{to:`/eventos/${d}`,className:"flex-shrink-0 snap-start min-w-[280px] sm:min-w-[250px] md:min-w-[250px] lg:min-w-[320px]",children:f.jsx(FN,{title:p,image:a,modo:"vertical"})},d)})})})}function pG({comunidades:e=[],loading:t}){if(t)return f.jsx(BN,{});const n=e.slice(0,6);return n.length===0?null:f.jsx("section",{className:"space-y-4",children:f.jsx(M_,{children:n.map(r=>f.jsx(Wn,{to:`/comunidades/${r._id||r.id}`,className:"flex-shrink-0 snap-start min-w-[280px] sm:min-w-[250px] md:min-w-[250px] lg:min-w-[320px]",children:f.jsx(FN,{title:r.name,image:r.bannerImage||r.flagImage,modo:"vertical",logo:r.flagImage})},r._id||r.id))})})}const E0e="/assets/bn1-BI8ql6H4.png",A0e="/assets/bn2-CSrT9LO1.png";function C0e({onBuscar:e}){const t=[E0e,A0e],[n,r]=V.useState(0),[l,d]=V.useState(1),p=V.useRef();return V.useEffect(()=>{t.forEach(a=>{const b=new Image;b.src=a})},[]),V.useEffect(()=>{const a=setInterval(()=>{d(0),setTimeout(()=>{const b=(n+1)%t.length;r(b),d(1)},500)},7e3);return()=>clearInterval(a)},[n,t.length]),f.jsx("div",{className:"@container",children:f.jsxs("div",{className:"@[480px] relative overflow-hidden rounded-xl min-h-[500px]",children:[f.jsx("img",{ref:p,src:t[n],alt:"",className:"absolute inset-0 w-full h-full object-cover transition-opacity duration-500",style:{opacity:l}}),f.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/10 to-black/40"}),f.jsxs("div",{className:"relative z-10 flex flex-col gap-6 @[480px]:gap-8 items-center justify-center p-4 h-full",children:[f.jsx("h1",{className:"text-white text-4xl font-black text-center tracking-[-0.033em] @[480px]:text-5xl",children:"Descubre los mejores negocios, eventos y novedades de tu comunidad"}),f.jsx("div",{className:"w-full max-w-[480px]",children:e&&e()})]})]})})}function mG({value:e,onChange:t,onBuscar:n,onLimpiar:r,placeholder:l="Buscar..."}){const d=p=>{p.key==="Enter"&&n()};return f.jsx("div",{className:"px-4 py-3 flex",children:f.jsxs("div",{className:`\r
          flex items-center gap-2\r
          bg-white/50 backdrop-blur-md\r
          border border-sky-400\r
          rounded-2xl\r
          h-12 px-4\r
          shadow-2xl\r
          transition-all\r
          focus-within:border-sky-400\r
          focus-within:ring-2\r
          focus-within:ring-sky-300/40\r
          w-full max-w-[400px]\r
        `,children:[f.jsx("button",{onClick:n,className:"text-black hover:opacity-70 transition",children:f.jsx(hle,{})}),f.jsx("input",{type:"text",inputMode:"search",autoComplete:"off",value:e,onChange:p=>{t(p.target.value),p.target.value.trim()===""&&(r==null||r())},onKeyDown:d,placeholder:l,className:`\r
    flex-1 bg-transparent border-none outline-none\r
    text-[16px] md:text-sm lg:text-base\r
    text-black placeholder:text-black\r
  `})]})})}function j0e({onResultadosRef:e,onResaltar:t}){const n=br(),[r,l]=V.useState(""),d=()=>{const a=r.trim();a?n(jb(a)).then(()=>{var b;(b=e==null?void 0:e.current)==null||b.scrollIntoView({behavior:"smooth",block:"start"}),t==null||t()}):n(Qb())},p=()=>{l(""),n(Qb())};return f.jsx(C0e,{onBuscar:()=>f.jsx(mG,{value:r,onChange:l,onBuscar:d,onLimpiar:p})})}var xT={exports:{}},M0e=xT.exports,s8;function P0e(){return s8||(s8=1,function(e,t){(function(n,r){e.exports=r()})(M0e,function(){var n,r,l;function d(a,b){if(!n)n=b;else if(!r)r=b;else{var T="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk); self.onerror = null;",E={};n(E),l=b(E),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(l.workerUrl=window.URL.createObjectURL(new Blob([T],{type:"text/javascript"})))}}d(["exports"],function(a){var b=1e-6,T=typeof Float32Array<"u"?Float32Array:Array;function E(c,i){var o=i[0],h=i[1],g=i[2],_=i[3],w=o*_-g*h;return w?(c[0]=_*(w=1/w),c[1]=-h*w,c[2]=-g*w,c[3]=o*w,c):null}function P(){var c=new T(9);return T!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function I(c,i){var o=i[0],h=i[1],g=i[2],_=i[3],w=i[4],j=i[5],N=i[6],O=i[7],L=i[8];return c[0]=w*L-j*O,c[1]=g*O-h*L,c[2]=h*j-g*w,c[3]=j*N-_*L,c[4]=o*L-g*N,c[5]=g*_-o*j,c[6]=_*O-w*N,c[7]=h*N-o*O,c[8]=o*w-h*_,c}function R(c,i,o){var h=i[0],g=i[1],_=i[2],w=i[3],j=i[4],N=i[5],O=i[6],L=i[7],B=i[8],q=o[0],Y=o[1],Q=o[2],re=o[3],he=o[4],pe=o[5],Se=o[6],be=o[7],oe=o[8];return c[0]=q*h+Y*w+Q*O,c[1]=q*g+Y*j+Q*L,c[2]=q*_+Y*N+Q*B,c[3]=re*h+he*w+pe*O,c[4]=re*g+he*j+pe*L,c[5]=re*_+he*N+pe*B,c[6]=Se*h+be*w+oe*O,c[7]=Se*g+be*j+oe*L,c[8]=Se*_+be*N+oe*B,c}function F(){var c=new T(16);return T!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c}function W(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function $(c,i){var o=i[0],h=i[1],g=i[2],_=i[3],w=i[4],j=i[5],N=i[6],O=i[7],L=i[8],B=i[9],q=i[10],Y=i[11],Q=i[12],re=i[13],he=i[14],pe=i[15],Se=o*j-h*w,be=o*N-g*w,oe=o*O-_*w,xe=h*N-g*j,we=h*O-_*j,je=g*O-_*N,Ve=L*re-B*Q,We=L*he-q*Q,Ze=L*pe-Y*Q,Qe=B*he-q*re,pt=B*pe-Y*re,kt=q*pe-Y*he,Ct=Se*kt-be*pt+oe*Qe+xe*Ze-we*We+je*Ve;return Ct?(c[0]=(j*kt-N*pt+O*Qe)*(Ct=1/Ct),c[1]=(g*pt-h*kt-_*Qe)*Ct,c[2]=(re*je-he*we+pe*xe)*Ct,c[3]=(q*we-B*je-Y*xe)*Ct,c[4]=(N*Ze-w*kt-O*We)*Ct,c[5]=(o*kt-g*Ze+_*We)*Ct,c[6]=(he*oe-Q*je-pe*be)*Ct,c[7]=(L*je-q*oe+Y*be)*Ct,c[8]=(w*pt-j*Ze+O*Ve)*Ct,c[9]=(h*Ze-o*pt-_*Ve)*Ct,c[10]=(Q*we-re*oe+pe*Se)*Ct,c[11]=(B*oe-L*we-Y*Se)*Ct,c[12]=(j*We-w*Qe-N*Ve)*Ct,c[13]=(o*Qe-h*We+g*Ve)*Ct,c[14]=(re*be-Q*xe-he*Se)*Ct,c[15]=(L*xe-B*be+q*Se)*Ct,c):null}function Z(c,i,o){var h=i[0],g=i[1],_=i[2],w=i[3],j=i[4],N=i[5],O=i[6],L=i[7],B=i[8],q=i[9],Y=i[10],Q=i[11],re=i[12],he=i[13],pe=i[14],Se=i[15],be=o[0],oe=o[1],xe=o[2],we=o[3];return c[0]=be*h+oe*j+xe*B+we*re,c[1]=be*g+oe*N+xe*q+we*he,c[2]=be*_+oe*O+xe*Y+we*pe,c[3]=be*w+oe*L+xe*Q+we*Se,c[4]=(be=o[4])*h+(oe=o[5])*j+(xe=o[6])*B+(we=o[7])*re,c[5]=be*g+oe*N+xe*q+we*he,c[6]=be*_+oe*O+xe*Y+we*pe,c[7]=be*w+oe*L+xe*Q+we*Se,c[8]=(be=o[8])*h+(oe=o[9])*j+(xe=o[10])*B+(we=o[11])*re,c[9]=be*g+oe*N+xe*q+we*he,c[10]=be*_+oe*O+xe*Y+we*pe,c[11]=be*w+oe*L+xe*Q+we*Se,c[12]=(be=o[12])*h+(oe=o[13])*j+(xe=o[14])*B+(we=o[15])*re,c[13]=be*g+oe*N+xe*q+we*he,c[14]=be*_+oe*O+xe*Y+we*pe,c[15]=be*w+oe*L+xe*Q+we*Se,c}function ne(c,i,o){var h,g,_,w,j,N,O,L,B,q,Y,Q,re=o[0],he=o[1],pe=o[2];return i===c?(c[12]=i[0]*re+i[4]*he+i[8]*pe+i[12],c[13]=i[1]*re+i[5]*he+i[9]*pe+i[13],c[14]=i[2]*re+i[6]*he+i[10]*pe+i[14],c[15]=i[3]*re+i[7]*he+i[11]*pe+i[15]):(g=i[1],_=i[2],w=i[3],j=i[4],N=i[5],O=i[6],L=i[7],B=i[8],q=i[9],Y=i[10],Q=i[11],c[0]=h=i[0],c[1]=g,c[2]=_,c[3]=w,c[4]=j,c[5]=N,c[6]=O,c[7]=L,c[8]=B,c[9]=q,c[10]=Y,c[11]=Q,c[12]=h*re+j*he+B*pe+i[12],c[13]=g*re+N*he+q*pe+i[13],c[14]=_*re+O*he+Y*pe+i[14],c[15]=w*re+L*he+Q*pe+i[15]),c}function ie(c,i,o){var h=o[0],g=o[1],_=o[2];return c[0]=i[0]*h,c[1]=i[1]*h,c[2]=i[2]*h,c[3]=i[3]*h,c[4]=i[4]*g,c[5]=i[5]*g,c[6]=i[6]*g,c[7]=i[7]*g,c[8]=i[8]*_,c[9]=i[9]*_,c[10]=i[10]*_,c[11]=i[11]*_,c[12]=i[12],c[13]=i[13],c[14]=i[14],c[15]=i[15],c}function ge(c,i,o){var h=Math.sin(o),g=Math.cos(o),_=i[4],w=i[5],j=i[6],N=i[7],O=i[8],L=i[9],B=i[10],q=i[11];return i!==c&&(c[0]=i[0],c[1]=i[1],c[2]=i[2],c[3]=i[3],c[12]=i[12],c[13]=i[13],c[14]=i[14],c[15]=i[15]),c[4]=_*g+O*h,c[5]=w*g+L*h,c[6]=j*g+B*h,c[7]=N*g+q*h,c[8]=O*g-_*h,c[9]=L*g-w*h,c[10]=B*g-j*h,c[11]=q*g-N*h,c}function ae(c,i,o){var h=Math.sin(o),g=Math.cos(o),_=i[0],w=i[1],j=i[2],N=i[3],O=i[8],L=i[9],B=i[10],q=i[11];return i!==c&&(c[4]=i[4],c[5]=i[5],c[6]=i[6],c[7]=i[7],c[12]=i[12],c[13]=i[13],c[14]=i[14],c[15]=i[15]),c[0]=_*g-O*h,c[1]=w*g-L*h,c[2]=j*g-B*h,c[3]=N*g-q*h,c[8]=_*h+O*g,c[9]=w*h+L*g,c[10]=j*h+B*g,c[11]=N*h+q*g,c}function se(c,i,o){var h=Math.sin(o),g=Math.cos(o),_=i[0],w=i[1],j=i[2],N=i[3],O=i[4],L=i[5],B=i[6],q=i[7];return i!==c&&(c[8]=i[8],c[9]=i[9],c[10]=i[10],c[11]=i[11],c[12]=i[12],c[13]=i[13],c[14]=i[14],c[15]=i[15]),c[0]=_*g+O*h,c[1]=w*g+L*h,c[2]=j*g+B*h,c[3]=N*g+q*h,c[4]=O*g-_*h,c[5]=L*g-w*h,c[6]=B*g-j*h,c[7]=q*g-N*h,c}function me(c,i){return c[0]=i[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=i[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=i[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function ke(c,i,o){var h,g,_,w=o[0],j=o[1],N=o[2],O=Math.hypot(w,j,N);return O<b?null:(w*=O=1/O,j*=O,N*=O,h=Math.sin(i),g=Math.cos(i),c[0]=w*w*(_=1-g)+g,c[1]=j*w*_+N*h,c[2]=N*w*_-j*h,c[3]=0,c[4]=w*j*_-N*h,c[5]=j*j*_+g,c[6]=N*j*_+w*h,c[7]=0,c[8]=w*N*_+j*h,c[9]=j*N*_-w*h,c[10]=N*N*_+g,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c)}function qe(c,i){var o=i[0],h=i[1],g=i[2],_=i[3],w=o+o,j=h+h,N=g+g,O=o*w,L=h*w,B=h*j,q=g*w,Y=g*j,Q=g*N,re=_*w,he=_*j,pe=_*N;return c[0]=1-B-Q,c[1]=L+pe,c[2]=q-he,c[3]=0,c[4]=L-pe,c[5]=1-O-Q,c[6]=Y+re,c[7]=0,c[8]=q+he,c[9]=Y-re,c[10]=1-O-B,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}Math.hypot||(Math.hypot=function(){for(var c=0,i=arguments.length;i--;)c+=arguments[i]*arguments[i];return Math.sqrt(c)});var tt=Z;function nt(){var c=new T(3);return T!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function bt(c){var i=new T(3);return i[0]=c[0],i[1]=c[1],i[2]=c[2],i}function jt(c){return Math.hypot(c[0],c[1],c[2])}function Nt(c,i,o){var h=new T(3);return h[0]=c,h[1]=i,h[2]=o,h}function vt(c,i,o){return c[0]=i[0]+o[0],c[1]=i[1]+o[1],c[2]=i[2]+o[2],c}function He(c,i,o){return c[0]=i[0]-o[0],c[1]=i[1]-o[1],c[2]=i[2]-o[2],c}function ut(c,i,o){return c[0]=i[0]*o[0],c[1]=i[1]*o[1],c[2]=i[2]*o[2],c}function Tt(c,i,o){return c[0]=Math.min(i[0],o[0]),c[1]=Math.min(i[1],o[1]),c[2]=Math.min(i[2],o[2]),c}function Yt(c,i,o){return c[0]=Math.max(i[0],o[0]),c[1]=Math.max(i[1],o[1]),c[2]=Math.max(i[2],o[2]),c}function Ge(c,i,o){return c[0]=i[0]*o,c[1]=i[1]*o,c[2]=i[2]*o,c}function ot(c,i,o,h){return c[0]=i[0]+o[0]*h,c[1]=i[1]+o[1]*h,c[2]=i[2]+o[2]*h,c}function mt(c,i){var o=i[0]-c[0],h=i[1]-c[1],g=i[2]-c[2];return o*o+h*h+g*g}function It(c){var i=c[0],o=c[1],h=c[2];return i*i+o*o+h*h}function In(c,i){return c[0]=-i[0],c[1]=-i[1],c[2]=-i[2],c}function Mn(c,i){var o=i[0],h=i[1],g=i[2],_=o*o+h*h+g*g;return _>0&&(_=1/Math.sqrt(_)),c[0]=i[0]*_,c[1]=i[1]*_,c[2]=i[2]*_,c}function vn(c,i){return c[0]*i[0]+c[1]*i[1]+c[2]*i[2]}function Zn(c,i,o){var h=i[0],g=i[1],_=i[2],w=o[0],j=o[1],N=o[2];return c[0]=g*N-_*j,c[1]=_*w-h*N,c[2]=h*j-g*w,c}function Sr(c,i,o,h){var g=i[0],_=i[1],w=i[2];return c[0]=g+h*(o[0]-g),c[1]=_+h*(o[1]-_),c[2]=w+h*(o[2]-w),c}function un(c,i,o){var h=i[0],g=i[1],_=i[2],w=o[3]*h+o[7]*g+o[11]*_+o[15];return c[0]=(o[0]*h+o[4]*g+o[8]*_+o[12])/(w=w||1),c[1]=(o[1]*h+o[5]*g+o[9]*_+o[13])/w,c[2]=(o[2]*h+o[6]*g+o[10]*_+o[14])/w,c}function er(c,i,o){var h=i[0],g=i[1],_=i[2];return c[0]=h*o[0]+g*o[3]+_*o[6],c[1]=h*o[1]+g*o[4]+_*o[7],c[2]=h*o[2]+g*o[5]+_*o[8],c}function hr(c,i,o){var h=o[0],g=o[1],_=o[2],w=i[0],j=i[1],N=i[2],O=g*N-_*j,L=_*w-h*N,B=h*j-g*w,q=g*B-_*L,Y=_*O-h*B,Q=h*L-g*O,re=2*o[3];return L*=re,B*=re,Y*=2,Q*=2,c[0]=w+(O*=re)+(q*=2),c[1]=j+L+Y,c[2]=N+B+Q,c}function dn(c,i){return c[0]===i[0]&&c[1]===i[1]&&c[2]===i[2]}var Ir=He,Zr=ut,sa=jt;function Mi(){var c=new T(4);return T!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0,c[3]=0),c}function Ci(c,i,o){return c[0]=i[0]*o,c[1]=i[1]*o,c[2]=i[2]*o,c[3]=i[3]*o,c}function ls(c,i){var o=i[0],h=i[1],g=i[2],_=i[3],w=o*o+h*h+g*g+_*_;return w>0&&(w=1/Math.sqrt(w)),c[0]=o*w,c[1]=h*w,c[2]=g*w,c[3]=_*w,c}function wa(c,i,o){var h=i[0],g=i[1],_=i[2],w=i[3];return c[0]=o[0]*h+o[4]*g+o[8]*_+o[12]*w,c[1]=o[1]*h+o[5]*g+o[9]*_+o[13]*w,c[2]=o[2]*h+o[6]*g+o[10]*_+o[14]*w,c[3]=o[3]*h+o[7]*g+o[11]*_+o[15]*w,c}function Xa(){var c=new T(4);return T!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function Ds(c){return c[0]=0,c[1]=0,c[2]=0,c[3]=1,c}function Ft(c,i,o){o*=.5;var h=i[0],g=i[1],_=i[2],w=i[3],j=Math.sin(o),N=Math.cos(o);return c[0]=h*N+w*j,c[1]=g*N+_*j,c[2]=_*N-g*j,c[3]=w*N-h*j,c}function Hn(c,i,o){o*=.5;var h=i[0],g=i[1],_=i[2],w=i[3],j=Math.sin(o),N=Math.cos(o);return c[0]=h*N-_*j,c[1]=g*N+w*j,c[2]=_*N+h*j,c[3]=w*N-g*j,c}nt(),Mi();var Zt,pn,tr,Qn,Yr,pi=ls,Ua=(Zt=nt(),pn=Nt(1,0,0),tr=Nt(0,1,0),function(c,i,o){var h=vn(i,o);return h<-.999999?(Zn(Zt,pn,i),sa(Zt)<1e-6&&Zn(Zt,tr,i),Mn(Zt,Zt),function(g,_,w){w*=.5;var j=Math.sin(w);g[0]=j*_[0],g[1]=j*_[1],g[2]=j*_[2],g[3]=Math.cos(w)}(c,Zt,Math.PI),c):h>.999999?(c[0]=0,c[1]=0,c[2]=0,c[3]=1,c):(Zn(Zt,i,o),c[0]=Zt[0],c[1]=Zt[1],c[2]=Zt[2],c[3]=1+h,pi(c,c))});function Ji(){var c=new T(2);return T!=Float32Array&&(c[0]=0,c[1]=0),c}function Xs(c,i){var o=new T(2);return o[0]=c,o[1]=i,o}function Ka(c,i,o){return c[0]=i[0]+o[0],c[1]=i[1]+o[1],c}function La(c,i,o){return c[0]=i[0]-o[0],c[1]=i[1]-o[1],c}function cs(c,i,o){return c[0]=i[0]*o,c[1]=i[1]*o,c}function Os(c){return Math.hypot(c[0],c[1])}function vs(c,i){var o=i[0],h=i[1],g=o*o+h*h;return g>0&&(g=1/Math.sqrt(g)),c[0]=i[0]*g,c[1]=i[1]*g,c}function yi(c,i){return c[0]*i[0]+c[1]*i[1]}function Is(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}Xa(),Xa(),P(),Ji();var Yc,ks,Kl=function(){if(Yr)return Qn;function c(i,o,h,g){this.cx=3*i,this.bx=3*(h-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(g-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=o,this.p2x=h,this.p2y=g}return Yr=1,Qn=c,c.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,o){if(o===void 0&&(o=1e-6),i<0)return 0;if(i>1)return 1;for(var h=i,g=0;g<8;g++){var _=this.sampleCurveX(h)-i;if(Math.abs(_)<o)return h;var w=this.sampleCurveDerivativeX(h);if(Math.abs(w)<1e-6)break;h-=_/w}var j=0,N=1;for(h=i,g=0;g<20&&(_=this.sampleCurveX(h),!(Math.abs(_-i)<o));g++)i>_?j=h:N=h,h=.5*(N-j)+j;return h},solve:function(i,o){return this.sampleCurveY(this.solveCurveX(i,o))}},Qn}(),Hd=Is(Kl);function Yl(){if(ks)return Yc;function c(i,o){this.x=i,this.y=o}return ks=1,Yc=c,c.prototype={clone:function(){return new c(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,o){return this.clone()._rotateAround(i,o)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var o=i.x-this.x,h=i.y-this.y;return o*o+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,o){return Math.atan2(this.x*o-this.y*i,this.x*i+this.y*o)},_matMult:function(i){var o=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=o,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var o=Math.cos(i),h=Math.sin(i),g=h*this.x+o*this.y;return this.x=o*this.x-h*this.y,this.y=g,this},_rotateAround:function(i,o){var h=Math.cos(i),g=Math.sin(i),_=o.y+g*(this.x-o.x)+h*(this.y-o.y);return this.x=o.x+h*(this.x-o.x)-g*(this.y-o.y),this.y=_,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},c.convert=function(i){return i instanceof c?i:Array.isArray(i)?new c(i[0],i[1]):i},Yc}var Kt=Is(Yl());function el(c,i){if(Array.isArray(c)){if(!Array.isArray(i)||c.length!==i.length)return!1;for(let o=0;o<c.length;o++)if(!el(c[o],i[o]))return!1;return!0}if(typeof c=="object"&&c!==null&&i!==null){if(typeof i!="object"||Object.keys(c).length!==Object.keys(i).length)return!1;for(const o in c)if(!el(c[o],i[o]))return!1;return!0}return c===i}const Fu=Math.PI/180,Te=180/Math.PI;function te(c){return c*Fu}function le(c){return c*Te}const ye=[[0,0],[1,0],[1,1],[0,1]];function Me(c){if(c<=0)return 0;if(c>=1)return 1;const i=c*c,o=i*c;return 4*(c<.5?o:3*(c-i)+o-.75)}function De(c,i,o,h){const g=new Hd(c,i,o,h);return function(_){return g.solve(_)}}const Be=De(.25,.1,.25,1);function Le(c,i,o){return Math.min(o,Math.max(i,c))}function Ue(c,i,o){return(o=Le((o-c)/(i-c),0,1))*o*(3-2*o)}function Ye(c,i,o){const h=o-i,g=((c-i)%h+h)%h+i;return g===i?o:g}function it(c,i,o){if(!c.length)return o(null,[]);let h=c.length;const g=new Array(c.length);let _=null;c.forEach((w,j)=>{i(w,(N,O)=>{N&&(_=N),g[j]=O,--h==0&&o(_,g)})})}function Xe(c,...i){for(const o of i)for(const h in o)c[h]=o[h];return c}let St=1;function qt(){return St++}function nn(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function Fn(c,i){c.forEach(o=>{i[o]&&(i[o]=i[o].bind(i))})}function zn(c,i,o){const h={};for(const g in c)h[g]=i.call(this,c[g],g,c);return h}function Ln(c,i,o){const h={};for(const g in c)i.call(this,c[g],g,c)&&(h[g]=c[g]);return h}function cr(c){return Array.isArray(c)?c.map(cr):typeof c=="object"&&c?zn(c,cr):c}const Qr={};function or(c){Qr[c]||(typeof console<"u"&&console.warn(c),Qr[c]=!0)}function Lr(c,i,o){return(o.y-c.y)*(i.x-c.x)>(i.y-c.y)*(o.x-c.x)}function Cr(c){let i=0;for(let o,h,g=0,_=c.length,w=_-1;g<_;w=g++)o=c[g],h=c[w],i+=(h.x-o.x)*(o.y+h.y);return i}function Jr([c,i,o]){const h=te(i+90),g=te(o);return{x:c*Math.cos(h)*Math.sin(g),y:c*Math.sin(h)*Math.sin(g),z:c*Math.cos(g),azimuthal:i,polar:o}}function mi(c){return(typeof self<"u"||c!==void 0)&&typeof WorkerGlobalScope<"u"&&(c!==void 0?c:self)instanceof WorkerGlobalScope}function Ti(c){const i={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,h,g,_)=>{const w=g||_;return i[h]=!w||w.toLowerCase(),""}),i["max-age"]){const o=parseInt(i["max-age"],10);isNaN(o)?delete i["max-age"]:i["max-age"]=o}return i}let ea=null;function Ar(c,i){return[c[4*i],c[4*i+1],c[4*i+2],c[4*i+3]]}function qi(c,i,o,h){for(;i<o;){const g=i+o>>1;c[g]<h?i=g+1:o=g}return i}function us(c,i,o,h){for(;i<o;){const g=i+o>>1;c[g]<=h?i=g+1:o=g}return i}function fa(c){return c>0?1/(1.001-c):1+c}function Fa(c){return c>0?1-1/(1.001-c):-c}function ci(c,i,o){return(c-i.min)*(o.max-o.min)/(i.max-i.min)+o.min}const Ca={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Ca.API_URL)return null;try{const c=new URL(Ca.API_URL);return c.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":c.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function No(c){return Ca.API_URL_REGEX.test(c)}function rs(c){return Ca.API_SPRITE_REGEX.test(c)}let nf,rf,Gd,af,Cc,dp;function Do(){return nf==null&&(nf=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),nf}const tl={now:()=>af!==void 0?af:performance.now(),setNow(c){af=c},restoreNow(){af=void 0},frame(c){const i=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(i)}},getImageData(c,i=0){const{width:o,height:h}=c;Cc||(Cc=document.createElement("canvas"));const g=Cc.getContext("2d",{willReadFrequently:!0});if(!g)throw new Error("failed to create canvas 2d context");return(o>Cc.width||h>Cc.height)&&(Cc.width=o,Cc.height=h),g.clearRect(-i,-i,o+2*i,h+2*i),g.drawImage(c,0,0,o,h),g.getImageData(-i,-i,o+2*i,h+2*i)},resolveURL:c=>(rf||(rf=document.createElement("a")),rf.href=c,rf.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Gd==null&&(Gd=window.matchMedia("(prefers-reduced-motion: reduce)")),Gd.matches)},hasCanvasFingerprintNoise(){if(dp!==void 0)return dp;if(!Do())return dp=!1,!1;const c=new OffscreenCanvas(85,1),i=c.getContext("2d",{willReadFrequently:!0});let o=0;for(let g=0;g<c.width;++g)i.fillStyle=`rgba(${o++},${o++},${o++}, 255)`,i.fillRect(g,0,1,1);const h=i.getImageData(0,0,c.width,c.height);o=0;for(let g=0;g<h.data.length;++g)if(g%4!=3&&o++!==h.data[g])return dp=!0,!0;return dp=!1,!1}};function Hm(c,i){const o=c.indexOf("?");if(o<0)return`${c}?${new URLSearchParams(i).toString()}`;const h=new URLSearchParams(c.slice(o));for(const g in i)h.set(g,i[g]);return`${c.slice(0,o)}?${h.toString()}`}function Ks(c,i={persistentParams:[]}){const o=c.indexOf("?");if(o<0)return c;const h=new URLSearchParams,g=new URLSearchParams(c.slice(o));for(const w of i.persistentParams){const j=g.get(w);j&&h.set(w,j)}const _=h.toString();return`${c.slice(0,o)}${_.length>0?`?${_}`:""}`}const Ys="mapbox-tiles";let jc=500,_l=50;const Oo=["language","worldview","jobid"];let bl,sf;function Gm(){try{return caches}catch{}}function Ql(){const c=Gm();c&&bl==null&&(bl=c.open(Ys))}let hp=1/0;const vx={supported:!1,testSupport:function(c){!of&&_s&&(Qc?_x(c):Bu=c)}};let Bu,_s,of=!1,Qc=!1;const Jl=typeof self<"u"?self:{};function _x(c){const i=c.createTexture();c.bindTexture(c.TEXTURE_2D,i);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,_s),c.isContextLost())return;vx.supported=!0}catch{}c.deleteTexture(i),of=!0}Jl.document&&(_s=Jl.document.createElement("img"),_s.onload=function(){Bu&&_x(Bu),Bu=null,Qc=!0},_s.onerror=function(){of=!0,Bu=null},_s.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const lf={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(lf);class fp extends Error{constructor(i,o,h){o===401&&No(h)&&(i+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(i),this.status=o,this.url=h}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Rr=mi()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Io=function(c,i){if(!(/^file:/.test(o=c.url)||/^file:/.test(Rr())&&!/^\w+:/.test(o))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(h,g){const _=new AbortController,w=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,referrer:Rr(),referrerPolicy:h.referrerPolicy,signal:_.signal});let j=!1,N=!1;const O=(L=w.url).indexOf("sku=")>0&&No(L);var L;h.type==="json"&&w.headers.set("Accept","application/json");const B=(Y,Q,re)=>{if(N)return;if(Y&&Y.message!=="SecurityError"&&or(Y.toString()),Q&&re)return q(Q);const he=Date.now();fetch(w).then(pe=>{if(pe.ok){const Se=O?pe.clone():null;return q(pe,Se,he)}return g(new fp(pe.statusText,pe.status,h.url))}).catch(pe=>{pe.name!=="AbortError"&&g(new Error(`${pe.message} ${h.url}`))})},q=(Y,Q,re)=>{(h.type==="arrayBuffer"?Y.arrayBuffer():h.type==="json"?Y.json():Y.text()).then(he=>{N||(Q&&re&&function(pe,Se,be){if(Ql(),bl==null)return;const oe=Ti(Se.headers.get("Cache-Control")||"");if(oe["no-store"])return;const xe={status:Se.status,statusText:Se.statusText,headers:new Headers};Se.headers.forEach((Ve,We)=>xe.headers.set(We,Ve)),oe["max-age"]&&xe.headers.set("Expires",new Date(be+1e3*oe["max-age"]).toUTCString());const we=xe.headers.get("Expires");if(!we||new Date(we).getTime()-be<42e4)return;let je=Ks(pe.url,{persistentParams:Oo});if(Se.status===206){const Ve=pe.headers.get("Range");if(!Ve)return;xe.status=200,je=Hm(je,{range:Ve})}(function(Ve,We){if(sf===void 0)try{new Response(new ReadableStream),sf=!0}catch{sf=!1}sf?We(Ve.body):Ve.blob().then(We).catch(Ze=>or(Ze.message))})(Se,Ve=>{const We=new Response((Ze=Se.status)!==200&&Ze!==404&&[101,103,204,205,304].includes(Ze)?null:Ve,xe);var Ze;Ql(),bl!=null&&bl.then(Qe=>Qe.put(je,We)).catch(Qe=>or(Qe.message))})}(w,Q,re),j=!0,g(null,he,Y.headers.get("Cache-Control"),Y.headers.get("Expires")))}).catch(he=>{N||g(new Error(he.message))})};return O?function(Y,Q){if(Ql(),bl==null)return Q(null);bl.then(re=>{let he=Ks(Y.url,{persistentParams:Oo});const pe=Y.headers.get("Range");pe&&(he=Hm(he,{range:pe})),re.match(he).then(Se=>{const be=function(oe){if(!oe)return!1;const xe=new Date(oe.headers.get("Expires")||0),we=Ti(oe.headers.get("Cache-Control")||"");return Number(xe)>Date.now()&&!we["no-cache"]}(Se);re.delete(he).catch(Q),be&&re.put(he,Se.clone()).catch(Q),Q(null,Se,be)}).catch(Q)}).catch(Q)}(w,B):B(null,null),{cancel:()=>{N=!0,j||_.abort()}}}(c,i);if(mi(self)&&self.worker.actor)return self.worker.actor.send("getResource",c,i,void 0,!0)}var o;return function(h,g){const _=new XMLHttpRequest;_.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(_.responseType="arraybuffer");for(const w in h.headers)_.setRequestHeader(w,h.headers[w]);return h.type==="json"&&(_.responseType="text",_.setRequestHeader("Accept","application/json")),_.withCredentials=h.credentials==="include",_.onerror=()=>{g(new Error(_.statusText))},_.onload=()=>{if((_.status>=200&&_.status<300||_.status===0)&&_.response!==null){let w=_.response;if(h.type==="json")try{w=JSON.parse(_.response)}catch(j){return g(j)}g(null,w,_.getResponseHeader("Cache-Control"),_.getResponseHeader("Expires"))}else g(new fp(_.statusText,_.status,h.url))},_.send(h.body),{cancel:()=>_.abort()}}(c,i)},Vu=function(c,i){return Io(Xe(c,{type:"arrayBuffer"}),i)};function pp(c){const i=document.createElement("a");return i.href=c,i.protocol===location.protocol&&i.host===location.host}const Jc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let eu,ec;eu=[],ec=0;const Wd=function(c,i){if(vx.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),ec>=Ca.MAX_PARALLEL_IMAGE_REQUESTS){const _={requestParameters:c,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return eu.push(_),_}ec++;let o=!1;const h=()=>{if(!o)for(o=!0,ec--;eu.length&&ec<Ca.MAX_PARALLEL_IMAGE_REQUESTS;){const _=eu.shift(),{requestParameters:w,callback:j,cancelled:N}=_;N||(_.cancel=Wd(w,j).cancel)}},g=Vu(c,(_,w,j,N)=>{h(),_?i(_):w&&(self.createImageBitmap?function(O,L){const B=new Blob([new Uint8Array(O)],{type:"image/png"});createImageBitmap(B).then(q=>{L(null,q)}).catch(q=>{L(new Error(`Could not load image because of ${q.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(w,(O,L)=>i(O,L,j,N)):function(O,L){const B=new Image;B.onload=()=>{L(null,B),URL.revokeObjectURL(B.src),B.onload=null,requestAnimationFrame(()=>{B.src=Jc})},B.onerror=()=>L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const q=new Blob([new Uint8Array(O)],{type:"image/png"});B.src=O.byteLength?URL.createObjectURL(q):Jc}(w,(O,L)=>i(O,L,j,N)))});return{cancel:()=>{g.cancel(),h()}}};var mp,cf,Uu,bs={exports:{}},wl={exports:{}},Zd={exports:{}},Xd=function(){if(Uu)return bs.exports;Uu=1;var c=(mp||(mp=1,wl.exports=function(o,h){var g,_,w,j,N,O,L,B;for(_=o.length-(g=3&o.length),w=h,N=3432918353,O=461845907,B=0;B<_;)L=255&o.charCodeAt(B)|(255&o.charCodeAt(++B))<<8|(255&o.charCodeAt(++B))<<16|(255&o.charCodeAt(++B))<<24,++B,w=27492+(65535&(j=5*(65535&(w=(w^=L=(65535&(L=(L=(65535&L)*N+(((L>>>16)*N&65535)<<16)&4294967295)<<15|L>>>17))*O+(((L>>>16)*O&65535)<<16)&4294967295)<<13|w>>>19))+((5*(w>>>16)&65535)<<16)&4294967295))+((58964+(j>>>16)&65535)<<16);switch(L=0,g){case 3:L^=(255&o.charCodeAt(B+2))<<16;case 2:L^=(255&o.charCodeAt(B+1))<<8;case 1:w^=L=(65535&(L=(L=(65535&(L^=255&o.charCodeAt(B)))*N+(((L>>>16)*N&65535)<<16)&4294967295)<<15|L>>>17))*O+(((L>>>16)*O&65535)<<16)&4294967295}return w^=o.length,w=2246822507*(65535&(w^=w>>>16))+((2246822507*(w>>>16)&65535)<<16)&4294967295,w=3266489909*(65535&(w^=w>>>13))+((3266489909*(w>>>16)&65535)<<16)&4294967295,(w^=w>>>16)>>>0}),wl.exports),i=(cf||(cf=1,Zd.exports=function(o,h){for(var g,_=o.length,w=h^_,j=0;_>=4;)g=1540483477*(65535&(g=255&o.charCodeAt(j)|(255&o.charCodeAt(++j))<<8|(255&o.charCodeAt(++j))<<16|(255&o.charCodeAt(++j))<<24))+((1540483477*(g>>>16)&65535)<<16),w=1540483477*(65535&w)+((1540483477*(w>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),_-=4,++j;switch(_){case 3:w^=(255&o.charCodeAt(j+2))<<16;case 2:w^=(255&o.charCodeAt(j+1))<<8;case 1:w=1540483477*(65535&(w^=255&o.charCodeAt(j)))+((1540483477*(w>>>16)&65535)<<16)}return w=1540483477*(65535&(w^=w>>>13))+((1540483477*(w>>>16)&65535)<<16),(w^=w>>>15)>>>0}),Zd.exports);return bs.exports=c,bs.exports.murmur3=c,bs.exports.murmur2=i,bs.exports}(),ko=Is(Xd);class Mc{constructor(i,...o){Xe(this,o[0]||{}),this.type=i}}class gp extends Mc{constructor(i,o={}){super("error",Xe({error:i},o))}}function Kd(c,i,o){o[c]&&o[c].indexOf(i)!==-1||(o[c]=o[c]||[],o[c].push(i))}function Yd(c,i,o){if(o&&o[c]){const h=o[c].indexOf(i);h!==-1&&o[c].splice(h,1)}}class $u{on(i,o){return this._listeners=this._listeners||{},Kd(i,o,this._listeners),this}off(i,o){return Yd(i,o,this._listeners),Yd(i,o,this._oneTimeListeners),this}once(i,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},Kd(i,o,this._oneTimeListeners),this):new Promise(h=>{this.once(i,h)})}fire(i,o){const h=typeof i=="string"?new Mc(i,o):i,g=h.type;if(this.listens(g)){h.target=this;const _=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];for(const N of _)N.call(this,h);const w=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];for(const N of w)Yd(g,N,this._oneTimeListeners),N.call(this,h);const j=this._eventedParent;j&&(Xe(h,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),j.fire(h))}else h instanceof gp&&console.error(h.error);return this}listens(i){return!!(this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i))}setEventedParent(i,o){return this._eventedParent=i,this._eventedParentData=o,this}}class Ro{constructor(i){typeof i=="string"?this.name=i:(this.name=i.name,this.iconsetId=i.iconsetId)}static from(i){return new Ro(i)}static toString(i){return i.iconsetId?`${i.name}${i.iconsetId}`:i.name}static parse(i){const[o,h]=i.split("");return new Ro({name:o,iconsetId:h})}static isEqual(i,o){return i.name===o.name&&i.iconsetId===o.iconsetId}toString(){return Ro.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var bx,Wm={},Qd=function(){if(bx)return Wm;bx=1;var c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function i(_){return(_=Math.round(_))<0?0:_>255?255:_}function o(_){return i(_[_.length-1]==="%"?parseFloat(_)/100*255:parseInt(_))}function h(_){return(w=_[_.length-1]==="%"?parseFloat(_)/100:parseFloat(_))<0?0:w>1?1:w;var w}function g(_,w,j){return j<0?j+=1:j>1&&(j-=1),6*j<1?_+(w-_)*j*6:2*j<1?w:3*j<2?_+(w-_)*(2/3-j)*6:_}try{Wm.parseCSSColor=function(_){var w,j=_.replace(/ /g,"").toLowerCase();if(j in c)return c[j].slice();if(j[0]==="#")return j.length===4?(w=parseInt(j.substr(1),16))>=0&&w<=4095?[(3840&w)>>4|(3840&w)>>8,240&w|(240&w)>>4,15&w|(15&w)<<4,1]:null:j.length===7&&(w=parseInt(j.substr(1),16))>=0&&w<=16777215?[(16711680&w)>>16,(65280&w)>>8,255&w,1]:null;var N=j.indexOf("("),O=j.indexOf(")");if(N!==-1&&O+1===j.length){var L=j.substr(0,N),B=j.substr(N+1,O-(N+1)).split(","),q=1;switch(L){case"rgba":if(B.length!==4)return null;q=h(B.pop());case"rgb":return B.length!==3?null:[o(B[0]),o(B[1]),o(B[2]),q];case"hsla":if(B.length!==4)return null;q=h(B.pop());case"hsl":if(B.length!==3)return null;var Y=(parseFloat(B[0])%360+360)%360/360,Q=h(B[1]),re=h(B[2]),he=re<=.5?re*(Q+1):re+Q-re*Q,pe=2*re-he;return[i(255*g(pe,he,Y+1/3)),i(255*g(pe,he,Y)),i(255*g(pe,he,Y-1/3)),q];default:return null}}return null}}catch{}return Wm}();class Kr{constructor(i,o,h,g=1){this.r=i,this.g=o,this.b=h,this.a=g}static parse(i){if(!i)return;if(i instanceof Kr)return i;if(typeof i!="string")return;const o=Qd.parseCSSColor(i);return o?new Kr(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3]):void 0}toStringPremultipliedAlpha(){const[i,o,h,g]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(i)},${Math.round(o)},${Math.round(h)},${g})`}toString(){const[i,o,h,g]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*i)},${Math.round(255*o)},${Math.round(255*h)},${g})`}toRenderColor(i){const{r:o,g:h,b:g,a:_}=this;return new Ry(i,o,h,g,_)}clone(){return new Kr(this.r,this.g,this.b,this.a)}}class Ry{constructor(i,o,h,g,_){if(i){const w=i.image.height,j=w*w;o=_===0?0:o/_*(w-1),h=_===0?0:h/_*(w-1),g=_===0?0:g/_*(w-1);const N=Math.floor(o),O=Math.floor(h),L=Math.floor(g),B=Math.ceil(o),q=Math.ceil(h),Y=Math.ceil(g),Q=o-N,re=h-O,he=g-L,pe=i.image.data,Se=4*(N+O*j+L*w),be=4*(N+O*j+Y*w),oe=4*(N+q*j+L*w),xe=4*(N+q*j+Y*w),we=4*(B+O*j+L*w),je=4*(B+O*j+Y*w),Ve=4*(B+q*j+L*w),We=4*(B+q*j+Y*w);if(Se<0||We>=pe.length)throw new Error("out of range");this.r=Vn(Vn(Vn(pe[Se],pe[be],he),Vn(pe[oe],pe[xe],he),re),Vn(Vn(pe[we],pe[je],he),Vn(pe[Ve],pe[We],he),re),Q)/255*_,this.g=Vn(Vn(Vn(pe[Se+1],pe[be+1],he),Vn(pe[oe+1],pe[xe+1],he),re),Vn(Vn(pe[we+1],pe[je+1],he),Vn(pe[Ve+1],pe[We+1],he),re),Q)/255*_,this.b=Vn(Vn(Vn(pe[Se+2],pe[be+2],he),Vn(pe[oe+2],pe[xe+2],he),re),Vn(Vn(pe[we+2],pe[je+2],he),Vn(pe[Ve+2],pe[We+2],he),re),Q)/255*_,this.a=_}else this.r=o,this.g=h,this.b=g,this.a=_}toArray(){const{r:i,g:o,b:h,a:g}=this;return g===0?[0,0,0,0]:[255*i/g,255*o/g,255*h/g,g]}toHslaArray(){if(this.a===0)return[0,0,0,0];const{r:i,g:o,b:h,a:g}=this,_=Math.min(Math.max(i/g,0),1),w=Math.min(Math.max(o/g,0),1),j=Math.min(Math.max(h/g,0),1),N=Math.min(_,w,j),O=Math.max(_,w,j),L=(N+O)/2;if(N===O)return[0,0,100*L,g];const B=O-N,q=L>.5?B/(2-O-N):B/(O+N);let Y=0;return O===_?Y=(w-j)/B+(w<j?6:0):O===w?Y=(j-_)/B+2:O===j&&(Y=(_-w)/B+4),Y*=60,[Math.min(Math.max(Y,0),360),Math.min(Math.max(100*q,0),100),Math.min(Math.max(100*L,0),100),g]}toArray01(){const{r:i,g:o,b:h,a:g}=this;return g===0?[0,0,0,0]:[i/g,o/g,h/g,g]}toArray01Scaled(i){const{r:o,g:h,b:g,a:_}=this;return _===0?[0,0,0]:[o/_*i,h/_*i,g/_*i]}toArray01PremultipliedAlpha(){const{r:i,g:o,b:h,a:g}=this;return[i,o,h,g]}toArray01Linear(){const{r:i,g:o,b:h,a:g}=this;return g===0?[0,0,0,0]:[Math.pow(i/g,2.2),Math.pow(o/g,2.2),Math.pow(h/g,2.2),g]}}function Vn(c,i,o){return c*(1-o)+i*o}function zy(c,i,o){return c.map((h,g)=>Vn(h,i[g],o))}function Zm(c){return c*c*c*c*c}Kr.black=new Kr(0,0,0,1),Kr.white=new Kr(1,1,1,1),Kr.transparent=new Kr(0,0,0,0),Kr.red=new Kr(1,0,0,1),Kr.blue=new Kr(0,0,1,1);var xp=Object.freeze({__proto__:null,array:zy,color:function(c,i,o){return new Kr(Vn(c.r,i.r,o),Vn(c.g,i.g,o),Vn(c.b,i.b,o),Vn(c.a,i.a,o))},easeIn:Zm,number:Vn});function yp(c,...i){for(const o of i)for(const h in o)c[h]=o[h];return c}class Sl extends Error{constructor(i,o){super(o),this.message=o,this.key=i}}class Jd{constructor(i,o=[]){this.parent=i,this.bindings={};for(const[h,g]of o)this.bindings[h]=g}concat(i){return new Jd(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const qu={kind:"null"},kn={kind:"number"},vi={kind:"string"},ai={kind:"boolean"},go={kind:"color"},tu={kind:"object"},ii={kind:"value"},eh={kind:"collator"},vp={kind:"formatted"},_p={kind:"resolvedImage"};function Qs(c,i){return{kind:"array",itemType:c,N:i}}function ka(c){if(c.kind==="array"){const i=ka(c.itemType);return typeof c.N=="number"?`array<${i}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${i}>`}return c.kind}const B_=[qu,kn,vi,ai,go,vp,tu,Qs(ii),_p];function bp(c,i){if(i.kind==="error")return null;if(c.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!bp(c.itemType,i.itemType))&&(typeof c.N!="number"||c.N===i.N))return null}else{if(c.kind===i.kind)return null;if(c.kind==="value"){for(const o of B_)if(!bp(o,i))return null}}return`Expected ${ka(c)} but found ${ka(i)} instead.`}function wx(c,i){return i.some(o=>o.kind===c.kind)}function Hu(c,i){return i.some(o=>o==="null"?c===null:o==="array"?Array.isArray(c):o==="object"?c&&!Array.isArray(c)&&typeof c=="object":o===typeof c)}class Tl{constructor(i,o,h){this.sensitivity=i?o?"variant":"case":o?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,o){return this.collator.compare(i,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Xm{constructor(i,o,h,g,_){this.text=i.normalize?i.normalize():i,this.image=o,this.scale=h,this.fontStack=g,this.textColor=_}}class Rs{constructor(i){this.sections=i}static fromString(i){return new Rs([new Xm(i,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||!!i.image&&i.image.hasPrimary())}static factory(i){return i instanceof Rs?i:Rs.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}serialize(){const i=["format"];for(const o of this.sections){if(o.image){const g=o.image.getPrimary().id.toString();i.push(["image",g]);continue}i.push(o.text);const h={};o.fontStack&&(h["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(h["font-scale"]=o.scale),o.textColor&&(h["text-color"]=["rgba"].concat(o.textColor.toRenderColor(null).toArray())),i.push(h)}return i}}class El{constructor(i,o={}){if(this.id=Ro.from(i),this.options=Object.assign({},o),o.transform){const{a:h,b:g,c:_,d:w,e:j,f:N}=o.transform;this.options.transform=new DOMMatrix([h,g,_,w,j,N])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:i,b:o,c:h,d:g,e:_,f:w}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:i,b:o,c:h,d:g,e:_,f:w}})}static parse(i){let o,h,g,_;try{({name:o,iconsetId:h,params:g,transform:_}=JSON.parse(i)||{})}catch{return null}if(!o)return null;const{a:w,b:j,c:N,d:O,e:L,f:B}=_||{};return new El({name:o,iconsetId:h},{params:g,transform:new DOMMatrix([w,j,N,O,L,B])})}scaleSelf(i,o){return this.options.transform.scaleSelf(i,o),this}}class Js{constructor(i,o,h,g,_=!1){this.primaryId=Ro.from(i),this.primaryOptions=o,h&&(this.secondaryId=Ro.from(h)),this.secondaryOptions=g,this.available=_}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new El(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new El(this.secondaryId,this.secondaryOptions):null}static from(i){return typeof i=="string"?Js.build({name:i}):i}static build(i,o,h,g){return!i||typeof i=="object"&&!("name"in i)?null:new Js(i,h,o,g)}}function Sx(c,i,o,h){return typeof c=="number"&&c>=0&&c<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof o=="number"&&o>=0&&o<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[c,i,o,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[c,i,o,h]:[c,i,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function th(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof Kr||c instanceof Tl||c instanceof Rs||c instanceof Js)return!0;if(Array.isArray(c)){for(const i of c)if(!th(i))return!1;return!0}if(typeof c=="object"){for(const i in c)if(!th(c[i]))return!1;return!0}return!1}function pa(c){if(c===null)return qu;if(typeof c=="string")return vi;if(typeof c=="boolean")return ai;if(typeof c=="number")return kn;if(c instanceof Kr)return go;if(c instanceof Tl)return eh;if(c instanceof Rs)return vp;if(c instanceof Js)return _p;if(Array.isArray(c)){const i=c.length;let o;for(const h of c){const g=pa(h);if(o){if(o===g)continue;o=ii;break}o=g}return Qs(o||ii,i)}return tu}function eo(c){const i=typeof c;return c===null?"":i==="string"||i==="number"||i==="boolean"?String(c):c instanceof Kr?c.toStringPremultipliedAlpha():c instanceof Rs||c instanceof Js?c.toString():JSON.stringify(c)}class pr{constructor(i,o){this.type=i,this.value=o}static parse(i,o){if(i.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!th(i[1]))return o.error("invalid value");const h=i[1];let g=pa(h);const _=o.expectedType;return g.kind!=="array"||g.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(g=_),new pr(g,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Kr?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Rs?this.value.serialize():this.value}}class _n{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}}const uf={string:vi,number:kn,boolean:ai,object:tu};class Kn{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");let h,g=1;const _=i[0];if(_==="array"){let j,N;if(i.length>2){const O=i[1];if(typeof O!="string"||!(O in uf)||O==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);j=uf[O],g++}else j=ii;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return o.error('The length argument to "array" must be a positive integer literal',2);N=i[2],g++}h=Qs(j,N)}else h=uf[_];const w=[];for(;g<i.length;g++){const j=o.parse(i[g],g,ii);if(!j)return null;w.push(j)}return new Kn(h,w)}evaluate(i){for(let o=0;o<this.args.length;o++){const h=this.args[o].evaluate(i);if(!bp(this.type,pa(h)))return h;if(o===this.args.length-1)throw new _n(`The expression ${JSON.stringify(this.args[o].serialize())} evaluated to ${ka(pa(h))} but was expected to be of type ${ka(this.type)}.`)}return null}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=this.type,o=[i.kind];if(i.kind==="array"){const h=i.itemType;if(h.kind==="string"||h.kind==="number"||h.kind==="boolean"){o.push(h.kind);const g=i.N;(typeof g=="number"||this.args.length>1)&&o.push(g)}}return o.concat(this.args.map(h=>h.serialize()))}}class tc{constructor(i){this.type=vp,this.sections=i}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");const h=i[1];if(!Array.isArray(h)&&typeof h=="object")return o.error("First argument must be an image or text section.");const g=[];let _=!1;for(let w=1;w<=i.length-1;++w){const j=i[w];if(_&&typeof j=="object"&&!Array.isArray(j)){_=!1;let N=null;if(j["font-scale"]&&(N=o.parseObjectValue(j["font-scale"],w,"font-scale",kn),!N))return null;let O=null;if(j["text-font"]&&(O=o.parseObjectValue(j["text-font"],w,"text-font",Qs(vi)),!O))return null;let L=null;if(j["text-color"]&&(L=o.parseObjectValue(j["text-color"],w,"text-color",go),!L))return null;const B=g[g.length-1];B.scale=N,B.font=O,B.textColor=L}else{const N=o.parse(i[w],w,ii);if(!N)return null;const O=N.type.kind;if(O!=="string"&&O!=="value"&&O!=="null"&&O!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,g.push({content:N,scale:null,font:null,textColor:null})}}return new tc(g)}evaluate(i){return new Rs(this.sections.map(o=>{const h=o.content.evaluate(i);return pa(h)===_p?new Xm("",h,null,null,null):new Xm(eo(h),null,o.scale?o.scale.evaluate(i):null,o.font?o.font.evaluate(i).join(","):null,o.textColor?o.textColor.evaluate(i):null)}))}eachChild(i){for(const o of this.sections)i(o.content),o.scale&&i(o.scale),o.font&&i(o.font),o.textColor&&i(o.textColor)}outputDefined(){return!1}serialize(){const i=["format"];for(const o of this.sections){i.push(o.content.serialize());const h={};o.scale&&(h["font-scale"]=o.scale.serialize()),o.font&&(h["text-font"]=o.font.serialize()),o.textColor&&(h["text-color"]=o.textColor.serialize()),i.push(h)}return i}}class Pc{constructor(i,o,h,g){this._imageWarnHistory={},this.type=_p,this.namePrimary=i,this.nameSecondary=o,h&&(this.paramsPrimary=h.params,this.iconsetIdPrimary=h.iconset?h.iconset.id:void 0),g&&(this.paramsSecondary=g.params,this.iconsetIdSecondary=g.iconset?g.iconset.id:void 0)}static parse(i,o){if(i.length<2)return o.error("Expected two or more arguments.");let h=1;const g=[];function _(){if(h<i.length){const j=o.parse(i[h],h++,vi);return j?(g.push({image:j,options:{}}),!0):(o.error(g.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function w(){if(h<i.length){const N=i[h];if((j=N)===null||typeof j!="object"||Array.isArray(j))return!0;const O=N.params,L=N.iconset,B=o.concat(h);if(!O&&!L)return h++,!0;if(O){if(typeof O!="object"||O.constructor!==Object)return B.error('Image options "params" should be an object'),!1;const q={},Y=B.concat(void 0,"params");for(const Q in O){if(!Q)return Y.error("Image parameter name should be non-empty"),!1;const re=Y.concat(void 0,Q).parse(O[Q],void 0,go,void 0,{typeAnnotation:"coerce"});if(!re)return!1;q[Q]=re}g[g.length-1].options.params=q}if(L){if(typeof L!="object"||L.constructor!==Object)return B.error('Image options "iconset" should be an object'),!1;if(!L.id)return B.error('Image options "iconset" should have an "id" property'),!1;g[g.length-1].options.iconset=L}return h++,!0}var j;return!0}for(let j=0;j<2;j++)if(!_()||!w())return;return new Pc(g[0].image,g[1]?g[1].image:void 0,g[0].options,g[1]?g[1].options:void 0)}evaluateParams(i,o){const h={};if(o){for(const g in o)if(o[g])try{h[g]=o[g].evaluate(i)}catch{continue}if(Object.keys(h).length!==0)return{params:h}}}evaluate(i){const o={name:this.namePrimary.evaluate(i),iconsetId:this.iconsetIdPrimary},h=this.nameSecondary?{name:this.nameSecondary.evaluate(i),iconsetId:this.iconsetIdSecondary}:void 0,g=Js.build(o,h,this.paramsPrimary?this.evaluateParams(i,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(i,this.paramsSecondary):void 0);if(g&&i.availableImages){const _=g.getPrimary().id;if(g.available=i.availableImages.some(w=>Ro.isEqual(w,_)),g.available){const w=g.getSecondary()?g.getSecondary().id:null;w&&(g.available=i.availableImages.some(j=>Ro.isEqual(j,w)))}}return g}eachChild(i){if(i(this.namePrimary),this.paramsPrimary)for(const o in this.paramsPrimary)this.paramsPrimary[o]&&i(this.paramsPrimary[o]);if(this.nameSecondary&&(i(this.nameSecondary),this.paramsSecondary))for(const o in this.paramsSecondary)this.paramsSecondary[o]&&i(this.paramsSecondary[o])}outputDefined(){return!1}serializeOptions(i,o){const h={};if(o&&(h.iconset={id:o}),i){h.params={};for(const g in i)i[g]&&(h.params[g]=i[g].serialize())}return Object.keys(h).length>0?h:void 0}serialize(){const i=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const o=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);o&&i.push(o)}if(this.nameSecondary&&(i.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const o=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);o&&i.push(o)}return i}}function Jn(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}const wp={"to-boolean":ai,"to-color":go,"to-number":kn,"to-string":vi};class Al{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");const h=i[0],g=[];let _=qu;if(h==="to-array"){if(!Array.isArray(i[1]))return null;const w=i[1].length;if(o.expectedType){if(o.expectedType.kind!=="array")return o.error(`Expected ${o.expectedType.kind} but found array.`);_=Qs(o.expectedType.itemType,w)}else{if(!(w>0&&th(i[1][0])))return null;_=Qs(pa(i[1][0]),w)}for(let j=0;j<w;j++){const N=i[1][j];let O;if(Jn(N)==="array")O=o.parse(N,void 0,_.itemType);else{const L=Jn(N);if(L!==_.itemType.kind)return o.error(`Expected ${_.itemType.kind} but found ${L}.`);O=o.registry.literal.parse(["literal",N===void 0?null:N],o)}if(!O)return null;g.push(O)}}else{if((h==="to-boolean"||h==="to-string")&&i.length!==2)return o.error("Expected one argument.");_=wp[h];for(let w=1;w<i.length;w++){const j=o.parse(i[w],w,ii);if(!j)return null;g.push(j)}}return new Al(_,g)}evaluate(i){if(this.type.kind==="boolean")return!!this.args[0].evaluate(i);if(this.type.kind==="color"){let o,h;for(const g of this.args){if(o=g.evaluate(i),h=null,o instanceof Kr)return o;if(typeof o=="string"){const _=i.parseColor(o);if(_)return _}else if(Array.isArray(o)&&(h=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:Sx(o[0],o[1],o[2],o[3]),!h))return new Kr(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new _n(h||`Could not parse color from value '${typeof o=="string"?o:String(JSON.stringify(o))}'`)}if(this.type.kind==="number"){let o=null;for(const h of this.args){if(o=h.evaluate(i),o===null)return 0;const g=Number(o);if(!isNaN(g))return g}throw new _n(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?Rs.fromString(eo(this.args[0].evaluate(i))):this.type.kind==="resolvedImage"?Js.build(eo(this.args[0].evaluate(i))):this.type.kind==="array"?this.args.map(o=>o.evaluate(i)):eo(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){if(this.type.kind==="formatted")return new tc([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Pc(this.args[0]).serialize();const i=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(o=>{i.push(o.serialize())}),i}}const Tx=["Unknown","Point","LineString","Polygon"];class df{constructor(i,o){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=i,this.options=o}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Tx[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(i){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const i=this.featureDistanceData.center,o=this.featureDistanceData.scale,{x:h,y:g}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(h*o-i[0])+this.featureDistanceData.bearing[1]*(g*o-i[1])}return 0}parseColor(i){let o=this._parseColorCache[i];return o||(o=this._parseColorCache[i]=Kr.parse(i)),o}getConfig(i){return this.options?this.options.get(i):null}}class ds{constructor(i,o,h,g,_){this.name=i,this.type=o,this._evaluate=h,this.args=g,this._overloadIndex=_}evaluate(i){if(!this._evaluate){const o=ds.definitions[this.name];this._evaluate=Array.isArray(o)?o[2]:o.overloads[this._overloadIndex][1]}return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(i=>i.serialize()))}static parse(i,o){const h=i[0],g=ds.definitions[h];if(!g)return o.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(g)?g[0]:g.type,w=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,j=[];let N=null,O=-1;for(const[L,B]of w){if(Array.isArray(L)&&L.length!==i.length-1)continue;j.push(L),O++,N=new oc(o.registry,o.path,null,o.scope,void 0,o._scope,o.options);const q=[];let Y=!1;for(let Q=1;Q<i.length;Q++){const re=i[Q],he=Array.isArray(L)?L[Q-1]:L.type,pe=N.parse(re,1+q.length,he);if(!pe){Y=!0;break}q.push(pe)}if(!Y)if(Array.isArray(L)&&L.length!==q.length)N.error(`Expected ${L.length} arguments, but found ${q.length} instead.`);else{for(let Q=0;Q<q.length;Q++){const re=Array.isArray(L)?L[Q]:L.type,he=q[Q];N.concat(Q+1).checkSubtype(re,he.type)}if(N.errors.length===0)return new ds(h,_,B,q,O)}}if(j.length===1)o.errors.push(...N.errors);else{const L=(j.length?j:w.map(([q])=>q)).map(zs).join(" | "),B=[];for(let q=1;q<i.length;q++){const Y=o.parse(i[q],1+B.length);if(!Y)return null;B.push(ka(Y.type))}o.error(`Expected arguments of type ${L}, but found (${B.join(", ")}) instead.`)}return null}static register(i,o){ds.definitions=o;for(const h in o)i[h]=ds}}function zs(c){return Array.isArray(c)?`(${c.map(ka).join(", ")})`:`(${ka(c.type)}...)`}class nh{constructor(i,o,h){this.type=eh,this.locale=h,this.caseSensitive=i,this.diacriticSensitive=o}static parse(i,o){if(i.length!==2)return o.error("Expected one argument.");const h=i[1];if(typeof h!="object"||Array.isArray(h))return o.error("Collator options argument must be an object.");const g=h["case-sensitive"]===void 0?o.parse(!1,1,ai):o.parseObjectValue(h["case-sensitive"],1,"case-sensitive",ai);if(!g)return null;const _=h["diacritic-sensitive"]===void 0?o.parse(!1,1,ai):o.parseObjectValue(h["diacritic-sensitive"],1,"diacritic-sensitive",ai);if(!_)return null;let w=null;return h.locale&&(w=o.parseObjectValue(h.locale,1,"locale",vi),!w)?null:new nh(g,_,w)}evaluate(i){return new Tl(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}serialize(){const i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]}}function nu(c,i,o=0,h=c.length-1,g=ih){for(;h>o;){if(h-o>600){const N=h-o+1,O=i-o+1,L=Math.log(N),B=.5*Math.exp(2*L/3),q=.5*Math.sqrt(L*B*(N-B)/N)*(O-N/2<0?-1:1);nu(c,i,Math.max(o,Math.floor(i-O*B/N+q)),Math.min(h,Math.floor(i+(N-O)*B/N+q)),g)}const _=c[i];let w=o,j=h;for(rh(c,o,i),g(c[h],_)>0&&rh(c,o,h);w<j;){for(rh(c,w,j),w++,j--;g(c[w],_)<0;)w++;for(;g(c[j],_)>0;)j--}g(c[o],_)===0?rh(c,o,j):(j++,rh(c,j,h)),j<=i&&(o=j+1),i<=j&&(h=j-1)}}function rh(c,i,o){const h=c[i];c[i]=c[o],c[o]=h}function ih(c,i){return c<i?-1:c>i?1:0}function to(c){let i=0;for(let o,h,g=0,_=c.length,w=_-1;g<_;w=g++)o=c[g],h=c[w],i+=(h.x-o.x)*(o.y+h.y);return i}function Sp(c,i){c[0]=Math.min(c[0],i[0]),c[1]=Math.min(c[1],i[1]),c[2]=Math.max(c[2],i[0]),c[3]=Math.max(c[3],i[1])}function Tp(c,i){return!(c[0]<=i[0]||c[2]>=i[2]||c[1]<=i[1]||c[3]>=i[3])}function nl(c,i,o){const h=c[0]-i[0],g=c[1]-i[1],_=c[0]-o[0],w=c[1]-o[1];return h*w-_*g==0&&h*_<=0&&g*w<=0}function rl(c,i,o=!1){let h=!1;for(let j=0,N=i.length;j<N;j++){const O=i[j];for(let L=0,B=O.length,q=B-1;L<B;q=L++){const Y=O[q],Q=O[L];if(nl(c,Y,Q))return o;(_=Y)[1]>(g=c)[1]!=(w=Q)[1]>g[1]&&g[0]<(w[0]-_[0])*(g[1]-_[1])/(w[1]-_[1])+_[0]&&(h=!h)}}var g,_,w;return h}function Km(c,i,o,h){const g=h[0]-o[0],_=h[1]-o[1],w=(c[0]-o[0])*_-g*(c[1]-o[1]),j=(i[0]-o[0])*_-g*(i[1]-o[1]);return w>0&&j<0||w<0&&j>0}function nc(c,i,o,h){return(g=[h[0]-o[0],h[1]-o[1]])[0]*(_=[i[0]-c[0],i[1]-c[1]])[1]-g[1]*_[0]!=0&&!(!Km(c,i,o,h)||!Km(o,h,c,i));var g,_}function Ym(c){const i=new Kt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),o=new Kt(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const h of c[0])i.x>h.x&&(i.x=h.x),i.y>h.y&&(i.y=h.y),o.x<h.x&&(o.x=h.x),o.y<h.y&&(o.y=h.y);return{min:i,max:o}}const ru=8192;function Ex(c,i){const o=(180+c[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,g=Math.pow(2,i.z);return[Math.round(o*g*ru),Math.round(h*g*ru)]}function V_(c,i){for(let o=0;o<i.length;o++)if(rl(c,i[o]))return!0;return!1}function ah(c,i,o){for(const h of o)for(let g=0,_=h.length,w=_-1;g<_;w=g++)if(nc(c,i,h[w],h[g]))return!0;return!1}function Qm(c,i){for(let o=0;o<c.length;++o)if(!rl(c[o],i))return!1;for(let o=0;o<c.length-1;++o)if(ah(c[o],c[o+1],i))return!1;return!0}function Ep(c,i){for(let o=0;o<i.length;o++)if(Qm(c,i[o]))return!0;return!1}function hf(c,i,o){const h=[];for(let g=0;g<c.length;g++){const _=[];for(let w=0;w<c[g].length;w++){const j=Ex(c[g][w],o);Sp(i,j),_.push(j)}h.push(_)}return h}function Ax(c,i,o){const h=[];for(let g=0;g<c.length;g++){const _=hf(c[g],i,o);h.push(_)}return h}function zo(c,i,o,h){if(c[0]<o[0]||c[0]>o[2]){const g=.5*h;let _=c[0]-o[0]>g?-h:o[0]-c[0]>g?h:0;_===0&&(_=c[0]-o[2]>g?-h:o[2]-c[0]>g?h:0),c[0]+=_}Sp(i,c)}function sh(c,i,o,h){const g=Math.pow(2,h.z)*ru,_=[h.x*ru,h.y*ru],w=[];if(!c)return w;for(const j of c)for(const N of j){const O=[N.x+_[0],N.y+_[1]];zo(O,i,o,g),w.push(O)}return w}function Jm(c,i,o,h){const g=Math.pow(2,h.z)*ru,_=[h.x*ru,h.y*ru],w=[];if(!c)return w;for(const N of c){const O=[];for(const L of N){const B=[L.x+_[0],L.y+_[1]];Sp(i,B),O.push(B)}w.push(O)}if(i[2]-i[0]<=g/2){(j=i)[0]=j[1]=1/0,j[2]=j[3]=-1/0;for(const N of w)for(const O of N)zo(O,i,o,g)}var j;return w}class Nc{constructor(i,o){this.type=ai,this.geojson=i,this.geometries=o}static parse(i,o){if(i.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(th(i[1])){const h=i[1];if(h.type==="FeatureCollection")for(let g=0;g<h.features.length;++g){const _=h.features[g].geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new Nc(h,h.features[g].geometry)}else if(h.type==="Feature"){const g=h.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Nc(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new Nc(h,h)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(o,h){const g=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],w=o.canonicalID();if(!w)return!1;if(h.type==="Polygon"){const j=hf(h.coordinates,_,w),N=sh(o.geometry(),g,_,w);if(!Tp(g,_))return!1;for(const O of N)if(!rl(O,j))return!1}if(h.type==="MultiPolygon"){const j=Ax(h.coordinates,_,w),N=sh(o.geometry(),g,_,w);if(!Tp(g,_))return!1;for(const O of N)if(!V_(O,j))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(o,h){const g=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],w=o.canonicalID();if(!w)return!1;if(h.type==="Polygon"){const j=hf(h.coordinates,_,w),N=Jm(o.geometry(),g,_,w);if(!Tp(g,_))return!1;for(const O of N)if(!Qm(O,j))return!1}if(h.type==="MultiPolygon"){const j=Ax(h.coordinates,_,w),N=Jm(o.geometry(),g,_,w);if(!Tp(g,_))return!1;for(const O of N)if(!Ep(O,j))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const rc={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},eg=1/298.257223563,il=eg*(2-eg),oh=Math.PI/180;class ff{static fromTile(i,o,h){const g=Math.PI*(1-2*(i+.5)/Math.pow(2,o)),_=Math.atan(.5*(Math.exp(g)-Math.exp(-g)))/oh;return new ff(_,h)}static get units(){return rc}constructor(i,o){if(i===void 0)throw new Error("No latitude given.");if(o&&!rc[o])throw new Error(`Unknown unit ${o}. Use one of: ${Object.keys(rc).join(", ")}`);const h=6378.137*oh*(o?rc[o]:1),g=Math.cos(i*oh),_=1/(1-il*(1-g*g)),w=Math.sqrt(_);this.kx=h*w*g,this.ky=h*w*_*(1-il)}distance(i,o){const h=Lo(i[0]-o[0])*this.kx,g=(i[1]-o[1])*this.ky;return Math.sqrt(h*h+g*g)}bearing(i,o){const h=Lo(o[0]-i[0])*this.kx;return Math.atan2(h,(o[1]-i[1])*this.ky)/oh}destination(i,o,h){const g=h*oh;return this.offset(i,Math.sin(g)*o,Math.cos(g)*o)}offset(i,o,h){return[i[0]+o/this.kx,i[1]+h/this.ky]}lineDistance(i){let o=0;for(let h=0;h<i.length-1;h++)o+=this.distance(i[h],i[h+1]);return o}area(i){let o=0;for(let h=0;h<i.length;h++){const g=i[h];for(let _=0,w=g.length,j=w-1;_<w;j=_++)o+=Lo(g[_][0]-g[j][0])*(g[_][1]+g[j][1])*(h?-1:1)}return Math.abs(o)/2*this.kx*this.ky}along(i,o){let h=0;if(o<=0)return i[0];for(let g=0;g<i.length-1;g++){const _=i[g],w=i[g+1],j=this.distance(_,w);if(h+=j,h>o)return tg(_,w,(o-(h-j))/j)}return i[i.length-1]}pointToSegmentDistance(i,o,h){let[g,_]=o,w=Lo(h[0]-g)*this.kx,j=(h[1]-_)*this.ky;if(w!==0||j!==0){const N=(Lo(i[0]-g)*this.kx*w+(i[1]-_)*this.ky*j)/(w*w+j*j);N>1?(g=h[0],_=h[1]):N>0&&(g+=w/this.kx*N,_+=j/this.ky*N)}return w=Lo(i[0]-g)*this.kx,j=(i[1]-_)*this.ky,Math.sqrt(w*w+j*j)}pointOnLine(i,o){let h=1/0,g=i[0][0],_=i[0][1],w=0,j=0;for(let N=0;N<i.length-1;N++){let O=i[N][0],L=i[N][1],B=Lo(i[N+1][0]-O)*this.kx,q=(i[N+1][1]-L)*this.ky,Y=0;B===0&&q===0||(Y=(Lo(o[0]-O)*this.kx*B+(o[1]-L)*this.ky*q)/(B*B+q*q),Y>1?(O=i[N+1][0],L=i[N+1][1]):Y>0&&(O+=B/this.kx*Y,L+=q/this.ky*Y)),B=Lo(o[0]-O)*this.kx,q=(o[1]-L)*this.ky;const Q=B*B+q*q;Q<h&&(h=Q,g=O,_=L,w=N,j=Y)}return{point:[g,_],index:w,t:Math.max(0,Math.min(1,j))}}lineSlice(i,o,h){let g=this.pointOnLine(h,i),_=this.pointOnLine(h,o);if(g.index>_.index||g.index===_.index&&g.t>_.t){const O=g;g=_,_=O}const w=[g.point],j=g.index+1,N=_.index;!Cx(h[j],w[0])&&j<=N&&w.push(h[j]);for(let O=j+1;O<=N;O++)w.push(h[O]);return Cx(h[N],_.point)||w.push(_.point),w}lineSliceAlong(i,o,h){let g=0;const _=[];for(let w=0;w<h.length-1;w++){const j=h[w],N=h[w+1],O=this.distance(j,N);if(g+=O,g>i&&_.length===0&&_.push(tg(j,N,(i-(g-O))/O)),g>=o)return _.push(tg(j,N,(o-(g-O))/O)),_;g>i&&_.push(N)}return _}bufferPoint(i,o){const h=o/this.ky,g=o/this.kx;return[i[0]-g,i[1]-h,i[0]+g,i[1]+h]}bufferBBox(i,o){const h=o/this.ky,g=o/this.kx;return[i[0]-g,i[1]-h,i[2]+g,i[3]+h]}insideBBox(i,o){return Lo(i[0]-o[0])>=0&&Lo(i[0]-o[2])<=0&&i[1]>=o[1]&&i[1]<=o[3]}}function Cx(c,i){return c[0]===i[0]&&c[1]===i[1]}function tg(c,i,o){const h=Lo(i[0]-c[0]);return[c[0]+h*o,c[1]+(i[1]-c[1])*o]}function Lo(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}class Ap{constructor(i=[],o=(h,g)=>h<g?-1:h>g?1:0){if(this.data=i,this.length=this.data.length,this.compare=o,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:o,compare:h}=this,g=o[i];for(;i>0;){const _=i-1>>1,w=o[_];if(h(g,w)>=0)break;o[i]=w,i=_}o[i]=g}_down(i){const{data:o,compare:h}=this,g=this.length>>1,_=o[i];for(;i<g;){let w=1+(i<<1);const j=w+1;if(j<this.length&&h(o[j],o[w])<0&&(w=j),h(o[w],_)>=0)break;o[i]=o[w],i=w}o[i]=_}}var en=8192;function al(c,i){return i.dist-c.dist}const Cp=100,xo=50;function Fo(c){const i=[1/0,1/0,-1/0,-1/0];if(i.length!==c.length)return!1;for(let o=0;o<i.length;o++)if(i[o]!==c[o])return!1;return!0}function Cl(c){return c[1]-c[0]+1}function Bo(c,i){const o=c[1]>=c[0]&&c[1]<i;return o||console.warn("Distance Expression: Index is out of range"),o}function iu(c,i){if(c[0]>c[1])return[null,null];const o=Cl(c);if(i){if(o===2)return[c,null];const h=Math.floor(o/2);return[[c[0],c[0]+h],[c[0]+h,c[1]]]}{if(o===1)return[c,null];const h=Math.floor(o/2)-1;return[[c[0],c[0]+h],[c[0]+h+1,c[1]]]}}function ic(c,i){const o=[1/0,1/0,-1/0,-1/0];if(!Bo(i,c.length))return o;for(let h=i[0];h<=i[1];++h)Sp(o,c[h]);return o}function lh(c){const i=[1/0,1/0,-1/0,-1/0];for(let o=0;o<c.length;++o)for(let h=0;h<c[o].length;++h)Sp(i,c[o][h]);return i}function jl(c,i,o){if(Fo(c)||Fo(i))return NaN;let h=0,g=0;return c[2]<i[0]&&(h=i[0]-c[2]),c[0]>i[2]&&(h=c[0]-i[2]),c[1]>i[3]&&(g=c[1]-i[3]),c[3]<i[1]&&(g=i[1]-c[3]),o.distance([0,0],[h,g])}function ch(c){return 360*c-180}function jr(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function Gu(c,i){const o=Math.pow(2,i.z),h=(c.y/en+i.y)/o;return[ch((c.x/en+i.x)/o),jr(h)]}function U_(c,i){const o=[];for(let h=0;h<c.length;++h)o.push(Gu(c[h],i));return o}function Vo(c,i,o){const h=o.pointOnLine(i,c).point;return o.distance(c,h)}function jp(c,i,o,h,g){const _=o.slice(h[0],h[1]+1);let w=1/0;for(let j=i[0];j<=i[1];++j)if((w=Math.min(w,Vo(c[j],_,g)))===0)return 0;return w}function ac(c,i,o,h,g){const _=Math.min(g.pointToSegmentDistance(c,o,h),g.pointToSegmentDistance(i,o,h)),w=Math.min(g.pointToSegmentDistance(o,c,i),g.pointToSegmentDistance(h,c,i));return Math.min(_,w)}function Ki(c,i,o,h,g){if(!Bo(i,c.length)||!Bo(h,o.length))return NaN;let _=1/0;for(let w=i[0];w<i[1];++w)for(let j=h[0];j<h[1];++j){if(nc(c[w],c[w+1],o[j],o[j+1]))return 0;_=Math.min(_,ac(c[w],c[w+1],o[j],o[j+1],g))}return _}function ng(c,i,o,h,g){if(!Bo(i,c.length)||!Bo(h,o.length))return NaN;let _=1/0;for(let w=i[0];w<=i[1];++w)for(let j=h[0];j<=h[1];++j)if((_=Math.min(_,g.distance(c[w],o[j])))===0)return _;return _}function uh(c,i,o){if(rl(c,i,!0))return 0;let h=1/0;for(const g of i){const _=g.length;if(_<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(g[0]!==g[_-1]&&(h=Math.min(h,o.pointToSegmentDistance(c,g[_-1],g[0])))===0||(h=Math.min(h,Vo(c,g,o)))===0)return h}return h}function jx(c,i,o,h){if(!Bo(i,c.length))return NaN;for(let _=i[0];_<=i[1];++_)if(rl(c[_],o,!0))return 0;let g=1/0;for(let _=i[0];_<i[1];++_)for(const w of o)for(let j=0,N=w.length,O=N-1;j<N;O=j++){if(nc(c[_],c[_+1],w[O],w[j]))return 0;g=Math.min(g,ac(c[_],c[_+1],w[O],w[j],h))}return g}function rg(c,i){for(const o of c)for(let h=0;h<=o.length-1;++h)if(rl(o[h],i,!0))return!0;return!1}function pf(c,i,o,h=1/0){const g=lh(c),_=lh(i);if(h!==1/0&&jl(g,_,o)>=h)return h;if(Tp(g,_)){if(rg(c,i))return 0}else if(rg(i,c))return 0;let w=h;for(const j of c)for(let N=0,O=j.length,L=O-1;N<O;L=N++)for(const B of i)for(let q=0,Y=B.length,Q=Y-1;q<Y;Q=q++){if(nc(j[L],j[N],B[Q],B[q]))return 0;w=Math.min(w,ac(j[L],j[N],B[Q],B[q],o))}return w}function au(c,i,o,h,g,_,w){if(_===null||w===null)return;const j=jl(ic(h,_),ic(g,w),o);j<i&&c.push({dist:j,range1:_,range2:w})}function ig(c,i,o,h,g=1/0){let _=Math.min(h.distance(c[0],o[0][0]),g);if(_===0)return _;const w=new Ap([{dist:0,range1:[0,c.length-1],range2:[0,0]}],al),j=i?xo:Cp,N=lh(o);for(;w.length;){const O=w.pop();if(O.dist>=_)continue;const L=O.range1;if(Cl(L)<=j){if(!Bo(L,c.length))return NaN;if(i){const B=jx(c,L,o,h);if((_=Math.min(_,B))===0)return _}else for(let B=L[0];B<=L[1];++B){const q=uh(c[B],o,h);if((_=Math.min(_,q))===0)return _}}else{const B=iu(L,i);if(B[0]!==null){const q=jl(ic(c,B[0]),N,h);q<_&&w.push({dist:q,range1:B[0],range2:[0,0]})}if(B[1]!==null){const q=jl(ic(c,B[1]),N,h);q<_&&w.push({dist:q,range1:B[1],range2:[0,0]})}}}return _}function Mp(c,i,o,h,g,_=1/0){let w=Math.min(_,g.distance(c[0],o[0]));if(w===0)return w;const j=new Ap([{dist:0,range1:[0,c.length-1],range2:[0,o.length-1]}],al),N=i?xo:Cp,O=h?xo:Cp;for(;j.length;){const L=j.pop();if(L.dist>=w)continue;const B=L.range1,q=L.range2;if(Cl(B)<=N&&Cl(q)<=O){if(!Bo(B,c.length)||!Bo(q,o.length))return NaN;if(i&&h?w=Math.min(w,Ki(c,B,o,q,g)):i||h?i&&!h?w=Math.min(w,jp(o,q,c,B,g)):!i&&h&&(w=Math.min(w,jp(c,B,o,q,g))):w=Math.min(w,ng(c,B,o,q,g)),w===0)return w}else{const Y=iu(B,i),Q=iu(q,h);au(j,w,g,c,o,Y[0],Q[0]),au(j,w,g,c,o,Y[0],Q[1]),au(j,w,g,c,o,Y[1],Q[0]),au(j,w,g,c,o,Y[1],Q[1])}}return w}function Uo(c,i,o,h,g=1/0){let _=g;const w=ic(c,[0,c.length-1]);for(const j of o)if(!(_!==1/0&&jl(w,ic(j,[0,j.length-1]),h)>=_)&&(_=Math.min(_,Mp(c,i,j,!0,h,_)),_===0))return _;return _}function yo(c,i,o,h,g=1/0){let _=g;const w=ic(c,[0,c.length-1]);for(const j of o){if(_!==1/0&&jl(w,lh(j),h)>=_)continue;const N=ig(c,i,j,h,_);if(isNaN(N))return N;if((_=Math.min(_,N))===0)return _}return _}function su(c){return c==="Point"||c==="MultiPoint"||c==="LineString"||c==="MultiLineString"||c==="Polygon"||c==="MultiPolygon"}class vo{constructor(i,o){this.type=kn,this.geojson=i,this.geometries=o}static parse(i,o){if(i.length!==2)return o.error(`'distance' expression requires either one argument, but found ' ${i.length-1} instead.`);if(th(i[1])){const h=i[1];if(h.type==="FeatureCollection"){for(let g=0;g<h.features.length;++g)if(su(h.features[g].geometry.type))return new vo(h,h.features[g].geometry)}else if(h.type==="Feature"){if(su(h.geometry.type))return new vo(h,h.geometry)}else if(su(h.type))return new vo(h,h)}return o.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(i){const o=i.geometry(),h=i.canonicalID();if(o!=null&&h!=null){if(i.geometryType()==="Point")return function(g,_,w){const j=[];for(const O of g)for(const L of O)j.push(Gu(L,_));const N=new ff(j[0][1],"meters");return w.type==="Point"||w.type==="MultiPoint"||w.type==="LineString"?Mp(j,!1,w.type==="Point"?[w.coordinates]:w.coordinates,w.type==="LineString",N):w.type==="MultiLineString"?Uo(j,!1,w.coordinates,N):w.type==="Polygon"||w.type==="MultiPolygon"?yo(j,!1,w.type==="Polygon"?[w.coordinates]:w.coordinates,N):null}(o,h,this.geometries);if(i.geometryType()==="LineString")return function(g,_,w){const j=[];for(const O of g){const L=[];for(const B of O)L.push(Gu(B,_));j.push(L)}const N=new ff(j[0][0][1],"meters");if(w.type==="Point"||w.type==="MultiPoint"||w.type==="LineString")return Uo(w.type==="Point"?[w.coordinates]:w.coordinates,w.type==="LineString",j,N);if(w.type==="MultiLineString"){let O=1/0;for(let L=0;L<w.coordinates.length;L++){const B=Uo(w.coordinates[L],!0,j,N,O);if(isNaN(B))return B;if((O=Math.min(O,B))===0)return O}return O}if(w.type==="Polygon"||w.type==="MultiPolygon"){let O=1/0;for(let L=0;L<j.length;L++){const B=yo(j[L],!0,w.type==="Polygon"?[w.coordinates]:w.coordinates,N,O);if(isNaN(B))return B;if((O=Math.min(O,B))===0)return O}return O}return null}(o,h,this.geometries);if(i.geometryType()==="Polygon")return function(g,_,w){const j=[];for(const O of function(L,B){const q=L.length;if(q<=1)return[L];const Y=[];let Q,re;for(let he=0;he<q;he++){const pe=to(L[he]);pe!==0&&(L[he].area=Math.abs(pe),re===void 0&&(re=pe<0),re===pe<0?(Q&&Y.push(Q),Q=[L[he]]):Q.push(L[he]))}return Q&&Y.push(Q),Y}(g)){const L=[];for(let B=0;B<O.length;++B)L.push(U_(O[B],_));j.push(L)}const N=new ff(j[0][0][0][1],"meters");if(w.type==="Point"||w.type==="MultiPoint"||w.type==="LineString")return yo(w.type==="Point"?[w.coordinates]:w.coordinates,w.type==="LineString",j,N);if(w.type==="MultiLineString"){let O=1/0;for(let L=0;L<w.coordinates.length;L++){const B=yo(w.coordinates[L],!0,j,N,O);if(isNaN(B))return B;if((O=Math.min(O,B))===0)return O}return O}return w.type==="Polygon"||w.type==="MultiPolygon"?function(O,L,B){let q=1/0;for(const Y of O)for(const Q of L){const re=pf(Y,Q,B,q);if(isNaN(re))return re;if((q=Math.min(q,re))===0)return q}return q}(w.type==="Polygon"?[w.coordinates]:w.coordinates,j,N):null}(o,h,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function sc(c,i){switch(c){case"string":return eo(i);case"number":return+i;case"boolean":return!!i;case"color":return Kr.parse(i);case"formatted":return Rs.fromString(eo(i));case"resolvedImage":return Js.build(eo(i))}return i}function Wu(c,i,o,h){return h!==void 0&&(c=h*Math.round(c/h)),i!==void 0&&c<i&&(c=i),o!==void 0&&c>o&&(c=o),c}class dh{constructor(i,o,h){this.type=i,this.key=o,this.scope=h}static parse(i,o){let h=o.expectedType;if(h==null&&(h=ii),i.length<2||i.length>3)return o.error("Invalid number of arguments for 'config' expression.");const g=o.parse(i[1],1);if(!(g instanceof pr))return o.error("Key name of 'config' expression must be a string literal.");if(i.length>=3){const _=o.parse(i[2],2);return _ instanceof pr?new dh(h,eo(g.value),eo(_.value)):o.error("Scope of 'config' expression must be a string literal.")}return new dh(h,eo(g.value))}evaluate(i){const o=[this.key,this.scope,i.scope].filter(Boolean).join(""),h=i.getConfig(o);if(!h)return null;const{type:g,value:_,values:w,minValue:j,maxValue:N,stepValue:O}=h,L=h.default.evaluate(i);let B=L;if(_){const q=i.scope;i.scope=(q||"").split("").slice(1).join(""),B=_.evaluate(i),i.scope=q}return g&&(B=sc(g,B)),B===void 0||j===void 0&&N===void 0&&O===void 0||(typeof B=="number"?B=Wu(B,j,N,O):Array.isArray(B)&&(B=B.map(q=>typeof q=="number"?Wu(q,j,N,O):q))),_!==void 0&&B!==void 0&&w&&!w.includes(B)&&(B=L,g&&(B=sc(g,B))),(g&&g!==this.type||B!==void 0&&pa(B)!==this.type)&&(B=sc(this.type.kind,B)),B}eachChild(){}outputDefined(){return!1}serialize(){const i=["config",this.key];return this.scope&&i.concat(this.key),i}}function hh(c){if(c instanceof ds&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof Nc||c instanceof vo)return!1;let i=!0;return c.eachChild(o=>{i&&!hh(o)&&(i=!1)}),i}function mf(c){if(c instanceof ds&&c.name==="feature-state")return!1;let i=!0;return c.eachChild(o=>{i&&!mf(o)&&(i=!1)}),i}function ws(c){if(c instanceof dh)return new Set([c.key]);let i=new Set;return c.eachChild(o=>{i=new Set([...i,...ws(o)])}),i}function ma(c,i){if(c instanceof ds&&i.indexOf(c.name)>=0)return!1;let o=!0;return c.eachChild(h=>{o&&!ma(h,i)&&(o=!1)}),o}class Hi{constructor(i,o){this.type=o.type,this.name=i,this.boundExpression=o}static parse(i,o){if(i.length!==2||typeof i[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const h=i[1];return o.scope.has(h)?new Hi(h,o.scope.get(h)):o.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class ou{constructor(i,o=[],h,g=new Jd,_=[],w,j){this.registry=i,this.path=o,this.key=o.map(N=>typeof N=="string"?`['${N}']`:`[${N}]`).join(""),this.scope=g,this.errors=_,this.expectedType=h,this._scope=w,this.options=j}parse(i,o,h,g,_={}){return o||h?this.concat(o,null,h,g)._parse(i,_):this._parse(i,_)}parseObjectValue(i,o,h,g,_,w={}){return this.concat(o,h,g,_)._parse(i,w)}_parse(i,o){function h(g,_,w){return w==="assert"?new Kn(_,[g]):w==="coerce"?new Al(_,[g]):g}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=typeof i[0]=="string"?this.registry[i[0]]:void 0;if(g){let _=g.parse(i,this);if(!_)return null;if(this.expectedType){const w=this.expectedType,j=_.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||j.kind!=="value")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||j.kind!=="value"&&j.kind!=="string"){if(this.checkSubtype(w,j))return null}else _=h(_,w,o.typeAnnotation||"coerce");else _=h(_,w,o.typeAnnotation||"assert")}if(!(_ instanceof pr)&&_.type.kind!=="resolvedImage"&&Pp(_)){const w=new df(this._scope,this.options);try{_=new pr(_.type,_.evaluate(w))}catch(j){return this.error(j.message),null}}return _}return Al.parse(["to-array",i],this)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,o,h,g){let _=typeof i=="number"?this.path.concat(i):this.path;_=typeof o=="string"?_.concat(o):_;const w=g?this.scope.concat(g):this.scope;return new ou(this.registry,_,h||null,w,this.errors,this._scope,this.options)}error(i,...o){const h=`${this.key}${o.map(g=>`[${g}]`).join("")}`;this.errors.push(new Sl(h,i))}checkSubtype(i,o){const h=bp(i,o);return h&&this.error(h),h}}var oc=ou;function Pp(c){if(c instanceof Hi)return Pp(c.boundExpression);if(c instanceof ds&&c.name==="error"||c instanceof nh||c instanceof Nc||c instanceof vo||c instanceof dh)return!1;const i=c instanceof Al||c instanceof Kn;let o=!0;return c.eachChild(h=>{o=i?o&&Pp(h):o&&h instanceof pr}),!!o&&hh(c)&&ma(c,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Dc(c,i){const o=c.length-1;let h,g,_=0,w=o,j=0;for(;_<=w;)if(j=Math.floor((_+w)/2),h=c[j],g=c[j+1],h<=i){if(j===o||i<g)return j;_=j+1}else{if(!(h>i))throw new _n("Input is not a number.");w=j-1}return 0}class gf{constructor(i,o,h){this.type=i,this.input=o,this.labels=[],this.outputs=[];for(const[g,_]of h)this.labels.push(g),this.outputs.push(_)}static parse(i,o){if(i.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return o.error("Expected an even number of arguments.");const h=o.parse(i[1],1,kn);if(!h)return null;const g=[];let _=null;o.expectedType&&o.expectedType.kind!=="value"&&(_=o.expectedType);for(let w=1;w<i.length;w+=2){const j=w===1?-1/0:i[w],N=i[w+1],O=w,L=w+1;if(typeof j!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(g.length&&g[g.length-1][0]>=j)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',O);const B=o.parse(N,L,_);if(!B)return null;_=_||B.type,g.push([j,B])}return new gf(_,h,g)}evaluate(i){const o=this.labels,h=this.outputs;if(o.length===1)return h[0].evaluate(i);const g=this.input.evaluate(i);if(g<=o[0])return h[0].evaluate(i);const _=o.length;return g>=o[_-1]?h[_-1].evaluate(i):h[Dc(o,g)].evaluate(i)}eachChild(i){i(this.input);for(const o of this.outputs)i(o)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){const i=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&i.push(this.labels[o]),i.push(this.outputs[o].serialize());return i}}const Mx=.95047,xf=1.08883,yf=4/29,fh=6/29,vf=3*fh*fh,Px=fh*fh*fh,lu=Math.PI/180,cu=180/Math.PI;function lc(c){return c>Px?Math.pow(c,1/3):c/vf+yf}function cc(c){return c>fh?c*c*c:vf*(c-yf)}function Np(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Dp(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function ph(c){const i=Dp(c.r),o=Dp(c.g),h=Dp(c.b),g=lc((.4124564*i+.3575761*o+.1804375*h)/Mx),_=lc((.2126729*i+.7151522*o+.072175*h)/1);return{l:116*_-16,a:500*(g-_),b:200*(_-lc((.0193339*i+.119192*o+.9503041*h)/xf)),alpha:c.a}}function _f(c){let i=(c.l+16)/116,o=isNaN(c.a)?i:i+c.a/500,h=isNaN(c.b)?i:i-c.b/200;return i=1*cc(i),o=Mx*cc(o),h=xf*cc(h),new Kr(Np(3.2404542*o-1.5371385*i-.4985314*h),Np(-.969266*o+1.8760108*i+.041556*h),Np(.0556434*o-.2040259*i+1.0572252*h),c.alpha)}function Ml(c,i,o){const h=i-c;return c+o*(h>180||h<-180?h-360*Math.round(h/360):h)}const Ya={forward:ph,reverse:_f,interpolate:function(c,i,o){return{l:Vn(c.l,i.l,o),a:Vn(c.a,i.a,o),b:Vn(c.b,i.b,o),alpha:Vn(c.alpha,i.alpha,o)}}},uu={forward:function(c){const{l:i,a:o,b:h}=ph(c),g=Math.atan2(h,o)*cu;return{h:g<0?g+360:g,c:Math.sqrt(o*o+h*h),l:i,alpha:c.a}},reverse:function(c){const i=c.h*lu,o=c.c;return _f({l:c.l,a:Math.cos(i)*o,b:Math.sin(i)*o,alpha:c.alpha})},interpolate:function(c,i,o){return{h:Ml(c.h,i.h,o),c:Vn(c.c,i.c,o),l:Vn(c.l,i.l,o),alpha:Vn(c.alpha,i.alpha,o)}}};var Nx=Object.freeze({__proto__:null,hcl:uu,lab:Ya});class _o{constructor(i,o,h,g,_){this.type=i,this.operator=o,this.interpolation=h,this.input=g,this.labels=[],this.outputs=[];for(const[w,j]of _)this.labels.push(w),this.outputs.push(j)}static interpolationFactor(i,o,h,g){let _=0;if(i.name==="exponential")_=Op(o,i.base,h,g);else if(i.name==="linear")_=Op(o,1,h,g);else if(i.name==="cubic-bezier"){const w=i.controlPoints;_=new Hd(w[0],w[1],w[2],w[3]).solve(Op(o,1,h,g))}return _}static parse(i,o){let[h,g,_,...w]=i;if(!Array.isArray(g)||g.length===0)return o.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const O=g[1];if(typeof O!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:O}}else{if(g[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const O=g.slice(1);if(O.length!==4||O.some(L=>typeof L!="number"||L<0||L>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:O}}}if(i.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length-1>3&&(i.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(_=o.parse(_,2,kn),!_)return null;const j=[];let N=null;h==="interpolate-hcl"||h==="interpolate-lab"?N=go:o.expectedType&&o.expectedType.kind!=="value"&&(N=o.expectedType);for(let O=0;O<w.length;O+=2){const L=w[O],B=w[O+1],q=O+3,Y=O+4;if(typeof L!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(j.length&&j[j.length-1][0]>=L)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',q);const Q=o.parse(B,Y,N);if(!Q)return null;N=N||Q.type,j.push([L,Q])}return N.kind==="number"||N.kind==="color"||N.kind==="array"&&N.itemType.kind==="number"&&typeof N.N=="number"?new _o(N,h,g,_,j):o.error(`Type ${ka(N)} is not interpolatable.`)}evaluate(i){const o=this.labels,h=this.outputs;if(o.length===1)return h[0].evaluate(i);const g=this.input.evaluate(i);if(g<=o[0])return h[0].evaluate(i);const _=o.length;if(g>=o[_-1])return h[_-1].evaluate(i);const w=Dc(o,g),j=_o.interpolationFactor(this.interpolation,g,o[w],o[w+1]),N=h[w].evaluate(i),O=h[w+1].evaluate(i);return this.operator==="interpolate"?xp[this.type.kind.toLowerCase()](N,O,j):this.operator==="interpolate-hcl"?uu.reverse(uu.interpolate(uu.forward(N),uu.forward(O),j)):Ya.reverse(Ya.interpolate(Ya.forward(N),Ya.forward(O),j))}eachChild(i){i(this.input);for(const o of this.outputs)i(o)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){let i;i=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const o=[this.operator,i,this.input.serialize()];for(let h=0;h<this.labels.length;h++)o.push(this.labels[h],this.outputs[h].serialize());return o}}function Op(c,i,o,h){const g=h-o,_=c-o;return g===0?0:i===1?_/g:(Math.pow(i,_)-1)/(Math.pow(i,g)-1)}class ag{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expectected at least one argument.");let h=null;const g=o.expectedType;g&&g.kind!=="value"&&(h=g);const _=[];for(const j of i.slice(1)){const N=o.parse(j,1+_.length,h,void 0,{typeAnnotation:"omit"});if(!N)return null;h=h||N.type,_.push(N)}const w=g&&_.some(j=>bp(g,j.type));return new ag(w?ii:h,_)}evaluate(i){let o,h=null,g=0;for(const _ of this.args){if(g++,h=_.evaluate(i),h&&h instanceof Js&&!h.available&&(o||(o=h),h=null,g===this.args.length))return o;if(h!==null)break}return h}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=["coalesce"];return this.eachChild(o=>{i.push(o.serialize())}),i}}class $a{constructor(i,o){this.type=o.type,this.bindings=[].concat(i),this.result=o}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const o of this.bindings)i(o[1]);i(this.result)}static parse(i,o){if(i.length<4)return o.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const h=[];for(let _=1;_<i.length-1;_+=2){const w=i[_];if(typeof w!="string")return o.error(`Expected string, but found ${typeof w} instead.`,_);if(/[^a-zA-Z0-9_]/.test(w))return o.error("Variable names must contain only alphanumeric characters or '_'.",_);const j=o.parse(i[_+1],_+1);if(!j)return null;h.push([w,j])}const g=o.parse(i[i.length-1],i.length-1,o.expectedType,h);return g?new $a(h,g):null}outputDefined(){return this.result.outputDefined()}serialize(){const i=["let"];for(const[o,h]of this.bindings)i.push(o,h.serialize());return i.push(this.result.serialize()),i}}class bf{constructor(i,o,h){this.type=i,this.index=o,this.input=h}static parse(i,o){if(i.length!==3)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=o.parse(i[1],1,kn),g=o.parse(i[2],2,Qs(o.expectedType||ii));return h&&g?new bf(g.type.itemType,h,g):null}evaluate(i){const o=this.index.evaluate(i),h=this.input.evaluate(i);if(o<0)throw new _n(`Array index out of bounds: ${o} < 0.`);if(o>=h.length)throw new _n(`Array index out of bounds: ${o} > ${h.length-1}.`);if(o!==Math.floor(o))throw new _n(`Array index must be an integer, but found ${o} instead. Use at-interpolated to retrieve interpolated result with a fractional index.`);return h[o]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Zu{constructor(i,o,h){this.type=i,this.index=o,this.input=h}static parse(i,o){if(i.length!==3)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=o.parse(i[1],1,kn),g=o.parse(i[2],2,Qs(o.expectedType||ii));return h&&g?new Zu(g.type.itemType,h,g):null}evaluate(i){const o=this.index.evaluate(i),h=this.input.evaluate(i);if(o<0)throw new _n(`Array index out of bounds: ${o} < 0.`);if(o>h.length-1)throw new _n(`Array index out of bounds: ${o} > ${h.length-1}.`);if(o===Math.floor(o))return h[o];const g=Math.floor(o),_=Math.ceil(o),w=h[g],j=h[_];if(typeof w!="number"||typeof j!="number")throw new _n(`Cannot interpolate between non-number values at index ${o}.`);const N=o-g;return w*(1-N)+j*N}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class mh{constructor(i,o){this.type=ai,this.needle=i,this.haystack=o}static parse(i,o){if(i.length!==3)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=o.parse(i[1],1,ii),g=o.parse(i[2],2,ii);return h&&g?wx(h.type,[ai,vi,kn,qu,ii])?new mh(h,g):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ka(h.type)} instead`):null}evaluate(i){const o=this.needle.evaluate(i),h=this.haystack.evaluate(i);if(h==null)return!1;if(!Hu(o,["boolean","string","number","null"]))throw new _n(`Expected first argument to be of type boolean, string, number or null, but found ${ka(pa(o))} instead.`);if(!Hu(h,["string","array"]))throw new _n(`Expected second argument to be of type array or string, but found ${ka(pa(h))} instead.`);return h.indexOf(o)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class wf{constructor(i,o,h){this.type=kn,this.needle=i,this.haystack=o,this.fromIndex=h}static parse(i,o){if(i.length<=2||i.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const h=o.parse(i[1],1,ii),g=o.parse(i[2],2,ii);if(!h||!g)return null;if(!wx(h.type,[ai,vi,kn,qu,ii]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ka(h.type)} instead`);if(i.length===4){const _=o.parse(i[3],3,kn);return _?new wf(h,g,_):null}return new wf(h,g)}evaluate(i){const o=this.needle.evaluate(i),h=this.haystack.evaluate(i);if(!Hu(o,["boolean","string","number","null"]))throw new _n(`Expected first argument to be of type boolean, string, number or null, but found ${ka(pa(o))} instead.`);if(!Hu(h,["string","array"]))throw new _n(`Expected second argument to be of type array or string, but found ${ka(pa(h))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(i);return h.indexOf(o,g)}return h.indexOf(o)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Xu{constructor(i,o,h,g,_,w){this.inputType=i,this.type=o,this.input=h,this.cases=g,this.outputs=_,this.otherwise=w}static parse(i,o){if(i.length<5)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return o.error("Expected an even number of arguments.");let h,g;o.expectedType&&o.expectedType.kind!=="value"&&(g=o.expectedType);const _={},w=[];for(let O=2;O<i.length-1;O+=2){let L=i[O];const B=i[O+1];Array.isArray(L)||(L=[L]);const q=o.concat(O);if(L.length===0)return q.error("Expected at least one branch label.");for(const Q of L){if(typeof Q!="number"&&typeof Q!="string")return q.error("Branch labels must be numbers or strings.");if(typeof Q=="number"&&Math.abs(Q)>Number.MAX_SAFE_INTEGER)return q.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Q=="number"&&Math.floor(Q)!==Q)return q.error("Numeric branch labels must be integer values.");if(h){if(q.checkSubtype(h,pa(Q)))return null}else h=pa(Q);if(_[String(Q)]!==void 0)return q.error("Branch labels must be unique.");_[String(Q)]=w.length}const Y=o.parse(B,O,g);if(!Y)return null;g=g||Y.type,w.push(Y)}const j=o.parse(i[1],1,ii);if(!j)return null;const N=o.parse(i[i.length-1],i.length-1,g);return N?j.type.kind!=="value"&&o.concat(1).checkSubtype(h,j.type)?null:new Xu(h,g,j,_,w,N):null}evaluate(i){const o=this.input.evaluate(i);return(pa(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),h=[],g={};for(const w of o){const j=g[this.cases[w]];j===void 0?(g[this.cases[w]]=h.length,h.push([this.cases[w],[w]])):h[j][1].push(w)}const _=w=>this.inputType.kind==="number"?Number(w):w;for(const[w,j]of h)i.push(j.length===1?_(j[0]):j.map(_)),i.push(this.outputs[w].serialize());return i.push(this.otherwise.serialize()),i}}class du{constructor(i,o,h){this.type=i,this.branches=o,this.otherwise=h}static parse(i,o){if(i.length<4)return o.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return o.error("Expected an odd number of arguments.");let h;o.expectedType&&o.expectedType.kind!=="value"&&(h=o.expectedType);const g=[];for(let w=1;w<i.length-1;w+=2){const j=o.parse(i[w],w,ai);if(!j)return null;const N=o.parse(i[w+1],w+1,h);if(!N)return null;g.push([j,N]),h=h||N.type}const _=o.parse(i[i.length-1],i.length-1,h);return _?new du(h,g,_):null}evaluate(i){for(const[o,h]of this.branches)if(o.evaluate(i))return h.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[o,h]of this.branches)i(o),i(h);i(this.otherwise)}outputDefined(){return this.branches.every(([i,o])=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["case"];return this.eachChild(o=>{i.push(o.serialize())}),i}}class Ip{constructor(i,o,h,g){this.type=i,this.input=o,this.beginIndex=h,this.endIndex=g}static parse(i,o){if(i.length<=2||i.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const h=o.parse(i[1],1,ii),g=o.parse(i[2],2,kn);if(!h||!g)return null;if(!wx(h.type,[Qs(ii),vi,ii]))return o.error(`Expected first argument to be of type array or string, but found ${ka(h.type)} instead`);if(i.length===4){const _=o.parse(i[3],3,kn);return _?new Ip(h.type,h,g,_):null}return new Ip(h.type,h,g)}evaluate(i){const o=this.input.evaluate(i),h=this.beginIndex.evaluate(i);if(!Hu(o,["string","array"]))throw new _n(`Expected first argument to be of type array or string, but found ${ka(pa(o))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(i);return o.slice(h,g)}return o.slice(h)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Sf(c,i){return c==="=="||c==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function Ly(c,i,o,h){return h.compare(i,o)===0}function Ku(c,i,o){const h=c!=="=="&&c!=="!=";return class gG{constructor(_,w,j){this.type=ai,this.lhs=_,this.rhs=w,this.collator=j,this.hasUntypedArgument=_.type.kind==="value"||w.type.kind==="value"}static parse(_,w){if(_.length!==3&&_.length!==4)return w.error("Expected two or three arguments.");const j=_[0];let N=w.parse(_[1],1,ii);if(!N)return null;if(!Sf(j,N.type))return w.concat(1).error(`"${j}" comparisons are not supported for type '${ka(N.type)}'.`);let O=w.parse(_[2],2,ii);if(!O)return null;if(!Sf(j,O.type))return w.concat(2).error(`"${j}" comparisons are not supported for type '${ka(O.type)}'.`);if(N.type.kind!==O.type.kind&&N.type.kind!=="value"&&O.type.kind!=="value")return w.error(`Cannot compare types '${ka(N.type)}' and '${ka(O.type)}'.`);h&&(N.type.kind==="value"&&O.type.kind!=="value"?N=new Kn(O.type,[N]):N.type.kind!=="value"&&O.type.kind==="value"&&(O=new Kn(N.type,[O])));let L=null;if(_.length===4){if(N.type.kind!=="string"&&O.type.kind!=="string"&&N.type.kind!=="value"&&O.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(L=w.parse(_[3],3,eh),!L)return null}return new gG(N,O,L)}evaluate(_){const w=this.lhs.evaluate(_),j=this.rhs.evaluate(_);if(h&&this.hasUntypedArgument){const N=pa(w),O=pa(j);if(N.kind!==O.kind||N.kind!=="string"&&N.kind!=="number")throw new _n(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${N.kind}, ${O.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const N=pa(w),O=pa(j);if(N.kind!=="string"||O.kind!=="string")return i(_,w,j)}return this.collator?o(_,w,j,this.collator.evaluate(_)):i(_,w,j)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}serialize(){const _=[c];return this.eachChild(w=>{_.push(w.serialize())}),_}}}const gh=Ku("==",function(c,i,o){return i===o},Ly),Dx=Ku("!=",function(c,i,o){return i!==o},function(c,i,o,h){return!Ly(0,i,o,h)}),kp=Ku("<",function(c,i,o){return i<o},function(c,i,o,h){return h.compare(i,o)<0}),Ox=Ku(">",function(c,i,o){return i>o},function(c,i,o,h){return h.compare(i,o)>0}),Rp=Ku("<=",function(c,i,o){return i<=o},function(c,i,o,h){return h.compare(i,o)<=0}),Fy=Ku(">=",function(c,i,o){return i>=o},function(c,i,o,h){return h.compare(i,o)>=0});class Tf{constructor(i,o,h,g,_,w){this.type=vi,this.number=i,this.locale=o,this.currency=h,this.unit=g,this.minFractionDigits=_,this.maxFractionDigits=w}static parse(i,o){if(i.length!==3)return o.error("Expected two arguments.");const h=o.parse(i[1],1,kn);if(!h)return null;const g=i[2];if(typeof g!="object"||Array.isArray(g))return o.error("NumberFormat options argument must be an object.");let _=null;if(g.locale&&(_=o.parseObjectValue(g.locale,2,"locale",vi),!_))return null;let w=null;if(g.currency&&(w=o.parseObjectValue(g.currency,2,"currency",vi),!w))return null;let j=null;if(g.unit&&(j=o.parseObjectValue(g.unit,2,"unit",vi),!j))return null;let N=null;if(g["min-fraction-digits"]&&(N=o.parseObjectValue(g["min-fraction-digits"],2,"min-fraction-digits",kn),!N))return null;let O=null;return g["max-fraction-digits"]&&(O=o.parseObjectValue(g["max-fraction-digits"],2,"max-fraction-digits",kn),!O)?null:new Tf(h,_,w,j,N,O)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(i):void 0,unit:this.unit?this.unit.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.unit&&i(this.unit),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.unit&&(i.unit=this.unit.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]}}class xh{constructor(i){this.type=kn,this.input=i}static parse(i,o){if(i.length!==2)return o.error(`Expected 1 argument, but found ${i.length-1} instead.`);const h=o.parse(i[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${ka(h.type)} instead.`):new xh(h):null}evaluate(i){const o=this.input.evaluate(i);if(typeof o=="string"||Array.isArray(o))return o.length;throw new _n(`Expected value to be of type string or array, but found ${ka(pa(o))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){const i=["length"];return this.eachChild(o=>{i.push(o.serialize())}),i}}function Ix(c){return function(){c=1831565813+(c|=0)|0;let i=Math.imul(c^c>>>15,1|c);return i=i+Math.imul(i^i>>>7,61|i)^i,((i^i>>>14)>>>0)/4294967296}}const Oc={"==":gh,"!=":Dx,">":Ox,"<":kp,">=":Fy,"<=":Rp,array:Kn,at:bf,"at-interpolated":Zu,boolean:Kn,case:du,coalesce:ag,collator:nh,format:tc,image:Pc,in:mh,"index-of":wf,interpolate:_o,"interpolate-hcl":_o,"interpolate-lab":_o,length:xh,let:$a,literal:pr,match:Xu,number:Kn,"number-format":Tf,object:Kn,slice:Ip,step:gf,string:Kn,"to-boolean":Al,"to-color":Al,"to-number":Al,"to-string":Al,var:Hi,within:Nc,distance:vo,config:dh};function kx(c,[i,o,h,g]){i=i.evaluate(c),o=o.evaluate(c),h=h.evaluate(c);const _=g?g.evaluate(c):1,w=Sx(i,o,h,_);if(w)throw new _n(w);return new Kr(i/255*_,o/255*_,h/255*_,_)}function Ef(c,[i,o,h,g]){i=i.evaluate(c),o=o.evaluate(c),h=h.evaluate(c);const _=g?g.evaluate(c):1,w=function(O,L,B,q){return typeof O=="number"&&O>=0&&O<=360?typeof L=="number"&&L>=0&&L<=100&&typeof B=="number"&&B>=0&&B<=100?q===void 0||typeof q=="number"&&q>=0&&q<=1?null:`Invalid hsla value [${[O,L,B,q].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof q=="number"?[O,L,B,q]:[O,L,B]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof q=="number"?[O,L,B,q]:[O,L,B]).join(", ")}]: 'h' must be between 0 and 360.`}(i,o,h,_);if(w)throw new _n(w);const j=`hsla(${i}, ${o}%, ${h}%, ${_})`,N=Kr.parse(j);if(!N)throw new _n(`Failed to parse HSLA color: ${j}`);return N}function sg(c,i){return c in i}function zp(c,i){const o=i[c];return o===void 0?null:o}function bo(c){return{type:c}}function og(c){return{result:"success",value:c}}function wo(c){return{result:"error",value:c}}function Ic(c,i){return!!c&&!!c.parameters&&c.parameters.indexOf(i)>-1}function uc(c){return c["property-type"]==="data-driven"}function Af(c){return Ic(c.expression,"measure-light")}function Lp(c){return Ic(c.expression,"zoom")}function Cf(c){return!!c.expression&&c.expression.interpolated}function Yu(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function jf(c){return c}function Fp(c,i){const o=i.type==="color",h=c.stops&&typeof c.stops[0][0]=="object",g=h||!(h||c.property!==void 0),_=c.type||(Cf(i)?"exponential":"interval");if(o&&((c=yp({},c)).stops&&(c.stops=c.stops.map(O=>[O[0],Kr.parse(O[1])])),c.default=Kr.parse(c.default?c.default:i.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!Nx[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let w,j,N;if(_==="exponential")w=kc;else if(_==="interval")w=lg;else if(_==="categorical"){w=yh,j=Object.create(null);for(const O of c.stops)j[O[0]]=O[1];N=typeof c.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);w=Rx}if(h){const O={},L=[];for(let Y=0;Y<c.stops.length;Y++){const Q=c.stops[Y],re=Q[0].zoom;O[re]===void 0&&(O[re]={zoom:re,type:c.type,property:c.property,default:c.default,stops:[]},L.push(re)),O[re].stops.push([Q[0].value,Q[1]])}const B=[];for(const Y of L)B.push([O[Y].zoom,Fp(O[Y],i)]);const q={name:"linear"};return{kind:"composite",interpolationType:q,interpolationFactor:_o.interpolationFactor.bind(void 0,q),zoomStops:B.map(Y=>Y[0]),evaluate:({zoom:Y},Q)=>kc({stops:B,base:c.base},i,Y).evaluate(Y,Q)}}if(g){const O=_==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:O,interpolationFactor:_o.interpolationFactor.bind(void 0,O),zoomStops:c.stops.map(L=>L[0]),evaluate:({zoom:L})=>w(c,i,L,j,N)}}return{kind:"source",evaluate(O,L){const B=L&&L.properties?L.properties[c.property]:void 0;return B===void 0?Qu(c.default,i.default):w(c,i,B,j,N)}}}function Qu(c,i,o){return c!==void 0?c:i!==void 0?i:o!==void 0?o:void 0}function yh(c,i,o,h,g){return Qu(typeof o===g?h[o]:void 0,c.default,i.default)}function lg(c,i,o){if(Jn(o)!=="number")return Qu(c.default,i.default);const h=c.stops.length;if(h===1||o<=c.stops[0][0])return c.stops[0][1];if(o>=c.stops[h-1][0])return c.stops[h-1][1];const g=Dc(c.stops.map(_=>_[0]),o);return c.stops[g][1]}function kc(c,i,o){const h=c.base!==void 0?c.base:1;if(Jn(o)!=="number")return Qu(c.default,i.default);const g=c.stops.length;if(g===1||o<=c.stops[0][0])return c.stops[0][1];if(o>=c.stops[g-1][0])return c.stops[g-1][1];const _=Dc(c.stops.map(L=>L[0]),o),w=function(L,B,q,Y){const Q=Y-q,re=L-q;return Q===0?0:B===1?re/Q:(Math.pow(B,re)-1)/(Math.pow(B,Q)-1)}(o,h,c.stops[_][0],c.stops[_+1][0]),j=c.stops[_][1],N=c.stops[_+1][1];let O=xp[i.type]||jf;if(c.colorSpace&&c.colorSpace!=="rgb"){const L=Nx[c.colorSpace];O=(B,q)=>L.reverse(L.interpolate(L.forward(B),L.forward(q),w))}return typeof j.evaluate=="function"?{evaluate(...L){const B=j.evaluate.apply(void 0,L),q=N.evaluate.apply(void 0,L);if(B!==void 0&&q!==void 0)return O(B,q,w)}}:O(j,N,w)}function Rx(c,i,o){return i.type==="color"?o=Kr.parse(o):i.type==="formatted"?o=Rs.fromString(o.toString()):i.type==="resolvedImage"?o=Js.build(o.toString()):Jn(o)===i.type||i.type==="enum"&&i.values[o]||(o=void 0),Qu(o,c.default,i.default)}ds.register(Oc,{error:[{kind:"error"},[vi],(c,[i])=>{throw new _n(i.evaluate(c))}],typeof:[vi,[ii],(c,[i])=>ka(pa(i.evaluate(c)))],"to-rgba":[Qs(kn,4),[go],(c,[i])=>i.evaluate(c).toRenderColor(null).toArray()],"to-hsla":[Qs(kn,4),[go],(c,[i])=>i.evaluate(c).toRenderColor(null).toHslaArray()],rgb:[go,[kn,kn,kn],kx],rgba:[go,[kn,kn,kn,kn],kx],hsl:[go,[kn,kn,kn],Ef],hsla:[go,[kn,kn,kn,kn],Ef],has:{type:ai,overloads:[[[vi],(c,[i])=>sg(i.evaluate(c),c.properties())],[[vi,tu],(c,[i,o])=>sg(i.evaluate(c),o.evaluate(c))]]},get:{type:ii,overloads:[[[vi],(c,[i])=>zp(i.evaluate(c),c.properties())],[[vi,tu],(c,[i,o])=>zp(i.evaluate(c),o.evaluate(c))]]},"feature-state":[ii,[vi],(c,[i])=>zp(i.evaluate(c),c.featureState||{})],properties:[tu,[],c=>c.properties()],"geometry-type":[vi,[],c=>c.geometryType()],id:[ii,[],c=>c.id()],zoom:[kn,[],c=>c.globals.zoom],pitch:[kn,[],c=>c.globals.pitch||0],"distance-from-center":[kn,[],c=>c.distanceFromCenter()],"measure-light":[kn,[vi],(c,[i])=>c.measureLight(i.evaluate(c))],"heatmap-density":[kn,[],c=>c.globals.heatmapDensity||0],"line-progress":[kn,[],c=>c.globals.lineProgress||0],"raster-value":[kn,[],c=>c.globals.rasterValue||0],"raster-particle-speed":[kn,[],c=>c.globals.rasterParticleSpeed||0],"sky-radial-progress":[kn,[],c=>c.globals.skyRadialProgress||0],accumulated:[ii,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[kn,bo(kn),(c,i)=>{let o=0;for(const h of i)o+=h.evaluate(c);return o}],"*":[kn,bo(kn),(c,i)=>{let o=1;for(const h of i)o*=h.evaluate(c);return o}],"-":{type:kn,overloads:[[[kn,kn],(c,[i,o])=>i.evaluate(c)-o.evaluate(c)],[[kn],(c,[i])=>-i.evaluate(c)]]},"/":[kn,[kn,kn],(c,[i,o])=>i.evaluate(c)/o.evaluate(c)],"%":[kn,[kn,kn],(c,[i,o])=>i.evaluate(c)%o.evaluate(c)],ln2:[kn,[],()=>Math.LN2],pi:[kn,[],()=>Math.PI],e:[kn,[],()=>Math.E],"^":[kn,[kn,kn],(c,[i,o])=>Math.pow(i.evaluate(c),o.evaluate(c))],sqrt:[kn,[kn],(c,[i])=>Math.sqrt(i.evaluate(c))],log10:[kn,[kn],(c,[i])=>Math.log(i.evaluate(c))/Math.LN10],ln:[kn,[kn],(c,[i])=>Math.log(i.evaluate(c))],log2:[kn,[kn],(c,[i])=>Math.log(i.evaluate(c))/Math.LN2],sin:[kn,[kn],(c,[i])=>Math.sin(i.evaluate(c))],cos:[kn,[kn],(c,[i])=>Math.cos(i.evaluate(c))],tan:[kn,[kn],(c,[i])=>Math.tan(i.evaluate(c))],asin:[kn,[kn],(c,[i])=>Math.asin(i.evaluate(c))],acos:[kn,[kn],(c,[i])=>Math.acos(i.evaluate(c))],atan:[kn,[kn],(c,[i])=>Math.atan(i.evaluate(c))],min:[kn,bo(kn),(c,i)=>Math.min(...i.map(o=>o.evaluate(c)))],max:[kn,bo(kn),(c,i)=>Math.max(...i.map(o=>o.evaluate(c)))],abs:[kn,[kn],(c,[i])=>Math.abs(i.evaluate(c))],round:[kn,[kn],(c,[i])=>{const o=i.evaluate(c);return o<0?-Math.round(-o):Math.round(o)}],floor:[kn,[kn],(c,[i])=>Math.floor(i.evaluate(c))],ceil:[kn,[kn],(c,[i])=>Math.ceil(i.evaluate(c))],"filter-==":[ai,[vi,ii],(c,[i,o])=>c.properties()[i.value]===o.value],"filter-id-==":[ai,[ii],(c,[i])=>c.id()===i.value],"filter-type-==":[ai,[vi],(c,[i])=>c.geometryType()===i.value],"filter-<":[ai,[vi,ii],(c,[i,o])=>{const h=c.properties()[i.value],g=o.value;return typeof h==typeof g&&h<g}],"filter-id-<":[ai,[ii],(c,[i])=>{const o=c.id(),h=i.value;return typeof o==typeof h&&o<h}],"filter->":[ai,[vi,ii],(c,[i,o])=>{const h=c.properties()[i.value],g=o.value;return typeof h==typeof g&&h>g}],"filter-id->":[ai,[ii],(c,[i])=>{const o=c.id(),h=i.value;return typeof o==typeof h&&o>h}],"filter-<=":[ai,[vi,ii],(c,[i,o])=>{const h=c.properties()[i.value],g=o.value;return typeof h==typeof g&&h<=g}],"filter-id-<=":[ai,[ii],(c,[i])=>{const o=c.id(),h=i.value;return typeof o==typeof h&&o<=h}],"filter->=":[ai,[vi,ii],(c,[i,o])=>{const h=c.properties()[i.value],g=o.value;return typeof h==typeof g&&h>=g}],"filter-id->=":[ai,[ii],(c,[i])=>{const o=c.id(),h=i.value;return typeof o==typeof h&&o>=h}],"filter-has":[ai,[ii],(c,[i])=>i.value in c.properties()],"filter-has-id":[ai,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[ai,[Qs(vi)],(c,[i])=>i.value.indexOf(c.geometryType())>=0],"filter-id-in":[ai,[Qs(ii)],(c,[i])=>i.value.indexOf(c.id())>=0],"filter-in-small":[ai,[vi,Qs(ii)],(c,[i,o])=>o.value.indexOf(c.properties()[i.value])>=0],"filter-in-large":[ai,[vi,Qs(ii)],(c,[i,o])=>function(h,g,_,w){for(;_<=w;){const j=_+w>>1;if(g[j]===h)return!0;g[j]>h?w=j-1:_=j+1}return!1}(c.properties()[i.value],o.value,0,o.value.length-1)],all:{type:ai,overloads:[[[ai,ai],(c,[i,o])=>i.evaluate(c)&&o.evaluate(c)],[bo(ai),(c,i)=>{for(const o of i)if(!o.evaluate(c))return!1;return!0}]]},any:{type:ai,overloads:[[[ai,ai],(c,[i,o])=>i.evaluate(c)||o.evaluate(c)],[bo(ai),(c,i)=>{for(const o of i)if(o.evaluate(c))return!0;return!1}]]},"!":[ai,[ai],(c,[i])=>!i.evaluate(c)],"is-supported-script":[ai,[vi],(c,[i])=>{const o=c.globals&&c.globals.isSupportedScript;return!o||o(i.evaluate(c))}],upcase:[vi,[vi],(c,[i])=>i.evaluate(c).toUpperCase()],downcase:[vi,[vi],(c,[i])=>i.evaluate(c).toLowerCase()],concat:[vi,bo(ii),(c,i)=>i.map(o=>eo(o.evaluate(c))).join("")],"resolved-locale":[vi,[eh],(c,[i])=>i.evaluate(c).resolvedLocale()],random:[kn,[kn,kn,ii],(c,i)=>{const[o,h,g]=i.map(w=>w.evaluate(c));if(o>h||o===h)return o;let _;if(typeof g=="string")_=function(w){let j=0;if(w.length===0)return j;for(let N=0;N<w.length;N++)j=(j<<5)-j+w.charCodeAt(N),j|=0;return j}(g);else{if(typeof g!="number")throw new _n(`Invalid seed input: ${g}`);_=g}return o+Ix(_)()*(h-o)}]});class Bp{constructor(i,o,h,g){this.expression=i,this._warningHistory={},this._evaluator=new df(h,g),this._defaultValue=o?function(_){return _.type==="color"&&(Yu(_.default)||Array.isArray(_.default))?new Kr(0,0,0,0):_.type==="color"?Kr.parse(_.default)||null:_.default===void 0?null:_.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null,this.configDependencies=ws(i)}evaluateWithoutErrorHandling(i,o,h,g,_,w,j,N){return this._evaluator.globals=i,this._evaluator.feature=o,this._evaluator.featureState=h,this._evaluator.canonical=g||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=w,this._evaluator.featureTileCoord=j||null,this._evaluator.featureDistanceData=N||null,this.expression.evaluate(this._evaluator)}evaluate(i,o,h,g,_,w,j,N){this._evaluator.globals=i,this._evaluator.feature=o||null,this._evaluator.featureState=h||null,this._evaluator.canonical=g||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=w||null,this._evaluator.featureTileCoord=j||null,this._evaluator.featureDistanceData=N||null;try{const O=this.expression.evaluate(this._evaluator);if(O==null||typeof O=="number"&&O!=O)return this._defaultValue;if(this._enumValues&&!(O in this._enumValues))throw new _n(`Expected value to be one of ${Object.keys(this._enumValues).map(L=>JSON.stringify(L)).join(", ")}, but found ${JSON.stringify(O)} instead.`);return O}catch(O){return this._warningHistory[O.message]||(this._warningHistory[O.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${O.message}`)),this._defaultValue}}}function dc(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in Oc}function si(c,i,o,h){const g=new oc(Oc,[],i?function(w){const j={color:go,string:vi,number:kn,enum:vi,boolean:ai,formatted:vp,resolvedImage:_p};return w.type==="array"?Qs(j[w.value]||ii,w.length):j[w.type]}(i):void 0,void 0,void 0,o,h),_=g.parse(c,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return _?og(new Bp(_,i,o,h)):wo(g.errors)}class Gi{constructor(i,o,h,g){this.kind=i,this._styleExpression=o,this.isLightConstant=h,this.isLineProgressConstant=g,this.isStateDependent=i!=="constant"&&!mf(o.expression),this.configDependencies=ws(o.expression)}evaluateWithoutErrorHandling(i,o,h,g,_,w){return this._styleExpression.evaluateWithoutErrorHandling(i,o,h,g,_,w)}evaluate(i,o,h,g,_,w){return this._styleExpression.evaluate(i,o,h,g,_,w)}}class ja{constructor(i,o,h,g,_,w){this.kind=i,this.zoomStops=h,this._styleExpression=o,this.isStateDependent=i!=="camera"&&!mf(o.expression),this.isLightConstant=_,this.isLineProgressConstant=w,this.configDependencies=ws(o.expression),this.interpolationType=g}evaluateWithoutErrorHandling(i,o,h,g,_,w){return this._styleExpression.evaluateWithoutErrorHandling(i,o,h,g,_,w)}evaluate(i,o,h,g,_,w){return this._styleExpression.evaluate(i,o,h,g,_,w)}interpolationFactor(i,o,h){return this.interpolationType?_o.interpolationFactor(this.interpolationType,i,o,h):0}}function Ju(c,i,o,h){if((c=si(c,i,o,h)).result==="error")return c;const g=c.value.expression,_=hh(g);if(!_&&!uc(i))return wo([new Sl("","data expressions not supported")]);const w=ma(g,["zoom","pitch","distance-from-center"]);if(!w&&!Lp(i))return wo([new Sl("","zoom expressions not supported")]);const j=ma(g,["measure-light"]);if(!j&&!Af(i))return wo([new Sl("","measure-light expression not supported")]);const N=ma(g,["line-progress"]);if(!N&&!function(B){return Ic(B.expression,"line-progress")}(i))return wo([new Sl("","line-progress expression not supported")]);const O=i.expression&&i.expression.relaxZoomRestriction,L=zc(g);return L||w||O?L instanceof Sl?wo([L]):L instanceof _o&&!Cf(i)?wo([new Sl("",'"interpolate" expressions cannot be used with this property')]):og(L?new ja(_&&N?"camera":"composite",c.value,L.labels,L instanceof _o?L.interpolation:void 0,j,N):new Gi(_&&N?"constant":"source",c.value,j,N)):wo([new Sl("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Rc{constructor(i,o){this._parameters=i,this._specification=o,yp(this,Fp(this._parameters,this._specification))}static deserialize(i){return new Rc(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function zc(c){let i=null;if(c instanceof $a)i=zc(c.result);else if(c instanceof ag){for(const o of c.args)if(i=zc(o),i)break}else(c instanceof gf||c instanceof _o)&&c.input instanceof ds&&c.input.name==="zoom"&&(i=c);return i instanceof Sl||c.eachChild(o=>{const h=zc(o);h instanceof Sl?i=h:i&&h&&i!==h&&(i=new Sl("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}var Mf,ed,td=function(){if(ed)return Mf;ed=1,Mf=i;var c=3;function i(o,h,g){var _=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var w=new Int32Array(this.arrayBuffer);o=w[0],this.d=(h=w[1])+2*(g=w[2]);for(var j=0;j<this.d*this.d;j++){var N=w[c+j],O=w[c+j+1];_.push(N===O?null:w.subarray(N,O))}var L=w[c+_.length+1];this.keys=w.subarray(w[c+_.length],L),this.bboxes=w.subarray(L),this.insert=this._insertReadonly}else{this.d=h+2*g;for(var B=0;B<this.d*this.d;B++)_.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=o,this.padding=g,this.scale=h/o,this.uid=0;var q=g/h*o;this.min=-q,this.max=o+q}return i.prototype.insert=function(o,h,g,_,w){this._forEachCell(h,g,_,w,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(_),this.bboxes.push(w)},i.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},i.prototype._insertCell=function(o,h,g,_,w,j){this.cells[w].push(j)},i.prototype.query=function(o,h,g,_,w){var j=this.min,N=this.max;if(o<=j&&h<=j&&N<=g&&N<=_&&!w)return Array.prototype.slice.call(this.keys);var O=[];return this._forEachCell(o,h,g,_,this._queryCell,O,{},w),O},i.prototype._queryCell=function(o,h,g,_,w,j,N,O){var L=this.cells[w];if(L!==null)for(var B=this.keys,q=this.bboxes,Y=0;Y<L.length;Y++){var Q=L[Y];if(N[Q]===void 0){var re=4*Q;(O?O(q[re+0],q[re+1],q[re+2],q[re+3]):o<=q[re+2]&&h<=q[re+3]&&g>=q[re+0]&&_>=q[re+1])?(N[Q]=!0,j.push(B[Q])):N[Q]=!1}}},i.prototype._forEachCell=function(o,h,g,_,w,j,N,O){for(var L=this._convertToCellCoord(o),B=this._convertToCellCoord(h),q=this._convertToCellCoord(g),Y=this._convertToCellCoord(_),Q=L;Q<=q;Q++)for(var re=B;re<=Y;re++){var he=this.d*re+Q;if((!O||O(this._convertFromCellCoord(Q),this._convertFromCellCoord(re),this._convertFromCellCoord(Q+1),this._convertFromCellCoord(re+1)))&&w.call(this,o,h,g,_,he,j,N,O))return}},i.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},i.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},i.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,h=c+this.cells.length+1+1,g=0,_=0;_<this.cells.length;_++)g+=this.cells[_].length;var w=new Int32Array(h+g+this.keys.length+this.bboxes.length);w[0]=this.extent,w[1]=this.n,w[2]=this.padding;for(var j=h,N=0;N<o.length;N++){var O=o[N];w[c+N]=j,w.set(O,j),j+=O.length}return w[c+o.length]=j,w.set(this.keys,j),w[c+o.length+1]=j+=this.keys.length,w.set(this.bboxes,j),j+=this.bboxes.length,w.buffer},Mf}(),Pf=Is(td);const Ma={};function mn(c,i,o={}){Object.defineProperty(c,"_classRegistryKey",{value:i,writable:!1}),Ma[i]={klass:c,omit:o.omit||[]}}mn(Object,"Object"),Pf.serialize=function(c,i){const o=c.toArrayBuffer();return i&&i.add(o),{buffer:o}},Pf.deserialize=function(c){return new Pf(c.buffer)},Object.defineProperty(Pf,"name",{value:"Grid"}),mn(Pf,"Grid"),typeof DOMMatrix<"u"&&mn(DOMMatrix,"DOMMatrix"),mn(Kr,"Color"),mn(Error,"Error"),mn(Rs,"Formatted"),mn(Xm,"FormattedSection"),mn(fp,"AJAXError"),mn(Js,"ResolvedImage"),mn(Rc,"StylePropertyFunction"),mn(Bp,"StyleExpression",{omit:["_evaluator"]}),mn(Ro,"ImageId"),mn(El,"ImageVariant"),mn(ja,"ZoomDependentExpression"),mn(Gi,"ZoomConstantExpression"),mn(ds,"CompoundExpression",{omit:["_evaluate"]});for(const c in Oc)Ma[Oc[c]._classRegistryKey]||mn(Oc[c],`Expression${c}`);function vh(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function nd(c){return self.ImageBitmap&&c instanceof ImageBitmap}function hu(c,i){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(vh(c)||nd(c))return i&&i.add(c),c;if(ArrayBuffer.isView(c))return i&&i.add(c.buffer),c;if(c instanceof ImageData)return i&&i.add(c.data.buffer),c;if(Array.isArray(c)){const o=[];for(const h of c)o.push(hu(h,i));return o}if(c instanceof Map){const o={$name:"Map",entries:[]};for(const[h,g]of c.entries())o.entries.push(hu(h),hu(g,i));return o}if(c instanceof Set){const o={$name:"Set"};let h=0;for(const g of c.values())o[++h]=hu(g);return o}if(c instanceof DOMMatrix){const o={$name:"DOMMatrix"},h=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const g of h)o[g]=c[g];return o}if(typeof c=="bigint")return{$name:"BigInt",value:c.toString()};if(typeof c=="object"){const o=c.constructor,h=o._classRegistryKey;if(!h)throw new Error(`Can't serialize object of unregistered class "${o.name}".`);const g=o.serialize?o.serialize(c,i):{};if(!o.serialize){for(const _ in c)c.hasOwnProperty(_)&&(Ma[h].omit.indexOf(_)>=0||(g[_]=hu(c[_],i)));c instanceof Error&&(g.message=c.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(g.$name=h),g}throw new Error("can't serialize object of type "+typeof c)}function rd(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||vh(c)||nd(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(rd);if(typeof c=="object"){const i=c.$name||"Object";if(i==="Map"){const g=c.entries||[],_=new Map;for(let w=0;w<g.length;w+=2)_.set(rd(g[w]),rd(g[w+1]));return _}if(i==="Set"){const g=new Set;for(const _ of Object.keys(c))_!=="$name"&&g.add(rd(c[_]));return g}if(i==="DOMMatrix"){let g;return g=c.is2D?[c.a,c.b,c.c,c.d,c.e,c.f]:[c.m11,c.m12,c.m13,c.m14,c.m21,c.m22,c.m23,c.m24,c.m31,c.m32,c.m33,c.m34,c.m41,c.m42,c.m43,c.m44],new DOMMatrix(g)}if(i==="BigInt")return BigInt(c.value);const{klass:o}=Ma[i];if(!o)throw new Error(`Can't deserialize unregistered class "${i}".`);if(o.deserialize)return o.deserialize(c);const h=Object.create(o.prototype);for(const g of Object.keys(c))g!=="$name"&&(h[g]=rd(c[g]));return h}throw new Error("can't deserialize object of type "+typeof c)}const Un={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519,Osage:c=>c>=66736&&c<=66815,"CJK Unified Ideographs Extension B":c=>c>=131072&&c<=173791};function Vp(c){for(const i of c)if(Ra(i.charCodeAt(0)))return!0;return!1}function zx(c){for(const i of c)if(!So(i.charCodeAt(0)))return!1;return!0}function So(c){return!(Un.Arabic(c)||Un["Arabic Supplement"](c)||Un["Arabic Extended-A"](c)||Un["Arabic Presentation Forms-A"](c)||Un["Arabic Presentation Forms-B"](c))}function Ra(c){return!(c!==746&&c!==747&&(c<4352||!(Un["Bopomofo Extended"](c)||Un.Bopomofo(c)||Un["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||Un["CJK Compatibility Ideographs"](c)||Un["CJK Compatibility"](c)||Un["CJK Radicals Supplement"](c)||Un["CJK Strokes"](c)||!(!Un["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||Un["CJK Unified Ideographs Extension A"](c)||Un["CJK Unified Ideographs"](c)||Un["Enclosed CJK Letters and Months"](c)||Un["Hangul Compatibility Jamo"](c)||Un["Hangul Jamo Extended-A"](c)||Un["Hangul Jamo Extended-B"](c)||Un["Hangul Jamo"](c)||Un["Hangul Syllables"](c)||Un.Hiragana(c)||Un["Ideographic Description Characters"](c)||Un.Kanbun(c)||Un["Kangxi Radicals"](c)||Un["Katakana Phonetic Extensions"](c)||Un.Katakana(c)&&c!==12540||!(!Un["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!Un["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||Un["Unified Canadian Aboriginal Syllabics"](c)||Un["Unified Canadian Aboriginal Syllabics Extended"](c)||Un["Vertical Forms"](c)||Un["Yijing Hexagram Symbols"](c)||Un["Yi Syllables"](c)||Un["Yi Radicals"](c))))}function cg(c){return!(Ra(c)||function(i){return!!(Un["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||Un["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||Un["Letterlike Symbols"](i)||Un["Number Forms"](i)||Un["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||Un["Control Pictures"](i)&&i!==9251||Un["Optical Character Recognition"](i)||Un["Enclosed Alphanumerics"](i)||Un["Geometric Shapes"](i)||Un["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||Un["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||Un["CJK Symbols and Punctuation"](i)||Un.Katakana(i)||Un["Private Use Area"](i)||Un["CJK Compatibility Forms"](i)||Un["Small Form Variants"](i)||Un["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(c))}function Up(c){return Un.Arabic(c)||Un["Arabic Supplement"](c)||Un["Arabic Extended-A"](c)||Un["Arabic Presentation Forms-A"](c)||Un["Arabic Presentation Forms-B"](c)}function $p(c){return c>=1424&&c<=2303||Un["Arabic Presentation Forms-A"](c)||Un["Arabic Presentation Forms-B"](c)}function Lx(c,i){return!(!i&&$p(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||Un.Khmer(c))}function fu(c){for(const i of c)if($p(i.charCodeAt(0)))return!0;return!1}const Nf="deferred",qp="loading",Hp="loaded";let ug=null,To="unavailable",pu=null;const id=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(To="error"),ug&&ug(c)};function Gp(){Wp.fire(new Mc("pluginStateChange",{pluginStatus:To,pluginURL:pu}))}const Wp=new $u,ad=function(){return To},Fx=function(){if(To!==Nf||!pu)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");To=qp,Gp(),pu&&Vu({url:pu},c=>{c?id(c):(To=Hp,Gp())})},Pl={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>To===Hp||Pl.applyArabicShaping!=null,isLoading:()=>To===qp,setState(c){To=c.pluginStatus,pu=c.pluginURL},isParsed:()=>Pl.applyArabicShaping!=null&&Pl.processBidirectionalText!=null&&Pl.processStyledBidirectionalText!=null,getPluginURL:()=>pu};class ui{constructor(i,o){this.zoom=i,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.transition=o.transition,this.pitch=o.pitch,this.brightness=o.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(i){return function(o,h){for(const g of o)if(!Lx(g.charCodeAt(0),h))return!1;return!0}(i,Pl.isLoaded())}}class Df{constructor(i,o,h,g){this.property=i,this.value=o,this.expression=function(_,w,j,N){if(Yu(_))return new Rc(_,w);if(dc(_)||Array.isArray(_)&&_.length>0){const O=Ju(_,w,j,N);if(O.result==="error")throw new Error(O.value.map(L=>`${L.key}: ${L.message}`).join(", "));return O.value}{let O=_;return typeof _=="string"&&w.type==="color"&&(O=Kr.parse(_)),{kind:"constant",configDependencies:new Set,evaluate:()=>O}}}(o===void 0?i.specification.default:o,i.specification,h,g)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(i,o,h){return this.property.possiblyEvaluate(this,i,o,h)}}class mu{constructor(i,o,h){this.property=i,this.value=new Df(i,void 0,o,h)}transitioned(i,o){return new Bx(this.property,this.value,o,Xe({},i.transition,this.transition),i.now)}untransitioned(){return new Bx(this.property,this.value,null,{},0)}}class dg{constructor(i,o,h){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues),this._scope=o,this._options=h,this.configDependencies=new Set}getValue(i){return cr(this._values[i].value.value)}setValue(i,o){this._values.hasOwnProperty(i)||(this._values[i]=new mu(this._values[i].property,this._scope,this._options)),this._values[i].value=new Df(this._values[i].property,o===null?void 0:cr(o),this._scope,this._options),this._values[i].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[i].value.expression.configDependencies]))}setTransitionOrValue(i,o){o&&(this._options=o);const h=this._properties.properties;if(i)for(const g in i){const _=i[g];if(g.endsWith("-transition")){const w=g.slice(0,-11);h[w]&&this.setTransition(w,_)}else h.hasOwnProperty(g)&&this.setValue(g,_)}}getTransition(i){return cr(this._values[i].transition)}setTransition(i,o){this._values.hasOwnProperty(i)||(this._values[i]=new mu(this._values[i].property)),this._values[i].transition=cr(o)||void 0}serialize(){const i={};for(const o of Object.keys(this._values)){const h=this.getValue(o);h!==void 0&&(i[o]=h);const g=this.getTransition(o);g!==void 0&&(i[`${o}-transition`]=g)}return i}transitioned(i,o){const h=new Vx(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].transitioned(i,o._values[g]);return h}untransitioned(){const i=new Vx(this._properties);for(const o of Object.keys(this._values))i._values[o]=this._values[o].untransitioned();return i}}class Bx{constructor(i,o,h,g,_){const w=g.delay||0,j=g.duration||0;_=_||0,this.property=i,this.value=o,this.begin=_+w,this.end=this.begin+j,i.specification.transition&&(g.delay||g.duration)&&(this.prior=h)}possiblyEvaluate(i,o,h){const g=i.now||0,_=this.value.possiblyEvaluate(i,o,h),w=this.prior;if(w){if(g>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(g<this.begin)return w.possiblyEvaluate(i,o,h);{const j=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(i,o,h),_,Me(j))}}return _}}class Vx{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,o,h){const g=new sd(this._properties);for(const _ of Object.keys(this._values))g._values[_]=this._values[_].possiblyEvaluate(i,o,h);return g}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class By{constructor(i,o,h){this._properties=i,this._values=Object.create(i.defaultPropertyValues),this._scope=o,this._options=h,this.configDependencies=new Set}getValue(i){return cr(this._values[i].value)}setValue(i,o){this._values[i]=new Df(this._values[i].property,o===null?void 0:cr(o),this._scope,this._options),this._values[i].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[i].expression.configDependencies]))}serialize(){const i={};for(const o of Object.keys(this._values)){const h=this.getValue(o);h!==void 0&&(i[o]=h)}return i}possiblyEvaluate(i,o,h){const g=new sd(this._properties);for(const _ of Object.keys(this._values))g._values[_]=this._values[_].possiblyEvaluate(i,o,h);return g}}class _h{constructor(i,o,h){this.property=i,this.value=o,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,o,h,g){return this.property.evaluate(this.value,this.parameters,i,o,h,g)}}class sd{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class Xt{constructor(i){this.specification=i}possiblyEvaluate(i,o){return i.expression.evaluate(o)}interpolate(i,o,h){const g=xp[this.specification.type];return g?g(i,o,h):i}}class fn{constructor(i,o){this.specification=i,this.overrides=o}possiblyEvaluate(i,o,h,g){return new _h(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(o,null,{},h,g)}:i.expression,o)}interpolate(i,o,h){if(i.value.kind!=="constant"||o.value.kind!=="constant")return i;if(i.value.value===void 0||o.value.value===void 0)return new _h(this,{kind:"constant",value:void 0},i.parameters);const g=xp[this.specification.type];return g?new _h(this,{kind:"constant",value:g(i.value.value,o.value.value,h)},i.parameters):i}evaluate(i,o,h,g,_,w){return i.kind==="constant"?i.value:i.evaluate(o,h,g,_,w)}}class Nl{constructor(i){this.specification=i}possiblyEvaluate(i,o,h,g){return!!i.expression.evaluate(o,null,{},h,g)}interpolate(){return!1}}class Yi{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const o=new ui(0,{});for(const h in i){const g=i[h];g.specification.overridable&&this.overridableProperties.push(h);const _=this.defaultPropertyValues[h]=new Df(g,void 0),w=this.defaultTransitionablePropertyValues[h]=new mu(g);this.defaultTransitioningPropertyValues[h]=w.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=_.possiblyEvaluate(o)}}}mn(fn,"DataDrivenProperty"),mn(Xt,"DataConstantProperty"),mn(Nl,"ColorRampProperty");var rt=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","expression":{}},"buildingFeaturesetId":{"type":"string","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"transition":true},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"transition":true},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-wall-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"transition":true},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white"},"sky-atmosphere-color":{"type":"color","default":"white"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function $o(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function od(c){if(Array.isArray(c))return c.map(od);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const i={};for(const o in c)i[o]=od(c[o]);return i}return $o(c)}function Zp(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const i of c.slice(1))if(!Zp(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}function hg(c,i="",o=null,h="fill"){if(c==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Zp(c)||(c=Xp(c));const g=c;let _=!0;try{_=function(L){if(!bh(L))return L;let B=od(L);return $x(B),B=Ux(B),B}(g)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(g,null,2)}
        `)}let w=null,j=null;if(h!=="background"&&h!=="sky"&&h!=="slot"){j=rt[`filter_${h}`];const L=si(_,j,i,o);if(L.result==="error")throw new Error(L.value.map(B=>`${B.key}: ${B.message}`).join(", "));w=(B,q,Y)=>L.value.evaluate(B,q,{},Y)}let N=null,O=null;if(_!==g){const L=si(g,j,i,o);if(L.result==="error")throw new Error(L.value.map(B=>`${B.key}: ${B.message}`).join(", "));N=(B,q,Y,Q,re)=>L.value.evaluate(B,q,{},Y,void 0,void 0,Q,re),O=!hh(L.value.expression)}return{filter:w,dynamicFilter:N||void 0,needGeometry:Hx(_),needFeature:!!O}}function Ux(c){if(!Array.isArray(c))return c;const i=function(o){if(Vy.has(o[0])){for(let h=1;h<o.length;h++)if(bh(o[h]))return!0}return o}(c);return i===!0?i:i.map(o=>Ux(o))}function $x(c){let i=!1;const o=[];if(c[0]==="case"){for(let h=1;h<c.length-1;h+=2)i=i||bh(c[h]),o.push(c[h+1]);o.push(c[c.length-1])}else if(c[0]==="match"){i=i||bh(c[1]);for(let h=2;h<c.length-1;h+=2)o.push(c[h+1]);o.push(c[c.length-1])}else if(c[0]==="step"){i=i||bh(c[1]);for(let h=1;h<c.length-1;h+=2)o.push(c[h+1])}i&&(c.length=0,c.push("any",...o));for(let h=1;h<c.length;h++)$x(c[h])}function bh(c){if(!Array.isArray(c))return!1;if((i=c[0])==="pitch"||i==="distance-from-center")return!0;var i;for(let o=1;o<c.length;o++)if(bh(c[o]))return!0;return!1}const Vy=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function qx(c,i){return c<i?-1:c>i?1:0}function Hx(c){if(!Array.isArray(c))return!1;if(c[0]==="within"||c[0]==="distance")return!0;for(let i=1;i<c.length;i++)if(Hx(c[i]))return!0;return!1}function Xp(c){if(!c)return!0;const i=c[0];return c.length<=1?i!=="any":i==="=="?Kp(c[1],c[2],"=="):i==="!="?pg(Kp(c[1],c[2],"==")):i==="<"||i===">"||i==="<="||i===">="?Kp(c[1],c[2],i):i==="any"?(o=c.slice(1),["any"].concat(o.map(Xp))):i==="all"?["all"].concat(c.slice(1).map(Xp)):i==="none"?["all"].concat(c.slice(1).map(Xp).map(pg)):i==="in"?fg(c[1],c.slice(2)):i==="!in"?pg(fg(c[1],c.slice(2))):i==="has"?Gx(c[1]):i!=="!has"||pg(Gx(c[1]));var o}function Kp(c,i,o){switch(c){case"$type":return[`filter-type-${o}`,i];case"$id":return[`filter-id-${o}`,i];default:return[`filter-${o}`,c,i]}}function fg(c,i){if(i.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(o=>typeof o!=typeof i[0])?["filter-in-large",c,["literal",i.sort(qx)]]:["filter-in-small",c,["literal",i]]}}function Gx(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function pg(c){return["!",c]}const wh="";function ld(c,i){return i?`${c}${wh}${i}`:c}const mg="-transition",Lc=new Set(["fill","line","background","hillshade","raster"]);class Ls extends $u{constructor(i,o,h,g,_){if(super(),this.id=i.id,this.fqid=ld(this.id,h),this.type=i.type,this.scope=h,this.lut=g,this.options=_,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,i.type!=="custom"){if(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type&&i.type!=="background"&&i.type!=="sky"&&i.type!=="slot"){this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter;const w=si(this.filter,rt[`filter_${i.type}`]);w.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...w.value.configDependencies]))}if(i.slot&&(this.slot=i.slot),o.layout&&(this._unevaluatedLayout=new By(o.layout,this.scope,_),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),o.paint){this._transitionablePaint=new dg(o.paint,this.scope,_);for(const w in i.paint)this.setPaintProperty(w,i.paint[w]);for(const w in i.layout)this.setLayoutProperty(w,i.layout[w]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new sd(o.paint)}}}onAdd(i){}onRemove(i){}isDraped(i){return!this.is3D(!0)&&Lc.has(this.type)}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,o){if(this.type==="custom"&&i==="visibility")return void(this.visibility=o);const h=this._unevaluatedLayout;h._properties.properties[i]&&(h.setValue(i,o),this.configDependencies=new Set([...this.configDependencies,...h.configDependencies]),i==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(i){return i.endsWith(mg)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,o){const h=this._transitionablePaint,g=h._properties.properties;if(i.endsWith(mg)){const B=i.slice(0,-11);return g[B]&&h.setTransition(B,o||void 0),!1}if(!g[i])return!1;const _=h._values[i],w=_.value.isDataDriven(),j=_.value;h.setValue(i,o),this.configDependencies=new Set([...this.configDependencies,...h.configDependencies]),this._handleSpecialPaintPropertyUpdate(i);const N=h._values[i].value,O=N.isDataDriven(),L=i.endsWith("pattern")||i==="line-dasharray";return O||w||L||this._handleOverridablePaintPropertyUpdate(i,j,N)}_handleSpecialPaintPropertyUpdate(i){}getProgramIds(){return null}getDefaultProgramParams(i,o,h){return null}_handleOverridablePaintPropertyUpdate(i,o,h){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,o){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,o)}serialize(){return Ln({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(i,o)=>!(i===void 0||o==="layout"&&!Object.keys(i).length||o==="paint"&&!Object.keys(i).length))}is3D(i){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const i in this.paint._values){const o=this.paint.get(i);if(o instanceof _h&&uc(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}compileFilter(i){this._filterCompiled||(this._featureFilter=hg(this.filter,this.scope,i),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(i){this._stats&&(i.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(i){}queryIntersectsFeature(i,o,h,g,_,w,j,N,O){}}const Uy={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Yp{constructor(i,o){this._structArray=i,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Bi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,o){return i._trim(),o&&(i.isTransferred=!0,o.add(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const o=Object.create(this.prototype);return o.arrayBuffer=i.arrayBuffer,o.length=i.length,o.capacity=i.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...i){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...i){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Vr(c,i=1){let o=0,h=0;return{members:c.map(g=>{const _=Uy[g.type].BYTES_PER_ELEMENT,w=o=Sh(o,Math.max(i,_)),j=g.components||1;return h=Math.max(h,_),o+=_*j,{name:g.name,type:g.type,components:j,offset:w}}),size:Sh(o,Math.max(h,i)),alignment:i}}function Sh(c,i){return Math.ceil(c/i)*i}class hc extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o){const h=this.length;return this.resize(h+1),this.emplace(h,i,o)}emplace(i,o,h){const g=2*i;return this.int16[g+0]=o,this.int16[g+1]=h,i}}hc.prototype.bytesPerElement=4,mn(hc,"StructArrayLayout2i4");class Th extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,h){const g=this.length;return this.resize(g+1),this.emplace(g,i,o,h)}emplace(i,o,h,g){const _=3*i;return this.int16[_+0]=o,this.int16[_+1]=h,this.int16[_+2]=g,i}}Th.prototype.bytesPerElement=6,mn(Th,"StructArrayLayout3i6");class cd extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,h,g){const _=this.length;return this.resize(_+1),this.emplace(_,i,o,h,g)}emplace(i,o,h,g,_){const w=4*i;return this.int16[w+0]=o,this.int16[w+1]=h,this.int16[w+2]=g,this.int16[w+3]=_,i}}cd.prototype.bytesPerElement=8,mn(cd,"StructArrayLayout4i8");class Eh extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.float32[1*i+0]=o,i}}Eh.prototype.bytesPerElement=4,mn(Eh,"StructArrayLayout1f4");class Ah extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,h){const g=this.length;return this.resize(g+1),this.emplace(g,i,o,h)}emplace(i,o,h,g){const _=4*i,w=2*i;return this.int16[_+0]=o,this.int16[_+1]=h,this.float32[w+1]=g,i}}Ah.prototype.bytesPerElement=8,mn(Ah,"StructArrayLayout2i1f8");class Ch extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,h){const g=this.length;return this.resize(g+1),this.emplace(g,i,o,h)}emplace(i,o,h,g){const _=4*i;return this.int16[_+0]=o,this.int16[_+1]=h,this.int16[_+2]=g,i}}Ch.prototype.bytesPerElement=8,mn(Ch,"StructArrayLayout3i8");class gg extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,h,g,_){const w=this.length;return this.resize(w+1),this.emplace(w,i,o,h,g,_)}emplace(i,o,h,g,_,w){const j=5*i;return this.int16[j+0]=o,this.int16[j+1]=h,this.int16[j+2]=g,this.int16[j+3]=_,this.int16[j+4]=w,i}}gg.prototype.bytesPerElement=10,mn(gg,"StructArrayLayout5i10");class Wx extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,h,g,_,w,j){const N=this.length;return this.resize(N+1),this.emplace(N,i,o,h,g,_,w,j)}emplace(i,o,h,g,_,w,j,N){const O=6*i,L=12*i,B=3*i;return this.int16[O+0]=o,this.int16[O+1]=h,this.uint8[L+4]=g,this.uint8[L+5]=_,this.uint8[L+6]=w,this.uint8[L+7]=j,this.float32[B+2]=N,i}}Wx.prototype.bytesPerElement=12,mn(Wx,"StructArrayLayout2i4ub1f12");class Eo extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,h){const g=this.length;return this.resize(g+1),this.emplace(g,i,o,h)}emplace(i,o,h,g){const _=3*i;return this.float32[_+0]=o,this.float32[_+1]=h,this.float32[_+2]=g,i}}Eo.prototype.bytesPerElement=12,mn(Eo,"StructArrayLayout3f12");class sl extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,h,g,_){const w=this.length;return this.resize(w+1),this.emplace(w,i,o,h,g,_)}emplace(i,o,h,g,_,w){const j=6*i,N=3*i;return this.uint16[j+0]=o,this.uint16[j+1]=h,this.uint16[j+2]=g,this.uint16[j+3]=_,this.float32[N+2]=w,i}}sl.prototype.bytesPerElement=12,mn(sl,"StructArrayLayout4ui1f12");class jh extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,h,g){const _=this.length;return this.resize(_+1),this.emplace(_,i,o,h,g)}emplace(i,o,h,g,_){const w=4*i;return this.uint16[w+0]=o,this.uint16[w+1]=h,this.uint16[w+2]=g,this.uint16[w+3]=_,i}}jh.prototype.bytesPerElement=8,mn(jh,"StructArrayLayout4ui8");class fc extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,h,g,_,w){const j=this.length;return this.resize(j+1),this.emplace(j,i,o,h,g,_,w)}emplace(i,o,h,g,_,w,j){const N=6*i;return this.int16[N+0]=o,this.int16[N+1]=h,this.int16[N+2]=g,this.int16[N+3]=_,this.int16[N+4]=w,this.int16[N+5]=j,i}}fc.prototype.bytesPerElement=12,mn(fc,"StructArrayLayout6i12");class gu extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,h,g,_,w,j,N,O,L,B,q){const Y=this.length;return this.resize(Y+1),this.emplace(Y,i,o,h,g,_,w,j,N,O,L,B,q)}emplace(i,o,h,g,_,w,j,N,O,L,B,q,Y){const Q=12*i;return this.int16[Q+0]=o,this.int16[Q+1]=h,this.int16[Q+2]=g,this.int16[Q+3]=_,this.uint16[Q+4]=w,this.uint16[Q+5]=j,this.uint16[Q+6]=N,this.uint16[Q+7]=O,this.int16[Q+8]=L,this.int16[Q+9]=B,this.int16[Q+10]=q,this.int16[Q+11]=Y,i}}gu.prototype.bytesPerElement=24,mn(gu,"StructArrayLayout4i4ui4i24");class no extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,h,g,_,w){const j=this.length;return this.resize(j+1),this.emplace(j,i,o,h,g,_,w)}emplace(i,o,h,g,_,w,j){const N=10*i,O=5*i;return this.int16[N+0]=o,this.int16[N+1]=h,this.int16[N+2]=g,this.float32[O+2]=_,this.float32[O+3]=w,this.float32[O+4]=j,i}}no.prototype.bytesPerElement=20,mn(no,"StructArrayLayout3i3f20");class pc extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,h,g){const _=this.length;return this.resize(_+1),this.emplace(_,i,o,h,g)}emplace(i,o,h,g,_){const w=4*i;return this.float32[w+0]=o,this.float32[w+1]=h,this.float32[w+2]=g,this.float32[w+3]=_,i}}pc.prototype.bytesPerElement=16,mn(pc,"StructArrayLayout4f16");class ud extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint32[1*i+0]=o,i}}ud.prototype.bytesPerElement=4,mn(ud,"StructArrayLayout1ul4");class xu extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o){const h=this.length;return this.resize(h+1),this.emplace(h,i,o)}emplace(i,o,h){const g=2*i;return this.uint16[g+0]=o,this.uint16[g+1]=h,i}}xu.prototype.bytesPerElement=4,mn(xu,"StructArrayLayout2ui4");class qo extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,h,g,_,w,j,N,O,L,B,q,Y){const Q=this.length;return this.resize(Q+1),this.emplace(Q,i,o,h,g,_,w,j,N,O,L,B,q,Y)}emplace(i,o,h,g,_,w,j,N,O,L,B,q,Y,Q){const re=20*i,he=10*i;return this.int16[re+0]=o,this.int16[re+1]=h,this.int16[re+2]=g,this.int16[re+3]=_,this.int16[re+4]=w,this.float32[he+3]=j,this.float32[he+4]=N,this.float32[he+5]=O,this.float32[he+6]=L,this.int16[re+14]=B,this.uint32[he+8]=q,this.uint16[re+18]=Y,this.uint16[re+19]=Q,i}}qo.prototype.bytesPerElement=40,mn(qo,"StructArrayLayout5i4f1i1ul2ui40");class ol extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,h,g,_,w,j){const N=this.length;return this.resize(N+1),this.emplace(N,i,o,h,g,_,w,j)}emplace(i,o,h,g,_,w,j,N){const O=8*i;return this.int16[O+0]=o,this.int16[O+1]=h,this.int16[O+2]=g,this.int16[O+4]=_,this.int16[O+5]=w,this.int16[O+6]=j,this.int16[O+7]=N,i}}ol.prototype.bytesPerElement=16,mn(ol,"StructArrayLayout3i2i2i16");class Dl extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,h,g,_){const w=this.length;return this.resize(w+1),this.emplace(w,i,o,h,g,_)}emplace(i,o,h,g,_,w){const j=4*i,N=8*i;return this.float32[j+0]=o,this.float32[j+1]=h,this.float32[j+2]=g,this.int16[N+6]=_,this.int16[N+7]=w,i}}Dl.prototype.bytesPerElement=16,mn(Dl,"StructArrayLayout2f1f2i16");class xg extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,h,g,_,w){const j=this.length;return this.resize(j+1),this.emplace(j,i,o,h,g,_,w)}emplace(i,o,h,g,_,w,j){const N=20*i,O=5*i;return this.uint8[N+0]=o,this.uint8[N+1]=h,this.float32[O+1]=g,this.float32[O+2]=_,this.float32[O+3]=w,this.float32[O+4]=j,i}}xg.prototype.bytesPerElement=20,mn(xg,"StructArrayLayout2ub4f20");class la extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,h){const g=this.length;return this.resize(g+1),this.emplace(g,i,o,h)}emplace(i,o,h,g){const _=3*i;return this.uint16[_+0]=o,this.uint16[_+1]=h,this.uint16[_+2]=g,i}}la.prototype.bytesPerElement=6,mn(la,"StructArrayLayout3ui6");class mc extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,o,h,g,_,w,j,N,O,L,B,q,Y,Q,re,he,pe,Se,be,oe,xe){const we=this.length;return this.resize(we+1),this.emplace(we,i,o,h,g,_,w,j,N,O,L,B,q,Y,Q,re,he,pe,Se,be,oe,xe)}emplace(i,o,h,g,_,w,j,N,O,L,B,q,Y,Q,re,he,pe,Se,be,oe,xe,we){const je=30*i,Ve=15*i,We=60*i;return this.int16[je+0]=o,this.int16[je+1]=h,this.int16[je+2]=g,this.float32[Ve+2]=_,this.float32[Ve+3]=w,this.uint16[je+8]=j,this.uint16[je+9]=N,this.uint32[Ve+5]=O,this.uint32[Ve+6]=L,this.uint32[Ve+7]=B,this.uint16[je+16]=q,this.uint16[je+17]=Y,this.uint16[je+18]=Q,this.float32[Ve+10]=re,this.float32[Ve+11]=he,this.uint8[We+48]=pe,this.uint8[We+49]=Se,this.uint8[We+50]=be,this.uint32[Ve+13]=oe,this.int16[je+28]=xe,this.uint8[We+58]=we,i}}mc.prototype.bytesPerElement=60,mn(mc,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Qa extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,o,h,g,_,w,j,N,O,L,B,q,Y,Q,re,he,pe,Se,be,oe,xe,we,je,Ve,We,Ze,Qe,pt,kt,Ct,Pt,Vt,ht){const Mt=this.length;return this.resize(Mt+1),this.emplace(Mt,i,o,h,g,_,w,j,N,O,L,B,q,Y,Q,re,he,pe,Se,be,oe,xe,we,je,Ve,We,Ze,Qe,pt,kt,Ct,Pt,Vt,ht)}emplace(i,o,h,g,_,w,j,N,O,L,B,q,Y,Q,re,he,pe,Se,be,oe,xe,we,je,Ve,We,Ze,Qe,pt,kt,Ct,Pt,Vt,ht,Mt){const dt=20*i,ft=40*i,$t=80*i;return this.float32[dt+0]=o,this.float32[dt+1]=h,this.int16[ft+4]=g,this.int16[ft+5]=_,this.int16[ft+6]=w,this.int16[ft+7]=j,this.int16[ft+8]=N,this.int16[ft+9]=O,this.int16[ft+10]=L,this.int16[ft+11]=B,this.int16[ft+12]=q,this.uint16[ft+13]=Y,this.uint16[ft+14]=Q,this.uint16[ft+15]=re,this.uint16[ft+16]=he,this.uint16[ft+17]=pe,this.uint16[ft+18]=Se,this.uint16[ft+19]=be,this.uint16[ft+20]=oe,this.uint16[ft+21]=xe,this.uint16[ft+22]=we,this.uint16[ft+23]=je,this.uint16[ft+24]=Ve,this.uint16[ft+25]=We,this.uint16[ft+26]=Ze,this.uint16[ft+27]=Qe,this.uint32[dt+14]=pt,this.float32[dt+15]=kt,this.float32[dt+16]=Ct,this.float32[dt+17]=Pt,this.float32[dt+18]=Vt,this.uint8[$t+76]=ht,this.uint16[ft+39]=Mt,i}}Qa.prototype.bytesPerElement=80,mn(Qa,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class gc extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,h,g,_){const w=this.length;return this.resize(w+1),this.emplace(w,i,o,h,g,_)}emplace(i,o,h,g,_,w){const j=5*i;return this.float32[j+0]=o,this.float32[j+1]=h,this.float32[j+2]=g,this.float32[j+3]=_,this.float32[j+4]=w,i}}gc.prototype.bytesPerElement=20,mn(gc,"StructArrayLayout5f20");class Mh extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,h,g,_,w,j){const N=this.length;return this.resize(N+1),this.emplace(N,i,o,h,g,_,w,j)}emplace(i,o,h,g,_,w,j,N){const O=7*i;return this.float32[O+0]=o,this.float32[O+1]=h,this.float32[O+2]=g,this.float32[O+3]=_,this.float32[O+4]=w,this.float32[O+5]=j,this.float32[O+6]=N,i}}Mh.prototype.bytesPerElement=28,mn(Mh,"StructArrayLayout7f28");class Qp extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,h,g,_,w,j,N,O,L,B){const q=this.length;return this.resize(q+1),this.emplace(q,i,o,h,g,_,w,j,N,O,L,B)}emplace(i,o,h,g,_,w,j,N,O,L,B,q){const Y=11*i;return this.float32[Y+0]=o,this.float32[Y+1]=h,this.float32[Y+2]=g,this.float32[Y+3]=_,this.float32[Y+4]=w,this.float32[Y+5]=j,this.float32[Y+6]=N,this.float32[Y+7]=O,this.float32[Y+8]=L,this.float32[Y+9]=B,this.float32[Y+10]=q,i}}Qp.prototype.bytesPerElement=44,mn(Qp,"StructArrayLayout11f44");class Jp extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,h,g,_,w,j,N,O){const L=this.length;return this.resize(L+1),this.emplace(L,i,o,h,g,_,w,j,N,O)}emplace(i,o,h,g,_,w,j,N,O,L){const B=9*i;return this.float32[B+0]=o,this.float32[B+1]=h,this.float32[B+2]=g,this.float32[B+3]=_,this.float32[B+4]=w,this.float32[B+5]=j,this.float32[B+6]=N,this.float32[B+7]=O,this.float32[B+8]=L,i}}Jp.prototype.bytesPerElement=36,mn(Jp,"StructArrayLayout9f36");class dd extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o){const h=this.length;return this.resize(h+1),this.emplace(h,i,o)}emplace(i,o,h){const g=2*i;return this.float32[g+0]=o,this.float32[g+1]=h,i}}dd.prototype.bytesPerElement=8,mn(dd,"StructArrayLayout2f8");class yu extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,h,g){const _=this.length;return this.resize(_+1),this.emplace(_,i,o,h,g)}emplace(i,o,h,g,_){const w=6*i;return this.uint32[3*i+0]=o,this.uint16[w+2]=h,this.uint16[w+3]=g,this.uint16[w+4]=_,i}}yu.prototype.bytesPerElement=12,mn(yu,"StructArrayLayout1ul3ui12");class hd extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint16[1*i+0]=o,i}}hd.prototype.bytesPerElement=2,mn(hd,"StructArrayLayout1ui2");class Ph extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,h,g,_,w,j,N,O,L,B,q,Y,Q,re,he){const pe=this.length;return this.resize(pe+1),this.emplace(pe,i,o,h,g,_,w,j,N,O,L,B,q,Y,Q,re,he)}emplace(i,o,h,g,_,w,j,N,O,L,B,q,Y,Q,re,he,pe){const Se=16*i;return this.float32[Se+0]=o,this.float32[Se+1]=h,this.float32[Se+2]=g,this.float32[Se+3]=_,this.float32[Se+4]=w,this.float32[Se+5]=j,this.float32[Se+6]=N,this.float32[Se+7]=O,this.float32[Se+8]=L,this.float32[Se+9]=B,this.float32[Se+10]=q,this.float32[Se+11]=Y,this.float32[Se+12]=Q,this.float32[Se+13]=re,this.float32[Se+14]=he,this.float32[Se+15]=pe,i}}Ph.prototype.bytesPerElement=64,mn(Ph,"StructArrayLayout16f64");class Of extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,h,g,_,w,j){const N=this.length;return this.resize(N+1),this.emplace(N,i,o,h,g,_,w,j)}emplace(i,o,h,g,_,w,j,N){const O=10*i,L=5*i;return this.uint16[O+0]=o,this.uint16[O+1]=h,this.uint16[O+2]=g,this.uint16[O+3]=_,this.float32[L+2]=w,this.float32[L+3]=j,this.float32[L+4]=N,i}}Of.prototype.bytesPerElement=20,mn(Of,"StructArrayLayout4ui3f20");class yg extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.int16[1*i+0]=o,i}}yg.prototype.bytesPerElement=2,mn(yg,"StructArrayLayout1i2");class Nh extends Bi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint8[1*i+0]=o,i}}Nh.prototype.bytesPerElement=1,mn(Nh,"StructArrayLayout1ub1");class Zx extends Yp{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Zx.prototype.size=40;class If extends qo{get(i){return new Zx(this,i)}}mn(If,"CollisionBoxArray");class Xx extends Yp{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(i){this._structArray.uint8[this._pos1+49]=i}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(i){this._structArray.uint8[this._pos1+50]=i}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(i){this._structArray.uint32[this._pos4+13]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(i){this._structArray.uint8[this._pos1+58]=i}}Xx.prototype.size=60;class Kx extends mc{get(i){return new Xx(this,i)}}mn(Kx,"PlacedSymbolArray");class $y extends Yp{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(i){this._structArray.uint32[this._pos4+14]=i}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(i){this._structArray.float32[this._pos4+18]=i}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}$y.prototype.size=80;class Yx extends Qa{get(i){return new $y(this,i)}}mn(Yx,"SymbolInstanceArray");class is extends Eh{getoffsetX(i){return this.float32[1*i+0]}}mn(is,"GlyphOffsetArray");class Ss extends hc{getx(i){return this.int16[2*i+0]}gety(i){return this.int16[2*i+1]}}mn(Ss,"SymbolLineVertexArray");class Qx extends Yp{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Qx.prototype.size=12;class Jx extends yu{get(i){return new Qx(this,i)}}mn(Jx,"FeatureIndexArray");class e0 extends xu{geta_centroid_pos0(i){return this.uint16[2*i+0]}geta_centroid_pos1(i){return this.uint16[2*i+1]}}mn(e0,"FillExtrusionCentroidArray");class t0 extends Yp{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}t0.prototype.size=6;class n0 extends Th{get(i){return new t0(this,i)}}mn(n0,"FillExtrusionWallArray");const vg=Vr([{name:"a_pos",components:2,type:"Int16"}],4),r0=Vr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Wi{constructor(i=[]){this.segments=i}_prepareSegment(i,o,h,g){let _=this.segments[this.segments.length-1];return i>Wi.MAX_VERTEX_ARRAY_LENGTH&&or(`Max vertices per segment is ${Wi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!_||_.vertexLength+i>Wi.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==g)&&(_={vertexOffset:o,primitiveOffset:h,vertexLength:0,primitiveLength:0},g!==void 0&&(_.sortKey=g),this.segments.push(_)),_}prepareSegment(i,o,h,g){return this._prepareSegment(i,o.length,h.length,g)}get(){return this.segments}destroy(){for(const i of this.segments)for(const o in i.vaos)i.vaos[o].destroy()}static simpleSegment(i,o,h,g){return new Wi([{vertexOffset:i,primitiveOffset:o,vertexLength:h,primitiveLength:g,vaos:{},sortKey:0}])}}function i0(c,i){return 256*(c=Le(Math.floor(c),0,255))+Le(Math.floor(i),0,255)}Wi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,mn(Wi,"SegmentVector");const qy=Vr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),fd=Vr([{name:"a_pattern_b",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),a0=Vr([{name:"a_dash",components:4,type:"Uint16"}]);class pd{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(i,o,h,g){this.ids.push(s0(i)),this.positions.push(o,h,g)}eachPosition(i,o){const h=s0(i);let g=0,_=this.ids.length-1;for(;g<_;){const w=g+_>>1;this.ids[w]>=h?_=w:g=w+1}for(;this.ids[g]===h;)o(this.positions[3*g],this.positions[3*g+1],this.positions[3*g+2]),g++}static serialize(i,o){const h=new Float64Array(i.ids),g=new Uint32Array(i.positions);return kf(h,g,0,h.length-1),o&&(o.add(h.buffer),o.add(g.buffer)),{ids:h,positions:g}}static deserialize(i){const o=new pd;let h;o.ids=i.ids,o.positions=i.positions;for(const g of o.ids)g!==h&&o.uniqueIds.push(g),h=g;return o.indexed=!0,o}}function s0(c){const i=+c;return!isNaN(i)&&Number.MIN_SAFE_INTEGER<=i&&i<=Number.MAX_SAFE_INTEGER?i:ko(String(c))}function kf(c,i,o,h){for(;o<h;){const g=c[o+h>>1];let _=o-1,w=h+1;for(;;){do _++;while(c[_]<g);do w--;while(c[w]>g);if(_>=w)break;md(c,_,w),md(i,3*_,3*w),md(i,3*_+1,3*w+1),md(i,3*_+2,3*w+2)}w-o<h-w?(kf(c,i,o,w),o=w+1):(kf(c,i,w+1,h),h=w)}}function md(c,i,o){const h=c[i];c[i]=c[o],c[o]=h}mn(pd,"FeaturePositionMap");class Ol{constructor(i){this.gl=i.gl,this.initialized=!1}fetchUniformLocation(i,o){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(i,o),this.initialized=!0),!!this.location}set(i,o,h){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class em extends Ol{constructor(i){super(i),this.current=0}set(i,o,h){this.fetchUniformLocation(i,o)&&this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}}class ca extends Ol{constructor(i){super(i),this.current=0}set(i,o,h){this.fetchUniformLocation(i,o)&&this.current!==h&&(this.current=h,this.gl.uniform1f(this.location,h))}}class Il extends Ol{constructor(i){super(i),this.current=[0,0]}set(i,o,h){this.fetchUniformLocation(i,o)&&(h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1])))}}class ll extends Ol{constructor(i){super(i),this.current=[0,0,0]}set(i,o,h){this.fetchUniformLocation(i,o)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2])))}}class Rf extends Ol{constructor(i){super(i),this.current=[0,0,0,0]}set(i,o,h){this.fetchUniformLocation(i,o)&&(h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]&&h[3]===this.current[3]||(this.current=h,this.gl.uniform4f(this.location,h[0],h[1],h[2],h[3])))}}class Hy extends Ol{constructor(i){super(i),this.current=Kr.transparent.toRenderColor(null)}set(i,o,h){this.fetchUniformLocation(i,o)&&(h.r===this.current.r&&h.g===this.current.g&&h.b===this.current.b&&h.a===this.current.a||(this.current=h,this.gl.uniform4f(this.location,h.r,h.g,h.b,h.a)))}}const Gy=new Float32Array(16);class cl extends Ol{constructor(i){super(i),this.current=Gy}set(i,o,h){if(this.fetchUniformLocation(i,o)){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let g=1;g<16;g++)if(h[g]!==this.current[g]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}}}const o0=new Float32Array(9),zf=new Float32Array(4);class ro extends Ol{constructor(i){super(i),this.current=zf}set(i,o,h){if(this.fetchUniformLocation(i,o)){for(let g=0;g<4;g++)if(h[g]!==this.current[g]){this.current=h,this.gl.uniformMatrix2fv(this.location,!1,h);break}}}}function ga(c){return[i0(255*c.r,255*c.g),i0(255*c.b,255*c.a)]}class tm{constructor(i,o,h,g){this.value=i,this.uniformNames=o.map(_=>`u_${_}`),this.type=h,this.context=g}setUniform(i,o,h,g,_){const w=g.constantOr(this.value);o.set(i,_,w instanceof Kr?w.toRenderColor(this.lutExpression&&this.lutExpression.value==="none"?null:this.context.lut):w)}getBinding(i,o){return this.type==="color"?new Hy(i):new ca(i)}}class Lf{constructor(i,o){this.uniformNames=o.map(h=>`u_${h}`),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(i,o){this.pixelRatio=i.pixelRatio||1,this.pattern=i.tl.concat(i.br),this.patternTransition=o?o.tl.concat(o.br):this.pattern}setUniform(i,o,h,g,_){let w=null;_!=="u_pattern"&&_!=="u_dash"||(w=this.pattern),_==="u_pattern_b"&&(w=this.patternTransition),_==="u_pixel_ratio"&&(w=this.pixelRatio),w&&o.set(i,_,w)}getBinding(i,o){return o==="u_pattern"||o==="u_pattern_b"||o==="u_dash"?new Rf(i):new ca(i)}}class Fc{constructor(i,o,h,g){this.expression=i,this.type=h,this.maxValue=0,this.paintVertexAttributes=o.map(_=>({name:`a_${_}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(i,o,h,g,_,w,j){const N=this.paintVertexArray.length,O=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new ui(0,{brightness:w}),o,{},_,g,j):this.expression.kind==="constant"&&this.expression.value,L=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ui(0,{brightness:w}),o,{},_,g,j):this.lutExpression.value)==="none";this.paintVertexArray.resize(i),this._setPaintValue(N,i,O,L?null:this.context.lut)}updatePaintArray(i,o,h,g,_,w,j){const N=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:j},h,g,void 0,_):this.expression.kind==="constant"&&this.expression.value,O=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ui(0,{brightness:j}),h,g,void 0,_):this.lutExpression.value)==="none";this._setPaintValue(i,o,N,O?null:this.context.lut)}_setPaintValue(i,o,h,g){if(this.type==="color"){const _=ga(h.toRenderColor(g));for(let w=i;w<o;w++)this.paintVertexArray.emplace(w,_[0],_[1])}else{for(let _=i;_<o;_++)this.paintVertexArray.emplace(_,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ao{constructor(i,o,h,g,_,w){this.expression=i,this.uniformNames=o.map(j=>`u_${j}_t`),this.type=h,this.useIntegerZoom=g,this.context=_,this.maxValue=0,this.paintVertexAttributes=o.map(j=>({name:`a_${j}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(i,o,h,g,_,w,j){const N=this.expression.evaluate(new ui(this.context.zoom,{brightness:w}),o,{},_,g,j),O=this.expression.evaluate(new ui(this.context.zoom+1,{brightness:w}),o,{},_,g,j),L=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ui(0,{brightness:w}),o,{},_,g,j):this.lutExpression.value)==="none",B=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(B,i,N,O,L?null:this.context.lut)}updatePaintArray(i,o,h,g,_,w,j){const N=this.expression.evaluate({zoom:this.context.zoom,brightness:j},h,g,void 0,_),O=this.expression.evaluate({zoom:this.context.zoom+1,brightness:j},h,g,void 0,_),L=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ui(0,{brightness:j}),h,g,void 0,_):this.lutExpression.value)==="none";this._setPaintValue(i,o,N,O,L?null:this.context.lut)}_setPaintValue(i,o,h,g,_){if(this.type==="color"){const w=ga(h.toRenderColor(_)),j=ga(h.toRenderColor(_));for(let N=i;N<o;N++)this.paintVertexArray.emplace(N,w[0],w[1],j[0],j[1])}else{for(let w=i;w<o;w++)this.paintVertexArray.emplace(w,h,g);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(g))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,o,h,g,_){const w=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,j=Le(this.expression.interpolationFactor(w,this.context.zoom,this.context.zoom+1),0,1);o.set(i,_,j)}getBinding(i,o){return new ca(i)}}class Ts{constructor(i,o,h,g,_){this.expression=i,this.layerId=_,this.paintVertexAttributes=(h==="array"?a0:qy).members;for(let w=0;w<o.length;++w);this.paintVertexArray=new g,this.paintTransitionVertexArray=new sl}populatePaintArray(i,o,h,g){const _=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValues(_,i,o.patterns&&o.patterns[this.layerId],h)}updatePaintArray(i,o,h,g,_,w,j){this._setPaintValues(i,o,h.patterns&&h.patterns[this.layerId],w)}_setPaintValues(i,o,h,g){if(!g||!h)return;const _=g[h[0]],w=g[h[1]];if(_){if(_){const{tl:j,br:N,pixelRatio:O}=_;for(let L=i;L<o;L++)this.paintVertexArray.emplace(L,j[0],j[1],N[0],N[1],O)}if(w){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:j,br:N,pixelRatio:O}=w;for(let L=i;L<o;L++)this.paintTransitionVertexArray.emplace(L,j[0],j[1],N[0],N[1],O)}}}upload(i){const o=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,o)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=i.createVertexBuffer(this.paintTransitionVertexArray,fd.members,o))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class vu{constructor(i,o,h=()=>!0){this.binders={},this._buffers=[],this.context=o;const g=[];for(const _ in i.paint._values){const w=i.paint.get(_);if(_.endsWith("-use-theme")||!h(_)||!(w instanceof _h&&uc(w.property.specification)))continue;const j=s(_,i.type),N=w.value,O=w.property.specification.type,L=!!w.property.useIntegerZoom,B=_==="line-dasharray"||_.endsWith("pattern"),q=i.paint.get(`${_}-use-theme`),Y=_==="line-dasharray"&&i.layout.get("line-cap").value.kind!=="constant"||q&&q.value.kind!=="constant";if(N.kind!=="constant"||Y)if(N.kind==="source"||Y||B){const Q=S(_,O,"source");this.binders[_]=B?new Ts(N,j,O,Q,i.id):new Fc(N,j,O,Q),g.push(`/a_${_}`)}else{const Q=S(_,O,"composite");this.binders[_]=new Ao(N,j,O,L,o,Q),g.push(`/z_${_}`)}else this.binders[_]=B?new Lf(N.value,j):new tm(N.value,j,O,o),g.push(`/u_${_}`);q&&(this.binders[_].lutExpression=q.value)}this.cacheKey=g.sort().join("")}getMaxValue(i){const o=this.binders[i];return o instanceof Fc||o instanceof Ao?o.maxValue:0}populatePaintArrays(i,o,h,g,_,w,j){for(const N in this.binders){const O=this.binders[N];O.context=this.context,(O instanceof Fc||O instanceof Ao||O instanceof Ts)&&O.populatePaintArray(i,o,h,g,_,w,j)}}setConstantPatternPositions(i,o){for(const h in this.binders){const g=this.binders[h];g instanceof Lf&&g.setConstantPatternPositions(i,o)}}getPatternTransitionVertexBuffer(i){const o=this.binders[i];return o instanceof Ts?o.paintTransitionVertexBuffer:null}updatePaintArrays(i,o,h,g,_,w,j,N,O){let L=!1;const B=Object.keys(i),q=B.length!==0&&!N,Y=q?B:o.uniqueIds;this.context.lut=_.lut;for(const Q in this.binders){const re=this.binders[Q];if(re.context=this.context,(re instanceof Fc||re instanceof Ao||re instanceof Ts)&&re.expression&&re.expression.kind&&re.expression.kind!=="constant"&&(re.expression.isStateDependent===!0||re.expression.isLightConstant===!1)){const he=_.paint.get(Q);re.expression=he.value;for(const pe of Y){const Se=i[pe.toString()];o.eachPosition(pe,(be,oe,xe)=>{const we=g.feature(be);re.updatePaintArray(oe,xe,we,Se,w,j,O)})}if(!q)for(const pe of h.uniqueIds){const Se=i[pe.toString()];h.eachPosition(pe,(be,oe,xe)=>{const we=g.feature(be);re.updatePaintArray(oe,xe,we,Se,w,j,O)})}L=!0}}return L}defines(){const i=[];for(const o in this.binders){const h=this.binders[o];(h instanceof tm||h instanceof Lf)&&i.push(...h.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return i}getBinderAttributes(){const i=[];for(const o in this.binders){const h=this.binders[o];if(h instanceof Fc||h instanceof Ao||h instanceof Ts)for(let g=0;g<h.paintVertexAttributes.length;g++)i.push(h.paintVertexAttributes[g].name);if(h instanceof Ts)for(let g=0;g<fd.members.length;g++)i.push(fd.members[g].name)}return i}getBinderUniforms(){const i=[];for(const o in this.binders){const h=this.binders[o];if(h instanceof tm||h instanceof Lf||h instanceof Ao)for(const g of h.uniformNames)i.push(g)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i){const o=[];for(const h in this.binders){const g=this.binders[h];if(g instanceof tm||g instanceof Lf||g instanceof Ao)for(const _ of g.uniformNames)o.push({name:_,property:h,binding:g.getBinding(i,_)})}return o}setUniforms(i,o,h,g,_){for(const{name:w,property:j,binding:N}of h)this.binders[j].setUniform(i,N,_,g.get(j),w)}updatePaintBuffers(){this._buffers=[];for(const i in this.binders){const o=this.binders[i];(o instanceof Fc||o instanceof Ao||o instanceof Ts)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer),o instanceof Ts&&o.paintTransitionVertexBuffer&&this._buffers.push(o.paintTransitionVertexBuffer)}}upload(i){for(const o in this.binders){const h=this.binders[o];(h instanceof Fc||h instanceof Ao||h instanceof Ts)&&h.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const o=this.binders[i];(o instanceof Fc||o instanceof Ao||o instanceof Ts)&&o.destroy()}}}class gd{constructor(i,o,h=()=>!0){this.programConfigurations={};for(const g of i)this.programConfigurations[g.id]=new vu(g,o,h);this.needsUpload=!1,this._featureMap=new pd,this._featureMapWithoutIds=new pd,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(i,o,h,g,_,w,j,N){for(const O in this.programConfigurations)this.programConfigurations[O].populatePaintArrays(i,o,g,_,w,j,N);o.id!==void 0?this._featureMap.add(o.id,h,this._bufferOffset,i):(this._featureMapWithoutIds.add(this._idlessCounter,h,this._bufferOffset,i),this._idlessCounter+=1),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,o,h,g,_,w,j){for(const N of h)this.needsUpload=this.programConfigurations[N.id].updatePaintArrays(i,this._featureMap,this._featureMapWithoutIds,o,N,g,_,w,j||0)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}const x={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"]};function s(c,i){return x[c]||[c.replace(`${i}-`,"").replace(/-/g,"_")]}const u={"line-pattern":{source:sl,composite:sl},"fill-pattern":{source:sl,composite:sl},"fill-extrusion-pattern":{source:sl,composite:sl},"line-dasharray":{source:jh,composite:jh}},y={color:{source:dd,composite:pc},number:{source:Eh,composite:dd}};function S(c,i,o){const h=u[c];return h&&h[o]||y[i][o]}mn(tm,"ConstantBinder"),mn(Lf,"PatternConstantBinder"),mn(Fc,"SourceExpressionBinder"),mn(Ts,"PatternCompositeBinder"),mn(Ao,"CompositeExpressionBinder"),mn(vu,"ProgramConfiguration",{omit:["_buffers"]}),mn(gd,"ProgramConfigurationSet");const A=en/Math.PI/2,M=5,D=6,z=16383,U=64,H=[U,32,16],K=-A,X=A;function J(c,i,o,h=A){return o=te(o),[c*Math.sin(o)*h,-i*h,c*Math.cos(o)*h]}function de(c,i,o){return J(Math.cos(te(c)),Math.sin(te(c)),i,o)}const ce=63710088e-1,fe=2*Math.PI*ce;class ue{constructor(i,o){if(isNaN(i)||isNaN(o))throw new Error(`Invalid LngLat object: (${i}, ${o})`);if(this.lng=+i,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ue(Ye(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const o=Math.PI/180,h=this.lat*o,g=i.lat*o,_=Math.sin(h)*Math.sin(g)+Math.cos(h)*Math.cos(g)*Math.cos((i.lng-this.lng)*o);return ce*Math.acos(Math.min(_,1))}toBounds(i=0){const o=360*i/40075017,h=o/Math.cos(Math.PI/180*this.lat);return new ve({lng:this.lng-h,lat:this.lat-o},{lng:this.lng+h,lat:this.lat+o})}toEcef(i){return de(this.lat,this.lng,A+i*A/ce)}static convert(i){if(i instanceof ue)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new ue(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new ue(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class ve{constructor(i,o){if(i)if(o)this.setSouthWest(i).setNorthEast(o);else if(i.length===4){const h=i;this.setSouthWest([h[0],h[1]]).setNorthEast([h[2],h[3]])}else{const h=i;this.setSouthWest(h[0]).setNorthEast(h[1])}}setNorthEast(i){return this._ne=i instanceof ue?new ue(i.lng,i.lat):ue.convert(i),this}setSouthWest(i){return this._sw=i instanceof ue?new ue(i.lng,i.lat):ue.convert(i),this}extend(i){const o=this._sw,h=this._ne;let g,_;if(i instanceof ue)g=i,_=i;else{if(!(i instanceof ve))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(ve.convert(i)):this.extend(ue.convert(i)):typeof i=="object"&&i!==null&&i.hasOwnProperty("lat")&&(i.hasOwnProperty("lon")||i.hasOwnProperty("lng"))?this.extend(ue.convert(i)):this;if(g=i._sw,_=i._ne,!g||!_)return this}return o||h?(o.lng=Math.min(g.lng,o.lng),o.lat=Math.min(g.lat,o.lat),h.lng=Math.max(_.lng,h.lng),h.lat=Math.max(_.lat,h.lat)):(this._sw=new ue(g.lng,g.lat),this._ne=new ue(_.lng,_.lat)),this}getCenter(){return new ue((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ue(this.getWest(),this.getNorth())}getSouthEast(){return new ue(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:o,lat:h}=ue.convert(i);let g=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&g}static convert(i){if(i)return i instanceof ve?i:new ve(i)}}const Ee=0,Pe=25.5;function ze(c){return fe*Math.cos(c*Math.PI/180)}function Ie(c){return(180+c)/360}function Oe(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function Ce(c,i){return c/ze(i)}function Fe(c){return 360*c-180}function $e(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function st(c,i){return c*ze($e(i))}const et=85.051129;function _t(c){return Math.cos(te(Le(c,-85.051129,et)))}function xt(c,i){const o=Le(i,Ee,Pe),h=Math.pow(2,o);return _t(c)*fe/(512*h)}function Bt(c){return 1/Math.cos(c*Math.PI/180)}function Je(c,i=0){const o=Math.exp(Math.PI*(1-(c.y+i/en)/(1<<c.z)*2));return 80150034*o/(o*o+1)/en/(1<<c.z)}class lt{constructor(i,o,h=0){this.x=+i,this.y=+o,this.z=+h}static fromLngLat(i,o=0){const h=ue.convert(i);return new lt(Ie(h.lng),Oe(h.lat),Ce(o,h.lat))}toLngLat(){return new ue(Fe(this.x),$e(this.y))}toAltitude(){return st(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/fe*Bt($e(this.y))}}function Ke(c,i,o,h,g,_,w,j,N){const O=(i+h)/2,L=(o+g)/2,B=new Kt(O,L);j(B),function(q,Y,Q,re,he,pe){const Se=Q-he,be=re-pe;return Math.abs((re-Y)*Se-(Q-q)*be)/Math.hypot(Se,be)}(B.x,B.y,_.x,_.y,w.x,w.y)>=N?(Ke(c,i,o,O,L,_,B,j,N),Ke(c,O,L,h,g,B,w,j,N)):c.push(w)}function Et(c,i,o){let h=c[0],g=h.x,_=h.y;i(h);const w=[h];for(let j=1;j<c.length;j++){const N=c[j],{x:O,y:L}=N;i(N),Ke(w,g,_,O,L,h,N,i,o),g=O,_=L,h=N}return w}function ct(c,i,o,h){if(h(i,o)){const g=i.add(o)._mult(.5);ct(c,i,g,h),ct(c,g,o,h)}else c.push(o)}function Dt(c,i){let o=c[0];const h=[o];for(let g=1;g<c.length;g++){const _=c[g];ct(h,o,_,i),o=_}return h}const wt=Math.pow(2,14)-1,Ot=-wt-1;function zt(c,i){const o=Math.round(c.x*i),h=Math.round(c.y*i);return c.x=Le(o,Ot,wt),c.y=Le(h,Ot,wt),(o<c.x||o>c.x+1||h<c.y||h>c.y+1)&&or("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function yn(c,i,o){const h=c.loadGeometry(),g=c.extent,_=en/g;if(i&&o&&o.projection.isReprojectedInTileSpace){const w=1<<i.z,{scale:j,x:N,y:O,projection:L}=o,B=q=>{const Y=Fe((i.x+q.x/g)/w),Q=$e((i.y+q.y/g)/w),re=L.project(Y,Q);q.x=(re.x*j-N)*g,q.y=(re.y*j-O)*g};for(let q=0;q<h.length;q++)if(c.type!==1)h[q]=Et(h[q],B,1);else{const Y=[];for(const Q of h[q])Q.x<0||Q.x>=g||Q.y<0||Q.y>=g||(B(Q),Y.push(Q));h[q]=Y}}for(const w of h)for(const j of w)zt(j,_);return h}function Tn(c,i){return{type:c.type,id:c.id,properties:c.properties,geometry:i?yn(c):[]}}function gn(c,i,o,h,g){c.emplaceBack(2*i+(h+1)/2,2*o+(g+1)/2)}function Pn(c,i,o){c.emplaceBack(i.x,i.y,i.z,o[0]*16384,o[1]*16384,o[2]*16384)}class Sn{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=i.index,this.hasPattern=!1,this.projection=i.projection,this.layoutVertexArray=new hc,this.indexArray=new la,this.segments=new Wi,this.programConfigurations=new gd(i.layers,{zoom:i.zoom,lut:i.lut}),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}updateFootprints(i,o){}populate(i,o,h,g){const _=this.layers[0],w=[];let j=null;_.type==="circle"&&(j=_.layout.get("circle-sort-key"));for(const{feature:O,id:L,index:B,sourceLayerIndex:q}of i){const Y=this.layers[0]._featureFilter.needGeometry,Q=Tn(O,Y);if(!this.layers[0]._featureFilter.filter(new ui(this.zoom),Q,h))continue;const re=j?j.evaluate(Q,{},h):void 0,he={id:L,properties:O.properties,type:O.type,sourceLayerIndex:q,index:B,geometry:Y?Q.geometry:yn(O,h,g),patterns:{},sortKey:re};w.push(he)}j&&w.sort((O,L)=>O.sortKey-L.sortKey);let N=null;g.projection.name==="globe"&&(this.globeExtVertexArray=new fc,N=g.projection);for(const O of w){const{geometry:L,index:B,sourceLayerIndex:q}=O,Y=i[B].feature;this.addFeature(O,L,B,o.availableImages,h,N,o.brightness),o.featureIndex.insert(Y,L,B,q,this.index)}}update(i,o,h,g,_,w,j){this.programConfigurations.updatePaintArrays(i,o,_,h,g,w,j)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,vg.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,r0.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(i,o,h,g,_,w,j){for(const N of o)for(const O of N){const L=O.x,B=O.y;if(L<0||L>=en||B<0||B>=en)continue;if(w){const Q=w.projectTilePoint(L,B,_),re=w.upVector(_,L,B),he=this.globeExtVertexArray;Pn(he,Q,re),Pn(he,Q,re),Pn(he,Q,re),Pn(he,Q,re)}const q=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),Y=q.vertexLength;gn(this.layoutVertexArray,L,B,-1,-1),gn(this.layoutVertexArray,L,B,1,-1),gn(this.layoutVertexArray,L,B,1,1),gn(this.layoutVertexArray,L,B,-1,1),this.indexArray.emplaceBack(Y,Y+1,Y+2),this.indexArray.emplaceBack(Y,Y+2,Y+3),q.vertexLength+=4,q.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,{},g,_,j)}}function qn(c,i){for(let o=0;o<c.length;o++)if(Ur(i,c[o]))return!0;for(let o=0;o<i.length;o++)if(Ur(c,i[o]))return!0;return!!Yn(c,i)}function ir(c,i,o){return!!Ur(c,i)||!!ar(i,c,o)}function $n(c,i){if(c.length===1)return Fr(i,c[0]);for(let o=0;o<i.length;o++){const h=i[o];for(let g=0;g<h.length;g++)if(Ur(c,h[g]))return!0}for(let o=0;o<c.length;o++)if(Fr(i,c[o]))return!0;for(let o=0;o<i.length;o++)if(Yn(c,i[o]))return!0;return!1}function ur(c,i,o){if(c.length>1){if(Yn(c,i))return!0;for(let h=0;h<i.length;h++)if(ar(i[h],c,o))return!0}for(let h=0;h<c.length;h++)if(ar(c[h],i,o))return!0;return!1}function Yn(c,i){if(c.length===0||i.length===0)return!1;for(let o=0;o<c.length-1;o++){const h=c[o],g=c[o+1];for(let _=0;_<i.length-1;_++)if(Bn(h,g,i[_],i[_+1]))return!0}return!1}function Bn(c,i,o,h){return Lr(c,o,h)!==Lr(i,o,h)&&Lr(c,i,o)!==Lr(c,i,h)}function Tr(c,i,o){return(c.x-o.x)*(i.y-o.y)-(c.y-o.y)*(i.x-o.x)}function ei(c,i,o,h){const g=Tr(c,i,h),_=Tr(c,i,o);if(Math.sign(g)===Math.sign(_))return;const w=Tr(o,h,c),j=w+_-g;return Math.sign(w)!==Math.sign(j)?[w/(w-j),_/(_-g)]:void 0}function ar(c,i,o){const h=o*o;if(i.length===1)return c.distSqr(i[0])<h;for(let g=1;g<i.length;g++)if(Er(c,i[g-1],i[g])<h)return!0;return!1}function Er(c,i,o){const h=i.distSqr(o);if(h===0)return c.distSqr(i);const g=((c.x-i.x)*(o.x-i.x)+(c.y-i.y)*(o.y-i.y))/h;return c.distSqr(g<0?i:g>1?o:o.sub(i)._mult(g)._add(i))}function Fr(c,i){let o,h,g,_=!1;for(let w=0;w<c.length;w++){o=c[w];for(let j=0,N=o.length-1;j<o.length;N=j++)h=o[j],g=o[N],h.y>i.y!=g.y>i.y&&i.x<(g.x-h.x)*(i.y-h.y)/(g.y-h.y)+h.x&&(_=!_)}return _}function Ur(c,i){let o=!1;for(let h=0,g=c.length-1;h<c.length;g=h++){const _=c[h],w=c[g];_.y>i.y!=w.y>i.y&&i.x<(w.x-_.x)*(i.y-_.y)/(w.y-_.y)+_.x&&(o=!o)}return o}function ti(c,i,o,h,g){for(const w of c)if(i<=w.x&&o<=w.y&&h>=w.x&&g>=w.y)return!0;const _=[new Kt(i,o),new Kt(i,g),new Kt(h,g),new Kt(h,o)];if(c.length>2){for(const w of _)if(Ur(c,w))return!0}for(let w=0;w<c.length-1;w++)if(Pi(c[w],c[w+1],_))return!0;return!1}function Pi(c,i,o){const h=o[0],g=o[2];if(c.x<h.x&&i.x<h.x||c.x>g.x&&i.x>g.x||c.y<h.y&&i.y<h.y||c.y>g.y&&i.y>g.y)return!1;const _=Lr(c,i,o[0]);return _!==Lr(c,i,o[1])||_!==Lr(c,i,o[2])||_!==Lr(c,i,o[3])}function ta(c,i,o,h,g,_){let w=i.y-c.y,j=c.x-i.x;if(_=_||0){const N=w*w+j*j;if(N===0)return!0;const O=Math.sqrt(N);w/=O,j/=O}return!((o.x-c.x)*w+(o.y-c.y)*j-_<0||(h.x-c.x)*w+(h.y-c.y)*j-_<0||(g.x-c.x)*w+(g.y-c.y)*j-_<0)}function Ni(c,i,o,h,g,_,w){return!(ta(c,i,h,g,_,w)||ta(i,o,h,g,_,w)||ta(o,c,h,g,_,w)||ta(h,g,c,i,o,w)||ta(g,_,c,i,o,w)||ta(_,h,c,i,o,w))}function rr(c,i,o){const h=i.paint.get(c).value;return h.kind==="constant"?h.value:o.programConfigurations.get(i.id).getMaxValue(c)}function _i(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function kr(c,i,o,h,g){if(!i[0]&&!i[1])return c;const _=Kt.convert(i)._mult(g);o==="viewport"&&_._rotate(-h);const w=[];for(let j=0;j<c.length;j++)w.push(c[j].sub(_));return w}function qr(c,i,o,h){const g=Kt.convert(c)._mult(h);return i==="viewport"&&g._rotate(-o),g}let Hr,Di;function za(c,i,o){var h=2*Math.PI*6378137/256/Math.pow(2,o);return[c*h-2*Math.PI*6378137/2,i*h-2*Math.PI*6378137/2]}mn(Sn,"CircleBucket",{omit:["layers"]});class bi{constructor(i,o,h){this.z=i,this.x=o,this.y=h,this.key=Sa(0,i,i,o,h)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,o){const h=function(_,w,j){var N=za(256*_,256*(w=Math.pow(2,j)-w-1),j),O=za(256*(_+1),256*(w+1),j);return N[0]+","+N[1]+","+O[0]+","+O[1]}(this.x,this.y,this.z),g=function(_,w,j){let N,O="";for(let L=_;L>0;L--)N=1<<L-1,O+=(w&N?1:0)+(j&N?2:0);return O}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",g).replace("{bbox-epsg-3857}",h)}toString(){return`${this.z}/${this.x}/${this.y}`}}class xa{constructor(i,o){this.wrap=i,this.canonical=o,this.key=Sa(i,o.z,o.z,o.x,o.y)}}class di{constructor(i,o,h,g,_){this.overscaledZ=i,this.wrap=o,this.canonical=new bi(h,+g,+_),this.key=o===0&&i===h?this.canonical.key:Sa(o,i,h,g,_)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){const o=this.canonical.z-i;return i>this.canonical.z?new di(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new di(i,this.wrap,i,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(i,o=!0){if(this.overscaledZ===i&&o)return this.key;if(i>this.canonical.z)return Sa(this.wrap*+o,i,this.canonical.z,this.canonical.x,this.canonical.y);{const h=this.canonical.z-i;return Sa(this.wrap*+o,i,i,this.canonical.x>>h,this.canonical.y>>h)}}isChildOf(i){if(i.wrap!==this.wrap)return!1;const o=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.z<this.canonical.z&&i.canonical.x===this.canonical.x>>o&&i.canonical.y===this.canonical.y>>o}children(i){if(this.overscaledZ>=i)return[new di(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,h=2*this.canonical.x,g=2*this.canonical.y;return[new di(o,this.wrap,o,h,g),new di(o,this.wrap,o,h+1,g),new di(o,this.wrap,o,h,g+1),new di(o,this.wrap,o,h+1,g+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new di(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new di(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new xa(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Sa(c,i,o,h,g){const _=1<<Math.min(o,22);let w=_*(g%_)+h%_;return c&&o<22&&(w+=_*_*((c<0?-2*c-1:2*c)%(1<<2*(22-o)))),16*(32*w+o)+(i-o)}const io=[c=>{let i=c.canonical.x-1,o=c.wrap;return i<0&&(i=(1<<c.canonical.z)-1,o--),new di(c.overscaledZ,o,c.canonical.z,i,c.canonical.y)},c=>{let i=c.canonical.x+1,o=c.wrap;return i===1<<c.canonical.z&&(i=0,o++),new di(c.overscaledZ,o,c.canonical.z,i,c.canonical.y)},c=>new di(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,(c.canonical.y===0?1<<c.canonical.z:c.canonical.y)-1),c=>new di(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y===(1<<c.canonical.z)-1?0:c.canonical.y+1)];mn(bi,"CanonicalTileID"),mn(di,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Ho=Vr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:ao}=Ho,Go=Vr([{name:"a_pos_3",components:3,type:"Int16"}]);var xc=Vr([{name:"a_pos",type:"Int16",components:2}]);class Wo{constructor(i,o){this.pos=i,this.dir=o}intersectsPlane(i,o,h){const g=yi(o,this.dir);if(Math.abs(g)<1e-6)return!1;const _=((i[0]-this.pos[0])*o[0]+(i[1]-this.pos[1])*o[1])/g;return h[0]=this.pos[0]+this.dir[0]*_,h[1]=this.pos[1]+this.dir[1]*_,!0}}class ul{constructor(i,o){this.pos=i,this.dir=o}intersectsPlane(i,o,h){const g=vn(o,this.dir);if(Math.abs(g)<1e-6)return!1;const _=((i[0]-this.pos[0])*o[0]+(i[1]-this.pos[1])*o[1]+(i[2]-this.pos[2])*o[2])/g;return h[0]=this.pos[0]+this.dir[0]*_,h[1]=this.pos[1]+this.dir[1]*_,h[2]=this.pos[2]+this.dir[2]*_,!0}closestPointOnSphere(i,o,h){if(function(Y,Q){var re=Y[0],he=Y[1],pe=Y[2],Se=Q[0],be=Q[1],oe=Q[2];return Math.abs(re-Se)<=b*Math.max(1,Math.abs(re),Math.abs(Se))&&Math.abs(he-be)<=b*Math.max(1,Math.abs(he),Math.abs(be))&&Math.abs(pe-oe)<=b*Math.max(1,Math.abs(pe),Math.abs(oe))}(this.pos,i)||o===0)return h[0]=h[1]=h[2]=0,!1;const[g,_,w]=this.dir,j=this.pos[0]-i[0],N=this.pos[1]-i[1],O=this.pos[2]-i[2],L=g*g+_*_+w*w,B=2*(j*g+N*_+O*w),q=B*B-4*L*(j*j+N*N+O*O-o*o);if(q<0){const Y=Math.max(-B/2,0),Q=j+g*Y,re=N+_*Y,he=O+w*Y,pe=Math.hypot(Q,re,he);return h[0]=Q*o/pe,h[1]=re*o/pe,h[2]=he*o/pe,!1}{const Y=(-B-Math.sqrt(q))/(2*L);if(Y<0){const Q=Math.hypot(j,N,O);return h[0]=j*o/Q,h[1]=N*o/Q,h[2]=O*o/Q,!1}return h[0]=j+g*Y,h[1]=N+_*Y,h[2]=O+w*Y,!0}}}class Es{constructor(i,o,h,g,_){this.TL=i,this.TR=o,this.BR=h,this.BL=g,this.horizon=_}static fromInvProjectionMatrix(i,o,h){const g=[-1,1,1],_=[1,1,1],w=[1,-1,1],j=[-1,-1,1],N=un(g,g,i),O=un(_,_,i),L=un(w,w,i),B=un(j,j,i);return new Es(N,O,L,B,o/h)}}function xd(c,i,o){let h=1/0,g=-1/0;const _=[];for(const w of c){Ir(_,w,i);const j=vn(_,o);h=Math.min(h,j),g=Math.max(g,j)}return[h,g]}function so(c,i){let o=!0;for(let h=0;h<c.planes.length;h++){const g=c.planes[h];let _=0;for(let w=0;w<i.length;w++)_+=vn(g,i[w])+g[3]>=0;if(_===0)return 0;_!==i.length&&(o=!1)}return o?2:1}function nm(c,i){for(const o of c.projections){const h=xd(i,c.points[0],o.axis);if(o.projection[1]<h[0]||o.projection[0]>h[1])return 0}return 1}function rm(c,i){let o=0;const h=[0,0,0,0];for(let w=0;w<c.length;w++)h[0]=c[w][0],h[1]=c[w][1],h[2]=c[w][2],h[3]=1,(g=h)[0]*(_=i)[0]+g[1]*_[1]+g[2]*_[2]+g[3]*_[3]>=0&&o++;var g,_;return o}class im{constructor(i,o){this.points=i||new Array(8).fill([0,0,0]),this.planes=o||new Array(6).fill([0,0,0,0]),this.bounds=hi.fromPoints(this.points),this.projections=[],this.frustumEdges=[Ir([],this.points[2],this.points[3]),Ir([],this.points[0],this.points[3]),Ir([],this.points[4],this.points[0]),Ir([],this.points[5],this.points[1]),Ir([],this.points[6],this.points[2]),Ir([],this.points[7],this.points[3])];for(const h of this.frustumEdges){const g=[0,-h[2],h[1]],_=[h[2],0,-h[0]];this.projections.push({axis:g,projection:xd(this.points,this.points[0],g)}),this.projections.push({axis:_,projection:xd(this.points,this.points[0],_)})}}static fromInvProjectionMatrix(i,o,h,g){const _=Math.pow(2,h),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(O=>{const L=wa([],O,i),B=1/L[3]/o*_;return(q=L)[0]=(Y=L)[0]*(Q=[B,B,g?1/L[3]:B,B])[0],q[1]=Y[1]*Q[1],q[2]=Y[2]*Q[2],q[3]=Y[3]*Q[3],q;var q,Y,Q}),j=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(O=>{const L=Mn([],Zn([],Ir([],w[O[0]],w[O[1]]),Ir([],w[O[2]],w[O[1]]))),B=-vn(L,w[O[1]]);return L.concat(B)}),N=[];for(let O=0;O<w.length;O++)N.push([w[O][0],w[O][1],w[O][2]]);return new im(N,j)}intersectsPrecise(i,o,h){for(let g=0;g<o.length;g++)if(!rm(i,o[g]))return 0;for(let g=0;g<this.planes.length;g++)if(!rm(i,this.planes[g]))return 0;for(const g of h)for(const _ of this.frustumEdges){const w=Zn([],g,_),j=jt(w);if(j===0)continue;Ge(w,w,1/j);const N=xd(this.points,this.points[0],w),O=xd(i,this.points[0],w);if(N[0]>O[1]||O[0]>N[1])return 0}return 1}containsPoint(i){for(const o of this.planes){const h=o[3];if(vn([o[0],o[1],o[2]],i)+h<0)return!1}return!0}}class hi{static fromPoints(i){const o=[1/0,1/0,1/0],h=[-1/0,-1/0,-1/0];for(const g of i)Tt(o,o,g),Yt(h,h,g);return new hi(o,h)}static fromTileIdAndHeight(i,o,h){const g=1<<i.canonical.z,_=i.canonical.x,w=i.canonical.y;return new hi([_/g,w/g,o],[(_+1)/g,(w+1)/g,h])}static applyTransform(i,o){const h=i.getCorners();for(let g=0;g<h.length;++g)un(h[g],h[g],o);return hi.fromPoints(h)}static applyTransformFast(i,o){const h=[o[12],o[13],o[14]],g=[...h];for(let _=0;_<3;_++)for(let w=0;w<3;w++){const j=o[4*w+_],N=j*i.min[w],O=j*i.max[w];h[_]+=Math.min(N,O),g[_]+=Math.max(N,O)}return new hi(h,g)}static projectAabbCorners(i,o){const h=i.getCorners();for(let g=0;g<h.length;++g)un(h[g],h[g],o);return h}constructor(i,o){this.min=i,this.max=o,this.center=Ge([],vt([],this.min,this.max),.5)}quadrant(i){const o=[i%2==0,i<2],h=bt(this.min),g=bt(this.max);for(let _=0;_<o.length;_++)h[_]=o[_]?this.min[_]:this.center[_],g[_]=o[_]?this.center[_]:this.max[_];return g[2]=this.max[2],new hi(h,g)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}distanceZ(i){return Math.max(Math.min(this.max[2],i[2]),this.min[2])-i[2]}getCorners(){const i=this.min,o=this.max;return[[i[0],i[1],i[2]],[o[0],i[1],i[2]],[o[0],o[1],i[2]],[i[0],o[1],i[2]],[i[0],i[1],o[2]],[o[0],i[1],o[2]],[o[0],o[1],o[2]],[i[0],o[1],o[2]]]}intersects(i){return this.intersectsAabb(i.bounds)?so(i,this.getCorners()):0}intersectsFlat(i){return this.intersectsAabb(i.bounds)?so(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(i,o){return o||this.intersects(i)?nm(i,this.getCorners()):0}intersectsPreciseFlat(i,o){return o||this.intersectsFlat(i)?nm(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(i){for(let o=0;o<3;++o)if(this.min[o]>i.max[o]||i.min[o]>this.max[o])return!1;return!0}intersectsAabbXY(i){return!(this.min[0]>i.max[0]||i.min[0]>this.max[0]||this.min[1]>i.max[1]||i.min[1]>this.max[1])}encapsulate(i){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],i.min[o]),this.max[o]=Math.max(this.max[o],i.max[o])}encapsulatePoint(i){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],i[o]),this.max[o]=Math.max(this.max[o],i[o])}closestPoint(i){return[Math.max(Math.min(this.max[0],i[0]),this.min[0]),Math.max(Math.min(this.max[1],i[1]),this.min[1]),Math.max(Math.min(this.max[2],i[2]),this.min[2])]}}function _u(c){return c*A/ce}mn(hi,"Aabb");const am=[new hi([K,K,K],[X,X,X]),new hi([K,K,K],[0,0,X]),new hi([0,K,K],[X,0,X]),new hi([K,0,K],[0,X,X]),new hi([0,0,K],[X,X,X])];function sm(c,i,o,h=!0){const g=Ge([],c._camera.position,c.worldSize),_=[i,o,1,1];wa(_,_,c.pixelMatrixInverse),Ci(_,_,1/_[3]);const w=Mn([],Ir([],_,g)),j=c.globeMatrix,N=[j[12],j[13],j[14]],O=Ir([],N,g),L=jt(O),B=Mn([],O),q=c.worldSize/(2*Math.PI),Y=vn(B,w),Q=Math.asin(q/L);if(Q<Math.acos(Y)){if(!h)return null;const Ze=[],Qe=[];Ge(Ze,w,L/Y),Mn(Qe,Ir(Qe,Ze,O)),Mn(w,vt(w,O,Ge(w,Qe,Math.tan(Q)*L)))}const re=[];new ul(g,w).closestPointOnSphere(N,q,re);const he=Mn([],Ar(j,0)),pe=Mn([],Ar(j,1)),Se=Mn([],Ar(j,2)),be=vn(he,re),oe=vn(pe,re),xe=vn(Se,re),we=le(Math.asin(-oe/q));let je=le(Math.atan2(be,xe));je=c.center.lng+function(Ze,Qe){const pt=(Qe-Ze+180)%360-180;return pt<-180?pt+360:pt}(c.center.lng,je);const Ve=Ie(je),We=Le(Oe(we),0,1);return new lt(Ve,We)}class i2{constructor(i,o,h){this.a=Ir([],i,h),this.b=Ir([],o,h),this.center=h;const g=Mn([],this.a),_=Mn([],this.b);this.angle=Math.acos(vn(g,_))}}function Wy(c,i){if(c.angle===0)return null;let o;return o=c.a[i]===0?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[i]/c.a[i]/Math.sin(c.angle)-1/Math.tan(c.angle)),o<0||o>1?null:function(h,g,_,w){const j=Math.sin(_);return h*(Math.sin((1-w)*_)/j)+g*(Math.sin(w*_)/j)}(c.a[i],c.b[i],c.angle,Le(o,0,1))+c.center[i]}function bu(c){if(c.z<=1)return am[c.z+2*c.y+c.x];const i=$_(Xy(c));return hi.fromPoints(i)}function wu(c,i,o){return Ge(c,c,1-o),ot(c,c,i,o)}function Zy(c,i,o){for(const h of c)un(h,h,i),Ge(h,h,o)}function a2(c,i,o,h){const g=i/c.worldSize,_=c.globeMatrix;if(o.z<=1){const We=bu(o).getCorners();return Zy(We,_,g),hi.fromPoints(We)}const w=Xy(o,h),j=$_(w,A+_u(c._tileCoverLift));Zy(j,_,g);const N=Number.MAX_VALUE,O=[-N,-N,-N],L=[N,N,N];if(w.contains(c.center)){for(const Qe of j)Tt(L,L,Qe),Yt(O,O,Qe);O[2]=0;const We=c.point,Ze=[We.x*g,We.y*g,0];return Tt(L,L,Ze),Yt(O,O,Ze),new hi(L,O)}if(c._tileCoverLift>0){for(const We of j)Tt(L,L,We),Yt(O,O,We);return new hi(L,O)}const B=[_[12]*g,_[13]*g,_[14]*g],q=w.getCenter(),Y=Le(c.center.lat,-85.051129,et),Q=Le(q.lat,-85.051129,et),re=Ie(c.center.lng),he=Oe(Y);let pe=re-Ie(q.lng);const Se=he-Oe(Q);pe>.5?pe-=1:pe<-.5&&(pe+=1);let be=0;Math.abs(pe)>Math.abs(Se)?be=pe>=0?1:3:(be=Se>=0?0:2,ot(B,B,[_[4]*g,_[5]*g,_[6]*g],-Math.sin(te(Se>=0?w.getSouth():w.getNorth()))*A));const oe=j[be],xe=j[(be+1)%4],we=new i2(oe,xe,B),je=[Wy(we,0)||oe[0],Wy(we,1)||oe[1],Wy(we,2)||oe[2]],Ve=Dh(c.zoom);if(Ve>0){const We=function({x:Qe,y:pt,z:kt},Ct,Pt,Vt,ht){const Mt=1/(1<<kt);let dt=Qe*Mt,ft=dt+Mt,$t=pt*Mt,Gt=$t+Mt,Dn=0;const bn=(dt+ft)/2-Vt;return bn>.5?Dn=-1:bn<-.5&&(Dn=1),dt=((dt+Dn)*Ct-(Vt*=Ct))*Pt+Vt,ft=((ft+Dn)*Ct-Vt)*Pt+Vt,$t=($t*Ct-(ht*=Ct))*Pt+ht,Gt=(Gt*Ct-ht)*Pt+ht,[[dt,Gt,0],[ft,Gt,0],[ft,$t,0],[dt,$t,0]]}(o,i,c._pixelsPerMercatorPixel,re,he);for(let Qe=0;Qe<j.length;Qe++)wu(j[Qe],We[Qe],Ve);const Ze=vt([],We[be],We[(be+1)%4]);Ge(Ze,Ze,.5),wu(je,Ze,Ve)}for(const We of j)Tt(L,L,We),Yt(O,O,We);return L[2]=Math.min(oe[2],xe[2]),Tt(L,L,je),Yt(O,O,je),new hi(L,O)}function Xy({x:c,y:i,z:o},h=!1){const g=1/(1<<o),_=new ue(Fe(c*g),i===(1<<o)-1&&h?-90:$e((i+1)*g)),w=new ue(Fe((c+1)*g),i===0&&h?90:$e(i*g));return new ve(_,w)}function $_(c,i=A){const o=te(c.getNorth()),h=te(c.getSouth()),g=Math.cos(o),_=Math.cos(h),w=Math.sin(o),j=Math.sin(h),N=c.getWest(),O=c.getEast();return[J(_,j,N,i),J(_,j,O,i),J(g,w,O,i),J(g,w,N,i)]}function _g(c,i,o,h){const g=1<<o.z,_=(c/en+o.x)/g;return de($e((i/en+o.y)/g),Fe(_),h)}function l0({min:c,max:i}){return z/Math.max(i[0]-c[0],i[1]-c[1],i[2]-c[2])}const om=new Float64Array(16);function lm(c){const i=l0(c),o=me(om,[i,i,i]);return ne(o,o,In([],c.min))}function Ky(c){const i=(h=c.min,(o=om)[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=h[0],o[13]=h[1],o[14]=h[2],o[15]=1,o);var o,h;const g=1/l0(c);return ie(i,i,[g,g,g])}function Yy(c){const i=en/(2*Math.PI);return c/(2*Math.PI)/i}function q_(c,i){return en/(512*Math.pow(2,c))*l0(bu(i))}function H_(c,i,o,h,g){const _=Yy(o),w=[c,i,-o/(2*Math.PI)],j=W(new Float64Array(16));return ne(j,j,w),ie(j,j,[_,_,_]),ge(j,j,te(-g)),ae(j,j,te(-h)),j}function Dh(c){return Ue(M,D,c)}function G_(c,i){const o=de(i.lat,i.lng),h=function(Q){const re=de(Q._center.lat,Q._center.lng);let he=Zn([],Nt(0,1,0),re);const pe=ke([],-Q.angle,re);he=un(he,he,pe),ke(pe,-Q._pitch,he);const Se=Mn([],re);return Ge(Se,Se,_u(Q.cameraToCenterDistance/Q.pixelsPerMeter)),un(Se,Se,pe),vt([],re,Se)}(c);return w=(g=He([],h,o))[0],j=g[1],N=g[2],O=(_=o)[0],L=_[1],B=_[2],Y=(q=Math.sqrt(w*w+j*j+N*N)*Math.sqrt(O*O+L*L+B*B))&&vn(g,_)/q,Math.acos(Math.min(Math.max(Y,-1),1));var g,_,w,j,N,O,L,B,q,Y}function bg(c,i){return G_(c,i)>Math.PI/2*1.01}const W_=te(85),s2=Math.cos(W_),Pa=Math.sin(W_),Z_=F(),o2=c=>{const i=[];return c.paint.get("circle-pitch-alignment")==="map"&&i.push("PITCH_WITH_MAP"),c.paint.get("circle-pitch-scale")==="map"&&i.push("SCALE_WITH_MAP"),i};function X_(c,i,o,h,g,_,w,j,N){if(_&&c.queryGeometry.isAboveHorizon)return!1;_&&(N*=c.pixelToTileUnitsFactor);const O=c.tileID.canonical,L=o.projection.upVectorScale(O,o.center.lat,o.worldSize).metersToTile;for(const B of i)for(const q of B){const Y=q.add(j),Q=g&&o.elevation?o.elevation.exaggeration()*g.getElevationAt(Y.x,Y.y,!0):0,re=o.projection.projectTilePoint(Y.x,Y.y,O);if(Q>0){const be=o.projection.upVector(O,Y.x,Y.y);re.x+=be[0]*L*Q,re.y+=be[1]*L*Q,re.z+=be[2]*L*Q}const he=_?Y:eA(re.x,re.y,re.z,h),pe=_?c.tilespaceRays.map(be=>Qy(be,Q)):c.queryGeometry.screenGeometry,Se=wa([],[re.x,re.y,re.z,1],h);if(!w&&_?N*=Se[3]/o.cameraToCenterDistance:w&&!_&&(N*=o.cameraToCenterDistance/Se[3]),_){const be=$e((q.y/en+O.y)/(1<<O.z));N/=o.projection.pixelsPerMeter(be,1)/Ce(1,be)}if(ir(pe,he,N))return!0}return!1}function eA(c,i,o,h){const g=wa([],[c,i,o,1],h);return new Kt(g[0]/g[3],g[1]/g[3])}const l2=Nt(0,0,0),tA=Nt(0,0,1);function Qy(c,i){const o=nt();return l2[2]=i,c.intersectsPlane(l2,tA,o),new Kt(o[0],o[1])}class cm extends Sn{}let Jy,c0,ev,Ff;function Su(c,{width:i,height:o},h,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==i*o*h)throw new RangeError("mismatched image size")}else g=new Uint8Array(i*o*h);return c.width=i,c.height=o,c.data=g,c}function wg(c,i,o){const{width:h,height:g}=i;h===c.width&&g===c.height||(K_(c,i,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,h),height:Math.min(c.height,g)},o,null),c.width=h,c.height=g,c.data=i.data)}function K_(c,i,o,h,g,_,w,j){if(g.width===0||g.height===0)return i;if(g.width>c.width||g.height>c.height||o.x>c.width-g.width||o.y>c.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>i.width||g.height>i.height||h.x>i.width-g.width||h.y>i.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const N=c.data,O=i.data,L=_===4&&j;for(let B=0;B<g.height;B++){const q=((o.y+B)*c.width+o.x)*_,Y=((h.y+B)*i.width+h.x)*_;if(L)for(let Q=0;Q<g.width;Q++){const re=q+Q*_+3,he=Y+Q*_;O[he+0]=255,O[he+1]=255,O[he+2]=255,O[he+3]=N[re]}else if(w)for(let Q=0;Q<g.width;Q++){const re=q+Q*_,he=Y+Q*_,pe=N[re+3],Se=new Kr(N[re+0]/255*pe,N[re+1]/255*pe,N[re+2]/255*pe,pe).toRenderColor(w).toArray();O[he+0]=Se[0],O[he+1]=Se[1],O[he+2]=Se[2],O[he+3]=Se[3]}else for(let Q=0;Q<g.width*_;Q++)O[Y+Q]=N[q+Q]}return i}mn(cm,"HeatmapBucket",{omit:["layers"]});class Oh{constructor(i,o){Su(this,i,1,o)}resize(i){wg(this,new Oh(i),1)}clone(){return new Oh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,o,h,g,_){K_(i,o,h,g,_,1,null)}}class hs{constructor(i,o){Su(this,i,4,o)}resize(i){wg(this,new hs(i),4)}replace(i,o){o?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new hs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,o,h,g,_,w,j){K_(i,o,h,g,_,4,w,j)}}class Y_{constructor(i,o){this.width=i.width,this.height=i.height,this.data=o instanceof Uint8Array?new Float32Array(o.buffer):o}}function Sg(c){const i={},o=c.resolution||256,h=c.clips?c.clips.length:1,g=c.image||new hs({width:o,height:h}),_=(w,j,N)=>{i[c.evaluationKey]=N;const O=c.expression.evaluate(i);O&&(g.data[w+j+0]=Math.floor(255*O.r/O.a),g.data[w+j+1]=Math.floor(255*O.g/O.a),g.data[w+j+2]=Math.floor(255*O.b/O.a),g.data[w+j+3]=Math.floor(255*O.a))};if(c.clips)for(let w=0,j=0;w<h;++w,j+=4*o)for(let N=0,O=0;N<o;N++,O+=4){const L=N/(o-1),{start:B,end:q}=c.clips[w];_(j,O,B*(1-L)+q*L)}else for(let w=0,j=0;w<o;w++,j+=4)_(0,j,w/(o-1));return g}mn(Oh,"AlphaImage"),mn(hs,"RGBAImage");const nA=Vr([{name:"a_pos",components:2,type:"Int16"}],4),Q_=Vr([{name:"a_road_z_offset",components:1,type:"Float32"}],4),c2=Vr([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),u2=Vr([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function u0(c,i,o=2){const h=i&&i.length,g=h?i[0]*o:c.length;let _=tv(c,0,g,o,!0);const w=[];if(!_||_.next===_.prev)return w;let j,N,O;if(h&&(_=function(L,B,q,Y){const Q=[];for(let re=0,he=B.length;re<he;re++){const pe=tv(L,B[re]*Y,re<he-1?B[re+1]*Y:L.length,Y,!1);pe===pe.next&&(pe.steiner=!0),Q.push(h2(pe))}Q.sort(Vi);for(let re=0;re<Q.length;re++)q=J_(Q[re],q);return q}(c,i,_,o)),c.length>80*o){j=1/0,N=1/0;let L=-1/0,B=-1/0;for(let q=o;q<g;q+=o){const Y=c[q],Q=c[q+1];Y<j&&(j=Y),Q<N&&(N=Q),Y>L&&(L=Y),Q>B&&(B=Q)}O=Math.max(L-j,B-N),O=O!==0?32767/O:0}return d0(_,w,o,j,N,O,0),w}function tv(c,i,o,h,g){let _;if(g===function(w,j,N,O){let L=0;for(let B=j,q=N-O;B<N;B+=O)L+=(w[q]-w[B])*(w[B+1]+w[q+1]),q=B;return L}(c,i,o,h)>0)for(let w=i;w<o;w+=h)_=ya(w/h|0,c[w],c[w+1],_);else for(let w=o-h;w>=i;w-=h)_=ya(w/h|0,c[w],c[w+1],_);return _&&um(_,_.next)&&(dm(_),_=_.next),_}function Ih(c,i){if(!c)return c;i||(i=c);let o,h=c;do if(o=!1,h.steiner||!um(h,h.next)&&Ta(h.prev,h,h.next)!==0)h=h.next;else{if(dm(h),h=i=h.prev,h===h.next)break;o=!0}while(o||h!==i);return i}function d0(c,i,o,h,g,_,w){if(!c)return;!w&&_&&function(N,O,L,B){let q=N;do q.z===0&&(q.z=f0(q.x,q.y,O,L,B)),q.prevZ=q.prev,q.nextZ=q.next,q=q.next;while(q!==N);q.prevZ.nextZ=null,q.prevZ=null,function(Y){let Q,re=1;do{let he,pe=Y;Y=null;let Se=null;for(Q=0;pe;){Q++;let be=pe,oe=0;for(let we=0;we<re&&(oe++,be=be.nextZ,be);we++);let xe=re;for(;oe>0||xe>0&&be;)oe!==0&&(xe===0||!be||pe.z<=be.z)?(he=pe,pe=pe.nextZ,oe--):(he=be,be=be.nextZ,xe--),Se?Se.nextZ=he:Y=he,he.prevZ=Se,Se=he;pe=be}Se.nextZ=null,re*=2}while(Q>1)}(q)}(c,h,g,_);let j=c;for(;c.prev!==c.next;){const N=c.prev,O=c.next;if(_?h0(c,h,g,_):rA(c))i.push(N.i,c.i,O.i),dm(c),c=O.next,j=O.next;else if((c=O)===j){w?w===1?d0(c=iA(Ih(c),i),i,o,h,g,_,2):w===2&&d2(c,i,o,h,g,_):d0(Ih(c),i,o,h,g,_,1);break}}}function rA(c){const i=c.prev,o=c,h=c.next;if(Ta(i,o,h)>=0)return!1;const g=i.x,_=o.x,w=h.x,j=i.y,N=o.y,O=h.y,L=Math.min(g,_,w),B=Math.min(j,N,O),q=Math.max(g,_,w),Y=Math.max(j,N,O);let Q=h.next;for(;Q!==i;){if(Q.x>=L&&Q.x<=q&&Q.y>=B&&Q.y<=Y&&kh(g,j,_,N,w,O,Q.x,Q.y)&&Ta(Q.prev,Q,Q.next)>=0)return!1;Q=Q.next}return!0}function h0(c,i,o,h){const g=c.prev,_=c,w=c.next;if(Ta(g,_,w)>=0)return!1;const j=g.x,N=_.x,O=w.x,L=g.y,B=_.y,q=w.y,Y=Math.min(j,N,O),Q=Math.min(L,B,q),re=Math.max(j,N,O),he=Math.max(L,B,q),pe=f0(Y,Q,i,o,h),Se=f0(re,he,i,o,h);let be=c.prevZ,oe=c.nextZ;for(;be&&be.z>=pe&&oe&&oe.z<=Se;){if(be.x>=Y&&be.x<=re&&be.y>=Q&&be.y<=he&&be!==g&&be!==w&&kh(j,L,N,B,O,q,be.x,be.y)&&Ta(be.prev,be,be.next)>=0||(be=be.prevZ,oe.x>=Y&&oe.x<=re&&oe.y>=Q&&oe.y<=he&&oe!==g&&oe!==w&&kh(j,L,N,B,O,q,oe.x,oe.y)&&Ta(oe.prev,oe,oe.next)>=0))return!1;oe=oe.nextZ}for(;be&&be.z>=pe;){if(be.x>=Y&&be.x<=re&&be.y>=Q&&be.y<=he&&be!==g&&be!==w&&kh(j,L,N,B,O,q,be.x,be.y)&&Ta(be.prev,be,be.next)>=0)return!1;be=be.prevZ}for(;oe&&oe.z<=Se;){if(oe.x>=Y&&oe.x<=re&&oe.y>=Q&&oe.y<=he&&oe!==g&&oe!==w&&kh(j,L,N,B,O,q,oe.x,oe.y)&&Ta(oe.prev,oe,oe.next)>=0)return!1;oe=oe.nextZ}return!0}function iA(c,i){let o=c;do{const h=o.prev,g=o.next.next;!um(h,g)&&f2(h,o,o.next,g)&&Tg(h,g)&&Tg(g,h)&&(i.push(h.i,o.i,g.i),dm(o),dm(o.next),o=c=g),o=o.next}while(o!==c);return Ih(o)}function d2(c,i,o,h,g,_){let w=c;do{let j=w.next.next;for(;j!==w.prev;){if(w.i!==j.i&&iv(w,j)){let N=m0(w,j);return w=Ih(w,w.next),N=Ih(N,N.next),d0(w,i,o,h,g,_,0),void d0(N,i,o,h,g,_,0)}j=j.next}w=w.next}while(w!==c)}function Vi(c,i){let o=c.x-i.x;return o===0&&(o=c.y-i.y,o===0)&&(o=(c.next.y-c.y)/(c.next.x-c.x)-(i.next.y-i.y)/(i.next.x-i.x)),o}function J_(c,i){const o=function(g,_){let w=_;const j=g.x,N=g.y;let O,L=-1/0;if(um(g,w))return w;do{if(um(g,w.next))return w.next;if(N<=w.y&&N>=w.next.y&&w.next.y!==w.y){const re=w.x+(N-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(re<=j&&re>L&&(L=re,O=w.x<w.next.x?w:w.next,re===j))return O}w=w.next}while(w!==_);if(!O)return null;const B=O,q=O.x,Y=O.y;let Q=1/0;w=O;do{if(j>=w.x&&w.x>=q&&j!==w.x&&rv(N<Y?j:L,N,q,Y,N<Y?L:j,N,w.x,w.y)){const re=Math.abs(N-w.y)/(j-w.x);Tg(w,g)&&(re<Q||re===Q&&(w.x>O.x||w.x===O.x&&nv(O,w)))&&(O=w,Q=re)}w=w.next}while(w!==B);return O}(c,i);if(!o)return i;const h=m0(o,c);return Ih(h,h.next),Ih(o,o.next)}function nv(c,i){return Ta(c.prev,c,i.prev)<0&&Ta(i.next,c,c.next)<0}function f0(c,i,o,h,g){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-o)*g|0)|c<<8))|c<<4))|c<<2))|c<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-h)*g|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function h2(c){let i=c,o=c;do(i.x<o.x||i.x===o.x&&i.y<o.y)&&(o=i),i=i.next;while(i!==c);return o}function rv(c,i,o,h,g,_,w,j){return(g-w)*(i-j)>=(c-w)*(_-j)&&(c-w)*(h-j)>=(o-w)*(i-j)&&(o-w)*(_-j)>=(g-w)*(h-j)}function kh(c,i,o,h,g,_,w,j){return!(c===w&&i===j)&&rv(c,i,o,h,g,_,w,j)}function iv(c,i){return c.next.i!==i.i&&c.prev.i!==i.i&&!function(o,h){let g=o;do{if(g.i!==o.i&&g.next.i!==o.i&&g.i!==h.i&&g.next.i!==h.i&&f2(g,g.next,o,h))return!0;g=g.next}while(g!==o);return!1}(c,i)&&(Tg(c,i)&&Tg(i,c)&&function(o,h){let g=o,_=!1;const w=(o.x+h.x)/2,j=(o.y+h.y)/2;do g.y>j!=g.next.y>j&&g.next.y!==g.y&&w<(g.next.x-g.x)*(j-g.y)/(g.next.y-g.y)+g.x&&(_=!_),g=g.next;while(g!==o);return _}(c,i)&&(Ta(c.prev,c,i.prev)||Ta(c,i.prev,i))||um(c,i)&&Ta(c.prev,c,c.next)>0&&Ta(i.prev,i,i.next)>0)}function Ta(c,i,o){return(i.y-c.y)*(o.x-i.x)-(i.x-c.x)*(o.y-i.y)}function um(c,i){return c.x===i.x&&c.y===i.y}function f2(c,i,o,h){const g=p0(Ta(c,i,o)),_=p0(Ta(c,i,h)),w=p0(Ta(o,h,c)),j=p0(Ta(o,h,i));return g!==_&&w!==j||!(g!==0||!av(c,o,i))||!(_!==0||!av(c,h,i))||!(w!==0||!av(o,c,h))||!(j!==0||!av(o,i,h))}function av(c,i,o){return i.x<=Math.max(c.x,o.x)&&i.x>=Math.min(c.x,o.x)&&i.y<=Math.max(c.y,o.y)&&i.y>=Math.min(c.y,o.y)}function p0(c){return c>0?1:c<0?-1:0}function Tg(c,i){return Ta(c.prev,c,c.next)<0?Ta(c,i,c.next)>=0&&Ta(c,c.prev,i)>=0:Ta(c,i,c.prev)<0||Ta(c,c.next,i)<0}function m0(c,i){const o=Fs(c.i,c.x,c.y),h=Fs(i.i,i.x,i.y),g=c.next,_=i.prev;return c.next=i,i.prev=c,o.next=g,g.prev=o,h.next=o,o.prev=h,_.next=h,h.prev=_,h}function ya(c,i,o,h){const g=Fs(c,i,o);return h?(g.next=h.next,g.prev=h,h.next.prev=g,h.next=g):(g.prev=g,g.next=g),g}function dm(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function Fs(c,i,o){return{i:c,x:i,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function sv(c,i){const o=c.length;if(o<=1)return[c];const h=[];let g,_;for(let w=0;w<o;w++){const j=Cr(c[w]);j!==0&&(c[w].area=Math.abs(j),_===void 0&&(_=j<0),_===j<0?(g&&h.push(g),g=[c[w]]):g.push(c[w]))}if(g&&h.push(g),i>1)for(let w=0;w<h.length;w++)h[w].length<=i||(nu(h[w],i,1,h[w].length-1,e1),h[w]=h[w].slice(0,i));return h}function e1(c,i){return i.area-c.area}function ov(c,i,o=1){if(!c)return null;const h=typeof c=="string"?Js.from(c).getPrimary():c.getPrimary(),g=typeof c=="string"?null:c.getSecondary();for(const _ of[h,g]){if(!_)continue;const w=_.id.toString();i.has(w)||i.set(w,[]),_.scaleSelf(o),i.get(w).push(_)}return{primary:h.toString(),secondary:g?g.toString():null}}function Eg(c,i,o,h){const g=h.patternDependencies;let _=!1;for(const w of i){const j=w.paint.get(`${c}-pattern`);j.isConstant()||(_=!0),ov(j.constantOr(null),g,o)&&(_=!0)}return _}function lv(c,i,o,h,g,_){const w=_.patternDependencies;for(const j of i){const N=j.paint.get(`${c}-pattern`).value;if(N.kind!=="constant"){let O=N.evaluate({zoom:h},o,{},_.availableImages);O=O&&O.name?O.name:O;const L=ov(O,w,g);if(!L)continue;const{primary:B,secondary:q}=L;B&&(o.patterns[j.id]=[B,q].filter(Boolean))}}return o}var cv,uv,g0,p2,dv,m2,t1,hv={};function g2(){if(uv)return cv;uv=1;var c=Yl();function i(g,_,w,j,N){this.properties={},this.extent=w,this.type=0,this._pbf=g,this._geometry=-1,this._keys=j,this._values=N,g.readFields(o,this,_)}function o(g,_,w){g==1?_.id=w.readVarint():g==2?function(j,N){for(var O=j.readVarint()+j.pos;j.pos<O;){var L=N._keys[j.readVarint()],B=N._values[j.readVarint()];N.properties[L]=B}}(w,_):g==3?_.type=w.readVarint():g==4&&(_._geometry=w.pos)}function h(g){for(var _,w,j=0,N=0,O=g.length,L=O-1;N<O;L=N++)j+=((w=g[L]).x-(_=g[N]).x)*(_.y+w.y);return j}return cv=i,i.types=["Unknown","Point","LineString","Polygon"],i.prototype.loadGeometry=function(){var g=this._pbf;g.pos=this._geometry;for(var _,w=g.readVarint()+g.pos,j=1,N=0,O=0,L=0,B=[];g.pos<w;){if(N<=0){var q=g.readVarint();j=7&q,N=q>>3}if(N--,j===1||j===2)O+=g.readSVarint(),L+=g.readSVarint(),j===1&&(_&&B.push(_),_=[]),_.push(new c(O,L));else{if(j!==7)throw new Error("unknown command "+j);_&&_.push(_[0].clone())}}return _&&B.push(_),B},i.prototype.bbox=function(){var g=this._pbf;g.pos=this._geometry;for(var _=g.readVarint()+g.pos,w=1,j=0,N=0,O=0,L=1/0,B=-1/0,q=1/0,Y=-1/0;g.pos<_;){if(j<=0){var Q=g.readVarint();w=7&Q,j=Q>>3}if(j--,w===1||w===2)(N+=g.readSVarint())<L&&(L=N),N>B&&(B=N),(O+=g.readSVarint())<q&&(q=O),O>Y&&(Y=O);else if(w!==7)throw new Error("unknown command "+w)}return[L,q,B,Y]},i.prototype.toGeoJSON=function(g,_,w){var j,N,O=this.extent*Math.pow(2,w),L=this.extent*g,B=this.extent*_,q=this.loadGeometry(),Y=i.types[this.type];function Q(pe){for(var Se=0;Se<pe.length;Se++){var be=pe[Se];pe[Se]=[360*(be.x+L)/O-180,360/Math.PI*Math.atan(Math.exp((180-360*(be.y+B)/O)*Math.PI/180))-90]}}switch(this.type){case 1:var re=[];for(j=0;j<q.length;j++)re[j]=q[j][0];Q(q=re);break;case 2:for(j=0;j<q.length;j++)Q(q[j]);break;case 3:for(q=function(pe){var Se=pe.length;if(Se<=1)return[pe];for(var be,oe,xe=[],we=0;we<Se;we++){var je=h(pe[we]);je!==0&&(oe===void 0&&(oe=je<0),oe===je<0?(be&&xe.push(be),be=[pe[we]]):be.push(pe[we]))}return be&&xe.push(be),xe}(q),j=0;j<q.length;j++)for(N=0;N<q[j].length;N++)Q(q[j][N])}q.length===1?q=q[0]:Y="Multi"+Y;var he={type:"Feature",geometry:{type:Y,coordinates:q},properties:this.properties};return"id"in this&&(he.id=this.id),he},cv}function Rh(){if(p2)return g0;p2=1;var c=g2();function i(h,g){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=h,this._keys=[],this._values=[],this._features=[],h.readFields(o,this,g),this.length=this._features.length}function o(h,g,_){h===15?g.version=_.readVarint():h===1?g.name=_.readString():h===5?g.extent=_.readVarint():h===2?g._features.push(_.pos):h===3?g._keys.push(_.readString()):h===4&&g._values.push(function(w){for(var j=null,N=w.readVarint()+w.pos;w.pos<N;){var O=w.readVarint()>>3;j=O===1?w.readString():O===2?w.readFloat():O===3?w.readDouble():O===4?w.readVarint64():O===5?w.readVarint():O===6?w.readSVarint():O===7?w.readBoolean():null}return j}(_))}return g0=i,i.prototype.feature=function(h){if(h<0||h>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[h];var g=this._pbf.readVarint()+this._pbf.pos;return new c(this._pbf,g,this.extent,this._keys,this._values)},g0}function n1(){return t1||(t1=1,hv.VectorTile=function(){if(m2)return dv;m2=1;var c=Rh();function i(o,h,g){if(o===3){var _=new c(g,g.readVarint()+g.pos);_.length&&(h[_.name]=_)}}return dv=function(o,h){this.layers=o.readFields(i,{},h)},dv}(),hv.VectorTileFeature=g2(),hv.VectorTileLayer=Rh()),hv}var yd=n1();const hm="3d_elevation_id",x2="level";class r1{constructor(){this._valid=!1}reset(i){return this.feature=i,this._valid=!0,this._geometry=i.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(i,o){return this._valid&&i(o(this._geometry)),this}require(i,o,h){return this.get(i,!0,o,h)}optional(i,o,h){return this.get(i,!1,o,h)}success(){return this._valid}get(i,o,h,g){const _=this.feature.properties.hasOwnProperty(i)?+this.feature.properties[i]:void 0;return this._valid&&_!==void 0&&!Number.isNaN(_)?h(g?g(_):_):o&&(this._valid=!1),this}}class y2{constructor(i,o){this.featureFunc=i,this.vertexFunc=o}parseFeature(i,o,h){return this.featureFunc(i,o,h)}parseVertex(i,o,h){return this.vertexFunc(i,o,h)}}const Tu=new y2((c,i,o)=>c.reset(i).require(hm,h=>{o.id=h}).optional("fixed_height_relative",h=>{o.constantHeight=h},Bf.decodeRelativeHeight).geometry(h=>{o.bounds=h},Ym).success(),(c,i,o)=>c.reset(i).require(hm,h=>{o.id=h}).require("elevation_idx",h=>{o.idx=h}).require("extent",h=>{o.extent=h}).require("height_relative",h=>{o.height=h},Bf.decodeRelativeHeight).geometry(h=>{o.position=h},Bf.getPoint).success()),i1=new y2((c,i,o)=>c.reset(i).require(hm,h=>{o.id=h}).optional("fixed_height",h=>{o.constantHeight=h},Bf.decodeMetricHeight).geometry(h=>{o.bounds=h},Ym).success(),(c,i,o)=>c.reset(i).require(hm,h=>{o.id=h}).require("elevation_idx",h=>{o.idx=h}).require("extent",h=>{o.extent=h}).require("height",h=>{o.height=h},Bf.decodeMetricHeight).geometry(h=>{o.position=h},Bf.getPoint).success());class Bf{static getPoint(i){return Xs(i[0][0].x,i[0][0].y)}static decodeRelativeHeight(i){return 1e-4*i*5}static decodeMetricHeight(i){return 1e-4*i}static parse(i){const o=[],h=[],g=i.length,_=new r1;for(let j=0;j<g;j++){const N=i.feature(j),O=N.properties.hasOwnProperty("version")?String(N.properties.version):void 0,L=(w=O)?w==="1.0.1"?i1:void 0:Tu;if(L===void 0){or(`Unknown elevation feature version number ${O||"(unknown)"}`);continue}const B=N.properties.hasOwnProperty("type")?N.properties.type:void 0;if(B){if(yd.VectorTileFeature.types[N.type]==="Point"&&B==="curve_point"){const q={};L.parseVertex(_,N,q)&&o.push(q)}else if(yd.VectorTileFeature.types[N.type]==="Polygon"&&B==="curve_meta"){const q={};L.parseFeature(_,N,q)&&h.push(q)}}}var w;return{vertices:o,features:h}}}class a1{constructor(i,o){this.feature=i,this.metersToTile=o,this.index=0}get(){const i=this.feature.vertices[this.index],o=this.feature.vertexProps[this.index].dir,h=o[1],g=-o[0],_=(i.extent+1)*this.metersToTile;return[new Kt(Math.trunc(i.position[0]+h*_),Math.trunc(i.position[1]+g*_)),new Kt(Math.trunc(i.position[0]-h*_),Math.trunc(i.position[1]-g*_))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class fm{constructor(i,o,h,g,_,w){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=i,this.heightRange={min:h,max:h},this.safeArea=o,this.constantHeight=h,this.constantHeight==null&&(this.constantHeight!=null||g.length!==0)){this.vertices=g,this.edges=_,this.edges=this.edges.filter(j=>{return j.a<this.vertices.length&&j.b<this.vertices.length&&!((N=this.vertices[j.a].position)[0]===(O=this.vertices[j.b].position)[0]&&N[1]===O[1]);var N,O}),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const j of this.vertices)this.vertexProps.push({dir:Xs(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,j.height),this.heightRange.max=Math.max(this.heightRange.max,j.height);for(const j of this.edges){const N=this.vertices[j.a].position,O=this.vertices[j.b].position,L=La(Ji(),O,N),B=Os(L),q=cs(Ji(),L,1/B);this.edgeProps.push({vec:L,dir:q,len:B});const Y=this.vertexProps[j.a].dir,Q=this.vertexProps[j.b].dir;Ka(Y,Y,q),Ka(Q,Q,q)}for(const j of this.vertexProps)j.dir[0]===0&&j.dir[1]===0||vs(j.dir,j.dir);this.tessellate(w)}}pointElevation(i){if(this.constantHeight!=null)return this.constantHeight;const o=this.getClosestEdge(i);if(o==null)return 0;const[h,g]=o;return((_,w,j)=>(1-j)*_+j*w)(this.vertices[this.edges[h].a].height,this.vertices[this.edges[h].b].height,g)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(i){if(this.edges.length===0)return;let o=0,h=Number.POSITIVE_INFINITY,g=0;const _=Xs(i.x,i.y);for(let w=0;w<this.edges.length;w++){const j=this.edges[w],N=this.edgeProps[w].dir,O=new Wo(_,this.edgeProps[w].dir),L=this.vertices[j.a].position,B=this.vertices[j.b].position,q=Ji(),Y=Ji(),Q=O.intersectsPlane(L,this.vertexProps[j.a].dir,q),re=O.intersectsPlane(B,this.vertexProps[j.b].dir,Y);if(!Q||!re)continue;const he=La(Ji(),Y,q),pe=La(Ji(),_,q),Se=yi(he,he),be=Se>0?yi(pe,he)/Se:0,oe=Le(be,0,1),xe=Math.abs((be-oe)*this.edgeProps[w].len),we=La(Ji(),_,L),je=xe+Math.abs(yi(we,Xs(N[1],-N[0])));je<h&&(o=w,h=je,g=oe)}return[o,g]}tessellate(i){for(let o=this.edges.length-1;o>=0;--o){const h=this.edges[o].a,g=this.edges[o].b,{position:_,height:w,extent:j}=this.vertices[h],{position:N,height:O,extent:L}=this.vertices[g],B=this.vertexProps[h].dir,q=this.vertexProps[g].dir,Y=Nt(_[0]/i,_[1]/i,w),Q=Nt(N[0]/i,N[1]/i,O),re=Nt(B[1],-B[0],0);Ge(re,re,j);const he=Nt(q[1],-q[0],0);if(Ge(he,he,L),this.distSqLines(Nt(Y[0]+.5*re[0],Y[1]+.5*re[1],Y[2]+.5*re[2]),Nt(Q[0]-.5*he[0],Q[1]-.5*he[1],Q[2]-.5*he[2]),Nt(Y[0]-.5*re[0],Y[1]-.5*re[1],Y[2]-.5*re[2]),Nt(Q[0]+.5*he[0],Q[1]+.5*he[1],Q[2]+.5*he[2]))<=.0025000000000000005)continue;const pe=this.vertices.length,Se=Ka(Ji(),_,N);this.vertices.push({position:cs(Se,Se,.5),height:.5*(w+O),extent:.5*(j+L)});const be=Ka(Ji(),B,q);this.vertexProps.push({dir:vs(be,be)}),this.edges.splice(o,1),this.edgeProps.splice(o,1),this.edges.push({a:h,b:pe}),this.edges.push({a:pe,b:g});const oe=La(Ji(),this.vertices[pe].position,_),xe=Os(oe),we={vec:oe,dir:cs(Ji(),oe,1/xe),len:xe};this.edgeProps.push(we),this.edgeProps.push(we)}}distSqLines(i,o,h,g){const _=He(nt(),o,i),w=He(nt(),g,h),j=He(nt(),i,h),N=vn(_,_),O=vn(_,w),L=vn(_,j),B=vn(w,w),q=vn(w,j),Y=N*B-O*O;if(Y===0){const he=vn(j,w)/vn(w,w);return mt(Sr(nt(),h,g,he),i)}const Q=(O*q-L*B)/Y,re=(N*q-O*L)/Y;return mt(Sr(nt(),i,o,Q),Sr(nt(),h,g,re))}}class kl{static parseFrom(i,o){const h=Bf.parse(i);if(!h)return[];let{vertices:g,features:_}=h;const w=1/Je(o);_.sort((L,B)=>L.id-B.id),g.sort((L,B)=>L.id-B.id||L.idx-B.idx),g=g.filter((L,B,q)=>B===q.findIndex(Y=>Y.id===L.id&&Y.idx===L.idx));const j=new Array;let N=0;const O=g.length;for(const L of _){if(L.constantHeight){j.push(new fm(L.id,L.bounds,L.constantHeight));continue}for(;N!==O&&g[N].id<L.id;)N++;if(N===O||g[N].id!==L.id)continue;const B=new Array,q=new Array,Y=N;for(;N!==O&&g[N].id===L.id;){const Q=g[N];if(B.push({position:Q.position,height:Q.height,extent:Q.extent}),N!==Y&&g[N-1].idx===Q.idx-1){const re=N-Y;q.push({a:re-1,b:re})}N++}j.push(new fm(L.id,L.bounds,void 0,B,q,w))}return j}static getElevationFeature(i,o){if(!o)return;const h=+i.properties[hm];return Number.isNaN(h)?void 0:o.find(g=>g.id===h)}}class s1{constructor(i,o){this.zScale=1,this.xOffset=0,this.yOffset=0,i.equals(o)||(this.zScale=Math.pow(2,o.z-i.z),this.xOffset=(i.x*this.zScale-o.x)*en,this.yOffset=(i.y*this.zScale-o.y)*en)}constantElevation(i,o){if(i.constantHeight!=null)return this.computeBiasedHeight(i.constantHeight,o)}pointElevation(i,o,h){const g=this.constantElevation(o,h);return g??(i.x=i.x*this.zScale+this.xOffset,i.y=i.y*this.zScale+this.yOffset,this.computeBiasedHeight(o.pointElevation(i),h))}computeBiasedHeight(i,o){return o<=0?i:i+o*Ue(0,o,i>=0?i:Math.abs(.5*i))}}mn(fm,"ElevationFeature");class x0{constructor(){this.polygons=new Map}add(i,...o){this.polygons.has(i)?this.polygons.get(i).push(...o):this.polygons.set(i,o)}merge(i){for(const[o,h]of i.polygons)this.add(o,...h)}}class dl{constructor(){this.portals=[]}static evaluate(i){if(i.length===0)return new dl;let o=[];for(const O of i)o.push(...O.portals);if(o.length===0)return new dl;const h=(O,L)=>O<=0&&L<=0||O>=en&&L>=en;for(const O of o){const L=O.va,B=O.vb;(h(L.x,B.x)||h(L.y,B.y))&&(O.type="border")}const g=o.filter(O=>O.type!=="unevaluated"),_=o.filter(O=>O.type==="unevaluated");if(_.length===0)return new dl;_.sort((O,L)=>O.hash===L.hash?O.isTunnel===L.isTunnel?0:O.isTunnel?-1:1:O.hash<L.hash?1:-1),o=g.concat(_);let w=g.length,j=w,N=w;do if(j++,j===o.length||o[w].hash!==o[j].hash){if(j-w==2){N<w&&(o[N]=o[w],o[w]=null);const O=o[N],L=o[j-1];O.type=O.isTunnel!==L.isTunnel?"tunnel":"polygon",O.connection={a:O.connection.a,b:L.connection.a},N++}w=j}while(w!==o.length);return o.splice(N),o.sort((O,L)=>O.hash<L.hash?1:-1),{portals:o}}}mn(dl,"ElevationPortalGraph"),mn(x0,"ElevationPolygons");class aA{constructor(i,o,h){this.outPositions=i,this.outNormals=o,this.outIndices=h,this.vertexLookup=new Map,this.buffer=new ArrayBuffer(4),this.view=new DataView(this.buffer)}addVertex(i,o,h){let g=i[2];h!=null&&(g*=h);const _=this.getVec3Bits(i)<<96n|this.getVec3Bits(o),w=this.vertexLookup.get(_);if(w!=null)return w;const j=this.outPositions.length;this.vertexLookup.set(_,j);const N=Math.trunc(16384*o[0]),O=Math.trunc(16384*o[1]),L=Math.trunc(16384*o[2]);return this.outPositions.emplaceBack(i[0],i[1],g),this.outNormals.emplaceBack(N,O,L),j}addVertices(i,o,...h){const g=[];for(const _ of h){const w=this.addVertex(_,i,o);g.push(w)}return g}addTriangles(i,o,h){if(o&&h){const g=h.length===1,_=Nt(0,0,0);for(let w=0;w<i.length;w+=3){const j=o[i[w+0]],N=o[i[w+1]],O=o[i[w+2]],L=g?h[0]:h[i[w+1]],B=g?h[0]:h[i[w+2]],q=this.addVertex(Nt(j.x,j.y,g?h[0]:h[i[w+0]]),_),Y=this.addVertex(Nt(N.x,N.y,L),_),Q=this.addVertex(Nt(O.x,O.y,B),_);this.outIndices.emplaceBack(q,Y,Q)}}else for(let g=0;g<i.length;g+=3)this.outIndices.emplaceBack(i[g+0],i[g+1],i[g+2])}addQuad(i,o){const h=this.addVertices(o,void 0,...i.map(N=>Nt(N.coord.x,N.coord.y,N.height))),[g,_,w,j]=h;this.addTriangles([g,_,w,w,j,g])}getBits(i){return this.view.setFloat32(0,i),BigInt(this.view.getUint32(0))}getVec3Bits(i){return this.getBits(i[0])<<64n|this.getBits(i[1])<<32n|this.getBits(i[2])}}class Rl{constructor(i){this.unevaluatedPortals=new dl,this.portalPolygons=new x0,this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new Ah,this.vertexNormals=new Ch,this.indexArray=new la,this.tileToMeters=Je(i)}addVertices(i,o){const h=this.unevalVertices.length;for(let g=0;g<i.length;g++)this.unevalVertices.push(i[g]),this.unevalHeights.push(o[g]);return h}addTriangles(i,o,h){const g=h?this.unevalTunnelTriangles:this.unevalTriangles;for(const _ of i)g.push(_+o)}addRenderableRing(i,o,h,g,_){const w=[new Kt(_.min.x,_.min.y),new Kt(_.max.x,_.min.y),new Kt(_.max.x,_.max.y),new Kt(_.min.x,_.max.y)];for(let j=0;j<h-1;j++){const N=o+j,O=N+1,L=this.unevalVertices[N],B=this.unevalVertices[O];if(!(L.x>=_.min.x&&L.x<=_.max.x&&L.y>=_.min.y&&L.y<=_.max.y||B.x>=_.min.x&&B.x<=_.max.x&&B.y>=_.min.y&&B.y<=_.max.y||Pi(L,B,w))||this.isOnBorder(L.x,B.x)||this.isOnBorder(L.y,B.y))continue;const q=Rl.computeEdgeHash(this.unevalVertices[N],this.unevalVertices[O]);let Y,Q=this.vertexHashLookup.get(Rl.computePosHash(L));Q!=null?Y=Q.next:(Q=this.vertexHashLookup.get(Rl.computePosHash(B)),Y=Q!=null?Q.prev:q),this.unevalEdges.push({polygonIdx:i,a:N,b:O,hash:q,portalHash:Y,isTunnel:g,type:"unevaluated"})}}addPortalCandidates(i,o,h,g,_){if(o.length===0)return;this.portalPolygons.add(i,{geometry:o,zLevel:_});const w=o[0];this.vertexHashLookup.clear();let j=Rl.computeEdgeHash(w[w.length-2],w[w.length-1]);for(let N=0;N<w.length-1;N++){const O=w[N+0],L=w[N+1],B=Xs(L.x-O.x,L.y-O.y),q=Os(B);if(q===0)continue;let Y="unevaluated";const Q=g.pointElevation(O),re=g.pointElevation(L);Math.abs(Q)<.01&&Math.abs(re)<.01?Y="entrance":(this.isOnBorder(O.x,L.x)||this.isOnBorder(O.y,L.y))&&(Y="border");const he=Rl.computeEdgeHash(O,L);this.unevaluatedPortals.portals.push({connection:{a:i,b:void 0},va:O,vb:L,vab:B,length:q,hash:he,isTunnel:h,type:Y});const pe=Rl.computePosHash(O);this.vertexHashLookup.set(pe,{prev:j,next:he}),j=he}}construct(i){if(this.unevalVertices.length===0)return;const o=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),h=B=>{B.primitiveLength=this.indexArray.length-B.primitiveOffset},g=new aA(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(i.portals,this.unevalEdges);const _=o(),w=o(),j=o(),N=(B,q)=>{B.sort((Q,re)=>Q.type===q&&re.type!==q?-1:Q.type!==q&&re.type===q?1:0);const Y=B.findIndex(Q=>Q.type!==q);return Y>=0?Y:B.length};let O=0;this.unevalEdges.length>0&&(O=N(this.unevalEdges,"none"),this.constructBridgeStructures(g,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:O},this.tileToMeters));const L=o();if(this.unevalEdges.length>0){const B=this.unevalEdges.splice(O),q=N(B,"tunnel")+O;this.unevalEdges.push(...B),this.constructTunnelStructures(g,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:O},{min:O,max:q})}h(j),g.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),h(L),g.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),h(w),g.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),h(_),this.maskSegments=Wi.simpleSegment(0,L.primitiveOffset,0,L.primitiveLength),this.depthSegments=Wi.simpleSegment(0,w.primitiveOffset,0,w.primitiveLength),this.renderableSegments=Wi.simpleSegment(0,j.primitiveOffset,0,j.primitiveLength),this.shadowCasterSegments=Wi.simpleSegment(0,_.primitiveOffset,0,_.primitiveLength)}upload(i){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=i.createVertexBuffer(this.vertexPositions,c2.members),this.vertexBufferNormal=i.createVertexBuffer(this.vertexNormals,u2.members),this.indexBuffer=i.createIndexBuffer(this.indexArray))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableSegments.destroy(),this.shadowCasterSegments.destroy())}computeVertexConnections(i,o,h,g,_){const w=new Map;for(let j=g;j<_;j++){const N=h[j],O=N.a,L=N.b,B=Rl.computePosHash(i[O]),q=Rl.computePosHash(i[L]);w.has(B)||w.set(B,{}),w.has(q)||w.set(q,{});const Y=w.get(B),Q=w.get(q);o[O]<=0&&o[L]<=0||(Y.to=L,Q.from=O)}return w}constructBridgeStructures(i,o,h,g,_,w){const j=this.computeVertexConnections(o,h,g,_.min,_.max),N=1/w,O=.5*N,L=q=>Nt(o[q].x,o[q].y,h[q]*N),B=q=>{const Y=j.get(Rl.computePosHash(o[q])),Q=Y.from,re=Y.to;if(!Q||!re)return;const he=L(Q),pe=L(q),Se=L(re),be=Nt(0,0,0);if(!dn(he,pe)){const xe=Ir(nt(),pe,he);vt(be,be,Mn(xe,xe))}if(!dn(Se,pe)){const xe=Ir(nt(),Se,pe);vt(be,be,Mn(xe,xe))}const oe=sa(be);return oe>0?Ge(be,be,1/oe):void 0};for(let q=_.min;q<_.max;q++){const Y=g[q],Q=this.prepareEdgePoints(o,h,Y,(Ut,sr)=>Ut>sr);if(Q==null)continue;const re=Q[0],he=Q[1],pe=Nt(re.coord.x,re.coord.y,N*re.height),Se=Nt(he.coord.x,he.coord.y,N*he.height);if(dn(pe,Se))continue;const be=Ir(nt(),Se,pe);Mn(be,be);const oe=Ut=>Mn(Ut,Ut),xe=B(Y.a)||be,we=B(Y.b)||be,je=oe(Nt(xe[1],-xe[0],0)),Ve=oe(Nt(we[1],-we[0],0)),We=oe(Zn(nt(),je,xe)),Ze=oe(Zn(nt(),Ve,we)),Qe=nt(),pt=[vt(nt(),pe,Ge(Qe,Ir(Qe,je,We),O)),vt(nt(),pe,Ge(Qe,vt(Qe,je,We),O)),vt(nt(),pe,Ge(Qe,We,O)),pe],kt=[vt(nt(),Se,Ge(Qe,Ir(Qe,Ve,Ze),O)),vt(nt(),Se,Ge(Qe,vt(Qe,Ve,Ze),O)),vt(nt(),Se,Ge(Qe,Ze,O)),Se],[Ct,Pt]=i.addVertices(je,w,pt[0],pt[1]),[Vt,ht]=i.addVertices(Ve,w,kt[0],kt[1]);i.addTriangles([Ct,Pt,Vt,Pt,ht,Vt]);const[Mt,dt]=i.addVertices(We,w,pt[1],pt[2]),[ft,$t]=i.addVertices(Ze,w,kt[1],kt[2]);i.addTriangles([Mt,dt,ft,dt,$t,ft]);const[Gt,Dn]=i.addVertices(In(je,je),w,pt[2],pt[3]),[bn,an]=i.addVertices(In(Ve,Ve),w,kt[2],kt[3]);i.addTriangles([Gt,Dn,bn,Dn,an,bn])}}constructTunnelStructures(i,o,h,g,_,w){const j=N=>Mn(N,N);for(let N=_.min;N<_.max;N++){const O=this.prepareEdgePoints(o,h,g[N],(Y,Q)=>Y<Q);if(O==null)continue;const[L,B]=O,q=j(Nt(B.coord.y-L.coord.y,-(B.coord.x-L.coord.x),0));i.addQuad([L,B,{coord:B.coord,height:g[N].isTunnel?-.1:0},{coord:L.coord,height:g[N].isTunnel?-.1:0}],q)}for(let N=w.min;N<w.max;N++){const O=g[N],L=o[O.a],B=o[O.b],q=j(Nt(B.y-L.y,-(B.x-L.x),0));i.addQuad([{coord:B,height:0},{coord:L,height:0},{coord:L,height:h[O.a]+4},{coord:B,height:h[O.b]+4}],q),i.addQuad([{coord:L,height:0},{coord:B,height:0},{coord:B,height:h[O.b]+4},{coord:L,height:h[O.a]+4}],q)}}prepareEdgePoints(i,o,h,g){let _=o[h.a],w=o[h.b];const j=g(_,0),N=g(w,0);if(j&&N)return[{coord:i[h.a],height:_},{coord:i[h.b],height:w}];if(!j&&!N)return;const O=i[h.a].clone(),L=i[h.b].clone();if(j){if(!N){const B=w/(w-_);L.x=Vn(L.x,O.x,B),L.y=Vn(L.y,O.y,B),w=Vn(w,_,B)}}else{const B=_/(_-w);O.x=Vn(O.x,L.x,B),O.y=Vn(O.y,L.y,B),_=Vn(_,w,B)}return[{coord:O,height:_},{coord:L,height:w}]}prepareEdges(i,o){if(o.length===0)return;o.sort((j,N)=>j.hash===N.hash?N.polygonIdx-j.polygonIdx:N.hash>j.hash?1:-1);let h=0,g=0,_=0,w=o[h].polygonIdx;do g++,(g===o.length||o[h].hash!==o[g].hash)&&((g-h==1||o[g-1].polygonIdx!==w)&&(_<h&&(o[_]=o[h],o[h]=null),o[_].type="none",_++),h=g,h!==o.length&&(w=o[h].polygonIdx));while(h!==o.length);if(o.splice(_),o.length!==0&&i.length!==0){o.sort((O,L)=>O.portalHash<L.portalHash?1:-1);let j=0,N=0;for(;j!==o.length&&N!==i.length;){const O=o[j],L=i[N];O.portalHash>L.hash?j++:L.hash>O.portalHash?N++:(O.type=L.type,j++)}}}isOnBorder(i,o){return i<=0&&o<=0||i>=en&&o>=en}static computeEdgeHash(i,o){return(i.y===o.y&&i.x>o.x||i.y>o.y)&&([i,o]=[o,i]),BigInt(Rl.computePosHash(i))<<32n|BigInt(Rl.computePosHash(o))}static computePosHash(i){return((65535&i.x)<<16|65535&i.y)>>>0}}var pm,o1={exports:{}},v2=(pm||(pm=1,function(c,i){(function(o){function h(Ae,Ne){return Ae>Ne?1:Ae<Ne?-1:0}var g=function(Ae,Ne){Ae===void 0&&(Ae=h),Ne===void 0&&(Ne=!1),this._compare=Ae,this._root=null,this._size=0,this._noDuplicates=!!Ne},_={size:{configurable:!0}};function w(Ae,Ne,yt,Qt,cn){var on=cn-Qt;if(on>0){var Nn=Qt+Math.floor(on/2),Xn={key:Ne[Nn],data:yt[Nn],parent:Ae};return Xn.left=w(Xn,Ne,yt,Qt,Nn),Xn.right=w(Xn,Ne,yt,Nn+1,cn),Xn}return null}function j(Ae,Ne,yt,Qt,cn){if(!(yt>=Qt)){for(var on=Ae[yt+Qt>>1],Nn=yt-1,Xn=Qt+1;;){do Nn++;while(cn(Ae[Nn],on)<0);do Xn--;while(cn(Ae[Xn],on)>0);if(Nn>=Xn)break;var Pr=Ae[Nn];Ae[Nn]=Ae[Xn],Ae[Xn]=Pr,Pr=Ne[Nn],Ne[Nn]=Ne[Xn],Ne[Xn]=Pr}j(Ae,Ne,yt,Xn,cn),j(Ae,Ne,Xn+1,Qt,cn)}}g.prototype.rotateLeft=function(Ae){var Ne=Ae.right;Ne&&(Ae.right=Ne.left,Ne.left&&(Ne.left.parent=Ae),Ne.parent=Ae.parent),Ae.parent?Ae===Ae.parent.left?Ae.parent.left=Ne:Ae.parent.right=Ne:this._root=Ne,Ne&&(Ne.left=Ae),Ae.parent=Ne},g.prototype.rotateRight=function(Ae){var Ne=Ae.left;Ne&&(Ae.left=Ne.right,Ne.right&&(Ne.right.parent=Ae),Ne.parent=Ae.parent),Ae.parent?Ae===Ae.parent.left?Ae.parent.left=Ne:Ae.parent.right=Ne:this._root=Ne,Ne&&(Ne.right=Ae),Ae.parent=Ne},g.prototype._splay=function(Ae){for(;Ae.parent;){var Ne=Ae.parent;Ne.parent?Ne.left===Ae&&Ne.parent.left===Ne?(this.rotateRight(Ne.parent),this.rotateRight(Ne)):Ne.right===Ae&&Ne.parent.right===Ne?(this.rotateLeft(Ne.parent),this.rotateLeft(Ne)):Ne.left===Ae&&Ne.parent.right===Ne?(this.rotateRight(Ne),this.rotateLeft(Ne)):(this.rotateLeft(Ne),this.rotateRight(Ne)):Ne.left===Ae?this.rotateRight(Ne):this.rotateLeft(Ne)}},g.prototype.splay=function(Ae){for(var Ne,yt,Qt,cn,on;Ae.parent;)(yt=(Ne=Ae.parent).parent)&&yt.parent?((Qt=yt.parent).left===yt?Qt.left=Ae:Qt.right=Ae,Ae.parent=Qt):(Ae.parent=null,this._root=Ae),cn=Ae.left,on=Ae.right,Ae===Ne.left?(yt&&(yt.left===Ne?(Ne.right?(yt.left=Ne.right,yt.left.parent=yt):yt.left=null,Ne.right=yt,yt.parent=Ne):(cn?(yt.right=cn,cn.parent=yt):yt.right=null,Ae.left=yt,yt.parent=Ae)),on?(Ne.left=on,on.parent=Ne):Ne.left=null,Ae.right=Ne,Ne.parent=Ae):(yt&&(yt.right===Ne?(Ne.left?(yt.right=Ne.left,yt.right.parent=yt):yt.right=null,Ne.left=yt,yt.parent=Ne):(on?(yt.left=on,on.parent=yt):yt.left=null,Ae.right=yt,yt.parent=Ae)),cn?(Ne.right=cn,cn.parent=Ne):Ne.right=null,Ae.left=Ne,Ne.parent=Ae)},g.prototype.replace=function(Ae,Ne){Ae.parent?Ae===Ae.parent.left?Ae.parent.left=Ne:Ae.parent.right=Ne:this._root=Ne,Ne&&(Ne.parent=Ae.parent)},g.prototype.minNode=function(Ae){if(Ae===void 0&&(Ae=this._root),Ae)for(;Ae.left;)Ae=Ae.left;return Ae},g.prototype.maxNode=function(Ae){if(Ae===void 0&&(Ae=this._root),Ae)for(;Ae.right;)Ae=Ae.right;return Ae},g.prototype.insert=function(Ae,Ne){var yt=this._root,Qt=null,cn=this._compare;if(this._noDuplicates)for(;yt;){if(Qt=yt,cn(yt.key,Ae)===0)return;yt=cn(yt.key,Ae)<0?yt.right:yt.left}else for(;yt;)Qt=yt,yt=cn(yt.key,Ae)<0?yt.right:yt.left;return yt={key:Ae,data:Ne,left:null,right:null,parent:Qt},Qt?cn(Qt.key,yt.key)<0?Qt.right=yt:Qt.left=yt:this._root=yt,this.splay(yt),this._size++,yt},g.prototype.find=function(Ae){for(var Ne=this._root,yt=this._compare;Ne;){var Qt=yt(Ne.key,Ae);if(Qt<0)Ne=Ne.right;else{if(!(Qt>0))return Ne;Ne=Ne.left}}return null},g.prototype.contains=function(Ae){for(var Ne=this._root,yt=this._compare;Ne;){var Qt=yt(Ae,Ne.key);if(Qt===0)return!0;Ne=Qt<0?Ne.left:Ne.right}return!1},g.prototype.remove=function(Ae){var Ne=this.find(Ae);if(!Ne)return!1;if(this.splay(Ne),Ne.left)if(Ne.right){var yt=this.minNode(Ne.right);yt.parent!==Ne&&(this.replace(yt,yt.right),yt.right=Ne.right,yt.right.parent=yt),this.replace(Ne,yt),yt.left=Ne.left,yt.left.parent=yt}else this.replace(Ne,Ne.left);else this.replace(Ne,Ne.right);return this._size--,!0},g.prototype.removeNode=function(Ae){if(!Ae)return!1;if(this.splay(Ae),Ae.left)if(Ae.right){var Ne=this.minNode(Ae.right);Ne.parent!==Ae&&(this.replace(Ne,Ne.right),Ne.right=Ae.right,Ne.right.parent=Ne),this.replace(Ae,Ne),Ne.left=Ae.left,Ne.left.parent=Ne}else this.replace(Ae,Ae.left);else this.replace(Ae,Ae.right);return this._size--,!0},g.prototype.erase=function(Ae){var Ne=this.find(Ae);if(Ne){this.splay(Ne);var yt=Ne.left,Qt=Ne.right,cn=null;yt&&(yt.parent=null,cn=this.maxNode(yt),this.splay(cn),this._root=cn),Qt&&(yt?cn.right=Qt:this._root=Qt,Qt.parent=cn),this._size--}},g.prototype.pop=function(){var Ae=this._root,Ne=null;if(Ae){for(;Ae.left;)Ae=Ae.left;Ne={key:Ae.key,data:Ae.data},this.remove(Ae.key)}return Ne},g.prototype.next=function(Ae){var Ne=Ae;if(Ne)if(Ne.right)for(Ne=Ne.right;Ne&&Ne.left;)Ne=Ne.left;else for(Ne=Ae.parent;Ne&&Ne.right===Ae;)Ae=Ne,Ne=Ne.parent;return Ne},g.prototype.prev=function(Ae){var Ne=Ae;if(Ne)if(Ne.left)for(Ne=Ne.left;Ne&&Ne.right;)Ne=Ne.right;else for(Ne=Ae.parent;Ne&&Ne.left===Ae;)Ae=Ne,Ne=Ne.parent;return Ne},g.prototype.forEach=function(Ae){for(var Ne=this._root,yt=[],Qt=!1,cn=0;!Qt;)Ne?(yt.push(Ne),Ne=Ne.left):yt.length>0?(Ae(Ne=yt.pop(),cn++),Ne=Ne.right):Qt=!0;return this},g.prototype.range=function(Ae,Ne,yt,Qt){for(var cn=[],on=this._compare,Nn=this._root;cn.length!==0||Nn;)if(Nn)cn.push(Nn),Nn=Nn.left;else{if(on((Nn=cn.pop()).key,Ne)>0)break;if(on(Nn.key,Ae)>=0&&yt.call(Qt,Nn))return this;Nn=Nn.right}return this},g.prototype.keys=function(){for(var Ae=this._root,Ne=[],yt=[],Qt=!1;!Qt;)Ae?(Ne.push(Ae),Ae=Ae.left):Ne.length>0?(Ae=Ne.pop(),yt.push(Ae.key),Ae=Ae.right):Qt=!0;return yt},g.prototype.values=function(){for(var Ae=this._root,Ne=[],yt=[],Qt=!1;!Qt;)Ae?(Ne.push(Ae),Ae=Ae.left):Ne.length>0?(Ae=Ne.pop(),yt.push(Ae.data),Ae=Ae.right):Qt=!0;return yt},g.prototype.at=function(Ae){for(var Ne=this._root,yt=[],Qt=!1,cn=0;!Qt;)if(Ne)yt.push(Ne),Ne=Ne.left;else if(yt.length>0){if(Ne=yt.pop(),cn===Ae)return Ne;cn++,Ne=Ne.right}else Qt=!0;return null},g.prototype.load=function(Ae,Ne,yt){if(Ae===void 0&&(Ae=[]),Ne===void 0&&(Ne=[]),yt===void 0&&(yt=!1),this._size!==0)throw new Error("bulk-load: tree is not empty");var Qt=Ae.length;return yt&&j(Ae,Ne,0,Qt-1,this._compare),this._root=w(null,Ae,Ne,0,Qt),this._size=Qt,this},g.prototype.min=function(){var Ae=this.minNode(this._root);return Ae?Ae.key:null},g.prototype.max=function(){var Ae=this.maxNode(this._root);return Ae?Ae.key:null},g.prototype.isEmpty=function(){return this._root===null},_.size.get=function(){return this._size},g.createTree=function(Ae,Ne,yt,Qt,cn){return new g(yt,cn).load(Ae,Ne,Qt)},Object.defineProperties(g.prototype,_);var N=0,O=1,L=2,B=3,q=0,Y=1,Q=2,re=3;function he(Ae,Ne,yt){Ne===null?(Ae.inOut=!1,Ae.otherInOut=!0):(Ae.isSubject===Ne.isSubject?(Ae.inOut=!Ne.inOut,Ae.otherInOut=Ne.otherInOut):(Ae.inOut=!Ne.otherInOut,Ae.otherInOut=Ne.isVertical()?!Ne.inOut:Ne.inOut),Ne&&(Ae.prevInResult=!pe(Ne,yt)||Ne.isVertical()?Ne.prevInResult:Ne));var Qt=pe(Ae,yt);Ae.resultTransition=Qt?function(cn,on){var Nn,Xn=!cn.inOut,Pr=!cn.otherInOut;switch(on){case q:Nn=Xn&&Pr;break;case Y:Nn=Xn||Pr;break;case re:Nn=Xn^Pr;break;case Q:Nn=cn.isSubject?Xn&&!Pr:Pr&&!Xn}return Nn?1:-1}(Ae,yt):0}function pe(Ae,Ne){switch(Ae.type){case N:switch(Ne){case q:return!Ae.otherInOut;case Y:return Ae.otherInOut;case Q:return Ae.isSubject&&Ae.otherInOut||!Ae.isSubject&&!Ae.otherInOut;case re:return!0}break;case L:return Ne===q||Ne===Y;case B:return Ne===Q;case O:return!1}return!1}var Se=function(Ae,Ne,yt,Qt,cn){this.left=Ne,this.point=Ae,this.otherEvent=yt,this.isSubject=Qt,this.type=cn||N,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},be={inResult:{configurable:!0}};function oe(Ae,Ne){return Ae[0]===Ne[0]&&Ae[1]===Ne[1]}Se.prototype.isBelow=function(Ae){var Ne=this.point,yt=this.otherEvent.point;return this.left?(Ne[0]-Ae[0])*(yt[1]-Ae[1])-(yt[0]-Ae[0])*(Ne[1]-Ae[1])>0:(yt[0]-Ae[0])*(Ne[1]-Ae[1])-(Ne[0]-Ae[0])*(yt[1]-Ae[1])>0},Se.prototype.isAbove=function(Ae){return!this.isBelow(Ae)},Se.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},be.inResult.get=function(){return this.resultTransition!==0},Se.prototype.clone=function(){var Ae=new Se(this.point,this.left,this.otherEvent,this.isSubject,this.type);return Ae.contourId=this.contourId,Ae.resultTransition=this.resultTransition,Ae.prevInResult=this.prevInResult,Ae.isExteriorRing=this.isExteriorRing,Ae.inOut=this.inOut,Ae.otherInOut=this.otherInOut,Ae},Object.defineProperties(Se.prototype,be);var xe=11102230246251565e-32,we=134217729,je=(3+8*xe)*xe;function Ve(Ae,Ne,yt,Qt,cn){var on,Nn,Xn,Pr,Nr=Ne[0],gr=Qt[0],gi=0,Ii=0;gr>Nr==gr>-Nr?(on=Nr,Nr=Ne[++gi]):(on=gr,gr=Qt[++Ii]);var Dr=0;if(gi<Ae&&Ii<yt)for(gr>Nr==gr>-Nr?(Xn=on-((Nn=Nr+on)-Nr),Nr=Ne[++gi]):(Xn=on-((Nn=gr+on)-gr),gr=Qt[++Ii]),on=Nn,Xn!==0&&(cn[Dr++]=Xn);gi<Ae&&Ii<yt;)gr>Nr==gr>-Nr?(Xn=on-((Nn=on+Nr)-(Pr=Nn-on))+(Nr-Pr),Nr=Ne[++gi]):(Xn=on-((Nn=on+gr)-(Pr=Nn-on))+(gr-Pr),gr=Qt[++Ii]),on=Nn,Xn!==0&&(cn[Dr++]=Xn);for(;gi<Ae;)Xn=on-((Nn=on+Nr)-(Pr=Nn-on))+(Nr-Pr),Nr=Ne[++gi],on=Nn,Xn!==0&&(cn[Dr++]=Xn);for(;Ii<yt;)Xn=on-((Nn=on+gr)-(Pr=Nn-on))+(gr-Pr),gr=Qt[++Ii],on=Nn,Xn!==0&&(cn[Dr++]=Xn);return on===0&&Dr!==0||(cn[Dr++]=on),Dr}function We(Ae){return new Float64Array(Ae)}var Ze=33306690738754716e-32,Qe=22204460492503146e-32,pt=11093356479670487e-47,kt=We(4),Ct=We(8),Pt=We(12),Vt=We(16),ht=We(4);function Mt(Ae,Ne,yt){var Qt=function(cn,on,Nn,Xn,Pr,Nr){var gr=(on-Nr)*(Nn-Pr),gi=(cn-Pr)*(Xn-Nr),Ii=gr-gi;if(gr===0||gi===0||gr>0!=gi>0)return Ii;var Dr=Math.abs(gr+gi);return Math.abs(Ii)>=Ze*Dr?Ii:-function(ra,Li,fi,ua,Ui,ki,Fi){var wi,vr,Si,ia,Gn,$r,$i,oa,Zi,qa,Ai,Ba,Ll,oo,Vs,Fl,qf,Ha,as=ra-Ui,lo=fi-Ui,Zo=Li-ki,Co=ua-ki;kt[0]=(Vs=(oa=as-($i=($r=we*as)-($r-as)))*(qa=Co-(Zi=($r=we*Co)-($r-Co)))-((oo=as*Co)-$i*Zi-oa*Zi-$i*qa))-((Ai=Vs-(qf=(oa=Zo-($i=($r=we*Zo)-($r-Zo)))*(qa=lo-(Zi=($r=we*lo)-($r-lo)))-((Fl=Zo*lo)-$i*Zi-oa*Zi-$i*qa)))+(Gn=Vs-Ai))+(Gn-qf),kt[1]=(Ll=oo-((Ba=oo+Ai)-(Gn=Ba-oo))+(Ai-Gn))-((Ai=Ll-Fl)+(Gn=Ll-Ai))+(Gn-Fl),kt[2]=Ba-((Ha=Ba+Ai)-(Gn=Ha-Ba))+(Ai-Gn),kt[3]=Ha;var zg=function(h6e,mR){for(var gR=mR[0],tC=1;tC<4;tC++)gR+=mR[tC];return gR}(0,kt),H1=Qe*Fi;if(zg>=H1||-zg>=H1||(wi=ra-(as+(Gn=ra-as))+(Gn-Ui),Si=fi-(lo+(Gn=fi-lo))+(Gn-Ui),vr=Li-(Zo+(Gn=Li-Zo))+(Gn-ki),ia=ua-(Co+(Gn=ua-Co))+(Gn-ki),wi===0&&vr===0&&Si===0&&ia===0)||(H1=pt*Fi+je*Math.abs(zg),(zg+=as*ia+Co*wi-(Zo*Si+lo*vr))>=H1||-zg>=H1))return zg;ht[0]=(Vs=(oa=wi-($i=($r=we*wi)-($r-wi)))*(qa=Co-(Zi=($r=we*Co)-($r-Co)))-((oo=wi*Co)-$i*Zi-oa*Zi-$i*qa))-((Ai=Vs-(qf=(oa=vr-($i=($r=we*vr)-($r-vr)))*(qa=lo-(Zi=($r=we*lo)-($r-lo)))-((Fl=vr*lo)-$i*Zi-oa*Zi-$i*qa)))+(Gn=Vs-Ai))+(Gn-qf),ht[1]=(Ll=oo-((Ba=oo+Ai)-(Gn=Ba-oo))+(Ai-Gn))-((Ai=Ll-Fl)+(Gn=Ll-Ai))+(Gn-Fl),ht[2]=Ba-((Ha=Ba+Ai)-(Gn=Ha-Ba))+(Ai-Gn),ht[3]=Ha;var JJ=Ve(4,kt,4,ht,Ct);ht[0]=(Vs=(oa=as-($i=($r=we*as)-($r-as)))*(qa=ia-(Zi=($r=we*ia)-($r-ia)))-((oo=as*ia)-$i*Zi-oa*Zi-$i*qa))-((Ai=Vs-(qf=(oa=Zo-($i=($r=we*Zo)-($r-Zo)))*(qa=Si-(Zi=($r=we*Si)-($r-Si)))-((Fl=Zo*Si)-$i*Zi-oa*Zi-$i*qa)))+(Gn=Vs-Ai))+(Gn-qf),ht[1]=(Ll=oo-((Ba=oo+Ai)-(Gn=Ba-oo))+(Ai-Gn))-((Ai=Ll-Fl)+(Gn=Ll-Ai))+(Gn-Fl),ht[2]=Ba-((Ha=Ba+Ai)-(Gn=Ha-Ba))+(Ai-Gn),ht[3]=Ha;var eee=Ve(JJ,Ct,4,ht,Pt);ht[0]=(Vs=(oa=wi-($i=($r=we*wi)-($r-wi)))*(qa=ia-(Zi=($r=we*ia)-($r-ia)))-((oo=wi*ia)-$i*Zi-oa*Zi-$i*qa))-((Ai=Vs-(qf=(oa=vr-($i=($r=we*vr)-($r-vr)))*(qa=Si-(Zi=($r=we*Si)-($r-Si)))-((Fl=vr*Si)-$i*Zi-oa*Zi-$i*qa)))+(Gn=Vs-Ai))+(Gn-qf),ht[1]=(Ll=oo-((Ba=oo+Ai)-(Gn=Ba-oo))+(Ai-Gn))-((Ai=Ll-Fl)+(Gn=Ll-Ai))+(Gn-Fl),ht[2]=Ba-((Ha=Ba+Ai)-(Gn=Ha-Ba))+(Ai-Gn),ht[3]=Ha;var tee=Ve(eee,Pt,4,ht,Vt);return Vt[tee-1]}(cn,on,Nn,Xn,Pr,Nr,Dr)}(Ae[0],Ae[1],Ne[0],Ne[1],yt[0],yt[1]);return Qt>0?-1:Qt<0?1:0}function dt(Ae,Ne){var yt=Ae.point,Qt=Ne.point;return yt[0]>Qt[0]?1:yt[0]<Qt[0]?-1:yt[1]!==Qt[1]?yt[1]>Qt[1]?1:-1:function(cn,on,Nn,Xn){return cn.left!==on.left?cn.left?1:-1:Mt(Nn,cn.otherEvent.point,on.otherEvent.point)!==0?cn.isBelow(on.otherEvent.point)?-1:1:!cn.isSubject&&on.isSubject?1:-1}(Ae,Ne,yt)}function ft(Ae,Ne,yt){var Qt=new Se(Ne,!1,Ae,Ae.isSubject),cn=new Se(Ne,!0,Ae.otherEvent,Ae.isSubject);return oe(Ae.point,Ae.otherEvent.point)&&console.warn("what is that, a collapsed segment?",Ae),Qt.contourId=cn.contourId=Ae.contourId,dt(cn,Ae.otherEvent)>0&&(Ae.otherEvent.left=!0,cn.left=!1),Ae.otherEvent.otherEvent=cn,Ae.otherEvent=Qt,yt.push(cn),yt.push(Qt),yt}function $t(Ae,Ne){return Ae[0]*Ne[1]-Ae[1]*Ne[0]}function Gt(Ae,Ne){return Ae[0]*Ne[0]+Ae[1]*Ne[1]}function Dn(Ae,Ne,yt){var Qt=function(Pr,Nr,gr,gi,Ii){var Dr=[Nr[0]-Pr[0],Nr[1]-Pr[1]],ra=[gi[0]-gr[0],gi[1]-gr[1]];function Li($r,$i,oa){return[$r[0]+$i*oa[0],$r[1]+$i*oa[1]]}var fi=[gr[0]-Pr[0],gr[1]-Pr[1]],ua=$t(Dr,ra),Ui=ua*ua,ki=Gt(Dr,Dr);if(Ui>0){var Fi=$t(fi,ra)/ua;if(Fi<0||Fi>1)return null;var wi=$t(fi,Dr)/ua;return wi<0||wi>1?null:Fi===0||Fi===1?[Li(Pr,Fi,Dr)]:wi===0||wi===1?[Li(gr,wi,ra)]:[Li(Pr,Fi,Dr)]}if((Ui=(ua=$t(fi,Dr))*ua)>0)return null;var vr=Gt(Dr,fi)/ki,Si=vr+Gt(Dr,ra)/ki,ia=Math.min(vr,Si),Gn=Math.max(vr,Si);return ia<=1&&Gn>=0?ia===1?[Li(Pr,ia>0?ia:0,Dr)]:Gn===0?[Li(Pr,Gn<1?Gn:1,Dr)]:[Li(Pr,ia>0?ia:0,Dr),Li(Pr,Gn<1?Gn:1,Dr)]:null}(Ae.point,Ae.otherEvent.point,Ne.point,Ne.otherEvent.point),cn=Qt?Qt.length:0;if(cn===0||cn===1&&(oe(Ae.point,Ne.point)||oe(Ae.otherEvent.point,Ne.otherEvent.point))||cn===2&&Ae.isSubject===Ne.isSubject)return 0;if(cn===1)return oe(Ae.point,Qt[0])||oe(Ae.otherEvent.point,Qt[0])||ft(Ae,Qt[0],yt),oe(Ne.point,Qt[0])||oe(Ne.otherEvent.point,Qt[0])||ft(Ne,Qt[0],yt),1;var on=[],Nn=!1,Xn=!1;return oe(Ae.point,Ne.point)?Nn=!0:dt(Ae,Ne)===1?on.push(Ne,Ae):on.push(Ae,Ne),oe(Ae.otherEvent.point,Ne.otherEvent.point)?Xn=!0:dt(Ae.otherEvent,Ne.otherEvent)===1?on.push(Ne.otherEvent,Ae.otherEvent):on.push(Ae.otherEvent,Ne.otherEvent),Nn&&Xn||Nn?(Ne.type=O,Ae.type=Ne.inOut===Ae.inOut?L:B,Nn&&!Xn&&ft(on[1].otherEvent,on[0].point,yt),2):Xn?(ft(on[0],on[1].point,yt),3):on[0]!==on[3].otherEvent?(ft(on[0],on[1].point,yt),ft(on[1],on[2].point,yt),3):(ft(on[0],on[1].point,yt),ft(on[3].otherEvent,on[2].point,yt),3)}function bn(Ae,Ne){if(Ae===Ne)return 0;if(Mt(Ae.point,Ae.otherEvent.point,Ne.point)!==0||Mt(Ae.point,Ae.otherEvent.point,Ne.otherEvent.point)!==0)return oe(Ae.point,Ne.point)?Ae.isBelow(Ne.otherEvent.point)?-1:1:Ae.point[0]===Ne.point[0]?Ae.point[1]<Ne.point[1]?-1:1:dt(Ae,Ne)===1?Ne.isAbove(Ae.point)?-1:1:Ae.isBelow(Ne.point)?-1:1;if(Ae.isSubject!==Ne.isSubject)return Ae.isSubject?-1:1;var yt=Ae.point,Qt=Ne.point;return yt[0]===Qt[0]&&yt[1]===Qt[1]?(yt=Ae.otherEvent.point)[0]===(Qt=Ne.otherEvent.point)[0]&&yt[1]===Qt[1]?0:Ae.contourId>Ne.contourId?1:-1:dt(Ae,Ne)===1?1:-1}var an=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function Ut(Ae,Ne,yt,Qt){var cn,on=Ae+1,Nn=Ne[Ae].point,Xn=Ne.length;for(on<Xn&&(cn=Ne[on].point);on<Xn&&cn[0]===Nn[0]&&cn[1]===Nn[1];){if(!yt[on])return on;++on<Xn&&(cn=Ne[on].point)}for(on=Ae-1;yt[on]&&on>Qt;)on--;return on}an.prototype.isExterior=function(){return this.holeOf==null};var sr=Cn,An=Cn;function Cn(Ae,Ne){if(!(this instanceof Cn))return new Cn(Ae,Ne);if(this.data=Ae||[],this.length=this.data.length,this.compare=Ne||nr,this.length>0)for(var yt=(this.length>>1)-1;yt>=0;yt--)this._down(yt)}function nr(Ae,Ne){return Ae<Ne?-1:Ae>Ne?1:0}Cn.prototype={push:function(Ae){this.data.push(Ae),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var Ae=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),Ae}},peek:function(){return this.data[0]},_up:function(Ae){for(var Ne=this.data,yt=this.compare,Qt=Ne[Ae];Ae>0;){var cn=Ae-1>>1,on=Ne[cn];if(yt(Qt,on)>=0)break;Ne[Ae]=on,Ae=cn}Ne[Ae]=Qt},_down:function(Ae){for(var Ne=this.data,yt=this.compare,Qt=this.length>>1,cn=Ne[Ae];Ae<Qt;){var on=1+(Ae<<1),Nn=on+1,Xn=Ne[on];if(Nn<this.length&&yt(Ne[Nn],Xn)<0&&(on=Nn,Xn=Ne[Nn]),yt(Xn,cn)>=0)break;Ne[Ae]=Xn,Ae=on}Ne[Ae]=cn}},sr.default=An;var dr=Math.max,fr=Math.min,wr=0;function yr(Ae,Ne,yt,Qt,cn,on){var Nn,Xn,Pr,Nr,gr,gi;for(Nn=0,Xn=Ae.length-1;Nn<Xn;Nn++)if(Nr=Ae[Nn+1],gr=new Se(Pr=Ae[Nn],!1,void 0,Ne),gi=new Se(Nr,!1,gr,Ne),gr.otherEvent=gi,Pr[0]!==Nr[0]||Pr[1]!==Nr[1]){gr.contourId=gi.contourId=yt,on||(gr.isExteriorRing=!1,gi.isExteriorRing=!1),dt(gr,gi)>0?gi.left=!0:gr.left=!0;var Ii=Pr[0],Dr=Pr[1];cn[0]=fr(cn[0],Ii),cn[1]=fr(cn[1],Dr),cn[2]=dr(cn[2],Ii),cn[3]=dr(cn[3],Dr),Qt.push(gr),Qt.push(gi)}}var mr=[];function Ei(Ae,Ne,yt){typeof Ae[0][0][0]=="number"&&(Ae=[Ae]),typeof Ne[0][0][0]=="number"&&(Ne=[Ne]);var Qt=function(Dr,ra,Li){var fi=null;return Dr.length*ra.length==0&&(Li===q?fi=mr:Li===Q?fi=Dr:Li!==Y&&Li!==re||(fi=Dr.length===0?ra:Dr)),fi}(Ae,Ne,yt);if(Qt)return Qt===mr?null:Qt;var cn=[1/0,1/0,-1/0,-1/0],on=[1/0,1/0,-1/0,-1/0],Nn=function(Dr,ra,Li,fi,ua){var Ui,ki,Fi,wi,vr,Si,ia=new sr(null,dt);for(Fi=0,wi=Dr.length;Fi<wi;Fi++)for(vr=0,Si=(Ui=Dr[Fi]).length;vr<Si;vr++)(ki=vr===0)&&wr++,yr(Ui[vr],!0,wr,ia,Li,ki);for(Fi=0,wi=ra.length;Fi<wi;Fi++)for(vr=0,Si=(Ui=ra[Fi]).length;vr<Si;vr++)ki=vr===0,ua===Q&&(ki=!1),ki&&wr++,yr(Ui[vr],!1,wr,ia,fi,ki);return ia}(Ae,Ne,cn,on,yt);if(Qt=function(Dr,ra,Li,fi,ua){var Ui=null;return(Li[0]>fi[2]||fi[0]>Li[2]||Li[1]>fi[3]||fi[1]>Li[3])&&(ua===q?Ui=mr:ua===Q?Ui=Dr:ua!==Y&&ua!==re||(Ui=Dr.concat(ra))),Ui}(Ae,Ne,cn,on,yt))return Qt===mr?null:Qt;for(var Xn=function(Dr){var ra,Li,fi=function(Fi){var wi,vr,Si,ia,Gn=[];for(vr=0,Si=Fi.length;vr<Si;vr++)((wi=Fi[vr]).left&&wi.inResult||!wi.left&&wi.otherEvent.inResult)&&Gn.push(wi);for(var $r=!1;!$r;)for($r=!0,vr=0,Si=Gn.length;vr<Si;vr++)vr+1<Si&&dt(Gn[vr],Gn[vr+1])===1&&(ia=Gn[vr],Gn[vr]=Gn[vr+1],Gn[vr+1]=ia,$r=!1);for(vr=0,Si=Gn.length;vr<Si;vr++)(wi=Gn[vr]).otherPos=vr;for(vr=0,Si=Gn.length;vr<Si;vr++)(wi=Gn[vr]).left||(ia=wi.otherPos,wi.otherPos=wi.otherEvent.otherPos,wi.otherEvent.otherPos=ia);return Gn}(Dr),ua={},Ui=[],ki=function(){if(!ua[ra]){var Fi=Ui.length,wi=function(Gn,$r,$i){var oa=new an;if(Gn.prevInResult!=null){var Zi=Gn.prevInResult,qa=Zi.outputContourId;if(Zi.resultTransition>0){var Ai=$r[qa];if(Ai.holeOf!=null){var Ba=Ai.holeOf;$r[Ba].holeIds.push($i),oa.holeOf=Ba,oa.depth=$r[qa].depth}else $r[qa].holeIds.push($i),oa.holeOf=qa,oa.depth=$r[qa].depth+1}else oa.holeOf=null,oa.depth=$r[qa].depth}else oa.holeOf=null,oa.depth=0;return oa}(fi[ra],Ui,Fi),vr=function(Gn){ua[Gn]=!0,Gn<fi.length&&fi[Gn]&&(fi[Gn].outputContourId=Fi)},Si=ra,ia=ra;for(wi.points.push(fi[ra].point);vr(Si),vr(Si=fi[Si].otherPos),wi.points.push(fi[Si].point),!((Si=Ut(Si,fi,ua,ia))==ia||Si>=fi.length)&&fi[Si];);Ui.push(wi)}};for(ra=0,Li=fi.length;ra<Li;ra++)ki();return Ui}(function(Dr,ra,Li,fi,ua,Ui){for(var ki,Fi,wi,vr=new g(bn),Si=[],ia=Math.min(fi[2],ua[2]);Dr.length!==0;){var Gn=Dr.pop();if(Si.push(Gn),Ui===q&&Gn.point[0]>ia||Ui===Q&&Gn.point[0]>fi[2])break;if(Gn.left){Fi=ki=vr.insert(Gn),ki=ki!==(wi=vr.minNode())?vr.prev(ki):null,Fi=vr.next(Fi);var $r=ki?ki.key:null;if(he(Gn,$r,Ui),Fi&&Dn(Gn,Fi.key,Dr)===2&&(he(Gn,$r,Ui),he(Fi.key,Gn,Ui)),ki&&Dn(ki.key,Gn,Dr)===2){var $i=ki;he($r,($i=$i!==wi?vr.prev($i):null)?$i.key:null,Ui),he(Gn,$r,Ui)}}else Fi=ki=vr.find(Gn=Gn.otherEvent),ki&&Fi&&(ki=ki!==wi?vr.prev(ki):null,Fi=vr.next(Fi),vr.remove(Gn),Fi&&ki&&Dn(ki.key,Fi.key,Dr))}return Si}(Nn,0,0,cn,on,yt)),Pr=[],Nr=0;Nr<Xn.length;Nr++){var gr=Xn[Nr];if(gr.isExterior()){for(var gi=[gr.points],Ii=0;Ii<gr.holeIds.length;Ii++)gi.push(Xn[gr.holeIds[Ii]].points);Pr.push(gi)}}return Pr}var zi={UNION:Y,DIFFERENCE:Q,INTERSECTION:q,XOR:re};o.diff=function(Ae,Ne){return Ei(Ae,Ne,Q)},o.intersection=function(Ae,Ne){return Ei(Ae,Ne,q)},o.operations=zi,o.union=function(Ae,Ne){return Ei(Ae,Ne,Y)},o.xor=function(Ae,Ne){return Ei(Ae,Ne,re)},Object.defineProperty(o,"__esModule",{value:!0})})(i)}(0,o1.exports)),o1.exports);/**
 * martinez v0.7.4
 * Martinez polygon clipping algorithm, does boolean operation on polygons (multipolygons, polygons with holes etc): intersection, union, difference, xor
 *
 * @author Alex Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */function fv(c,i,o,h){const g=[],_=h===0?(w,j,N,O,L,B)=>{w.push(new Kt(B,N+(B-j)/(O-j)*(L-N)))}:(w,j,N,O,L,B)=>{w.push(new Kt(j+(B-N)/(L-N)*(O-j),B))};for(const w of c){const j=[];for(const N of w){if(N.length<=2)continue;const O=[];for(let q=0;q<N.length-1;q++){const Y=N[q].x,Q=N[q].y,re=N[q+1].x,he=N[q+1].y,pe=h===0?Y:Q,Se=h===0?re:he;pe<i?Se>i&&_(O,Y,Q,re,he,i):pe>o?Se<o&&_(O,Y,Q,re,he,o):O.push(N[q]),Se<i&&pe>=i&&_(O,Y,Q,re,he,i),Se>o&&pe<=o&&_(O,Y,Q,re,he,o)}let L=N[N.length-1];const B=h===0?L.x:L.y;B>=i&&B<=o&&O.push(L),O.length&&(L=O[O.length-1],O[0].x===L.x&&O[0].y===L.y||O.push(O[0]),j.push(O))}j.length&&g.push(j)}return g}function sA(c,i){const o=l1(c),h=l1([i]),g=v2.intersection(o,h);return g==null?[]:_2(g)}function oA(c,i){let h=l1(c,65536);for(;i.valid();i.next()){const[g,_]=i.get(),w=g.x*65536,j=g.y*65536,N=_.x*65536,O=_.y*65536,L=N-w,B=O-j,q=Math.hypot(L,B),Y=Math.trunc(B/q*3),Q=-Math.trunc(L/q*3);h=v2.diff(h,[[[w,j],[N,O],[N+Y,O+Q],[w+Y,j+Q],[w,j]]])}return _2(h,1/65536)}function l1(c,i=1){return[c.map(o=>o.map(h=>[h.x*i,h.y*i]))]}function _2(c,i=1){return c.map(o=>o.map((h,g)=>{const _=h.map(w=>new Kt(w[0]*i,w[1]*i).round());return g>0&&_.reverse(),_}))}class c1{constructor(i,o){this.layoutVertexArray=new hc,this.indexArray=new la,this.lineIndexArray=new xu,this.triangleSegments=new Wi,this.lineSegments=new Wi,this.programConfigurations=new gd(i.layers,{zoom:i.zoom,lut:i.lut}),this.uploaded=!1,o&&(this.elevatedLayoutVertexArray=new Eh)}update(i,o,h,g,_,w,j){this.programConfigurations.updatePaintArrays(i,o,_,h,g,w,j)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,nA.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.lineIndexBuffer=i.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=i.createVertexBuffer(this.elevatedLayoutVertexArray,Q_.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(i,o,h,g,_,w){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,o,h,g,_,w)}}class pv{constructor(i){this.zoom=i.zoom,this.pixelRatio=i.pixelRatio,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.bufferData=new c1(i,!1),this.elevationBufferData=new c1(i,!0),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.projection=i.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference")}updateFootprints(i,o){}populate(i,o,h,g){this.hasPattern=Eg("fill",this.layers,this.pixelRatio,o);const _=this.layers[0].layout.get("fill-sort-key"),w=[];for(const{feature:j,id:N,index:O,sourceLayerIndex:L}of i){const B=this.layers[0]._featureFilter.needGeometry,q=Tn(j,B);if(!this.layers[0]._featureFilter.filter(new ui(this.zoom),q,h))continue;const Y=_?_.evaluate(q,{},h,o.availableImages):void 0,Q={id:N,properties:j.properties,type:j.type,sourceLayerIndex:L,index:O,geometry:B?q.geometry:yn(j,h,g),patterns:{},sortKey:Y};w.push(Q)}_&&w.sort((j,N)=>j.sortKey-N.sortKey);for(const j of w){const{geometry:N,index:O,sourceLayerIndex:L}=j;if(this.hasPattern){const B=lv("fill",this.layers,j,this.zoom,this.pixelRatio,o);this.patternFeatures.push(B)}else this.addFeature(j,N,O,h,{},o.availableImages,o.brightness,o.elevationFeatures);o.featureIndex.insert(i[O].feature,N,O,L,this.index)}}update(i,o,h,g,_,w,j){this.bufferData.update(i,o,h,g,_,w,j),this.elevationBufferData.update(i,o,h,g,_,w,j)}addFeatures(i,o,h,g,_,w){for(const j of this.patternFeatures)this.addFeature(j,j.geometry,j.index,o,h,g,w,i.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(i){this.bufferData.upload(i),this.elevationBufferData.upload(i),this.elevatedStructures&&this.elevatedStructures.upload(i)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(i,o,h,g,_,w=[],j,N){const O=sv(o,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(i,O,g,h,N):this.addGeometry(O,this.bufferData),this.bufferData.populatePaintArrays(i,h,_,w,g,j),this.elevationBufferData.populatePaintArrays(i,h,_,w,g,j)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(i){this.elevatedStructures&&this.elevatedStructures.construct(i)}addElevatedRoadFeature(i,o,h,g,_){const w=new Array,j=kl.getElevationFeature(i,_);if(j){{const N=this.clipPolygonsToTile(o,1);N.length>0&&w.push({polygons:N,elevationFeature:j,elevationTileID:h})}for(const N of w)if(N.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new Rl(N.elevationTileID));const L=N.elevationFeature.isTunnel();let B=0;i.properties.hasOwnProperty(x2)&&(B=+i.properties[x2]);for(const q of N.polygons)this.elevatedStructures.addPortalCandidates(N.elevationFeature.id,q,L,N.elevationFeature,B)}N.elevationFeature.constantHeight==null&&(N.polygons=this.prepareElevatedPolygons(N.polygons,N.elevationFeature,N.elevationTileID));const O=new s1(h,N.elevationTileID);this.addElevatedGeometry(N.polygons,O,N.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,g)}}else this.addGeometry(o,this.bufferData)}addElevatedGeometry(i,o,h,g,_){const w={elevation:h,elevationSampler:o,bias:g,index:_},[j,N]=this.addGeometry(i,this.elevationBufferData,w);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:j,max:N}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,j),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,N))}addGeometry(i,o,h){let g=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,w=null;h&&(w=h.elevationSampler.constantElevation(h.elevation,h.bias),w!=null&&(g=w,_=w));const j=(N,O,L)=>{if(h!=null)if(O.push(N),w!=null)o.elevatedLayoutVertexArray.emplaceBack(w),L.push(w);else{const B=h.elevationSampler.pointElevation(N,h.elevation,h.bias);o.elevatedLayoutVertexArray.emplaceBack(B),L.push(B),g=Math.min(g,B),_=Math.max(_,B)}};for(const N of i){let O=0;for(const be of N)O+=be.length;const L=o.triangleSegments.prepareSegment(O,o.layoutVertexArray,o.indexArray),B=L.vertexLength,q=[],Y=[],Q=[],re=[],he=[],pe=o.layoutVertexArray.length;for(const be of N){if(be.length===0)continue;be!==N[0]&&Y.push(q.length/2);const oe=o.lineSegments.prepareSegment(be.length,o.layoutVertexArray,o.lineIndexArray),xe=oe.vertexLength;h&&he.push(o.layoutVertexArray.length-pe),j(be[0],Q,re),o.layoutVertexArray.emplaceBack(be[0].x,be[0].y),o.lineIndexArray.emplaceBack(xe+be.length-1,xe),q.push(be[0].x),q.push(be[0].y);for(let we=1;we<be.length;we++)j(be[we],Q,re),o.layoutVertexArray.emplaceBack(be[we].x,be[we].y),o.lineIndexArray.emplaceBack(xe+we-1,xe+we),q.push(be[we].x),q.push(be[we].y);oe.vertexLength+=be.length,oe.primitiveLength+=be.length}const Se=u0(q,Y);for(let be=0;be<Se.length;be+=3)o.indexArray.emplaceBack(B+Se[be],B+Se[be+1],B+Se[be+2]);if(Se.length>0&&h&&this.elevationMode==="hd-road-base"){const be=h.elevation.isTunnel(),oe=h.elevation.safeArea,xe=this.elevatedStructures.addVertices(Q,re);this.elevatedStructures.addTriangles(Se,xe,be);const we=he.length;if(we>0){for(let je=0;je<we-1;je++)this.elevatedStructures.addRenderableRing(h.index,he[je]+xe,he[je+1]-he[je],be,oe);this.elevatedStructures.addRenderableRing(h.index,he[we-1]+xe,Q.length-he[we-1],be,oe)}}L.vertexLength+=O,L.primitiveLength+=Se.length/3}return[g,_]}prepareElevatedPolygons(i,o,h){const g=1/Je(h),_=[];for(const w of i){const j=oA(w,new a1(o,g));_.push(...j)}return _}clipPolygonsToTile(i,o){const h=-o,g=-o,_=en+o,w=en+o;let j=0;const N=[],O=[];for(;j<i.length;j++){const q=i[j],Y=Ym(q);(Y.min.x>=h&&Y.max.x<=_&&Y.min.y>=g&&Y.max.y<=w?N:O).push(q)}if(N.length===i.length)return i;const L=[new Kt(h,g),new Kt(_,g),new Kt(_,w),new Kt(h,w),new Kt(h,g)],B=N;for(const q of O)B.push(...sA(q,L));return B}}let mm,Ag,u1,b2;mn(pv,"FillBucket",{omit:["layers","patternFeatures"]}),mn(c1,"FillBufferData"),mn(Rl,"ElevatedStructures");class Vf{constructor(i,o,h,g){if(this.triangleCount=o.length/3,this.min=new Kt(0,0),this.max=new Kt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||i.length===0)return;const[_,w]=[i[0].clone(),i[0].clone()];for(let B=1;B<i.length;++B){const q=i[B];_.x=Math.min(_.x,q.x),_.y=Math.min(_.y,q.y),w.x=Math.max(w.x,q.x),w.y=Math.max(w.y,q.y)}if(g){const B=Math.ceil(Math.max(w.x-_.x,w.y-_.y)/g);h=Math.max(h,B)}if(h===0)return;this.min=_,this.max=w;const j=this.max.sub(this.min);j.x=Math.max(j.x,1),j.y=Math.max(j.y,1);const N=Math.max(j.x,j.y)/h;this.cellsX=Math.max(1,Math.ceil(j.x/N)),this.cellsY=Math.max(1,Math.ceil(j.y/N)),this.xScale=1/N,this.yScale=1/N;const O=[];for(let B=0;B<this.triangleCount;B++){const q=i[o[3*B+0]].sub(this.min),Y=i[o[3*B+1]].sub(this.min),Q=i[o[3*B+2]].sub(this.min),re=zl(Math.floor(Math.min(q.x,Y.x,Q.x)),this.xScale,this.cellsX),he=zl(Math.floor(Math.max(q.x,Y.x,Q.x)),this.xScale,this.cellsX),pe=zl(Math.floor(Math.min(q.y,Y.y,Q.y)),this.yScale,this.cellsY),Se=zl(Math.floor(Math.max(q.y,Y.y,Q.y)),this.yScale,this.cellsY),be=new Kt(0,0),oe=new Kt(0,0),xe=new Kt(0,0),we=new Kt(0,0);for(let je=pe;je<=Se;++je){be.y=oe.y=je*N,xe.y=we.y=(je+1)*N;for(let Ve=re;Ve<=he;++Ve)be.x=xe.x=Ve*N,oe.x=we.x=(Ve+1)*N,(Ni(q,Y,Q,be,oe,we)||Ni(q,Y,Q,be,we,xe))&&O.push({cellIdx:je*this.cellsX+Ve,triIdx:B})}}if(O.length===0)return;O.sort((B,q)=>B.cellIdx-q.cellIdx||B.triIdx-q.triIdx);let L=0;for(;L<O.length;){const B=O[L].cellIdx,q={start:this.payload.length,len:0};for(;L<O.length&&O[L].cellIdx===B;)++q.len,this.payload.push(O[L++].triIdx);this.cells[B]=q}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(i,o){if(this.triangleCount===0||this.cells.length===0||i.x>this.max.x||this.min.x>i.x||i.y>this.max.y||this.min.y>i.y)return;const h=zl(i.x-this.min.x,this.xScale,this.cellsX),g=zl(i.y-this.min.y,this.yScale,this.cellsY),_=this.cells[g*this.cellsX+h];if(_){this._lazyInitLookup();for(let w=0;w<_.len;w++){const j=this.payload[_.start+w],N=Math.floor(j/8),O=1<<j%8;if(!(this.lookup[N]&O)&&(this.lookup[N]|=O,o.push(j),o.length===this.triangleCount))return}}}query(i,o,h){if(this.triangleCount===0||this.cells.length===0||i.x>this.max.x||this.min.x>o.x||i.y>this.max.y||this.min.y>o.y)return;this._lazyInitLookup();const g=zl(i.x-this.min.x,this.xScale,this.cellsX),_=zl(o.x-this.min.x,this.xScale,this.cellsX),w=zl(i.y-this.min.y,this.yScale,this.cellsY),j=zl(o.y-this.min.y,this.yScale,this.cellsY);for(let N=w;N<=j;N++)for(let O=g;O<=_;O++){const L=this.cells[N*this.cellsX+O];if(L)for(let B=0;B<L.len;B++){const q=this.payload[L.start+B],Y=Math.floor(q/8),Q=1<<q%8;if(!(this.lookup[Y]&Q)&&(this.lookup[Y]|=Q,h.push(q),h.length===this.triangleCount))return}}}}function zl(c,i,o){return Math.max(0,Math.min(o-1,Math.floor(c*i)))}mn(Vf,"TriangleGridIndex");class d1{constructor(i){this.zoom=i.zoom,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=i.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.footprints=[]}updateFootprints(i,o){for(const h of this.footprints)o.push({footprint:h,id:i})}populate(i,o,h,g){const _=[];for(const{feature:w,id:j,index:N,sourceLayerIndex:O}of i){const L=this.layers[0]._featureFilter.needGeometry,B=Tn(w,L);if(!this.layers[0]._featureFilter.filter(new ui(this.zoom),B,h))continue;const q={id:j,properties:w.properties,type:w.type,sourceLayerIndex:O,index:N,geometry:L?B.geometry:yn(w,h,g),patterns:{}};_.push(q)}for(const w of _){const{geometry:j,index:N,sourceLayerIndex:O}=w;this.addFeature(w,j,N,h,{},o.availableImages,o.brightness),o.featureIndex.insert(i[N].feature,j,N,O,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(i){}update(i,o,h,g,_,w,j){}destroy(){}addFeature(i,o,h,g,_,w=[],j){for(const N of sv(o,2)){const O=[],L=[],B=[],q=new Kt(1/0,1/0),Y=new Kt(-1/0,-1/0);for(const he of N)if(he.length!==0){he!==N[0]&&B.push(L.length/2);for(let pe=0;pe<he.length;pe++)L.push(he[pe].x),L.push(he[pe].y),O.push(he[pe]),q.x=Math.min(q.x,he[pe].x),q.y=Math.min(q.y,he[pe].y),Y.x=Math.max(Y.x,he[pe].x),Y.y=Math.max(Y.y,he[pe].y)}const Q=u0(L,B),re=new Vf(O,Q,8,256);this.footprints.push({vertices:O,indices:Q,grid:re,min:q,max:Y})}}}mn(d1,"ClipBucket",{omit:["layers"]});const mv=Vr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),h1=Vr([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),f1=Vr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),gv=Vr([{name:"a_join_normal_inside",components:3,type:"Int16"}]),w2=Vr([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),S2=Vr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:lA}=mv,y0=Number.MAX_SAFE_INTEGER;function Cg(c,i,o,h){return c.order<i||c.order===y0||!(c.clipMask&o)||function(g,_){return _.length!==0&&_.find(w=>w===g)===void 0}(h,c.clipScope)}function xv(c,i){return c.x-i.x||c.y-i.y}function T2(c,i){return xv(c.min,i.min)===0&&xv(c.max,i.max)===0}function p1(c,i){return!(c.min.x>i.max.x||c.max.x<i.min.x||c.min.y>i.max.y||c.max.y<i.min.y)}function jg(c,i){if(c.length!==i.length)return!1;for(let o=0;o<c.length;o++)if(c[o].sourceId!==i[o].sourceId||!T2(c[o],i[o])||c[o].order!==i[o].order||c[o].clipMask!==i[o].clipMask||!el(c[o].clipScope,i[o].clipScope))return!1;return!0}function v0(c,i,o){const h=1/en,g=1/(1<<o.canonical.z),_=(i.x*h+o.canonical.x)*g+o.wrap,w=(i.y*h+o.canonical.y)*g;return{min:new Kt((c.x*h+o.canonical.x)*g+o.wrap,(c.y*h+o.canonical.y)*g),max:new Kt(_,w)}}function m1(c,i,o){const h=1<<o.canonical.z,g=((i.x-o.wrap)*h-o.canonical.x)*en,_=(i.y*h-o.canonical.y)*en;return{min:new Kt(((c.x-o.wrap)*h-o.canonical.x)*en,(c.y*h-o.canonical.y)*en),max:new Kt(g,_)}}function E2(c,i,o,h,g,_,w){const j=c.indices,N=c.vertices,O=[];for(let L=h;L<h+g;L+=3){const B=i[o[L+0]+_],q=i[o[L+1]+_],Y=i[o[L+2]+_],Q=Math.min(B.x,q.x,Y.x),re=Math.max(B.x,q.x,Y.x),he=Math.min(B.y,q.y,Y.y),pe=Math.max(B.y,q.y,Y.y);O.length=0,c.grid.query(new Kt(Q,he),new Kt(re,pe),O);for(let Se=0;Se<O.length;Se++){const be=O[Se];if(Ni(N[j[3*be+0]],N[j[3*be+1]],N[j[3*be+2]],B,q,Y,w))return!0}}return!1}function Mg(c,i,o,h){if(!c||!o)return!1;let g=c.vertices;if(!i.canonical.equals(h.canonical)||i.wrap!==h.wrap){if(o.vertices.length<c.vertices.length)return Mg(o,h,c,i);const _=i.canonical,w=h.canonical,j=Math.pow(2,w.z-_.z);g=c.vertices.map(N=>new Kt((N.x+_.x*en)*j-w.x*en,(N.y+_.y*en)*j-w.y*en))}return E2(o,g,c.indices,0,c.indices.length,0,0)}function A2(c,i,o,h){const g=Math.pow(2,h.z-o.z);return new Kt((c+o.x*en)*g-h.x*en,(i+o.y*en)*g-h.y*en)}function g1(c,i){const o=[];i.grid.queryPoint(c,o);const h=i.indices,g=i.vertices;for(let _=0;_<o.length;_++){const w=o[_];if(Ur([g[h[3*w+0]],g[h[3*w+1]],g[h[3*w+2]]],c))return!0}return!1}const yv=[new Kt(0,0),new Kt(en,0),new Kt(en,en),new Kt(0,en)];function x1(c,i){const o=[];let h=[];if(!i||c.length<2)return[c];if(c.length===2)return Pi(c[0],c[1],yv)?[c]:[];for(let g=0;g<c.length+2;g++){const _=c[g%c.length],w=c[(g+1)%c.length],j=Pi(g===0?c[c.length-1]:c[(g-1)%c.length],_,yv),N=Pi(_,w,yv),O=j||N;O&&h.push(_),O&&N||h.length>0&&(h.length>1&&o.push(h),h=[])}return h.length>1&&o.push(h),o}const vv=yd.VectorTileFeature.types,y1=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],C2=["fill-extrusion-flood-light-ground-radius"],_v=Math.pow(2,13),cA=Math.pow(2,15)-1,j2=new Kt(0,1),vd=2147483648;function gm(c,i,o,h,g,_,w,j){c.emplaceBack((i<<1)+w,(o<<1)+_,(Math.floor(h*_v)<<1)+g,Math.round(j))}function Uf(c,i,o){c.emplaceBack(i.x*en,i.y*en,o?1:0)}function Pg(c,i,o,h,g,_){c.emplaceBack(i.x,i.y,(o.x<<1)+h,(o.y<<1)+g,_)}function Ng(c,i,o){c.emplaceBack(i.x,i.y,i.z,o[0]*16384,o[1]*16384,o[2]*16384)}class bv{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class zh{constructor(){this.centroidXY=new Kt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Kt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Kt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Kt(this.max.x-this.min.x,this.max.y-this.min.y)}}class Lh{constructor(){this.acc=new Kt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(i,o){i.min.x===Number.MAX_VALUE&&(i.min.x=i.max.x=o.x,i.min.y=i.max.y=o.y)}appendEdge(i,o,h){this.accCount++,this.acc._add(o);let g=!!this.borders;o.x<i.min.x?(i.min.x=o.x,g=!0):o.x>i.max.x&&(i.max.x=o.x,g=!0),o.y<i.min.y?(i.min.y=o.y,g=!0):o.y>i.max.y&&(i.max.y=o.y,g=!0),((o.x===0||o.x===en)&&o.x===h.x)!=((o.y===0||o.y===en)&&o.y===h.y)&&this.processBorderOverlap(o,h),g&&this.checkBorderIntersection(o,h)}checkBorderIntersection(i,o){o.x<0!=i.x<0&&this.addBorderIntersection(0,Vn(o.y,i.y,(0-o.x)/(i.x-o.x))),o.x>en!=i.x>en&&this.addBorderIntersection(1,Vn(o.y,i.y,(en-o.x)/(i.x-o.x))),o.y<0!=i.y<0&&this.addBorderIntersection(2,Vn(o.x,i.x,(0-o.y)/(i.y-o.y))),o.y>en!=i.y>en&&this.addBorderIntersection(3,Vn(o.x,i.x,(en-o.y)/(i.y-o.y)))}addBorderIntersection(i,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const h=this.borders[i];o<h[0]&&(h[0]=o),o>h[1]&&(h[1]=o)}processBorderOverlap(i,o){if(i.x===o.x){if(i.y===o.y)return;const h=i.x===0?0:1;this.addBorderIntersection(h,o.y),this.addBorderIntersection(h,i.y)}else{const h=i.y===0?2:3;this.addBorderIntersection(h,o.x),this.addBorderIntersection(h,i.x)}}centroid(){return this.accCount===0?new Kt(0,0):new Kt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((i,o)=>i+ +(o[0]!==Number.MAX_VALUE),0):0}}function Fh(c,i){const o=c.add(i)._unit(),h=Le(c.x*o.x+c.y*o.y,-1,1);var g,_,w;return g=Math.acos(h),Math.min(4,Math.max(-4,Math.tan(g)))/4*cA*((_=c).x*(w=i).y-_.y*w.x<0?-1:1)}const _0=[c=>c.x<0,c=>c.x>en,c=>c.y<0,c=>c.y>en];function b0(c,i,o,h){const g=[4];if(h===0)return g;o._mult(h);const _=c.sub(o),w=i.sub(o),j=[c,i,_,w];for(let N=0;N<4;N++)for(const O of j)if(_0[N](O)){g.push(N);break}return g}class Bh{constructor(i){this.vertexArray=new gg,this.indexArray=new la,this.programConfigurations=new gd(i.layers,{zoom:i.zoom,lut:i.lut},o=>C2.includes(o)),this._segments=new Wi,this.hiddenByLandmarkVertexArray=new Nh,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Wi}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(i,o,h,g=!1){const _=i.length;if(_>2){let w=Math.max(0,this._segments.get().length-1);const j=this._segments._prepareSegment(4*_,this.vertexArray.length,2*this._segmentToGroundQuads[w].length);let N;w!==this._segments.get().length-1&&(w++,this._segmentToGroundQuads[w]=[],this._segmentToRegionTriCounts[w]=[0,0,0,0,0]);{const O=i[0],L=i[1];N=Fh(O.sub(i[_-1])._perp()._unit(),L.sub(O)._perp()._unit())}for(let O=0;O<_;O++){const L=O===_-1?0:O+1,B=i[O],q=i[L],Y=i[L===_-1?0:L+1],Q=q.sub(B)._perp()._unit(),re=Fh(Q,Y.sub(q)._perp()._unit()),he=N,pe=re;if(Sv(B,q,o)||g&&S0(B,o)&&S0(q,o)){N=re;continue}const Se=j.vertexLength;Pg(this.vertexArray,B,q,1,1,he),Pg(this.vertexArray,B,q,1,0,he),Pg(this.vertexArray,B,q,0,1,pe),Pg(this.vertexArray,B,q,0,0,pe),j.vertexLength+=4;const be=b0(B,q,Q,h);for(const oe of be)this._segmentToGroundQuads[w].push({id:Se,region:oe}),this._segmentToRegionTriCounts[w][oe]+=2,j.primitiveLength+=2;N=re}}}prepareBorderSegments(){if(!this.hasData())return;const i=this._segments.get(),o=i.length;for(let h=0;h<o;h++)this._segmentToGroundQuads[h].sort((g,_)=>g.region-_.region);for(let h=0;h<o;h++){const g=this._segmentToGroundQuads[h],_=i[h],w=this._segmentToRegionTriCounts[h];w.reduce((N,O)=>N+O,0);let j=0;for(let N=0;N<=4;N++){const O=w[N];if(O!==0){let L=this.regionSegments[N];L||(L=this.regionSegments[N]=new Wi);const B={vertexOffset:_.vertexOffset,primitiveOffset:_.primitiveOffset+j,vertexLength:_.vertexLength,primitiveLength:O};L.get().push(B)}j+=O}for(let N=0;N<g.length;N++){const O=g[N].id;this.indexArray.emplaceBack(O,O+1,O+3),this.indexArray.emplaceBack(O,O+3,O+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(i,o,h,g,_,w){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,i,o,h,g,_,w)}upload(i){this.hasData()&&(this.vertexBuffer=i.createVertexBuffer(this.vertexArray,h1.members),this.indexBuffer=i.createIndexBuffer(this.indexArray))}uploadPaintProperties(i){this.hasData()&&this.programConfigurations.upload(i)}update(i,o,h,g,_,w,j){this.hasData()&&this.programConfigurations.updatePaintArrays(i,o,h,g,_,w,j)}updateHiddenByLandmark(i){if(!this.hasData())return;const o=i.groundVertexCount+i.groundVertexArrayOffset;if(i.groundVertexCount===0)return;const h=i.flags&vd?1:0;for(let g=i.groundVertexArrayOffset;g<o;++g)this.hiddenByLandmarkVertexArray.emplace(g,h);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(i){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=i.createVertexBuffer(this.hiddenByLandmarkVertexArray,w2.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let i=0;i<=4;i++){const o=this.regionSegments[i];o&&o.destroy()}}}}class wv{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.overscaling=i.overscaling,this.layers=i.layers,this.pixelRatio=i.pixelRatio,this.layerIds=this.layers.map(o=>o.fqid),this.index=i.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=i.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new la,this.footprintVertices=new hc,this.footprintSegments=[],this.layoutVertexArray=new cd,this.centroidVertexArray=new e0,this.wallVertexArray=new n0,this.indexArray=new la,this.programConfigurations=new gd(i.layers,{zoom:i.zoom,lut:i.lut},o=>y1.includes(o)),this.segments=new Wi,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.groundEffect=new Bh(i),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(i,o){}populate(i,o,h,g){this.features=[],this.hasPattern=Eg("fill-extrusion",this.layers,this.pixelRatio,o),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=Je(h),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:_,id:w,index:j,sourceLayerIndex:N}of i){const O=this.layers[0]._featureFilter.needGeometry,L=Tn(_,O);if(!this.layers[0]._featureFilter.filter(new ui(this.zoom),L,h))continue;const B={id:w,sourceLayerIndex:N,index:j,geometry:O?L.geometry:yn(_,h,g),properties:_.properties,type:_.type,patterns:{}},q=this.layoutVertexArray.length,Y=vv[B.type]==="Polygon";if(this.hasPattern)this.features.push(lv("fill-extrusion",this.layers,B,this.zoom,this.pixelRatio,o));else if(this.wallMode)for(const Q of B.geometry)for(const re of x1(Q,Y))this.addFeature(B,[re],j,h,{},o.availableImages,g,o.brightness);else this.addFeature(B,B.geometry,j,h,{},o.availableImages,g,o.brightness);o.featureIndex.insert(_,B.geometry,j,N,this.index,q)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(i,o,h,g,_,w){for(const j of this.features){const N=vv[j.type]==="Polygon",{geometry:O}=j;if(this.wallMode)for(const L of O)for(const B of x1(L,N))this.addFeature(j,[B],j.index,o,h,g,_,w);else this.addFeature(j,O,j.index,o,h,g,_,w)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(i,o,h,g,_,w,j){this.programConfigurations.updatePaintArrays(i,o,_,h,g,w,j),this.groundEffect.update(i,o,_,h,g,w,j)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,lA),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.wallVertexBuffer=i.createVertexBuffer(this.wallVertexArray,gv.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=i.createVertexBuffer(this.layoutVertexExtArray,S2.members,!0)),this.groundEffect.upload(i)),this.groundEffect.uploadPaintProperties(i),this.programConfigurations.upload(i),this.uploaded=!0}uploadCentroid(i){this.groundEffect.uploadHiddenByLandmark(i),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,f1.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,o,h,g,_,w,j,N){const O=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(i,{})/this.tileToMeter,L=[new Kt(0,0),new Kt(en,en)],B=j.projection,q=B.name==="globe",Y=this.wallMode||vv[i.type]==="Polygon",Q=new Lh;Q.centroidDataIndex=this.centroidData.length;const re=new zh,he=this.layers[0].paint.get("fill-extrusion-base").evaluate(i,{},g)<=0,pe=this.layers[0].paint.get("fill-extrusion-height").evaluate(i,{},g);let Se;if(re.height=pe,re.vertexArrayOffset=this.layoutVertexArray.length,re.groundVertexArrayOffset=this.groundEffect.vertexArray.length,q&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new fc),this.wallMode){if(q)return void or("Non zero fill-extrusion-line-width is not yet supported on globe.");if(o.length!==1)return;Se=function(Ze){const Qe=Ze[0].x===Ze[Ze.length-1].x&&Ze[0].y===Ze[Ze.length-1].y;(function(an){let Ut=0;const sr=an.length;for(let An=0;An<sr;An++)Ut+=(an[(An+1)%sr].x-an[An].x)*(an[(An+1)%sr].y+an[An].y);return Ut>=0})(Ze)||(Ze=Ze.reverse());const kt={geometry:[],joinNormals:[],indices:[]},Ct=[],Pt=[],Vt=[];let ht=Ze.length;for(;ht>=2&&Ze[ht-1].equals(Ze[ht-2]);)ht--;if(ht<(Qe?3:2))return kt;let Mt,dt,ft,$t,Gt,Dn=0;for(;Dn<ht-1&&Ze[Dn].equals(Ze[Dn+1]);)Dn++;Qe&&(Mt=Ze[ht-2],Gt=Ze[Dn].sub(Mt)._unit()._perp());for(let an=Dn;an<ht;an++){if(ft=an===ht-1?Qe?Ze[Dn+1]:void 0:Ze[an+1],ft&&Ze[an].equals(ft))continue;Gt&&($t=Gt),Mt&&(dt=Mt),Mt=Ze[an],Gt=ft?ft.sub(Mt)._unit()._perp():$t,$t=$t||Gt;let Ut=$t.add(Gt);Ut.x===0&&Ut.y===0||Ut._unit();const sr=Ut.x*Gt.x+Ut.y*Gt.y,An=sr!==0?1/sr:1/0,Cn=$t.x*Gt.y-$t.y*Gt.x>0;let nr="miter";const dr=2;nr==="miter"&&An>dr&&(nr="bevel"),nr==="bevel"&&(An>100&&(nr="flipbevel"),An<dr&&(nr="miter"));const fr=(wr,yr,mr,Ei)=>{const zi=new Kt(wr.x,wr.y),Ae=new Kt(wr.x,wr.y);zi.x+=yr.x*Ei,zi.y+=yr.y*Ei,Ae.x-=yr.x*Math.max(mr,1),Ae.y-=yr.y*Math.max(mr,1),Vt.push(yr),Ct.push(zi),Pt.push(Ae)};if(nr==="miter")Ut._mult(An),fr(Mt,Ut,0,0);else if(nr==="flipbevel")Ut=Gt.mult(-1),fr(Mt,Ut,0,0),fr(Mt,Ut.mult(-1),0,0);else{const wr=-Math.sqrt(An*An-1),yr=Cn?wr:0,mr=Cn?0:wr;dt&&fr(Mt,$t,yr,mr),ft&&fr(Mt,Gt,yr,mr)}}kt.geometry=[...Ct,...Pt.reverse(),Ct[0]],kt.joinNormals=[...Vt,...Vt.reverse(),Vt[Vt.length-1]];const bn=kt.geometry.length-1;for(let an=0;an<bn/2;an++)if(an+1<bn/2){let Ut=an,sr=an+1,An=bn-1-an,Cn=bn-2-an;Ut=Ut===0?bn-1:Ut-1,sr=sr===0?bn-1:sr-1,An=An===0?bn-1:An-1,Cn=Cn===0?bn-1:Cn-1,kt.indices.push(An),kt.indices.push(sr),kt.indices.push(Ut),kt.indices.push(An),kt.indices.push(Cn),kt.indices.push(sr)}return kt}(o[0]),o=[Se.geometry]}const be=(Ze,Qe)=>Ze<(Qe.length-1)/2||Ze===Qe.length-1,oe=this.wallMode?[o]:sv(o,500);for(let Ze=oe.length-1;Ze>=0;Ze--){const Qe=oe[Ze];(Qe.length===0||(xe=Qe[0]).every(pt=>pt.x<=0)||xe.every(pt=>pt.x>=en)||xe.every(pt=>pt.y<=0)||xe.every(pt=>pt.y>=en))&&oe.splice(Ze,1)}var xe;let we;if(q)we=E0(oe,L,g);else{we=[];for(const Ze of oe)we.push({polygon:Ze,bounds:L})}const je=Y?this.edgeRadius:0,Ve=je>0&&this.zoom<17,We=(Ze,Qe)=>{if(Ze.length===0)return!1;const pt=Ze[Ze.length-1];return Qe.x===pt.x&&Qe.y===pt.y};for(const{polygon:Ze,bounds:Qe}of we){let pt=0,kt=0;for(const ht of Ze)Y&&!ht[0].equals(ht[ht.length-1])&&ht.push(ht[0]),kt+=Y?ht.length-1:ht.length;const Ct=this.segments.prepareSegment((Y?5:4)*kt,this.layoutVertexArray,this.indexArray);re.footprintSegIdx<0&&(re.footprintSegIdx=this.footprintSegments.length),re.polygonSegIdx<0&&(re.polygonSegIdx=this.polygonSegments.length);const Pt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Vt=new bv;if(Vt.vertexOffset=this.footprintVertices.length,Vt.indexOffset=3*this.footprintIndices.length,Vt.ringIndices=[],Y){const ht=[],Mt=[];pt=Ct.vertexLength;for(let ft=0;ft<Ze.length;ft++){const $t=Ze[ft];$t.length&&ft!==0&&Mt.push(ht.length/2);const Gt=[];let Dn,bn;Dn=$t[1].sub($t[0])._perp()._unit(),Vt.ringIndices.push($t.length-1);for(let an=1;an<$t.length;an++){const Ut=$t[an],sr=$t[an===$t.length-1?1:an+1],An=Ut.clone();if(je){bn=sr.sub(Ut)._perp()._unit();const Cn=Dn.add(bn)._unit(),nr=je*Math.min(4,1/(Dn.x*Cn.x+Dn.y*Cn.y));An.x+=nr*Cn.x,An.y+=nr*Cn.y,An.x=Math.round(An.x),An.y=Math.round(An.y),Dn=bn}if(!he||je!==0&&!Ve||We(Gt,An)||Gt.push(An),gm(this.layoutVertexArray,An.x,An.y,0,0,1,1,0),this.wallMode){const Cn=be(an,$t);Uf(this.wallVertexArray,Se.joinNormals[an],!Cn)}Ct.vertexLength++,this.footprintVertices.emplaceBack(Ut.x,Ut.y),ht.push(Ut.x,Ut.y),q&&Ng(this.layoutVertexExtArray,B.projectTilePoint(An.x,An.y,g),B.upVector(g,An.x,An.y))}he&&(je===0||Ve)&&(Gt.length!==0&&We(Gt,Gt[0])&&Gt.pop(),this.groundEffect.addData(Gt,Qe,O))}const dt=this.wallMode?Se.indices:u0(ht,Mt);for(let ft=0;ft<dt.length;ft+=3)this.footprintIndices.emplaceBack(Vt.vertexOffset+dt[ft+0],Vt.vertexOffset+dt[ft+1],Vt.vertexOffset+dt[ft+2]),this.indexArray.emplaceBack(pt+dt[ft],pt+dt[ft+2],pt+dt[ft+1]),Ct.primitiveLength++;Vt.indexCount+=dt.length,Vt.vertexCount+=this.footprintVertices.length-Vt.vertexOffset}for(let ht=0;ht<Ze.length;ht++){const Mt=Ze[ht];Q.startRing(re,Mt[0]);let dt=Mt.length>4&&_1(Mt[Mt.length-2],Mt[0],Mt[1]),ft=je?w0(Mt[Mt.length-2],Mt[0],Mt[1],je):0;const $t=[];let Gt,Dn,bn;Dn=Mt[1].sub(Mt[0])._perp()._unit();let an=!0;for(let Ut=1,sr=0;Ut<Mt.length;Ut++){let An=Mt[Ut-1],Cn=Mt[Ut];const nr=Mt[Ut===Mt.length-1?1:Ut+1];if(Q.appendEdge(re,Cn,An),Sv(Cn,An,Qe)){je&&(Dn=nr.sub(Cn)._perp()._unit(),an=!an);continue}const dr=Cn.sub(An)._perp(),fr=dr.x/(Math.abs(dr.x)+Math.abs(dr.y)),wr=dr.y>0?1:0,yr=An.dist(Cn);if(sr+yr>32768&&(sr=0),je){bn=nr.sub(Cn)._perp()._unit();let Ae=M2(An,Cn,nr,v1(Dn,bn),je);isNaN(Ae)&&(Ae=0);const Ne=Cn.sub(An)._unit();An=An.add(Ne.mult(ft))._round(),Cn=Cn.add(Ne.mult(-Ae))._round(),ft=Ae,Dn=bn,he&&this.zoom>=17&&(We($t,An)||$t.push(An),We($t,Cn)||$t.push(Cn))}const mr=Ct.vertexLength,Ei=Mt.length>4&&_1(An,Cn,nr);let zi=P2(sr,dt,an);if(gm(this.layoutVertexArray,An.x,An.y,fr,wr,0,0,zi),gm(this.layoutVertexArray,An.x,An.y,fr,wr,0,1,zi),this.wallMode){const Ae=be(Ut-1,Mt),Ne=Se.joinNormals[Ut-1];Uf(this.wallVertexArray,Ne,Ae),Uf(this.wallVertexArray,Ne,Ae)}if(sr+=yr,zi=P2(sr,Ei,!an),dt=Ei,gm(this.layoutVertexArray,Cn.x,Cn.y,fr,wr,0,0,zi),gm(this.layoutVertexArray,Cn.x,Cn.y,fr,wr,0,1,zi),this.wallMode){const Ae=be(Ut,Mt),Ne=Se.joinNormals[Ut];Uf(this.wallVertexArray,Ne,Ae),Uf(this.wallVertexArray,Ne,Ae)}if(Ct.vertexLength+=4,this.indexArray.emplaceBack(mr+0,mr+1,mr+2),this.indexArray.emplaceBack(mr+1,mr+3,mr+2),Ct.primitiveLength+=2,je){const Ae=pt+(Ut===1?Mt.length-2:Ut-2),Ne=Ut===1?pt:Ae+1;if(this.indexArray.emplaceBack(mr+1,Ae,mr+3),this.indexArray.emplaceBack(Ae,Ne,mr+3),Ct.primitiveLength+=2,Gt===void 0&&(Gt=mr),!Sv(nr,Mt[Ut],Qe)){const yt=Ut===Mt.length-1?Gt:Ct.vertexLength;this.indexArray.emplaceBack(mr+2,mr+3,yt),this.indexArray.emplaceBack(mr+3,yt+1,yt),this.indexArray.emplaceBack(mr+3,Ne,yt+1),Ct.primitiveLength+=3}an=!an}if(q){const Ae=this.layoutVertexExtArray,Ne=B.projectTilePoint(An.x,An.y,g),yt=B.projectTilePoint(Cn.x,Cn.y,g),Qt=B.upVector(g,An.x,An.y),cn=B.upVector(g,Cn.x,Cn.y);Ng(Ae,Ne,Qt),Ng(Ae,Ne,Qt),Ng(Ae,yt,cn),Ng(Ae,yt,cn)}}Y&&(pt+=Mt.length-1),he&&je&&this.zoom>=17&&($t.length!==0&&We($t,$t[0])&&$t.pop(),this.groundEffect.addData($t,Qe,O,je>0))}this.footprintSegments.push(Vt),Pt.triangleCount=this.indexArray.length-Pt.triangleArrayOffset,this.polygonSegments.push(Pt),++re.footprintSegLen,++re.polygonSegLen}if(re.vertexCount=this.layoutVertexArray.length-re.vertexArrayOffset,re.groundVertexCount=this.groundEffect.vertexArray.length-re.groundVertexArrayOffset,re.vertexCount!==0){if(re.centroidXY=Q.borders?j2:this.encodeCentroid(Q,re),this.centroidData.push(re),Q.borders){this.featuresOnBorder.push(Q);const Ze=this.featuresOnBorder.length-1;for(let Qe=0;Qe<Q.borders.length;Qe++)Q.borders[Qe][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Qe].push(Ze)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,_,w,g,N),this.groundEffect.addPaintPropertiesData(i,h,_,w,g,N),this.maxHeight=Math.max(this.maxHeight,pe)}}sortBorders(){for(let i=0;i<this.borderFeatureIndices.length;i++)this.borderFeatureIndices[i].sort((o,h)=>this.featuresOnBorder[o].borders[i][0]-this.featuresOnBorder[h].borders[i][0])}splitToSubtiles(){const i=[];for(let j=0;j<this.centroidData.length;j++){const N=this.centroidData[j],O=+(N.min.y+N.max.y>en),L=2*O+(+(N.min.x+N.max.x>en)^O);for(let B=0;B<N.polygonSegLen;B++){const q=N.polygonSegIdx+B;i.push({centroidIdx:j,subtile:L,polygonSegmentIdx:q,triangleSegmentIdx:this.polygonSegments[q].triangleSegIdx})}}const o=new la;i.sort((j,N)=>j.triangleSegmentIdx===N.triangleSegmentIdx?j.subtile-N.subtile:j.triangleSegmentIdx-N.triangleSegmentIdx);let h=0,g=0,_=0;for(const j of i){if(j.triangleSegmentIdx!==h)break;_++}const w=i.length;for(;g!==i.length;){h=i[g].triangleSegmentIdx;let j=0,N=g,O=g;for(let L=N;L<_&&i[L].subtile===j;L++)O++;for(;N!==_;){const L=i[N];j=L.subtile;const B=this.centroidData[L.centroidIdx].min.clone(),q=this.centroidData[L.centroidIdx].max.clone(),Y={vertexOffset:this.segments.segments[h].vertexOffset,primitiveOffset:o.length,vertexLength:this.segments.segments[h].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let Q=N;Q<O;Q++){const re=i[Q],he=this.polygonSegments[re.polygonSegmentIdx],pe=this.centroidData[re.centroidIdx].min,Se=this.centroidData[re.centroidIdx].max,be=this.indexArray.uint16;for(let oe=he.triangleArrayOffset;oe<he.triangleArrayOffset+he.triangleCount;oe++)o.emplaceBack(be[3*oe],be[3*oe+1],be[3*oe+2]);Y.primitiveLength+=he.triangleCount,B.x=Math.min(B.x,pe.x),B.y=Math.min(B.y,pe.y),q.x=Math.max(q.x,Se.x),q.y=Math.max(q.y,Se.y)}Y.primitiveLength>0&&this.triangleSubSegments.push({segment:Y,min:B,max:q}),N=O;for(let Q=N;Q<_&&i[Q].subtile===i[N].subtile;Q++)O++}g=_;for(let L=g;L<w&&i[L].triangleSegmentIdx===i[g].triangleSegmentIdx;L++)_++}o._trim(),this.indexArray=o}getVisibleSegments(i,o,h){const g=new Wi;if(this.wallMode){for(const re of this.triangleSubSegments)g.segments.push(re.segment);return g}let _=0,w=0;const j=1<<i.canonical.z;if(o){const re=o.getMinMaxForTile(i);re&&(_=re.min,w=re.max)}w+=this.maxHeight;const N=i.toUnwrapped();let O;const L=[N.canonical.x/j+N.wrap,N.canonical.y/j],B=[(N.canonical.x+1)/j+N.wrap,(N.canonical.y+1)/j],q=(re,he,pe)=>[re[0]*(1-pe[0])+he[0]*pe[0],re[1]*(1-pe[1])+he[1]*pe[1]],Y=[],Q=[];for(const re of this.triangleSubSegments){Y[0]=re.min.x/en,Y[1]=re.min.y/en,Q[0]=re.max.x/en,Q[1]=re.max.y/en;const he=q(L,B,Y),pe=q(L,B,Q);if(new hi([he[0],he[1],_],[pe[0],pe[1],w]).intersectsPrecise(h)===0){O&&(g.segments.push(O),O=void 0);continue}const Se=re.segment;O&&O.vertexOffset!==Se.vertexOffset&&(g.segments.push(O),O=void 0),O?(O.vertexLength+=Se.vertexLength,O.primitiveLength+=Se.primitiveLength):O={vertexOffset:Se.vertexOffset,primitiveLength:Se.primitiveLength,vertexLength:Se.vertexLength,primitiveOffset:Se.primitiveOffset,sortKey:void 0,vaos:{}}}return O&&g.segments.push(O),g}encodeCentroid(i,o){const h=i.centroid(),g=o.span(),_=Math.min(7,Math.round(g.x*this.tileToMeter/10)),w=Math.min(7,Math.round(g.y*this.tileToMeter/10));return new Kt(Le(h.x,1,en-1)<<3|_,Le(h.y,1,en-1)<<3|w)}encodeBorderCentroid(i){if(!i.borders)return new Kt(0,0);const o=i.borders,h=Number.MAX_VALUE;if(o[0][0]!==h||o[1][0]!==h){const g=o[0][0]!==h?0:1;return new Kt(6|(o[0][0]!==h?0:65528),(o[g][0]+o[g][1])/2<<3|6)}{const g=o[2][0]!==h?2:3;return new Kt((o[g][0]+o[g][1])/2<<3|6,6|(o[2][0]!==h?0:65528))}}showCentroid(i){const o=this.centroidData[i.centroidDataIndex];o.flags&=vd,o.centroidXY.x=0,o.centroidXY.y=0,this.writeCentroidToBuffer(o)}writeCentroidToBuffer(i){this.groundEffect.updateHiddenByLandmark(i);const o=i.vertexArrayOffset,h=i.vertexCount+i.vertexArrayOffset,g=i.flags&vd?j2:i.centroidXY,_=this.centroidVertexArray.geta_centroid_pos0(o);if(this.centroidVertexArray.geta_centroid_pos1(o)!==g.y||_!==g.x){for(let w=o;w<h;++w)this.centroidVertexArray.emplace(w,g.x,g.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const i of this.centroidData)this.writeCentroidToBuffer(i)}updateReplacement(i,o,h){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const g=o.getReplacementRegionsForTile(i.toUnwrapped());if(jg(this.activeReplacements,g))return;if(this.activeReplacements=g,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const w of this.centroidData)w.flags&=2147483647;const _=[];for(const w of this.activeReplacements){if(w.order<h)continue;const j=Math.max(1,Math.pow(2,w.footprintTileId.canonical.z-i.canonical.z));for(const N of this.centroidData)if(!(N.flags&vd||w.min.x>N.max.x||N.min.x>w.max.x||w.min.y>N.max.y||N.min.y>w.max.y))for(let O=0;O<N.footprintSegLen;O++){const L=this.footprintSegments[N.footprintSegIdx+O];if(_.length=0,N2(this.footprintVertices,L.vertexOffset,L.vertexCount,w.footprintTileId.canonical,i.canonical,_),E2(w.footprint,_,this.footprintIndices.uint16,L.indexOffset,L.indexCount,-L.vertexOffset,-j)){N.flags|=vd;break}}}for(const w of this.centroidData)this.writeCentroidToBuffer(w);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(i,o,h){let g=!1;for(let _=0;_<h.footprintSegLen;_++){const w=this.footprintSegments[h.footprintSegIdx+_];let j=0;for(const N of w.ringIndices){for(let O=j,L=N+j-1;O<N+j;L=O++){const B=this.footprintVertices.int16[2*(O+w.vertexOffset)+0],q=this.footprintVertices.int16[2*(O+w.vertexOffset)+1],Y=this.footprintVertices.int16[2*(L+w.vertexOffset)+1];q>o!=Y>o&&i<(this.footprintVertices.int16[2*(L+w.vertexOffset)+0]-B)*(o-q)/(Y-q)+B&&(g=!g)}j=N}}return g}getHeightAtTileCoord(i,o){let h=Number.NEGATIVE_INFINITY,g=!0;const _=4*(i+en)*en+(o+en);if(this.partLookup.hasOwnProperty(_)){const w=this.partLookup[_];return w?{height:w.height,hidden:!!(w.flags&vd)}:void 0}for(const w of this.centroidData)i>w.max.x||w.min.x>i||o>w.max.y||w.min.y>o||this.footprintContainsPoint(i,o,w)&&w&&w.height>h&&(h=w.height,this.partLookup[_]=w,g=!!(w.flags&vd));if(h!==Number.NEGATIVE_INFINITY)return{height:h,hidden:g};this.partLookup[_]=void 0}}function v1(c,i){const o=c.add(i)._unit();return c.x*o.x+c.y*o.y}function w0(c,i,o,h){const g=i.sub(c)._perp()._unit(),_=o.sub(i)._perp()._unit();return M2(c,i,o,v1(g,_),h)}function M2(c,i,o,h,g){const _=Math.sqrt(1-h*h);return Math.min(c.dist(i)/3,i.dist(o)/3,g*_/h)}function Sv(c,i,o){return c.x<o[0].x&&i.x<o[0].x||c.x>o[1].x&&i.x>o[1].x||c.y<o[0].y&&i.y<o[0].y||c.y>o[1].y&&i.y>o[1].y}function S0(c,i){return c.x<i[0].x||c.x>i[1].x||c.y<i[0].y||c.y>i[1].y}function _1(c,i,o){if(c.x<0||c.x>=en||i.x<0||i.x>=en||o.x<0||o.x>=en)return!1;const h=o.sub(i),g=h.perp(),_=c.sub(i);return(h.x*_.x+h.y*_.y)/Math.sqrt((h.x*h.x+h.y*h.y)*(_.x*_.x+_.y*_.y))>-.866&&g.x*_.x+g.y*_.y<0}function P2(c,i,o){const h=i?2|c:-3&c;return o?1|h:-2&h}function T0(){const c=Math.PI/32,i=Math.tan(c),o=ce;return o*Math.sqrt(1+2*i*i)-o}function E0(c,i,o){const h=1<<o.z,g=Fe(o.x/h),_=Fe((o.x+1)/h),w=$e(o.y/h),j=$e((o.y+1)/h);return function(N,O,L,B,q=0,Y){const Q=[];if(!N.length||!L||!B)return Q;const re=(we,je)=>{for(const Ve of we)Q.push({polygon:Ve,bounds:je})},he=Math.ceil(Math.log2(L)),pe=Math.ceil(Math.log2(B)),Se=he-pe,be=[];for(let we=0;we<Math.abs(Se);we++)be.push(Se>0?0:1);for(let we=0;we<Math.min(he,pe);we++)be.push(0),be.push(1);let oe=N;if(oe=fv(oe,O[0].y-q,O[1].y+q,1),oe=fv(oe,O[0].x-q,O[1].x+q,0),!oe.length)return Q;const xe=[];for(be.length?xe.push({polygons:oe,bounds:O,depth:0}):re(oe,O);xe.length;){const we=xe.pop(),je=we.depth,Ve=be[je],We=we.bounds[0],Ze=we.bounds[1],Qe=Ve===0?We.x:We.y,pt=Ve===0?Ze.x:Ze.y,kt=Y?Y(Ve,Qe,pt):.5*(Qe+pt),Ct=fv(we.polygons,Qe-q,kt+q,Ve),Pt=fv(we.polygons,kt-q,pt+q,Ve);if(Ct.length){const Vt=[We,new Kt(Ve===0?kt:Ze.x,Ve===1?kt:Ze.y)];be.length>je+1?xe.push({polygons:Ct,bounds:Vt,depth:je+1}):re(Ct,Vt)}if(Pt.length){const Vt=[new Kt(Ve===0?kt:We.x,Ve===1?kt:We.y),Ze];be.length>je+1?xe.push({polygons:Pt,bounds:Vt,depth:je+1}):re(Pt,Vt)}}return Q}(c,i,Math.ceil((_-g)/11.25),Math.ceil((w-j)/11.25),1,(N,O,L)=>{if(N===0)return .5*(O+L);{const B=$e((o.y+O/en)/h);return(Oe(.5*($e((o.y+L/en)/h)+B))*h-o.y)*en}})}function N2(c,i,o,h,g,_){const w=Math.pow(2,h.z-g.z);for(let j=0;j<o;j++){let N=c.int16[2*(j+i)+0],O=c.int16[2*(j+i)+1];N=(N+g.x*en)*w-h.x*en,O=(O+g.y*en)*w-h.y*en,_.push(new Kt(N,O))}}let Dg,Tv;mn(wv,"FillExtrusionBucket",{omit:["layers","features"]}),mn(zh,"PartData"),mn(bv,"FootprintSegment"),mn(Lh,"BorderCentroidData"),mn(Bh,"GroundEffect");class _d extends Kt{constructor(i,o,h){super(i,o),this.z=h}}class b1 extends _d{constructor(i,o,h,g){super(i,o,h),this.w=g}}function D2(c,i,o,h){const g=o==="x"?"y":"x",_=(h-c[o])/(i[o]-c[o]);c[g]=Math.round(c[g]+(i[g]-c[g])*_),c[o]=h,c.hasOwnProperty("z")&&(c.z=Vn(c.z,i.z,_)),c.hasOwnProperty("w")&&(c.w=Vn(c.w,i.w,_))}function A0(c,i,o,h){const g=o,_=h;for(const w of["x","y"]){let j=c,N=i;j[w]>=N[w]&&(j=i,N=c),j[w]<g&&N[w]>g&&D2(j,N,w,g),j[w]<_&&N[w]>_&&D2(N,j,w,_)}}function m(c,i,o,h,g,_){const w=[];for(let j=0;j<c.length;j++){const N=c[j];let O;const L=w.length;let B=0;for(let q=0;q<N.length-1;q++){let Y=N[q],Q=N[q+1],re=0;const he=B;let pe,Se;_&&(re=Math.hypot(Q.x-Y.x,Q.y-Y.y),B+=re,pe=Y,Se=Q),Y.x<i&&Q.x<i||(Y.x<i?Y=new Kt(i,Y.y+(i-Y.x)/(Q.x-Y.x)*(Q.y-Y.y))._round():Q.x<i&&(Q=new Kt(i,Y.y+(i-Y.x)/(Q.x-Y.x)*(Q.y-Y.y))._round()),Y.y<o&&Q.y<o||(Y.y<o?Y=new Kt(Y.x+(o-Y.y)/(Q.y-Y.y)*(Q.x-Y.x),o)._round():Q.y<o&&(Q=new Kt(Y.x+(o-Y.y)/(Q.y-Y.y)*(Q.x-Y.x),o)._round()),Y.x>=h&&Q.x>=h||(Y.x>=h?Y=new Kt(h,Y.y+(h-Y.x)/(Q.x-Y.x)*(Q.y-Y.y))._round():Q.x>=h&&(Q=new Kt(h,Y.y+(h-Y.x)/(Q.x-Y.x)*(Q.y-Y.y))._round()),Y.y>=g&&Q.y>=g||(Y.y>=g?Y=new Kt(Y.x+(g-Y.y)/(Q.y-Y.y)*(Q.x-Y.x),g)._round():Q.y>=g&&(Q=new Kt(Y.x+(g-Y.y)/(Q.y-Y.y)*(Q.x-Y.x),g)._round()),O&&Y.equals(O[O.length-1])||(O=[Y],w.push(O),_&&_.push({progress:{min:he+C(pe,Se,Y)*re,max:1},parentIndex:j,prevPoint:pe,nextPoint:Se})),O.push(Q),_&&(_[_.length-1].progress.max=he+C(pe,Se,Q)*re,_[_.length-1].nextPoint=Se)))))}if(_&&B>0)for(let q=L;q<w.length;q++)_[q].progress.min/=B,_[q].progress.max/=B}return w}function v(c,i,o,h,g){if(c.length<2)return void h.push(c);const _=[];for(;i.valid();){const[O,L]=i.get();for(let B=0;B<c.length-1;B++){const q=c[B],Y=c[B+1],Q=ei(q,Y,O,L);if(Q){const[re]=Q,he=new Kt(Vn(q.x,Y.x,re),Vn(q.y,Y.y,re));_.push({t:B+re,distance:0,point:he})}}i.next()}if(_.length===0)return void h.push(c);_.sort((O,L)=>O.t-L.t);let w=0,j=0,N=[];for(h.push(N);w!==c.length;){if(j===_.length){for(;w!==c.length;)N.length!==0&&N[N.length-1].equals(c[w])||N.push(c[w]),w++;break}_[j].t<=w?(N.length!==0&&N[N.length-1].equals(_[j].point)||N.push(_[j].point),Math.trunc(_[j].t),j++):(N.length!==0&&N[N.length-1].equals(c[w])||N.push(c[w]),w++)}}function C(c,i,o){return c.x!==i.x?(o.x-c.x)/(i.x-c.x):c.y!==i.y?(o.y-c.y)/(i.y-c.y):0}function k(c,i){return c.x*i.x+c.y*i.y}function G(c,i){if(c.length===1){let o=0;const h=i[o++];let g;for(;!g||h.equals(g);)if(g=i[o++],!g)return 1/0;for(;o<i.length;o++){const _=i[o],w=c[0],j=g.sub(h),N=_.sub(h),O=w.sub(h),L=k(j,j),B=k(j,N),q=k(N,N),Y=k(O,j),Q=k(O,N),re=L*q-B*B,he=(q*Y-B*Q)/re,pe=(L*Q-B*Y)/re,Se=h.z*(1-he-pe)+g.z*he+_.z*pe;if(isFinite(Se))return Se}return 1/0}{let o=1/0;for(const h of i)o=Math.min(o,h.z);return o}}function ee(c,i,o,h,g,_,w,j){const N=w*g.getElevationAt(c,i,!0,!0),O=_[0]!==0,L=O?_[1]===0?w*(_[0]/7-450):w*function(B,q,Y){const Q=Math.floor(q[0]/8),re=Math.floor(q[1]/8),he=10*(q[0]-8*Q),pe=10*(q[1]-8*re),Se=B.getElevationAt(Q,re,!0,!0),be=B.getMeterToDEM(Y),oe=Math.floor(.5*(he*be-1)),xe=Math.floor(.5*(pe*be-1)),we=B.tileCoordToPixel(Q,re),je=2*oe+1,Ve=2*xe+1,We=function(Pt,Vt,ht,Mt,dt){return[Pt.getElevationAtPixel(Vt,ht,!0),Pt.getElevationAtPixel(Vt+dt,ht,!0),Pt.getElevationAtPixel(Vt,ht+dt,!0),Pt.getElevationAtPixel(Vt+Mt,ht+dt,!0)]}(B,we.x-oe,we.y-xe,je,Ve),Ze=Math.abs(We[0]-We[1]),Qe=Math.abs(We[2]-We[3]),pt=Math.abs(We[0]-We[2])+Math.abs(We[1]-We[3]),kt=Math.min(.25,.5*be*(Ze+Qe)/je),Ct=Math.min(.25,.5*be*pt/Ve);return Se+Math.max(kt*he,Ct*pe)}(g,_,j):N;return{base:N+(o===0?-1:o),top:O?Math.max(L+h,N+o+2):N+h}}const _e=Vr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),Re=Vr([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:at}=_e,Lt=Vr([{name:"a_packed",components:3,type:"Float32"}]),{members:hn}=Lt,En=Vr([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:Ht}=En;class Wt{constructor(i,o){this.width=i,this.height=o,this.nextRow=0,this.image=new Oh({width:i,height:o}),this.positions={},this.uploaded=!1}getDash(i,o){const h=this.getKey(i,o);return this.positions[h]}trim(){const i=this.width,o=this.height=nn(this.nextRow);this.image.resize({width:i,height:o})}getKey(i,o){return i.join(",")+o}getDashRanges(i,o,h){const g=[];let _=i.length%2==1?-i[i.length-1]*h:0,w=i[0]*h,j=!0;g.push({left:_,right:w,isDash:j,zeroLength:i[0]===0});let N=i[0];for(let O=1;O<i.length;O++){j=!j;const L=i[O];_=N*h,N+=L,w=N*h,g.push({left:_,right:w,isDash:j,zeroLength:L===0})}return g}addRoundDash(i,o,h){const g=o/2;for(let _=-h;_<=h;_++){const w=this.width*(this.nextRow+h+_);let j=0,N=i[j];for(let O=0;O<this.width;O++){O/N.right>1&&(N=i[++j]);const L=Math.abs(O-N.left),B=Math.abs(O-N.right),q=Math.min(L,B);let Y;const Q=_/h*(g+1);if(N.isDash){const re=g-Math.abs(Q);Y=Math.sqrt(q*q+re*re)}else Y=g-Math.sqrt(q*q+Q*Q);this.image.data[w+O]=Math.max(0,Math.min(255,Y+128))}}}addRegularDash(i,o){for(let N=i.length-1;N>=0;--N){const O=i[N],L=i[N+1];O.zeroLength?i.splice(N,1):L&&L.isDash===O.isDash&&(L.left=O.left,i.splice(N,1))}const h=i[0],g=i[i.length-1];h.isDash===g.isDash&&(h.left=g.left-this.width,g.right=h.right+this.width);const _=this.width*this.nextRow;let w=0,j=i[w];for(let N=0;N<this.width;N++){N/j.right>1&&(j=i[++w]);const O=Math.abs(N-j.left),L=Math.abs(N-j.right),B=Math.min(O,L);this.image.data[_+N]=Math.max(0,Math.min(255,(j.isDash?B:-B)+o+128))}}addDash(i,o){const h=this.getKey(i,o);if(this.positions[h])return this.positions[h];const g=o==="round",_=g?7:0,w=2*_+1;if(this.nextRow+w>this.height)return or("LineAtlas out of space"),null;i.length===0&&i.push(1);let j=0;for(let L=0;L<i.length;L++)i[L]<0&&(or("Negative value is found in line dasharray, replacing values with 0"),i[L]=0),j+=i[L];if(j!==0){const L=this.width/j,B=this.getDashRanges(i,this.width,L);g?this.addRoundDash(B,L,_):this.addRegularDash(B,o==="square"?.5*L:0)}const N=this.nextRow+_;this.nextRow+=w;const O={tl:[N,_],br:[j,0]};return this.positions[h]=O,O}}mn(Wt,"LineAtlas");const ni=yd.VectorTileFeature.types,Gr=Math.cos(Math.PI/180*37.5),Ea=Math.cos(Math.PI/180*5);class At{constructor(i){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=i.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=i.overscaling,this.pixelRatio=i.pixelRatio,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=i.index,this.projection=i.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new Wx,this.layoutVertexArray2=new Eo,this.patternVertexArray=new Eo,this.indexArray=new la,this.programConfigurations=new gd(i.layers,{zoom:i.zoom,lut:i.lut}),this.segments=new Wi,this.maxLineLength=0,this.zOffsetVertexArray=new Eo,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.tessellationStep=i.tessellationStep?i.tessellationStep:en/64}updateFootprints(i,o){}populate(i,o,h,g){this.hasPattern=Eg("line",this.layers,this.pixelRatio,o);const _=this.layers[0].layout.get("line-sort-key");this.tileToMeter=Je(h);const w=this.layers[0].layout.get("line-elevation-reference");if(w==="hd-road-markup")this.elevationType="road";else{const q=this.layers[0].layout.get("line-z-offset"),Y=q.isConstant()&&!q.constantOr(0);this.elevationType=w!=="sea"&&w!=="ground"&&Y?"none":"offset",this.elevationType==="offset"&&w==="none"&&or(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const j=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&j!==void 0;const N=[];for(const{feature:q,id:Y,index:Q,sourceLayerIndex:re}of i){const he=this.layers[0]._featureFilter.needGeometry,pe=Tn(q,he);if(!this.layers[0]._featureFilter.filter(new ui(this.zoom),pe,h))continue;const Se=_?_.evaluate(pe,{},h):void 0,be={id:Y,properties:q.properties,type:q.type,sourceLayerIndex:re,index:Q,geometry:he?pe.geometry:yn(q,h,g),patterns:{},sortKey:Se};N.push(be)}_&&N.sort((q,Y)=>q.sortKey-Y.sortKey);const{lineAtlas:O,featureIndex:L}=o,B=this.addConstantDashes(O);for(const q of N){const{geometry:Y,index:Q,sourceLayerIndex:re}=q;if(B&&this.addFeatureDashes(q,O),this.hasPattern){const he=lv("line",this.layers,q,this.zoom,this.pixelRatio,o);this.patternFeatures.push(he)}else this.addFeature(q,Y,Q,h,O.positions,o.availableImages,o.brightness,o.elevationFeatures);L.insert(i[Q].feature,Y,Q,re,this.index)}}addConstantDashes(i){let o=!1;for(const h of this.layers){const g=h.paint.get("line-dasharray").value,_=h.layout.get("line-cap").value;if(g.kind!=="constant"||_.kind!=="constant")o=!0;else{const w=_.value,j=g.value;if(!j)continue;i.addDash(j,w)}}return o}addFeatureDashes(i,o){const h=this.zoom;for(const g of this.layers){const _=g.paint.get("line-dasharray").value,w=g.layout.get("line-cap").value;if(_.kind==="constant"&&w.kind==="constant")continue;let j,N;if(_.kind==="constant"){if(j=_.value,!j)continue}else j=_.evaluate({zoom:h},i);N=w.kind==="constant"?w.value:w.evaluate({zoom:h},i),o.addDash(j,N),i.patterns[g.id]=[o.getKey(j,N)]}}update(i,o,h,g,_,w,j){this.programConfigurations.updatePaintArrays(i,o,_,h,g,w,j)}addFeatures(i,o,h,g,_,w){for(const j of this.patternFeatures)this.addFeature(j,j.geometry,j.index,o,h,g,w)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,hn)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=i.createVertexBuffer(this.patternVertexArray,Ht)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=i.createVertexBuffer(this.zOffsetVertexArray,Re.members,!0)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,at),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&i.properties.hasOwnProperty("mapbox_clip_start")&&i.properties.hasOwnProperty("mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,o,h,g,_,w,j,N){const O=this.layers[0].layout,L=O.get("line-join").evaluate(i,{}),B=O.get("line-cap").evaluate(i,{}),q=O.get("line-miter-limit"),Y=O.get("line-round-limit");this.lineClips=this.lineFeatureClips(i),this.lineFeature=i,this.zOffsetValue=O.get("line-z-offset").value;const Q=this.layers[0].paint.get("line-width").value;if(Q.kind!=="constant"&&Q.isLineProgressConstant===!1&&(this.variableWidthValue=Q),this.elevationType==="road"){const re=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(i,o,g,N,L,B,q,Y)){const[he,pe]=this.clipRuntimeLinesToTile(o,1);for(let Se=0;Se<he.length;Se++){const be=he[Se],oe=pe[Se],xe={progress:{min:oe.progress.min,max:oe.progress.max},nextDir:this.computeSegNextDir(oe,be),prevDir:this.computeSegPrevDir(oe,be)};this.addLine(be,i,g,L,B,q,Y,xe)}this.fillNonElevatedRoadSegment(re)}}else for(const re of o)this.addLine(re,i,g,L,B,q,Y);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,_,w,g,j)}computeSegNextDir(i,o){return i.nextPoint.sub(o.at(-2)).unit()}computeSegPrevDir(i,o){return o[1].sub(i.prevPoint).unit()}clipLinesToTile(i,o){return m(i,-o,-o,en+o,en+o)}clipRuntimeLinesToTile(i,o){const h=[];return[m(i,-o,-o,en+o,en+o,h),h]}addElevatedRoadFeature(i,o,h,g,_,w,j,N){const O=[],L=kl.getElevationFeature(i,g);if(L){const B=this.clipLinesToTile(o,1),q=this.prepareElevatedLines(B,L,h);for(const Y of q)O.push({geometry:Y,elevation:L,elevationTileID:h,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(O.length===0)return!1;for(const B of O){const q=this.layoutVertexArray.length;this.addLine(B.geometry,i,h,_,w,j,N);const Y=new s1(h,B.elevationTileID);if(B.elevation)for(let Q=q;Q<this.layoutVertexArray.length;Q++){const re=new Kt(this.layoutVertexArray.int16[6*Q]>>1,this.layoutVertexArray.int16[6*Q+1]>>1),he=Y.pointElevation(re,B.elevation,.05);this.updateHeightRange(he),this.zOffsetVertexArray.emplaceBack(he,0,0)}else this.fillNonElevatedRoadSegment(q)}return!0}prepareElevatedLines(i,o,h){if(o.constantHeight!=null)return i;const g=[],_=1/Je(h);for(const w of i)v(w,new a1(o,_),0,g);return g}fillNonElevatedRoadSegment(i){for(let o=i;o<this.layoutVertexArray.length;o++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(i){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,i),this.heightRange.max=Math.max(this.heightRange.max,i)):this.heightRange={min:i,max:i}}addLine(i,o,h,g,_,w,j,N){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const O=g==="none";this.patternJoinNone=this.hasPattern&&O,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const L=N&&N.progress.min>0,B=N&&N.progress.max<1;if(this.lineClips){let Ve={min:this.lineClips.start,max:this.lineClips.end},We=1;if(N){const pt=this.lineClips.end-this.lineClips.start;Ve=function(kt,Ct,Pt){return{min:ci(kt.min,Ct,Pt),max:ci(kt.max,Ct,Pt)}}(N.progress,{min:0,max:1},Ve),pt>0&&(We=(Ve.max-Ve.min)/pt)}const Ze=+o.properties.mapbox_clip_feature_len,Qe=+o.properties.mapbox_clip_seg_len;if(Number.isNaN(Ze)||Number.isNaN(Qe)){for(let kt=0;kt<i.length-1;kt++)this.totalDistance+=i[kt].dist(i[kt+1]);const pt=this.totalDistance/(Ve.max-Ve.min);this.totalFeatureLength=Number.isFinite(pt)?pt:0,this.lineClips.start=Ve.min,this.lineClips.end=Ve.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=Ze,this.distance=Qe*We,this.lineClips.start=Ve.min,this.lineClips.end=Ve.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const q=ni[o.type]==="Polygon";let Y=i.length;for(;Y>=2&&i[Y-1].equals(i[Y-2]);)Y--;let Q=0;for(;Q<Y-1&&i[Q].equals(i[Q+1]);)Q++;if(Y<(q?3:2))return;g==="bevel"&&(w=1.05);const re=this.segments.prepareSegment(10*Y,this.layoutVertexArray,this.indexArray);let he,pe,Se,be,oe,xe,we,je;N&&N.prevDir&&(xe=N.prevDir.perp()),N&&N.nextDir&&(we=N.nextDir.perp()),this.e1=this.e2=-1,q&&(he=i[Y-2],oe=i[Q].sub(he)._unit()._perp());for(let Ve=Q;Ve<Y;Ve++){if(Se=Ve===Y-1?q?i[Q+1]:void 0:i[Ve+1],Se&&i[Ve].equals(Se))continue;oe&&(be=oe),he&&(pe=he),he=i[Ve],je=this.evaluateLineProgressFeatures(pe?pe.dist(he):0),oe=Se?Se.sub(he)._unit()._perp():be,be=be||oe;const We=pe&&Se;let Ze=We?g:q||O?"butt":_;const Qe=be.x*oe.x+be.y*oe.y;if(O){const dt=function(ft){if(ft.patternJoinNone){const $t=ft.segmentPoints.length/2,Gt=ft.lineSoFar-ft.segmentStart;for(let Dn=0;Dn<$t;++Dn){const bn=ft.segmentPoints[2*Dn+1],an=Math.round(ft.segmentPoints[2*Dn])+.5+.25*bn;ft.patternVertexArray.emplaceBack(an,Gt,ft.segmentStart),ft.patternVertexArray.emplaceBack(an,Gt,ft.segmentStart)}ft.segmentPoints.length=0}ft.e1=ft.e2=-1};if(We&&Qe<Ea){this.updateDistance(pe,he),this.addCurrentVertex(he,be,1,1,re,je),dt(this),this.addCurrentVertex(he,oe,-1,-1,re,je);continue}if(pe){if(!Se){this.updateDistance(pe,he),this.addCurrentVertex(he,be,1,1,re,je),dt(this);continue}Ze="miter"}}let pt=be.add(oe);pt.x===0&&pt.y===0||pt._unit();const kt=pt.x*oe.x+pt.y*oe.y,Ct=kt!==0?1/kt:1/0,Pt=2*Math.sqrt(2-2*kt),Vt=kt<Gr&&pe&&Se,ht=be.x*oe.y-be.y*oe.x>0,Mt=this.overscaling<=16?15*en/(512*this.overscaling):0;if(We&&Ze==="round"){if(Ct<j)Ze="miter";else if(Ct<=2){const dt=gt(he,-10,en+10);Ze=this.elevationType==="offset"&&(dt||this.hasCrossSlope)?"miter":"fakeround"}}if(Ze==="miter"&&Ct>w&&(Ze="bevel"),Ze==="bevel"&&(Ct>2&&(Ze="flipbevel"),Ct<w&&(Ze="miter")),pe&&!(Ze==="miter"&&Vt)&&this.updateDistance(pe,he),Ze==="miter")if(Vt){const dt=he.dist(pe);if(dt>2*Mt){const $t=he.sub(he.sub(pe)._mult(Mt/dt)._round());this.updateDistance(pe,$t),this.addCurrentVertex($t,be,0,0,re,je),pe=$t}this.updateDistance(pe,he),pt._mult(Ct),this.addCurrentVertex(he,pt,0,0,re,je);const ft=he.dist(Se);if(ft>2*Mt){const $t=he.add(Se.sub(he)._mult(Mt/ft)._round());this.updateDistance(he,$t),this.addCurrentVertex($t,oe,0,0,re,je),he=$t}}else pt._mult(Ct),this.addCurrentVertex(he,pt,0,0,re,je);else if(Ze==="flipbevel"){if(Ct>100)pt=oe.mult(-1);else{const dt=Ct*be.add(oe).mag()/be.sub(oe).mag();pt._perp()._mult(dt*(ht?-1:1))}this.addCurrentVertex(he,pt,0,0,re,je),this.addCurrentVertex(he,pt.mult(-1),0,0,re,je)}else if(Ze==="bevel"||Ze==="fakeround"){je!=null&&pe&&this.addCurrentVertex(he,we||be,-1,-1,re,je);const dt=he.dist(pe)<=2*Mt&&Ze!=="bevel",ft=pt.mult(ht?1:-1);ft._mult(Ct);const $t=oe.mult(ht?-1:1),Gt=be.mult(ht?-1:1),Dn=this.evaluateLineProgressFeatures(this.distance);if(je==null&&(this.addHalfVertex(he,ft.x,ft.y,!1,!ht,0,re,Dn),dt||this.addHalfVertex(he,ft.x+2*Gt.x,ft.y+2*Gt.y,!1,ht,0,re,Dn)),Ze==="fakeround"){const bn=Math.round(180*Pt/Math.PI/20);this.addHalfVertex(he,Gt.x,Gt.y,!1,ht,0,re,Dn);for(let an=0;an<bn;an++){let Ut=an/bn;if(Ut!==.5){const An=Ut-.5;Ut+=Ut*An*(Ut-1)*((1.0904+Qe*(Qe*(3.55645-1.43519*Qe)-3.2452))*An*An+(.848013+Qe*(.215638*Qe-1.06021)))}const sr=$t.sub(Gt)._mult(Ut)._add(Gt)._unit();this.addHalfVertex(he,sr.x,sr.y,!1,ht,0,re,Dn)}this.addHalfVertex(he,$t.x,$t.y,!1,ht,0,re,Dn)}dt||je!=null||this.addHalfVertex(he,ft.x+2*$t.x,ft.y+2*$t.y,!1,ht,0,re,Dn),je!=null&&Se&&this.addCurrentVertex(he,xe||oe,1,1,re,je)}else if(Ze==="butt")this.addCurrentVertex(he,pt,0,0,re,je);else if(Ze==="square"){if(!pe){const dt=L?0:-1;this.addCurrentVertex(he,pt,dt,dt,re,je)}if(this.addCurrentVertex(he,pt,0,0,re,je),pe){const dt=B?0:1;this.addCurrentVertex(he,pt,dt,dt,re,je)}}else if(Ze==="round"){if(pe){const dt=!We&&we?we:be;this.addCurrentVertex(he,dt,0,0,re,je),!We&&B||this.addCurrentVertex(he,dt,1,1,re,je,!0)}if(Se){const dt=!We&&xe?xe:oe;!We&&L||this.addCurrentVertex(he,dt,-1,-1,re,je,!0),this.addCurrentVertex(he,dt,0,0,re,je)}}}}addVerticesTo(i,o,h,g,_,w,j,N,O,L){const B=(o.w-i.w)/this.tessellationStep|0;let q=0;const Y=this.scaledDistance;if(B>1){this.lineSoFar=i.w;const re=(o.x-i.x)/B,he=(o.y-i.y)/B,pe=(o.z-i.z)/B,Se=(o.w-i.w)/B;for(let be=1;be<B;++be){i.x+=re,i.y+=he,i.z+=pe,this.lineSoFar+=Se,q+=Se;const oe=this.evaluateLineProgressFeatures(this.prevDistance+q);this.scaledDistance=(this.prevDistance+q)/this.totalDistance,this.addHalfVertex(i,h,g,L,!1,j,O,oe),this.addHalfVertex(i,_,w,L,!0,-N,O,oe)}}this.lineSoFar=o.w,this.scaledDistance=Y;const Q=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(o,h,g,L,!1,j,O,Q),this.addHalfVertex(o,_,w,L,!0,-N,O,Q)}evaluateLineProgressFeatures(i){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+i)/this.totalFeatureLength):or(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let o=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(o=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:o}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:o}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:o}}addCurrentVertex(i,o,h,g,_,w,j=!1){const N=o.x+o.y*h,O=o.y-o.x*h,L=o.y*g-o.x,B=-o.y-o.x*g;if(w!=null){const q=this.elevationType==="offset",Y=-10,Q=en+10,re=w.zOffset,he=new b1(i.x,i.y,re,this.lineSoFar),pe=!!q&&gt(i,Y,Q),Se=this.lineSoFar,be=this.distance;if(this.currentVertex)if(pe){const oe=this.currentVertexIsOutside,xe=this.currentVertex,we=new b1(i.x,i.y,re,this.lineSoFar);if(A0(xe,we,Y,Q),!gt(we,Y,Q)){if(oe){this.e1=this.e2=-1,this.distance-=xe.dist(he),this.lineSoFar=xe.w;const je=this.evaluateLineProgressFeatures(xe.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(xe,N,O,j,!1,h,_,je),this.addHalfVertex(xe,L,B,j,!0,-g,_,je),this.prevDistance=this.distance}this.distance=this.prevDistance+xe.dist(we),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(xe,we,N,O,L,B,h,g,_,j),this.distance=be,this.scaledDistance=this.distance/this.totalDistance}}else{const oe=this.currentVertex;if(this.currentVertexIsOutside){A0(oe,he,Y,Q),this.e1=this.e2=-1,this.distance-=oe.dist(he),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=oe.w;const xe=this.evaluateLineProgressFeatures(oe.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(oe,N,O,j,!1,h,_,xe),this.addHalfVertex(oe,L,B,j,!0,-g,_,xe),this.prevDistance=this.distance,this.distance=be,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(oe,he,N,O,L,B,h,g,_,j)}else pe||(this.addHalfVertex(i,N,O,j,!1,h,_,w),this.addHalfVertex(i,L,B,j,!0,-g,_,w));this.currentVertex=he,this.currentVertexIsOutside=pe,this.lineSoFar=Se}else this.addHalfVertex(i,N,O,j,!1,h,_,w),this.addHalfVertex(i,L,B,j,!0,-g,_,w)}addHalfVertex({x:i,y:o},h,g,_,w,j,N,O){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),w||this.segmentPoints.push(this.lineSoFar-this.segmentStart,j)),this.layoutVertexArray.emplaceBack((i<<1)+(_?1:0),(o<<1)+(w?1:0),Math.round(63*h)+128,Math.round(63*g)+128,1+(j===0?0:j<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const B=Vn(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,B)}const L=N.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,L),N.primitiveLength++),w?this.e2=L:this.e1=L,O!=null&&this.zOffsetVertexArray.emplaceBack(O.zOffset,O.variableWidth,O.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(i,o){this.prevDistance=this.distance,this.distance+=i.dist(o),this.updateScaledDistance()}}function gt(c,i,o){return c.x<i||c.x>o||c.y<i||c.y>o}let Rt,xn;function xr(c,i,o){return i*(en/(c.tileSize*Math.pow(2,o-c.tileID.overscaledZ)))}mn(At,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const Oi=(c,i,o)=>(1-o)*c+o*i;function Mr(c,i){return 1/xr(c,1,i.tileZoom)}function Wr(c,i,o,h){return c.translatePosMatrix(h||i.tileID.projMatrix,i,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const Bs=c=>{const i=[];na(c)&&i.push("RENDER_LINE_DASH"),c.paint.get("line-gradient")&&i.push("RENDER_LINE_GRADIENT");const o=c.paint.get("line-trim-offset");o[0]===0&&o[1]===0||i.push("RENDER_LINE_TRIM_OFFSET"),c.paint.get("line-border-width").constantOr(1)!==0&&i.push("RENDER_LINE_BORDER");const h=c.layout.get("line-join").constantOr("miter")==="none",g=!!c.paint.get("line-pattern").constantOr(1);return h&&g&&i.push("LINE_JOIN_NONE"),i};function na(c){const i=c.paint.get("line-dasharray").value;return i.value||i.kind!=="constant"}let bd;const O2=()=>bd||(bd={layout:Rt||(Rt=new Yi({"line-cap":new fn(rt.layout_line["line-cap"]),"line-join":new fn(rt.layout_line["line-join"]),"line-miter-limit":new Xt(rt.layout_line["line-miter-limit"]),"line-round-limit":new Xt(rt.layout_line["line-round-limit"]),"line-sort-key":new fn(rt.layout_line["line-sort-key"]),"line-z-offset":new fn(rt.layout_line["line-z-offset"]),"line-elevation-reference":new Xt(rt.layout_line["line-elevation-reference"]),"line-cross-slope":new Xt(rt.layout_line["line-cross-slope"]),visibility:new Xt(rt.layout_line.visibility),"line-width-unit":new Xt(rt.layout_line["line-width-unit"])})),paint:xn||(xn=new Yi({"line-opacity":new fn(rt.paint_line["line-opacity"]),"line-color":new fn(rt.paint_line["line-color"]),"line-translate":new Xt(rt.paint_line["line-translate"]),"line-translate-anchor":new Xt(rt.paint_line["line-translate-anchor"]),"line-width":new fn(rt.paint_line["line-width"]),"line-gap-width":new fn(rt.paint_line["line-gap-width"]),"line-offset":new fn(rt.paint_line["line-offset"]),"line-blur":new fn(rt.paint_line["line-blur"]),"line-dasharray":new fn(rt.paint_line["line-dasharray"]),"line-pattern":new fn(rt.paint_line["line-pattern"]),"line-pattern-cross-fade":new Xt(rt.paint_line["line-pattern-cross-fade"]),"line-gradient":new Nl(rt.paint_line["line-gradient"]),"line-trim-offset":new Xt(rt.paint_line["line-trim-offset"]),"line-trim-fade-range":new Xt(rt.paint_line["line-trim-fade-range"]),"line-trim-color":new Xt(rt.paint_line["line-trim-color"]),"line-emissive-strength":new Xt(rt.paint_line["line-emissive-strength"]),"line-border-width":new fn(rt.paint_line["line-border-width"]),"line-border-color":new fn(rt.paint_line["line-border-color"]),"line-occlusion-opacity":new Xt(rt.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},bd);class HY extends fn{possiblyEvaluate(i,o){return o=new ui(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,transition:o.transition}),super.possiblyEvaluate(i,o)}evaluate(i,o,h,g){return o=Xe({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(i,o,h,g)}}let w1;function rI(c,i){return i>0?i+2*c:c}const GY=Vr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),WY=Vr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),ZY=Vr([{name:"a_projected_pos",components:4,type:"Float32"}],4);Vr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const XY=Vr([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),KY=Vr([{name:"a_texb",components:2,type:"Uint16"}]),YY=Vr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),QY=Vr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Vr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const iI=Vr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),JY=Vr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Vr([{name:"triangle",components:3,type:"Uint16"}]),Vr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Vr([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),Vr([{type:"Float32",name:"offsetX"}]),Vr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var As=24;function eQ(c,i,o){return c.sections.forEach(h=>{h.text=function(g,_,w){const j=_.layout.get("text-transform").evaluate(w,{});return j==="uppercase"?g=g.toLocaleUpperCase():j==="lowercase"&&(g=g.toLocaleLowerCase()),Pl.applyArabicShaping&&(g=Pl.applyArabicShaping(g)),g}(h.text,i,o)}),c}const S1={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function tQ(c){return c==="︶"||c==="﹈"||c==="︸"||c==="﹄"||c==="﹂"||c==="︾"||c==="︼"||c==="︺"||c==="︘"||c==="﹀"||c==="︐"||c==="︓"||c==="︔"||c==="｀"||c==="￣"||c==="︑"||c==="︒"}function nQ(c){return c==="︵"||c==="﹇"||c==="︷"||c==="﹃"||c==="﹁"||c==="︽"||c==="︻"||c==="︹"||c==="︗"||c==="︿"}var aI,uA,sI,dA={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function rQ(){return aI||(aI=1,dA.read=function(c,i,o,h,g){var _,w,j=8*g-h-1,N=(1<<j)-1,O=N>>1,L=-7,B=o?g-1:0,q=o?-1:1,Y=c[i+B];for(B+=q,_=Y&(1<<-L)-1,Y>>=-L,L+=j;L>0;_=256*_+c[i+B],B+=q,L-=8);for(w=_&(1<<-L)-1,_>>=-L,L+=h;L>0;w=256*w+c[i+B],B+=q,L-=8);if(_===0)_=1-O;else{if(_===N)return w?NaN:1/0*(Y?-1:1);w+=Math.pow(2,h),_-=O}return(Y?-1:1)*w*Math.pow(2,_-h)},dA.write=function(c,i,o,h,g,_){var w,j,N,O=8*_-g-1,L=(1<<O)-1,B=L>>1,q=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,Y=h?0:_-1,Q=h?1:-1,re=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(j=isNaN(i)?1:0,w=L):(w=Math.floor(Math.log(i)/Math.LN2),i*(N=Math.pow(2,-w))<1&&(w--,N*=2),(i+=w+B>=1?q/N:q*Math.pow(2,1-B))*N>=2&&(w++,N/=2),w+B>=L?(j=0,w=L):w+B>=1?(j=(i*N-1)*Math.pow(2,g),w+=B):(j=i*Math.pow(2,B-1)*Math.pow(2,g),w=0));g>=8;c[o+Y]=255&j,Y+=Q,j/=256,g-=8);for(w=w<<g|j,O+=g;O>0;c[o+Y]=255&w,Y+=Q,w/=256,O-=8);c[o+Y-Q]|=128*re}),dA}function oI(){if(sI)return uA;sI=1,uA=i;var c=rQ();function i(oe){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(oe)?oe:new Uint8Array(oe||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var o=4294967296,h=1/o,g=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function _(oe){return oe.type===i.Bytes?oe.readVarint()+oe.pos:oe.pos+1}function w(oe,xe,we){return we?4294967296*xe+(oe>>>0):4294967296*(xe>>>0)+(oe>>>0)}function j(oe,xe,we){var je=xe<=16383?1:xe<=2097151?2:xe<=268435455?3:Math.floor(Math.log(xe)/(7*Math.LN2));we.realloc(je);for(var Ve=we.pos-1;Ve>=oe;Ve--)we.buf[Ve+je]=we.buf[Ve]}function N(oe,xe){for(var we=0;we<oe.length;we++)xe.writeVarint(oe[we])}function O(oe,xe){for(var we=0;we<oe.length;we++)xe.writeSVarint(oe[we])}function L(oe,xe){for(var we=0;we<oe.length;we++)xe.writeFloat(oe[we])}function B(oe,xe){for(var we=0;we<oe.length;we++)xe.writeDouble(oe[we])}function q(oe,xe){for(var we=0;we<oe.length;we++)xe.writeBoolean(oe[we])}function Y(oe,xe){for(var we=0;we<oe.length;we++)xe.writeFixed32(oe[we])}function Q(oe,xe){for(var we=0;we<oe.length;we++)xe.writeSFixed32(oe[we])}function re(oe,xe){for(var we=0;we<oe.length;we++)xe.writeFixed64(oe[we])}function he(oe,xe){for(var we=0;we<oe.length;we++)xe.writeSFixed64(oe[we])}function pe(oe,xe){return(oe[xe]|oe[xe+1]<<8|oe[xe+2]<<16)+16777216*oe[xe+3]}function Se(oe,xe,we){oe[we]=xe,oe[we+1]=xe>>>8,oe[we+2]=xe>>>16,oe[we+3]=xe>>>24}function be(oe,xe){return(oe[xe]|oe[xe+1]<<8|oe[xe+2]<<16)+(oe[xe+3]<<24)}return i.prototype={destroy:function(){this.buf=null},readFields:function(oe,xe,we){for(we=we||this.length;this.pos<we;){var je=this.readVarint(),Ve=je>>3,We=this.pos;this.type=7&je,oe(Ve,xe,this),this.pos===We&&this.skip(je)}return xe},readMessage:function(oe,xe){return this.readFields(oe,xe,this.readVarint()+this.pos)},readFixed32:function(){var oe=pe(this.buf,this.pos);return this.pos+=4,oe},readSFixed32:function(){var oe=be(this.buf,this.pos);return this.pos+=4,oe},readFixed64:function(){var oe=pe(this.buf,this.pos)+pe(this.buf,this.pos+4)*o;return this.pos+=8,oe},readSFixed64:function(){var oe=pe(this.buf,this.pos)+be(this.buf,this.pos+4)*o;return this.pos+=8,oe},readFloat:function(){var oe=c.read(this.buf,this.pos,!0,23,4);return this.pos+=4,oe},readDouble:function(){var oe=c.read(this.buf,this.pos,!0,52,8);return this.pos+=8,oe},readVarint:function(oe){var xe,we,je=this.buf;return xe=127&(we=je[this.pos++]),we<128?xe:(xe|=(127&(we=je[this.pos++]))<<7,we<128?xe:(xe|=(127&(we=je[this.pos++]))<<14,we<128?xe:(xe|=(127&(we=je[this.pos++]))<<21,we<128?xe:function(Ve,We,Ze){var Qe,pt,kt=Ze.buf;if(Qe=(112&(pt=kt[Ze.pos++]))>>4,pt<128||(Qe|=(127&(pt=kt[Ze.pos++]))<<3,pt<128)||(Qe|=(127&(pt=kt[Ze.pos++]))<<10,pt<128)||(Qe|=(127&(pt=kt[Ze.pos++]))<<17,pt<128)||(Qe|=(127&(pt=kt[Ze.pos++]))<<24,pt<128)||(Qe|=(1&(pt=kt[Ze.pos++]))<<31,pt<128))return w(Ve,Qe,We);throw new Error("Expected varint not more than 10 bytes")}(xe|=(15&(we=je[this.pos]))<<28,oe,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var oe=this.readVarint();return oe%2==1?(oe+1)/-2:oe/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var oe=this.readVarint()+this.pos,xe=this.pos;return this.pos=oe,oe-xe>=12&&g?function(we,je,Ve){return g.decode(we.subarray(je,Ve))}(this.buf,xe,oe):function(we,je,Ve){for(var We="",Ze=je;Ze<Ve;){var Qe,pt,kt,Ct=we[Ze],Pt=null,Vt=Ct>239?4:Ct>223?3:Ct>191?2:1;if(Ze+Vt>Ve)break;Vt===1?Ct<128&&(Pt=Ct):Vt===2?(192&(Qe=we[Ze+1]))==128&&(Pt=(31&Ct)<<6|63&Qe)<=127&&(Pt=null):Vt===3?(pt=we[Ze+2],(192&(Qe=we[Ze+1]))==128&&(192&pt)==128&&((Pt=(15&Ct)<<12|(63&Qe)<<6|63&pt)<=2047||Pt>=55296&&Pt<=57343)&&(Pt=null)):Vt===4&&(pt=we[Ze+2],kt=we[Ze+3],(192&(Qe=we[Ze+1]))==128&&(192&pt)==128&&(192&kt)==128&&((Pt=(15&Ct)<<18|(63&Qe)<<12|(63&pt)<<6|63&kt)<=65535||Pt>=1114112)&&(Pt=null)),Pt===null?(Pt=65533,Vt=1):Pt>65535&&(Pt-=65536,We+=String.fromCharCode(Pt>>>10&1023|55296),Pt=56320|1023&Pt),We+=String.fromCharCode(Pt),Ze+=Vt}return We}(this.buf,xe,oe)},readBytes:function(){var oe=this.readVarint()+this.pos,xe=this.buf.subarray(this.pos,oe);return this.pos=oe,xe},readPackedVarint:function(oe,xe){if(this.type!==i.Bytes)return oe.push(this.readVarint(xe));var we=_(this);for(oe=oe||[];this.pos<we;)oe.push(this.readVarint(xe));return oe},readPackedSVarint:function(oe){if(this.type!==i.Bytes)return oe.push(this.readSVarint());var xe=_(this);for(oe=oe||[];this.pos<xe;)oe.push(this.readSVarint());return oe},readPackedBoolean:function(oe){if(this.type!==i.Bytes)return oe.push(this.readBoolean());var xe=_(this);for(oe=oe||[];this.pos<xe;)oe.push(this.readBoolean());return oe},readPackedFloat:function(oe){if(this.type!==i.Bytes)return oe.push(this.readFloat());var xe=_(this);for(oe=oe||[];this.pos<xe;)oe.push(this.readFloat());return oe},readPackedDouble:function(oe){if(this.type!==i.Bytes)return oe.push(this.readDouble());var xe=_(this);for(oe=oe||[];this.pos<xe;)oe.push(this.readDouble());return oe},readPackedFixed32:function(oe){if(this.type!==i.Bytes)return oe.push(this.readFixed32());var xe=_(this);for(oe=oe||[];this.pos<xe;)oe.push(this.readFixed32());return oe},readPackedSFixed32:function(oe){if(this.type!==i.Bytes)return oe.push(this.readSFixed32());var xe=_(this);for(oe=oe||[];this.pos<xe;)oe.push(this.readSFixed32());return oe},readPackedFixed64:function(oe){if(this.type!==i.Bytes)return oe.push(this.readFixed64());var xe=_(this);for(oe=oe||[];this.pos<xe;)oe.push(this.readFixed64());return oe},readPackedSFixed64:function(oe){if(this.type!==i.Bytes)return oe.push(this.readSFixed64());var xe=_(this);for(oe=oe||[];this.pos<xe;)oe.push(this.readSFixed64());return oe},skip:function(oe){var xe=7&oe;if(xe===i.Varint)for(;this.buf[this.pos++]>127;);else if(xe===i.Bytes)this.pos=this.readVarint()+this.pos;else if(xe===i.Fixed32)this.pos+=4;else{if(xe!==i.Fixed64)throw new Error("Unimplemented type: "+xe);this.pos+=8}},writeTag:function(oe,xe){this.writeVarint(oe<<3|xe)},realloc:function(oe){for(var xe=this.length||16;xe<this.pos+oe;)xe*=2;if(xe!==this.length){var we=new Uint8Array(xe);we.set(this.buf),this.buf=we,this.length=xe}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(oe){this.realloc(4),Se(this.buf,oe,this.pos),this.pos+=4},writeSFixed32:function(oe){this.realloc(4),Se(this.buf,oe,this.pos),this.pos+=4},writeFixed64:function(oe){this.realloc(8),Se(this.buf,-1&oe,this.pos),Se(this.buf,Math.floor(oe*h),this.pos+4),this.pos+=8},writeSFixed64:function(oe){this.realloc(8),Se(this.buf,-1&oe,this.pos),Se(this.buf,Math.floor(oe*h),this.pos+4),this.pos+=8},writeVarint:function(oe){(oe=+oe||0)>268435455||oe<0?function(xe,we){var je,Ve;if(xe>=0?(je=xe%4294967296|0,Ve=xe/4294967296|0):(Ve=~(-xe/4294967296),4294967295^(je=~(-xe%4294967296))?je=je+1|0:(je=0,Ve=Ve+1|0)),xe>=18446744073709552e3||xe<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");we.realloc(10),function(We,Ze,Qe){Qe.buf[Qe.pos++]=127&We|128,We>>>=7,Qe.buf[Qe.pos++]=127&We|128,We>>>=7,Qe.buf[Qe.pos++]=127&We|128,We>>>=7,Qe.buf[Qe.pos++]=127&We|128,Qe.buf[Qe.pos]=127&(We>>>=7)}(je,0,we),function(We,Ze){var Qe=(7&We)<<4;Ze.buf[Ze.pos++]|=Qe|((We>>>=3)?128:0),We&&(Ze.buf[Ze.pos++]=127&We|((We>>>=7)?128:0),We&&(Ze.buf[Ze.pos++]=127&We|((We>>>=7)?128:0),We&&(Ze.buf[Ze.pos++]=127&We|((We>>>=7)?128:0),We&&(Ze.buf[Ze.pos++]=127&We|((We>>>=7)?128:0),We&&(Ze.buf[Ze.pos++]=127&We)))))}(Ve,we)}(oe,this):(this.realloc(4),this.buf[this.pos++]=127&oe|(oe>127?128:0),oe<=127||(this.buf[this.pos++]=127&(oe>>>=7)|(oe>127?128:0),oe<=127||(this.buf[this.pos++]=127&(oe>>>=7)|(oe>127?128:0),oe<=127||(this.buf[this.pos++]=oe>>>7&127))))},writeSVarint:function(oe){this.writeVarint(oe<0?2*-oe-1:2*oe)},writeBoolean:function(oe){this.writeVarint(!!oe)},writeString:function(oe){oe=String(oe),this.realloc(4*oe.length),this.pos++;var xe=this.pos;this.pos=function(je,Ve,We){for(var Ze,Qe,pt=0;pt<Ve.length;pt++){if((Ze=Ve.charCodeAt(pt))>55295&&Ze<57344){if(!Qe){Ze>56319||pt+1===Ve.length?(je[We++]=239,je[We++]=191,je[We++]=189):Qe=Ze;continue}if(Ze<56320){je[We++]=239,je[We++]=191,je[We++]=189,Qe=Ze;continue}Ze=Qe-55296<<10|Ze-56320|65536,Qe=null}else Qe&&(je[We++]=239,je[We++]=191,je[We++]=189,Qe=null);Ze<128?je[We++]=Ze:(Ze<2048?je[We++]=Ze>>6|192:(Ze<65536?je[We++]=Ze>>12|224:(je[We++]=Ze>>18|240,je[We++]=Ze>>12&63|128),je[We++]=Ze>>6&63|128),je[We++]=63&Ze|128)}return We}(this.buf,oe,this.pos);var we=this.pos-xe;we>=128&&j(xe,we,this),this.pos=xe-1,this.writeVarint(we),this.pos+=we},writeFloat:function(oe){this.realloc(4),c.write(this.buf,oe,this.pos,!0,23,4),this.pos+=4},writeDouble:function(oe){this.realloc(8),c.write(this.buf,oe,this.pos,!0,52,8),this.pos+=8},writeBytes:function(oe){var xe=oe.length;this.writeVarint(xe),this.realloc(xe);for(var we=0;we<xe;we++)this.buf[this.pos++]=oe[we]},writeRawMessage:function(oe,xe){this.pos++;var we=this.pos;oe(xe,this);var je=this.pos-we;je>=128&&j(we,je,this),this.pos=we-1,this.writeVarint(je),this.pos+=je},writeMessage:function(oe,xe,we){this.writeTag(oe,i.Bytes),this.writeRawMessage(xe,we)},writePackedVarint:function(oe,xe){xe.length&&this.writeMessage(oe,N,xe)},writePackedSVarint:function(oe,xe){xe.length&&this.writeMessage(oe,O,xe)},writePackedBoolean:function(oe,xe){xe.length&&this.writeMessage(oe,q,xe)},writePackedFloat:function(oe,xe){xe.length&&this.writeMessage(oe,L,xe)},writePackedDouble:function(oe,xe){xe.length&&this.writeMessage(oe,B,xe)},writePackedFixed32:function(oe,xe){xe.length&&this.writeMessage(oe,Y,xe)},writePackedSFixed32:function(oe,xe){xe.length&&this.writeMessage(oe,Q,xe)},writePackedFixed64:function(oe,xe){xe.length&&this.writeMessage(oe,re,xe)},writePackedSFixed64:function(oe,xe){xe.length&&this.writeMessage(oe,he,xe)},writeBytesField:function(oe,xe){this.writeTag(oe,i.Bytes),this.writeBytes(xe)},writeFixed32Field:function(oe,xe){this.writeTag(oe,i.Fixed32),this.writeFixed32(xe)},writeSFixed32Field:function(oe,xe){this.writeTag(oe,i.Fixed32),this.writeSFixed32(xe)},writeFixed64Field:function(oe,xe){this.writeTag(oe,i.Fixed64),this.writeFixed64(xe)},writeSFixed64Field:function(oe,xe){this.writeTag(oe,i.Fixed64),this.writeSFixed64(xe)},writeVarintField:function(oe,xe){this.writeTag(oe,i.Varint),this.writeVarint(xe)},writeSVarintField:function(oe,xe){this.writeTag(oe,i.Varint),this.writeSVarint(xe)},writeStringField:function(oe,xe){this.writeTag(oe,i.Bytes),this.writeString(xe)},writeFloatField:function(oe,xe){this.writeTag(oe,i.Fixed32),this.writeFloat(xe)},writeDoubleField:function(oe,xe){this.writeTag(oe,i.Fixed64),this.writeDouble(xe)},writeBooleanField:function(oe,xe){this.writeVarintField(oe,!!xe)}},uA}var I2=Is(oI());const hA=3;function iQ(c,i,o){i.glyphs=[],c===1&&o.readMessage(aQ,i)}function aQ(c,i,o){if(c===3){const{id:h,bitmap:g,width:_,height:w,left:j,top:N,advance:O}=o.readMessage(sQ,{});i.glyphs.push({id:h,bitmap:new Oh({width:_+2*hA,height:w+2*hA},g),metrics:{width:_,height:w,left:j,top:N,advance:O}})}else c===4?i.ascender=o.readSVarint():c===5&&(i.descender=o.readSVarint())}function sQ(c,i,o){c===1?i.id=o.readVarint():c===2?i.bitmap=o.readBytes():c===3?i.width=o.readVarint():c===4?i.height=o.readVarint():c===5?i.left=o.readSVarint():c===6?i.top=o.readSVarint():c===7&&(i.advance=o.readVarint())}const oQ=hA,yc={horizontal:1,vertical:2,horizontalOnly:3};class T1{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(i,o){const h=new T1;return h.scale=i||1,h.fontStack=o,h}static forImage(i){const o=new T1;return o.image=i,o}}class Ev{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,o,h){const g=new Ev;for(let _=0;_<i.sections.length;_++){const w=i.sections[_];w.image?g.addImageSection(w,h):g.addTextSection(w,o)}return g}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSections(){return this.sections}getSectionIndex(i){return this.sectionIndex[i]}getCodePoint(i){return this.text.codePointAt(i)}verticalizePunctuation(i){this.text=function(o,h){let g="";for(let _=0;_<o.length;_++){const w=o.charCodeAt(_+1)||null,j=o.charCodeAt(_-1)||null;g+=!h&&(w&&cg(w)&&!S1[o[_+1]]||j&&cg(j)&&!S1[o[_-1]])||!S1[o[_]]?o[_]:S1[o[_]]}return g}(this.text,i)}trim(){let i=0;for(let h=0;h<this.text.length&&k2[this.text.charCodeAt(h)];h++)i++;let o=this.text.length;for(let h=this.text.length-1;h>=0&&h>=i&&k2[this.text.charCodeAt(h)];h--)o--;this.text=this.text.substring(i,o),this.sectionIndex=this.sectionIndex.slice(i,o)}substring(i,o){const h=new Ev;return h.text=this.text.substring(i,o),h.sectionIndex=this.sectionIndex.slice(i,o),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,o)=>Math.max(i,this.sections[o].scale),0)}addTextSection(i,o){this.text+=i.text,this.sections.push(T1.forText(i.scale,i.fontStack||o));const h=this.sections.length-1;for(let g=0;g<i.text.length;++g)this.sectionIndex.push(h)}addImageSection(i,o){const h=i.image?i.image.getPrimary():null;if(!h)return void or("Can't add FormattedSection with an empty image.");h.scaleSelf(o);const g=this.getNextImageSectionCharCode();g?(this.text+=String.fromCodePoint(g),this.sections.push(T1.forImage(h)),this.sectionIndex.push(this.sections.length-1)):or("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function fA(c,i,o,h,g,_,w,j,N,O,L,B,q,Y,Q,re=1){const he=Ev.fromFeature(c,g,re);B===yc.vertical&&he.verticalizePunctuation(q);let pe=[];const Se=function(je,Ve,We,Ze,Qe,pt){if(!je)return[];const kt=[],Ct=function(Mt,dt,ft,$t,Gt,Dn){let bn=0;for(let an=0;an<Mt.length();an++){const Ut=Mt.getSection(an);bn+=lI(Mt.getCodePoint(an),Ut,$t,Gt,dt,Dn)}return bn/Math.max(1,Math.ceil(bn/ft))}(je,Ve,We,Ze,Qe,pt),Pt=je.text.indexOf("​")>=0;let Vt=0;for(let Mt=0;Mt<je.length();Mt++){const dt=je.getSection(Mt),ft=je.getCodePoint(Mt);if(k2[ft]||(Vt+=lI(ft,dt,Ze,Qe,Ve,pt)),Mt<je.length()-1){const $t=!((ht=ft)<11904||!(Un["Bopomofo Extended"](ht)||Un.Bopomofo(ht)||Un["CJK Compatibility Forms"](ht)||Un["CJK Compatibility Ideographs"](ht)||Un["CJK Compatibility"](ht)||Un["CJK Radicals Supplement"](ht)||Un["CJK Strokes"](ht)||Un["CJK Symbols and Punctuation"](ht)||Un["CJK Unified Ideographs Extension A"](ht)||Un["CJK Unified Ideographs"](ht)||Un["Enclosed CJK Letters and Months"](ht)||Un["Halfwidth and Fullwidth Forms"](ht)||Un.Hiragana(ht)||Un["Ideographic Description Characters"](ht)||Un["Kangxi Radicals"](ht)||Un["Katakana Phonetic Extensions"](ht)||Un.Katakana(ht)||Un["Vertical Forms"](ht)||Un["Yi Radicals"](ht)||Un["Yi Syllables"](ht)));(lQ[ft]||$t||dt.image)&&kt.push(uI(Mt+1,Vt,Ct,kt,cQ(ft,je.getCodePoint(Mt+1),$t&&Pt),!1))}}var ht;return dI(uI(je.length(),Vt,Ct,kt,0,!0))}(he,O,_,i,h,Y),{processBidirectionalText:be,processStyledBidirectionalText:oe}=Pl;if(be&&he.sections.length===1){const je=be(he.toString(),Se);for(const Ve of je){const We=new Ev;We.text=Ve,We.sections=he.sections;for(let Ze=0;Ze<Ve.length;Ze++)We.sectionIndex.push(0);pe.push(We)}}else if(oe){const je=oe(he.text,he.sectionIndex,Se);for(const Ve of je){const We=new Ev;We.text=Ve[0],We.sectionIndex=Ve[1],We.sections=he.sections,pe.push(We)}}else pe=function(je,Ve){const We=[],Ze=je.text;let Qe=0;for(const pt of Ve)We.push(je.substring(Qe,pt)),Qe=pt;return Qe<Ze.length&&We.push(je.substring(Qe,Ze.length)),We}(he,Se);const xe=[],we={positionedLines:xe,text:he.toString(),top:L[1],bottom:L[1],left:L[0],right:L[0],writingMode:B,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if(function(je,Ve,We,Ze,Qe,pt,kt,Ct,Pt,Vt,ht,Mt){let dt=0,ft=0,$t=0;const Gt=Ct==="right"?1:Ct==="left"?0:.5;let Dn=!1;for(const Cn of Qe){const nr=Cn.getSections();for(const dr of nr){if(dr.image)continue;const fr=Ve[dr.fontStack];if(fr&&(Dn=fr.ascender!==void 0&&fr.descender!==void 0,!Dn))break}if(!Dn)break}let bn=0;for(const Cn of Qe){Cn.trim();const nr=Cn.getMaxScale(),dr=(nr-1)*As,fr={positionedGlyphs:[],lineOffset:0};je.positionedLines[bn]=fr;const wr=fr.positionedGlyphs;let yr=0;if(!Cn.length()){ft+=pt,++bn;continue}let mr=0,Ei=0;for(let Ae=0;Ae<Cn.length();Ae++){const Ne=Cn.getSection(Ae),yt=Cn.getSectionIndex(Ae),Qt=Cn.getCodePoint(Ae);let cn=Ne.scale,on=null,Nn=null,Xn=null,Pr=As,Nr=0;Pt===yc.vertical&&((an=Qt)===12312||an===12313||an===12316||an===12540||an===12448)&&(Pt=yc.horizontal);const gr=!(Pt===yc.horizontal||!ht&&!Ra(Qt)||ht&&(k2[Qt]||Up(Qt)));if(Ne.image){const gi=Ze.get(Ne.image.toString());if(!gi)continue;Xn=Ne.image,je.iconsInText=je.iconsInText||!0,Nn=gi.paddedRect;const Ii=gi.displaySize;cn=cn*As/Mt,on={width:Ii[0],height:Ii[1],left:0,top:-3,advance:gr?Ii[1]:Ii[0],localGlyph:!1},Nr=Dn?-on.height*cn:nr*As-17-Ii[1]*cn,Pr=on.advance;const Dr=(gr?Ii[0]:Ii[1])*cn-As*nr;Dr>0&&Dr>yr&&(yr=Dr)}else{const gi=We[Ne.fontStack];if(!gi)continue;gi[Qt]&&(Nn=gi[Qt]);const Ii=Ve[Ne.fontStack];if(!Ii)continue;const Dr=Ii.glyphs[Qt];if(!Dr)continue;if(on=Dr.metrics,Pr=Qt!==8203?As:0,Dn){const ra=Ii.ascender!==void 0?Math.abs(Ii.ascender):0,Li=Ii.descender!==void 0?Math.abs(Ii.descender):0,fi=(ra+Li)*cn;mr<fi&&(mr=fi,Ei=(ra-Li)/2*cn),Nr=-ra*cn}else Nr=(nr-cn)*As-17}gr?(je.verticalizable=!0,wr.push({glyph:Qt,image:Xn,x:dt,y:ft+Nr,vertical:gr,scale:cn,localGlyph:on.localGlyph,fontStack:Ne.fontStack,sectionIndex:yt,metrics:on,rect:Nn}),dt+=Pr*cn+Vt):(wr.push({glyph:Qt,image:Xn,x:dt,y:ft+Nr,vertical:gr,scale:cn,localGlyph:on.localGlyph,fontStack:Ne.fontStack,sectionIndex:yt,metrics:on,rect:Nn}),dt+=on.advance*cn+Vt)}wr.length!==0&&($t=Math.max(dt-Vt,$t),Dn?hI(wr,Gt,yr,Ei,pt*nr/2):hI(wr,Gt,yr,0,pt/2)),dt=0;const zi=pt*nr+yr;fr.lineOffset=Math.max(yr,dr),ft+=zi,++bn}var an;const Ut=ft,{horizontalAlign:sr,verticalAlign:An}=pA(kt);(function(Cn,nr,dr,fr,wr,yr){const mr=(nr-dr)*wr,Ei=-yr*fr;for(const zi of Cn)for(const Ae of zi.positionedGlyphs)Ae.x+=mr,Ae.y+=Ei})(je.positionedLines,Gt,sr,An,$t,Ut),je.top+=-An*Ut,je.bottom=je.top+Ut,je.left+=-sr*$t,je.right=je.left+$t,je.hasBaseline=Dn}(we,i,o,h,pe,w,j,N,B,O,q,Q),!function(je){for(const Ve of je)if(Ve.positionedGlyphs.length!==0)return!1;return!0}(xe))return we}const k2={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},lQ={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function lI(c,i,o,h,g,_){if(i.image){const w=h.get(i.image.toString());return w?w.displaySize[0]*i.scale*As/_+g:0}{const w=o[i.fontStack],j=w&&w.glyphs[c];return j?j.metrics.advance*i.scale+g:0}}function cI(c,i,o,h){const g=Math.pow(c-i,2);return h?c<i?g/2:2*g:g+Math.abs(o)*o}function cQ(c,i,o){let h=0;return c===10&&(h-=1e4),o&&(h+=150),c!==40&&c!==65288||(h+=50),i!==41&&i!==65289||(h+=50),h}function uI(c,i,o,h,g,_){let w=null,j=cI(i,o,g,_);for(const N of h){const O=cI(i-N.x,o,g,_)+N.badness;O<=j&&(w=N,j=O)}return{index:c,x:i,priorBreak:w,badness:j}}function dI(c){return c?dI(c.priorBreak).concat(c.index):[]}function pA(c){let i=.5,o=.5;switch(c){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:i,verticalAlign:o}}function hI(c,i,o,h,g){if(!(i||o||h||g))return;const _=c.length-1,w=c[_],j=(w.x+w.metrics.advance*w.scale)*i;for(let N=0;N<=_;N++)c[N].x-=j,c[N].y+=o+h+g}function fI(c){return c.imagePrimary!==void 0&&c.top!==void 0&&c.bottom!==void 0&&c.left!==void 0&&c.right!==void 0}function uQ(c,i,o,h){const{horizontalAlign:g,verticalAlign:_}=pA(h),w=o[0]-c.displaySize[0]*g,j=o[1]-c.displaySize[1]*_;return{imagePrimary:c,imageSecondary:i,top:j,bottom:j+c.displaySize[1],left:w,right:w+c.displaySize[0]}}function pI(c,i,o,h,g,_){const w=c.imagePrimary;let j;if(w.content){const he=w.content,pe=w.pixelRatio||1;j=[he[0]/pe,he[1]/pe,w.displaySize[0]-he[2]/pe,w.displaySize[1]-he[3]/pe]}const N=i.left*_,O=i.right*_;let L,B,q,Y;o==="width"||o==="both"?(Y=g[0]+N-h[3],B=g[0]+O+h[1]):(Y=g[0]+(N+O-w.displaySize[0])/2,B=Y+w.displaySize[0]);const Q=i.top*_,re=i.bottom*_;return o==="height"||o==="both"?(L=g[1]+Q-h[0],q=g[1]+re+h[2]):(L=g[1]+(Q+re-w.displaySize[1])/2,q=L+w.displaySize[1]),{imagePrimary:w,imageSecondary:void 0,top:L,right:B,bottom:q,left:Y,collisionPadding:j}}function mI(c){return!c.imagePrimary.stretchX}function gI(c){return!c.imagePrimary.stretchY}function xI(c){return{width:c.right-c.left,height:c.bottom-c.top}}const $f=128;function yI(c,i){const{expression:o}=i;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new ui(c+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:g}=o;let _=0;for(;_<h.length&&h[_]<=c;)_++;_=Math.max(0,_-1);let w=_;for(;w<h.length&&h[w]<c+1;)w++;w=Math.min(h.length-1,w);const j=h[_],N=h[w];return o.kind==="composite"?{kind:"composite",minZoom:j,maxZoom:N,interpolationType:g}:{kind:"camera",minZoom:j,maxZoom:N,minSize:o.evaluate(new ui(j)),maxSize:o.evaluate(new ui(N)),interpolationType:g}}}function mA(c,{uSize:i,uSizeT:o},{lowerSize:h,upperSize:g}){return c.kind==="source"?h/$f:c.kind==="composite"?Vn(h/$f,g/$f,o):i}function E1(c,i,o=1){let h=0,g=0;if(c.kind==="constant")g=c.layoutSize*o;else if(c.kind!=="source"){const{interpolationType:_,minZoom:w,maxZoom:j}=c,N=_?Le(_o.interpolationFactor(_,i,w,j),0,1):0;c.kind==="camera"?g=Vn(c.minSize,c.maxSize,N)*o:h=N*o}return{uSizeT:h,uSize:g}}class xm extends Kt{constructor(i,o,h,g,_){super(i,o),this.angle=g,this.z=h,_!==void 0&&(this.segment=_)}clone(){return new xm(this.x,this.y,this.z,this.angle,this.segment)}}function vI(c,i,o,h,g){if(i.segment===void 0)return!0;let _=i,w=i.segment+1,j=0;for(;j>-o/2;){if(w--,w<0)return!1;j-=c[w].dist(_),_=c[w]}j+=c[w].dist(c[w+1]),w++;const N=[];let O=0;for(;j<o/2;){const L=c[w],B=c[w+1];if(!B)return!1;let q=c[w-1].angleTo(L)-L.angleTo(B);for(q=Math.abs((q+3*Math.PI)%(2*Math.PI)-Math.PI),N.push({distance:j,angleDelta:q}),O+=q;j-N[0].distance>h;)O-=N.shift().angleDelta;if(O>g)return!1;w++,j+=L.dist(B)}return!0}function _I(c){let i=0;for(let o=0;o<c.length-1;o++)i+=c[o].dist(c[o+1]);return i}function bI(c,i,o){return c?.6*i*o:0}function wI(c,i){return Math.max(c?c.right-c.left:0,i?i.right-i.left:0)}function dQ(c,i,o,h,g,_){const w=bI(o,g,_),j=wI(o,h)*_;let N=0;const O=_I(c)/2;for(let L=0;L<c.length-1;L++){const B=c[L],q=c[L+1],Y=B.dist(q);if(N+Y>O){const Q=(O-N)/Y,re=Vn(B.x,q.x,Q),he=Vn(B.y,q.y,Q),pe=new xm(re,he,0,q.angleTo(B),L);return!w||vI(c,pe,j,w,i)?pe:void 0}N+=Y}}function hQ(c,i,o,h,g,_,w,j,N){const O=bI(h,_,w),L=wI(h,g),B=L*w,q=c[0].x===0||c[0].x===N||c[0].y===0||c[0].y===N;return i-B<i/4&&(i=B+i/4),SI(c,q?i/2*j%i:(L/2+2*_)*w*j%i,i,O,o,B,q,!1,N)}function SI(c,i,o,h,g,_,w,j,N){const O=_/2,L=_I(c);let B=0,q=i-o,Y=[];for(let Q=0;Q<c.length-1;Q++){const re=c[Q],he=c[Q+1],pe=re.dist(he),Se=he.angleTo(re);for(;q+o<B+pe;){q+=o;const be=(q-B)/pe,oe=Vn(re.x,he.x,be),xe=Vn(re.y,he.y,be);if(oe>=0&&oe<N&&xe>=0&&xe<N&&q-O>=0&&q+O<=L){const we=new xm(oe,xe,0,Se,Q);h&&!vI(c,we,_,h,g)||Y.push(we)}}B+=pe}return j||Y.length||w||(Y=SI(c,B/2,o,h,g,_,w,!0,N)),Y}function TI(c){let i=0,o=0;for(const w of c)i+=w.w*w.h,o=Math.max(o,w.w);c.sort((w,j)=>j.h-w.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),o),h:1/0}];let g=0,_=0;for(const w of c)for(let j=h.length-1;j>=0;j--){const N=h[j];if(!(w.w>N.w||w.h>N.h)){if(w.x=N.x,w.y=N.y,_=Math.max(_,w.y+w.h),g=Math.max(g,w.x+w.w),w.w===N.w&&w.h===N.h){const O=h.pop();j<h.length&&(h[j]=O)}else w.h===N.h?(N.x+=w.w,N.w-=w.w):w.w===N.w?(N.y+=w.h,N.h-=w.h):(h.push({x:N.x+w.w,y:N.y,w:N.w-w.w,h:w.h}),N.y+=w.h,N.h-=w.h);break}}return{w:g,h:_,fill:i/(g*_)||0}}mn(xm,"Anchor");const C0=1;class A1{static getImagePositionScale(i,o,h){if(o&&i&&i.options&&i.options.transform){const g=i.options.transform;return{x:g.a,y:g.d}}return{x:h,y:h}}constructor(i,o,h,g){this.paddedRect=i;const{pixelRatio:_,version:w,stretchX:j,stretchY:N,content:O,sdf:L,usvg:B}=o;this.pixelRatio=_,this.stretchX=j,this.stretchY=N,this.content=O,this.version=w,this.padding=h,this.sdf=L,this.scale=A1.getImagePositionScale(g,B,_)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function gA(c,i,o){const h=El.parse(c),g=function(_,w,j=[1,1]){return{x:0,y:0,w:(_.data?_.data.width:_.width*j[0])+2*w,h:(_.data?_.data.height:_.height*j[1])+2*w}}(i,o,[h.options.transform.a,h.options.transform.d]);return{bin:g,imagePosition:new A1(g,i,o,h),imageVariant:h}}class EI{constructor(i,o,h){const g=new Map,_=new Map;this.haveRenderCallbacks=[];const w=[];this.addImages(i,g,C0,w),this.addImages(o,_,2,w);const{w:j,h:N}=TI(w),O=new hs({width:j||1,height:N||1});for(const[L,B]of i.entries()){const q=g.get(L).paddedRect;hs.copy(B.data,O,{x:0,y:0},{x:q.x+C0,y:q.y+C0},B.data,h,B.sdf)}for(const[L,B]of o.entries()){const q=_.get(L),Y=q.paddedRect;let Q=q.padding;const re=Y.x+Q,he=Y.y+Q,pe=B.data.width,Se=B.data.height;Q=Q>1?Q-1:Q,hs.copy(B.data,O,{x:0,y:0},{x:re,y:he},B.data,h),hs.copy(B.data,O,{x:0,y:Se-Q},{x:re,y:he-Q},{width:pe,height:Q},h),hs.copy(B.data,O,{x:0,y:0},{x:re,y:he+Se},{width:pe,height:Q},h),hs.copy(B.data,O,{x:pe-Q,y:0},{x:re-Q,y:he},{width:Q,height:Se},h),hs.copy(B.data,O,{x:0,y:0},{x:re+pe,y:he},{width:Q,height:Se},h),hs.copy(B.data,O,{x:pe-Q,y:Se-Q},{x:re-Q,y:he-Q},{width:Q,height:Q},h),hs.copy(B.data,O,{x:0,y:Se-Q},{x:re+pe,y:he-Q},{width:Q,height:Q},h),hs.copy(B.data,O,{x:0,y:0},{x:re+pe,y:he+Se},{width:Q,height:Q},h),hs.copy(B.data,O,{x:pe-Q,y:0},{x:re-Q,y:he+Se},{width:Q,height:Q},h)}this.lut=h,this.image=O,this.iconPositions=g,this.patternPositions=_}addImages(i,o,h,g){for(const[_,w]of i.entries()){const{bin:j,imagePosition:N,imageVariant:O}=gA(_,w,h);o.set(_,N),g.push(j),w.hasRenderCallback&&this.haveRenderCallbacks.push(O.id)}}patchUpdatedImages(i,o,h){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(g=>i.hasImage(g,h)),i.dispatchRenderCallbacks(this.haveRenderCallbacks,h);for(const g of i.getUpdatedImages(h)){for(const _ of this.iconPositions.keys()){const w=El.parse(_);if(Ro.isEqual(w.id,g)){const j=i.getImage(g,h);this.patchUpdatedImage(this.iconPositions.get(_),j,o)}}for(const _ of this.patternPositions.keys()){const w=El.parse(_);if(Ro.isEqual(w.id,g)){const j=i.getImage(g,h);this.patchUpdatedImage(this.patternPositions.get(_),j,o)}}}}patchUpdatedImage(i,o,h){if(!i||!o||i.version===o.version)return;i.version=o.version;const[g,_]=i.tl,w=i.sdf;if(this.lut||w){const j={width:o.data.width,height:o.data.height},N=new hs(j);hs.copy(o.data,N,{x:0,y:0},{x:0,y:0},j,this.lut,w),h.update(N,{position:{x:g,y:_}})}else h.update(o.data,{position:{x:g,y:_}})}}mn(A1,"ImagePosition"),mn(EI,"ImageAtlas");const R2=1e20;function AI(c,i,o,h,g,_,w,j,N){for(let O=i;O<i+h;O++)CI(c,o*_+O,_,g,w,j,N);for(let O=o;O<o+g;O++)CI(c,O*_+i,1,h,w,j,N)}function CI(c,i,o,h,g,_,w){_[0]=0,w[0]=-1e20,w[1]=R2,g[0]=c[i];for(let j=1,N=0,O=0;j<h;j++){g[j]=c[i+j*o];const L=j*j;do{const B=_[N];O=(g[j]-g[B]+L-B*B)/(j-B)/2}while(O<=w[N]&&--N>-1);N++,_[N]=j,w[N]=O,w[N+1]=R2}for(let j=0,N=0;j<h;j++){for(;w[N+1]<j;)N++;const O=_[N],L=j-O;c[i+j*o]=g[O]+L*L}}const Vh=2,xA={none:0,ideographs:1,all:2};class Av{constructor(i,o,h){this.requestManager=i,this.localGlyphMode=o,this.localFontFamily=h,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(i,o){this.urls[o]=i}getGlyphs(i,o,h){const g=[],_=this.urls[o]||Ca.GLYPHS_URL;for(const w in i)for(const j of i[w])g.push({stack:w,id:j});it(g,({stack:w,id:j},N)=>{let O=this.entries[w];O||(O=this.entries[w]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let L=O.glyphs[j];if(L!==void 0)return void N(null,{stack:w,id:j,glyph:L});if(L=this._tinySDF(O,w,j),L)return O.glyphs[j]=L,void N(null,{stack:w,id:j,glyph:L});const B=Math.floor(j/256);if(256*B>65535)return or("glyphs > 65535 not supported"),void N(null,{stack:w,id:j,glyph:L});if(O.ranges[B])return void N(null,{stack:w,id:j,glyph:L});let q=O.requests[B];q||(q=O.requests[B]=[],Av.loadGlyphRange(w,B,_,this.requestManager,(Y,Q)=>{if(Q){O.ascender=Q.ascender,O.descender=Q.descender;for(const re in Q.glyphs)this._doesCharSupportLocalGlyph(+re)||(O.glyphs[+re]=Q.glyphs[+re]);O.ranges[B]=!0}for(const re of q)re(Y,Q);delete O.requests[B]})),q.push((Y,Q)=>{Y?N(Y):Q&&N(null,{stack:w,id:j,glyph:Q.glyphs[j]||null})})},(w,j)=>{if(w)h(w);else if(j){const N={};for(const{stack:O,id:L,glyph:B}of j)N[O]===void 0&&(N[O]={}),N[O].glyphs===void 0&&(N[O].glyphs={}),N[O].glyphs[L]=B&&{id:B.id,bitmap:B.bitmap.clone(),metrics:B.metrics},N[O].ascender=this.entries[O].ascender,N[O].descender=this.entries[O].descender;h(null,N)}})}_doesCharSupportLocalGlyph(i){return this.localGlyphMode!==xA.none&&(this.localGlyphMode===xA.all?!!this.localFontFamily:!!this.localFontFamily&&(Un["CJK Unified Ideographs"](i)||Un["Hangul Syllables"](i)||Un.Hiragana(i)||Un.Katakana(i)||Un["CJK Symbols and Punctuation"](i)||Un["CJK Unified Ideographs Extension A"](i)||Un["CJK Unified Ideographs Extension B"](i)||Un.Osage(i)))}_tinySDF(i,o,h){const g=this.localFontFamily;if(!g||!this._doesCharSupportLocalGlyph(h))return;let _=i.tinySDF;if(!_){let re="400";/bold/i.test(o)?re="900":/medium/i.test(o)?re="500":/light/i.test(o)&&(re="200"),_=i.tinySDF=new Av.TinySDF({fontFamily:g,fontWeight:re,fontSize:24*Vh,buffer:3*Vh,radius:8*Vh}),_.fontWeight=re}if(this.localGlyphs[_.fontWeight][h])return this.localGlyphs[_.fontWeight][h];const w=String.fromCodePoint(h),{data:j,width:N,height:O,glyphWidth:L,glyphHeight:B,glyphLeft:q,glyphTop:Y,glyphAdvance:Q}=_.draw(w);return this.localGlyphs[_.fontWeight][h]={id:h,bitmap:new Oh({width:N,height:O},j),metrics:{width:L/Vh,height:B/Vh,left:q/Vh,top:Y/Vh-27,advance:Q/Vh,localGlyph:!0}}}}Av.loadGlyphRange=function(c,i,o,h,g){const _=256*i,w=_+255,j=h.transformRequest(h.normalizeGlyphsURL(o).replace("{fontstack}",c).replace("{range}",`${_}-${w}`),lf.Glyphs);Vu(j,(N,O)=>{if(N)g(N);else if(O){const L={},B=function(q){return new I2(q).readFields(iQ,{})}(O);for(const q of B.glyphs)L[q.id]=q;g(null,{glyphs:L,ascender:B.ascender,descender:B.descender})}})},Av.TinySDF=class{constructor({fontSize:c=24,buffer:i=3,radius:o=8,cutoff:h=.25,fontFamily:g="sans-serif",fontWeight:_="normal",fontStyle:w="normal"}={}){this.buffer=i,this.cutoff=h,this.radius=o;const j=this.size=c+4*i,N=this._createCanvas(j),O=this.ctx=N.getContext("2d",{willReadFrequently:!0});O.font=`${w} ${_} ${c}px ${g}`,O.textBaseline="alphabetic",O.textAlign="left",O.fillStyle="black",this.gridOuter=new Float64Array(j*j),this.gridInner=new Float64Array(j*j),this.f=new Float64Array(j),this.z=new Float64Array(j+1),this.v=new Uint16Array(j)}_createCanvas(c){const i=document.createElement("canvas");return i.width=i.height=c,i}draw(c){const{width:i,actualBoundingBoxAscent:o,actualBoundingBoxDescent:h,actualBoundingBoxLeft:g,actualBoundingBoxRight:_}=this.ctx.measureText(c),w=Math.ceil(o),j=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-g))),N=Math.min(this.size-this.buffer,w+Math.ceil(h)),O=j+2*this.buffer,L=N+2*this.buffer,B=Math.max(O*L,0),q=new Uint8ClampedArray(B),Y={data:q,width:O,height:L,glyphWidth:j,glyphHeight:N,glyphTop:w,glyphLeft:0,glyphAdvance:i};if(j===0||N===0)return Y;const{ctx:Q,buffer:re,gridInner:he,gridOuter:pe}=this;Q.clearRect(re,re,j,N),Q.fillText(c,re,re+w);const Se=Q.getImageData(re,re,j,N);pe.fill(R2,0,B),he.fill(0,0,B);for(let be=0;be<N;be++)for(let oe=0;oe<j;oe++){const xe=Se.data[4*(be*j+oe)+3]/255;if(xe===0)continue;const we=(be+re)*O+oe+re;if(xe===1)pe[we]=0,he[we]=R2;else{const je=.5-xe;pe[we]=je>0?je*je:0,he[we]=je<0?je*je:0}}AI(pe,0,0,O,L,O,this.f,this.v,this.z),AI(he,re,re,j,N,O,this.f,this.v,this.z);for(let be=0;be<B;be++){const oe=Math.sqrt(pe[be])-Math.sqrt(he[be]);q[be]=Math.round(255-255*(oe/this.radius+this.cutoff))}return Y}};const j0=C0;function jI(c,i){return c+i[1]-i[0]}function MI(c,i,o,h,g=1){const _=[],w=c.imagePrimary,j=w.pixelRatio,N=w.paddedRect.w-2*j0,O=w.paddedRect.h-2*j0,L=(c.right-c.left)*g,B=(c.bottom-c.top)*g,q=w.stretchX||[[0,N]],Y=w.stretchY||[[0,O]],Q=q.reduce(jI,0),re=Y.reduce(jI,0),he=N-Q,pe=O-re;let Se=0,be=Q,oe=0,xe=re,we=0,je=he,Ve=0,We=pe;if(w.content&&h){const Qe=w.content;Se=z2(q,0,Qe[0]),oe=z2(Y,0,Qe[1]),be=z2(q,Qe[0],Qe[2]),xe=z2(Y,Qe[1],Qe[3]),we=Qe[0]-Se,Ve=Qe[1]-oe,je=Qe[2]-Qe[0]-be,We=Qe[3]-Qe[1]-xe}const Ze=(Qe,pt,kt,Ct)=>{const Pt=L2(Qe.stretch-Se,be,L,c.left*g),Vt=F2(Qe.fixed-we,je,Qe.stretch,Q),ht=L2(pt.stretch-oe,xe,B,c.top*g),Mt=F2(pt.fixed-Ve,We,pt.stretch,re),dt=L2(kt.stretch-Se,be,L,c.left*g),ft=F2(kt.fixed-we,je,kt.stretch,Q),$t=L2(Ct.stretch-oe,xe,B,c.top*g),Gt=F2(Ct.fixed-Ve,We,Ct.stretch,re),Dn=new Kt(Pt,ht),bn=new Kt(dt,ht),an=new Kt(dt,$t),Ut=new Kt(Pt,$t),sr=new Kt(Vt/j,Mt/j),An=new Kt(ft/j,Gt/j),Cn=i*Math.PI/180;if(Cn){const mr=Math.sin(Cn),Ei=Math.cos(Cn),zi=[Ei,-mr,mr,Ei];Dn._matMult(zi),bn._matMult(zi),Ut._matMult(zi),an._matMult(zi)}const nr=Qe.stretch+Qe.fixed,dr=kt.stretch+kt.fixed,fr=pt.stretch+pt.fixed,wr=Ct.stretch+Ct.fixed,yr=c.imageSecondary;return{tl:Dn,tr:bn,bl:Ut,br:an,texPrimary:{x:w.paddedRect.x+j0+nr,y:w.paddedRect.y+j0+fr,w:dr-nr,h:wr-fr},texSecondary:yr?{x:yr.paddedRect.x+j0+nr,y:yr.paddedRect.y+j0+fr,w:dr-nr,h:wr-fr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:sr,pixelOffsetBR:An,minFontScaleX:je/j/L,minFontScaleY:We/j/B,isSDF:o}};if(h&&(w.stretchX||w.stretchY)){const Qe=PI(q,he,Q),pt=PI(Y,pe,re);for(let kt=0;kt<Qe.length-1;kt++){const Ct=Qe[kt],Pt=Qe[kt+1];for(let Vt=0;Vt<pt.length-1;Vt++)_.push(Ze(Ct,pt[Vt],Pt,pt[Vt+1]))}}else _.push(Ze({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:N+1},{fixed:0,stretch:O+1}));return _}function z2(c,i,o){let h=0;for(const g of c)h+=Math.max(i,Math.min(o,g[1]))-Math.max(i,Math.min(o,g[0]));return h}function PI(c,i,o){const h=[{fixed:-1,stretch:0}];for(const[g,_]of c){const w=h[h.length-1];h.push({fixed:g-w.stretch,stretch:w.stretch}),h.push({fixed:g-w.stretch,stretch:w.stretch+(_-g)})}return h.push({fixed:i+j0,stretch:o}),h}function L2(c,i,o,h){return c/i*o+h}function F2(c,i,o,h){return c-i*o/h}function fQ(c,i,o,h){const g=i+c.positionedLines[h].lineOffset;return h===0?o+g/2:o+(g+(i+c.positionedLines[h-1].lineOffset))/2}function pQ(c,i=1,o=!1){let h=1/0,g=1/0,_=-1/0,w=-1/0;const j=c[0];for(let Y=0;Y<j.length;Y++){const Q=j[Y];(!Y||Q.x<h)&&(h=Q.x),(!Y||Q.y<g)&&(g=Q.y),(!Y||Q.x>_)&&(_=Q.x),(!Y||Q.y>w)&&(w=Q.y)}const N=Math.min(_-h,w-g);let O=N/2;const L=new Ap([],mQ);if(N===0)return new Kt(h,g);for(let Y=h;Y<_;Y+=N)for(let Q=g;Q<w;Q+=N)L.push(new Cv(Y+O,Q+O,O,c));let B=function(Y){let Q=0,re=0,he=0;const pe=Y[0];for(let Se=0,be=pe.length,oe=be-1;Se<be;oe=Se++){const xe=pe[Se],we=pe[oe],je=xe.x*we.y-we.x*xe.y;re+=(xe.x+we.x)*je,he+=(xe.y+we.y)*je,Q+=3*je}return new Cv(re/Q,he/Q,0,Y)}(c),q=L.length;for(;L.length;){const Y=L.pop();(Y.d>B.d||!B.d)&&(B=Y,o&&console.log("found best %d after %d probes",Math.round(1e4*Y.d)/1e4,q)),Y.max-B.d<=i||(O=Y.h/2,L.push(new Cv(Y.p.x-O,Y.p.y-O,O,c)),L.push(new Cv(Y.p.x+O,Y.p.y-O,O,c)),L.push(new Cv(Y.p.x-O,Y.p.y+O,O,c)),L.push(new Cv(Y.p.x+O,Y.p.y+O,O,c)),q+=4)}return o&&(console.log(`num probes: ${q}`),console.log(`best distance: ${B.d}`)),B.p}function mQ(c,i){return i.max-c.max}class Cv{constructor(i,o,h,g){this.p=new Kt(i,o),this.h=h,this.d=function(_,w){let j=!1,N=1/0;for(let O=0;O<w.length;O++){const L=w[O];for(let B=0,q=L.length,Y=q-1;B<q;Y=B++){const Q=L[B],re=L[Y];Q.y>_.y!=re.y>_.y&&_.x<(re.x-Q.x)*(_.y-Q.y)/(re.y-Q.y)+Q.x&&(j=!j),N=Math.min(N,Er(_,Q,re))}}return(j?1:-1)*Math.sqrt(N)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}}const gQ=Object.keys,yA=Number.POSITIVE_INFINITY,xQ=Math.sqrt(2);function NI(c,[i,o]){let h=0,g=0;if(o===yA){i<0&&(i=0);const _=i/xQ;switch(c){case"top-right":case"top-left":g=_-7;break;case"bottom-right":case"bottom-left":g=7-_;break;case"bottom":g=7-i;break;case"top":g=i-7}switch(c){case"top-right":case"bottom-right":h=-_;break;case"top-left":case"bottom-left":h=_;break;case"left":h=i;break;case"right":h=-i}}else{switch(i=Math.abs(i),o=Math.abs(o),c){case"top-right":case"top-left":case"top":g=o-7;break;case"bottom-right":case"bottom-left":case"bottom":g=7-o}switch(c){case"top-right":case"bottom-right":case"right":h=-i;break;case"top-left":case"bottom-left":case"left":h=i}}return[h,g]}function B2(c,i,o,h,g,_,w,j,N){if(!i||!i.usvg)return;const O=xI(h),L=xI(g),B=_!=="both"&&_!=="width"||!mI(h)?1:Math.max(1,L.width/O.width),q=_!=="both"&&_!=="height"||!gI(h)?1:Math.max(1,L.height/O.height);o.scaleSelf(B,q);const Y=o.toString();w.set(Y,o),j.set(Y,i);const{imagePosition:Q}=gA(Y,i,C0);N.set(Y,Q)}function DI(c,i,o,h,g,_,w,j){if(!c)return;const N=function(O,L,B,q,Y){if(O.kind==="camera")return O.maxSize;if(O.kind==="composite"){const Q=L.possiblyEvaluate(new ui(O.maxZoom),B).evaluate(Y,{},B),re=L.possiblyEvaluate(new ui(O.minZoom),B).evaluate(Y,{},B);return Math.max(Q,re)}return L.possiblyEvaluate(new ui(q)).evaluate(Y,{},B)}(i,o,h,g,_);return c.scaleSelf(N*j*w)}function OI(c,i,o,h,g,_,w,j){return{iconPrimary:DI(c.getPrimary(),i,o,h,g,_,w,j),iconSecondary:DI(c.getSecondary(),i,o,h,g,_,w,j)}}function II(c,i,o,h){if(!c)return;const g=i.get(o.toString());if(c.imagePrimary=g,h){const _=i.get(h.toString());c.imageSecondary=_}}function yQ(c,i){for(const o in c.horizontal)kI(c.horizontal[o],i);kI(c.vertical,i)}function kI(c,i){if(c){for(const o of c.positionedLines)for(const h of o.positionedGlyphs)if(h.image!==null){const g=h.image.toString();h.rect=i.get(g).paddedRect}}}function vA(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function vQ(c,i,o,h,g,_,w,j,N){const O=_A(_.horizontal)||_.vertical,L=o.get("icon-text-fit-padding").evaluate(h,{},g);let B,q=i;return i&&N!=="none"&&(c.allowVerticalPlacement&&_.vertical&&(B=pI(i,_.vertical,N,L,j,w)),O&&(q=pI(i,O,N,L,j,w))),{defaultShapedIcon:q,verticallyShapedIcon:B}}function _Q(c,i,o,h,g,_,w,j,N,O,L,B,q,Y,Q,re,he,pe,Se,be){let oe=w.textMaxSize.evaluate(i,{},q);oe===void 0?oe=j*w.textScaleFactor:oe*=w.textScaleFactor;const xe=c.layers[0].layout,we=_A(o.horizontal)||o.vertical,je=Y.name==="globe",Ve=As,We=c.tilePixelRatio*oe/Ve,Ze=(Vt=c.overscaling,c.zoom>18&&Vt>2&&(Vt>>=1),Math.max(en/(512*Vt),1)*xe.get("symbol-spacing")),Qe=xe.get("text-padding")*c.tilePixelRatio,pt=xe.get("icon-padding")*c.tilePixelRatio,kt=te(xe.get("text-max-angle")),Ct=xe.get("icon-rotation-alignment")==="map"&&be!=="point",Pt=Ze/2;var Vt;c.hasAnyIconTextFit===!1&&he!=="none"&&(c.hasAnyIconTextFit=!0);const ht=i.properties?+i.properties[hm]:null,Mt=ht&&c.elevationFeatureIdToIndex?c.elevationFeatureIdToIndex.get(ht):65535,dt=(ft,$t,Gt)=>{if($t.x<0||$t.x>=en||$t.y<0||$t.y>=en)return;let Dn=null;if(je){const{x:bn,y:an,z:Ut}=Y.projectTilePoint($t.x,$t.y,Gt);Dn={anchor:new xm(bn,an,Ut,0,void 0),up:Y.upVector(Gt,$t.x,$t.y)}}(function(bn,an,Ut,sr,An,Cn,nr,dr,fr,wr,yr,mr,Ei,zi,Ae,Ne,yt,Qt,cn,on,Nn,Xn,Pr,Nr,gr,gi,Ii,Dr,ra){const Li=bn.addToLineVertexArray(an,sr);let fi,ua,Ui,ki,Fi,wi,vr,Si=0,ia=0,Gn=0,$r=0,$i=-1,oa=-1;const Zi={};let qa=ko("");const Ai=Ut?Ut.anchor:an,Ba=Dr!=="none";let Ll=0,oo=0;if(fr._unevaluatedLayout.getValue("text-radial-offset")===void 0){const Ha=fr.layout.get("text-offset").evaluate(Nn,{},gr);Ll=Ha[0]*As,oo=Ha[1]*As}else Ll=fr.layout.get("text-radial-offset").evaluate(Nn,{},gr)*As,oo=yA;if(bn.allowVerticalPlacement&&An.vertical){const Ha=An.vertical;if(Ae)wi=bA(Ha),dr&&(vr=bA(dr));else{const as=fr.layout.get("text-rotate").evaluate(Nn,{},gr)+90;Ui=V2(wr,Ai,an,yr,mr,Ei,Ha,zi,as,Ne),dr&&(ki=V2(wr,Ai,an,yr,mr,Ei,dr,Qt,as))}}if(Cn){const Ha=bn.iconSizeData,as=fr.layout.get("icon-rotate").evaluate(Nn,{},gr),lo=MI(Cn,as,Pr,Ba,Xn.iconScaleFactor),Zo=dr?MI(dr,as,Pr,Ba,Xn.iconScaleFactor):void 0;ua=V2(wr,Ai,an,yr,mr,Ei,Cn,Qt,as,null),Si=4*lo.length;let Co=null;Ha.kind==="source"?(Co=[$f*fr.layout.get("icon-size").evaluate(Nn,{},gr)*Xn.iconScaleFactor],Co[0]>Og&&or(`${bn.layerIds[0]}: Value for "icon-size" is >= ${C1}. Reduce your "icon-size".`)):Ha.kind==="composite"&&(Co=[$f*Xn.compositeIconSizes[0].evaluate(Nn,{},gr)*Xn.iconScaleFactor,$f*Xn.compositeIconSizes[1].evaluate(Nn,{},gr)*Xn.iconScaleFactor],(Co[0]>Og||Co[1]>Og)&&or(`${bn.layerIds[0]}: Value for "icon-size" is >= ${C1}. Reduce your "icon-size".`)),bn.addSymbols(bn.icon,lo,Co,on,cn,Nn,void 0,Ut,an,Li.lineStartIndex,Li.lineLength,-1,Nr,gr,gi,Ii),$i=bn.icon.placedSymbolArray.length-1,Zo&&(ia=4*Zo.length,bn.addSymbols(bn.icon,Zo,Co,on,cn,Nn,yc.vertical,Ut,an,Li.lineStartIndex,Li.lineLength,-1,Nr,gr,gi,Ii),oa=bn.icon.placedSymbolArray.length-1)}for(const Ha in An.horizontal){const as=Ha,lo=An.horizontal[as];fi||(qa=ko(lo.text),Ae?Fi=bA(lo):fi=V2(wr,Ai,an,yr,mr,Ei,lo,zi,fr.layout.get("text-rotate").evaluate(Nn,{},gr),Ne));const Zo=lo.positionedLines.length===1;if(Gn+=RI(bn,Ut,an,lo,nr,fr,Ae,Nn,Ne,Li,An.vertical?yc.horizontal:yc.horizontalOnly,Zo?gQ(An.horizontal):[as],Zi,$i,Xn,Nr,gr,gi),Zo)break}An.vertical&&($r+=RI(bn,Ut,an,An.vertical,nr,fr,Ae,Nn,Ne,Li,yc.vertical,["vertical"],Zi,oa,Xn,Nr,gr,gi));let Vs=-1;const Fl=(Ha,as)=>Ha?Math.max(Ha,as):as;Vs=Fl(Fi,Vs),Vs=Fl(wi,Vs),Vs=Fl(vr,Vs);const qf=Vs>-1?1:0;bn.glyphOffsetArray.length>=65535&&or("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Nn.sortKey!==void 0&&bn.addToSortKeyRanges(bn.symbolInstances.length,Nn.sortKey),bn.symbolInstances.emplaceBack(an.x,an.y,Ai.x,Ai.y,Ai.z,Zi.right>=0?Zi.right:-1,Zi.center>=0?Zi.center:-1,Zi.left>=0?Zi.left:-1,Zi.vertical>=0?Zi.vertical:-1,$i,oa,qa,fi!==void 0?fi:bn.collisionBoxArray.length,fi!==void 0?fi+1:bn.collisionBoxArray.length,Ui!==void 0?Ui:bn.collisionBoxArray.length,Ui!==void 0?Ui+1:bn.collisionBoxArray.length,ua!==void 0?ua:bn.collisionBoxArray.length,ua!==void 0?ua+1:bn.collisionBoxArray.length,ki||bn.collisionBoxArray.length,ki?ki+1:bn.collisionBoxArray.length,yr,Gn,$r,Si,ia,qf,0,Ll,oo,Vs,0,Ba?1:0,ra)})(c,$t,Dn,ft,o,h,_,g,c.layers[0],c.collisionBoxArray,i.index,i.sourceLayerIndex,c.index,Qe,Se,O,0,pt,Ct,pe,i,w,L,B,q,Q,re,he,Mt)};if(be==="line")for(const ft of m(i.geometry,0,0,en,en)){const $t=hQ(ft,Ze,kt,o.vertical||we,h,Ve,We,c.overscaling,en);for(const Gt of $t)we&&bQ(c,we.text,Pt,Gt)||dt(ft,Gt,q)}else if(be==="line-center"){for(const ft of i.geometry)if(ft.length>1){const $t=dQ(ft,kt,o.vertical||we,h,Ve,We);$t&&dt(ft,$t,q)}}else if(i.type==="Polygon")for(const ft of sv(i.geometry,0)){const $t=pQ(ft,16);dt(ft[0],new xm($t.x,$t.y,0,0,void 0),q)}else if(i.type==="LineString")for(const ft of i.geometry)dt(ft,new xm(ft[0].x,ft[0].y,0,0,void 0),q);else if(i.type==="Point")for(const ft of i.geometry)for(const $t of ft)dt([$t],new xm($t.x,$t.y,0,0,void 0),q)}const C1=255,Og=C1*$f;function RI(c,i,o,h,g,_,w,j,N,O,L,B,q,Y,Q,re,he,pe){const Se=function(xe,we,je,Ve,We,Ze,Qe,pt){const kt=[];if(we.positionedLines.length===0)return kt;const Ct=Ve.layout.get("text-rotate").evaluate(Ze,{})*Math.PI/180,Pt=function(ft){const $t=ft[0],Gt=ft[1],Dn=$t*Gt;return Dn>0?[$t,-Gt]:Dn<0?[-$t,Gt]:$t===0?[Gt,$t]:[Gt,-$t]}(je);let Vt=Math.abs(we.top-we.bottom);for(const ft of we.positionedLines)Vt-=ft.lineOffset;const ht=we.positionedLines.length,Mt=Vt/ht;let dt=we.top-je[1];for(let ft=0;ft<ht;++ft){const $t=we.positionedLines[ft];dt=fQ(we,Mt,dt,ft);for(const Gt of $t.positionedGlyphs){if(!Gt.rect)continue;const Dn=Gt.rect||{};let bn=oQ+1,an=!0,Ut=1,sr=0;if(Gt.image){const Nn=Qe.get(Gt.image.toString());if(!Nn)continue;if(Nn.sdf){or("SDF images are not supported in formatted text and will be ignored.");continue}an=!1,Ut=Nn.pixelRatio,bn=C0/Ut}const An=(We||pt)&&Gt.vertical,Cn=Gt.metrics.advance*Gt.scale/2,nr=Gt.metrics,dr=Gt.rect;if(dr===null)continue;pt&&we.verticalizable&&(sr=Gt.image?Cn-Gt.metrics.width*Gt.scale/2:0);const fr=We?[Gt.x+Cn,Gt.y]:[0,0];let wr=[0,0],yr=[0,0],mr=!1;We||(An?(yr=[Gt.x+Cn+Pt[0],Gt.y+Pt[1]-sr],mr=!0):wr=[Gt.x+Cn+je[0],Gt.y+je[1]-sr]);const Ei=dr.w*Gt.scale/(Ut*(Gt.localGlyph?Vh:1)),zi=dr.h*Gt.scale/(Ut*(Gt.localGlyph?Vh:1));let Ae,Ne,yt,Qt;if(An){const Nn=Gt.y-dt,Xn=new Kt(-Cn,Cn-Nn),Pr=-Math.PI/2,Nr=new Kt(...yr);Ae=new Kt(-Cn+wr[0],wr[1]),Ae._rotateAround(Pr,Xn)._add(Nr),Ae.x+=-Nn+Cn,Ae.y-=(nr.left-bn)*Gt.scale;const gr=Gt.image?nr.advance*Gt.scale:As*Gt.scale,gi=String.fromCodePoint(Gt.glyph);tQ(gi)?Ae.x+=(1-bn)*Gt.scale:nQ(gi)?Ae.x+=gr-nr.height*Gt.scale+(-bn-1)*Gt.scale:Ae.x+=Gt.image||nr.width+2*bn===dr.w&&nr.height+2*bn===dr.h?(gr-zi)/2:(gr-(nr.height+2*bn)*Gt.scale)/2,Ne=new Kt(Ae.x,Ae.y-Ei),yt=new Kt(Ae.x+zi,Ae.y),Qt=new Kt(Ae.x+zi,Ae.y-Ei)}else{const Nn=(nr.left-bn)*Gt.scale-Cn+wr[0],Xn=(-nr.top-bn)*Gt.scale+wr[1],Pr=Nn+Ei,Nr=Xn+zi;Ae=new Kt(Nn,Xn),Ne=new Kt(Pr,Xn),yt=new Kt(Nn,Nr),Qt=new Kt(Pr,Nr)}if(Ct){let Nn;Nn=We?new Kt(0,0):mr?new Kt(Pt[0],Pt[1]):new Kt(je[0],je[1]),Ae._rotateAround(Ct,Nn),Ne._rotateAround(Ct,Nn),yt._rotateAround(Ct,Nn),Qt._rotateAround(Ct,Nn)}const cn=new Kt(0,0),on=new Kt(0,0);kt.push({tl:Ae,tr:Ne,bl:yt,br:Qt,texPrimary:Dn,texSecondary:void 0,writingMode:we.writingMode,glyphOffset:fr,sectionIndex:Gt.sectionIndex,isSDF:an,pixelOffsetTL:cn,pixelOffsetBR:on,minFontScaleX:0,minFontScaleY:0})}}return kt}(0,h,N,_,w,j,g,c.allowVerticalPlacement),be=c.textSizeData;let oe=null;be.kind==="source"?(oe=[$f*_.layout.get("text-size").evaluate(j,{},he)*Q.textScaleFactor],oe[0]>Og&&or(`${c.layerIds[0]}: Value for "text-size" is >= ${C1}. Reduce your "text-size".`)):be.kind==="composite"&&(oe=[$f*Q.compositeTextSizes[0].evaluate(j,{},he)*Q.textScaleFactor,$f*Q.compositeTextSizes[1].evaluate(j,{},he)*Q.textScaleFactor],(oe[0]>Og||oe[1]>Og)&&or(`${c.layerIds[0]}: Value for "text-size" is >= ${C1}. Reduce your "text-size".`)),c.addSymbols(c.text,Se,oe,N,w,j,L,i,o,O.lineStartIndex,O.lineLength,Y,re,he,pe,!1);for(const xe of B)q[xe]=c.text.placedSymbolArray.length-1;return 4*Se.length}function _A(c){for(const i in c)return c[i];return null}function V2(c,i,o,h,g,_,w,j,N,O){let L=w.top,B=w.bottom,q=w.left,Y=w.right;if(fI(w)&&w.collisionPadding){const Q=w.collisionPadding;q-=Q[0],L-=Q[1],Y+=Q[2],B+=Q[3]}if(N){const Q=new Kt(q,L),re=new Kt(Y,L),he=new Kt(q,B),pe=new Kt(Y,B),Se=te(N);let be=new Kt(0,0);O&&(be=new Kt(O[0],O[1])),Q._rotateAround(Se,be),re._rotateAround(Se,be),he._rotateAround(Se,be),pe._rotateAround(Se,be),q=Math.min(Q.x,re.x,he.x,pe.x),Y=Math.max(Q.x,re.x,he.x,pe.x),L=Math.min(Q.y,re.y,he.y,pe.y),B=Math.max(Q.y,re.y,he.y,pe.y)}return c.emplaceBack(i.x,i.y,i.z,o.x,o.y,q,L,Y,B,j,h,g,_),c.length-1}function bA(c){fI(c)&&c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const i=c.bottom-c.top;return i>0?Math.max(10,i):null}function bQ(c,i,o,h){const g=c.compareText;if(i in g){const _=g[i];for(let w=_.length-1;w>=0;w--)if(h.dist(_[w])<o)return!0}else g[i]=[];return g[i].push(h),!1}function zI(c,i){const o=c.fovAboveCenter,h=c.elevation?c.elevation.getMinElevationBelowMSL()*i:0,g=(c._camera.position[2]*c.worldSize-h)/Math.cos(c._pitch),_=Math.sin(o)*g/Math.sin(Math.max(Math.PI/2-c._pitch-o,.01));let w=Math.sin(c._pitch)*_+g;const j=g*(1/c._horizonShift);if(!c.elevation||c.elevation.exaggeration()===0){let N=Math.max(c.zoom-17,0);c.isOrthographic&&(N/=10),w*=1+N}return Math.min(1.01*w,j)}function j1(c,i){if(!i.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:i};const o=Math.pow(2,-c.z),h=c.x*o,g=(c.x+1)*o,_=c.y*o,w=(c.y+1)*o,j=Fe(h),N=Fe(g),O=$e(_),L=$e(w),B=i.project(j,O),q=i.project(N,O),Y=i.project(N,L),Q=i.project(j,L);let re=Math.min(B.x,q.x,Y.x,Q.x),he=Math.min(B.y,q.y,Y.y,Q.y),pe=Math.max(B.x,q.x,Y.x,Q.x),Se=Math.max(B.y,q.y,Y.y,Q.y);const be=o/16;function oe(we,je,Ve,We,Ze,Qe){const pt=(Ve+Ze)/2,kt=(We+Qe)/2,Ct=i.project(Fe(pt),$e(kt)),Pt=Math.max(0,re-Ct.x,he-Ct.y,Ct.x-pe,Ct.y-Se);re=Math.min(re,Ct.x),pe=Math.max(pe,Ct.x),he=Math.min(he,Ct.y),Se=Math.max(Se,Ct.y),Pt>be&&(oe(we,Ct,Ve,We,pt,kt),oe(Ct,je,pt,kt,Ze,Qe))}oe(B,q,h,_,g,_),oe(q,Y,g,_,g,w),oe(Y,Q,g,w,h,w),oe(Q,B,h,w,h,_),re-=be,he-=be,pe+=be,Se+=be;const xe=1/Math.max(pe-re,Se-he);return{scale:xe,x:re*xe,y:he*xe,x2:pe*xe,y2:Se*xe,projection:i}}function LI(c,{x:i,y:o},h=0){return new Kt(((i-h)*c.scale-c.x)*en,(o*c.scale-c.y)*en)}const wQ=W(new Float32Array(16));class Ig{constructor(i){this.spec=i,this.name=i.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(i,o){return{x:0,y:0,z:0}}unproject(i,o){return new ue(0,0)}projectTilePoint(i,o,h){return{x:i,y:o,z:0}}locationPoint(i,o,h,g=!0){return i._coordinatePoint(i.locationCoordinate(o,h),g)}pixelsPerMeter(i,o){return Ce(1,i)*o}pixelSpaceConversion(i,o,h){return 1}farthestPixelDistance(i){return zI(i,i.pixelsPerMeter)}pointCoordinate(i,o,h,g){const _=i.horizonLineFromTop(!1),w=new Kt(o,Math.max(_,h));return i.rayIntersectionCoordinate(i.pointRayIntersection(w,g))}pointCoordinate3D(i,o,h){const g=new Kt(o,h);if(i.elevation)return i.elevation.pointCoordinate(g);{const _=this.pointCoordinate(i,g.x,g.y,0);return[_.x,_.y,_.z]}}isPointAboveHorizon(i,o){if(i.elevation&&i.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(i,o.x,o.y);const h=i.horizonLineFromTop();return o.y<h}createInversionMatrix(i,o){return wQ}createTileMatrix(i,o,h){let g,_,w;const j=h.canonical,N=W(new Float64Array(16));if(this.isReprojectedInTileSpace){const O=j1(j,this);g=1,_=O.x+h.wrap*O.scale,w=O.y,ie(N,N,[g/O.scale,g/O.scale,i.pixelsPerMeter/o])}else g=o/i.zoomScale(j.z),_=(j.x+Math.pow(2,j.z)*h.wrap)*g,w=j.y*g;return ne(N,N,[_,w,0]),ie(N,N,[g/en,g/en,1]),N}upVector(i,o,h){return[0,0,1]}upVectorScale(i,o,h){return{metersToTile:1}}}class SQ extends Ig{constructor(i){super(i),this.range=[4,7],this.center=i.center||[-96,37.5];const[o,h]=this.parallels=i.parallels||[29.5,45.5],g=Math.sin(te(o));this.n=(g+Math.sin(te(h)))/2,this.c=1+g*(2*this.n-g),this.r0=Math.sqrt(this.c)/this.n}project(i,o){const{n:h,c:g,r0:_}=this,w=te(i-this.center[0]),j=te(o),N=Math.sqrt(g-2*h*Math.sin(j))/h;return{x:N*Math.sin(w*h),y:N*Math.cos(w*h)-_,z:0}}unproject(i,o){const{n:h,c:g,r0:_}=this,w=_+o;let j=Math.atan2(i,Math.abs(w))*Math.sign(w);w*h<0&&(j-=Math.PI*Math.sign(i)*Math.sign(w));const N=te(this.center[0])*h;j=Ye(j,-Math.PI-N,Math.PI-N);const O=Le(le(j/h)+this.center[0],-180,180),L=Math.asin(Le((g-(i*i+w*w)*h*h)/(2*h),-1,1)),B=Le(le(L),-85.051129,et);return new ue(O,B)}}const M1=1.340264,P1=-.081106,N1=893e-6,D1=.003796,U2=Math.sqrt(3)/2;class TQ extends Ig{project(i,o){o=o/180*Math.PI,i=i/180*Math.PI;const h=Math.asin(U2*Math.sin(o)),g=h*h,_=g*g*g;return{x:.5*(i*Math.cos(h)/(U2*(M1+3*P1*g+_*(7*N1+9*D1*g)))/Math.PI+.5),y:1-.5*(h*(M1+P1*g+_*(N1+D1*g))/Math.PI+1),z:0}}unproject(i,o){i=(2*i-.5)*Math.PI;let h=o=(2*(1-o)-1)*Math.PI,g=h*h,_=g*g*g;for(let L,B,q,Y=0;Y<12&&(B=h*(M1+P1*g+_*(N1+D1*g))-o,q=M1+3*P1*g+_*(7*N1+9*D1*g),L=B/q,h=Le(h-L,-Math.PI/3,Math.PI/3),g=h*h,_=g*g*g,!(Math.abs(L)<1e-12));++Y);const w=U2*i*(M1+3*P1*g+_*(7*N1+9*D1*g))/Math.cos(h),j=Math.asin(Math.sin(h)/U2),N=Le(180*w/Math.PI,-180,180),O=Le(180*j/Math.PI,-85.051129,et);return new ue(N,O)}}class EQ extends Ig{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0}project(i,o){return{x:.5+i/360,y:.5-o/360,z:0}}unproject(i,o){const h=360*(i-.5),g=Le(360*(.5-o),-85.051129,et);return new ue(h,g)}}const jv=Math.PI/2;function $2(c){return Math.tan((jv+c)/2)}class AQ extends Ig{constructor(i){super(i),this.center=i.center||[0,30];const[o,h]=this.parallels=i.parallels||[30,30];let g=te(o),_=te(h);this.southernCenter=g+_<0,this.southernCenter&&(g=-g,_=-_);const w=Math.cos(g),j=$2(g);this.n=g===_?Math.sin(g):Math.log(w/Math.cos(_))/Math.log($2(_)/j),this.f=w*Math.pow($2(g),this.n)/this.n}project(i,o){o=te(o),this.southernCenter&&(o=-o),i=te(i-this.center[0]);const h=1e-6,{n:g,f:_}=this;_>0?o<-jv+h&&(o=-jv+h):o>jv-h&&(o=jv-h);const w=_/Math.pow($2(o),g);let j=w*Math.sin(g*i),N=_-w*Math.cos(g*i);return j=.5*(j/Math.PI+.5),N=.5*(N/Math.PI+.5),{x:j,y:this.southernCenter?N:1-N,z:0}}unproject(i,o){i=(2*i-.5)*Math.PI,this.southernCenter&&(o=1-o),o=(2*(1-o)-.5)*Math.PI;const{n:h,f:g}=this,_=g-o,w=Math.sign(_),j=Math.sign(h)*Math.sqrt(i*i+_*_);let N=Math.atan2(i,Math.abs(_))*w;_*h<0&&(N-=Math.PI*Math.sign(i)*w);const O=Le(le(N/h)+this.center[0],-180,180),L=Le(le(2*Math.atan(Math.pow(g/j,1/h))-jv),-85.051129,et);return new ue(O,this.southernCenter?-L:L)}}class FI extends Ig{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(i,o){return{x:Ie(i),y:Oe(o),z:0}}unproject(i,o){const h=Fe(i),g=$e(o);return new ue(h,g)}}const BI=te(et);class CQ extends Ig{project(i,o){const h=(o=te(o))*o,g=h*h;return{x:.5*((i=te(i))*(.8707-.131979*h+g*(g*(.003971*h-.001529*g)-.013791))/Math.PI+.5),y:1-.5*(o*(1.007226+h*(.015085+g*(.028874*h-.044475-.005916*g)))/Math.PI+1),z:0}}unproject(i,o){i=(2*i-.5)*Math.PI;let h=o=(2*(1-o)-1)*Math.PI,g=25,_=0,w=h*h;do{w=h*h;const O=w*w;_=(h*(1.007226+w*(.015085+O*(.028874*w-.044475-.005916*O)))-o)/(1.007226+w*(.045255+O*(.259866*w-.311325-.005916*11*O))),h=Le(h-_,-BI,BI)}while(Math.abs(_)>1e-6&&--g>0);w=h*h;const j=Le(le(i/(.8707+w*(w*(w*w*w*(.003971-.001529*w)-.013791)-.131979))),-180,180),N=le(h);return new ue(j,N)}}const VI=te(et);class jQ extends Ig{project(i,o){o=te(o),i=te(i);const h=Math.cos(o),g=2/Math.PI,_=Math.acos(h*Math.cos(i/2)),w=Math.sin(_)/_,j=.5*(i*g+2*h*Math.sin(i/2)/w)||0,N=.5*(o+Math.sin(o)/w)||0;return{x:.5*(j/Math.PI+.5),y:1-.5*(N/Math.PI+1),z:0}}unproject(i,o){let h=i=(2*i-.5)*Math.PI,g=o=(2*(1-o)-1)*Math.PI,_=25;const w=1e-6;let j=0,N=0;do{const O=Math.cos(g),L=Math.sin(g),B=2*L*O,q=L*L,Y=O*O,Q=Math.cos(h/2),re=Math.sin(h/2),he=2*Q*re,pe=re*re,Se=1-Y*Q*Q,be=Se?1/Se:0,oe=Se?Math.acos(O*Q)*Math.sqrt(1/Se):0,xe=.5*(2*oe*O*re+2*h/Math.PI)-i,we=.5*(oe*L+g)-o,je=.5*be*(Y*pe+oe*O*Q*q)+1/Math.PI,Ve=be*(he*B/4-oe*L*re),We=.125*be*(B*re-oe*L*Y*he),Ze=.5*be*(q*Q+oe*pe*O)+.5,Qe=Ve*We-Ze*je;j=(we*Ve-xe*Ze)/Qe,N=(xe*We-we*je)/Qe,h=Le(h-j,-Math.PI,Math.PI),g=Le(g-N,-VI,VI)}while((Math.abs(j)>w||Math.abs(N)>w)&&--_>0);return new ue(le(h),le(g))}}class UI extends Ig{constructor(i){super(i),this.center=i.center||[0,0],this.parallels=i.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(te(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(i,o){const{scale:h,cosPhi:g}=this;return{x:te(i)*g*h+.5,y:-Math.sin(te(o))/g*h+.5,z:0}}unproject(i,o){const{scale:h,cosPhi:g}=this,_=-(o-.5)/h,w=Le(le((i-.5)/h)/g,-180,180),j=Math.asin(Le(_*g,-1,1)),N=Le(le(j),-85.051129,et);return new ue(w,N)}}class MQ extends FI{constructor(i){super(i),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(i,o,h){const g=_g(i,o,h);return un(g,g,lm(bu(h))),{x:g[0],y:g[1],z:g[2]}}locationPoint(i,o,h){const g=de(o.lat,o.lng),_=Mn([],g),w=h?i._centerAltitude+h:i.elevation?i.elevation.getAtPointOrZero(i.locationCoordinate(o),i._centerAltitude):i._centerAltitude;ot(g,g,_,Ce(1,0)*en*w);const j=W(new Float64Array(16));return Z(j,i.pixelMatrix,i.globeMatrix),un(g,g,j),new Kt(g[0],g[1])}pixelsPerMeter(i,o){return Ce(1,0)*o}pixelSpaceConversion(i,o,h){const g=Ce(1,i)*o,_=Vn(Ce(1,45)*o,g,h);return this.pixelsPerMeter(i,o)/_}createTileMatrix(i,o,h){const g=Ky(bu(h.canonical));return Z(new Float64Array(16),i.globeMatrix,g)}createInversionMatrix(i,o){const{center:h}=i,g=lm(bu(o));return ae(g,g,te(h.lng)),ge(g,g,te(h.lat)),ie(g,g,[i._pixelsPerMercatorPixel,i._pixelsPerMercatorPixel,1]),Float32Array.from(g)}pointCoordinate(i,o,h,g){return sm(i,o,h,!0)||new lt(0,0)}pointCoordinate3D(i,o,h){const g=this.pointCoordinate(i,o,h,0);return[g.x,g.y,g.z]}isPointAboveHorizon(i,o){return!sm(i,o.x,o.y,!1)}farthestPixelDistance(i){const o=function(g,_){const w=g.cameraToCenterDistance,j=g._centerAltitude*_,N=g._camera,O=g._camera.forward(),L=vt([],Ge([],O,-w),[0,0,j]),B=g.worldSize/(2*Math.PI),q=[0,0,-B],Y=g.width/g.height,Q=Math.tan(g.fovAboveCenter),re=Ge([],N.up(),Q),he=Ge([],N.right(),Q*Y),pe=Mn([],vt([],vt([],O,re),he)),Se=[];let be;if(new ul(L,pe).closestPointOnSphere(q,B,Se)){const oe=vt([],Se,q),xe=Ir([],oe,L);be=Math.cos(g.fovAboveCenter)*jt(xe)}else{const oe=Ir([],L,q),xe=Ir([],q,L);Mn(xe,xe);const we=jt(oe)-B;be=Math.sqrt(we*(we+2*B));const je=Math.acos(be/(B+we))-Math.acos(vn(O,xe));be*=Math.cos(je)}return 1.01*be}(i,this.pixelsPerMeter(i.center.lat,i.worldSize)),h=Dh(i.zoom);if(h>0){const g=zI(i,Ce(1,i.center.lat)*i.worldSize),_=i.worldSize/(2*Math.PI),w=Math.max(i.width,i.height)/i.worldSize*Math.PI;return Vn(o,g+_*(1-Math.cos(w)),Math.pow(h,10))}return o}upVector(i,o,h){return _g(o,h,i,1)}upVectorScale(i){return{metersToTile:_u(l0(bu(i)))}}}function $I(c){const i=c.parallels,o=!!i&&Math.abs(i[0]+i[1])<.01;switch(c.name){case"mercator":return new FI(c);case"equirectangular":return new EQ(c);case"naturalEarth":return new CQ(c);case"equalEarth":return new TQ(c);case"winkelTripel":return new jQ(c);case"albers":return o?new UI(c):new SQ(c);case"lambertConformalConic":return o?new UI(c):new AQ(c);case"globe":return new MQ(c)}throw new Error(`Invalid projection name: ${c.name}`)}const PQ=yd.VectorTileFeature.types,NQ=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function q2(c,i,o,h,g,_,w,j,N,O,L,B,q){const Y=j?Math.min(Og,Math.round(j[0])):0,Q=j?Math.min(Og,Math.round(j[1])):0;c.emplaceBack(i,o,Math.round(32*h),Math.round(32*g),_,w,(Y<<1)+(N?1:0),Q,16*O,16*L,256*B,256*q)}function H2(c,i,o){c.emplaceBack(i,o)}function G2(c,i,o,h,g,_,w){c.emplaceBack(i,o,h,g,_,w)}function W2(c,i,o,h,g){c.emplaceBack(i,o,h,g),c.emplaceBack(i,o,h,g),c.emplaceBack(i,o,h,g),c.emplaceBack(i,o,h,g)}function DQ(c){for(const i of c.sections)if(fu(i.text))return!0;return!1}class wA{constructor(i){this.layoutVertexArray=new gu,this.indexArray=new la,this.programConfigurations=i,this.segments=new Wi,this.dynamicLayoutVertexArray=new pc,this.opacityVertexArray=new ud,this.placedSymbolArray=new Kx,this.iconTransitioningVertexArray=new xu,this.globeExtVertexArray=new no,this.zOffsetVertexArray=new Eh}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(i,o,h,g,_){this.isEmpty()||(h&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,GY.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,ZY.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,NQ,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=i.createVertexBuffer(this.iconTransitioningVertexArray,KY.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,WY.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||_)&&(this.zOffsetVertexBuffer=i.createVertexBuffer(this.zOffsetVertexArray,XY.members,!0)),this.opacityVertexBuffer.itemSize=1),(h||g)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}mn(wA,"SymbolBuffers");class SA{constructor(i,o,h){this.layoutVertexArray=new i,this.layoutAttributes=o,this.indexArray=new h,this.segments=new Wi,this.collisionVertexArray=new xg,this.collisionVertexArrayExt=new pc}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,YY.members,!0),this.collisionVertexBufferExt=i.createVertexBuffer(this.collisionVertexArrayExt,QY.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}mn(SA,"CollisionBuffers");class Z2{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.lut=i.lut,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(w=>w.fqid),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=W([]),this.placementViewportMatrix=W([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=yI(this.zoom,o["text-size"]),this.iconSizeData=yI(this.zoom,o["icon-size"]);const h=this.layers[0].layout,g=h.get("symbol-sort-key"),_=h.get("symbol-z-order");this.canOverlap=h.get("text-allow-overlap")||h.get("icon-allow-overlap")||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&g.constantOr(1)!==void 0,this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=h.get("text-writing-mode").map(w=>yc[w]),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=i.sourceID,this.projection=i.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new wA(new gd(this.layers,{zoom:this.zoom,lut:this.lut},i=>i.startsWith("text")||i.startsWith("symbol"))),this.icon=new wA(new gd(this.layers,{zoom:this.zoom,lut:this.lut},i=>i.startsWith("icon")||i.startsWith("symbol"))),this.glyphOffsetArray=new is,this.lineVertexArray=new Ss,this.symbolInstances=new Yx}calculateGlyphDependencies(i,o,h,g,_){for(const w of i){const j=w.codePointAt(0);if(j===void 0)break;if(o[j]=!0,g&&_&&j<=65535){const N=S1[w];N&&(o[N.charCodeAt(0)]=!0)}}}updateFootprints(i,o){}updateReplacement(i,o){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const h=o.getReplacementRegionsForTile(i.toUnwrapped(),!0);return!jg(this.activeReplacements,h)&&(this.activeReplacements=h,!0)}populate(i,o,h,g){const _=this.layers[0],w=_.layout,j=this.projection.name==="globe",N=w.get("text-font"),O=w.get("text-field"),L=w.get("icon-image"),[B,q]=w.get("icon-size-scale-range"),Y=Le(o.scaleFactor||1,B,q),Q=(O.value.kind!=="constant"||O.value.value instanceof Rs&&!O.value.value.isEmpty()||O.value.value.toString().length>0)&&(N.value.kind!=="constant"||N.value.value.length>0),re=L.value.kind!=="constant"||!!L.value.value||Object.keys(L.parameters).length>0,he=w.get("symbol-sort-key");if(this.features=[],!Q&&!re)return;const pe=o.iconDependencies,Se=o.glyphDependencies,be=o.availableImages,oe=new ui(this.zoom);for(const{feature:xe,id:we,index:je,sourceLayerIndex:Ve}of i){const We=_._featureFilter.needGeometry,Ze=Tn(xe,We);if(!_._featureFilter.filter(oe,Ze,h))continue;if(We||(Ze.geometry=yn(xe,h,g)),j&&xe.type!==1&&h.z<=5){const Pt=Ze.geometry,Vt=.98078528056,ht=(Mt,dt)=>vn(_g(Mt.x,Mt.y,h,1),_g(dt.x,dt.y,h,1))<Vt;for(let Mt=0;Mt<Pt.length;Mt++)Pt[Mt]=Dt(Pt[Mt],ht)}let Qe,pt;if(Q){const Pt=_.getValueAndResolveTokens("text-field",Ze,h,be),Vt=Rs.factory(Pt);DQ(Vt)&&(this.hasRTLText=!0),(!this.hasRTLText||ad()==="unavailable"||this.hasRTLText&&Pl.isParsed())&&(Qe=eQ(Vt,_,Ze))}if(re){const Pt=_.getValueAndResolveTokens("icon-image",Ze,h,be);pt=typeof Pt=="string"?Js.build(Pt):Pt}if(!Qe&&!pt)continue;const kt=this.sortFeaturesByKey?he.evaluate(Ze,{},h):void 0,Ct={id:we,text:Qe,icon:pt,index:je,sourceLayerIndex:Ve,geometry:Ze.geometry,properties:xe.properties,type:PQ[xe.type],sortKey:kt};if(this.features.push(Ct),pt){const Pt=this.layers[0]._unevaluatedLayout._values,{iconPrimary:Vt,iconSecondary:ht}=OI(pt,this.iconSizeData,Pt["icon-size"],h,this.zoom,Ct,this.pixelRatio,Y),Mt=Vt.id.toString();if(pe.has(Mt)?pe.get(Mt).push(Vt):pe.set(Mt,[Vt]),ht){const dt=ht.id.toString();pe.has(dt)?pe.get(dt).push(ht):pe.set(dt,[ht])}}if(Qe){const Pt=N.evaluate(Ze,{},h).join(","),Vt=w.get("text-rotation-alignment")==="map"&&w.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(yc.vertical)>=0;for(const ht of Qe.sections)if(ht.image){const Mt=ht.image.getPrimary().scaleSelf(this.pixelRatio),dt=Mt.id.toString(),ft=pe.get(dt)||[];ft.push(Mt),pe.set(dt,ft)}else{const Mt=Vp(Qe.toString()),dt=ht.fontStack||Pt,ft=Se[dt]=Se[dt]||{};this.calculateGlyphDependencies(ht.text,ft,Vt,this.allowVerticalPlacement,Mt)}}}if(w.get("symbol-placement")==="line"&&(this.features=function(xe){const we={},je={},Ve=[];let We=0;function Ze(Ct){Ve.push(xe[Ct]),We++}function Qe(Ct,Pt,Vt){const ht=je[Ct];return delete je[Ct],je[Pt]=ht,Ve[ht].geometry[0].pop(),Ve[ht].geometry[0]=Ve[ht].geometry[0].concat(Vt[0]),ht}function pt(Ct,Pt,Vt){const ht=we[Pt];return delete we[Pt],we[Ct]=ht,Ve[ht].geometry[0].shift(),Ve[ht].geometry[0]=Vt[0].concat(Ve[ht].geometry[0]),ht}function kt(Ct,Pt,Vt){const ht=Vt?Pt[0][Pt[0].length-1]:Pt[0][0];return`${Ct}:${ht.x}:${ht.y}`}for(let Ct=0;Ct<xe.length;Ct++){const Pt=xe[Ct],Vt=Pt.geometry,ht=Pt.text?Pt.text.toString():null;if(!ht){Ze(Ct);continue}const Mt=kt(ht,Vt),dt=kt(ht,Vt,!0);if(Mt in je&&dt in we&&je[Mt]!==we[dt]){const ft=pt(Mt,dt,Vt),$t=Qe(Mt,dt,Ve[ft].geometry);delete we[Mt],delete je[dt],je[kt(ht,Ve[$t].geometry,!0)]=$t,Ve[ft].geometry=null}else Mt in je?Qe(Mt,dt,Vt):dt in we?pt(Mt,dt,Vt):(Ze(Ct),we[Mt]=We-1,je[dt]=We-1)}return Ve.filter(Ct=>Ct.geometry)}(this.features)),w.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",o.elevationFeatures){!this.elevationFeatures&&o.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const xe of o.elevationFeatures)this.elevationFeatureIdToIndex.set(xe.id,this.elevationFeatures.length),this.elevationFeatures.push(xe)}}else w.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((xe,we)=>xe.sortKey-we.sortKey)}update(i,o,h,g,_,w,j){this.text.programConfigurations.updatePaintArrays(i,o,_,h,g,w,j),this.icon.programConfigurations.updatePaintArrays(i,o,_,h,g,w,j)}updateRoadElevation(){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let i=!1;for(let o=0;o<this.symbolInstances.length;o++){const h=this.symbolInstances.get(o);if(h.elevationFeatureIndex===65535)continue;const g=this.elevationFeatures[h.elevationFeatureIndex];if(g){const _=.05+g.pointElevation(new Kt(h.tileAnchorX,h.tileAnchorY));h.zOffset!==_&&(i=!0,h.zOffset=_)}}i&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const i=(_,w,j)=>{h+=w,h>_.length&&_.resize(h);for(let N=-w;N<0;N++)_.emplace(N+h,j)},o=(_,w,j)=>{g+=w,g>_.length&&_.resize(g);for(let N=-w;N<0;N++)_.emplace(N+g,j)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let h=0,g=0;for(let _=0;_<this.symbolInstances.length;_++){const w=this.symbolInstances.get(_),{numHorizontalGlyphVertices:j,numVerticalGlyphVertices:N,numIconVertices:O}=w,L=w.zOffset,B=O>0;if((j>0||N>0)&&(i(this.text.zOffsetVertexArray,j,L),i(this.text.zOffsetVertexArray,N,L)),B){const{placedIconSymbolIndex:q,verticalPlacedIconSymbolIndex:Y}=w;q>=0&&o(this.icon.zOffsetVertexArray,O,L),Y>=0&&o(this.icon.zOffsetVertexArray,w.numVerticalIconVertices,L)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=$I(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,o){const h=this.lineVertexArray.length;if(i.segment!==void 0)for(const{x:g,y:_}of o)this.lineVertexArray.emplaceBack(g,_);return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(i,o,h,g,_,w,j,N,O,L,B,q,Y,Q,re,he){const pe=i.indexArray,Se=i.layoutVertexArray,be=i.globeExtVertexArray,oe=i.segments.prepareSegment(4*o.length,Se,pe,this.canOverlap?w.sortKey:void 0),xe=this.glyphOffsetArray.length,we=oe.vertexLength,je=this.allowVerticalPlacement&&j===yc.vertical?Math.PI/2:0,Ve=w.text&&w.text.sections;for(let Ze=0;Ze<o.length;Ze++){const{tl:Qe,tr:pt,bl:kt,br:Ct,texPrimary:Pt,texSecondary:Vt,pixelOffsetTL:ht,pixelOffsetBR:Mt,minFontScaleX:dt,minFontScaleY:ft,glyphOffset:$t,isSDF:Gt,sectionIndex:Dn}=o[Ze],bn=oe.vertexLength,an=$t[1];if(q2(Se,O.x,O.y,Qe.x,an+Qe.y,Pt.x,Pt.y,h,Gt,ht.x,ht.y,dt,ft),q2(Se,O.x,O.y,pt.x,an+pt.y,Pt.x+Pt.w,Pt.y,h,Gt,Mt.x,ht.y,dt,ft),q2(Se,O.x,O.y,kt.x,an+kt.y,Pt.x,Pt.y+Pt.h,h,Gt,ht.x,Mt.y,dt,ft),q2(Se,O.x,O.y,Ct.x,an+Ct.y,Pt.x+Pt.w,Pt.y+Pt.h,h,Gt,Mt.x,Mt.y,dt,ft),N){const{x:Ut,y:sr,z:An}=N.anchor,[Cn,nr,dr]=N.up;G2(be,Ut,sr,An,Cn,nr,dr),G2(be,Ut,sr,An,Cn,nr,dr),G2(be,Ut,sr,An,Cn,nr,dr),G2(be,Ut,sr,An,Cn,nr,dr),W2(i.dynamicLayoutVertexArray,Ut,sr,An,je)}else W2(i.dynamicLayoutVertexArray,O.x,O.y,O.z,je);if(he){const Ut=Vt||Pt;H2(i.iconTransitioningVertexArray,Ut.x,Ut.y),H2(i.iconTransitioningVertexArray,Ut.x+Ut.w,Ut.y),H2(i.iconTransitioningVertexArray,Ut.x,Ut.y+Ut.h),H2(i.iconTransitioningVertexArray,Ut.x+Ut.w,Ut.y+Ut.h)}pe.emplaceBack(bn,bn+1,bn+2),pe.emplaceBack(bn+1,bn+2,bn+3),oe.vertexLength+=4,oe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack($t[0]),Ze!==o.length-1&&Dn===o[Ze+1].sectionIndex||i.programConfigurations.populatePaintArrays(Se.length,w,w.index,{},Y,Q,re,Ve&&Ve[Dn])}const We=N?N.anchor:O;i.placedSymbolArray.emplaceBack(We.x,We.y,We.z,O.x,O.y,xe,this.glyphOffsetArray.length-xe,we,L,B,O.segment,h?h[0]:0,h?h[1]:0,g[0],g[1],j,0,0,0,q,0)}_commitLayoutVertex(i,o,h,g,_,w,j){i.emplaceBack(o,h,g,_,w,Math.round(j.x),Math.round(j.y))}_addCollisionDebugVertices(i,o,h,g,_,w,j){const N=h.segments.prepareSegment(4,h.layoutVertexArray,h.indexArray),O=N.vertexLength,L=j.tileAnchorX,B=j.tileAnchorY;for(let Y=0;Y<4;Y++)h.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(h.collisionVertexArrayExt,o,i.padding,j.zOffset),this._commitLayoutVertex(h.layoutVertexArray,g,_,w,L,B,new Kt(i.x1,i.y1)),this._commitLayoutVertex(h.layoutVertexArray,g,_,w,L,B,new Kt(i.x2,i.y1)),this._commitLayoutVertex(h.layoutVertexArray,g,_,w,L,B,new Kt(i.x2,i.y2)),this._commitLayoutVertex(h.layoutVertexArray,g,_,w,L,B,new Kt(i.x1,i.y2)),N.vertexLength+=4;const q=h.indexArray;q.emplaceBack(O,O+1),q.emplaceBack(O+1,O+2),q.emplaceBack(O+2,O+3),q.emplaceBack(O+3,O),N.primitiveLength+=4}_addTextDebugCollisionBoxes(i,o,h,g,_,w){for(let j=g;j<_;j++){const N=h.get(j),O=this.getSymbolInstanceTextSize(i,w,o,j);this._addCollisionDebugVertices(N,O,this.textCollisionBox,N.projectedAnchorX,N.projectedAnchorY,N.projectedAnchorZ,w)}}_addIconDebugCollisionBoxes(i,o,h,g,_,w){for(let j=g;j<_;j++){const N=h.get(j),O=this.getSymbolInstanceIconSize(i,o,w.placedIconSymbolIndex);this._addCollisionDebugVertices(N,O,this.iconCollisionBox,N.projectedAnchorX,N.projectedAnchorY,N.projectedAnchorZ,w)}}generateCollisionDebugBuffers(i,o,h){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new SA(ol,iI.members,xu),this.iconCollisionBox=new SA(ol,iI.members,xu);const g=E1(this.iconSizeData,i),_=E1(this.textSizeData,i,h);for(let w=0;w<this.symbolInstances.length;w++){const j=this.symbolInstances.get(w);this._addTextDebugCollisionBoxes(_,i,o,j.textBoxStartIndex,j.textBoxEndIndex,j),this._addTextDebugCollisionBoxes(_,i,o,j.verticalTextBoxStartIndex,j.verticalTextBoxEndIndex,j),this._addIconDebugCollisionBoxes(g,i,o,j.iconBoxStartIndex,j.iconBoxEndIndex,j),this._addIconDebugCollisionBoxes(g,i,o,j.verticalIconBoxStartIndex,j.verticalIconBoxEndIndex,j)}}getSymbolInstanceTextSize(i,o,h,g){const _=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:g),w=mA(this.textSizeData,i,_)/As;return this.tilePixelRatio*w}getSymbolInstanceIconSize(i,o,h){const g=this.icon.placedSymbolArray.get(h),_=mA(this.iconSizeData,i,g);return this.tilePixelRatio*_}_commitDebugCollisionVertexUpdate(i,o,h,g){i.emplaceBack(o,-h,-h,g),i.emplaceBack(o,h,-h,g),i.emplaceBack(o,h,h,g),i.emplaceBack(o,-h,h,g)}_updateTextDebugCollisionBoxes(i,o,h,g,_,w,j){for(let N=g;N<_;N++){const O=h.get(N),L=this.getSymbolInstanceTextSize(i,w,o,N);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,L,O.padding,w.zOffset)}}_updateIconDebugCollisionBoxes(i,o,h,g,_,w,j){for(let N=g;N<_;N++){const O=h.get(N),L=this.getSymbolInstanceIconSize(i,o,w.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,L,O.padding,w.zOffset)}}updateCollisionDebugBuffers(i,o,h,g){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const _=E1(this.iconSizeData,i,g),w=E1(this.textSizeData,i,h);for(let j=0;j<this.symbolInstances.length;j++){const N=this.symbolInstances.get(j);this._updateTextDebugCollisionBoxes(w,i,o,N.textBoxStartIndex,N.textBoxEndIndex,N,h),this._updateTextDebugCollisionBoxes(w,i,o,N.verticalTextBoxStartIndex,N.verticalTextBoxEndIndex,N,h),this._updateIconDebugCollisionBoxes(_,i,o,N.iconBoxStartIndex,N.iconBoxEndIndex,N,g),this._updateIconDebugCollisionBoxes(_,i,o,N.verticalIconBoxStartIndex,N.verticalIconBoxEndIndex,N,g)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(i,o,h,g,_,w,j,N,O){const L={};if(o<h){const{x1:B,y1:q,x2:Y,y2:Q,padding:re,projectedAnchorX:he,projectedAnchorY:pe,projectedAnchorZ:Se,tileAnchorX:be,tileAnchorY:oe,featureIndex:xe}=i.get(o);L.textBox={x1:B,y1:q,x2:Y,y2:Q,padding:re,projectedAnchorX:he,projectedAnchorY:pe,projectedAnchorZ:Se,tileAnchorX:be,tileAnchorY:oe},L.textFeatureIndex=xe}if(g<_){const{x1:B,y1:q,x2:Y,y2:Q,padding:re,projectedAnchorX:he,projectedAnchorY:pe,projectedAnchorZ:Se,tileAnchorX:be,tileAnchorY:oe,featureIndex:xe}=i.get(g);L.verticalTextBox={x1:B,y1:q,x2:Y,y2:Q,padding:re,projectedAnchorX:he,projectedAnchorY:pe,projectedAnchorZ:Se,tileAnchorX:be,tileAnchorY:oe},L.verticalTextFeatureIndex=xe}if(w<j){const{x1:B,y1:q,x2:Y,y2:Q,padding:re,projectedAnchorX:he,projectedAnchorY:pe,projectedAnchorZ:Se,tileAnchorX:be,tileAnchorY:oe,featureIndex:xe}=i.get(w);L.iconBox={x1:B,y1:q,x2:Y,y2:Q,padding:re,projectedAnchorX:he,projectedAnchorY:pe,projectedAnchorZ:Se,tileAnchorX:be,tileAnchorY:oe},L.iconFeatureIndex=xe}if(N<O){const{x1:B,y1:q,x2:Y,y2:Q,padding:re,projectedAnchorX:he,projectedAnchorY:pe,projectedAnchorZ:Se,tileAnchorX:be,tileAnchorY:oe,featureIndex:xe}=i.get(N);L.verticalIconBox={x1:B,y1:q,x2:Y,y2:Q,padding:re,projectedAnchorX:he,projectedAnchorY:pe,projectedAnchorZ:Se,tileAnchorX:be,tileAnchorY:oe},L.verticalIconFeatureIndex=xe}return L}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const h=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(i,o){const h=i.placedSymbolArray.get(o),g=h.vertexStartIndex+4*h.numGlyphs;for(let _=h.vertexStartIndex;_<g;_+=4)i.indexArray.emplaceBack(_,_+1,_+2),i.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(i),h=Math.cos(i),g=[],_=[],w=[];for(let j=0;j<this.symbolInstances.length;++j){w.push(j);const N=this.symbolInstances.get(j);g.push(0|Math.round(o*N.tileAnchorX+h*N.tileAnchorY)),_.push(N.featureIndex)}return w.sort((j,N)=>g[j]-g[N]||_[N]-_[j]),w}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let i=0;i<this.symbolInstances.length;++i)this.symbolInstanceIndexesSortedZOffset.push(i)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((i,o)=>this.symbolInstances.get(o).zOffset-this.symbolInstances.get(i).zOffset)}addToSortKeyRanges(i,o){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===o?h.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const h=this.symbolInstances.get(o);this.featureSortOrder.push(h.featureIndex);const{rightJustifiedTextSymbolIndex:g,centerJustifiedTextSymbolIndex:_,leftJustifiedTextSymbolIndex:w,verticalPlacedTextSymbolIndex:j,placedIconSymbolIndex:N,verticalPlacedIconSymbolIndex:O}=h;g>=0&&this.addIndicesForPlacedSymbol(this.text,g),_>=0&&_!==g&&this.addIndicesForPlacedSymbol(this.text,_),w>=0&&w!==_&&w!==g&&this.addIndicesForPlacedSymbol(this.text,w),j>=0&&this.addIndicesForPlacedSymbol(this.text,j),N>=0&&this.addIndicesForPlacedSymbol(this.icon,N),O>=0&&this.addIndicesForPlacedSymbol(this.icon,O)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let qI,HI,TA;mn(Z2,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Z2.addDynamicAttributes=W2;class GI{constructor(i){this.type=i.property.overrides?i.property.overrides.runtimeType:qu,this.defaultValue=i}evaluate(i){if(i.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(i.formattedSection))return o.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}mn(GI,"FormatSectionOverride",{omit:["defaultValue"]});const EA=()=>TA||(TA={layout:qI||(qI=new Yi({"symbol-placement":new Xt(rt.layout_symbol["symbol-placement"]),"symbol-spacing":new Xt(rt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Xt(rt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new fn(rt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Xt(rt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Xt(rt.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Xt(rt.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Xt(rt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Xt(rt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Xt(rt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Xt(rt.layout_symbol["icon-rotation-alignment"]),"icon-size":new fn(rt.layout_symbol["icon-size"]),"icon-size-scale-range":new Xt(rt.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new fn(rt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new fn(rt.layout_symbol["icon-text-fit-padding"]),"icon-image":new fn(rt.layout_symbol["icon-image"]),"icon-rotate":new fn(rt.layout_symbol["icon-rotate"]),"icon-padding":new Xt(rt.layout_symbol["icon-padding"]),"icon-keep-upright":new Xt(rt.layout_symbol["icon-keep-upright"]),"icon-offset":new fn(rt.layout_symbol["icon-offset"]),"icon-anchor":new fn(rt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Xt(rt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Xt(rt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Xt(rt.layout_symbol["text-rotation-alignment"]),"text-field":new fn(rt.layout_symbol["text-field"]),"text-font":new fn(rt.layout_symbol["text-font"]),"text-size":new fn(rt.layout_symbol["text-size"]),"text-size-scale-range":new Xt(rt.layout_symbol["text-size-scale-range"]),"text-max-width":new fn(rt.layout_symbol["text-max-width"]),"text-line-height":new fn(rt.layout_symbol["text-line-height"]),"text-letter-spacing":new fn(rt.layout_symbol["text-letter-spacing"]),"text-justify":new fn(rt.layout_symbol["text-justify"]),"text-radial-offset":new fn(rt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Xt(rt.layout_symbol["text-variable-anchor"]),"text-anchor":new fn(rt.layout_symbol["text-anchor"]),"text-max-angle":new Xt(rt.layout_symbol["text-max-angle"]),"text-writing-mode":new Xt(rt.layout_symbol["text-writing-mode"]),"text-rotate":new fn(rt.layout_symbol["text-rotate"]),"text-padding":new Xt(rt.layout_symbol["text-padding"]),"text-keep-upright":new Xt(rt.layout_symbol["text-keep-upright"]),"text-transform":new fn(rt.layout_symbol["text-transform"]),"text-offset":new fn(rt.layout_symbol["text-offset"]),"text-allow-overlap":new Xt(rt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Xt(rt.layout_symbol["text-ignore-placement"]),"text-optional":new Xt(rt.layout_symbol["text-optional"]),visibility:new Xt(rt.layout_symbol.visibility)})),paint:HI||(HI=new Yi({"icon-opacity":new fn(rt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new fn(rt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new fn(rt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new fn(rt.paint_symbol["text-emissive-strength"]),"icon-color":new fn(rt.paint_symbol["icon-color"]),"icon-halo-color":new fn(rt.paint_symbol["icon-halo-color"]),"icon-halo-width":new fn(rt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new fn(rt.paint_symbol["icon-halo-blur"]),"icon-translate":new Xt(rt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Xt(rt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Xt(rt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new fn(rt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new fn(rt.paint_symbol["text-occlusion-opacity"]),"text-color":new fn(rt.paint_symbol["text-color"],{runtimeType:go,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new fn(rt.paint_symbol["text-halo-color"]),"text-halo-width":new fn(rt.paint_symbol["text-halo-width"]),"text-halo-blur":new fn(rt.paint_symbol["text-halo-blur"]),"text-translate":new Xt(rt.paint_symbol["text-translate"]),"text-translate-anchor":new Xt(rt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Xt(rt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Xt(rt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Xt(rt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Xt(rt.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new fn(rt.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},TA);class X2 extends Ls{constructor(i,o,h,g){super(i,EA(),o,h,g),this._colorAdjustmentMatrix=W([]),this.hasInitialOcclusionOpacityProperties=i.paint!==void 0&&("icon-occlusion-opacity"in i.paint||"text-occlusion-opacity"in i.paint)}recalculate(i,o){super.recalculate(i,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const h=this.layout.get("text-writing-mode");if(h){const g=[];for(const _ of h)g.indexOf(_)<0&&g.push(_);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(i,o,h,g){return this._saturation===i&&this._contrast===o&&this._brightnessMin===h&&this._brightnessMax===g||(this._colorAdjustmentMatrix=function(_,w,j,N){_=Fa(_),w=fa(w);const O=F(),L=_/3,B=1-2*L,q=[B,L,L,0,L,B,L,0,L,L,B,0,0,0,0,1],Y=.5-.5*w,Q=N-j;return Z(O,[Q,0,0,0,0,Q,0,0,0,0,Q,0,j,j,j,1],[w,0,0,0,0,w,0,0,0,0,w,0,Y,Y,Y,1]),Z(O,O,q),O}(i,o,h,g),this._saturation=i,this._contrast=o,this._brightnessMin=h,this._brightnessMax=g),this._colorAdjustmentMatrix}getValueAndResolveTokens(i,o,h,g){const _=this.layout.get(i).evaluate(o,{},h,g),w=this._unevaluatedLayout._values[i];return w.isDataDriven()||dc(w.value)||!_?_:function(j,N){return N.replace(/{([^{}]+)}/g,(O,L)=>L in j?String(j[L]):"")}(o.properties,_)}createBucket(i){return new Z2(i)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const i of EA().paint.overridableProperties){if(!X2.hasPaintOverride(this.layout,i))continue;const o=this.paint.get(i),h=new GI(o),g=new Bp(h,o.property.specification,this.scope,this.options);let _=null;_=o.value.kind==="constant"||o.value.kind==="source"?new Gi("source",g):new ja("composite",g,o.value.zoomStops,o.value.interpolationType),this.paint._values[i]=new _h(o.property,_,o.parameters)}}_handleOverridablePaintPropertyUpdate(i,o,h){return!(!this.layout||o.isDataDriven()||h.isDataDriven())&&X2.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,o){const h=i.get("text-field"),g=EA().paint.properties[o];let _=!1;const w=j=>{for(const N of j)if(g.overrides&&g.overrides.hasOverride(N))return void(_=!0)};if(h.value.kind==="constant"&&h.value.value instanceof Rs)w(h.value.value.sections);else if(h.value.kind==="source"){const j=O=>{_||(O instanceof pr&&pa(O.value)===vp?w(O.value.sections):O instanceof tc?w(O.sections):O.eachChild(j))},N=h.value;N._styleExpression&&j(N._styleExpression.expression)}return _}getProgramIds(){return["symbol"]}getDefaultProgramParams(i,o,h){return{config:new vu(this,{zoom:o,lut:h}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let WI,ZI,XI,KI;var AA=Vr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function CA(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function jA(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class MA{constructor(i,o,h,g){this.context=i,this.format=h,this.useMipmap=g&&g.useMipmap,this.texture=i.gl.createTexture(),this.update(o,{premultiply:g&&g.premultiply})}update(i,o){const h=i&&i instanceof HTMLVideoElement&&i.width===0?i.videoWidth:i.width,g=i&&i instanceof HTMLVideoElement&&i.height===0?i.videoHeight:i.height,{context:_}=this,{gl:w}=_,{x:j,y:N}=o&&o.position?o.position:{x:0,y:0},O=j+h,L=N+g;!this.size||this.size[0]===O&&this.size[1]===L||(w.bindTexture(w.TEXTURE_2D,null),w.deleteTexture(this.texture),this.texture=w.createTexture(),this.size=null),w.bindTexture(w.TEXTURE_2D,this.texture),_.pixelStoreUnpackFlipY.set(!1),_.pixelStoreUnpack.set(1),_.pixelStoreUnpackPremultiplyAlpha.set(this.format===w.RGBA8&&(!o||o.premultiply!==!1));const B=i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||ImageBitmap&&i instanceof ImageBitmap;if(!this.size&&O>0&&L>0){const q=this.useMipmap?Math.floor(Math.log2(Math.max(O,L)))+1:1;w.texStorage2D(w.TEXTURE_2D,q,this.format,O,L),this.size=[O,L]}if(this.size)if(B)w.texSubImage2D(w.TEXTURE_2D,0,j,N,CA(this.format),jA(this.format),i);else{const q=i.data;q&&w.texSubImage2D(w.TEXTURE_2D,0,j,N,h,g,CA(this.format),jA(this.format),q)}this.useMipmap&&w.generateMipmap(w.TEXTURE_2D)}bind(i,o,h=!1){const{context:g}=this,{gl:_}=g;_.bindTexture(_.TEXTURE_2D,this.texture),i!==this.minFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,i),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,this.useMipmap&&!h?i===_.NEAREST?_.NEAREST_MIPMAP_NEAREST:_.LINEAR_MIPMAP_LINEAR:i),this.minFilter=i),o!==this.wrapS&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,o),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,o),this.wrapS=o)}bindExtraParam(i,o,h,g){const{context:_}=this,{gl:w}=_;w.bindTexture(w.TEXTURE_2D,this.texture),o!==this.magFilter&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,o),this.magFilter=o),i!==this.minFilter&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,this.useMipmap?i===w.NEAREST?w.NEAREST_MIPMAP_NEAREST:w.LINEAR_MIPMAP_LINEAR:i),this.minFilter=i),h!==this.wrapS&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,h),this.wrapS=h),g!==this.wrapT&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,g),this.wrapT=g)}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class K2{constructor(i,o){this.context=i,this.texture=o}bind(i,o){const{context:h}=this,{gl:g}=h;g.bindTexture(g.TEXTURE_2D,this.texture),i!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,i),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,i),this.minFilter=i),o!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,o),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,o),this.wrapS=o)}}function Y2(c,i,o,h,g,_,w,j){const N=[c,i,1,o,h,1,g,_,1],O=[w,j,1],L=I([],N),[B,q,Y]=er(O,O,L);return R(N,N,[B,0,0,0,q,0,0,0,Y])}function YI(c,i,o,h,g,_,w,j){const N=function(O,L,B,q,Y,Q,re,he){const pe=Y2(0,0,1,0,1,1,0,1),Se=Y2(O,L,B,q,Y,Q,re,he);return R(Se,Se,I([],pe))}(c,i,o,h,g,_,w,j);return[N[2]/N[8]/en,N[5]/N[8]/en]}function Q2(c){return[c[0],Math.min(Math.max(c[1],-85.051129),et)]}class QI extends $u{constructor(i,o,h,g){super(),this.id=i,this.dispatcher=h,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(g),this.options=o,this._dirty=!1}load(i,o){if(this._loaded=o||!1,this.fire(new Mc("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return i&&(this.coordinates=i),this._loaded=!0,void this._finishLoading();this._imageRequest=Wd(this.map._requestManager.transformRequest(this.url,lf.Image),(h,g)=>{this._imageRequest=null,this._loaded=!0,h?this.fire(new gp(h)):g&&(this.image=g instanceof HTMLImageElement?tl.getImageData(g):g,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,i&&(this.coordinates=i),this._finishLoading())})}loaded(){return this._loaded}updateImage(i){return i.url?(this._imageRequest&&i.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=i.url,this.load(i.coordinates,this._loaded),this):this}setTexture(i){if(!(i.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new K2(this.map.painter.context,i.handle),this.width=i.dimensions[0],this.height=i.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Mc("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(i){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof K2||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(i){if(this.coordinates=i,this._boundsArray=void 0,this._unsupportedCoords=!1,!i.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let o=i[0][1],h=i[0][1];for(const _ of i)_[1]>h&&(h=_[1]),_[1]<o&&(o=_[1]);const g=(h+o)/2;if(g>et?this.onNorthPole=!0:g<-85.051129&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const _=i.map(lt.fromLngLat);this.tileID=function(w){let j=1/0,N=1/0,O=-1/0,L=-1/0;for(const re of w)j=Math.min(j,re.x),N=Math.min(N,re.y),O=Math.max(O,re.x),L=Math.max(L,re.y);const B=Math.max(O-j,L-N),q=Math.max(0,Math.floor(-Math.log(B)/Math.LN2)),Y=Math.pow(2,q);let Q=Math.floor((j+O)/2*Y);return Q>1&&(Q-=1),new bi(q,Q,Math.floor((N+L)/2*Y))}(_),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Mc("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(i){for(const pe in this.tiles){const Se=this.tiles[pe];Se.state!=="loaded"&&(Se.state="loaded",Se.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const o=j1(new bi(0,0,0),this.map.transform.projection),h=[o.projection.project(this.coordinates[0][0],this.coordinates[0][1]),o.projection.project(this.coordinates[1][0],this.coordinates[1][1]),o.projection.project(this.coordinates[2][0],this.coordinates[2][1]),o.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(pe){const Se=pe[1].x-pe[0].x,be=pe[1].y-pe[0].y,oe=pe[2].x-pe[1].x,xe=pe[2].y-pe[1].y,we=pe[3].x-pe[2].x,je=pe[3].y-pe[2].y,Ve=pe[0].x-pe[3].x,We=pe[0].y-pe[3].y,Ze=Se*xe-oe*be,Qe=oe*je-we*xe,pt=we*We-Ve*je,kt=Ve*be-Se*We;return Ze>0&&Qe>0&&pt>0&&kt>0||Ze<0&&Qe<0&&pt<0&&kt<0}(h))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const g=j1(this.tileID,this.map.transform.projection),[_,w,j,N]=this.coordinates.map(pe=>{const Se=g.projection.project(pe[0],pe[1]);return LI(g,Se)._round()});this.perspectiveTransform=YI(_.x,_.y,w.x,w.y,j.x,j.y,N.x,N.y);const O=this._boundsArray=new cd;O.emplaceBack(_.x,_.y,0,0),O.emplaceBack(w.x,w.y,en,0),O.emplaceBack(N.x,N.y,0,en),O.emplaceBack(j.x,j.y,en,en),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=i.createVertexBuffer(O,AA.members),this.boundsSegments=Wi.simpleSegment(0,0,4,2);const L=[],B=[Q2((q=this.coordinates)[0]),Q2(q[1]),Q2(q[2]),Q2(q[3])];var q;const[Y,Q,re,he]=function(pe){let Se=pe[0][0],be=Se,oe=pe[0][1],xe=oe;for(let we=1;we<pe.length;we++)pe[we][0]<Se?Se=pe[we][0]:pe[we][0]>be&&(be=pe[we][0]),pe[we][1]<oe?oe=pe[we][1]:pe[we][1]>xe&&(xe=pe[we][1]);return[Se,oe,be-Se,xe-oe]}(B);{const pe=new cd,[Se,be,oe,xe]=function(ht){let Mt=ht[0].x,dt=Mt,ft=ht[0].y,$t=ft;for(let Gt=1;Gt<ht.length;Gt++)ht[Gt].x<Mt?Mt=ht[Gt].x:ht[Gt].x>dt&&(dt=ht[Gt].x),ht[Gt].y<ft?ft=ht[Gt].y:ht[Gt].y>$t&&($t=ht[Gt].y);return[Mt,ft,dt-Mt,$t-ft]}(h),we=ht=>[(ht.x-Se)/oe,(ht.y-be)/xe],[je,Ve,We,Ze]=h.map(we),Qe=function(ht,Mt,dt,ft,$t,Gt,Dn,bn){const an=Y2(0,0,1,0,1,1,0,1);return R(an,an,I([],Y2(ht,Mt,dt,ft,$t,Gt,Dn,bn)))}(je[0],je[1],Ve[0],Ve[1],We[0],We[1],Ze[0],Ze[1]);this.elevatedGlobePerspectiveTransform=YI(je[0],je[1],Ve[0],Ve[1],We[0],We[1],Ze[0],Ze[1]);const pt=(ht,Mt)=>{L.push(ht.lng);const dt=Math.round((ht.lng-Y)/re*en),ft=Math.round((ht.lat-Q)/he*en),$t=we(Mt),Gt=er([],[$t[0],$t[1],1],Qe),Dn=Math.round(Gt[0]/Gt[2]*en),bn=Math.round(Gt[1]/Gt[2]*en);pe.emplaceBack(dt,ft,Dn,bn)},kt=h[3].x-h[0].x,Ct=h[3].y-h[0].y,Pt=h[2].x-h[1].x,Vt=h[2].y-h[1].y;for(let ht=0;ht<65;ht++){const Mt=ht/64,dt=[h[0].x+Mt*kt,h[0].y+Mt*Ct],ft=[h[1].x+Mt*Pt,h[1].y+Mt*Vt],$t=ft[0]-dt[0],Gt=ft[1]-dt[1];for(let Dn=0;Dn<65;Dn++){const bn=Dn/64,an={x:dt[0]+$t*bn,y:dt[1]+Gt*bn};pt(o.projection.unproject(an.x,an.y),an)}}this.elevatedGlobeVertexBuffer=i.createVertexBuffer(pe,AA.members)}{this.maxLongitudeTriangleSize=0;let pe=[],Se=new la;const be=(oe,xe,we)=>{Se.emplaceBack(oe,xe,we);const je=L[oe],Ve=L[xe],We=L[we],Ze=Math.min(Math.min(je,Ve),We),Qe=Math.max(Math.max(je,Ve),We)-Ze;Qe>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Qe),pe.push(Ze+Qe/2)};for(let oe=0;oe<64;oe++)for(let xe=0;xe<64;xe++){const we=65*oe+xe,je=we+1,Ve=we+65,We=Ve+1;be(we,Ve,je),be(je,Ve,We)}[pe,Se]=function(oe,xe){const we=Array.from({length:oe.length},(We,Ze)=>Ze);we.sort((We,Ze)=>oe[We]-oe[Ze]);const je=[],Ve=new la;for(let We=0;We<we.length;We++){const Ze=we[We];je.push(oe[Ze]);const Qe=3*Ze,pt=Qe+1;Ve.emplaceBack(xe.uint16[Qe],xe.uint16[pt],xe.uint16[pt+1])}return[je,Ve]}(pe,Se),this.elevatedGlobeTrianglesCenterLongitudes=pe,this.elevatedGlobeIndexBuffer=i.createIndexBuffer(Se)}this.elevatedGlobeSegments=Wi.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,re/en,0,he/en,0,0,Q,Y,0])}prepare(){const i=Object.keys(this.tiles).length!==0;if(this.tileID&&!i)return;const o=this.map.painter.context,h=o.gl;!this._dirty||this.texture instanceof K2||(this.texture?this.texture.update(this.image):(this.texture=new MA(o,this.image,h.RGBA8),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),i&&this._prepareData(o)}loadTile(i,o){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},o(null)):(i.state="errored",o(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(i){const o=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!o)return null;const h=this.elevatedGlobeTrianglesCenterLongitudes;let g=(_=i+180)+360*Math.round((h[0]-_)/360);var _;const w=new Wi,j=(B,q)=>{w.segments.push({vertexOffset:0,primitiveOffset:B,vertexLength:o.segments[0].vertexLength,primitiveLength:q,sortKey:void 0,vaos:{}})},N=.51*this.maxLongitudeTriangleSize;if(Math.abs(h[0]-g)<=N){const B=us(h,0,h.length,g+N);return B===h.length||j(B,qi(h,B+1,h.length,g+360-N)-B),w}g<h[0]&&(g+=360);const O=qi(h,0,h.length,g-N);if(O===h.length)return j(0,h.length),w;j(0,O-0);const L=us(h,O+1,h.length,g+N);return L!==h.length&&j(L,h.length-L),w}}const OQ=(Math.pow(256,2)-1)/16907520;class JI extends Ls{constructor(i,o,h,g){super(i,{layout:XI||(XI=new Yi({visibility:new Xt(rt.layout_raster.visibility)})),paint:KI||(KI=new Yi({"raster-opacity":new Xt(rt.paint_raster["raster-opacity"]),"raster-color":new Nl(rt.paint_raster["raster-color"]),"raster-color-mix":new Xt(rt.paint_raster["raster-color-mix"]),"raster-color-range":new Xt(rt.paint_raster["raster-color-range"]),"raster-hue-rotate":new Xt(rt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Xt(rt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Xt(rt.paint_raster["raster-brightness-max"]),"raster-saturation":new Xt(rt.paint_raster["raster-saturation"]),"raster-contrast":new Xt(rt.paint_raster["raster-contrast"]),"raster-resampling":new Xt(rt.paint_raster["raster-resampling"]),"raster-fade-duration":new Xt(rt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Xt(rt.paint_raster["raster-emissive-strength"]),"raster-array-band":new Xt(rt.paint_raster["raster-array-band"]),"raster-elevation":new Xt(rt.paint_raster["raster-elevation"]),"raster-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},o,h,g),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(i){return!(i&&i._source instanceof QI&&(i._source.onNorthPole||i._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(i){i!=="raster-color"&&i!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(i){if(!this.hasColorMap()||!this._curRampRange)return;const o=this._transitionablePaint._values["raster-color"].value.expression,[h,g]=i||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(h)&&isNaN(g)||h===this._curRampRange[0]&&g===this._curRampRange[1]||(this.colorRamp=Sg({expression:o,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:h,end:g}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[h,g])}}let ek,tk,nk,rk,ik;class ak extends Ls{constructor(i,o,h,g){super(i,{layout:ek||(ek=new Yi({visibility:new Xt(rt["layout_raster-particle"].visibility)})),paint:tk||(tk=new Yi({"raster-particle-array-band":new Xt(rt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Xt(rt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Nl(rt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Xt(rt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Xt(rt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Xt(rt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Xt(rt["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Xt(rt["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},o,h,g),this._updateColorRamp(),this.lastInvalidatedAt=tl.now()}onRemove(i){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(i){return!1}_handleSpecialPaintPropertyUpdate(i){i!=="raster-particle-color"&&i!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),i==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const i=this._transitionablePaint._values["raster-particle-color"].value.expression,o=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Sg({expression:i,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:o}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=tl.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class IQ extends Ls{constructor(i,o){super(i,{},o,null),this.implementation=i,i.slot&&(this.slot=i.slot)}is3D(i){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(i){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)}onRemove(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)}}function PA(c,i,o){const h=[0,0,1],g=Ds([]);return Hn(g,g,o?-te(c)+Math.PI:te(c)),Ft(g,g,-te(i)),hr(h,h,g),Mn(h,h)}function sk(c,i){const o=J2(c.projection,c.zoom,c.width,c.height),h=function(_,w,j,N,O){const L=new ue(j.lng-180*kg,j.lat),B=new ue(j.lng+180*kg,j.lat),q=_.project(L.lng,L.lat),Y=_.project(B.lng,B.lat),Q=-Math.atan2(Y.y-q.y,Y.x-q.x),re=lt.fromLngLat(j);re.y=Le(re.y,-1+kg,1-kg);const he=re.toLngLat(),pe=_.project(he.lng,he.lat),Se=lt.fromLngLat(he);Se.x+=kg;const be=Se.toLngLat(),oe=_.project(be.lng,be.lat),xe=lk(oe.x-pe.x,oe.y-pe.y,Q),we=lt.fromLngLat(he);we.y+=kg;const je=we.toLngLat(),Ve=_.project(je.lng,je.lat),We=lk(Ve.x-pe.x,Ve.y-pe.y,Q),Ze=Math.abs(xe.x)/Math.abs(We.y),Qe=W([]);se(Qe,Qe,-Q*(1-(O?0:N)));const pt=W([]);return ie(pt,pt,[1,1-(1-Ze)*N,1]),pt[4]=-We.x/We.y*N,se(pt,pt,Q),Z(pt,Qe,pt),pt}(c.projection,0,c.center,o,i),g=ok(c);return ie(h,h,[g,g,1]),h}function ok(c){const i=c.projection,o=J2(c.projection,c.zoom,c.width,c.height),h=NA(i,c.center),g=NA(i,ue.convert(i.center));return Math.pow(2,h*o+(1-o)*g)}function J2(c,i,o,h,g=1/0){const _=c.range;if(!_)return 0;const w=Math.min(g,Math.max(o,h)),j=Math.log(w/1024)/Math.LN2;return Ue(_[0]+j,_[1]+j,i)}const kg=1/4e4;function NA(c,i){const o=Le(i.lat,-85.051129,et),h=new ue(i.lng-180*kg,o),g=new ue(i.lng+180*kg,o),_=c.project(h.lng,o),w=c.project(g.lng,o),j=lt.fromLngLat(h),N=lt.fromLngLat(g),O=w.x-_.x,L=w.y-_.y,B=N.x-j.x,q=N.y-j.y,Y=Math.sqrt((B*B+q*q)/(O*O+L*L));return Math.log(Y)/Math.LN2}function lk(c,i,o){const h=Math.cos(o),g=Math.sin(o);return{x:c*h-i*g,y:c*g+i*h}}function ck(c,i,o){W(c),se(c,c,te(i[2])),ge(c,c,te(i[0])),ae(c,c,te(i[1])),ie(c,c,o),Z(c,c,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function eS(c,i,o,h,g,_,w,j){const N=[o[0]-i[0],o[1]-i[1],0],O=[h[0]-i[0],h[1]-i[1],0];if(jt(N)<1e-12||jt(O)<1e-12)return Ds(c);const L=Zn([],N,O);Mn(L,L),He(O,h,i),N[2]=(_-g)*j,O[2]=(w-g)*j;const B=N;return Zn(B,N,O),Mn(B,B),Ua(c,L,B)}function DA(c,i,o=!1){const h=Dh(i.zoom),g=function(_,w,j){const N=w.worldSize,O=[_[12],_[13],_[14]],L=$e(O[1]/N),B=Fe(O[0]/N),q=W([]),Y=Ce(1,L)*N,Q=Ce(1,0)*N*xt(L,w.zoom),re=1/Yy(N);let he=Q*re;if(j){const oe=J2(w.projection,w.zoom,w.width,w.height,1024);he=re*w.projection.pixelSpaceConversion(w.center.lat,N,oe)}const pe=de(L,B);vt(pe,pe,Ge([],Mn([],pe),Y*he*O[2]));const Se=function(oe){const xe=[oe[0],oe[1],oe[2]];let we=[0,1,0];const je=Zn([],we,xe);return Zn(we,xe,je),It(we)===0&&(we=[0,1,0],Zn(je,xe,we)),Mn(je,je),Mn(we,we),Mn(xe,xe),[je[0],je[1],je[2],0,we[0],we[1],we[2],0,xe[0],xe[1],xe[2],0,oe[0],oe[1],oe[2],1]}(pe);ie(q,q,[he,he,he*Y]),ne(q,q,[-O[0],-O[1],-O[2]]);const be=Z([],w.globeMatrix,Se);return Z(be,be,q),Z(be,be,_),be}(c,i,o);if(h>0){const _=function(w,j){const N=j.worldSize,O=Ce(1,0)*N*xt(j.center.lat,j.zoom)/Yy(N),L=Ce(1,j.center.lat)*N,B=W([]);return ae(B,B,te(j.center.lng)),ge(B,B,te(j.center.lat)),ne(B,B,[0,0,A]),ie(B,B,[O,O,O*L]),ne(B,B,[j.point.x-.5*N,j.point.y-.5*N,0]),Z(B,B,w),Z(B,j.globeMatrix,B)}(c,i);return function(w,j,N){const O=(Q,re,he)=>{const pe=jt(Q),Se=jt(re),be=wu(Q,re,he);return Ge(be,be,1/jt(be)*Vn(pe,Se,he))},L=O([w[0],w[1],w[2]],[j[0],j[1],j[2]],N),B=O([w[4],w[5],w[6]],[j[4],j[5],j[6]],N),q=O([w[8],w[9],w[10]],[j[8],j[9],j[10]],N),Y=wu([w[12],w[13],w[14]],[j[12],j[13],j[14]],N);return[L[0],L[1],L[2],0,B[0],B[1],B[2],0,q[0],q[1],q[2],0,Y[0],Y[1],Y[2],1]}(g,_,h)}return g}function uk(c,i,o,h){const g=hi.projectAabbCorners(h,o);let _=Number.MAX_VALUE,w=-1;for(let O=0;O<g.length;++O){const L=g[O];L[0]=(.5*L[0]+.5)*i.width,L[1]=(.5-.5*L[1])*i.height,L[2]<_&&(w=O,_=L[2])}const j=O=>new Kt(g[O][0],g[O][1]);let N;switch(w){case 0:case 6:N=[j(1),j(5),j(4),j(7),j(3),j(2),j(1)];break;case 1:case 7:N=[j(0),j(4),j(5),j(6),j(2),j(3),j(0)];break;case 3:case 5:N=[j(1),j(0),j(4),j(7),j(6),j(2),j(1)];break;default:N=[j(1),j(5),j(6),j(7),j(3),j(0),j(1)]}if(qn(c,N))return _}const kQ=Vr([{name:"a_pos_3f",components:3,type:"Float32"}]),RQ=Vr([{name:"a_color_3f",components:3,type:"Float32"}]),zQ=Vr([{name:"a_color_4f",components:4,type:"Float32"}]),LQ=Vr([{name:"a_uv_2f",components:2,type:"Float32"}]),FQ=Vr([{name:"a_normal_3f",components:3,type:"Float32"}]),BQ=Vr([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),VQ=Vr([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),dk={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class tS{constructor(i,o,h,g){this.message=(i?`${i}: `:"")+h,g&&(this.identifier=g),o!=null&&o.__line__&&(this.line=o.__line__)}}function OA(c,i){const o=c.indexOf("://")===-1;try{return new URL(c,o&&i?"http://example.com":void 0),!0}catch{return!1}}class hk{constructor(i,o){this.feature=i,this.instancedDataOffset=o,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class fk{constructor(){this.instancedDataArray=new Ph,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class IA{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.fqid),this.projection=i.projection,this.index=i.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=i.styleDefinedModelURLs}updateFootprints(i,o){}populate(i,o,h,g){this.tileToMeter=Je(h);const _=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:w,id:j,index:N,sourceLayerIndex:O}of i){const L=j??(w.properties&&w.properties.hasOwnProperty("id")?w.properties.id:void 0),B=Tn(w,_);if(!this.layers[0]._featureFilter.filter(new ui(this.zoom),B,h))continue;const q={id:L,sourceLayerIndex:O,index:N,geometry:_?B.geometry:yn(w,h,g),properties:w.properties,type:w.type,patterns:{}},Y=this.addFeature(q,q.geometry,B);Y&&o.featureIndex.insert(w,q.geometry,N,O,this.index,this.instancesPerModel[Y].instancedDataArray.length,en/32)}this.lookup=null}update(i,o,h,g){for(const _ in this.instancesPerModel){const w=this.instancesPerModel[_];for(const j in i)w.idToFeaturesIndex.hasOwnProperty(j)&&(this.evaluate(w.features[w.idToFeaturesIndex[j]],i[j],w,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let i=!1;for(const o in this.instancesPerModel){const h=this.instancesPerModel[o];for(const g of h.features){const _=this.layers[0],w=g.feature,j=this.canonical,N=_.paint.get("model-rotation").evaluate(w,{},j),O=_.paint.get("model-scale").evaluate(w,{},j),L=_.paint.get("model-translation").evaluate(w,{},j);dn(g.rotation,N)&&dn(g.scale,O)&&dn(g.translation,L)||(this.evaluate(g,g.featureStates,h,!0),i=!0)}}return i}updateReplacement(i,o,h,g){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const _=o.getReplacementRegionsForTile(i.toUnwrapped(),!0);if(jg(this.activeReplacements,_))return!1;this.activeReplacements=_;let w=!1;for(const j in this.instancesPerModel){const N=this.instancesPerModel[j],O=N.instancedDataArray;for(const L of N.features){const B=L.instancedDataOffset,q=L.instancedDataCount;for(let Y=0;Y<q;Y++){const Q=16*(Y+B);let re=O.float32[Q+0];const he=re>en;re=he?re-en:re;const pe=Math.floor(re),Se=O.float32[Q+1];let be=!1;for(const oe of this.activeReplacements)if(!Cg(oe,h,dk.Model,g)&&!(oe.min.x>pe||pe>oe.max.x||oe.min.y>Se||Se>oe.max.y)&&(be=g1(A2(pe,Se,i.canonical,oe.footprintTileId.canonical),oe.footprint),be))break;O.float32[Q]=be?re+en:re,w=w||be!==he}}}return w}isEmpty(){for(const i in this.instancesPerModel)if(this.instancesPerModel[i].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(i){if(!this.uploaded)for(const o in this.instancesPerModel){const h=this.instancesPerModel[o];h.instancedDataArray.length<0||h.instancedDataArray.length===0||(h.instancedDataBuffer?h.instancedDataBuffer.updateData(h.instancedDataArray):h.instancedDataBuffer=i.createVertexBuffer(h.instancedDataArray,BQ.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const o in this.instancesPerModel){const h=this.instancesPerModel[o];h.instancedDataArray.length!==0&&h.instancedDataBuffer&&h.instancedDataBuffer.destroy()}const i=this.layers[0].modelManager;if(i&&this.modelUris&&this.modelsRequested)for(const o of this.modelUris)i.removeModel(o,"",!0)}addFeature(i,o,h){const g=this.layers[0],_=g.layout.get("model-id").evaluate(h,{},this.canonical);if(!_)return or(`modelId is not evaluated for layer ${g.id} and it is not going to get rendered.`),_;(OA(_,!1)||this.styleDefinedModelURLs[_]!==void 0)&&(this.modelUris.includes(_)||this.modelUris.push(_)),this.instancesPerModel[_]||(this.instancesPerModel[_]=new fk);const w=this.instancesPerModel[_],j=w.instancedDataArray,N=new hk(h,j.length);for(const O of o)for(const L of O){if(L.x<0||L.x>=en||L.y<0||L.y>=en)continue;const B=(this.lookupDim-1)/en,q=this.lookupDim*(L.y*B|0)+L.x*B|0;if(this.lookup){if(this.lookup[q]!==0)continue;this.lookup[q]=1}this.instanceCount++;const Y=j.length;j.resize(Y+1),w.instancesEvaluatedElevation.push(0),j.float32[16*Y]=L.x,j.float32[16*Y+1]=L.y}return N.instancedDataCount=w.instancedDataArray.length-N.instancedDataOffset,N.instancedDataCount>0&&(i.id&&(w.idToFeaturesIndex[i.id]=w.features.length),w.features.push(N),this.evaluate(N,{},w,!1)),_}getModelUris(){return this.modelUris}evaluate(i,o,h,g){const _=this.layers[0],w=i.feature,j=this.canonical,N=i.rotation=_.paint.get("model-rotation").evaluate(w,o,j),O=i.scale=_.paint.get("model-scale").evaluate(w,o,j),L=i.translation=_.paint.get("model-translation").evaluate(w,o,j),B=_.paint.get("model-color").evaluate(w,o,j);B.a=_.paint.get("model-color-mix-intensity").evaluate(w,o,j);const q=[];this.maxVerticalOffset<L[2]&&(this.maxVerticalOffset=L[2]),this.maxScale=Math.max(Math.max(this.maxScale,O[0]),Math.max(O[1],O[2])),ck(q,N,O);const Y=Math.round(100*B.a)+B.b/1.05;for(let Q=0;Q<i.instancedDataCount;++Q){const re=i.instancedDataOffset+Q,he=16*re,pe=h.instancedDataArray.float32;let Se=0;g&&(Se=pe[he+6]-h.instancesEvaluatedElevation[re]);const be=0|pe[he+1];pe[he]=(0|pe[he])+B.r/1.05,pe[he+1]=be+B.g/1.05,pe[he+2]=Y,pe[he+3]=1/(j.z>10?this.tileToMeter:Je(j,be)),pe[he+4]=L[0],pe[he+5]=L[1],pe[he+6]=L[2]+Se,pe[he+7]=q[0],pe[he+8]=q[1],pe[he+9]=q[2],pe[he+10]=q[4],pe[he+11]=q[5],pe[he+12]=q[6],pe[he+13]=q[8],pe[he+14]=q[9],pe[he+15]=q[10],h.instancesEvaluatedElevation[re]=L[2]}}}let pk,mk;mn(IA,"ModelBucket",{omit:["layers"]}),mn(fk,"PerModelAttributes"),mn(hk,"ModelFeature");const M0=64,Mv={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function gk(c,i,o,h,g,_,w,j,N,O=!1){const L=o.zoom,B=o.project(h),q=xt(h.lat,L),Y=1/q;W(c),ne(c,c,[B.x+w[0]*Y,B.y+w[1]*Y,w[2]]);let Q=1,re=1;const he=o.worldSize;if(O){if(o.projection.name==="mercator"){let oe=0;o.elevation&&(oe=o.elevation.getAtPointOrZero(new lt(B.x/he,B.y/he),0));const xe=wa([],[B.x,B.y,oe,1],o.projMatrix)[3]/o.cameraToCenterDistance;Q=xe,re=xe*xt(o.center.lat,L)}else if(o.projection.name==="globe"){const oe=DA(c,o),xe=[0,0,0,1];wa(xe,xe,Z([],o.projMatrix,oe));const we=xe[3]/o.cameraToCenterDistance,je=Dh(L),Ve=o.projection.pixelsPerMeter(h.lat,he)*xt(h.lat,L),We=o.projection.pixelsPerMeter(o.center.lat,he)*xt(o.center.lat,L);Q=we/Vn(Ve,_t(o.center.lat),je),re=we*q/Ve,Q*=We,re*=We}}else Q=Y;ie(c,c,[Q,Q,re]);const pe=[...c],Se=i.orientation,be=[];if(ck(be,[Se[0]+g[0],Se[1]+g[1],Se[2]+g[2]],_),Z(c,pe,be),j&&o.elevation){let oe=0;const xe=[];if(N&&o.elevation){oe=function(je,Ve,We,Ze,Qe){const pt=Ve.elevation;if(!pt)return 0;const kt=hi.projectAabbCorners(We,Ze),Ct=Ce(1,Qe.lat)*Ve.worldSize,Pt=function(Ut,sr){const An=[0,0,1],Cn=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const nr of Cn){const dr=Ut[nr.corners[0]],fr=Ut[nr.corners[1]],wr=Ut[nr.corners[2]],yr=[fr[0]-dr[0],fr[1]-dr[1],sr*(fr[2]-dr[2])],mr=Zn(yr,yr,[wr[0]-dr[0],wr[1]-dr[1],sr*(wr[2]-dr[2])]);Mn(mr,mr),nr.dotProductWithUp=vn(mr,An)}return Cn.sort((nr,dr)=>nr.dotProductWithUp-dr.dotProductWithUp),Cn[0].corners}(kt,Ct),Vt=kt[Pt[0]],ht=kt[Pt[1]],Mt=kt[Pt[2]],dt=kt[Pt[3]],ft=pt.getAtPointOrZero(new lt(Vt[0]/Ve.worldSize,Vt[1]/Ve.worldSize),0),$t=pt.getAtPointOrZero(new lt(ht[0]/Ve.worldSize,ht[1]/Ve.worldSize),0),Gt=pt.getAtPointOrZero(new lt(Mt[0]/Ve.worldSize,Mt[1]/Ve.worldSize),0),Dn=pt.getAtPointOrZero(new lt(dt[0]/Ve.worldSize,dt[1]/Ve.worldSize),0),bn=(ft+Dn)/2,an=($t+Gt)/2;return bn>an?$t<Gt?eS(je,ht,dt,Vt,$t,Dn,ft,Ct):eS(je,Mt,Vt,dt,Gt,ft,Dn,Ct):ft<Dn?eS(je,Vt,ht,Mt,ft,$t,Gt,Ct):eS(je,dt,Mt,ht,Dn,Gt,$t,Ct),Math.max(bn,an)}(xe,o,i.aabb,c,h);const we=Z([],qe([],xe),be);Z(c,pe,we)}else oe=o.elevation.getAtPointOrZero(new lt(B.x/he,B.y/he),0);oe!==0&&(c[14]+=oe)}}function O1(c,i,o=!1){c.uploaded||(c.gfxTexture=new MA(i,c.image,o?i.gl.R8:i.gl.RGBA8,{useMipmap:c.sampler.minFilter>=i.gl.NEAREST_MIPMAP_NEAREST}),c.uploaded=!0,c.image=null)}function UQ(c,i,o){c.indexBuffer=i.createIndexBuffer(c.indexArray,!1,!0),c.vertexBuffer=i.createVertexBuffer(c.vertexArray,kQ.members,!1,!0),c.normalArray&&(c.normalBuffer=i.createVertexBuffer(c.normalArray,FQ.members,!1,!0)),c.texcoordArray&&(c.texcoordBuffer=i.createVertexBuffer(c.texcoordArray,LQ.members,!1,!0)),c.colorArray&&(c.colorBuffer=i.createVertexBuffer(c.colorArray,(c.colorArray.bytesPerElement===12?RQ:zQ).members,!1,!0)),c.featureArray&&(c.pbrBuffer=i.createVertexBuffer(c.featureArray,VQ.members,!0)),c.segments=Wi.simpleSegment(0,0,c.vertexArray.length,c.indexArray.length);const h=c.material;h.pbrMetallicRoughness.baseColorTexture&&O1(h.pbrMetallicRoughness.baseColorTexture,i),h.pbrMetallicRoughness.metallicRoughnessTexture&&O1(h.pbrMetallicRoughness.metallicRoughnessTexture,i),h.normalTexture&&O1(h.normalTexture,i),h.occlusionTexture&&O1(h.occlusionTexture,i,o),h.emissionTexture&&O1(h.emissionTexture,i)}function kA(c,i,o){if(c.meshes)for(const h of c.meshes)UQ(h,i,o);if(c.children)for(const h of c.children)kA(h,i,o)}function nS(c){if(c.meshes)for(const i of c.meshes)i.indexArray.destroy(),i.vertexArray.destroy(),i.colorArray&&i.colorArray.destroy(),i.normalArray&&i.normalArray.destroy(),i.texcoordArray&&i.texcoordArray.destroy(),i.featureArray&&i.featureArray.destroy();if(c.children)for(const i of c.children)nS(i)}function RA(c){if(c.meshes)for(const o of c.meshes)o.vertexBuffer&&(o.vertexBuffer.destroy(),o.indexBuffer.destroy(),o.normalBuffer&&o.normalBuffer.destroy(),o.texcoordBuffer&&o.texcoordBuffer.destroy(),o.colorBuffer&&o.colorBuffer.destroy(),o.pbrBuffer&&o.pbrBuffer.destroy(),o.segments.destroy(),o.material&&((i=o.material).pbrMetallicRoughness.baseColorTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),i.pbrMetallicRoughness.metallicRoughnessTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),i.normalTexture&&i.normalTexture.gfxTexture&&i.normalTexture.gfxTexture.destroy(),i.emissionTexture&&i.emissionTexture.gfxTexture&&i.emissionTexture.gfxTexture.destroy(),i.occlusionTexture&&i.occlusionTexture.gfxTexture&&i.occlusionTexture.gfxTexture.destroy()));var i;if(c.children)for(const o of c.children)RA(o)}class Pv{constructor(i,o,h){this._demTile=i,this._dem=this._demTile.dem,this._scale=o,this._offset=h}static create(i,o,h){const g=h||i.findDEMTileFor(o);if(!g||!g.dem)return;const _=g.dem,w=g.tileID,j=1<<o.canonical.z-w.canonical.z;return new Pv(g,_.dim/en/j,[(o.canonical.x/j-w.canonical.x)*_.dim,(o.canonical.y/j-w.canonical.y)*_.dim])}tileCoordToPixel(i,o){const h=o*this._scale+this._offset[1],g=Math.floor(i*this._scale+this._offset[0]),_=Math.floor(h);return new Kt(g,_)}getElevationAt(i,o,h,g){const _=i*this._scale+this._offset[0],w=o*this._scale+this._offset[1],j=Math.floor(_),N=Math.floor(w),O=this._dem;return g=!!g,h?Vn(Vn(O.get(j,N,g),O.get(j,N+1,g),w-N),Vn(O.get(j+1,N,g),O.get(j+1,N+1,g),w-N),_-j):O.get(j,N,g)}getElevationAtPixel(i,o,h){return this._dem.get(i,o,!!h)}getMeterToDEM(i){return(1<<this._demTile.tileID.canonical.z)*Ce(1,i)*this._dem.stride}}const zA=new Float32Array(262144),P0=new Uint8Array(262144);function xk(c){let i=0;if(c.meshes)for(const o of c.meshes)i=Math.max(i,o.aabb.max[2]);if(c.children)for(const o of c.children)i=Math.max(i,xk(o));return i}function yk(c,i,o){if(c.meshes)for(const h of c.meshes){if(h.aabb.min[0]===1/0)continue;const g=hi.applyTransform(h.aabb,c.matrix);o.insert(i,g.min[0],g.min[1],g.max[0],g.max[1])}if(c.children)for(const h of c.children)yk(h,i,o)}const vk=["","wall","door","roof","window","lamp","logo"];class _k{constructor(i){this.node=i,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:i.id,geometry:[],properties:{height:xk(i)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new hi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let i=0;const o=new hi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const h of this.node.meshes)this.node.lightMeshIndex!==i&&(h.transformedAabb=hi.applyTransformFast(h.aabb,this.node.matrix),o.encapsulate(h.transformedAabb)),i++;this.aabb=o}return this.aabb}}class rS{constructor(i,o,h,g,_,w,j){this.id=h,this.layers=i,this.layerIds=this.layers.map(N=>N.fqid),this.stateDependentLayerIds=this.layers.filter(N=>N.isStateDependent()).map(N=>N.id),this.modelTraits|=Mv.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,g&&(this.modelTraits|=Mv.HasMapboxMeshFeatures),_&&(this.modelTraits|=Mv.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=w,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const N of o)this.nodesInfo.push(new _k(N)),yk(N,j.featureIndexArray.length,j.grid),j.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,j.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(i,o){for(const h of this.getNodesInfo()){const g=h.node;g.footprint&&o.push({footprint:g.footprint,id:i})}}update(i){const o=Object.keys(i).length!==0;if(o&&!this.stateDependentLayers.length)return;const h=o?this.stateDependentLayers:this.layers;if(!el(i,this.states))for(const g of h)this.evaluate(g,i);this.states=structuredClone(i)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(i){if(!this.needsUpload)return;const o=this.getNodesInfo();for(const h of o){const g=h.node;this.uploaded?this.updatePbrBuffer(g):kA(g,i,!0)}for(const h of o)nS(h.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(i){let o=!1;if(!i.meshes)return o;for(const h of i.meshes)h.pbrBuffer&&(h.pbrBuffer.updateData(h.featureArray),o=!0);return o}needsReEvaluation(i,o,h){const g=i.transform.projectionOptions,_=i.style.getBrightness(),w=this.brightness!==_;if(!this.uploaded||this.dirty||g.name!==this.projection.name||I1(h.paint.get("model-color").value,w)||I1(h.paint.get("model-color-mix-intensity").value,w)||I1(h.paint.get("model-roughness").value,w)||I1(h.paint.get("model-emissive-strength").value,w)||I1(h.paint.get("model-height-based-emissive-strength-multiplier").value,w)){this.projection=g,this.brightness=_;const j=this.getNodesInfo();for(const N of j)N.state=null;return!0}return!1}evaluateScale(i,o){if(i.transform.zoom===this.zoom)return;this.zoom=i.transform.zoom;const h=this.getNodesInfo(),g=this.id.canonical;for(const _ of h){const w=_.feature;_.evaluatedScale=o.paint.get("model-scale").evaluate(w,{},g)}}evaluate(i,o){const h=this.getNodesInfo();for(const g of h){if(!g.node.meshes)continue;const _=g.feature,w=o&&o[_.id];if(el(w,g.state))continue;g.state=structuredClone(w);const j=g.node.meshes&&g.node.meshes[0].featureData,N=g.evaluatedColor[2],O=g.evaluatedRMEA[2],L=this.id.canonical;if(g.hasTranslucentParts=!1,j){for(let B=0;B<vk.length;B++){const q=vk[B];q.length&&(_.properties.part=q);const Y=i.paint.get("model-color").evaluate(_,w,L).toRenderColor(null),Q=i.paint.get("model-color-mix-intensity").evaluate(_,w,L);g.evaluatedColor[B]=[Y.r,Y.g,Y.b,Q],g.evaluatedRMEA[B][0]=i.paint.get("model-roughness").evaluate(_,w,L),g.evaluatedRMEA[B][2]=i.paint.get("model-emissive-strength").evaluate(_,w,L),g.evaluatedRMEA[B][3]=Y.a,g.emissionHeightBasedParams[B]=i.paint.get("model-height-based-emissive-strength-multiplier").evaluate(_,w,L),!g.hasTranslucentParts&&Y.a<1&&(g.hasTranslucentParts=!0)}delete _.properties.part,qQ(g,N!==g.evaluatedColor[2]||O!==g.evaluatedRMEA[2],this.modelTraits)}else g.evaluatedRMEA[0][2]=i.paint.get("model-emissive-strength").evaluate(_,w,L);g.evaluatedScale=i.paint.get("model-scale").evaluate(_,w,L),this.updatePbrBuffer(g.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(i,o,h,g){const _=i.findDEMTileFor(h);if(_&&(_.tileID.canonical!==this.terrainTile||o!==this.terrainExaggeration)){if(_.dem&&_.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=_.tileID.overscaledZ;const w=Pv.create(i,h,_);if(!w)return;this.modelTraits&Mv.HasMapboxMeshFeatures&&this.updateDEM(i,w,h,g);for(const j of this.getNodesInfo()){const N=j.node;if(!N.footprint||!N.footprint.vertices||!N.footprint.vertices.length)continue;const O=N.footprint.vertices;let L=w.getElevationAt(O[0].x,O[0].y,!0,!0);for(let B=1;B<O.length;B++)L=Math.min(L,w.getElevationAt(O[B].x,O[B].y,!0,!0));N.elevation=L}}this.terrainTile=_.tileID.canonical,this.terrainExaggeration=o}}updateDEM(i,o,h,g){let _=o._dem._modifiedForSources[g];if(_===void 0&&(o._dem._modifiedForSources[g]=[],_=o._dem._modifiedForSources[g]),_.includes(h.canonical))return;const w=o._dem.dim;_.push(h.canonical);let j=!1;for(const N of this.getNodesInfo()){const O=N.node;if(!O.footprint||!O.footprint.grid)continue;const L=O.footprint.grid,B=o.tileCoordToPixel(L.min.x,L.min.y),q=o.tileCoordToPixel(L.max.x,L.max.y),Y=Math.min(Math.min(w-q.y,B.x),Math.min(B.y,w-q.x));if(Y<0)continue;const Q=Le(Y,2,5);let re=Math.max(0,B.x-Q),he=Math.max(0,B.y-Q),pe=Math.min(q.x+Q,w-1),Se=Math.min(q.y+Q,w-1);for(let we=he;we<=Se;++we)for(let je=re;je<=pe;++je)P0[we*w+je]=255;let be=0,oe=0;for(let we=0;we<L.cellsY;++we)for(let je=0;je<L.cellsX;++je){if(!L.cells[we*L.cellsX+je])continue;const Ve=o.tileCoordToPixel(L.min.x+je/L.xScale,L.min.y+we/L.yScale),We=o.tileCoordToPixel(L.min.x+(je+1)/L.xScale,L.min.y+(we+1)/L.yScale);for(let Ze=Ve.y;Ze<=Math.min(We.y+1,w-1);++Ze)for(let Qe=Ve.x;Qe<=Math.min(We.x+1,w-1);++Qe)P0[Ze*w+Qe]===255&&(P0[Ze*w+Qe]=0,be+=o.getElevationAtPixel(Qe,Ze),oe++)}const xe=be/oe;re=Math.max(1,B.x-Q),he=Math.max(1,B.y-Q),pe=Math.min(q.x+Q,w-2),Se=Math.min(q.y+Q,w-2),j=!0;for(let we=he;we<=Se;++we)for(let je=re;je<=pe;++je)P0[we*w+je]===0&&(zA[we*w+je]=o._dem.set(je,we,xe));for(let we=1;we<Q;++we){re=Math.max(1,B.x-we),he=Math.max(1,B.y-we),pe=Math.min(q.x+we,w-2),Se=Math.min(q.y+we,w-2);for(let je=he;je<=Se;++je)for(let Ve=re;Ve<=pe;++Ve){const We=je*w+Ve;if(P0[We]===255){let Ze=0,Qe=0,pt=-1,kt=-1;for(let Ct=-1;Ct<=1;++Ct)for(let Pt=-1;Pt<=1;++Pt){const Vt=(je+Ct)*w+Ve+Pt;if(P0[Vt]>=we)continue;const ht=zA[Vt],Mt=Math.abs(ht);Mt>Qe&&(Ze=ht,Qe=Mt,pt=Pt,kt=Ct)}if(Qe>.1){const Ct=1-(we+.5*Math.abs(pt*kt))/Q;let Pt=o._dem.get(Ve,je)+Ze*Ct;const Vt=o._dem.get(Ve+pt,je+kt),ht=o._dem.get(Ve-pt,je-kt,!0);(Pt-Vt)*(Pt-ht)>0&&(Pt=(Vt+ht)/2),zA[We]=o._dem.set(Ve,je,Pt),P0[We]=we}}}}}j&&(o._demTile.needsDEMTextureUpload=!0,o._dem._timestamp=tl.now())}setFilter(i){this.filter=i?hg(i):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(i=>this.filter.filter(new ui(this.id.overscaledZ),i.feature,this.id.canonical)):this.nodesInfo}destroy(){const i=this.getNodesInfo();for(const o of i)nS(o.node),RA(o.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(i,o){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const h=o.getReplacementRegionsForTile(i.toUnwrapped()),g=this.getNodesInfo();for(let _=0;_<this.nodesInfo.length;_++){const w=g[_].node;g[_].hiddenByReplacement=!!w.footprint&&!h.find(j=>j.footprint===w.footprint)}}getHeightAtTileCoord(i,o){const h=this.getNodesInfo(),g=[],_=[0,0,0],w=W([]);for(let j=0;j<this.nodesInfo.length;j++){const N=h[j],O=N.node.meshes[0],L=O.transformedAabb;if(i<L.min[0]||o<L.min[1]||i>L.max[0]||o>L.max[1])continue;if(N.node.hidden===!0)return{height:1/0,maxHeight:N.feature.properties.height,hidden:!1,verticalScale:N.evaluatedScale[2]};$(w,N.node.matrix),_[0]=i,_[1]=o,un(_,_,w);const B=(_[0]-O.aabb.min[0])/(O.aabb.max[0]-O.aabb.min[0])*M0|0,q=Math.min(63,(_[1]-O.aabb.min[1])/(O.aabb.max[1]-O.aabb.min[1])*M0|0)*M0+Math.min(63,B),Y=O.heightmap[q];if(!(Y<0&&N.node.footprint))return N.hiddenByReplacement?void 0:{height:Y,maxHeight:N.feature.properties.height,hidden:!1,verticalScale:N.evaluatedScale[2]};if(N.node.footprint.grid.query(new Kt(i,o),new Kt(i,o),g),g.length>0)return{height:void 0,maxHeight:N.feature.properties.height,hidden:N.hiddenByReplacement,verticalScale:N.evaluatedScale[2]}}}}function I1(c,i){return c instanceof Gi&&!c.isLightConstant&&i}function $Q(c,i,o,h,g,_,w,j){let N=(61440&i|(61440&i)>>4)>>8,O=(3840&i|(3840&i)>>4)>>4,L=240&i|(240&i)>>4;o[3]>0&&(N=Vn(N,255*o[0],o[3]),O=Vn(O,255*o[1],o[3]),L=Vn(L,255*o[2],o[3]));const B=N<<8|O,q=L<<8|Math.floor(255*h[3]),Y=function(we){const je=Le(we,0,2);return Math.min(Math.round(.5*je*255),255)}(h[2])<<8|15*h[0]<<4|15*h[1],Q=Le(g[0],0,1),re=Le(g[1],0,1),he=Le(g[2],0,1),pe=Le(g[3],0,1);let Se,be,oe,xe;if(Q!==re&&w!==_&&re!==Q){const we=w-_;be=1/(we*(re-Q)),oe=-(_+we*Q)/(we*(re-Q));const je=Le(g[4],-1,1);xe=Math.pow(10,je),Se=255*he<<8|255*pe}else Se=65535,be=0,oe=1,xe=1;if(c.emplaceBack(B,q,Y,Se,be,oe,xe),j){const we=j.length;j.clear();for(let je=0;je<we;je++)j.emplaceBack(B,q,Y,Se,be,oe,xe)}}function qQ(c,i,o){const h=c.node;let g=0;const _=o&Mv.HasMeshoptCompression;for(const w of h.meshes){if(h.lights&&h.lightMeshIndex===g||!w.featureData)continue;w.featureArray=new Of,w.featureArray.reserve(w.featureData.length);let j=i;for(const N of w.featureData){const O=_?65535&N:N>>16&65535,L=_?N>>16&65535:65535&N,B=(15&L)<8?15&L:0,q=c.evaluatedRMEA[B],Y=c.evaluatedColor[B],Q=c.emissionHeightBasedParams[B];let re;if(j&&B===2&&h.lights&&(re=new Of,re.resize(10*h.lights.length)),$Q(w.featureArray,O,Y,q,Q,w.aabb.min[2],w.aabb.max[2],re),re&&j){j=!1;const he=h.meshes[h.lightMeshIndex];he.featureArray=re,he.featureArray._trim()}}w.featureArray._trim(),g++}}function bk(c,i,o,h){const g=1<<c.z;i.lat=$e((h/en+c.y)/g),i.lng=Fe((o/en+c.x)/g)}mn(rS,"Tiled3dModelBucket",{omit:["layers"]}),mn(_k,"Tiled3dModelFeature");const HQ={circle:class extends Ls{constructor(c,i,o,h){super(c,{layout:Hr||(Hr=new Yi({"circle-sort-key":new fn(rt.layout_circle["circle-sort-key"]),"circle-elevation-reference":new Xt(rt.layout_circle["circle-elevation-reference"]),visibility:new Xt(rt.layout_circle.visibility)})),paint:Di||(Di=new Yi({"circle-radius":new fn(rt.paint_circle["circle-radius"]),"circle-color":new fn(rt.paint_circle["circle-color"]),"circle-blur":new fn(rt.paint_circle["circle-blur"]),"circle-opacity":new fn(rt.paint_circle["circle-opacity"]),"circle-translate":new Xt(rt.paint_circle["circle-translate"]),"circle-translate-anchor":new Xt(rt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Xt(rt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Xt(rt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new fn(rt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new fn(rt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new fn(rt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Xt(rt.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},i,o,h)}createBucket(c){return new Sn(c)}queryRadius(c){const i=c;return rr("circle-radius",this,i)+rr("circle-stroke-width",this,i)+_i(this.paint.get("circle-translate"))}queryIntersectsFeature(c,i,o,h,g,_,w,j){const N=qr(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,c.pixelToTileUnitsFactor),O=this.paint.get("circle-radius").evaluate(i,o)+this.paint.get("circle-stroke-width").evaluate(i,o);return X_(c,h,_,w,j,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",N,O)}getProgramIds(){return["circle"]}getDefaultProgramParams(c,i,o){const h=o2(this);return{config:new vu(this,{zoom:i,lut:o}),defines:h,overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends Ls{createBucket(c){return new cm(c)}constructor(c,i,o,h){super(c,{layout:Jy||(Jy=new Yi({visibility:new Xt(rt.layout_heatmap.visibility)})),paint:c0||(c0=new Yi({"heatmap-radius":new fn(rt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new fn(rt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Xt(rt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Nl(rt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Xt(rt.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},i,o,h),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Sg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(c){return rr("heatmap-radius",this,c)}queryIntersectsFeature(c,i,o,h,g,_,w,j){const N=this.paint.get("heatmap-radius").evaluate(i,o);return X_(c,h,_,w,j,!0,!0,new Kt(0,0),N)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(c,i,o){return c==="heatmap"?{config:new vu(this,{zoom:i,lut:o}),overrideFog:!1}:{}}},hillshade:class extends Ls{constructor(c,i,o,h){super(c,{layout:ev||(ev=new Yi({visibility:new Xt(rt.layout_hillshade.visibility)})),paint:Ff||(Ff=new Yi({"hillshade-illumination-direction":new Xt(rt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Xt(rt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Xt(rt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Xt(rt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Xt(rt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Xt(rt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Xt(rt.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},i,o,h)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(c,i,o){return{overrideFog:!1}}},fill:class extends Ls{constructor(c,i,o,h){super(c,{layout:mm||(mm=new Yi({"fill-sort-key":new fn(rt.layout_fill["fill-sort-key"]),visibility:new Xt(rt.layout_fill.visibility),"fill-elevation-reference":new Xt(rt.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new fn(rt.layout_fill["fill-construct-bridge-guard-rail"])})),paint:Ag||(Ag=new Yi({"fill-antialias":new Xt(rt.paint_fill["fill-antialias"]),"fill-opacity":new fn(rt.paint_fill["fill-opacity"]),"fill-color":new fn(rt.paint_fill["fill-color"]),"fill-outline-color":new fn(rt.paint_fill["fill-outline-color"]),"fill-translate":new Xt(rt.paint_fill["fill-translate"]),"fill-translate-anchor":new Xt(rt.paint_fill["fill-translate-anchor"]),"fill-pattern":new fn(rt.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new Xt(rt.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new Xt(rt.paint_fill["fill-emissive-strength"]),"fill-z-offset":new fn(rt.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new fn(rt.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new fn(rt.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},i,o,h)}getProgramIds(){const c=this.paint.get("fill-pattern"),i=c&&c.constantOr(1),o=[i?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(i&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getDefaultProgramParams(c,i,o){return{config:new vu(this,{zoom:i,lut:o}),overrideFog:!1}}recalculate(c,i){super.recalculate(c,i);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new pv(c)}queryRadius(){return _i(this.paint.get("fill-translate"))}queryIntersectsFeature(c,i,o,h,g,_){return!c.queryGeometry.isAboveHorizon&&$n(kr(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,c.pixelToTileUnitsFactor),h)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(c){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const i=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return c!=null?i&&!c:i}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends Ls{constructor(c,i,o,h){super(c,{layout:Dg||(Dg=new Yi({visibility:new Xt(rt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Xt(rt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:Tv||(Tv=new Yi({"fill-extrusion-opacity":new Xt(rt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new fn(rt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Xt(rt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Xt(rt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new fn(rt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new Xt(rt["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new fn(rt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new fn(rt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Xt(rt["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Xt(rt["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Xt(rt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Xt(rt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Xt(rt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Xt(rt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Xt(rt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Xt(rt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Xt(rt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Xt(rt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new fn(rt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new fn(rt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Xt(rt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Xt(rt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Xt(rt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Xt(rt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new fn(rt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new fn(rt["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Xt(rt["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},i,o,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new wv(c)}queryRadius(){return _i(this.paint.get("fill-extrusion-translate"))}is3D(c){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(c,i,o,h,g,_,w,j,N){const O=qr(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,c.pixelToTileUnitsFactor),L=this.paint.get("fill-extrusion-height").evaluate(i,o),B=this.paint.get("fill-extrusion-base").evaluate(i,o),q=[0,0],Y=j&&_.elevation,Q=_.elevation?_.elevation.exaggeration():1,re=c.tile.getBucket(this);if(Y&&re instanceof wv){const oe=re.centroidVertexArray,xe=N+1;xe<oe.length&&(q[0]=oe.geta_centroid_pos0(xe),q[1]=oe.geta_centroid_pos1(xe))}if(q[0]===0&&q[1]===1)return!1;_.projection.name==="globe"&&(h=E0([h],[new Kt(0,0),new Kt(en,en)],c.tileID.canonical).map(oe=>oe.polygon).flat());const he=Y?j:null,[pe,Se]=function(oe,xe,we,je,Ve,We,Ze,Qe,pt,kt,Ct){return oe.projection.name==="globe"?function(Pt,Vt,ht,Mt,dt,ft,$t,Gt,Dn,bn,an){const Ut=[],sr=[],An=Pt.projection.upVectorScale(an,Pt.center.lat,Pt.worldSize).metersToTile,Cn=[0,0,0,1],nr=[0,0,0,1],dr=(wr,yr,mr,Ei)=>{wr[0]=yr,wr[1]=mr,wr[2]=Ei,wr[3]=1},fr=T0();ht>0&&(ht+=fr),Mt+=fr;for(const wr of Vt){const yr=[],mr=[];for(const Ei of wr){const zi=Ei.x+dt.x,Ae=Ei.y+dt.y,Ne=Pt.projection.projectTilePoint(zi,Ae,an),yt=Pt.projection.upVector(an,Ei.x,Ei.y);let Qt=ht,cn=Mt;if($t){const on=ee(zi,Ae,ht,Mt,$t,Gt,Dn,bn);Qt+=on.base,cn+=on.top}ht!==0?dr(Cn,Ne.x+yt[0]*An*Qt,Ne.y+yt[1]*An*Qt,Ne.z+yt[2]*An*Qt):dr(Cn,Ne.x,Ne.y,Ne.z),dr(nr,Ne.x+yt[0]*An*cn,Ne.y+yt[1]*An*cn,Ne.z+yt[2]*An*cn),un(Cn,Cn,ft),un(nr,nr,ft),yr.push(new _d(Cn[0],Cn[1],Cn[2])),mr.push(new _d(nr[0],nr[1],nr[2]))}Ut.push(yr),sr.push(mr)}return[Ut,sr]}(oe,xe,we,je,Ve,We,Ze,Qe,pt,kt,Ct):Ze?function(Pt,Vt,ht,Mt,dt,ft,$t,Gt,Dn){const bn=[],an=[],Ut=[0,0,0,1];for(const sr of Pt){const An=[],Cn=[];for(const nr of sr){const dr=nr.x+Mt.x,fr=nr.y+Mt.y,wr=ee(dr,fr,Vt,ht,ft,$t,Gt,Dn);Ut[0]=dr,Ut[1]=fr,Ut[2]=wr.base,Ut[3]=1,wa(Ut,Ut,dt),Ut[3]=Math.max(Ut[3],1e-5);const yr=new _d(Ut[0]/Ut[3],Ut[1]/Ut[3],Ut[2]/Ut[3]);Ut[0]=dr,Ut[1]=fr,Ut[2]=wr.top,Ut[3]=1,wa(Ut,Ut,dt),Ut[3]=Math.max(Ut[3],1e-5);const mr=new _d(Ut[0]/Ut[3],Ut[1]/Ut[3],Ut[2]/Ut[3]);An.push(yr),Cn.push(mr)}bn.push(An),an.push(Cn)}return[bn,an]}(xe,we,je,Ve,We,Ze,Qe,pt,kt):function(Pt,Vt,ht,Mt,dt){const ft=[],$t=[],Gt=dt[8]*Vt,Dn=dt[9]*Vt,bn=dt[10]*Vt,an=dt[11]*Vt,Ut=dt[8]*ht,sr=dt[9]*ht,An=dt[10]*ht,Cn=dt[11]*ht;for(const nr of Pt){const dr=[],fr=[];for(const wr of nr){const yr=wr.x+Mt.x,mr=wr.y+Mt.y,Ei=dt[0]*yr+dt[4]*mr+dt[12],zi=dt[1]*yr+dt[5]*mr+dt[13],Ae=dt[2]*yr+dt[6]*mr+dt[14],Ne=dt[3]*yr+dt[7]*mr+dt[15],yt=Ei+Gt,Qt=zi+Dn,cn=Ae+bn,on=Math.max(Ne+an,1e-5),Nn=Ei+Ut,Xn=zi+sr,Pr=Ae+An,Nr=Math.max(Ne+Cn,1e-5);dr.push(new _d(yt/on,Qt/on,cn/on)),fr.push(new _d(Nn/Nr,Xn/Nr,Pr/Nr))}ft.push(dr),$t.push(fr)}return[ft,$t]}(xe,we,je,Ve,We)}(_,h,B,L,O,w,he,q,Q,_.center.lat,c.tileID.canonical),be=c.queryGeometry;return function(oe,xe,we){let je=1/0;$n(we,xe)&&(je=G(we,xe[0]));for(let Ve=0;Ve<xe.length;Ve++){const We=xe[Ve],Ze=oe[Ve];for(let Qe=0;Qe<We.length-1;Qe++){const pt=We[Qe],kt=[pt,We[Qe+1],Ze[Qe+1],Ze[Qe],pt];qn(we,kt)&&(je=Math.min(je,G(we,kt)))}}return je!==1/0&&je}(pe,Se,be.isPointQuery()?be.screenBounds:be.screenGeometry)}},line:class extends Ls{constructor(c,i,o,h){const g=O2();super(c,g,i,o,h),g.layout&&(this.layout=new sd(g.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const i=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=i._styleExpression&&i._styleExpression.expression instanceof gf,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,i){super.recalculate(c,i),this.paint._values["line-floorwidth"]=(()=>{if(w1)return w1;const o=O2();return w1=new HY(o.paint.properties["line-width"].specification),w1.useIntegerZoom=!0,w1})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new At(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(c,i,o){const h=Bs(this);return{config:new vu(this,{zoom:i,lut:o}),defines:h,overrideFog:!1}}queryRadius(c){const i=c,o=rI(rr("line-width",this,i),rr("line-gap-width",this,i)),h=rr("line-offset",this,i);return o/2+Math.abs(h)+_i(this.paint.get("line-translate"))}queryIntersectsFeature(c,i,o,h,g,_){if(c.queryGeometry.isAboveHorizon)return!1;const w=kr(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,c.pixelToTileUnitsFactor),j=c.pixelToTileUnitsFactor/2*rI(this.paint.get("line-width").evaluate(i,o),this.paint.get("line-gap-width").evaluate(i,o)),N=this.paint.get("line-offset").evaluate(i,o);return N&&(h=function(O,L){const B=[],q=new Kt(0,0);for(let Y=0;Y<O.length;Y++){const Q=O[Y],re=[];for(let he=0;he<Q.length;he++){const pe=Q[he],Se=Q[he+1],be=he===0?q:pe.sub(Q[he-1])._unit()._perp(),oe=he===Q.length-1?q:Se.sub(pe)._unit()._perp(),xe=be._add(oe)._unit();xe._mult(1/(xe.x*oe.x+xe.y*oe.y)),re.push(xe._mult(L)._add(pe))}B.push(re)}return B}(h,N*c.pixelToTileUnitsFactor)),function(O,L,B){for(let q=0;q<L.length;q++){const Y=L[q];if(O.length>=3){for(let Q=0;Q<Y.length;Q++)if(Ur(O,Y[Q]))return!0}if(ur(O,Y,B))return!0}return!1}(w,h,j)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(c){return!this.hasElevatedBuckets}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:X2,background:class extends Ls{constructor(c,i,o,h){super(c,{layout:WI||(WI=new Yi({visibility:new Xt(rt.layout_background.visibility)})),paint:ZI||(ZI=new Yi({"background-pitch-alignment":new Xt(rt.paint_background["background-pitch-alignment"]),"background-color":new Xt(rt.paint_background["background-color"]),"background-pattern":new Xt(rt.paint_background["background-pattern"]),"background-opacity":new Xt(rt.paint_background["background-opacity"]),"background-emissive-strength":new Xt(rt.paint_background["background-emissive-strength"]),"background-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},i,o,h)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(c,i,o){return{overrideFog:!1}}is3D(c){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:JI,"raster-particle":ak,sky:class extends Ls{constructor(c,i,o,h){super(c,{layout:nk||(nk=new Yi({visibility:new Xt(rt.layout_sky.visibility)})),paint:rk||(rk=new Yi({"sky-type":new Xt(rt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Xt(rt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Xt(rt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Xt(rt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Xt(rt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Nl(rt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Xt(rt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Xt(rt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Xt(rt.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},i,o,h),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="sky-gradient"?this._updateColorRamp():c!=="sky-atmosphere-sun"&&c!=="sky-atmosphere-halo-color"&&c!=="sky-atmosphere-color"&&c!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Sg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const i=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==i.azimuthal||this._lightPosition.polar!==i.polar}return!1}getCenter(c,i){if(this.paint.get("sky-type")==="atmosphere"){const h=this.paint.get("sky-atmosphere-sun"),g=!h,_=c.style.light,w=_.properties.get("position");return g&&_.properties.get("anchor")==="viewport"&&or("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),g?PA(w.azimuthal,90-w.polar,i):PA(h[0],90-h[1],i)}const o=this.paint.get("sky-gradient-center");return PA(o[0],90-o[1],i)}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return c==="atmosphere"?["skyboxCapture","skybox"]:c==="gradient"?["skyboxGradient"]:null}},slot:class extends Ls{constructor(c,i,o,h){super(c,{paint:ik||(ik=new Yi({}))},i,null)}},model:class extends Ls{constructor(c,i,o,h){super(c,{layout:pk||(pk=new Yi({visibility:new Xt(rt.layout_model.visibility),"model-id":new fn(rt.layout_model["model-id"])})),paint:mk||(mk=new Yi({"model-opacity":new fn(rt.paint_model["model-opacity"]),"model-rotation":new fn(rt.paint_model["model-rotation"]),"model-scale":new fn(rt.paint_model["model-scale"]),"model-translation":new fn(rt.paint_model["model-translation"]),"model-color":new fn(rt.paint_model["model-color"]),"model-color-mix-intensity":new fn(rt.paint_model["model-color-mix-intensity"]),"model-type":new Xt(rt.paint_model["model-type"]),"model-cast-shadows":new Xt(rt.paint_model["model-cast-shadows"]),"model-receive-shadows":new Xt(rt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Xt(rt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new fn(rt.paint_model["model-emissive-strength"]),"model-roughness":new fn(rt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new fn(rt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Xt(rt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Xt(rt.paint_model["model-front-cutoff"]),"model-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},i,o,h),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new IA(c)}getProgramIds(){return["model"]}is3D(c){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(c){return c instanceof rS?en-1:0}queryIntersectsFeature(c,i,o,h,g,_){if(!this.modelManager)return!1;const w=this.modelManager,j=c.tile.getBucket(this);if(!(j&&j instanceof IA))return!1;for(const N in j.instancesPerModel){const O=j.instancesPerModel[N],L=i.id!==void 0?i.id:i.properties&&i.properties.hasOwnProperty("id")?i.properties.id:void 0;if(O.idToFeaturesIndex.hasOwnProperty(L)){const B=O.features[O.idToFeaturesIndex[L]],q=w.getModel(N,this.scope);if(!q)return!1;let Y=F();const Q=new ue(0,0),re=j.canonical;let he=Number.MAX_VALUE;for(let pe=0;pe<B.instancedDataCount;++pe){const Se=16*(B.instancedDataOffset+pe),be=O.instancedDataArray.float32,oe=[be[Se+4],be[Se+5],be[Se+6]];bk(re,Q,be[Se],0|be[Se+1]),gk(Y,q,_,Q,B.rotation,B.scale,oe,!1,!1,!1),_.projection.name==="globe"&&(Y=DA(Y,_));const xe=Z([],_.projMatrix,Y),we=c.queryGeometry,je=uk(we.isPointQuery()?we.screenBounds:we.screenGeometry,_,xe,q.aabb);je!=null&&(he=Math.min(je,he))}return he!==Number.MAX_VALUE&&he}}return!1}_handleOverridablePaintPropertyUpdate(c,i,o){return!(!this.layout||i.isDataDriven()||o.isDataDriven()||c!=="model-color"&&c!=="model-color-mix-intensity"&&c!=="model-rotation"&&c!=="model-scale"&&c!=="model-translation"&&c!=="model-emissive-strength")}_isPropertyZoomDependent(c){const i=this._transitionablePaint._values[c];return i!=null&&i.value!=null&&i.value.expression!=null&&i.value.expression instanceof ja}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends Ls{constructor(c,i,o,h){super(c,{layout:u1||(u1=new Yi({"clip-layer-types":new Xt(rt.layout_clip["clip-layer-types"]),"clip-layer-scope":new Xt(rt.layout_clip["clip-layer-scope"])})),paint:b2||(b2=new Yi({}))},i,o,h)}recalculate(c,i){super.recalculate(c,i)}createBucket(c){return new d1(c)}is3D(c){return!0}}};class GQ{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class WQ{constructor(){this.tasks={},this.taskQueue=[],Fn(["process"],this),this.invoker=new GQ(this.process),this.nextId=0}add(i,o){const h=this.nextId++,g=function({type:_,isSymbolTile:w,zoom:j}){return j=j||0,_==="message"?0:_!=="maybePrepare"||w?_!=="parseTile"||w?_==="parseTile"&&w?300-j:_==="maybePrepare"&&w?400-j:500:200-j:100-j}(o);if(g===0){try{i()}finally{}return null}return this.tasks[h]={fn:i,metadata:o,priority:g,id:h},this.taskQueue.push(h),this.invoker.trigger(),{cancel:()=>{delete this.tasks[h]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(h=>!!this.tasks[h]),!this.taskQueue.length)return;const i=this.pick();if(i===null)return;const o=this.tasks[i];if(delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let i=null,o=1/0;for(let g=0;g<this.taskQueue.length;g++){const _=this.tasks[this.taskQueue[g]];_.priority<o&&(o=_.priority,i=g)}if(i===null)return null;const h=this.taskQueue[i];return this.taskQueue.splice(i,1),h}remove(){this.invoker.remove()}}class wk{constructor(i,o,h){this.target=i,this.parent=o,this.mapId=h,this.callbacks={},this.cancelCallbacks={},Fn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new WQ}send(i,o,h,g,_=!1,w){const j=Math.round(1e18*Math.random()).toString(36).substring(0,10);h&&(h.metadata=w,this.callbacks[j]=h);const N=new Set;return this.target.postMessage({id:j,type:i,hasCallback:!!h,targetMapId:g,mustQueue:_,sourceMapId:this.mapId,data:hu(o,N)},N),{cancel:()=>{h&&delete this.callbacks[j],this.target.postMessage({id:j,type:"<cancel>",targetMapId:g,sourceMapId:this.mapId})}}}receive(i){const o=i.data;if(!o)return;const h=o.id;if(h&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){const g=this.cancelCallbacks[h];delete this.cancelCallbacks[h],g&&g.cancel()}else if(o.mustQueue||mi(self)){const g=this.callbacks[h],_=this.scheduler.add(()=>this.processTask(h,o),g&&g.metadata||{type:"message"});_&&(this.cancelCallbacks[h]=_)}else this.processTask(h,o)}processTask(i,o){if(delete this.cancelCallbacks[i],o.type==="<response>"){const h=this.callbacks[i];delete this.callbacks[i],h&&(o.error?h(rd(o.error)):h(null,rd(o.data)))}else{const h=new Set,g=o.hasCallback?(w,j)=>{this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:w?hu(w):null,data:hu(j,h)},h)}:()=>{},_=rd(o.data);if(this.parent[o.type])this.parent[o.type](o.sourceMapId,_,g);else if(this.parent.getWorkerSource){const w=o.type.split("."),{source:j,scope:N}=_;this.parent.getWorkerSource(o.sourceMapId,w[0],j,N)[w[1]](_,g)}else g(new Error(`Could not find function ${o.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var k1={workerUrl:"",workerClass:null,workerParams:void 0};const LA="mapboxgl_preloaded_worker_pool";class N0{constructor(){this.active={}}acquire(i,o=N0.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<o;)this.workers.push(k1.workerClass!=null?new k1.workerClass:new self.Worker(k1.workerUrl,k1.workerParams));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.workers&&this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[LA]}numActive(){return Object.keys(this.active).length}}N0.workerCount=2;class Nv{constructor(i,o,h="Worker",g=N0.workerCount){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=qt();const _=this.workerPool.acquire(this.id,g);for(let w=0;w<_.length;w++){const j=new Nv.Actor(_[w],o,this.id);j.name=`${h} ${w}`,this.actors.push(j)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(i,o,h){it(this.actors,(g,_)=>{g.send(i,o,_)},h=h||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(i=>{i.remove()}),this.actors=[],this.workerPool.release(this.id)}}let R1,FA;function iS(){return R1||(R1=new N0),R1}Nv.Actor=wk;const BA=new Kr(0,0,0),VA={PATH_RULE_NON_ZERO:1,PATH_RULE_EVEN_ODD:2},UA={LINE_CAP_BUTT:1,LINE_CAP_ROUND:2,LINE_CAP_SQUARE:3},aS={LINE_JOIN_MITER:1,LINE_JOIN_MITER_CLIP:2,LINE_JOIN_ROUND:3,LINE_JOIN_BEVEL:4},ZQ={PAINT_ORDER_FILL_AND_STROKE:1},z1={PATH_COMMAND_MOVE:1,PATH_COMMAND_LINE:2,PATH_COMMAND_QUAD:3,PATH_COMMAND_CUBIC:4,PATH_COMMAND_CLOSE:5},Sk={MASK_TYPE_LUMINANCE:1};function XQ(c,i,o){c===1&&i.icons.push(function(h,g){return function(_){if(_.usvg_tree.height||(_.usvg_tree.height=_.usvg_tree.width),!_.metadata)return _;const{metadata:w}=_;if(w.content_area){const{content_area:j}=w;j.top==null&&(j.top=j.left),j.width==null&&(j.width=_.usvg_tree.width),j.height==null&&(j.height=j.width)}return w.stretch_x&&w.stretch_x.length&&Tk(w,"x"),w.stretch_y&&w.stretch_y.length&&Tk(w,"y"),_}(h.readFields(KQ,{name:void 0},g))}(o,o.readVarint()+o.pos))}function Tk(c,i){const o=[],h=c[`stretch_${i}`];let g=null;for(let _=0;_<h.length;_++)g===null?g=o.length===0?h[0]:o[o.length-1][1]+h[_]:(o.push([g,g+h[_]]),g=null);c[`stretch_${i}_areas`]=o}function KQ(c,i,o){c===1?i.name=o.readString():c===2?i.metadata=function(h,g){return h.readFields(YQ,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},g)}(o,o.readVarint()+o.pos):c===3&&(i.usvg_tree=function(h,g){return h.readFields(eJ,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},g)}(o,o.readVarint()+o.pos),i.data="usvg_tree")}function YQ(c,i,o){c===1?i.stretch_x=o.readPackedVarint():c===2?i.stretch_y=o.readPackedVarint():c===3?i.content_area=function(h,g){return h.readFields(QQ,{left:0},g)}(o,o.readVarint()+o.pos):c===4&&i.variables.push(function(h,g){return h.readFields(JQ,{name:void 0},g)}(o,o.readVarint()+o.pos))}function QQ(c,i,o){c===1?i.left=o.readVarint():c===2?i.width=o.readVarint():c===3?i.top=o.readVarint():c===4&&(i.height=o.readVarint())}function JQ(c,i,o){c===1?i.name=o.readString():c===2&&(i.rgb_color=lS(o.readVarint()),i.value="rgb_color")}function eJ(c,i,o){c===1?i.width=i.height=o.readVarint():c===2?i.height=o.readVarint():c===3?i.children.push(sS(o,o.readVarint()+o.pos)):c===4?i.linear_gradients.push(function(h,g){return h.readFields(oJ,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},g)}(o,o.readVarint()+o.pos)):c===5?i.radial_gradients.push(function(h,g){return h.readFields(cJ,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},g)}(o,o.readVarint()+o.pos)):c===7?i.clip_paths.push(function(h,g){return h.readFields(uJ,{children:[]},g)}(o,o.readVarint()+o.pos)):c===8&&i.masks.push(function(h,g){const _=h.readFields(dJ,{left:0,width:20,mask_type:Sk.MASK_TYPE_LUMINANCE,children:[]},g);return _.height==null&&(_.height=_.width),_.top==null&&(_.top=_.left),_}(o,o.readVarint()+o.pos))}function sS(c,i){return c.readFields(tJ,{},i)}function tJ(c,i,o){c===1?(i.group=function(h,g){return h.readFields(nJ,{opacity:255,children:[]},g)}(o,o.readVarint()+o.pos),i.node="group"):c===2&&(i.path=function(h,g){return h.readFields(iJ,{paint_order:1,commands:[],step:1,diffs:[],rule:VA.PATH_RULE_NON_ZERO},g)}(o,o.readVarint()+o.pos),i.node="path")}function nJ(c,i,o){c===1?i.transform=oS(o,o.readVarint()+o.pos):c===2?i.opacity=o.readVarint():c===5?i.clip_path_idx=o.readVarint():c===6?i.mask_idx=o.readVarint():c===7&&i.children.push(sS(o,o.readVarint()+o.pos))}function oS(c,i){return c.readFields(rJ,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},i)}function rJ(c,i,o){c===1?i.sx=o.readFloat():c===2?i.ky=o.readFloat():c===3?i.kx=o.readFloat():c===4?i.sy=o.readFloat():c===5?i.tx=o.readFloat():c===6&&(i.ty=o.readFloat())}function iJ(c,i,o){c===1?i.fill=function(h,g){return h.readFields(aJ,{rgb_color:BA,paint:"rgb_color",opacity:255},g)}(o,o.readVarint()+o.pos):c===2?i.stroke=function(h,g){return h.readFields(sJ,{rgb_color:BA,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},g)}(o,o.readVarint()+o.pos):c===3?i.paint_order=o.readVarint():c===5?o.readPackedVarint(i.commands):c===6?i.step=o.readFloat():c===7?o.readPackedSVarint(i.diffs):c===8&&(i.rule=o.readVarint())}function aJ(c,i,o){c===1?(i.rgb_color=lS(o.readVarint()),i.paint="rgb_color"):c===2?(i.linear_gradient_idx=o.readVarint(),i.paint="linear_gradient_idx"):c===3?(i.radial_gradient_idx=o.readVarint(),i.paint="radial_gradient_idx"):c===5&&(i.opacity=o.readVarint())}function lS(c){return new Kr((c>>16&255)/255,(c>>8&255)/255,(255&c)/255,1)}function sJ(c,i,o){c===1?(i.rgb_color=lS(o.readVarint()),i.paint="rgb_color"):c===2?(i.linear_gradient_idx=o.readVarint(),i.paint="linear_gradient_idx"):c===3?(i.radial_gradient_idx=o.readVarint(),i.paint="radial_gradient_idx"):c===5?o.readPackedFloat(i.dasharray):c===6?i.dashoffset=o.readFloat():c===7?i.miterlimit=o.readFloat():c===8?i.opacity=o.readVarint():c===9?i.width=o.readFloat():c===10?i.linecap=o.readVarint():c===11&&(i.linejoin=o.readVarint())}function oJ(c,i,o){c===1?i.transform=oS(o,o.readVarint()+o.pos):c===2?i.spread_method=o.readVarint():c===3?i.stops.push(Ek(o,o.readVarint()+o.pos)):c===4?i.x1=o.readFloat():c===5?i.y1=o.readFloat():c===6?i.x2=o.readFloat():c===7&&(i.y2=o.readFloat())}function Ek(c,i){return c.readFields(lJ,{offset:0,opacity:255,rgb_color:BA},i)}function lJ(c,i,o){c===1?i.offset=o.readFloat():c===2?i.opacity=o.readVarint():c===3&&(i.rgb_color=lS(o.readVarint()))}function cJ(c,i,o){c===1?i.transform=oS(o,o.readVarint()+o.pos):c===2?i.spread_method=o.readVarint():c===3?i.stops.push(Ek(o,o.readVarint()+o.pos)):c===4?i.cx=o.readFloat():c===5?i.cy=o.readFloat():c===6?i.r=o.readFloat():c===7?i.fx=o.readFloat():c===8?i.fy=o.readFloat():c===9&&(i.fr=o.readFloat())}function uJ(c,i,o){c===1?i.transform=oS(o,o.readVarint()+o.pos):c===2?i.clip_path_idx=o.readVarint():c===3&&i.children.push(sS(o,o.readVarint()+o.pos))}function dJ(c,i,o){c===1?i.left=i.top=o.readFloat():c===2?i.width=i.height=o.readFloat():c===3?i.top=o.readFloat():c===4?i.height=o.readFloat():c===5?i.mask_type=o.readVarint():c===6?i.mask_idx=o.readVarint():c===7&&i.children.push(sS(o,o.readVarint()+o.pos))}class hJ{static calculate(i={},o=[]){const h=new Map,g=new Map;if(Object.keys(i).length===0)return h;o.forEach(_=>{g.set(_.name,_.rgb_color||new Kr(0,0,0))});for(const[_,w]of Object.entries(i))g.has(_)?h.set(g.get(_).toStringPremultipliedAlpha(),w):console.warn(`Ignoring unknown image variable "${_}"`);return h}}function Dv(c,i=255,o){const h=i/255,g=c.toStringPremultipliedAlpha(),_=o.has(g)?o.get(g).clone():c.clone();return _.a*=h,_.toString()}function L1(c,i){if(!Do()){const o=document.createElement("canvas");return o.width=c,o.height=i,o}return new OffscreenCanvas(c,i)}function fJ(c,i){const o=hJ.calculate(i.params,c.metadata?c.metadata.variables:[]),h=c.usvg_tree,g=h.width,_=h.height,w=i.transform?i.transform:new DOMMatrix,j=Math.max(1,Math.round(g*w.a)),N=Math.max(1,Math.round(_*w.d)),O=new DOMMatrix([j/g,0,0,N/_,0,0]),L=L1(j,N).getContext("2d");return $A(L,O,h,h,o),L.getImageData(0,0,j,N)}function $A(c,i,o,h,g){for(const _ of h.children)Ak(c,i,o,_,g)}function Ak(c,i,o,h,g){h.group?(c.save(),function(_,w,j,N,O){const L=N.mask_idx!=null?j.masks[N.mask_idx]:null,B=N.clip_path_idx!=null?j.clip_paths[N.clip_path_idx]:null;if(N.transform&&(w=cS(N.transform).preMultiplySelf(w)),!function(Q,re,he){return Q.opacity!==255||re||he}(N,B!=null,L!=null))return void $A(_,w,j,N,O);const q=L1(_.canvas.width,_.canvas.height),Y=q.getContext("2d");$A(Y,w,j,N,O),B&&Ok(Y,w,j,B),L&&Ik(Y,w,j,L,O),_.globalAlpha=N.opacity/255,_.drawImage(q,0,0)}(c,i,o,h.group,g),c.restore()):h.path&&(c.save(),function(_,w,j,N,O){const L=kk(N);_.setTransform(w),N.paint_order===ZQ.PAINT_ORDER_FILL_AND_STROKE?(Ck(_,j,N,L,O),Mk(_,j,N,L,O)):(Mk(_,j,N,L,O),Ck(_,j,N,L,O))}(c,i,o,h.path,g),c.restore())}function Ck(c,i,o,h,g){const _=o.fill;if(!_)return;const w=_.opacity/255;switch(_.paint){case"rgb_color":c.fillStyle=Dv(_.rgb_color,_.opacity,g);break;case"linear_gradient_idx":c.fillStyle=Pk(c,i.linear_gradients[_.linear_gradient_idx],w,g);break;case"radial_gradient_idx":c.fillStyle=Nk(c,i.radial_gradients[_.radial_gradient_idx],w,g)}c.fill(h,jk(o))}function jk(c){return c.rule===VA.PATH_RULE_NON_ZERO?"nonzero":c.rule===VA.PATH_RULE_EVEN_ODD?"evenodd":void 0}function Mk(c,i,o,h,g){const _=o.stroke;if(!_)return;c.lineWidth=_.width,c.miterLimit=_.miterlimit,c.setLineDash(_.dasharray),c.lineDashOffset=_.dashoffset;const w=_.opacity/255;switch(_.paint){case"rgb_color":c.strokeStyle=Dv(_.rgb_color,_.opacity,g);break;case"linear_gradient_idx":c.strokeStyle=Pk(c,i.linear_gradients[_.linear_gradient_idx],w,g);break;case"radial_gradient_idx":c.strokeStyle=Nk(c,i.radial_gradients[_.radial_gradient_idx],w,g)}switch(_.linejoin){case aS.LINE_JOIN_MITER_CLIP:case aS.LINE_JOIN_MITER:c.lineJoin="miter";break;case aS.LINE_JOIN_ROUND:c.lineJoin="round";break;case aS.LINE_JOIN_BEVEL:c.lineJoin="bevel"}switch(_.linecap){case UA.LINE_CAP_BUTT:c.lineCap="butt";break;case UA.LINE_CAP_ROUND:c.lineCap="round";break;case UA.LINE_CAP_SQUARE:c.lineCap="square"}c.stroke(h)}function Pk(c,i,o,h){if(i.stops.length===1){const q=i.stops[0];return Dv(q.rgb_color,q.opacity*o,h)}const g=cS(i.transform),{x1:_,y1:w,x2:j,y2:N}=i,O=g.transformPoint(new DOMPoint(_,w)),L=g.transformPoint(new DOMPoint(j,N)),B=c.createLinearGradient(O.x,O.y,L.x,L.y);for(const q of i.stops)B.addColorStop(q.offset,Dv(q.rgb_color,q.opacity*o,h));return B}function Nk(c,i,o,h){if(i.stops.length===1){const q=i.stops[0];return Dv(q.rgb_color,q.opacity*o,h)}const g=cS(i.transform),{fx:_,fy:w,cx:j,cy:N}=i,O=g.transformPoint(new DOMPoint(_,w)),L=g.transformPoint(new DOMPoint(j,N)),B=c.createRadialGradient(O.x,O.y,0,L.x,L.y,i.r*((g.a+g.d)/2));for(const q of i.stops)B.addColorStop(q.offset,Dv(q.rgb_color,q.opacity*o,h));return B}function Dk(c,i,o,h){const g=h.transform?cS(h.transform).preMultiplySelf(i):i,_=L1(c.canvas.width,c.canvas.height),w=_.getContext("2d");for(const N of h.children)if(N.group)Dk(w,g,o,N.group);else if(N.path){const O=N.path,L=new Path2D;L.addPath(kk(O),g),w.fill(L,jk(O))}const j=h.clip_path_idx!=null?o.clip_paths[h.clip_path_idx]:null;j&&Ok(w,g,o,j),c.globalCompositeOperation="source-over",c.drawImage(_,0,0)}function Ok(c,i,o,h){const g=L1(c.canvas.width,c.canvas.height);Dk(g.getContext("2d"),i,o,h),c.globalCompositeOperation="destination-in",c.drawImage(g,0,0)}function Ik(c,i,o,h,g){if(h.children.length===0)return;const _=h.mask_idx!=null?o.masks[h.mask_idx]:null;_&&Ik(c,i,o,_,g);const w=c.canvas.width,j=c.canvas.height,N=L1(w,j),O=N.getContext("2d"),L=h.width,B=h.height,q=h.left,Y=h.top,Q=new Path2D,re=new Path2D;re.rect(q,Y,L,B),Q.addPath(re,i),O.clip(Q);for(const Se of h.children)Ak(O,i,o,Se,g);const he=O.getImageData(0,0,w,j),pe=he.data;if(h.mask_type===Sk.MASK_TYPE_LUMINANCE)for(let Se=0;Se<pe.length;Se+=4)pe[Se+3]=pe[Se+3]/255*(.2126*pe[Se]+.7152*pe[Se+1]+.0722*pe[Se+2]);O.putImageData(he,0,0),c.globalCompositeOperation="destination-in",c.drawImage(N,0,0)}function cS(c){return c?new DOMMatrix([c.sx,c.ky,c.kx,c.sy,c.tx,c.ty]):new DOMMatrix}function kk(c){const i=new Path2D,o=c.step;let h=c.diffs[0]*o,g=c.diffs[1]*o;i.moveTo(h,g);for(let _=0,w=2;_<c.commands.length;_++)switch(c.commands[_]){case z1.PATH_COMMAND_MOVE:h+=c.diffs[w++]*o,g+=c.diffs[w++]*o,i.moveTo(h,g);break;case z1.PATH_COMMAND_LINE:h+=c.diffs[w++]*o,g+=c.diffs[w++]*o,i.lineTo(h,g);break;case z1.PATH_COMMAND_QUAD:{const j=h+c.diffs[w++]*o,N=g+c.diffs[w++]*o;h=j+c.diffs[w++]*o,g=N+c.diffs[w++]*o,i.quadraticCurveTo(j,N,h,g);break}case z1.PATH_COMMAND_CUBIC:{const j=h+c.diffs[w++]*o,N=g+c.diffs[w++]*o,O=j+c.diffs[w++]*o,L=N+c.diffs[w++]*o;h=O+c.diffs[w++]*o,g=L+c.diffs[w++]*o,i.bezierCurveTo(j,N,O,L,h,g);break}case z1.PATH_COMMAND_CLOSE:i.closePath()}return i}class uS{constructor(i){this.capacity=i,this.cache=new Map}get(i){if(!this.cache.has(i))return;const o=this.cache.get(i);return this.cache.delete(i),this.cache.set(i,o),o}put(i,o){this.cache.has(i)?this.cache.delete(i):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(i,o)}delete(i){this.cache.delete(i)}}mn(uS,"LRUCache");class qA{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(i){return new hs(i,i.data)}getFromCache(i,o,h){return this.cacheMap.has(h)||this.cacheMap.set(h,new uS(150)),this.cacheMap.get(h).get(ld(i.toString(),o))}setInCache(i,o,h,g){this.cacheDependenciesMap.has(g)||this.cacheDependenciesMap.set(g,new Map),this.cacheMap.has(g)||this.cacheMap.set(g,new uS(150));const _=this.cacheDependenciesMap.get(g),w=ld(i.id.toString(),h);_.get(w)||_.set(w,new Set);const j=this.cacheMap.get(g),N=i.toString();_.get(w).add(N),j.put(ld(i.toString(),h),o)}removeImagesFromCacheByIds(i,o,h=0){if(!this.cacheMap.has(h)||!this.cacheDependenciesMap.has(h))return;const g=this.cacheMap.get(h),_=this.cacheDependenciesMap.get(h);for(const w of i){const j=ld(w.toString(),o);if(_.has(j)){for(const N of _.get(j))g.delete(N);_.delete(j)}}}rasterize(i,o,h,g,_=fJ){const w=this.getFromCache(i,h,g);if(w)return w.clone();const j=_(o.icon,i.options),N=qA._getImage(j);return this.setInCache(i,N,h,g),N.clone()}}class Rk{constructor(i){this.size=i,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(i,o){const h=this.toIdx(i,o);return{min:this.minimums[h],max:this.maximums[h]}}isLeaf(i,o){return this.leaves[this.toIdx(i,o)]}toIdx(i,o){return o*this.size+i}}function zk(c,i,o,h){let g=0,_=Number.MAX_VALUE;for(let w=0;w<3;w++)if(Math.abs(h[w])<1e-15){if(o[w]<c[w]||o[w]>i[w])return null}else{const j=1/h[w];let N=(c[w]-o[w])*j,O=(i[w]-o[w])*j;if(N>O){const L=N;N=O,O=L}if(N>g&&(g=N),O<_&&(_=O),g>_)return null}return g}function Lk(c,i,o,h,g,_,w,j,N,O,L){const B=h-c,q=g-i,Y=_-o,Q=w-c,re=j-i,he=N-o,pe=L[1]*he-L[2]*re,Se=L[2]*Q-L[0]*he,be=L[0]*re-L[1]*Q,oe=B*pe+q*Se+Y*be;if(Math.abs(oe)<1e-15)return null;const xe=1/oe,we=O[0]-c,je=O[1]-i,Ve=O[2]-o,We=(we*pe+je*Se+Ve*be)*xe;if(We<0||We>1)return null;const Ze=je*Y-Ve*q,Qe=Ve*B-we*Y,pt=we*q-je*B,kt=(L[0]*Ze+L[1]*Qe+L[2]*pt)*xe;return kt<0||We+kt>1?null:(Q*Ze+re*Qe+he*pt)*xe}function Fk(c,i,o){return(c-i)/(o-i)}function Bk(c,i,o,h,g,_,w,j,N){const O=1<<o,L=_-h,B=w-g,q=(c+1)/O*L+h,Y=(i+0)/O*B+g,Q=(i+1)/O*B+g;j[0]=(c+0)/O*L+h,j[1]=Y,N[0]=q,N[1]=Q}class Vk{constructor(i){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=i,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=function(_){const w=Math.ceil(Math.log2(_.dim/8)),j=[];let N=Math.ceil(Math.pow(2,w));const O=1/N,L=(Y,Q,re,he,pe)=>{const Se=he?1:0,be=(Y+1)*re-Se,oe=Q*re,xe=(Q+1)*re-Se;pe[0]=Y*re,pe[1]=oe,pe[2]=be,pe[3]=xe};let B=new Rk(N);const q=[];for(let Y=0;Y<N*N;Y++){L(Y%N,Math.floor(Y/N),O,!1,q);const Q=Rg(q[0],q[1],_),re=Rg(q[2],q[1],_),he=Rg(q[2],q[3],_),pe=Rg(q[0],q[3],_);B.minimums.push(Math.min(Q,re,he,pe)),B.maximums.push(Math.max(Q,re,he,pe)),B.leaves.push(1)}for(j.push(B),N/=2;N>=1;N/=2){const Y=j[j.length-1];B=new Rk(N);for(let Q=0;Q<N*N;Q++){L(Q%N,Math.floor(Q/N),2,!0,q);const re=Y.getElevation(q[0],q[1]),he=Y.getElevation(q[2],q[1]),pe=Y.getElevation(q[2],q[3]),Se=Y.getElevation(q[0],q[3]),be=Y.isLeaf(q[0],q[1]),oe=Y.isLeaf(q[2],q[1]),xe=Y.isLeaf(q[2],q[3]),we=Y.isLeaf(q[0],q[3]),je=Math.min(re.min,he.min,pe.min,Se.min),Ve=Math.max(re.max,he.max,pe.max,Se.max),We=be&&oe&&xe&&we;B.maximums.push(Ve),B.minimums.push(je),B.leaves.push(Ve-je<=5&&We?1:0)}j.push(B)}return j}(this.dem),h=o.length-1,g=o[h];this._addNode(g.minimums[0],g.maximums[0],g.leaves[0]),this._construct(o,0,0,h,0)}raycastRoot(i,o,h,g,_,w,j=1){return zk([i,o,-100],[h,g,this.maximums[0]*j],_,w)}raycast(i,o,h,g,_,w,j=1){if(!this.nodeCount)return null;const N=this.raycastRoot(i,o,h,g,_,w,j);if(N==null)return null;const O=[],L=[],B=[],q=[],Y=[{idx:0,t:N,nodex:0,nodey:0,depth:0}];for(;Y.length>0;){const{idx:Q,t:re,nodex:he,nodey:pe,depth:Se}=Y.pop();if(this.leaves[Q]){Bk(he,pe,Se,i,o,h,g,B,q);const oe=1<<Se,xe=(he+0)/oe,we=(he+1)/oe,je=(pe+0)/oe,Ve=(pe+1)/oe,We=Rg(xe,je,this.dem)*j,Ze=Rg(we,je,this.dem)*j,Qe=Rg(we,Ve,this.dem)*j,pt=Rg(xe,Ve,this.dem)*j,kt=Lk(B[0],B[1],We,q[0],B[1],Ze,q[0],q[1],Qe,_,w),Ct=Lk(q[0],q[1],Qe,B[0],q[1],pt,B[0],B[1],We,_,w),Pt=Math.min(kt!==null?kt:Number.MAX_VALUE,Ct!==null?Ct:Number.MAX_VALUE);if(Pt!==Number.MAX_VALUE)return Pt;{const Vt=ot([],_,w,re);if(Uk(We,Ze,pt,Qe,Fk(Vt[0],B[0],q[0]),Fk(Vt[1],B[1],q[1]))>=Vt[2])return re}continue}let be=0;for(let oe=0;oe<this._siblingOffset.length;oe++){Bk((he<<1)+this._siblingOffset[oe][0],(pe<<1)+this._siblingOffset[oe][1],Se+1,i,o,h,g,B,q),B[2]=-100,q[2]=this.maximums[this.childOffsets[Q]+oe]*j;const xe=zk(B,q,_,w);if(xe!=null){const we=xe;O[oe]=we;let je=!1;for(let Ve=0;Ve<be&&!je;Ve++)we>=O[L[Ve]]&&(L.splice(Ve,0,oe),je=!0);je||(L[be]=oe),be++}}for(let oe=0;oe<be;oe++){const xe=L[oe];Y.push({idx:this.childOffsets[Q]+xe,t:O[xe],nodex:(he<<1)+this._siblingOffset[xe][0],nodey:(pe<<1)+this._siblingOffset[xe][1],depth:Se+1})}}return null}_addNode(i,o,h){return this.minimums.push(i),this.maximums.push(o),this.leaves.push(h),this.childOffsets.push(0),this.nodeCount++}_construct(i,o,h,g,_){if(i[g].isLeaf(o,h)===1)return;this.childOffsets[_]||(this.childOffsets[_]=this.nodeCount);const w=g-1,j=i[w];let N=0,O=0;for(let L=0;L<this._siblingOffset.length;L++){const B=2*o+this._siblingOffset[L][0],q=2*h+this._siblingOffset[L][1],Y=j.getElevation(B,q),Q=j.isLeaf(B,q),re=this._addNode(Y.min,Y.max,Q);Q&&(N|=1<<L),O||(O=re)}for(let L=0;L<this._siblingOffset.length;L++)N&1<<L||this._construct(i,2*o+this._siblingOffset[L][0],2*h+this._siblingOffset[L][1],w,O+L)}}function Uk(c,i,o,h,g,_){return Vn(Vn(c,o,_),Vn(i,h,_),g)}function Rg(c,i,o){const h=o.dim,g=Le(c*h-.5,0,h-1),_=Le(i*h-.5,0,h-1),w=Math.floor(g),j=Math.floor(_),N=Math.min(w+1,h-1),O=Math.min(j+1,h-1);return Uk(o.get(w,j),o.get(N,j),o.get(w,O),o.get(N,O),g-w,_-j)}const pJ={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function mJ(c,i,o){return(256*c*256+256*i+o)/10-1e4}function gJ(c,i,o){return 256*c+i+o/256-32768}class dS{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(i,o,h,g=!1){if(this.uid=i,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(h&&h!=="mapbox"&&h!=="terrarium")return void or(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const _=this.dim=o.height-2,w=new Uint32Array(o.data.buffer);if(this.pixels=new Uint8Array(o.data.buffer),this.floatView=new Float32Array(o.data.buffer),this.borderReady=g,this._modifiedForSources={},!g){for(let N=0;N<_;N++)w[this._idx(-1,N)]=w[this._idx(0,N)],w[this._idx(_,N)]=w[this._idx(_-1,N)],w[this._idx(N,-1)]=w[this._idx(N,0)],w[this._idx(N,_)]=w[this._idx(N,_-1)];w[this._idx(-1,-1)]=w[this._idx(0,0)],w[this._idx(_,-1)]=w[this._idx(_-1,0)],w[this._idx(-1,_)]=w[this._idx(0,_-1)],w[this._idx(_,_)]=w[this._idx(_-1,_-1)]}const j=h==="terrarium"?gJ:mJ;for(let N=0;N<w.length;++N){const O=4*N;this.floatView[N]=j(this.pixels[O],this.pixels[O+1],this.pixels[O+2])}this._timestamp=tl.now()}_buildQuadTree(){this._tree=new Vk(this)}get(i,o,h=!1){h&&(i=Le(i,-1,this.dim),o=Le(o,-1,this.dim));const g=this._idx(i,o);return this.floatView[g]}set(i,o,h){const g=this._idx(i,o),_=this.floatView[g];return this.floatView[g]=h,h-_}static getUnpackVector(i){return pJ[i]}_idx(i,o){if(i<-1||i>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(i+1)}static pack(i,o){const h=[0,0,0,0],g=dS.getUnpackVector(o);let _=Math.floor((i+g[3])/g[2]);return h[2]=_%256,_=Math.floor(_/256),h[1]=_%256,_=Math.floor(_/256),h[0]=_,h}getPixels(){return new Y_({width:this.stride,height:this.stride},this.pixels)}backfillBorder(i,o,h){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let g=o*this.dim,_=o*this.dim+this.dim,w=h*this.dim,j=h*this.dim+this.dim;switch(o){case-1:g=_-1;break;case 1:_=g+1}switch(h){case-1:w=j-1;break;case 1:j=w+1}const N=-o*this.dim,O=-h*this.dim;for(let L=w;L<j;L++)for(let B=g;B<_;B++){const q=4*this._idx(B,L),Y=4*this._idx(B+N,L+O);this.pixels[q+0]=i.pixels[Y+0],this.pixels[q+1]=i.pixels[Y+1],this.pixels[q+2]=i.pixels[Y+2],this.pixels[q+3]=i.pixels[Y+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function xJ(c,i,o){c===1?i.headerLength=o.readFixed32():c===2?i.x=o.readVarint():c===3?i.y=o.readVarint():c===4?i.z=o.readVarint():c===5&&i.layers.push(function(h,g){return h.readFields(wJ,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},g)}(o,o.readVarint()+o.pos))}function yJ(c,i,o){c===1?(i.delta_filter=function(h,g){return h.readFields(vJ,{blockSize:0},g)}(o,o.readVarint()+o.pos),i.filter="delta_filter"):c===2?(o.readVarint(),i.filter="zigzag_filter"):c===3?(o.readVarint(),i.filter="bitshuffle_filter"):c===4&&(o.readVarint(),i.filter="byteshuffle_filter")}function vJ(c,i,o){c===1&&(i.blockSize=o.readVarint())}function _J(c,i,o){c===1?(o.readVarint(),i.codec="gzip_data"):c===2?(o.readVarint(),i.codec="jpeg_image"):c===3?(o.readVarint(),i.codec="webp_image"):c===4&&(o.readVarint(),i.codec="png_image")}function bJ(c,i,o){let h=0,g=0;c===1?i.firstByte=o.readFixed64():c===2?i.lastByte=o.readFixed64():c===3?i.filters.push(function(_,w){return _.readFields(yJ,{},w)}(o,o.readVarint()+o.pos)):c===4?i.codec=function(_,w){return _.readFields(_J,{},w)}(o,o.readVarint()+o.pos):c===5?g=o.readFloat():c===6?h=o.readFloat():c===7?i.bands.push(o.readString()):c===8?i.offset=o.readDouble():c===9&&(i.scale=o.readDouble()),i.offset===0&&(i.offset=g),i.scale===0&&(i.scale=h)}function wJ(c,i,o){c===1?i.version=o.readVarint():c===2?i.name=o.readString():c===3?i.units=o.readString():c===4?i.tileSize=o.readVarint():c===5?i.buffer=o.readVarint():c===6?i.pixelFormat=o.readVarint():c===7&&i.dataIndex.push(function(h,g){return h.readFields(bJ,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},g)}(o,o.readVarint()+o.pos))}function SJ(c,i,o){if(c===2)(function(h,g,_){h.readFields(TJ,_,g)})(o,o.readVarint()+o.pos,i);else if(c===3)throw new Error("Not implemented")}function TJ(c,i,o){if(c===1){let h=0;const g=o.readVarint()+o.pos;for(;o.pos<g;)i[h++]=o.readVarint()}}function EJ(c,i){if(i.length!==4)throw new Error(`Expected data of dimension 4 but got ${i.length}.`);let o=i[3];for(let h=2;h>=1;h--){const g=h===1?1:0,_=h===2?1:0;for(let w=0;w<i[0];w++){const j=i[1]*w;for(let N=g;N<i[1];N++){const O=i[2]*(N+j);for(let L=_;L<i[2];L++){const B=i[3]*(L+O);for(let q=0;q<i[3];q++){const Y=B+q;c[Y]+=c[Y-o]}}}}o*=i[h]}return c}function AJ(c){for(let i=0,o=c.length;i<o;i++)c[i]=c[i]>>>1^-(1&c[i]);return c}function CJ(c,i){switch(i){case"uint32":return c;case"uint16":for(let o=0;o<c.length;o+=2){const h=c[o],g=c[o+1];c[o]=(240&h)>>4|(61440&h)>>8|(240&g)<<4|61440&g,c[o+1]=15&h|(3840&h)>>4|(15&g)<<8|(3840&g)<<4}return c;case"uint8":for(let o=0;o<c.length;o+=4){const h=c[o],g=c[o+1],_=c[o+2],w=c[o+3];c[o+0]=(192&h)>>6|(192&g)>>4|(192&_)>>2|192&w,c[o+1]=(48&h)>>4|(48&g)>>2|48&_|(48&w)<<2,c[o+2]=(12&h)>>2|12&g|(12&_)<<2|(12&w)<<4,c[o+3]=3&h|(3&g)<<2|(3&_)<<4|(3&w)<<6}return c;default:throw new Error(`Invalid pixel format, "${i}"`)}}mn(dS,"DEMData"),mn(Vk,"DemMinMaxQuadTree",{omit:["dem"]});var Eu=Uint8Array,F1=Uint16Array,jJ=Int32Array,$k=new Eu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),qk=new Eu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),MJ=new Eu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Hk=function(c,i){for(var o=new F1(31),h=0;h<31;++h)o[h]=i+=1<<c[h-1];var g=new jJ(o[30]);for(h=1;h<30;++h)for(var _=o[h];_<o[h+1];++_)g[_]=_-o[h]<<5|h;return{b:o,r:g}},Gk=Hk($k,2),Wk=Gk.b,PJ=Gk.r;Wk[28]=258,PJ[258]=28;for(var NJ=Hk(qk,0).b,Zk=new F1(32768),Ja=0;Ja<32768;++Ja){var Ov=(43690&Ja)>>1|(21845&Ja)<<1;Zk[Ja]=((65280&(Ov=(61680&(Ov=(52428&Ov)>>2|(13107&Ov)<<2))>>4|(3855&Ov)<<4))>>8|(255&Ov)<<8)>>1}var B1=function(c,i,o){for(var h=c.length,g=0,_=new F1(i);g<h;++g)c[g]&&++_[c[g]-1];var w,j=new F1(i);for(g=1;g<i;++g)j[g]=j[g-1]+_[g-1]<<1;w=new F1(1<<i);var N=15-i;for(g=0;g<h;++g)if(c[g])for(var O=g<<4|c[g],L=i-c[g],B=j[c[g]-1]++<<L,q=B|(1<<L)-1;B<=q;++B)w[Zk[B]>>N]=O;return w},V1=new Eu(288);for(Ja=0;Ja<144;++Ja)V1[Ja]=8;for(Ja=144;Ja<256;++Ja)V1[Ja]=9;for(Ja=256;Ja<280;++Ja)V1[Ja]=7;for(Ja=280;Ja<288;++Ja)V1[Ja]=8;var Xk=new Eu(32);for(Ja=0;Ja<32;++Ja)Xk[Ja]=5;var DJ=B1(V1,9),OJ=B1(Xk,5),HA=function(c){for(var i=c[0],o=1;o<c.length;++o)c[o]>i&&(i=c[o]);return i},Uh=function(c,i,o){var h=i/8|0;return(c[h]|c[h+1]<<8)>>(7&i)&o},GA=function(c,i){var o=i/8|0;return(c[o]|c[o+1]<<8|c[o+2]<<16)>>(7&i)},IJ=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],$h=function(c,i,o){var h=new Error(i||IJ[c]);if(h.code=c,Error.captureStackTrace&&Error.captureStackTrace(h,$h),!o)throw h;return h},kJ=new Eu(0),RJ=typeof TextDecoder<"u"&&new TextDecoder;try{RJ.decode(kJ,{stream:!0})}catch{}const zJ={gzip_data:"gzip"};class wd extends Error{constructor(i){super(i),this.name="MRTError"}}const LJ={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},Kk={uint32:1,uint16:2,uint8:4},FJ={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let WA;class hS{constructor(i=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=i}getLayer(i){const o=this.layers[i];if(!o)throw new wd(`Layer '${i}' not found`);return o}getHeaderLength(i){const o=new Uint8Array(i),h=new DataView(i);if(o[0]!==13)throw new wd("File is not a valid MRT.");return h.getUint32(1,!0)}parseHeader(i){const o=new Uint8Array(i),h=this.getHeaderLength(i);if(o.length<h)throw new wd(`Expected header with length >= ${h} but got buffer of length ${o.length}`);const g=function(_,w){return _.readFields(xJ,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new WA(o.subarray(0,h)));if(!isNaN(this.x)&&(this.x!==g.x||this.y!==g.y||this.z!==g.z))throw new wd(`Invalid attempt to parse header ${g.z}/${g.x}/${g.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=g.x,this.y=g.y,this.z=g.z;for(const _ of g.layers)this.layers[_.name]=new Yk(_,{cacheSize:this._cacheSize});return this}createDecodingTask(i){const o=[],h=this.getLayer(i.layerName);for(let g of i.blockIndices){const _=h.dataIndex[g],w=_.firstByte-i.firstByte,j=_.lastByte-i.firstByte;if(h._blocksInProgress.has(g))continue;const N={layerName:h.name,firstByte:w,lastByte:j,pixelFormat:h.pixelFormat,blockIndex:g,blockShape:[_.bands.length].concat(h.bandShape),buffer:h.buffer,codec:_.codec.codec,filters:_.filters.map(O=>O.filter)};h._blocksInProgress.add(g),o.push(N)}return new Qk(o,()=>{o.forEach(g=>h._blocksInProgress.delete(g.blockIndex))},(g,_)=>{if(o.forEach(w=>h._blocksInProgress.delete(w.blockIndex)),g)throw g;_.forEach(w=>{this.getLayer(w.layerName).processDecodedData(w)})})}}class Yk{constructor({version:i,name:o,units:h,tileSize:g,pixelFormat:_,buffer:w,dataIndex:j},N){if(this.version=i,this.version!==1)throw new wd(`Cannot parse raster layer encoded with MRT version ${i}`);this.name=o,this.units=h,this.tileSize=g,this.buffer=w,this.pixelFormat=LJ[_],this.dataIndex=j,this.bandShape=[g+2*w,g+2*w,Kk[this.pixelFormat]],this._decodedBlocks=new uS(N?N.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return Kk[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:i})=>i).flat()}processDecodedData(i){const o=i.blockIndex.toString();this._decodedBlocks.get(o)||this._decodedBlocks.put(o,i.data)}getBlockForBand(i){let o=0;switch(typeof i){case"string":for(const[h,g]of this.dataIndex.entries()){for(const[_,w]of g.bands.entries())if(w===i)return{bandIndex:o+_,blockIndex:h,blockBandIndex:_};o+=g.bands.length}break;case"number":for(const[h,g]of this.dataIndex.entries()){if(i>=o&&i<o+g.bands.length)return{bandIndex:i,blockIndex:h,blockBandIndex:i-o};o+=g.bands.length}break;default:throw new wd(`Invalid band \`${JSON.stringify(i)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(i){let o=1/0,h=-1/0;const g=[],_=new Set;for(const w of i){const{blockIndex:j}=this.getBlockForBand(w);if(j<0)throw new wd(`Invalid band: ${JSON.stringify(w)}`);const N=this.dataIndex[j];g.includes(j)||g.push(j),_.add(j),o=Math.min(o,N.firstByte),h=Math.max(h,N.lastByte)}if(_.size>this.cacheSize)throw new wd(`Number of blocks to decode (${_.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:o,lastByte:h,blockIndices:g}}hasBand(i){const{blockIndex:o}=this.getBlockForBand(i);return o>=0}hasDataForBand(i){const{blockIndex:o}=this.getBlockForBand(i);return o>=0&&!!this._decodedBlocks.get(o.toString())}getBandView(i){const{blockIndex:o,blockBandIndex:h}=this.getBlockForBand(i);if(o<0)throw new wd(`Band not found: ${JSON.stringify(i)}`);const g=this._decodedBlocks.get(o.toString());if(!g)throw new wd(`Data for band ${JSON.stringify(i)} of layer "${this.name}" not decoded.`);const _=this.dataIndex[o],w=this.bandShape.reduce((O,L)=>O*L,1),j=h*w,N=g.subarray(j,j+w);return{data:N,bytes:new Uint8Array(N.buffer).subarray(N.byteOffset,N.byteOffset+N.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:_.offset,scale:_.scale}}}hS.setPbf=function(c){WA=c};class Qk{constructor(i,o,h){this.tasks=i,this._onCancel=o,this._onComplete=h,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(i,o){this._finalized||(this._onComplete(i,o),this._finalized=!0)}}hS.performDecoding=function(c,i){const o=new Uint8Array(c);return Promise.all(i.tasks.map(h=>{const{layerName:g,firstByte:_,lastByte:w,pixelFormat:j,blockShape:N,blockIndex:O,filters:L,codec:B}=h,q=o.subarray(_,w+1),Y=new Uint32Array(N[0]*N[1]*N[2]);let Q;if(B!=="gzip_data")throw new wd(`Unhandled codec: ${B}`);return Q=function(re,he){if(!globalThis.DecompressionStream&&he==="gzip_data")return Promise.resolve(((oe=function(je){je[0]==31&&je[1]==139&&je[2]==8||$h(6,"invalid gzip data");var Ve=je[3],We=10;4&Ve&&(We+=2+(je[10]|je[11]<<8));for(var Ze=(Ve>>3&1)+(Ve>>4&1);Ze>0;Ze-=!je[We++]);return We+(2&Ve)}(be=re))+8>be.length&&$h(6,"invalid gzip data"),function(je,Ve,We,Ze){var Qe=je.length;if(!Qe||Ve.f&&!Ve.l)return We||new Eu(0);var pt=!We,kt=pt||Ve.i!=2,Ct=Ve.i;pt&&(We=new Eu(3*Qe));var Pt,Vt,ht=function(ua){var Ui=We.length;if(ua>Ui){var ki=new Eu(Math.max(2*Ui,ua));ki.set(We),We=ki}},Mt=Ve.f||0,dt=Ve.p||0,ft=Ve.b||0,$t=Ve.l,Gt=Ve.d,Dn=Ve.m,bn=Ve.n,an=8*Qe;do{if(!$t){Mt=Uh(je,dt,1);var Ut=Uh(je,dt+1,3);if(dt+=3,!Ut){var sr=je[(Ae=4+((dt+7)/8|0))-4]|je[Ae-3]<<8,An=Ae+sr;if(An>Qe){Ct&&$h(0);break}kt&&ht(ft+sr),We.set(je.subarray(Ae,An),ft),Ve.b=ft+=sr,Ve.p=dt=8*An,Ve.f=Mt;continue}if(Ut==1)$t=DJ,Gt=OJ,Dn=9,bn=5;else if(Ut==2){var Cn=Uh(je,dt,31)+257,nr=Uh(je,dt+10,15)+4,dr=Cn+Uh(je,dt+5,31)+1;dt+=14;for(var fr=new Eu(dr),wr=new Eu(19),yr=0;yr<nr;++yr)wr[MJ[yr]]=Uh(je,dt+3*yr,7);dt+=3*nr;var mr=HA(wr),Ei=(1<<mr)-1,zi=B1(wr,mr);for(yr=0;yr<dr;){var Ae,Ne=zi[Uh(je,dt,Ei)];if(dt+=15&Ne,(Ae=Ne>>4)<16)fr[yr++]=Ae;else{var yt=0,Qt=0;for(Ae==16?(Qt=3+Uh(je,dt,3),dt+=2,yt=fr[yr-1]):Ae==17?(Qt=3+Uh(je,dt,7),dt+=3):Ae==18&&(Qt=11+Uh(je,dt,127),dt+=7);Qt--;)fr[yr++]=yt}}var cn=fr.subarray(0,Cn),on=fr.subarray(Cn);Dn=HA(cn),bn=HA(on),$t=B1(cn,Dn),Gt=B1(on,bn)}else $h(1);if(dt>an){Ct&&$h(0);break}}kt&&ht(ft+131072);for(var Nn=(1<<Dn)-1,Xn=(1<<bn)-1,Pr=dt;;Pr=dt){var Nr=(yt=$t[GA(je,dt)&Nn])>>4;if((dt+=15&yt)>an){Ct&&$h(0);break}if(yt||$h(2),Nr<256)We[ft++]=Nr;else{if(Nr==256){Pr=dt,$t=null;break}var gr=Nr-254;Nr>264&&(gr=Uh(je,dt,(1<<(Dr=$k[yr=Nr-257]))-1)+Wk[yr],dt+=Dr);var gi=Gt[GA(je,dt)&Xn],Ii=gi>>4;if(gi||$h(3),dt+=15&gi,on=NJ[Ii],Ii>3){var Dr=qk[Ii];on+=GA(je,dt)&(1<<Dr)-1,dt+=Dr}if(dt>an){Ct&&$h(0);break}kt&&ht(ft+131072);var ra=ft+gr;if(ft<on){var Li=0-on,fi=Math.min(on,ra);for(Li+ft<0&&$h(3);ft<fi;++ft)We[ft]=(void 0)[Li+ft]}for(;ft<ra;++ft)We[ft]=We[ft-on]}}Ve.l=$t,Ve.p=Pr,Ve.b=ft,Ve.f=Mt,$t&&(Mt=1,Ve.m=Dn,Ve.d=Gt,Ve.n=bn)}while(!Mt);return ft!=We.length&&pt?(Pt=We,((Vt=ft)==null||Vt>Pt.length)&&(Vt=Pt.length),new Eu(Pt.subarray(0,Vt))):We.subarray(0,ft)}(be.subarray(oe,-8),{i:2},new Eu(((pe=be)[(Se=pe.length)-4]|pe[Se-3]<<8|pe[Se-2]<<16|pe[Se-1]<<24)>>>0))));var pe,Se,be,oe;const xe=zJ[he];if(!xe)throw new Error(`Unhandled codec: ${he}`);const we=new globalThis.DecompressionStream(xe);return new Response(new Blob([re]).stream().pipeThrough(we)).arrayBuffer().then(je=>new Uint8Array(je))}(q,B).then(re=>(function(he,pe){he.readFields(SJ,pe)}(new WA(re),Y),new FJ[j](Y.buffer))),Q.then(re=>{for(let he=L.length-1;he>=0;he--)switch(L[he]){case"delta_filter":EJ(re,N);break;case"zigzag_filter":AJ(re);break;case"bitshuffle_filter":CJ(re,j);break;default:throw new wd(`Unhandled filter "${L[he]}"`)}return{layerName:g,blockIndex:O,data:re}}).catch(re=>{throw re})}))},mn(Qk,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),mn(hS,"MapboxRasterTile"),mn(Yk,"MapboxRasterLayer",{omit:["_blocksInProgress"]});let U1,ZA,qh,Iv,XA,kv=null;function Jk(){return mi(self)&&self.worker.dracoUrl?self.worker.dracoUrl:ZA||Ca.DRACO_URL}function eR(){if(mi(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Iv)return Iv;const c=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Iv=WebAssembly.validate(c)?Ca.MESHOPT_SIMD_URL:Ca.MESHOPT_URL,Iv}const fS={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},BJ={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},$1={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function tR(c,i,o){const h=o.json.bufferViews.length,g=o.buffers.length;i.bufferView=h,o.json.bufferViews[h]={buffer:g,byteLength:c.byteLength},o.buffers[g]=c}const KA="KHR_draco_mesh_compression";function VJ(c,i){const o=c.extensions&&c.extensions[KA];if(!o)return;const h=new qh.Decoder,g=aR(i,o.bufferView),_=new qh.Mesh;if(!h.DecodeArrayToMesh(g,g.byteLength,_))throw new Error("Failed to decode Draco mesh");const w=i.json.accessors[c.indices],j=fS[w.componentType],N=w.count*j.BYTES_PER_ELEMENT,O=qh._malloc(N);j===Uint16Array?h.GetTrianglesUInt16Array(_,N,O):h.GetTrianglesUInt32Array(_,N,O),tR(qh.memory.buffer.slice(O,O+N),w,i),qh._free(O);for(const L of Object.keys(o.attributes)){const B=h.GetAttributeByUniqueId(_,o.attributes[L]),q=i.json.accessors[c.attributes[L]],Y=BJ[q.componentType],Q=q.count*$1[q.type]*fS[q.componentType].BYTES_PER_ELEMENT,re=qh._malloc(Q);h.GetAttributeDataArrayForAllPoints(_,B,qh[Y],Q,re),tR(qh.memory.buffer.slice(re,re+Q),q,i),qh._free(re)}h.destroy(),_.destroy(),delete c.extensions[KA]}const pS="EXT_meshopt_compression";function UJ(c,i){if(!c.extensions||!c.extensions[pS])return;const o=c.extensions[pS],h=new Uint8Array(i.buffers[o.buffer],o.byteOffset||0,o.byteLength||0),g=new Uint8Array(o.count*o.byteStride);XA.decodeGltfBuffer(g,o.count,o.byteStride,h,o.mode,o.filter),c.buffer=i.buffers.length,c.byteOffset=0,i.buffers[c.buffer]=g.buffer,delete c.extensions[pS]}const nR=1179937895,rR=new TextDecoder("utf8");function iR(c,i){return new URL(c,i).href}function $J(c,i,o,h){return fetch(iR(c.uri,h)).then(g=>g.arrayBuffer()).then(g=>{i.buffers[o]=g})}function aR(c,i){const o=c.json.bufferViews[i];return new Uint8Array(c.buffers[o.buffer],o.byteOffset||0,o.byteLength)}function qJ(c,i,o,h){if(c.uri){const g=iR(c.uri,h);return fetch(g).then(_=>_.blob()).then(_=>createImageBitmap(_)).then(_=>{i.images[o]=_})}if(c.bufferView!==void 0){const g=aR(i,c.bufferView),_=new Blob([g],{type:c.mimeType});return createImageBitmap(_).then(w=>{i.images[o]=w})}}function sR(c,i=0,o){const h={json:null,images:[],buffers:[]};if(new Uint32Array(c,i,1)[0]===nR){const L=new Uint32Array(c,i);let B=2;const q=(L[B++]>>2)-3,Y=L[B++]>>2;if(B++,h.json=JSON.parse(rR.decode(L.subarray(B,B+Y))),B+=Y,B<q){const Q=L[B++];B++;const re=i+(B<<2);h.buffers[0]=c.slice(re,re+Q)}}else h.json=JSON.parse(rR.decode(new Uint8Array(c,i)));const{buffers:g,images:_,meshes:w,extensionsUsed:j,bufferViews:N}=h.json;let O=Promise.resolve();if(g){const L=[];for(let B=0;B<g.length;B++){const q=g[B];q.uri?L.push($J(q,h,B,o)):h.buffers[B]||(h.buffers[B]=null)}O=Promise.all(L)}return O.then(()=>{const L=[],B=j&&j.includes(KA),q=j&&j.includes(pS);if(B&&L.push(function(){if(!qh)return U1??(U1=function(Y){let Q,re=null;function he(){Q=new Uint8Array(re.buffer)}function pe(){throw new Error("Unexpected Draco error.")}const Se={a:{a:pe,d:function(be,oe,xe){return Q.copyWithin(be,oe,oe+xe)},c:function(be){const oe=Q.length,xe=Math.max(be>>>0,Math.ceil(1.2*oe)),we=Math.ceil((xe-oe)/65536);try{return re.grow(we),he(),!0}catch{return!1}},b:pe}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(Y,Se):Y.then(be=>be.arrayBuffer()).then(be=>WebAssembly.instantiate(be,Se))).then(be=>{const{Rb:oe,Qb:xe,P:we,T:je,X:Ve,Ja:We,La:Ze,Qa:Qe,Va:pt,Wa:kt,eb:Ct,jb:Pt,f:Vt,e:ht,yb:Mt,zb:dt,Ab:ft,Bb:$t,Db:Gt,Gb:Dn}=be.instance.exports;re=ht;const bn=(()=>{let an=0,Ut=0,sr=0,An=0;return Cn=>{sr&&(oe(An),oe(an),Ut+=sr,sr=an=0),an||(Ut+=128,an=xe(Ut));const nr=Cn.length+7&-8;let dr=an;nr>=Ut&&(sr=nr,dr=An=xe(nr));for(let fr=0;fr<Cn.length;fr++)Q[dr+fr]=Cn[fr];return dr}})();return he(),Vt(),{memory:ht,_free:oe,_malloc:xe,Mesh:class{constructor(){this.ptr=we()}destroy(){je(this.ptr)}},Decoder:class{constructor(){this.ptr=We()}destroy(){Pt(this.ptr)}DecodeArrayToMesh(an,Ut,sr){const An=bn(an),Cn=Ze(this.ptr,An,Ut,sr.ptr);return!!Ve(Cn)}GetAttributeByUniqueId(an,Ut){return{ptr:Qe(this.ptr,an.ptr,Ut)}}GetTrianglesUInt16Array(an,Ut,sr){pt(this.ptr,an.ptr,Ut,sr)}GetTrianglesUInt32Array(an,Ut,sr){kt(this.ptr,an.ptr,Ut,sr)}GetAttributeDataArrayForAllPoints(an,Ut,sr,An,Cn){Ct(this.ptr,an.ptr,Ut.ptr,sr,An,Cn)}},DT_INT8:Mt(),DT_UINT8:dt(),DT_INT16:ft(),DT_UINT16:$t(),DT_UINT32:Gt(),DT_FLOAT32:Dn()}})}(fetch(Jk())),U1.then(Y=>{qh=Y,U1=void 0}))}()),q&&L.push(function(){if(XA)return;const Y=function(Q){let re;const he=WebAssembly.instantiateStreaming(Q,{}).then(be=>{re=be.instance,re.exports.__wasm_call_ctors()}),pe={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},Se={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:he,supported:!0,decodeGltfBuffer(be,oe,xe,we,je,Ve){(function(We,Ze,Qe,pt,kt,Ct,Pt){const Vt=We.exports.sbrk,ht=pt+3&-4,Mt=Vt(ht*kt),dt=Vt(Ct.length),ft=new Uint8Array(We.exports.memory.buffer);ft.set(Ct,dt);const $t=Ze(Mt,pt,kt,dt,Ct.length);if($t===0&&Pt&&Pt(Mt,ht,kt),Qe.set(ft.subarray(Mt,Mt+pt*kt)),Vt(Mt-Vt(0)),$t!==0)throw new Error(`Malformed buffer data: ${$t}`)})(re,re.exports[Se[je]],be,oe,xe,we,re.exports[pe[Ve]])}}}(fetch(eR()));return Y.ready.then(()=>{XA=Y})}()),_)for(let Y=0;Y<_.length;Y++)L.push(qJ(_[Y],h,Y,o));return(L.length?Promise.all(L):Promise.resolve()).then(()=>{if(B&&w)for(const{primitives:Y}of w)for(const Q of Y)VJ(Q,h);if(q&&w&&N)for(const Y of N)UJ(Y,h);return h})})}function D0(c,i){const o=c.json.bufferViews[i.bufferView],h=fS[i.componentType];return new h(c.buffers[o.buffer],(i.byteOffset||0)+(o.byteOffset||0),i.count*(o.byteStride&&o.byteStride!==$1[i.type]*h.BYTES_PER_ELEMENT?o.byteStride/h.BYTES_PER_ELEMENT:$1[i.type]))}function YA(c,i,o,h){const g=fS[i.componentType],_=function(L){switch(L){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(g),w=c.json.bufferViews[i.bufferView],j=w.byteStride?w.byteStride/g.BYTES_PER_ELEMENT:$1[i.type],N=o.float32,O=N.length/o.capacity;for(let L=0,B=0;L<i.count*j;L+=j,B+=O)for(let q=0;q<O;q++)N[B+q]=h[L+q]*_;o._trim()}function HJ(c,i,o){const h=c.indices,g=c.attributes,_={};_.indexArray=new la;const w=i.json.accessors[h],j=w.count/3;_.indexArray.reserve(j);const N=D0(i,w);for(let q=0;q<j;q++)_.indexArray.emplaceBack(N[3*q],N[3*q+1],N[3*q+2]);_.indexArray._trim(),_.vertexArray=new Eo;const O=i.json.accessors[g.POSITION];_.vertexArray.reserve(O.count);const L=D0(i,O);for(let q=0;q<O.count;q++)_.vertexArray.emplaceBack(L[3*q],L[3*q+1],L[3*q+2]);if(_.vertexArray._trim(),_.aabb=new hi(O.min,O.max),_.centroid=function(q,Y){const Q=[0,0,0],re=q.length;if(re>0){for(let he=0;he<re;he++){const pe=3*q[he];Q[0]+=Y[pe],Q[1]+=Y[pe+1],Q[2]+=Y[pe+2]}Q[0]/=re,Q[1]/=re,Q[2]/=re}return Q}(N,L),g.COLOR_0!==void 0){const q=i.json.accessors[g.COLOR_0],Y=$1[q.type],Q=D0(i,q);_.colorArray=Y===3?new Eo:new pc,_.colorArray.resize(q.count),YA(i,q,_.colorArray,Q)}if(g.NORMAL!==void 0){_.normalArray=new Eo;const q=i.json.accessors[g.NORMAL];_.normalArray.resize(q.count);const Y=D0(i,q);YA(i,q,_.normalArray,Y)}if(g.TEXCOORD_0!==void 0&&o.length>0){_.texcoordArray=new dd;const q=i.json.accessors[g.TEXCOORD_0];_.texcoordArray.resize(q.count);const Y=D0(i,q);YA(i,q,_.texcoordArray,Y)}if(g._FEATURE_ID_RGBA4444!==void 0){const q=i.json.accessors[g._FEATURE_ID_RGBA4444];i.json.extensionsUsed&&i.json.extensionsUsed.includes("EXT_meshopt_compression")&&(_.featureData=D0(i,q))}g._FEATURE_RGBA4444!==void 0&&(_.featureData=new Uint32Array(D0(i,i.json.accessors[g._FEATURE_RGBA4444]).buffer));const B=c.material;return _.material=function(q,Y){const{emissiveFactor:Q=[0,0,0],alphaMode:re="OPAQUE",alphaCutoff:he=.5,normalTexture:pe,occlusionTexture:Se,emissiveTexture:be,doubleSided:oe}=q,{baseColorFactor:xe=[1,1,1,1],metallicFactor:we=1,roughnessFactor:je=1,baseColorTexture:Ve,metallicRoughnessTexture:We}=q.pbrMetallicRoughness||{},Ze=Se?Y[Se.index]:void 0;if(Se&&Se.extensions&&Se.extensions.KHR_texture_transform&&Ze){const Qe=Se.extensions.KHR_texture_transform;Ze.offsetScale=[Qe.offset[0],Qe.offset[1],Qe.scale[0],Qe.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Kr(...xe),metallicFactor:we,roughnessFactor:je,baseColorTexture:Ve?Y[Ve.index]:void 0,metallicRoughnessTexture:We?Y[We.index]:void 0},doubleSided:oe,emissiveFactor:Q,alphaMode:re,alphaCutoff:he,normalTexture:pe?Y[pe.index]:void 0,occlusionTexture:Ze,emissionTexture:be?Y[be.index]:void 0,defined:q.defined===void 0}}(B!==void 0?i.json.materials[B]:{defined:!1},o),_}function oR(c,i,o){const{matrix:h,rotation:g,translation:_,scale:w,mesh:j,extras:N,children:O}=c,L={};if(L.matrix=h||function(B,q,Y,Q){var re=q[0],he=q[1],pe=q[2],Se=q[3],be=re+re,oe=he+he,xe=pe+pe,we=re*be,je=re*oe,Ve=re*xe,We=he*oe,Ze=he*xe,Qe=pe*xe,pt=Se*be,kt=Se*oe,Ct=Se*xe,Pt=Q[0],Vt=Q[1],ht=Q[2];return B[0]=(1-(We+Qe))*Pt,B[1]=(je+Ct)*Pt,B[2]=(Ve-kt)*Pt,B[3]=0,B[4]=(je-Ct)*Vt,B[5]=(1-(we+Qe))*Vt,B[6]=(Ze+pt)*Vt,B[7]=0,B[8]=(Ve+kt)*ht,B[9]=(Ze-pt)*ht,B[10]=(1-(we+We))*ht,B[11]=0,B[12]=Y[0],B[13]=Y[1],B[14]=Y[2],B[15]=1,B}([],g||[0,0,0,1],_||[0,0,0],w||[1,1,1]),j!==void 0){L.meshes=o[j];const B=L.anchor=[0,0];for(const q of L.meshes){const{min:Y,max:Q}=q.aabb;B[0]+=Y[0]+Q[0],B[1]+=Y[1]+Q[1]}B[0]=Math.floor(B[0]/L.meshes.length/2),B[1]=Math.floor(B[1]/L.meshes.length/2)}if(N&&(N.id&&(L.id=N.id),N.lights&&(L.lights=function(B){if(!B.length)return[];const q=function(pe){const Se=atob(pe),be=new Uint8Array(Se.length);for(let oe=0;oe<Se.length;oe++)be[oe]=Se.codePointAt(oe);return be}(B),Y=[],Q=q.length/24,re=new Uint16Array(q.buffer),he=new Float32Array(q.buffer);for(let pe=0;pe<Q;pe++){const Se=re[2*pe*6]/30,be=re[2*pe*6+1]/30,oe=re[2*pe*6+10]/100,xe=he[6*pe+1],we=he[6*pe+2],je=he[6*pe+3],Ve=he[6*pe+4],We=je-xe,Ze=Ve-we,Qe=Math.hypot(We,Ze);Y.push({pos:[xe+.5*We,we+.5*Ze,be],normal:[Ze/Qe,-We/Qe,0],width:Qe,height:Se,depth:oe,points:[xe,we,je,Ve]})}return Y}(N.lights))),O){const B=[];for(const q of O)B.push(oR(i.json.nodes[q],i,o));L.children=B}return L}function GJ(c){if(c.vertices.length===0||c.indices.length===0)return null;const i=new Vf(c.vertices,c.indices,8,256),[o,h]=[i.min.clone(),i.max.clone()];return{vertices:c.vertices,indices:c.indices,grid:i,min:o,max:h}}function WJ(c){if(!c.extras||!c.extras.ground)return null;const i=c.extras.ground;if(!i||!Array.isArray(i)||i.length===0)return null;const o=i[0];if(!o||!Array.isArray(o)||o.length===0)return null;const h=[];for(const w of o){if(!Array.isArray(w)||w.length!==2)continue;const j=w[0],N=w[1];typeof j=="number"&&typeof N=="number"&&h.push(new Kt(j,N))}if(h.length<3)return null;h.length>1&&h[h.length-1].equals(h[0])&&h.pop();let g=0;for(let w=0;w<h.length;w++){const j=h[w],N=h[(w+1)%h.length],O=h[(w+2)%h.length];g+=(j.x-N.x)*(O.y-N.y)-(O.x-N.x)*(j.y-N.y)}g>0&&h.reverse();const _=u0(h.flatMap(w=>[w.x,w.y]),[]);return _.length===0?null:{vertices:h,indices:_}}function ZJ(c,i){const o=[],h=[];let g=0;const _=[];for(const w of c){g=o.length;const j=w.vertexArray.float32,N=w.indexArray.uint16;for(let O=0;O<w.vertexArray.length;O++)_[0]=j[3*O+0],_[1]=j[3*O+1],_[2]=j[3*O+2],un(_,_,i),o.push(new Kt(_[0],_[1]));for(let O=0;O<3*w.indexArray.length;O++)h.push(N[O]+g)}if(h.length%3!=0)return null;for(let w=0;w<h.length;w+=3){const j=o[h[w+0]],N=o[h[w+1]],O=o[h[w+2]];(j.x-N.x)*(O.y-N.y)-(O.x-N.x)*(j.y-N.y)>0&&([h[w+1],h[w+2]]=[h[w+2],h[w+1]])}return{vertices:o,indices:h}}function lR(c){const i=function(N,O){const L=[],B=WebGL2RenderingContext;if(N.json.textures)for(const q of N.json.textures){const Y={magFilter:B.LINEAR,minFilter:B.NEAREST,wrapS:B.REPEAT,wrapT:B.REPEAT};q.sampler!==void 0&&Object.assign(Y,N.json.samplers[q.sampler]),L.push({image:O[q.source],sampler:Y,uploaded:!1})}return L}(c,c.images),o=function(N,O){const L=[];for(const B of N.json.meshes){const q=[];for(const Y of B.primitives)q.push(HJ(Y,N,O));L.push(q)}return L}(c,i),{scenes:h,scene:g,nodes:_}=c.json,w=h?h[g||0].nodes:_,j=[];for(const N of w)j.push(oR(_[N],c,o));return function(N,O,L){const B={},q=new Set;for(let Y=0;Y<N.length;Y++){const Q=L[O[Y]];if(!Q.extras)continue;const re=Q.extras["mapbox:footprint:version"],he=Q.extras["mapbox:footprint:id"];(re||he)&&q.add(Y),re==="1.0.0"&&he&&(B[he]=Y)}for(let Y=0;Y<N.length;Y++){if(q.has(Y))continue;const Q=N[Y],re=L[O[Y]];if(!re.extras)continue;let he=null;Q.id in B&&(he=ZJ(N[B[Q.id]].meshes,Q.matrix)),he||(he=WJ(re)),he&&(Q.footprint=GJ(he))}if(q.size>0){const Y=Array.from(q.values()).sort((Q,re)=>Q-re);for(let Q=Y.length-1;Q>=0;Q--)N.splice(Y[Q],1)}}(j,w,c.json.nodes),j}function XJ(c){c.heightmap=new Float32Array(4096),c.heightmap.fill(-1);const i=c.vertexArray.float32,o=c.aabb.min[0]-1,h=c.aabb.min[1]-1,g=M0/(c.aabb.max[0]-o+2),_=M0/(c.aabb.max[1]-h+2);for(let w=0;w<i.length;w+=3){const j=i[w+2],N=(i[w+0]-o)*g|0,O=(i[w+1]-h)*_|0;j>c.heightmap[O*M0+N]&&(c.heightmap[O*M0+N]=j)}}function KJ(c,i){const o={};o.indexArray=new la,o.indexArray.reserve(4*c.length),o.vertexArray=new Eo,o.vertexArray.reserve(10*c.length),o.colorArray=new pc,o.vertexArray.reserve(10*c.length);let h=0;for(const w of c){const j=Math.min(10,Math.max(4,1.3*w.height))*i,N=[-w.normal[1],w.normal[0],0],O=Math.min(.29,.1*w.width/w.depth),L=w.width-2*w.depth*i*(O+.01),B=ot([],w.pos,N,L/2),q=ot([],w.pos,N,-L/2),Y=[B[0],B[1],B[2]+w.height],Q=[q[0],q[1],q[2]+w.height],re=ot([],w.normal,N,O);Ge(re,re,j);const he=ot([],w.normal,N,-O);Ge(he,he,j),vt(re,B,re),vt(he,q,he),B[2]+=.1,q[2]+=.1,o.vertexArray.emplaceBack(re[0],re[1],re[2]),o.vertexArray.emplaceBack(he[0],he[1],he[2]),o.vertexArray.emplaceBack(B[0],B[1],B[2]),o.vertexArray.emplaceBack(q[0],q[1],q[2]),o.vertexArray.emplaceBack(Y[0],Y[1],Y[2]),o.vertexArray.emplaceBack(Q[0],Q[1],Q[2]),o.vertexArray.emplaceBack(B[0],B[1],B[2]),o.vertexArray.emplaceBack(q[0],q[1],q[2]),o.vertexArray.emplaceBack(re[0],re[1],re[2]),o.vertexArray.emplaceBack(he[0],he[1],he[2]);const pe=L/j/2;o.colorArray.emplaceBack(-pe-O,-1,pe,.8),o.colorArray.emplaceBack(pe+O,-1,pe,.8),o.colorArray.emplaceBack(-pe,0,pe,1.3),o.colorArray.emplaceBack(pe,0,pe,1.3),o.colorArray.emplaceBack(pe+O,-.8,pe,.7),o.colorArray.emplaceBack(pe+O,-.8,pe,.7),o.colorArray.emplaceBack(0,0,pe,1.3),o.colorArray.emplaceBack(0,0,pe,1.3),o.colorArray.emplaceBack(pe+O,-1.2,pe,.8),o.colorArray.emplaceBack(pe+O,-1.2,pe,.8),o.indexArray.emplaceBack(6+h,4+h,8+h),o.indexArray.emplaceBack(7+h,9+h,5+h),o.indexArray.emplaceBack(0+h,1+h,2+h),o.indexArray.emplaceBack(1+h,3+h,2+h),h+=10}const g={defined:!0,emissiveFactor:[0,0,0]},_={};return _.baseColorFactor=Kr.white,g.pbrMetallicRoughness=_,o.material=g,o.aabb=new hi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),o}class cR{constructor(i){this._stringToNumber={},this._numberToString=[];for(let o=0;o<i.length;o++){const h=i[o];this._stringToNumber[h]=o,this._numberToString[o]=h}}encode(i){return this._stringToNumber[i]}decode(i){return this._numberToString[i]}}const YJ=["id","tile","layer","source","sourceLayer","state"];class Rv{constructor(i,o,h,g,_){this.type="Feature",this._vectorTileFeature=i,this._z=o,this._x=h,this._y=g,this.properties=i.properties,this.id=_}clone(){const i=new Rv(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(i.state=Object.assign({},this.state)),this.layer&&(i.layer=Object.assign({},this.layer)),this.source&&(i.source=this.source),this.sourceLayer&&(i.sourceLayer=this.sourceLayer),i}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const o of YJ)this[o]!==void 0&&(i[o]=this[o]);return i}}class uR{constructor(i,o){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new Pf(en,16,0),this.featureIndexArray=new Jx,this.promoteId=o,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(i,o,h,g,_,w=0,j=0){const N=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,g,_,w);const O=this.grid;for(let L=0;L<o.length;L++){const B=o[L],q=[1/0,1/0,-1/0,-1/0];for(let Y=0;Y<B.length;Y++){const Q=B[Y];q[0]=Math.min(q[0],Q.x),q[1]=Math.min(q[1],Q.y),q[2]=Math.max(q[2],Q.x),q[3]=Math.max(q[3],Q.y)}j!==0&&(q[0]-=j,q[1]-=j,q[2]+=j,q[3]+=j),q[0]<en&&q[1]<en&&q[2]>=0&&q[3]>=0&&O.insert(N,q[0],q[1],q[2],q[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new yd.VectorTile(new I2(this.rawTileData)).layers,this.sourceLayerCoder=new cR(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const i in this.vtLayers)this.vtFeatures[i]=[]}return this.vtLayers}query(i,o){const{tilespaceGeometry:h,transform:g,tileTransform:_,pixelPosMatrix:w,availableImages:j}=o;this.loadVTLayers(),this.serializedLayersCache.clear();const N=h.bufferedTilespaceBounds,O=this.grid.query(N.min.x,N.min.y,N.max.x,N.max.y,(Y,Q,re,he)=>ti(h.bufferedTilespaceGeometry,Y,Q,re,he));O.sort(QJ);let L=null;g.elevation&&O.length>0&&(L=Pv.create(g.elevation,this.tileID));const B={};let q;for(let Y=0;Y<O.length;Y++){const Q=O[Y];if(Q===q)continue;q=Q;const re=this.featureIndexArray.get(Q);let he=null;this.is3DTile?this.loadMatchingModelFeature(B,re,i,h,g):this.loadMatchingFeature(B,re,i,j,(pe,Se,be,oe=0)=>(he||(he=yn(pe,this.tileID.canonical,_)),Se.queryIntersectsFeature(h,pe,be,he,this.z,g,w,L,oe)))}return B}loadMatchingFeature(i,o,h,g,_){const{featureIndex:w,bucketIndex:j,sourceLayerIndex:N,layoutVertexArrayOffset:O}=o,L=this.bucketLayerIDs[j],B=h.layers,q=Object.keys(B);if(q.length&&!function(pe,Se){for(let be=0;be<pe.length;be++)if(Se.indexOf(pe[be])>=0)return!0;return!1}(q,L))return;const Y=h.sourceCache,Q=this.sourceLayerCoder.decode(N),re=this.vtLayers[Q].feature(w),he=this.getId(re,Q);for(let pe=0;pe<L.length;pe++){const Se=L[pe];if(!B[Se])continue;const{styleLayer:be,targets:oe}=B[Se];let xe={};he!==void 0&&(xe=Y.getFeatureState(be.sourceLayer,he));const we=!_||_(re,be,xe,O);if(!we)continue;const je=new Rv(re,this.z,this.x,this.y,he);je.tile=this.tileID.canonical,je.state=xe;let Ve=this.serializedLayersCache.get(Se);Ve||(Ve=be.serialize(),Ve.id=Se,this.serializedLayersCache.set(Se,Ve)),je.source=Ve.source,je.sourceLayer=Ve["source-layer"],je.layer=Xe({},Ve),je.layer.paint=dR(Ve.paint,be.paint,re,xe,g),je.layer.layout=dR(Ve.layout,be.layout,re,xe,g);let We=!1;for(const Ze of oe){this.updateFeatureProperties(je,Ze);const{filter:Qe}=Ze;if(Qe){if(re.properties=je.properties,Qe.needGeometry){const pt=Tn(re,!0);if(!Qe.filter(new ui(this.tileID.overscaledZ),pt,this.tileID.canonical))continue}else if(!Qe.filter(new ui(this.tileID.overscaledZ),re))continue}We=!0,Ze.targetId&&this.addFeatureVariant(je,Ze)}We&&this.appendToResult(i,Se,w,je,we)}}loadMatchingModelFeature(i,o,h,g,_){const w=this.bucketLayerIDs[0][0],j=h.layers;if(!j[w])return;const{styleLayer:N,targets:O}=j[w];if(N.type!=="model")return;const L=g.tile,B=o.featureIndex,q=L.getBucket(N);if(!(q&&q instanceof rS))return;const Y=function(Ve,We,Ze,Qe){const pt=Ve.getNodesInfo()[We];if(pt.hiddenByReplacement||!pt.node.meshes)return;let kt=Number.MAX_VALUE;const Ct=pt.node,Pt=Ze.tile,Vt=Qe.calculatePosMatrix(Pt.tileID.toUnwrapped(),Qe.worldSize),ht=pt.evaluatedScale;let Mt=0;Qe.elevation&&Ct.elevation&&(Mt=Ct.elevation*Qe.elevation.exaggeration()),ne(Vt,Vt,[(Ct.anchor?Ct.anchor[0]:0)*(ht[0]-1),(Ct.anchor?Ct.anchor[1]:0)*(ht[1]-1),Mt]),ie(Vt,Vt,ht);const dt=Ze.queryGeometry,ft=dt.isPointQuery()?dt.screenBounds:dt.screenGeometry,$t=function(Dn){const bn=Z([],Vt,Dn.matrix);Z(bn,Qe.expandedFarZProjMatrix,bn);for(let an=0;an<Dn.meshes.length;++an){const Ut=Dn.meshes[an];if(an===Dn.lightMeshIndex)continue;const sr=uk(ft,Qe,bn,Ut.aabb);sr!=null&&(kt=Math.min(sr,kt))}if(Dn.children)for(const an of Dn.children)$t(an)};if($t(Ct),kt===Number.MAX_VALUE)return;const Gt=new ue(0,0);return bk(Pt.tileID.canonical,Gt,pt.node.anchor[0],pt.node.anchor[1]),{intersectionZ:kt,position:Gt,feature:pt.feature}}(q,B,g,_);if(!Y)return;const{z:Q,x:re,y:he}=L.tileID.canonical,{feature:pe,intersectionZ:Se,position:be}=Y;let oe={};pe.id!==void 0&&(oe=h.sourceCache.getFeatureState(N.sourceLayer,pe.id));const xe=new Rv({},Q,re,he,pe.id);xe.tile=this.tileID.canonical,xe.state=oe,xe.properties=pe.properties,xe.geometry={type:"Point",coordinates:[be.lng,be.lat]};let we=this.serializedLayersCache.get(w);we||(we=N.serialize(),we.id=w,this.serializedLayersCache.set(w,we)),xe.source=we.source,xe.sourceLayer=we["source-layer"],xe.layer=Xe({},we);let je=!1;for(const Ve of O){this.updateFeatureProperties(xe,Ve);const{filter:We}=Ve;if(We){if(pe.properties=xe.properties,We.needGeometry){if(!We.filter(new ui(this.tileID.overscaledZ),pe,this.tileID.canonical))continue}else if(!We.filter(new ui(this.tileID.overscaledZ),pe))continue}je=!0,Ve.targetId&&this.addFeatureVariant(xe,Ve)}je&&this.appendToResult(i,w,B,xe,Se)}updateFeatureProperties(i,o,h){if(o.properties){const g={};for(const _ in o.properties){const w=o.properties[_].evaluate({zoom:this.z},i._vectorTileFeature,i.state,i.tile,h);w!=null&&(g[_]=w)}i.properties=g}}addFeatureVariant(i,o,h){const g={target:o.target,namespace:o.namespace,uniqueFeatureID:o.uniqueFeatureID};o.properties&&(g.properties=i.properties),i.variants=i.variants||{},i.variants[o.targetId]=i.variants[o.targetId]||[],i.variants[o.targetId].push(g)}appendToResult(i,o,h,g,_){let w=i[o];w===void 0&&(w=i[o]=[]),w.push({featureIndex:h,feature:g,intersectionZ:_})}lookupSymbolFeatures(i,o,h,g,_){const w={};this.loadVTLayers();for(const j of i)this.loadMatchingFeature(w,{bucketIndex:o,sourceLayerIndex:h,featureIndex:j,layoutVertexArrayOffset:0},g,_);return w}loadFeature(i){const{featureIndex:o,sourceLayerIndex:h}=i;this.loadVTLayers();const g=this.sourceLayerCoder.decode(h),_=this.vtFeatures[g];if(_[o])return _[o];const w=this.vtLayers[g].feature(o);return _[o]=w,w}hasLayer(i){for(const o of this.bucketLayerIDs)for(const h of o)if(i===h)return!0;return!1}getId(i,o){let h=i.id;if(this.promoteId){const g=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[o];if(g!=null)if(Array.isArray(g)){if(!this.promoteIdExpression){const _=si(g);if(_.result!=="success"){const w=_.value.map(j=>`${j.key}: ${j.message}`).join(", ");return void or(`Failed to create expression for promoteId: ${w}`)}this.promoteIdExpression=_.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new df),h=this.promoteIdExpression.evaluate({zoom:0},i)}else h=i.properties[g];typeof h=="boolean"&&(h=Number(h))}return h}}function dR(c,i,o,h,g){return zn(c,(_,w)=>{const j=i instanceof sd?i.get(w):null;return j&&j.evaluate?j.evaluate(o,h,void 0,g):j})}function QJ(c,i){return i-c}mn(uR,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const hR=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class QA{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,h]=new Uint8Array(i,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=h>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const _=hR[15&h];if(!_)throw new Error("Unrecognized array type.");const[w]=new Uint16Array(i,2,1),[j]=new Uint32Array(i,4,1);return new QA(j,w,_,i)}constructor(i,o=64,h=Float64Array,g){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=h,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const _=hR.indexOf(this.ArrayType),w=2*i*this.ArrayType.BYTES_PER_ELEMENT,j=i*this.IndexArrayType.BYTES_PER_ELEMENT,N=(8-j%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${h}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+j+N,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+w+j+N),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+j+N,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=i)}add(i,o){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=i,this.coords[this._pos++]=o,h}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return JA(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,o,h,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:w,nodeSize:j}=this,N=[0,_.length-1,0],O=[];for(;N.length;){const L=N.pop()||0,B=N.pop()||0,q=N.pop()||0;if(B-q<=j){for(let he=q;he<=B;he++){const pe=w[2*he],Se=w[2*he+1];pe>=i&&pe<=h&&Se>=o&&Se<=g&&O.push(_[he])}continue}const Y=q+B>>1,Q=w[2*Y],re=w[2*Y+1];Q>=i&&Q<=h&&re>=o&&re<=g&&O.push(_[Y]),(L===0?i<=Q:o<=re)&&(N.push(q),N.push(Y-1),N.push(1-L)),(L===0?h>=Q:g>=re)&&(N.push(Y+1),N.push(B),N.push(1-L))}return O}within(i,o,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:_,nodeSize:w}=this,j=[0,g.length-1,0],N=[],O=h*h;for(;j.length;){const L=j.pop()||0,B=j.pop()||0,q=j.pop()||0;if(B-q<=w){for(let he=q;he<=B;he++)pR(_[2*he],_[2*he+1],i,o)<=O&&N.push(g[he]);continue}const Y=q+B>>1,Q=_[2*Y],re=_[2*Y+1];pR(Q,re,i,o)<=O&&N.push(g[Y]),(L===0?i-h<=Q:o-h<=re)&&(j.push(q),j.push(Y-1),j.push(1-L)),(L===0?i+h>=Q:o+h>=re)&&(j.push(Y+1),j.push(B),j.push(1-L))}return N}}function JA(c,i,o,h,g,_){if(g-h<=o)return;const w=h+g>>1;fR(c,i,w,h,g,_),JA(c,i,o,h,w-1,1-_),JA(c,i,o,w+1,g,1-_)}function fR(c,i,o,h,g,_){for(;g>h;){if(g-h>600){const O=g-h+1,L=o-h+1,B=Math.log(O),q=.5*Math.exp(2*B/3),Y=.5*Math.sqrt(B*q*(O-q)/O)*(L-O/2<0?-1:1);fR(c,i,o,Math.max(h,Math.floor(o-L*q/O+Y)),Math.min(g,Math.floor(o+(O-L)*q/O+Y)),_)}const w=i[2*o+_];let j=h,N=g;for(q1(c,i,h,o),i[2*g+_]>w&&q1(c,i,h,g);j<N;){for(q1(c,i,j,N),j++,N--;i[2*j+_]<w;)j++;for(;i[2*N+_]>w;)N--}i[2*h+_]===w?q1(c,i,h,N):(N++,q1(c,i,N,g)),N<=o&&(h=N+1),o<=N&&(g=N-1)}}function q1(c,i,o,h){eC(c,o,h),eC(i,2*o,2*h),eC(i,2*o+1,2*h+1)}function eC(c,i,o){const h=c[i];c[i]=c[o],c[o]=h}function pR(c,i,o,h){const g=c-o,_=i-h;return g*g+_*_}a.$=ds,a.A=Mc,a.B=El,a.C=ld,a.D=Nv,a.E=$u,a.F=2,a.G=A1,a.H=TI,a.I=Ro,a.J=class extends tS{},a.K=Jn,a.L=yp,a.M=$o,a.N=Cf,a.O=uc,a.P=Kt,a.Q=Lp,a.R=lf,a.S=dc,a.T=MA,a.U=od,a.V=tS,a.W=Ju,a.X=si,a.Y=mf,a.Z=ma,a._=hh,a.a=function(c){return Ca.API_CDN_URL_REGEX.test(c)},a.a$=qt,a.a0=Qd,a.a1=Zp,a.a2=Yu,a.a3=Af,a.a4=function(c){const i=c.value;let o=[];if(!i)return o;const h=Jn(i);return h!=="string"?(o=o.concat([new tS(c.key,i,`string expected, "${h}" found`)]),o):(OA(i,!0)||(o=o.concat([new tS(c.key,i,`invalid url "${i}"`)])),o)},a.a5=rt,a.a6=dg,a.a7=Yi,a.a8=Xt,a.a9=class{constructor(c){this.specification=c}possiblyEvaluate(c,i){return Jr(c.expression.evaluate(i))}interpolate(c,i,o){return{x:Vn(c.x,i.x,o),y:Vn(c.y,i.y,o),z:Vn(c.z,i.z,o),azimuthal:Vn(c.azimuthal,i.azimuthal,o),polar:Vn(c.polar,i.polar,o)}}},a.aA=wa,a.aB=Ur,a.aC=Et,a.aD=Le,a.aE=A,a.aF=function(c,i){const o={};for(let h=0;h<i.length;h++){const g=i[h];g in c&&(o[g]=c[g])}return o},a.aG=ve,a.aH=Oe,a.aI=class{constructor(c){this.entries={},this.scheduler=c}request(c,i,o,h){const g=this.entries[c]=this.entries[c]||{callbacks:[]};if(g.result){const[_,w]=g.result;return this.scheduler?this.scheduler.add(()=>{h(_,w)},i):h(_,w),()=>{}}return g.callbacks.push(h),g.cancel||(g.cancel=o((_,w)=>{g.result=[_,w];for(const j of g.callbacks)this.scheduler?this.scheduler.add(()=>{j(_,w)},i):j(_,w);setTimeout(()=>delete this.entries[c],3e3)})),()=>{g.result||(g.callbacks=g.callbacks.filter(_=>_!==h),g.callbacks.length||(g.cancel(),delete this.entries[c]))}}},a.aJ=function(c,i,o){const h=JSON.stringify(c.request);return c.data&&(this.deduped.entries[h]={result:[null,c.data]}),this.deduped.request(h,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},g=>{const _=Vu(c.request,(w,j,N,O)=>{w?g(w):j&&g(null,{vectorTile:o?void 0:new yd.VectorTile(new I2(j)),rawData:j,cacheControl:N,expires:O})});return()=>{_.cancel(),g()}},i)},a.aK=function(c){hp++,hp>_l&&(c.getActor().send("enforceCacheSizeLimit",jc),hp=0)},a.aL=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},a.aM=di,a.aN=JI,a.aO=ak,a.aP=QI,a.aQ=function(c,i){const o=document.createElement("video");o.muted=!0,o.onloadstart=function(){i(null,o)};for(let h=0;h<c.length;h++){const g=document.createElement("source");pp(c[h])||(o.crossOrigin="Anonymous"),g.src=c[h],o.appendChild(g)}return{cancel:()=>{}}},a.aR=K2,a.aS=function(c){return fetch(c).then(i=>i.arrayBuffer()).then(i=>sR(i,0,c))},a.aT=lR,a.aU=class{constructor(c,i,o,h){this.id=c,this.position=i!=null?new ue(i[0],i[1]):new ue(0,0),this.orientation=o??[0,0,0],this.nodes=h,this.uploaded=!1,this.aabb=new hi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(c,i){if(Z(c.matrix,i,c.matrix),c.meshes)for(const o of c.meshes){const h=hi.applyTransformFast(o.aabb,c.matrix);this.aabb.encapsulate(h)}if(c.children)for(const o of c.children)this._applyTransformations(o,c.matrix)}computeBoundsAndApplyParent(){const c=W([]);for(const i of this.nodes)this._applyTransformations(i,c)}computeModelMatrix(c,i,o,h,g,_,w=!1){gk(this.matrix,this,c.transform,this.position,i,o,h,g,_,w)}upload(c){if(!this.uploaded){for(const i of this.nodes)kA(i,c);for(const i of this.nodes)nS(i);this.uploaded=!0}}destroy(){for(const c of this.nodes)RA(c)}},a.aV=Fn,a.aW=j1,a.aX=Fe,a.aY=$e,a.aZ=cd,a.a_=la,a.aa=ui,a.ab=ja,a.ac=lt,a.ad=un,a.ae=jt,a.af=Ue,a.ag=sd,a.ah=Dh,a.ai=Vn,a.aj=en,a.ak=zy,a.al=te,a.am=Kr,a.an=class{constructor(c){this.specification=c}possiblyEvaluate(c,i){return function([o,h]){const g=Jr([1,o,h]);return{x:g.x,y:g.y,z:g.z}}(c.expression.evaluate(i))}interpolate(c,i,o){return{x:Vn(c.x,i.x,o),y:Vn(c.y,i.y,o),z:Vn(c.z,i.z,o)}}},a.ao=function(c,i,o=0,h=!0){const g=new Kt(o,o),_=c.sub(g),w=i.add(g),j=[_,new Kt(w.x,_.y),w,new Kt(_.x,w.y)];return h&&j.push(_.clone()),j},a.ap=function(c,i){const o=[];for(let h=0;h<c.length;h++){const g=Ye(h-1,-1,c.length-1),_=Ye(h+1,-1,c.length-1),w=c[h],j=c[_],N=c[g].sub(w).unit(),O=j.sub(w).unit(),L=O.angleWithSep(N.x,N.y),B=N.add(O).unit().mult(-1*i/Math.sin(L/2));o.push(w.add(B))}return o},a.aq=LI,a.ar=ti,a.as=function(c,i,o=0){return Nt(((i.x-o)*c.scale-c.x)*en,(i.y*c.scale-c.y)*en,st(i.z,i.y))},a.at=Ir,a.au=Mn,a.av=ul,a.aw=xr,a.ax=function(c){let i=1/0,o=1/0,h=-1/0,g=-1/0;for(const _ of c)i=Math.min(i,_.x),o=Math.min(o,_.y),h=Math.max(h,_.x),g=Math.max(g,_.y);return{min:new Kt(i,o),max:new Kt(h,g)}},a.ay=Ie,a.az=Z,a.b=function(c){return Ca.API_FONTS_REGEX.test(c)},a.b$=Ge,a.b0=If,a.b1=Z2,a.b2=function(){Pl.isLoading()||Pl.isLoaded()||ad()!=="deferred"||Fx()},a.b3=hg,a.b4=Tn,a.b5=Rv,a.b6=Ti,a.b7=At,a.b8=pv,a.b9=yn,a.bA=function(c,i){const{x:o,y:h}=c.point,g=H_(o,h,c.worldSize/c._pixelsPerMercatorPixel,0,0);return Z(g,g,Ky(bu(i)))},a.bB=E,a.bC=function(c){return c[0]=0,c[1]=0,c[2]=0,c},a.bD=function(c,i){return Math.hypot(i[0]-c[0],i[1]-c[1],i[2]-c[2])},a.bE=vn,a.bF=ot,a.bG=Zn,a.bH=E1,a.bI=yc,a.bJ=mA,a.bK=function(c,i,o,h,g){const _=5*i+2;c.float32[_+0]=o,c.float32[_+1]=h,c.float32[_+2]=g},a.bL=W2,a.bM=m,a.bN=qn,a.bO=As,a.bP=Cg,a.bQ=dk,a.bR=A2,a.bS=g1,a.bT=vA,a.bU=NI,a.bV=pA,a.bW=QA,a.bX=Ye,a.bY=Ds,a.bZ=function(c,i,o){o*=.5;var h=i[0],g=i[1],_=i[2],w=i[3],j=Math.sin(o),N=Math.cos(o);return c[0]=h*N+g*j,c[1]=g*N-h*j,c[2]=_*N+w*j,c[3]=w*N-_*j,c},a.b_=Ft,a.ba=hc,a.bb=hd,a.bc=xc,a.bd=Wi,a.be=u0,a.bf=AA,a.bg=function(c,i){const o=Dh(i.zoom);if(o===0)return bu(c);const h=Xy(c),g=$_(h),_=Ie(h.getWest())*i.worldSize,w=Ie(h.getEast())*i.worldSize,j=Oe(h.getNorth())*i.worldSize,N=Oe(h.getSouth())*i.worldSize,O=[_,j,0],L=[w,j,0],B=[_,N,0],q=[w,N,0],Y=$([],i.globeMatrix);return un(O,O,Y),un(L,L,Y),un(B,B,Y),un(q,q,Y),g[0]=wu(g[0],B,o),g[1]=wu(g[1],q,o),g[2]=wu(g[2],L,o),g[3]=wu(g[3],O,o),hi.fromPoints(g)},a.bh=lm,a.bi=$,a.bj=_g,a.bk=wu,a.bl=Th,a.bm=Go,a.bn=me,a.bo=ne,a.bp=hS,a.bq=I2,a.br=Vu,a.bs=function(c,i){const o=[];for(const h in c)h in i||o.push(h);return o},a.bt=it,a.bu=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.bv=el,a.bw=function(c){var i=new T(16);return i[0]=c[0],i[1]=c[1],i[2]=c[2],i[3]=c[3],i[4]=c[4],i[5]=c[5],i[6]=c[6],i[7]=c[7],i[8]=c[8],i[9]=c[9],i[10]=c[10],i[11]=c[11],i[12]=c[12],i[13]=c[13],i[14]=c[14],i[15]=c[15],i},a.bx=W,a.by=se,a.bz=F,a.c=rs,a.c$=function(c){return c({pluginStatus:To,pluginURL:pu}),Wp.on("pluginStateChange",c),c},a.c0=sa,a.c1=Ar,a.c2=function(c,i){return c[0]=-i[0],c[1]=-i[1],c[2]=-i[2],c[3]=i[3],c},a.c3=qe,a.c4=function(c,i,o,h,g){var _,w=1/Math.tan(i/2);return c[0]=w/o,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=w,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,g!=null&&g!==1/0?(c[10]=(g+h)*(_=1/(h-g)),c[14]=2*g*h*_):(c[10]=-1,c[14]=-2*h),c},a.c5=function(c,i,o,h,g,_,w){var j=1/(i-o),N=1/(h-g),O=1/(_-w);return c[0]=-2*j,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*N,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*O,c[11]=0,c[12]=(i+o)*j,c[13]=(g+h)*N,c[14]=(w+_)*O,c[15]=1,c},a.c6=Ce,a.c7=function(c,i,o){c[4*i+0]=o[0],c[4*i+1]=o[1],c[4*i+2]=o[2],c[4*i+3]=o[3]},a.c8=cl,a.c9=Il,a.cA=J2,a.cB=tt,a.cC=sk,a.cD=function(c){const i=sk(c,!0);return E([],[i[0],i[1],i[4],i[5]])},a.cE=ie,a.cF=Es,a.cG=ge,a.cH=function(c){const{x:i,y:o}=c.point,{lng:h,lat:g}=c._center;return H_(i,o,c.worldSize,h,g)},a.cI=ut,a.cJ=le,a.cK=Sa,a.cL=M,a.cM=function(c,i,o){let h=0;for(let g=0;g<2;++g)c[g]>0&&(h+=(c[g]-0)*(c[g]-0)),i[g]<0&&(h+=(0-i[g])*(0-i[g]));return h},a.cN=45,a.cO=Zm,a.cP=ze,a.cQ=Rf,a.cR=function(c,i,o){const h=Math.sqrt(c*c+i*i+o*o),g=h>0?Math.acos(o/h)*Te:0;let _=c!==0||i!==0?Math.atan2(-i,-c)*Te+90:0;return _<0&&(_+=360),[h,_,g]},a.cS=Nt,a.cT=Je,a.cU=vt,a.cV=hi,a.cW=Jr,a.cX=function(c){return[Math.pow(c[0],1/2.2),Math.pow(c[1],1/2.2),Math.pow(c[2],1/2.2)]},a.cY=He,a.cZ=OA,a.c_=function(c,i){return c.readFields(XQ,{icons:[]},i)},a.ca=ll,a.cb=ca,a.cc=em,a.cd=ue,a.ce=$I,a.cf=function(){var c=new T(4);return T!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c},a.cg=function(c,i,o){var h=i[0],g=i[1],_=i[2],w=i[3],j=Math.sin(o),N=Math.cos(o);return c[0]=h*N+_*j,c[1]=g*N+w*j,c[2]=h*-j+_*N,c[3]=g*-j+w*N,c},a.ch=function(c,i){return c[0]===i[0]&&c[1]===i[1]&&c[2]===i[2]&&c[3]===i[3]},a.ci=dn,a.cj=function(c){return Math.hypot(c[0],c[1],c[2],c[3])},a.ck=pi,a.cl=hr,a.cm=xa,a.cn=im,a.co=ok,a.cp=bi,a.cq=a2,a.cr=function(c,i,o,h,g,_,w,j,N){if(N.name==="globe")return a2(c,i,new bi(o,h,g),!1);const O=j1({z:o,x:h,y:g},N);return new hi([(_+O.x/O.scale)*i,i*(O.y/O.scale),w],[(_+O.x2/O.scale)*i,i*(O.y2/O.scale),j])},a.cs=function(c,i,o){return c[0]=Math.min(i[0],o[0]),c[1]=Math.min(i[1],o[1]),c[2]=Math.min(i[2],o[2]),c[3]=Math.min(i[3],o[3]),c},a.ct=function(c,i,o){return c[0]=Math.max(i[0],o[0]),c[1]=Math.max(i[1],o[1]),c[2]=Math.max(i[2],o[2]),c[3]=Math.max(i[3],o[3]),c},a.cu=function(c){const i=Math.round((c+45+360)%360/90)%4;return ye[i]},a.cv=et,a.cw=Ci,a.cx=D,a.cy=function(c){const i=W(new Float64Array(16));Z(i,c.pixelMatrix,c.globeMatrix);const o=[0,K,0],h=[0,X,0];return un(o,o,i),un(h,h,i),[o[0]>0&&o[0]<=c.width&&o[1]>0&&o[1]<=c.height&&!bg(c,new ue(c.center.lat,90)),h[0]>0&&h[0]<=c.width&&h[1]>0&&h[1]<=c.height&&!bg(c,new ue(c.center.lat,-90))]},a.cz=function(c,i){const{scale:o}=c.tileTransform,h=o*en/(c.tileSize*Math.pow(2,i.zoom-c.tileID.overscaledZ+c.tileID.canonical.z));return function(g,_,w){var j=_[1],N=_[2],O=_[3],L=w[0],B=w[1];return g[0]=_[0]*L,g[1]=j*L,g[2]=N*B,g[3]=O*B,g}(new Float32Array(4),i.inverseAdjustmentMatrix,[h,h])},a.d=function(c){return Ca.API_TILEJSON_REGEX.test(c)},a.d$=yg,a.d0=iS,a.d1=Av,a.d2=xA,a.d3=Rr,a.d4=id,a.d5=Ks,a.d6=ko,a.d7=cr,a.d8=function(c){const i=c.indexOf(wh);return i>=0?c.slice(0,i):c},a.d9=function(c){return c.indexOf(wh)>=0},a.dA=q_,a.dB=Fa,a.dC=fa,a.dD=256,a.dE=function(c,i){const o=[0,0,0];return un(o,o,lm(bu(i.canonical))),un(o,o,c),o},a.dF=c=>({u_camera_to_center_distance:new ca(c),u_extrude_scale:new ro(c),u_device_pixel_ratio:new ca(c),u_matrix:new cl(c),u_inv_rot_matrix:new cl(c),u_merc_center:new Il(c),u_tile_id:new ll(c),u_zoom_transition:new ca(c),u_up_dir:new ll(c),u_emissive_strength:new ca(c)}),a.dG=c=>({u_matrix:new cl(c),u_pixels_to_tile_units:new ro(c),u_device_pixel_ratio:new ca(c),u_width_scale:new ca(c),u_floor_width_scale:new ca(c),u_units_to_pixels:new Il(c),u_dash_image:new em(c),u_gradient_image:new em(c),u_image_height:new ca(c),u_texsize:new Il(c),u_tile_units_to_pixels:new ca(c),u_alpha_discard_threshold:new ca(c),u_trim_offset:new Il(c),u_trim_fade_range:new Il(c),u_trim_color:new Rf(c),u_emissive_strength:new ca(c),u_zbias_factor:new ca(c),u_tile_to_meter:new ca(c),u_ground_shadow_factor:new ll(c)}),a.dH=c=>({u_matrix:new cl(c),u_texsize:new Il(c),u_pixels_to_tile_units:new ro(c),u_device_pixel_ratio:new ca(c),u_width_scale:new ca(c),u_floor_width_scale:new ca(c),u_image:new em(c),u_units_to_pixels:new Il(c),u_tile_units_to_pixels:new ca(c),u_alpha_discard_threshold:new ca(c),u_trim_offset:new Il(c),u_trim_fade_range:new Il(c),u_trim_color:new Rf(c),u_emissive_strength:new ca(c),u_zbias_factor:new ca(c),u_tile_to_meter:new ca(c),u_ground_shadow_factor:new ll(c),u_pattern_transition:new ca(c)}),a.dI=Dl,a.dJ=JY,a.dK=o2,a.dL=(c,i,o,h,g,_)=>{const w=c.transform,j=w.projection.name==="globe";let N;if(_.paint.get("circle-pitch-alignment")==="map")if(j){const L=q_(w.zoom,i.canonical)*w._pixelsPerMercatorPixel;N=Float32Array.from([L,0,0,L])}else N=w.calculatePixelsToTileUnitsMatrix(o);else N=new Float32Array([w.pixelsToGLUnits[0],0,0,w.pixelsToGLUnits[1]]);const O={u_camera_to_center_distance:c.transform.getCameraToCenterDistance(w.projection),u_matrix:c.translatePosMatrix(i.projMatrix,o,_.paint.get("circle-translate"),_.paint.get("circle-translate-anchor")),u_device_pixel_ratio:tl.devicePixelRatio,u_extrude_scale:N,u_inv_rot_matrix:Z_,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:_.paint.get("circle-emissive-strength")};if(j){O.u_inv_rot_matrix=h,O.u_merc_center=g,O.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],O.u_zoom_transition=Dh(w.zoom);const L=g[0]*en,B=g[1]*en;O.u_up_dir=w.projection.upVector(new bi(0,0,0),L,B)}return O},a.dM=Bs,a.dN=Js,a.dO=(c,i,o,h,g,_,w,j,N,O)=>{const L=c.transform,B=L.pitch<15?Oi(.07,.7,Le((14-L.zoom)/5,0,1)):.07,q=o.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:Wr(c,i,o,h),u_texsize:i.imageAtlasTexture?i.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:L.calculatePixelsToTileUnitsMatrix(i),u_device_pixel_ratio:g,u_width_scale:_,u_floor_width_scale:w,u_image:0,u_tile_units_to_pixels:Mr(i,L),u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:j,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toRenderColor(q?null:o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength"),u_zbias_factor:B,u_tile_to_meter:Je(i.tileID.canonical,0),u_ground_shadow_factor:N,u_pattern_transition:O}},a.dP=(c,i,o,h,g,_,w,j,N,O)=>{const L=c.transform,B=L.calculatePixelsToTileUnitsMatrix(i),q=o.paint.get("line-trim-color-use-theme").constantOr("default")==="none",Y=L.pitch<15?Oi(.07,.7,Le((14-L.zoom)/5,0,1)):.07;return{u_matrix:Wr(c,i,o,h),u_pixels_to_tile_units:B,u_device_pixel_ratio:_,u_width_scale:w,u_floor_width_scale:j,u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:g,u_texsize:na(o)&&i.lineAtlasTexture?i.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Mr(i,c.transform),u_alpha_discard_threshold:0,u_trim_offset:N,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toRenderColor(q?null:o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength"),u_zbias_factor:Y,u_tile_to_meter:Je(i.tileID.canonical,0),u_ground_shadow_factor:O}},a.dQ=nn,a.dR=Sg,a.dS=st,a.dT=T0,a.dU=io,a.dV=wv,a.dW=vd,a.dX=450,a.dY=7,a.dZ=OQ,a.d_=Vr,a.da=function(c){const i=c.lastIndexOf(wh);return i>=0?c.slice(i+1):""},a.db=function(c){const i=[],o=c.id;return o===void 0&&i.push({message:`layers.${o}: missing required property "id"`}),c.render===void 0&&i.push({message:`layers.${o}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&i.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),i},a.dc=function(c,i,o,h){return c.type==="custom"?new IQ(c,i):new HQ[c.type](c,i,o,h)},a.dd=Ln,a.de=function(c){const i=c.indexOf(wh);return i>=0?c.slice(i+1):""},a.df=class extends Rv{constructor(c,i){super(c._vectorTileFeature,c._z,c._x,c._y,c.id),c.state&&(this.state=Object.assign({},c.state)),this.target=i.target,this.namespace=i.namespace,i.properties&&(this.properties=i.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=c.source,this.sourceLayer=c.sourceLayer,this.layer=c.layer)}toJSON(){const c=super.toJSON();return c.target=this.target,c.namespace=this.namespace,c}},a.dg=Wp,a.dh=Io,a.di=Hy,a.dj=class extends Ol{constructor(c){super(c),this.current=o0}set(c,i,o){if(this.fetchUniformLocation(c,i)){for(let h=0;h<9;h++)if(o[h]!==this.current[h]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}}},a.dk=Me,a.dl=function(c,i,o){const h=Dh(o.zoom),g=c.style.map._antialias,_=c.terrain&&c.terrain.exaggeration()>0;return h===0&&!g&&!_},a.dm=function(c){const i=c.pixelsPerMeter,o=i/Ce(1,c.center.lat),h=W(new Float64Array(16));return ne(h,h,[c.point.x,c.point.y,0]),ie(h,h,[o,o,i]),Float32Array.from(h)},a.dn=Xy,a.dp=function(c){const i=et-5;c=Le(c,-80.051129,i)/i*90;const o=Math.pow(Math.abs(Math.sin(te(c))),3);return Math.round(o*(H.length-1))},a.dq=function(c,i,o,h){const g=i.getNorth(),_=i.getSouth(),w=i.getWest(),j=i.getEast(),N=1<<c.z,O=j-w,L=g-_,B=O/U,q=-L/H[o],Y=[0,B,0,q,0,0,g,w,0];if(c.z>0){const Q=180/h;R(Y,Y,[Q/O+1,0,0,0,Q/L+1,0,-.5*Q/B,.5*Q/q,1])}return Y[2]=N,Y[5]=c.x,Y[8]=c.y,Y},a.dr=bu,a.ds=function(c,i,o){const h=W(new Float64Array(16)),g=(i/(1<<c)-.5)*Math.PI*2;return ae(h,o.globeMatrix,g),Float32Array.from(h)},a.dt=class{isDataAvailableAtPoint(c){const i=this._source();if(this.isUsingMockSource()||!i||c.y<0||c.y>1)return!1;const o=i.getSource().maxzoom,h=1<<o,g=Math.floor(c.x),_=Math.floor((c.x-g)*h),w=Math.floor(c.y*h),j=this.findDEMTileFor(new di(o,g,o,_,w));return!(!j||!j.dem)}getAtPointOrZero(c,i=0){return this.getAtPoint(c,i)||0}getAtPoint(c,i,o=!0){if(this.isUsingMockSource())return null;i==null&&(i=null);const h=this._source();if(!h||c.y<0||c.y>1)return i;const g=h.getSource().maxzoom,_=1<<g,w=Math.floor(c.x),j=c.x-w,N=new di(g,w,g,Math.floor(j*_),Math.floor(c.y*_)),O=this.findDEMTileFor(N);if(!O||!O.dem)return i;const L=O.dem,B=1<<O.tileID.canonical.z,q=(j*B-O.tileID.canonical.x)*L.dim,Y=(c.y*B-O.tileID.canonical.y)*L.dim,Q=Math.floor(q),re=Math.floor(Y);return(o?this.exaggeration():1)*Vn(Vn(L.get(Q,re),L.get(Q,re+1),Y-re),Vn(L.get(Q+1,re),L.get(Q+1,re+1),Y-re),q-Q)}getAtTileOffset(c,i,o){const h=1<<c.canonical.z;return this.getAtPointOrZero(new lt(c.wrap+(c.canonical.x+i/en)/h,(c.canonical.y+o/en)/h))}getAtTileOffsetFunc(c,i,o,h){return g=>{const _=this.getAtTileOffset(c,g.x,g.y),w=h.upVector(c.canonical,g.x,g.y);return Ge(w,w,_*h.upVectorScale(c.canonical,i,o).metersToTile),w}}getForTilePoints(c,i,o,h){if(this.isUsingMockSource())return!1;const g=Pv.create(this,c,h);return!!g&&(i.forEach(_=>{_[2]=this.exaggeration()*g.getElevationAt(_[0],_[1],o)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const i=this.findDEMTileFor(c);if(!i||!i.dem)return null;const o=i.dem.tree,h=i.tileID,g=1<<c.canonical.z-h.canonical.z;let _=c.canonical.x/g-h.canonical.x,w=c.canonical.y/g-h.canonical.y,j=0;for(let N=0;N<c.canonical.z-h.canonical.z&&!o.leaves[j];N++){_*=2,w*=2;const O=2*Math.floor(w)+Math.floor(_);j=o.childOffsets[j]+O,_%=1,w%=1}return{min:this.exaggeration()*o.minimums[j],max:this.exaggeration()*o.maximums[j]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,i,o){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const c=this.visibleDemTiles;if(c.length===0)return null;let i=!1,o=Number.MAX_VALUE,h=Number.MIN_VALUE;for(const g of c){const _=this.getMinMaxForTile(g.tileID);_&&(o=Math.min(o,_.min),h=Math.max(h,_.max),i=!0)}return i?{min:o,max:h}:null}},a.du=Y_,a.dv=_u,a.dw=function(c,i){return[Math.pow(c[0],2.2)*i,Math.pow(c[1],2.2)*i,Math.pow(c[2],2.2)*i]},a.dx=P,a.dy=function(c,i){var o=Math.sin(i),h=Math.cos(i);return c[0]=h,c[1]=o,c[2]=0,c[3]=-o,c[4]=h,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},a.dz=er,a.e=Ca,a.e$=cR,a.e0=256,a.e1=Ky,a.e2=Eo,a.e3=ae,a.e4=function(c,i){return c[0]=i[0],c[1]=i[1],c[2]=i[2],c[3]=i[4],c[4]=i[5],c[5]=i[6],c[6]=i[8],c[7]=i[9],c[8]=i[10],c},a.e5=gc,a.e6=Mh,a.e7=function(c,i,o,h,g){return Le((c-i)/(o-i)*(g-h)+h,h,g)},a.e8=Hn,a.e9=function(c,i){var o=i[0],h=i[1],g=i[2],_=i[3],w=i[4],j=i[5],N=i[6],O=i[7],L=i[8],B=L*w-j*O,q=-L*_+j*N,Y=O*_-w*N,Q=o*B+h*q+g*Y;return Q?(c[0]=B*(Q=1/Q),c[1]=(-L*h+g*O)*Q,c[2]=(j*h-g*w)*Q,c[3]=q*Q,c[4]=(L*o-g*N)*Q,c[5]=(-j*o+g*_)*Q,c[6]=Y*Q,c[7]=(-O*o+h*N)*Q,c[8]=(w*o-h*_)*Q,c):null},a.eA=function(c,i,o){return c[0]=i[0]/o[0],c[1]=i[1]/o[1],c[2]=i[2]/o[2],c},a.eB=Zr,a.eC=de,a.eD=It,a.eE=function(c,i,o,h){return c[0]=i,c[1]=o,c[2]=h,c},a.eF=function([c,i,o]){const h=Math.hypot(c,i,o),g=Math.atan2(c,o),_=.5*Math.PI-Math.acos(-i/h);return new ue(le(g),le(_))},a.eG=ls,a.eH=NA,a.eI=function(c){const i=c.navigator?c.navigator.userAgent:null;return!!function(o){if(ea==null){const h=o.navigator?o.navigator.userAgent:null;ea=!!o.safari||!(!h||!(/\b(iPad|iPhone|iPod)\b/.test(h)||h.match("Safari")&&!h.match("Chrome")))}return ea}(c)&&!(!i||!(i.match("Version/15.4")||i.match("Version/15.5")||i.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},a.eJ=function(c,i){jc=c,_l=i},a.eK=bg,a.eL=G_,a.eM=function(c){const i=[0,0,0],o=W(new Float64Array(16));return Z(o,c.pixelMatrix,c.globeMatrix),un(i,i,o),new Kt(i[0],i[1])},a.eN=function(c,i,o=!1){if(To===Nf||To===qp||To===Hp)throw new Error("setRTLTextPlugin cannot be called multiple times.");pu=tl.resolveURL(c),To=Nf,ug=i,Gp(),o||Fx()},a.eO=ad,a.eP=function(){iS().acquire(LA)},a.eQ=function(){const c=R1;c&&(c.isPreloaded()&&c.numActive()===1?(c.release(LA),R1=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},a.eR=N0,a.eS=function(c){const i=Gm();if(!i)return;const o=i.delete(Ys);c&&o.then(()=>c()).catch(c)},a.eT=k1,a.eU=Jk,a.eV=function(c){ZA=tl.resolveURL(c),kv||(kv=new Nv(iS(),new $u)),kv.broadcast("setDracoUrl",ZA)},a.eW=eR,a.eX=function(c){Iv=tl.resolveURL(c),kv||(kv=new Nv(iS(),new $u)),kv.broadcast("setMeshoptUrl",Iv)},a.eY=mn,a.eZ=Oh,a.e_=Vh,a.ea=Ix,a.eb=In,a.ec=xt,a.ed=class{constructor(c,i,o,h){this.context=c,this.format=h,this.size=o,this.texture=c.gl.createTexture();const[g,_,w]=this.size,{gl:j}=c;j.bindTexture(j.TEXTURE_3D,this.texture),c.pixelStoreUnpackFlipY.set(!1),c.pixelStoreUnpack.set(1),c.pixelStoreUnpackPremultiplyAlpha.set(!1),j.texImage3D(j.TEXTURE_3D,0,this.format,g,_,w,0,CA(this.format),jA(this.format),i.data)}bind(c,i){const{context:o}=this,{gl:h}=o;h.bindTexture(h.TEXTURE_3D,this.texture),c!==this.minFilter&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MAG_FILTER,c),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_MIN_FILTER,c),this.minFilter=c),i!==this.wrapS&&(h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_S,i),h.texParameteri(h.TEXTURE_3D,h.TEXTURE_WRAP_T,i),this.wrapS=i)}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}},a.ee=function(c,i){if(c===i){var o=i[1],h=i[2],g=i[3],_=i[6],w=i[7],j=i[11];c[1]=i[4],c[2]=i[8],c[3]=i[12],c[4]=o,c[6]=i[9],c[7]=i[13],c[8]=h,c[9]=_,c[11]=i[14],c[12]=g,c[13]=w,c[14]=j}else c[0]=i[0],c[1]=i[4],c[2]=i[8],c[3]=i[12],c[4]=i[1],c[5]=i[5],c[6]=i[9],c[7]=i[13],c[8]=i[2],c[9]=i[6],c[10]=i[10],c[11]=i[14],c[12]=i[3],c[13]=i[7],c[14]=i[11],c[15]=i[15];return c},a.ef=DA,a.eg=nt,a.eh=[1,1,1],a.ei=function(c,i,o,h){var g=new T(4);return g[0]=c,g[1]=i,g[2]=o,g[3]=h,g},a.ej=Mi,a.ek=function(c,i,o,h){var g=i[0],_=i[1],w=i[2],j=i[3];return c[0]=g+h*(o[0]-g),c[1]=_+h*(o[1]-_),c[2]=w+h*(o[2]-w),c[3]=j+h*(o[3]-j),c},a.el=Pv,a.em=Mv,a.en=xu,a.eo=dd,a.ep=function(c,i,o,h,g,_,w,j,N,O,L,B,q,Y,Q,re){var he=new T(16);return he[0]=c,he[1]=i,he[2]=o,he[3]=h,he[4]=g,he[5]=_,he[6]=w,he[7]=j,he[8]=N,he[9]=O,he[10]=L,he[11]=B,he[12]=q,he[13]=Y,he[14]=Q,he[15]=re,he},a.eq=ce,a.er=Jp,a.es=Qp,a.et=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Kt(1/0,1/0),max:new Kt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(c,i=!1){const o=v0(new Kt(0,0),new Kt(en,en),c),h=[];if(i&&!p1(o,this._globalClipBounds))return h;for(const g of this._activeRegions){if(g.hiddenByOverlap||!p1(o,g))continue;const _=m1(g.min,g.max,c);h.push({min:_.min,max:_.max,sourceId:this._sourceIds[g.priority],footprint:g.footprint,footprintTileId:g.tileId,order:g.order,clipMask:g.clipMask,clipScope:g.clipScope})}return h}setSources(c){this._setSources(c.map(i=>({getSourceId:()=>i.cache.id,getFootprints:()=>{const o=[];for(const h of i.cache.getVisibleCoordinates()){const g=i.cache.getTile(h).buckets[i.layer];g&&g.updateFootprints(h.toUnwrapped(),o)}return o},getOrder:()=>i.order,getClipMask:()=>i.clipMask,getClipScope:()=>i.clipScope})))}_addSource(c){const i=c.getFootprints();if(i.length===0)return;const o=c.getOrder(),h=c.getClipMask(),g=c.getClipScope();for(const _ of i){if(!_.footprint)continue;const w=v0(_.footprint.min,_.footprint.max,_.id);this._activeRegions.push({min:w.min,max:w.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:_.id,footprint:_.footprint,order:o,clipMask:h,clipScope:g})}this._sourceIds.push(c.getSourceId())}_computeReplacement(){this._activeRegions.sort((i,o)=>i.priority-o.priority||xv(i.min,o.min)||xv(i.max,o.max)||i.order-o.order||i.clipMask-o.clipMask||function(h,g){const _=(w,j)=>w+j;return h.length-g.length||h.reduce(_,"").localeCompare(g.reduce(_,""))}(i.clipScope,o.clipScope));let c=this._activeRegions.length!==this._prevRegions.length;if(!c){let i=0;for(;!c&&i!==this._activeRegions.length;){const o=this._activeRegions[i],h=this._prevRegions[i];c=o.priority!==h.priority||!T2(o,h)||o.order!==h.order||o.clipMask!==h.clipMask||!el(o.clipScope,h.clipScope),++i}}if(c){++this._updateTime;for(const o of this._activeRegions)o.order!==y0&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,o.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,o.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,o.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,o.max.y));const i=o=>{const h=this._activeRegions;if(o>=h.length)return o;const g=h[o].priority;for(;o<h.length&&h[o].priority===g;)++o;return o};if(this._sourceIds.length>1){let o=0,h=i(o);for(;o!==h;){let g=o;const _=o;for(;g!==h;){const w=this._activeRegions[g];w.hiddenByOverlap=!1;for(let j=0;j<_;j++){const N=this._activeRegions[j];if(!N.hiddenByOverlap&&w.order===y0&&p1(w,N)&&(w.hiddenByOverlap=Mg(w.footprint,w.tileId,N.footprint,N.tileId),w.hiddenByOverlap))break}++g}o=h,h=i(o)}}}}_setSources(c){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let i=c.length-1;i>=0;i--)this._addSource(c[i]);this._computeReplacement()}},a.eu=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy()}_fillGridMeshWithLods(c,i){const o=new hc,h=new la,g=[],_=c+1+2,w=i[0]+1,j=i[0]+1+(1+i.length),N=(O,L,B)=>{let q=O===_-1?O-2:O===0?O:O-1;return q+=B?24575:0,[q,L]};for(let O=0;O<_;++O)o.emplaceBack(...N(O,0,!0));for(let O=0;O<w;++O)for(let L=0;L<_;++L)o.emplaceBack(...N(L,O,(L===0||L===_-1)&&!0));for(let O=0;O<i.length;++O){const L=i[O];for(let B=0;B<_;++B)o.emplaceBack(...N(B,L,!0))}for(let O=0;O<i.length;++O){const L=h.length,B=i[O]+1+2,q=new la;for(let re=0;re<B-1;re++){const he=re===B-2,pe=he?_*(j-i.length+O-re):_;for(let Se=0;Se<_-1;Se++){const be=re*_+Se;re===0||he||Se===0||Se===_-2?(q.emplaceBack(be+1,be,be+pe),q.emplaceBack(be+pe,be+pe+1,be+1)):(h.emplaceBack(be+1,be,be+pe),h.emplaceBack(be+pe,be+pe+1,be+1))}}const Y=Wi.simpleSegment(0,L,o.length,h.length-L);for(let re=0;re<q.uint16.length;re+=3)h.emplaceBack(q.uint16[re],q.uint16[re+1],q.uint16[re+2]);const Q=Wi.simpleSegment(0,L,o.length,h.length-L);g.push({withoutSkirts:Y,withSkirts:Q})}return{vertices:o,indices:h,segments:g}}_createGrid(c){const i=this._fillGridMeshWithLods(U,H);this._gridSegments=i.segments,this._gridBuffer=c.createVertexBuffer(i.vertices,xc.members),this._gridIndexBuffer=c.createIndexBuffer(i.indices,!0)}_createPoles(c){const i=new la;for(let w=0;w<=U;w++)i.emplaceBack(0,w+1,w+2);this._poleIndexBuffer=c.createIndexBuffer(i,!0);const o=new gc,h=new gc,g=new gc,_=new gc;this._poleSegments=[];for(let w=0,j=0;w<M;w++){const N=360/(1<<w);o.emplaceBack(0,-A,0,.5,0),h.emplaceBack(0,-A,0,.5,1),g.emplaceBack(0,-A,0,.5,.5),_.emplaceBack(0,-A,0,.5,.5);for(let O=0;O<=U;O++){let L=O/U,B=0;const q=Vn(0,N,L),[Y,Q,re]=J(s2,Pa,q,A);o.emplaceBack(Y,Q,re,L,B),h.emplaceBack(Y,Q,re,L,1-B);const he=te(q);L=.5+.5*Math.sin(he),B=.5+.5*Math.cos(he),g.emplaceBack(Y,Q,re,L,B),_.emplaceBack(Y,Q,re,L,1-B)}this._poleSegments.push(Wi.simpleSegment(j,0,66,64)),j+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(o,ao,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(h,ao,!1),this._texturedPoleNorthVertexBuffer=c.createVertexBuffer(g,ao,!1),this._texturedPoleSouthVertexBuffer=c.createVertexBuffer(_,ao,!1)}getGridBuffers(c,i){return[this._gridBuffer,this._gridIndexBuffer,i?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c,i){return[i?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,i?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}},a.ev=y0,a.ew=De,a.ex=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},a.ey=Be,a.ez=Bt,a.f=function(c){return c.indexOf("mapbox:")===0},a.f0=uR,a.f1=Wt,a.f2=hm,a.f3="hd_road_elevation",a.f4=kl,a.f5=zn,a.f6=dl,a.f7=gA,a.f8=C0,a.f9=function(c,i,o,h,g,_,w,j=1,N,O){c.createArrays(),c.tilePixelRatio=en/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const L=c.layers[0].layout,B=c.layers[0]._unevaluatedLayout._values,q={};q.scaleFactor=j,q.textSizeScaleRange=L.get("text-size-scale-range"),q.iconSizeScaleRange=L.get("icon-size-scale-range");const[Y,Q]=q.textSizeScaleRange,[re,he]=q.iconSizeScaleRange;q.textScaleFactor=Le(q.scaleFactor,Y,Q),q.iconScaleFactor=Le(q.scaleFactor,re,he);const pe=B["text-size"],Se=B["icon-size"];if(c.textSizeData.kind==="composite"){const{minZoom:Ve,maxZoom:We}=c.textSizeData;q.compositeTextSizes=[pe.possiblyEvaluate(new ui(Ve),_),pe.possiblyEvaluate(new ui(We),_)]}if(c.iconSizeData.kind==="composite"){const{minZoom:Ve,maxZoom:We}=c.iconSizeData;q.compositeIconSizes=[Se.possiblyEvaluate(new ui(Ve),_),Se.possiblyEvaluate(new ui(We),_)]}q.layoutTextSize=pe.possiblyEvaluate(new ui(w+1),_),q.layoutIconSize=Se.possiblyEvaluate(new ui(w+1),_),q.textMaxSize=pe.possiblyEvaluate(new ui(18),_);const be=L.get("symbol-placement"),oe=L.get("text-rotation-alignment")==="map"&&be!=="point",xe=L.get("text-size");let we=!1;const je=[];for(const Ve of c.features){const We=L.get("text-font").evaluate(Ve,{},_).join(","),Ze=xe.evaluate(Ve,{},_)*q.textScaleFactor,Qe=q.layoutTextSize.evaluate(Ve,{},_)*q.textScaleFactor,pt=q.layoutIconSize.evaluate(Ve,{},_)*q.iconScaleFactor,kt={horizontal:{},vertical:void 0},Ct=Ve.text;let Pt,Vt=[0,0];if(Ct){const Cn=Ct.toString(),nr=L.get("text-letter-spacing").evaluate(Ve,{},_)*As,dr=L.get("text-line-height").evaluate(Ve,{},_)*As,fr=zx(Cn)?nr:0,wr=L.get("text-anchor").evaluate(Ve,{},_),yr=L.get("text-variable-anchor");if(!yr){const Ne=L.get("text-radial-offset").evaluate(Ve,{},_);if(Ne)Vt=NI(wr,[Ne*As,yA]);else{const yt=L.get("text-offset").evaluate(Ve,{},_);Vt=[yt[0]*As,yt[1]*As]}}let mr=oe?"center":L.get("text-justify").evaluate(Ve,{},_);const Ei=be==="point",zi=Ei?L.get("text-max-width").evaluate(Ve,{},_)*As:1/0,Ae=Ne=>{c.allowVerticalPlacement&&Vp(Cn)&&(kt.vertical=fA(Ct,i,o,g,We,zi,dr,wr,Ne,fr,Vt,yc.vertical,!0,Qe,Ze,N))};if(!oe&&yr){const Ne=mr==="auto"?yr.map(Qt=>vA(Qt)):[mr];let yt=!1;for(let Qt=0;Qt<Ne.length;Qt++){const cn=Ne[Qt];if(!kt.horizontal[cn])if(yt)kt.horizontal[cn]=kt.horizontal[0];else{const on=fA(Ct,i,o,g,We,zi,dr,"center",cn,fr,Vt,yc.horizontal,!1,Qe,Ze,N);on&&(kt.horizontal[cn]=on,yt=on.positionedLines.length===1)}}Ae("left")}else{if(mr==="auto"&&(mr=vA(wr)),Ei||L.get("text-writing-mode").indexOf("horizontal")>=0||!Vp(Cn)){const Ne=fA(Ct,i,o,g,We,zi,dr,wr,mr,fr,Vt,yc.horizontal,!1,Qe,Ze,N);Ne&&(kt.horizontal[mr]=Ne)}Ae(Ei?"left":mr)}}let ht,Mt,dt,ft,$t,Gt,Dn,bn=!1;if(Ve.icon&&Ve.icon.hasPrimary()){const Cn=OI(Ve.icon,c.iconSizeData,B["icon-size"],_,c.zoom,Ve,N,q.iconScaleFactor);ht=Cn.iconPrimary,dt=Cn.iconSecondary;const nr=ht.toString();if(Mt=h.get(nr),Mt&&($t=L.get("icon-offset").evaluate(Ve,{},_),Gt=L.get("icon-anchor").evaluate(Ve,{},_),Dn=L.get("icon-text-fit").evaluate(Ve,{},_),Pt=uQ(g.get(nr),dt?g.get(dt.toString()):void 0,$t,Gt),bn=Mt.sdf,c.sdfIcons===void 0?c.sdfIcons=Mt.sdf:c.sdfIcons!==Mt.sdf&&or("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Mt.pixelRatio!==c.pixelRatio||L.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0)),dt){const dr=dt.toString();ft=h.get(dr)}}we=we||!(!Ve.icon||!Ve.icon.hasSecondary());const an=_A(kt.horizontal)||kt.vertical;c.iconsInText||(c.iconsInText=!!an&&an.iconsInText);const Ut=Qe*q.textScaleFactor/As,{defaultShapedIcon:sr,verticallyShapedIcon:An}=vQ(c,Pt,L,Ve,_,kt,Ut,$t,Dn);Dn!=="none"&&Pt&&(mI(Pt)||gI(Pt))&&(B2(0,Mt,ht,Pt,sr,Dn,O,h,g),B2(0,ft,dt,Pt,sr,Dn,O,h,g),An&&(B2(0,Mt,ht,Pt,An,Dn,O,h,g),B2(0,ft,dt,Pt,An,Dn,O,h,g))),Pt=sr,je.push({feature:Ve,shapedTextOrientations:kt,shapedText:an,shapedIcon:Pt,iconPrimary:ht,iconSecondary:dt,iconOffset:$t,iconAnchor:Gt,verticallyShapedIcon:An,layoutTextSize:Qe,layoutIconSize:pt,textOffset:Vt,isSDFIcon:bn,iconTextFit:Dn})}return{featureData:je,sizes:q,hasAnySecondaryIcon:we,textAlongLine:oe,symbolPlacement:be}},a.fa=EI,a.fb=function(c,i,o,h,g,_,w,j,N,O){const{featureData:L,hasAnySecondaryIcon:B,sizes:q,textAlongLine:Y,symbolPlacement:Q}=i;for(const re of L){const{shapedIcon:he,verticallyShapedIcon:pe,feature:Se,shapedTextOrientations:be,shapedText:oe,layoutTextSize:xe,textOffset:we,isSDFIcon:je,iconPrimary:Ve,iconSecondary:We,iconTextFit:Ze,iconOffset:Qe}=re;II(he,O.iconPositions,Ve,We),II(pe,O.iconPositions,Ve,We),yQ(be,O.iconPositions),(oe||he)&&_Q(c,Se,be,he,pe,N,q,xe,0,we,je,h,g,w,j,B,Ze,Qe,Y,Q)}o&&c.generateCollisionDebugBuffers(_,c.collisionBoxArray,q.textScaleFactor)},a.fc=yd,a.fd=dS,a.fe=Yl,a.ff=n1,a.fg=oI,a.fh=Is,a.fi=function(c){let i=0;if(new Uint32Array(c,0,1)[0]!==nR){const o=new Uint32Array(c,0,7),[,,h,g,_,w]=o;i=o.byteLength+g+_+w+_,(h!==c.byteLength||i>=c.byteLength)&&or("Invalid b3dm header information.")}return sR(c,i)},a.fj=function(c,i){const o=lR(c);for(const h of o){for(const g of h.meshes)XJ(g);h.lights&&(h.lightMeshIndex=h.meshes.length,h.meshes.push(KJ(h.lights,i)))}return o},a.fk=rS,a.fl=mi,a.fm=wk,a.fn=Pl,a.fo=function(c){Ql(),bl!=null&&bl.then(i=>{i.keys().then(o=>{for(let h=0;h<o.length-c;h++)i.delete(o[h]).catch(g=>or(g.message))}).catch(o=>or(o.message))}).catch(i=>or(i.message))},a.g=function(c,i){return Io(Xe(c,{method:"GET"}),i)},a.h=No,a.i=function(c){return Ca.API_STYLE_REGEX.test(c)&&!rs(c)},a.j=function(c){return decodeURIComponent(atob(c).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join(""))},a.k=function(c){return btoa(encodeURIComponent(c).replace(/%([0-9A-F]{2})/g,(i,o)=>String.fromCharCode(+("0x"+o))))},a.l=Xe,a.m=vx,a.n=function(c,i){return Io(Xe(c,{type:"json"}),i)},a.o=Wd,a.p=function(c,i){return Io(Xe(c,{method:"POST"}),i)},a.q=tl,a.r=hs,a.s=function(c){try{const i=self[c];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch{return!1}},a.t=Do,a.u=function(){return function c(i){return i?(i^Math.random()*(16>>i/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()},a.v=function(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)},a.w=or,a.x=function(){return FA||(FA=new N0),FA},a.y=qA,a.z=gp}),d(["./shared"],function(a){function b(Te){const te=Te?Te.url.toString():void 0;return te?performance.getEntriesByName(te):[]}function T(Te){if(typeof Te=="number"||typeof Te=="boolean"||typeof Te=="string"||Te==null)return JSON.stringify(Te);if(Array.isArray(Te)){let le="[";for(const ye of Te)le+=`${T(ye)},`;return`${le}]`}let te="{";for(const le of Object.keys(Te).sort())te+=`${le}:${T(Te[le])},`;return`${te}}`}function E(Te){let te="";for(const le of a.bu)(Te.type!=="model"||le!=="minzoom"&&le!=="maxzoom")&&(te+=`/${T(Te[le])}`);return te}class P{constructor(te){this.keyCache={},this._layers={},this._layerConfigs={},te&&this.replace(te)}replace(te,le){this._layerConfigs={},this._layers={},this.update(te,[],le)}update(te,le,ye){this._options=ye;for(const De of te)this._layerConfigs[De.id]=De,(this._layers[De.id]=a.dc(De,this.scope,null,this._options)).compileFilter(ye),this.keyCache[De.id]&&delete this.keyCache[De.id];for(const De of le)delete this.keyCache[De],delete this._layerConfigs[De],delete this._layers[De];this.familiesBySource={};const Me=function(De,Be){const Le={};for(let Ye=0;Ye<De.length;Ye++){const it=De[Ye];let Xe=Be&&Be[it.id];Xe||(it.type==="symbol"?Xe=it.id:(Xe=E(it),it.type==="line"&&it.paint&&function qt(nn){return typeof nn=="string"&&nn==="line-progress"||(Array.isArray(nn)?nn.some(qt):!(!nn||typeof nn!="object")&&Object.values(nn).some(qt))}(it.paint["line-width"])&&(Xe+=`/${T(it.paint["line-width"])}`))),Be&&(Be[it.id]=Xe);let St=Le[Xe];St||(St=Le[Xe]=[]),St.push(it)}const Ue=[];for(const Ye in Le)Ue.push(Le[Ye]);return Ue}(Object.values(this._layerConfigs),this.keyCache);for(const De of Me){const Be=De.map(St=>this._layers[St.id]),Le=Be[0];if(Le.visibility==="none")continue;const Ue=Le.source||"";let Ye=this.familiesBySource[Ue];Ye||(Ye=this.familiesBySource[Ue]={});const it=Le.sourceLayer||"_geojsonTileLayer";let Xe=Ye[it];Xe||(Xe=Ye[it]=[]),Xe.push(Be)}}}const I=1*a.e_;class R{constructor(te){const le={},ye=[];for(const Le in te){const Ue=te[Le],Ye=le[Le]={};for(const it in Ue.glyphs){const Xe=Ue.glyphs[+it];if(!Xe||Xe.bitmap.width===0||Xe.bitmap.height===0)continue;const St=Xe.metrics.localGlyph?I:1,qt={x:0,y:0,w:Xe.bitmap.width+2*St,h:Xe.bitmap.height+2*St};ye.push(qt),Ye[it]=qt}}const{w:Me,h:De}=a.H(ye),Be=new a.eZ({width:Me||1,height:De||1});for(const Le in te){const Ue=te[Le];for(const Ye in Ue.glyphs){const it=Ue.glyphs[+Ye];if(!it||it.bitmap.width===0||it.bitmap.height===0)continue;const Xe=le[Le][Ye],St=it.metrics.localGlyph?I:1;a.eZ.copy(it.bitmap,Be,{x:0,y:0},{x:Xe.x+St,y:Xe.y+St},it.bitmap)}}this.image=Be,this.positions=le}}a.eY(R,"GlyphAtlas");class F{constructor(te){this.tileID=new a.aM(te.tileID.overscaledZ,te.tileID.wrap,te.tileID.canonical.z,te.tileID.canonical.x,te.tileID.canonical.y),this.tileZoom=te.tileZoom,this.uid=te.uid,this.zoom=te.zoom,this.lut=te.lut,this.canonical=te.tileID.canonical,this.pixelRatio=te.pixelRatio,this.tileSize=te.tileSize,this.source=te.source,this.scope=te.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=te.showCollisionBoxes,this.collectResourceTiming=!!te.request&&te.request.collectResourceTiming,this.promoteId=te.promoteId,this.isSymbolTile=te.isSymbolTile,this.tileTransform=a.aW(te.tileID.canonical,te.projection),this.projection=te.projection,this.worldview=te.worldview,this.localizableLayerIds=te.localizableLayerIds,this.brightness=te.brightness,this.extraShadowCaster=!!te.extraShadowCaster,this.tessellationStep=te.tessellationStep,this.scaleFactor=te.scaleFactor}parse(te,le,ye,Me,De,Be){this.status="parsing",this.data=te,this.collisionBoxArray=new a.b0;const Le=new a.e$(Object.keys(te.layers).sort()),Ue=new a.f0(this.tileID,this.promoteId);Ue.bucketLayerIDs=[];const Ye={},it=new a.f1(256,256),Xe={featureIndex:Ue,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:it,availableImages:ye,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},St=le.familiesBySource[this.source];for(const Cr in St){const Jr=te.layers[Cr];if(!Jr)continue;let mi=!1,Ti=!1,ea=!1;for(const fa of St[Cr])fa[0].type==="symbol"?mi=!0:Ti=!0,fa[0].is3D()&&fa[0].type!=="model"&&(ea=!0);if(this.extraShadowCaster&&!ea||this.isSymbolTile===!0&&!mi||this.isSymbolTile===!1&&!Ti)continue;Jr.version===1&&a.w(`Vector tile source "${this.source}" layer "${Cr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ar=Le.encode(Cr),qi=[];let us=!1;for(let fa=0,Fa=0;fa<Jr.length;fa++){const ci=Jr.feature(fa),Ca=Ue.getId(ci,Cr);if(this.localizableLayerIds&&this.localizableLayerIds.has(Cr)){const No=ci.properties?ci.properties.worldview:null;if(this.worldview&&typeof No=="string")if(No==="all")ci.properties.$localized=!0;else{if(!No.split(",").includes(this.worldview))continue;ci.properties.$localized=!0,ci.properties.worldview=this.worldview}}!us&&ci.properties&&ci.properties.hasOwnProperty(a.f2)&&(us=!0),qi.push({feature:ci,id:Ca,index:Fa,sourceLayerIndex:Ar}),Fa++}us&&!Xe.elevationFeatures&&te.layers.hasOwnProperty(a.f3)&&(Xe.elevationFeatures=a.f4.parseFrom(te.layers[a.f3],this.canonical));for(const fa of St[Cr]){const Fa=fa[0];(!this.extraShadowCaster||Fa.is3D()&&Fa.type!=="model")&&(this.isSymbolTile!==void 0&&Fa.type==="symbol"!==this.isSymbolTile||Fa.minzoom&&this.zoom<Math.floor(Fa.minzoom)||Fa.maxzoom&&this.zoom>=Fa.maxzoom||Fa.visibility!=="none"&&(W(fa,this.zoom,Xe.brightness,ye),(Ye[Fa.id]=Fa.createBucket({index:Ue.bucketLayerIDs.length,layers:fa,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ar,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:Me})).populate(qi,Xe,this.tileID.canonical,this.tileTransform),Ue.bucketLayerIDs.push(fa.map(ci=>a.C(ci.id,ci.scope)))))}}let qt,nn,Fn,zn,Ln,cr;it.trim();const Qr={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},or=()=>{if(qt)return this.status="done",Be(qt);if(this.extraShadowCaster)this.status="done",Be(null,{buckets:Object.values(Ye).filter(Cr=>!Cr.isEmpty()),featureIndex:Ue,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Xe.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(nn&&Fn&&zn){const Cr=new R(nn),Jr=new Map;for(const[ea,Ar]of Fn.entries()){const{imagePosition:qi}=a.f7(ea,Ar,a.f8);Jr.set(ea,qi)}const mi={};for(const ea in Ye){const Ar=Ye[ea];Ar instanceof a.b1&&(W(Ar.layers,this.zoom,Xe.brightness,ye),mi[ea]=a.f9(Ar,nn,Cr.positions,Fn,Jr,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,Ln))}const Ti={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(De,Fn,Ln,()=>{Ti.iconsPending=!1,Lr(mi,Cr,Ti)}),this.rasterizeIfNeeded(De,zn,cr,()=>{Ti.patternsPending=!1,Lr(mi,Cr,Ti)})}},Lr=(Cr,Jr,mi,Ti)=>{if(mi.iconsPending||mi.patternsPending)return;const ea=new a.fa(Fn,zn,this.lut);for(const Ar in Ye){const qi=Ye[Ar];if(Ar in Cr)a.fb(qi,Cr[Ar],this.showCollisionBoxes,ye,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,Fn,ea);else if(qi.hasPattern&&(qi instanceof a.b7||qi instanceof a.b8||qi instanceof a.dV)){W(qi.layers,this.zoom,Xe.brightness,ye);const us=Object.fromEntries(ea.patternPositions);qi.addFeatures(Xe,this.tileID.canonical,us,ye,this.tileTransform,this.brightness)}}this.status="done",Be(null,{buckets:Object.values(Ye).filter(Ar=>!Ar.isEmpty()),featureIndex:Ue,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Jr.image,lineAtlas:it,imageAtlas:ea,brightness:Xe.brightness})};if(!this.extraShadowCaster){const Cr=a.f5(Xe.glyphDependencies,Ti=>Object.keys(Ti).map(Number));Object.keys(Cr).length?De.send("getGlyphs",{uid:this.uid,stacks:Cr,scope:this.scope},(Ti,ea)=>{qt||(qt=Ti,nn=ea,or())},void 0,!1,Qr):nn={};const Jr=Array.from(Xe.iconDependencies.keys()).map(Ti=>a.I.parse(Ti));Jr.length?De.send("getImages",{images:Jr,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Ti,ea)=>{qt||(qt=Ti,Fn=new Map,Ln=this.updateImageMapAndGetImageTaskQueue(Fn,ea,Xe.iconDependencies),or())},void 0,!1,Qr):(Fn=new Map,Ln=new Map);const mi=Array.from(Xe.patternDependencies.keys()).map(Ti=>a.I.parse(Ti));mi.length?De.send("getImages",{images:mi,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Ti,ea)=>{qt||(qt=Ti,zn=new Map,cr=this.updateImageMapAndGetImageTaskQueue(zn,ea,Xe.patternDependencies),or())},void 0,!1,Qr):(zn=new Map,cr=new Map)}if(Xe.elevationFeatures&&Xe.elevationFeatures.length>0){const Cr=[];for(const mi of Object.values(Ye))if(mi instanceof a.b8){const Ti=mi.getUnevaluatedPortalGraph();Ti&&Cr.push(Ti)}const Jr=a.f6.evaluate(Cr);for(const mi of Object.values(Ye))mi instanceof a.b8&&mi.setEvaluatedPortalGraph(Jr)}or()}rasterizeIfNeeded(te,le,ye,Me){Array.from(le.values()).some(De=>De.usvg)?this.rasterize(te,le,ye,Me):Me()}updateImageMapAndGetImageTaskQueue(te,le,ye){const Me=new Map;for(const De of le.keys()){const Be=ye.get(De)||[];for(const Le of Be){const Ue=Le.toString(),Ye=le.get(Le.id.toString());Ye.usvg?Me.has(Ue)||(Me.set(Ue,Le),te.set(Ue,Object.assign({},Ye))):te.set(Ue,Ye)}}return Me}rasterize(te,le,ye,Me){this.rasterizeTask=te.send("rasterizeImages",{scope:this.scope,tasks:ye},(De,Be)=>{if(!De)for(const[Le,Ue]of Be.entries()){const Ye=Object.assign(le.get(Le),{data:Ue});le.set(Le,Ye)}Me()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function W(Te,te,le,ye){const Me=new a.aa(te,{brightness:le});for(const De of Te)De.recalculate(Me,ye)}class $ extends a.E{constructor(te,le,ye,Me,De,Be,Le){super(),this.actor=te,this.layerIndex=le,this.availableImages=ye,this.availableModels=Me,this.loadVectorData=Be||a.aJ,this.loading={},this.loaded={},this.deduped=new a.aI(te.scheduler),this.isSpriteLoaded=De,this.scheduler=te.scheduler,this.brightness=Le}loadTile(te,le){const ye=te.uid,Me=te&&te.request,De=Me&&Me.collectResourceTiming,Be=this.loading[ye]=new F(te);Be.abort=this.loadVectorData(te,(Le,Ue)=>{const Ye=!this.loading[ye];if(delete this.loading[ye],Be.cancelRasterize(),Ye||Le||!Ue)return Be.status="done",Ye||(this.loaded[ye]=Be),le(Le);const it=Ue.rawData,Xe={};Ue.expires&&(Xe.expires=Ue.expires),Ue.cacheControl&&(Xe.cacheControl=Ue.cacheControl),Be.vectorTile=Ue.vectorTile||new a.fc.VectorTile(new a.bq(it));const St=()=>{Be.parse(Be.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,(qt,nn)=>{if(qt||!nn)return le(qt);const Fn={};if(De){const zn=b(Me);zn.length>0&&(Fn.resourceTiming=JSON.parse(JSON.stringify(zn)))}le(null,a.l({rawTileData:it.slice(0)},nn,Xe,Fn))})};this.isSpriteLoaded?St():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(St,{type:"parseTile",isSymbolTile:te.isSymbolTile,zoom:te.tileZoom}):St()}),this.loaded=this.loaded||{},this.loaded[ye]=Be})}reloadTile(te,le){const ye=this.loaded,Me=te.uid;if(ye&&ye[Me]){const De=ye[Me];De.scaleFactor=te.scaleFactor,De.showCollisionBoxes=te.showCollisionBoxes,De.projection=te.projection,De.brightness=te.brightness,De.tileTransform=a.aW(te.tileID.canonical,te.projection),De.extraShadowCaster=te.extraShadowCaster,De.lut=te.lut;const Be=(Le,Ue)=>{const Ye=De.reloadCallback;Ye&&(delete De.reloadCallback,De.parse(De.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,Ye)),le(Le,Ue)};De.status==="parsing"?De.reloadCallback=Be:De.status==="done"&&(De.vectorTile?De.parse(De.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,Be):Be())}else le(null,void 0)}abortTile(te,le){const ye=te.uid,Me=this.loading[ye];Me&&(Me.abort&&Me.abort(),delete this.loading[ye]),le()}removeTile(te,le){const ye=this.loaded,Me=te.uid;ye&&ye[Me]&&delete ye[Me],le()}}class Z{loadTile(te,le){const{uid:ye,encoding:Me,rawImageData:De,padding:Be}=te,Le=ImageBitmap&&De instanceof ImageBitmap?this.getImageData(De,Be):De;le(null,new a.fd(ye,Le,Me,Be<1))}reloadTile(te,le){le(null,null)}abortTile(te,le){le()}removeTile(te,le){le()}getImageData(te,le){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(te.width,te.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=te.width,this.offscreenCanvas.height=te.height,this.offscreenCanvasContext.drawImage(te,0,0,te.width,te.height);const ye=this.offscreenCanvasContext.getImageData(-le,-le,te.width+2*le,te.height+2*le);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ye}}a.bp.setPbf(a.bq);class ne{constructor(te){this._mrt=new a.bp(te.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=te.uid,this.tileID=te.tileID,this.source=te.source}parse(te,le){const ye=this._mrt;this.status="parsing",this._entireBuffer=te;try{ye.parseHeader(te),this._isHeaderLoaded=!0;const Me=[];for(const De in ye.layers){const Be=ye.getLayer(De),Le=Be.getDataRange(Be.getBandList()),Ue=ye.createDecodingTask(Le),Ye=te.slice(Le.firstByte,Le.lastByte+1),it=a.bp.performDecoding(Ye,Ue).then(Xe=>Ue.complete(null,Xe)).catch(Xe=>Ue.complete(Xe,null));Me.push(it)}Promise.allSettled(Me).then(()=>le(null,ye)).catch(De=>le(De))}catch(Me){le(Me)}}}class ie{constructor(te){this.actor=te,this.loading={},this.loaded={}}loadTile(te,le){const ye=te.uid,Me=te.request,De=this.loading[ye]=new ne(te),{cancel:Be}=a.br(Me,(Le,Ue,Ye,it)=>{const Xe=!this.loading[ye];if(delete this.loading[ye],Xe||Le||!Ue)return De.status="done",Xe||(this.loaded[ye]=De),le(Le);De.parse(Ue,(St,qt)=>{if(St||!qt)return le(St);le(null,qt,Ye,it)}),this.loaded[ye]=De});De.abort=Be}reloadTile(te,le){le(null,void 0)}abortTile(te,le){const ye=te.uid,Me=this.loading[ye];Me&&(Me.abort&&Me.abort(),delete this.loading[ye]),le()}removeTile(te,le){const ye=te.uid;this.loaded[ye]&&delete this.loaded[ye],le()}decodeRasterArray(te,le){a.bp.performDecoding(te.buffer,te.task).then(ye=>le(null,ye)).catch(ye=>le(ye))}}const ge=a.fc.VectorTileFeature.prototype.toGeoJSON;class ae{constructor(te){this._feature=te,this.extent=a.aj,this.type=te.type,this.properties=te.tags,"id"in te&&!isNaN(te.id)&&(this.id=parseInt(te.id,10))}loadGeometry(){if(this._feature.type===1){const te=[];for(const le of this._feature.geometry)te.push([new a.P(le[0],le[1])]);return te}{const te=[];for(const le of this._feature.geometry){const ye=[];for(const Me of le)ye.push(new a.P(Me[0],Me[1]));te.push(ye)}return te}}toGeoJSON(te,le,ye){return ge.call(this,te,le,ye)}}class se{constructor(te){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.aj,this.length=te.length,this._features=te}feature(te){return new ae(this._features[te])}}const me=64/4096,ke=128;class qe{constructor(){this.features=new Map}clear(){this.features.clear()}load(te=[],le){for(const ye of te){const Me=ye.id;if(Me==null)continue;let De=this.features.get(Me);De&&this.updateCache(De,le),ye.geometry?(De=nt(ye),this.updateCache(De,le),this.features.set(Me,De)):this.features.delete(Me),this.updateCache(De,le)}}updateCache(te,le){for(const{canonical:ye,uid:Me}of Object.values(le)){const{z:De,x:Be,y:Le}=ye;tt(te,Math.pow(2,De),Be,Le)&&delete le[Me]}}getTile(te,le,ye){const Me=Math.pow(2,te),De=[];for(const Be of this.features.values())tt(Be,Me,le,ye)&&De.push(vt(Be,Me,le,ye));return{features:De}}getFeatures(){return[...this.features.values()]}}function tt({minX:Te,minY:te,maxX:le,maxY:ye},Me,De,Be){return Te<(De+1+me)/Me&&te<(Be+1+me)/Me&&le>(De-me)/Me&&ye>(Be-me)/Me}function nt(Te){const{id:te,geometry:le,properties:ye}=Te;if(!le)return;if(le.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:Me,coordinates:De}=le,Be={id:te,type:1,geometry:[],tags:ye,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Le=Be.geometry;if(Me==="Point")bt(De,Le,Be);else if(Me==="MultiPoint")for(const Ue of De)bt(Ue,Le,Be);else if(Me==="LineString")Be.type=2,jt(De,Le,Be);else if(Me==="MultiLineString")Be.type=2,Nt(De,Le,Be);else if(Me==="Polygon")Be.type=3,Nt(De,Le,Be,!0);else{if(Me!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");Be.type=3;for(const Ue of De)Nt(Ue,Le,Be,!0)}return Be}function bt([Te,te],le,ye){const Me=a.ay(Te);let De=a.aH(te);De=De<0?0:De>1?1:De,le.push(Me,De),ye.minX=Math.min(ye.minX,Me),ye.minY=Math.min(ye.minY,De),ye.maxX=Math.max(ye.maxX,Me),ye.maxY=Math.max(ye.maxY,De)}function jt(Te,te,le,ye=!1,Me=!1){const De=[];for(const Be of Te)bt(Be,De,le);te.push(De),ye&&function(Be,Le){let Ue=0;for(let Ye=0,it=Be.length,Xe=it-2;Ye<it;Xe=Ye,Ye+=2)Ue+=(Be[Ye]-Be[Xe])*(Be[Ye+1]+Be[Xe+1]);if(Ue>0===Le)for(let Ye=0,it=Be.length;Ye<it/2;Ye+=2){const Xe=Be[Ye],St=Be[Ye+1];Be[Ye]=Be[it-2-Ye],Be[Ye+1]=Be[it-1-Ye],Be[it-2-Ye]=Xe,Be[it-1-Ye]=St}}(De,Me)}function Nt(Te,te,le,ye=!1){for(let Me=0;Me<Te.length;Me++)jt(Te[Me],te,le,ye,Me===0)}function vt(Te,te,le,ye){const{id:Me,type:De,geometry:Be,tags:Le}=Te,Ue=[];if(De===1)(function(Ye,it,Xe,St,qt){for(let nn=0;nn<Ye.length;nn+=2){const Fn=Math.round(a.aj*(Ye[nn+0]*it-Xe)),zn=Math.round(a.aj*(Ye[nn+1]*it-St));qt.push([Fn,zn])}})(Be,te,le,ye,Ue);else for(const Ye of Be)He(Ye,te,le,ye,Ue);return{id:Me,type:De,geometry:Ue,tags:Le}}function He(Te,te,le,ye,Me){const Be=a.aj+ke;let Le;for(let Ue=0;Ue<Te.length-2;Ue+=2){let Ye=Math.round(a.aj*(Te[Ue+0]*te-le)),it=Math.round(a.aj*(Te[Ue+1]*te-ye)),Xe=Math.round(a.aj*(Te[Ue+2]*te-le)),St=Math.round(a.aj*(Te[Ue+3]*te-ye));const qt=Xe-Ye,nn=St-it;Ye<-128&&Xe<-128||(Ye<-128?(it+=Math.round(nn*((-128-Ye)/qt)),Ye=-128):Xe<-128&&(St=it+Math.round(nn*((-128-Ye)/qt)),Xe=-128),it<-128&&St<-128||(it<-128?(Ye+=Math.round(qt*((-128-it)/nn)),it=-128):St<-128&&(Xe=Ye+Math.round(qt*((-128-it)/nn)),St=-128),Ye>=Be&&Xe>=Be||(Ye>=Be?(it+=Math.round(nn*((Be-Ye)/qt)),Ye=Be):Xe>=Be&&(St=it+Math.round(nn*((Be-Ye)/qt)),Xe=Be),it>=Be&&St>=Be||(it>=Be?(Ye+=Math.round(qt*((Be-it)/nn)),it=Be):St>=Be&&(Xe=Ye+Math.round(qt*((Be-it)/nn)),St=Be),Le&&Ye===Le[Le.length-1][0]&&it===Le[Le.length-1][1]||(Le=[[Ye,it]],Me.push(Le)),Le.push([Xe,St])))))}}var ut,Tt,Yt,Ge={exports:{}},ot=function(){if(Yt)return Ge.exports;Yt=1;var Te=a.fg(),te=function(){if(Tt)return ut;Tt=1;var it=a.fe(),Xe=a.ff().VectorTileFeature;function St(nn,Fn){this.options=Fn||{},this.features=nn,this.length=nn.length}function qt(nn,Fn){this.id=typeof nn.id=="number"?nn.id:void 0,this.type=nn.type,this.rawGeometry=nn.type===1?[nn.geometry]:nn.geometry,this.properties=nn.tags,this.extent=Fn||4096}return ut=St,St.prototype.feature=function(nn){return new qt(this.features[nn],this.options.extent)},qt.prototype.loadGeometry=function(){var nn=this.rawGeometry;this.geometry=[];for(var Fn=0;Fn<nn.length;Fn++){for(var zn=nn[Fn],Ln=[],cr=0;cr<zn.length;cr++)Ln.push(new it(zn[cr][0],zn[cr][1]));this.geometry.push(Ln)}return this.geometry},qt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var nn=this.geometry,Fn=1/0,zn=-1/0,Ln=1/0,cr=-1/0,Qr=0;Qr<nn.length;Qr++)for(var or=nn[Qr],Lr=0;Lr<or.length;Lr++){var Cr=or[Lr];Fn=Math.min(Fn,Cr.x),zn=Math.max(zn,Cr.x),Ln=Math.min(Ln,Cr.y),cr=Math.max(cr,Cr.y)}return[Fn,Ln,zn,cr]},qt.prototype.toGeoJSON=Xe.prototype.toGeoJSON,ut}();function le(it){var Xe=new Te;return function(St,qt){for(var nn in St.layers)qt.writeMessage(3,ye,St.layers[nn])}(it,Xe),Xe.finish()}function ye(it,Xe){var St;Xe.writeVarintField(15,it.version||1),Xe.writeStringField(1,it.name||""),Xe.writeVarintField(5,it.extent||4096);var qt={keys:[],values:[],keycache:{},valuecache:{}};for(St=0;St<it.length;St++)qt.feature=it.feature(St),Xe.writeMessage(2,Me,qt);var nn=qt.keys;for(St=0;St<nn.length;St++)Xe.writeStringField(3,nn[St]);var Fn=qt.values;for(St=0;St<Fn.length;St++)Xe.writeMessage(4,Ye,Fn[St])}function Me(it,Xe){var St=it.feature;St.id!==void 0&&Xe.writeVarintField(1,St.id),Xe.writeMessage(2,De,it),Xe.writeVarintField(3,St.type),Xe.writeMessage(4,Ue,St)}function De(it,Xe){var St=it.feature,qt=it.keys,nn=it.values,Fn=it.keycache,zn=it.valuecache;for(var Ln in St.properties){var cr=St.properties[Ln],Qr=Fn[Ln];if(cr!==null){Qr===void 0&&(qt.push(Ln),Fn[Ln]=Qr=qt.length-1),Xe.writeVarint(Qr);var or=typeof cr;or!=="string"&&or!=="boolean"&&or!=="number"&&(cr=JSON.stringify(cr));var Lr=or+":"+cr,Cr=zn[Lr];Cr===void 0&&(nn.push(cr),zn[Lr]=Cr=nn.length-1),Xe.writeVarint(Cr)}}}function Be(it,Xe){return(Xe<<3)+(7&it)}function Le(it){return it<<1^it>>31}function Ue(it,Xe){for(var St=it.loadGeometry(),qt=it.type,nn=0,Fn=0,zn=St.length,Ln=0;Ln<zn;Ln++){var cr=St[Ln],Qr=1;qt===1&&(Qr=cr.length),Xe.writeVarint(Be(1,Qr));for(var or=qt===3?cr.length-1:cr.length,Lr=0;Lr<or;Lr++){Lr===1&&qt!==1&&Xe.writeVarint(Be(2,or-1));var Cr=cr[Lr].x-nn,Jr=cr[Lr].y-Fn;Xe.writeVarint(Le(Cr)),Xe.writeVarint(Le(Jr)),nn+=Cr,Fn+=Jr}qt===3&&Xe.writeVarint(Be(7,1))}}function Ye(it,Xe){var St=typeof it;St==="string"?Xe.writeStringField(1,it):St==="boolean"?Xe.writeBooleanField(7,it):St==="number"&&(it%1!=0?Xe.writeDoubleField(3,it):it<0?Xe.writeSVarintField(6,it):Xe.writeVarintField(5,it))}return Ge.exports=le,Ge.exports.fromVectorTileJs=le,Ge.exports.fromGeojsonVt=function(it,Xe){Xe=Xe||{};var St={};for(var qt in it)St[qt]=new te(it[qt].features,Xe),St[qt].name=qt,St[qt].version=Xe.version,St[qt].extent=Xe.extent;return le({layers:St})},Ge.exports.GeoJSONWrapper=te,Ge.exports}(),mt=a.fh(ot);const It={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Te=>Te},In=Math.fround||(Mn=new Float32Array(1),Te=>(Mn[0]=+Te,Mn[0]));var Mn;const vn=3,Zn=5,Sr=6;class un{constructor(te){this.options=Object.assign(Object.create(It),te),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(te){const{log:le,minZoom:ye,maxZoom:Me}=this.options;le&&console.time("total time");const De=`prepare ${te.length} points`;le&&console.time(De),this.points=te;const Be=[];for(let Ue=0;Ue<te.length;Ue++){const Ye=te[Ue];if(!Ye.geometry)continue;const[it,Xe]=Ye.geometry.coordinates,St=In(dn(it)),qt=In(Ir(Xe));Be.push(St,qt,1/0,Ue,-1,1),this.options.reduce&&Be.push(0)}let Le=this.trees[Me+1]=this._createTree(Be);le&&console.timeEnd(De);for(let Ue=Me;Ue>=ye;Ue--){const Ye=+Date.now();Le=this.trees[Ue]=this._createTree(this._cluster(Le,Ue)),le&&console.log("z%d: %d clusters in %dms",Ue,Le.numItems,+Date.now()-Ye)}return le&&console.timeEnd("total time"),this}getClusters(te,le){let ye=((te[0]+180)%360+360)%360-180;const Me=Math.max(-90,Math.min(90,te[1]));let De=te[2]===180?180:((te[2]+180)%360+360)%360-180;const Be=Math.max(-90,Math.min(90,te[3]));if(te[2]-te[0]>=360)ye=-180,De=180;else if(ye>De){const Xe=this.getClusters([ye,Me,180,Be],le),St=this.getClusters([-180,Me,De,Be],le);return Xe.concat(St)}const Le=this.trees[this._limitZoom(le)],Ue=Le.range(dn(ye),Ir(Be),dn(De),Ir(Me)),Ye=Le.data,it=[];for(const Xe of Ue){const St=this.stride*Xe;it.push(Ye[St+Zn]>1?er(Ye,St,this.clusterProps):this.points[Ye[St+vn]])}return it}getChildren(te){const le=this._getOriginId(te),ye=this._getOriginZoom(te),Me="No cluster with the specified id.",De=this.trees[ye];if(!De)throw new Error(Me);const Be=De.data;if(le*this.stride>=Be.length)throw new Error(Me);const Le=this.options.radius/(this.options.extent*Math.pow(2,ye-1)),Ue=De.within(Be[le*this.stride],Be[le*this.stride+1],Le),Ye=[];for(const it of Ue){const Xe=it*this.stride;Be[Xe+4]===te&&Ye.push(Be[Xe+Zn]>1?er(Be,Xe,this.clusterProps):this.points[Be[Xe+vn]])}if(Ye.length===0)throw new Error(Me);return Ye}getLeaves(te,le,ye){const Me=[];return this._appendLeaves(Me,te,le=le||10,ye=ye||0,0),Me}getTile(te,le,ye){const Me=this.trees[this._limitZoom(te)],De=Math.pow(2,te),{extent:Be,radius:Le}=this.options,Ue=Le/Be,Ye=(ye-Ue)/De,it=(ye+1+Ue)/De,Xe={features:[]};return this._addTileFeatures(Me.range((le-Ue)/De,Ye,(le+1+Ue)/De,it),Me.data,le,ye,De,Xe),le===0&&this._addTileFeatures(Me.range(1-Ue/De,Ye,1,it),Me.data,De,ye,De,Xe),le===De-1&&this._addTileFeatures(Me.range(0,Ye,Ue/De,it),Me.data,-1,ye,De,Xe),Xe.features.length?Xe:null}getClusterExpansionZoom(te){let le=this._getOriginZoom(te)-1;for(;le<=this.options.maxZoom;){const ye=this.getChildren(te);if(le++,ye.length!==1)break;te=ye[0].properties.cluster_id}return le}_appendLeaves(te,le,ye,Me,De){const Be=this.getChildren(le);for(const Le of Be){const Ue=Le.properties;if(Ue&&Ue.cluster?De+Ue.point_count<=Me?De+=Ue.point_count:De=this._appendLeaves(te,Ue.cluster_id,ye,Me,De):De<Me?De++:te.push(Le),te.length===ye)break}return De}_createTree(te){const le=new a.bW(te.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ye=0;ye<te.length;ye+=this.stride)le.add(te[ye],te[ye+1]);return le.finish(),le.data=te,le}_addTileFeatures(te,le,ye,Me,De,Be){for(const Le of te){const Ue=Le*this.stride,Ye=le[Ue+Zn]>1;let it,Xe,St;if(Ye)it=hr(le,Ue,this.clusterProps),Xe=le[Ue],St=le[Ue+1];else{const Fn=this.points[le[Ue+vn]];it=Fn.properties;const[zn,Ln]=Fn.geometry.coordinates;Xe=dn(zn),St=Ir(Ln)}const qt={type:1,geometry:[[Math.round(this.options.extent*(Xe*De-ye)),Math.round(this.options.extent*(St*De-Me))]],tags:it};let nn;nn=Ye||this.options.generateId?le[Ue+vn]:this.points[le[Ue+vn]].id,nn!==void 0&&(qt.id=nn),Be.features.push(qt)}}_limitZoom(te){return Math.max(this.options.minZoom,Math.min(Math.floor(+te),this.options.maxZoom+1))}_cluster(te,le){const{radius:ye,extent:Me,reduce:De,minPoints:Be}=this.options,Le=ye/(Me*Math.pow(2,le)),Ue=te.data,Ye=[],it=this.stride;for(let Xe=0;Xe<Ue.length;Xe+=it){if(Ue[Xe+2]<=le)continue;Ue[Xe+2]=le;const St=Ue[Xe],qt=Ue[Xe+1],nn=te.within(Ue[Xe],Ue[Xe+1],Le),Fn=Ue[Xe+Zn];let zn=Fn;for(const Ln of nn){const cr=Ln*it;Ue[cr+2]>le&&(zn+=Ue[cr+Zn])}if(zn>Fn&&zn>=Be){let Ln,cr=St*Fn,Qr=qt*Fn,or=-1;const Lr=(Xe/it<<5)+(le+1)+this.points.length;for(const Cr of nn){const Jr=Cr*it;if(Ue[Jr+2]<=le)continue;Ue[Jr+2]=le;const mi=Ue[Jr+Zn];cr+=Ue[Jr]*mi,Qr+=Ue[Jr+1]*mi,Ue[Jr+4]=Lr,De&&(Ln||(Ln=this._map(Ue,Xe,!0),or=this.clusterProps.length,this.clusterProps.push(Ln)),De(Ln,this._map(Ue,Jr)))}Ue[Xe+4]=Lr,Ye.push(cr/zn,Qr/zn,1/0,Lr,-1,zn),De&&Ye.push(or)}else{for(let Ln=0;Ln<it;Ln++)Ye.push(Ue[Xe+Ln]);if(zn>1)for(const Ln of nn){const cr=Ln*it;if(!(Ue[cr+2]<=le)){Ue[cr+2]=le;for(let Qr=0;Qr<it;Qr++)Ye.push(Ue[cr+Qr])}}}}return Ye}_getOriginId(te){return te-this.points.length>>5}_getOriginZoom(te){return(te-this.points.length)%32}_map(te,le,ye){if(te[le+Zn]>1){const Be=this.clusterProps[te[le+Sr]];return ye?Object.assign({},Be):Be}const Me=this.points[te[le+vn]].properties,De=this.options.map(Me);return ye&&De===Me?Object.assign({},De):De}}function er(Te,te,le){return{type:"Feature",id:Te[te+vn],properties:hr(Te,te,le),geometry:{type:"Point",coordinates:[(ye=Te[te],360*(ye-.5)),Zr(Te[te+1])]}};var ye}function hr(Te,te,le){const ye=Te[te+Zn],Me=ye>=1e4?`${Math.round(ye/1e3)}k`:ye>=1e3?Math.round(ye/100)/10+"k":ye,De=Te[te+Sr],Be=De===-1?{}:Object.assign({},le[De]);return Object.assign(Be,{cluster:!0,cluster_id:Te[te+vn],point_count:ye,point_count_abbreviated:Me})}function dn(Te){return Te/360+.5}function Ir(Te){const te=Math.sin(Te*Math.PI/180),le=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return le<0?0:le>1?1:le}function Zr(Te){const te=(180-360*Te)*Math.PI/180;return 360*Math.atan(Math.exp(te))/Math.PI-90}function sa(Te,te,le,ye){let Me=ye;const De=te+(le-te>>1);let Be,Le=le-te;const Ue=Te[te],Ye=Te[te+1],it=Te[le],Xe=Te[le+1];for(let St=te+3;St<le;St+=3){const qt=Mi(Te[St],Te[St+1],Ue,Ye,it,Xe);if(qt>Me)Be=St,Me=qt;else if(qt===Me){const nn=Math.abs(St-De);nn<Le&&(Be=St,Le=nn)}}Me>ye&&(Be-te>3&&sa(Te,te,Be,ye),Te[Be+2]=Me,le-Be>3&&sa(Te,Be,le,ye))}function Mi(Te,te,le,ye,Me,De){let Be=Me-le,Le=De-ye;if(Be!==0||Le!==0){const Ue=((Te-le)*Be+(te-ye)*Le)/(Be*Be+Le*Le);Ue>1?(le=Me,ye=De):Ue>0&&(le+=Be*Ue,ye+=Le*Ue)}return Be=Te-le,Le=te-ye,Be*Be+Le*Le}function Ci(Te,te,le,ye){const Me={id:Te??null,type:te,geometry:le,tags:ye,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(te==="Point"||te==="MultiPoint"||te==="LineString")ls(Me,le);else if(te==="Polygon")ls(Me,le[0]);else if(te==="MultiLineString")for(const De of le)ls(Me,De);else if(te==="MultiPolygon")for(const De of le)ls(Me,De[0]);return Me}function ls(Te,te){for(let le=0;le<te.length;le+=3)Te.minX=Math.min(Te.minX,te[le]),Te.minY=Math.min(Te.minY,te[le+1]),Te.maxX=Math.max(Te.maxX,te[le]),Te.maxY=Math.max(Te.maxY,te[le+1])}function wa(Te,te,le,ye){if(!te.geometry)return;const Me=te.geometry.coordinates;if(Me&&Me.length===0)return;const De=te.geometry.type,Be=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2);let Le=[],Ue=te.id;if(le.promoteId?Ue=te.properties[le.promoteId]:le.generateId&&(Ue=ye||0),De==="Point")Xa(Me,Le);else if(De==="MultiPoint")for(const Ye of Me)Xa(Ye,Le);else if(De==="LineString")Ds(Me,Le,Be,!1);else if(De==="MultiLineString"){if(le.lineMetrics){for(const Ye of Me)Le=[],Ds(Ye,Le,Be,!1),Te.push(Ci(Ue,"LineString",Le,te.properties));return}Ft(Me,Le,Be,!1)}else if(De==="Polygon")Ft(Me,Le,Be,!0);else{if(De!=="MultiPolygon"){if(De==="GeometryCollection"){for(const Ye of te.geometry.geometries)wa(Te,{id:Ue,geometry:Ye,properties:te.properties},le,ye);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ye of Me){const it=[];Ft(Ye,it,Be,!0),Le.push(it)}}Te.push(Ci(Ue,De,Le,te.properties))}function Xa(Te,te){te.push(Hn(Te[0]),Zt(Te[1]),0)}function Ds(Te,te,le,ye){let Me,De,Be=0;for(let Ue=0;Ue<Te.length;Ue++){const Ye=Hn(Te[Ue][0]),it=Zt(Te[Ue][1]);te.push(Ye,it,0),Ue>0&&(Be+=ye?(Me*it-Ye*De)/2:Math.sqrt(Math.pow(Ye-Me,2)+Math.pow(it-De,2))),Me=Ye,De=it}const Le=te.length-3;te[2]=1,sa(te,0,Le,le),te[Le+2]=1,te.size=Math.abs(Be),te.start=0,te.end=te.size}function Ft(Te,te,le,ye){for(let Me=0;Me<Te.length;Me++){const De=[];Ds(Te[Me],De,le,ye),te.push(De)}}function Hn(Te){return Te/360+.5}function Zt(Te){const te=Math.sin(Te*Math.PI/180),le=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return le<0?0:le>1?1:le}function pn(Te,te,le,ye,Me,De,Be,Le){if(ye/=te,De>=(le/=te)&&Be<ye)return Te;if(Be<le||De>=ye)return null;const Ue=[];for(const Ye of Te){const it=Ye.geometry;let Xe=Ye.type;const St=Me===0?Ye.minX:Ye.minY,qt=Me===0?Ye.maxX:Ye.maxY;if(St>=le&&qt<ye){Ue.push(Ye);continue}if(qt<le||St>=ye)continue;let nn=[];if(Xe==="Point"||Xe==="MultiPoint")tr(it,nn,le,ye,Me);else if(Xe==="LineString")Qn(it,nn,le,ye,Me,!1,Le.lineMetrics);else if(Xe==="MultiLineString")pi(it,nn,le,ye,Me,!1);else if(Xe==="Polygon")pi(it,nn,le,ye,Me,!0);else if(Xe==="MultiPolygon")for(const Fn of it){const zn=[];pi(Fn,zn,le,ye,Me,!0),zn.length&&nn.push(zn)}if(nn.length){if(Le.lineMetrics&&Xe==="LineString"){for(const Fn of nn)Ue.push(Ci(Ye.id,Xe,Fn,Ye.tags));continue}Xe!=="LineString"&&Xe!=="MultiLineString"||(nn.length===1?(Xe="LineString",nn=nn[0]):Xe="MultiLineString"),Xe!=="Point"&&Xe!=="MultiPoint"||(Xe=nn.length===3?"Point":"MultiPoint"),Ue.push(Ci(Ye.id,Xe,nn,Ye.tags))}}return Ue.length?Ue:null}function tr(Te,te,le,ye,Me){for(let De=0;De<Te.length;De+=3){const Be=Te[De+Me];Be>=le&&Be<=ye&&Ua(te,Te[De],Te[De+1],Te[De+2])}}function Qn(Te,te,le,ye,Me,De,Be){let Le=Yr(Te);const Ue=Me===0?Ji:Xs;let Ye,it,Xe=Te.start;for(let zn=0;zn<Te.length-3;zn+=3){const Ln=Te[zn],cr=Te[zn+1],Qr=Te[zn+2],or=Te[zn+3],Lr=Te[zn+4],Cr=Me===0?Ln:cr,Jr=Me===0?or:Lr;let mi=!1;Be&&(Ye=Math.sqrt(Math.pow(Ln-or,2)+Math.pow(cr-Lr,2))),Cr<le?Jr>le&&(it=Ue(Le,Ln,cr,or,Lr,le),Be&&(Le.start=Xe+Ye*it)):Cr>ye?Jr<ye&&(it=Ue(Le,Ln,cr,or,Lr,ye),Be&&(Le.start=Xe+Ye*it)):Ua(Le,Ln,cr,Qr),Jr<le&&Cr>=le&&(it=Ue(Le,Ln,cr,or,Lr,le),mi=!0),Jr>ye&&Cr<=ye&&(it=Ue(Le,Ln,cr,or,Lr,ye),mi=!0),!De&&mi&&(Be&&(Le.end=Xe+Ye*it),te.push(Le),Le=Yr(Te)),Be&&(Xe+=Ye)}let St=Te.length-3;const qt=Te[St],nn=Te[St+1],Fn=Me===0?qt:nn;Fn>=le&&Fn<=ye&&Ua(Le,qt,nn,Te[St+2]),St=Le.length-3,De&&St>=3&&(Le[St]!==Le[0]||Le[St+1]!==Le[1])&&Ua(Le,Le[0],Le[1],Le[2]),Le.length&&te.push(Le)}function Yr(Te){const te=[];return te.size=Te.size,te.start=Te.start,te.end=Te.end,te}function pi(Te,te,le,ye,Me,De){for(const Be of Te)Qn(Be,te,le,ye,Me,De,!1)}function Ua(Te,te,le,ye){Te.push(te,le,ye)}function Ji(Te,te,le,ye,Me,De){const Be=(De-te)/(ye-te);return Ua(Te,De,le+(Me-le)*Be,1),Be}function Xs(Te,te,le,ye,Me,De){const Be=(De-le)/(Me-le);return Ua(Te,te+(ye-te)*Be,De,1),Be}function Ka(Te,te){const le=[];for(let ye=0;ye<Te.length;ye++){const Me=Te[ye],De=Me.type;let Be;if(De==="Point"||De==="MultiPoint"||De==="LineString")Be=La(Me.geometry,te);else if(De==="MultiLineString"||De==="Polygon"){Be=[];for(const Le of Me.geometry)Be.push(La(Le,te))}else if(De==="MultiPolygon"){Be=[];for(const Le of Me.geometry){const Ue=[];for(const Ye of Le)Ue.push(La(Ye,te));Be.push(Ue)}}le.push(Ci(Me.id,De,Be,Me.tags))}return le}function La(Te,te){const le=[];le.size=Te.size,Te.start!==void 0&&(le.start=Te.start,le.end=Te.end);for(let ye=0;ye<Te.length;ye+=3)le.push(Te[ye]+te,Te[ye+1],Te[ye+2]);return le}function cs(Te,te){if(Te.transformed)return Te;const le=1<<Te.z,ye=Te.x,Me=Te.y;for(const De of Te.features){const Be=De.geometry,Le=De.type;if(De.geometry=[],Le===1)for(let Ue=0;Ue<Be.length;Ue+=2)De.geometry.push(Os(Be[Ue],Be[Ue+1],te,le,ye,Me));else for(let Ue=0;Ue<Be.length;Ue++){const Ye=[];for(let it=0;it<Be[Ue].length;it+=2)Ye.push(Os(Be[Ue][it],Be[Ue][it+1],te,le,ye,Me));De.geometry.push(Ye)}}return Te.transformed=!0,Te}function Os(Te,te,le,ye,Me,De){return[Math.round(le*(Te*ye-Me)),Math.round(le*(te*ye-De))]}function vs(Te,te,le,ye,Me){const De=te===Me.maxZoom?0:Me.tolerance/((1<<te)*Me.extent),Be={features:[],numPoints:0,numSimplified:0,numFeatures:Te.length,source:null,x:le,y:ye,z:te,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Le of Te)yi(Be,Le,De,Me);return Be}function yi(Te,te,le,ye){const Me=te.geometry,De=te.type,Be=[];if(Te.minX=Math.min(Te.minX,te.minX),Te.minY=Math.min(Te.minY,te.minY),Te.maxX=Math.max(Te.maxX,te.maxX),Te.maxY=Math.max(Te.maxY,te.maxY),De==="Point"||De==="MultiPoint")for(let Le=0;Le<Me.length;Le+=3)Be.push(Me[Le],Me[Le+1]),Te.numPoints++,Te.numSimplified++;else if(De==="LineString")Is(Be,Me,Te,le,!1,!1);else if(De==="MultiLineString"||De==="Polygon")for(let Le=0;Le<Me.length;Le++)Is(Be,Me[Le],Te,le,De==="Polygon",Le===0);else if(De==="MultiPolygon")for(let Le=0;Le<Me.length;Le++){const Ue=Me[Le];for(let Ye=0;Ye<Ue.length;Ye++)Is(Be,Ue[Ye],Te,le,!0,Ye===0)}if(Be.length){let Le=te.tags||null;if(De==="LineString"&&ye.lineMetrics){Le={};for(const Ye in te.tags)Le[Ye]=te.tags[Ye];Le.mapbox_clip_start=Me.start/Me.size,Le.mapbox_clip_end=Me.end/Me.size}const Ue={geometry:Be,type:De==="Polygon"||De==="MultiPolygon"?3:De==="LineString"||De==="MultiLineString"?2:1,tags:Le};te.id!==null&&(Ue.id=te.id),Te.features.push(Ue)}}function Is(Te,te,le,ye,Me,De){const Be=ye*ye;if(ye>0&&te.size<(Me?Be:ye))return void(le.numPoints+=te.length/3);const Le=[];for(let Ue=0;Ue<te.length;Ue+=3)(ye===0||te[Ue+2]>Be)&&(le.numSimplified++,Le.push(te[Ue],te[Ue+1])),le.numPoints++;Me&&function(Ue,Ye){let it=0;for(let Xe=0,St=Ue.length,qt=St-2;Xe<St;qt=Xe,Xe+=2)it+=(Ue[Xe]-Ue[qt])*(Ue[Xe+1]+Ue[qt+1]);if(it>0===Ye)for(let Xe=0,St=Ue.length;Xe<St/2;Xe+=2){const qt=Ue[Xe],nn=Ue[Xe+1];Ue[Xe]=Ue[St-2-Xe],Ue[Xe+1]=Ue[St-1-Xe],Ue[St-2-Xe]=qt,Ue[St-1-Xe]=nn}}(Le,De),Te.push(Le)}const Yc={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ks{constructor(te,le){const ye=(le=this.options=function(De,Be){for(const Le in Be)De[Le]=Be[Le];return De}(Object.create(Yc),le)).debug;if(ye&&console.time("preprocess data"),le.maxZoom<0||le.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(le.promoteId&&le.generateId)throw new Error("promoteId and generateId cannot be used together.");let Me=function(De,Be){const Le=[];if(De.type==="FeatureCollection")for(let Ue=0;Ue<De.features.length;Ue++)wa(Le,De.features[Ue],Be,Ue);else wa(Le,De.type==="Feature"?De:{geometry:De},Be);return Le}(te,le);this.tiles={},this.tileCoords=[],ye&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",le.indexMaxZoom,le.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Me=function(De,Be){const Le=Be.buffer/Be.extent;let Ue=De;const Ye=pn(De,1,-1-Le,Le,0,-1,2,Be),it=pn(De,1,1-Le,2+Le,0,-1,2,Be);return(Ye||it)&&(Ue=pn(De,1,-Le,1+Le,0,-1,2,Be)||[],Ye&&(Ue=Ka(Ye,1).concat(Ue)),it&&(Ue=Ue.concat(Ka(it,-1)))),Ue}(Me,le),Me.length&&this.splitTile(Me,0,0,0),ye&&(Me.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(te,le,ye,Me,De,Be,Le){const Ue=[te,le,ye,Me],Ye=this.options,it=Ye.debug;for(;Ue.length;){Me=Ue.pop(),ye=Ue.pop(),le=Ue.pop(),te=Ue.pop();const Xe=1<<le,St=Kl(le,ye,Me);let qt=this.tiles[St];if(!qt&&(it>1&&console.time("creation"),qt=this.tiles[St]=vs(te,le,ye,Me,Ye),this.tileCoords.push({z:le,x:ye,y:Me}),it)){it>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",le,ye,Me,qt.numFeatures,qt.numPoints,qt.numSimplified),console.timeEnd("creation"));const mi=`z${le}`;this.stats[mi]=(this.stats[mi]||0)+1,this.total++}if(qt.source=te,De==null){if(le===Ye.indexMaxZoom||qt.numPoints<=Ye.indexMaxPoints)continue}else{if(le===Ye.maxZoom||le===De)continue;if(De!=null){const mi=De-le;if(ye!==Be>>mi||Me!==Le>>mi)continue}}if(qt.source=null,te.length===0)continue;it>1&&console.time("clipping");const nn=.5*Ye.buffer/Ye.extent,Fn=.5-nn,zn=.5+nn,Ln=1+nn;let cr=null,Qr=null,or=null,Lr=null,Cr=pn(te,Xe,ye-nn,ye+zn,0,qt.minX,qt.maxX,Ye),Jr=pn(te,Xe,ye+Fn,ye+Ln,0,qt.minX,qt.maxX,Ye);te=null,Cr&&(cr=pn(Cr,Xe,Me-nn,Me+zn,1,qt.minY,qt.maxY,Ye),Qr=pn(Cr,Xe,Me+Fn,Me+Ln,1,qt.minY,qt.maxY,Ye),Cr=null),Jr&&(or=pn(Jr,Xe,Me-nn,Me+zn,1,qt.minY,qt.maxY,Ye),Lr=pn(Jr,Xe,Me+Fn,Me+Ln,1,qt.minY,qt.maxY,Ye),Jr=null),it>1&&console.timeEnd("clipping"),Ue.push(cr||[],le+1,2*ye,2*Me),Ue.push(Qr||[],le+1,2*ye,2*Me+1),Ue.push(or||[],le+1,2*ye+1,2*Me),Ue.push(Lr||[],le+1,2*ye+1,2*Me+1)}}getTile(te,le,ye){te=+te,le=+le,ye=+ye;const Me=this.options,{extent:De,debug:Be}=Me;if(te<0||te>24)return null;const Le=1<<te,Ue=Kl(te,le=le+Le&Le-1,ye);if(this.tiles[Ue])return cs(this.tiles[Ue],De);Be>1&&console.log("drilling down to z%d-%d-%d",te,le,ye);let Ye,it=te,Xe=le,St=ye;for(;!Ye&&it>0;)it--,Xe>>=1,St>>=1,Ye=this.tiles[Kl(it,Xe,St)];return Ye&&Ye.source?(Be>1&&(console.log("found parent tile z%d-%d-%d",it,Xe,St),console.time("drilling down")),this.splitTile(Ye.source,it,Xe,St,te,le,ye),Be>1&&console.timeEnd("drilling down"),this.tiles[Ue]?cs(this.tiles[Ue],De):null):null}}function Kl(Te,te,le){return 32*((1<<Te)*le+te)+Te}function Hd(Te,te){const le=Te.tileID.canonical;if(!this._geoJSONIndex)return void te(null,null);const ye=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!ye)return void te(null,null);const Me=new se(ye.features);let De=mt(Me);De.byteOffset===0&&De.byteLength===De.buffer.byteLength||(De=new Uint8Array(De)),te(null,{vectorTile:Me,rawData:De.buffer})}class Yl extends ${constructor(te,le,ye,Me,De,Be,Le){super(te,le,ye,Me,De,Hd,Le),Be&&(this.loadGeoJSON=Be),this._dynamicIndex=new qe}loadData(te,le){const ye=te&&te.request,Me=ye&&ye.collectResourceTiming;this.loadGeoJSON(te,(De,Be)=>{if(De||!Be)return le(De);if(typeof Be!="object")return le(new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`));{try{if(te.filter){const Ue=a.X(te.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ue.result==="error")throw new Error(Ue.value.map(Ye=>`${Ye.key}: ${Ye.message}`).join(", "));Be.features=Be.features.filter(Ye=>Ue.value.evaluate({zoom:0},Ye))}te.dynamic?(Be.type==="Feature"&&(Be={type:"FeatureCollection",features:[Be]}),te.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(Be.features,this.loaded),te.cluster&&(Be.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=te.cluster?new un(function({superclusterOptions:Ue,clusterProperties:Ye}){if(!Ye||!Ue)return Ue;const it={},Xe={},St={accumulated:null,zoom:0},qt={properties:null},nn=Object.keys(Ye);for(const Fn of nn){const[zn,Ln]=Ye[Fn],cr=a.X(Ln),Qr=a.X(typeof zn=="string"?[zn,["accumulated"],["get",Fn]]:zn);it[Fn]=cr.value,Xe[Fn]=Qr.value}return Ue.map=Fn=>{qt.properties=Fn;const zn={};for(const Ln of nn)zn[Ln]=it[Ln].evaluate(St,qt);return zn},Ue.reduce=(Fn,zn)=>{qt.properties=zn;for(const Ln of nn)St.accumulated=Fn[Ln],Fn[Ln]=Xe[Ln].evaluate(St,qt)},Ue}(te)).load(Be.features):te.dynamic?this._dynamicIndex:function(Ue,Ye){return new ks(Ue,Ye)}(Be,te.geojsonVtOptions)}catch(Ue){return le(Ue)}const Le={};if(Me){const Ue=b(ye);Ue&&(Le.resourceTiming={},Le.resourceTiming[te.source]=JSON.parse(JSON.stringify(Ue)))}le(null,Le)}})}reloadTile(te,le){const ye=this.loaded;return ye&&ye[te.uid]?te.partial?le(null,void 0):super.reloadTile(te,le):this.loadTile(te,le)}loadGeoJSON(te,le){if(te.request)a.n(te.request,le);else{if(typeof te.data!="string")return le(new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`));try{return le(null,JSON.parse(te.data))}catch{return le(new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(te,le){try{le(null,this._geoJSONIndex.getClusterExpansionZoom(te.clusterId))}catch(ye){le(ye)}}getClusterChildren(te,le){try{le(null,this._geoJSONIndex.getChildren(te.clusterId))}catch(ye){le(ye)}}getClusterLeaves(te,le){try{le(null,this._geoJSONIndex.getLeaves(te.clusterId,te.limit,te.offset))}catch(ye){le(ye)}}}class Kt{constructor(te,le){this.tileID=new a.aM(te.tileID.overscaledZ,te.tileID.wrap,te.tileID.canonical.z,te.tileID.canonical.x,te.tileID.canonical.y),this.tileZoom=te.tileZoom,this.uid=te.uid,this.zoom=te.zoom,this.canonical=te.tileID.canonical,this.pixelRatio=te.pixelRatio,this.tileSize=te.tileSize,this.source=te.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=te.projection,this.brightness=le}parse(te,le,ye,Me){this.status="parsing";const De=new a.aM(ye.tileID.overscaledZ,ye.tileID.wrap,ye.tileID.canonical.z,ye.tileID.canonical.x,ye.tileID.canonical.y),Be=[],Le=le.familiesBySource[ye.source],Ue=new a.f0(De,ye.promoteId);Ue.bucketLayerIDs=[],Ue.is3DTile=!0,a.fi(te).then(Ye=>{if(!Ye)return Me(new Error("Could not parse tile"));const it=a.fj(Ye,1/a.cT(ye.tileID.canonical)),Xe=Ye.json.extensionsUsed&&Ye.json.extensionsUsed.includes("MAPBOX_mesh_features")||Ye.json.asset.extras&&Ye.json.asset.extras.MAPBOX_mesh_features,St=Ye.json.extensionsUsed&&Ye.json.extensionsUsed.includes("EXT_meshopt_compression"),qt=new a.aa(this.zoom,{brightness:this.brightness});for(const nn in Le)for(const Fn of Le[nn]){const zn=Fn[0];Ue.bucketLayerIDs.push(Fn.map(cr=>a.C(cr.id,cr.scope))),zn.recalculate(qt,[]);const Ln=new a.fk(Fn,it,De,Xe,St,this.brightness,Ue);Xe||(Ln.needsUpload=!0),Be.push(Ln),Ln.evaluate(zn)}this.status="done",Me(null,{buckets:Be,featureIndex:Ue,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(Ye=>Me(new Error(Ye.message)))}}class el{constructor(te,le,ye,Me,De,Be,Le){this.actor=te,this.layerIndex=le,this.availableImages=ye,this.availableModels=Me,this.brightness=Le,this.loading={},this.loaded={}}loadTile(te,le){const ye=te.uid,Me=this.loading[ye]=new Kt(te,this.brightness);a.br(te.request,(De,Be)=>{const Le=!this.loading[ye];return delete this.loading[ye],Le||De?(Me.status="done",Le||(this.loaded[ye]=Me),le(De)):Be&&Be.byteLength!==0?void Me.parse(Be,this.layerIndex,te,(Ue,Ye)=>{Me.status="done",this.loaded=this.loaded||{},this.loaded[ye]=Me,Ue||!Ye?le(Ue):le(null,Ye)}):(Me.status="done",this.loaded[ye]=Me,le())})}reloadTile(te,le){const ye=this.loaded,Me=te.uid;if(ye&&ye[Me]){const De=ye[Me];De.projection=te.projection,De.brightness=te.brightness;const Be=(Le,Ue)=>{De.reloadCallback&&(delete De.reloadCallback,this.loadTile(te,le)),le(Le,Ue)};De.status==="parsing"?De.reloadCallback=Be:De.status==="done"&&this.loadTile(te,le)}}abortTile(te,le){const ye=te.uid;this.loading[ye]&&delete this.loading[ye],le()}removeTile(te,le){const ye=this.loaded,Me=te.uid;ye&&ye[Me]&&delete ye[Me],le()}}class Fu{constructor(te){this.self=te,this.actor=new a.fm(te,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new a.y,this.projections={},this.defaultProjection=a.ce({name:"mercator"}),this.workerSourceTypes={vector:$,geojson:Yl,"raster-dem":Z,"raster-array":ie,"batched-model":el},this.workerSources={},this.self.registerWorkerSource=(le,ye)=>{if(this.workerSourceTypes[le])throw new Error(`Worker source with name "${le}" already registered.`);this.workerSourceTypes[le]=ye},this.self.registerRTLTextPlugin=le=>{if(a.fn.isParsed())throw new Error("RTL text plugin already registered.");a.fn.applyArabicShaping=le.applyArabicShaping,a.fn.processBidirectionalText=le.processBidirectionalText,a.fn.processStyledBidirectionalText=le.processStyledBidirectionalText}}clearCaches(te,le,ye){delete this.layerIndexes[te],delete this.availableImages[te],delete this.availableModels[te],delete this.workerSources[te],ye()}checkIfReady(te,le,ye){ye()}setReferrer(te,le){this.referrer=le}spriteLoaded(te,le){this.isSpriteLoaded[te]||(this.isSpriteLoaded[te]={});const{scope:ye,isLoaded:Me}=le;if(this.isSpriteLoaded[te][ye]=Me,this.workerSources[te]&&this.workerSources[te][ye])for(const De in this.workerSources[te][ye]){const Be=this.workerSources[te][ye][De];for(const Le in Be){const Ue=Be[Le];Ue instanceof $&&(Ue.isSpriteLoaded=Me,Ue.fire(new a.A("isSpriteLoaded")))}}}setImages(te,le,ye){this.availableImages[te]||(this.availableImages[te]={});const{scope:Me,images:De}=le;if(this.availableImages[te][Me]=De,this.workerSources[te]&&this.workerSources[te][Me]){for(const Be in this.workerSources[te][Me]){const Le=this.workerSources[te][Me][Be];for(const Ue in Le)Le[Ue].availableImages=De}ye()}else ye()}setModels(te,{scope:le,models:ye},Me){if(this.availableModels[te]||(this.availableModels[te]={}),this.availableModels[te][le]=ye,this.workerSources[te]&&this.workerSources[te][le]){for(const De in this.workerSources[te][le]){const Be=this.workerSources[te][le][De];for(const Le in Be)Be[Le].availableModels=ye}Me()}else Me()}setProjection(te,le){this.projections[te]=a.ce(le)}setBrightness(te,le,ye){this.brightness=le,ye()}setLayers(te,le,ye){this.getLayerIndex(te,le.scope).replace(le.layers,le.options),ye()}updateLayers(te,le,ye){this.getLayerIndex(te,le.scope).update(le.layers,le.removedIds,le.options),ye()}loadTile(te,le,ye){le.projection=this.projections[te]||this.defaultProjection,this.getWorkerSource(te,le.type,le.source,le.scope).loadTile(le,ye)}decodeRasterArray(te,le,ye){this.getWorkerSource(te,le.type,le.source,le.scope).decodeRasterArray(le,ye)}reloadTile(te,le,ye){le.projection=this.projections[te]||this.defaultProjection,this.getWorkerSource(te,le.type,le.source,le.scope).reloadTile(le,ye)}abortTile(te,le,ye){this.getWorkerSource(te,le.type,le.source,le.scope).abortTile(le,ye)}removeTile(te,le,ye){this.getWorkerSource(te,le.type,le.source,le.scope).removeTile(le,ye)}removeSource(te,le,ye){if(!(this.workerSources[te]&&this.workerSources[te][le.scope]&&this.workerSources[te][le.scope][le.type]&&this.workerSources[te][le.scope][le.type][le.source]))return;const Me=this.workerSources[te][le.scope][le.type][le.source];delete this.workerSources[te][le.scope][le.type][le.source],Me.removeSource!==void 0?Me.removeSource(le,ye):ye()}loadWorkerSource(te,le,ye){try{this.self.importScripts(le.url),ye()}catch(Me){ye(Me.toString())}}syncRTLPluginState(te,le,ye){try{a.fn.setState(le);const Me=a.fn.getPluginURL();if(a.fn.isLoaded()&&!a.fn.isParsed()&&Me!=null){this.self.importScripts(Me);const De=a.fn.isParsed();ye(De?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Me}`),De)}}catch(Me){ye(Me.toString())}}setDracoUrl(te,le){this.dracoUrl=le}getAvailableImages(te,le){this.availableImages[te]||(this.availableImages[te]={});let ye=this.availableImages[te][le];return ye||(ye=[]),ye}getAvailableModels(te,le){this.availableModels[te]||(this.availableModels[te]={});let ye=this.availableModels[te][le];return ye||(ye={}),ye}getLayerIndex(te,le){this.layerIndexes[te]||(this.layerIndexes[te]={});let ye=this.layerIndexes[te][le];return ye||(ye=this.layerIndexes[te][le]=new P,ye.scope=le),ye}getWorkerSource(te,le,ye,Me){const De=this.workerSources;return De[te]||(De[te]={}),De[te][Me]||(De[te][Me]={}),De[te][Me][le]||(De[te][Me][le]={}),this.isSpriteLoaded[te]||(this.isSpriteLoaded[te]={}),De[te][Me][le][ye]||(De[te][Me][le][ye]=new this.workerSourceTypes[le]({send:(Be,Le,Ue,Ye,it,Xe)=>this.actor.send(Be,Le,Ue,te,it,Xe),scheduler:this.actor.scheduler},this.getLayerIndex(te,Me),this.getAvailableImages(te,Me),this.getAvailableModels(te,Me),this.isSpriteLoaded[te][Me],void 0,this.brightness)),De[te][Me][le][ye]}rasterizeImagesWorker(te,le,ye){const Me=new Map;for(const[De,{image:Be,imageVariant:Le}]of le.tasks.entries()){const Ue=this.imageRasterizer.rasterize(Le,Be,le.scope,te);Me.set(De,Ue)}ye(void 0,Me)}removeRasterizedImages(te,le,ye){this.imageRasterizer.removeImagesFromCacheByIds(le.imageIds,le.scope,te),ye()}enforceCacheSizeLimit(te,le){a.fo(le)}getWorkerPerformanceMetrics(te,le,ye){ye(void 0,void 0)}}return a.fl(self)&&(self.worker=new Fu(self)),Fu}),d(["./shared"],function(a){var b="3.12.0";const T={create:"create",load:"load",fullLoad:"fullLoad"},E={mark(x){performance.mark(x)},measure(x,s,u){performance.measure(x,s,u)}};function P(x){const s=x.name.split("?")[0];return a.a(s)&&s.includes("mapbox-gl.js")?"javascript":a.a(s)&&s.includes("mapbox-gl.css")?"css":a.b(s)?"fontRange":a.c(s)?"sprite":a.i(s)?"style":a.d(s)?"tilejson":"other"}var I,R={},F=function(){if(I)return R;function x(y){return!s(y)}function s(y){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var A,M,D=new Blob([""],{type:"text/javascript"}),z=URL.createObjectURL(D);try{M=new Worker(z),A=!0}catch{A=!1}return M&&M.terminate(),URL.revokeObjectURL(z),A}()?function(){var A=document.createElement("canvas");A.width=A.height=1;var M=A.getContext("2d");if(!M)return!1;var D=M.getImageData(0,0,1,1);return D&&D.width===A.width}()?(u[S=y&&y.failIfMajorPerformanceCaveat]===void 0&&(u[S]=function(A){var M,D=function(z){var U=document.createElement("canvas"),H=Object.create(x.webGLContextAttributes);return H.failIfMajorPerformanceCaveat=z,U.getContext("webgl2",H)}(A);if(!D)return!1;try{M=D.createShader(D.VERTEX_SHADER)}catch{return!1}return!(!M||D.isContextLost())&&(D.shaderSource(M,"void main() {}"),D.compileShader(M),D.getShaderParameter(M,D.COMPILE_STATUS)===!0)}(S)),u[S]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var S}I=1,R.supported=x,R.notSupportedReason=s;var u={};return x.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},R}();function W(x,s,u){const y=document.createElement(x);return s!=null&&(y.className=s),u&&u.appendChild(y),y}function $(x,s,u){const y=document.createElementNS("http://www.w3.org/2000/svg",x);for(const S of Object.keys(s))y.setAttributeNS(null,S,String(s[S]));return u&&u.appendChild(y),y}const Z=typeof document<"u"?document.documentElement&&document.documentElement.style:null,ne=Z&&Z.userSelect!==void 0?"userSelect":"WebkitUserSelect";let ie;function ge(){Z&&ne&&(ie=Z[ne],Z[ne]="none")}function ae(){Z&&ne&&(Z[ne]=ie)}function se(x){x.preventDefault(),x.stopPropagation(),window.removeEventListener("click",se,!0)}function me(){window.addEventListener("click",se,!0),window.setTimeout(()=>{window.removeEventListener("click",se,!0)},0)}function ke(x,s){const u=x.getBoundingClientRect();return nt(x,u,s)}function qe(x,s){const u=x.getBoundingClientRect(),y=[];for(let S=0;S<s.length;S++)y.push(nt(x,u,s[S]));return y}function tt(x){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&x.button===2&&x.ctrlKey?0:x.button}function nt(x,s,u){const y=x.offsetWidth===s.width?1:x.offsetWidth/s.width;return new a.P((u.clientX-s.left)*y,(u.clientY-s.top)*y)}const bt="01",jt="NO_ACCESS_TOKEN";class Nt{constructor(s,u,y){this._transformRequestFn=s,this._customAccessToken=u,this._silenceAuthErrors=!!y,this._createSkuToken()}_createSkuToken(){const s=function(){let u="";for(let y=0;y<10;y++)u+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",bt,u].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(s,u){return this._transformRequestFn&&this._transformRequestFn(s,u)||{url:s}}normalizeStyleURL(s,u){if(!a.f(s))return s;const y=He(s);return y.params.push(`sdk=js-${b}`),y.path=`/styles/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||u)}normalizeGlyphsURL(s,u){if(!a.f(s))return s;const y=He(s);return y.path=`/fonts/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||u)}normalizeModelURL(s,u){if(!a.f(s))return s;const y=He(s);return y.path=`/models/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||u)}normalizeSourceURL(s,u,y,S){if(!a.f(s))return s;const A=He(s);return A.path=`/v4/${A.authority}.json`,A.params.push("secure"),y&&A.params.push(`language=${y}`),S&&A.params.push(`worldview=${S}`),this._makeAPIURL(A,this._customAccessToken||u)}normalizeIconsetURL(s,u){const y=He(s);return a.f(s)?(y.path=`/styles/v1${y.path}/iconset.pbf`,this._makeAPIURL(y,this._customAccessToken||u)):ut(y)}normalizeSpriteURL(s,u,y,S){const A=He(s);return a.f(s)?(A.path=`/styles/v1${A.path}/sprite${u}${y}`,this._makeAPIURL(A,this._customAccessToken||S)):(A.path+=`${u}${y}`,ut(A))}normalizeTileURL(s,u,y){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!a.f(s))return s;const S=He(s);S.path=S.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${u||y&&S.authority!=="raster"&&y===512?"@2x":""}${a.m.supported?".webp":"$1"}`),S.authority==="raster"?S.path=`/${a.e.RASTER_URL_PREFIX}${S.path}`:S.authority==="rasterarrays"?S.path=`/${a.e.RASTERARRAYS_URL_PREFIX}${S.path}`:S.authority==="3dtiles"?S.path=`/${a.e.TILES3D_URL_PREFIX}${S.path}`:(S.path=S.path.replace(/^.+\/v4\//,"/"),S.path=`/${a.e.TILE_URL_VERSION}${S.path}`);const A=this._customAccessToken||function(M){for(const D of M){const z=D.match(/^access_token=(.*)$/);if(z)return z[1]}return null}(S.params)||a.e.ACCESS_TOKEN;return a.e.REQUIRE_ACCESS_TOKEN&&A&&this._skuToken&&S.params.push(`sku=${this._skuToken}`),this._makeAPIURL(S,A)}canonicalizeTileURL(s,u){const y=He(s);if(!y.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!y.path.match(/\.[\w]+$/))return s;let S="mapbox://";y.path.match(/^\/raster\/v1\//)?S+=`raster/${y.path.replace(`/${a.e.RASTER_URL_PREFIX}/`,"")}`:y.path.match(/^\/rasterarrays\/v1\//)?S+=`rasterarrays/${y.path.replace(`/${a.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:S+=`tiles/${y.path.replace(`/${a.e.TILE_URL_VERSION}/`,"")}`;let A=y.params;return u&&(A=A.filter(M=>!M.match(/^access_token=/))),A.length&&(S+=`?${A.join("&")}`),S}canonicalizeTileset(s,u){const y=!!u&&a.f(u),S=[];for(const A of s.tiles||[])a.h(A)?S.push(this.canonicalizeTileURL(A,y)):S.push(A);return S}_makeAPIURL(s,u){const y="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",S=He(a.e.API_URL);if(s.protocol=S.protocol,s.authority=S.authority,s.protocol==="http"){const A=s.params.indexOf("secure");A>=0&&s.params.splice(A,1)}if(S.path!=="/"&&(s.path=`${S.path}${s.path}`),!a.e.REQUIRE_ACCESS_TOKEN)return ut(s);if(u=u||a.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!u)throw new Error(`An API access token is required to use Mapbox GL. ${y}`);if(u[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${y}`)}return s.params=s.params.filter(A=>A.indexOf("access_token")===-1),s.params.push(`access_token=${u||""}`),ut(s)}}const vt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function He(x){const s=x.match(vt);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function ut(x){const s=x.params.length?`?${x.params.join("&")}`:"";return`${x.protocol}://${x.authority}${x.path}${s}`}const Tt="mapbox.eventData";function Yt(x){if(!x)return null;const s=x.split(".");if(!s||s.length!==3)return null;try{return JSON.parse(a.j(s[1]))}catch{return null}}class Ge{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){const u=Yt(a.e.ACCESS_TOKEN);let y="";return y=u&&u.u?a.k(u.u):a.e.ACCESS_TOKEN||"",s?`${Tt}.${s}:${y}`:`${Tt}:${y}`}fetchEventData(){const s=a.s("localStorage"),u=this.getStorageKey(),y=this.getStorageKey("uuid");if(s)try{const S=localStorage.getItem(u);S&&(this.eventData=JSON.parse(S));const A=localStorage.getItem(y);A&&(this.anonId=A)}catch{a.w("Unable to read from LocalStorage")}}saveEventData(){const s=a.s("localStorage"),u=this.getStorageKey(),y=this.getStorageKey("uuid"),S=this.anonId;if(s&&S)try{localStorage.setItem(y,S),Object.keys(this.eventData).length>=1&&localStorage.setItem(u,JSON.stringify(this.eventData))}catch{a.w("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,u,y,S){if(!a.e.EVENTS_URL)return;const A=He(a.e.EVENTS_URL);A.params.push(`access_token=${S||a.e.ACCESS_TOKEN||""}`);const M={event:this.type,created:new Date(s).toISOString()},D=u?a.l(M,u):M,z={url:ut(A),headers:{"Content-Type":"text/plain"},body:JSON.stringify([D])};this.pendingRequest=a.p(z,U=>{this.pendingRequest=null,y(U),this.saveEventData(),this.processRequests(S)})}queueRequest(s,u){this.queue.push(s),this.processRequests(u)}}const ot=new class extends Ge{constructor(x){super("appUserTurnstile"),this._customAccessToken=x}postTurnstileEvent(x,s){a.e.EVENTS_URL&&a.e.ACCESS_TOKEN&&Array.isArray(x)&&x.some(u=>a.f(u)||a.h(u))&&this.queueRequest(Date.now(),s)}processRequests(x){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const s=Yt(a.e.ACCESS_TOKEN),u=s?s.u:a.e.ACCESS_TOKEN;let y=u!==this.eventData.tokenU;a.v(this.anonId)||(this.anonId=a.u(),y=!0);const S=this.queue.shift();if(this.eventData.lastSuccess){const A=new Date(this.eventData.lastSuccess),M=new Date(S),D=(S-this.eventData.lastSuccess)/864e5;y=y||D>=1||D<-1||A.getDate()!==M.getDate()}else y=!0;y?this.postEvent(S,{sdkIdentifier:"mapbox-gl-js",sdkVersion:b,skuId:bt,"enabled.telemetry":!1,userId:this.anonId},A=>{A||(this.eventData.lastSuccess=S,this.eventData.tokenU=u)},x):this.processRequests()}},mt=ot.postTurnstileEvent.bind(ot),It=new class extends Ge{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(x,s,u,y){this.skuToken=s,this.errorCb=y,a.e.EVENTS_URL&&(u||a.e.ACCESS_TOKEN?this.queueRequest({id:x,timestamp:Date.now()},u):this.errorCb(new Error(jt)))}processRequests(x){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:u}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),a.v(this.anonId)||(this.anonId=a.u()),this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:b,skuId:bt,skuToken:this.skuToken,userId:this.anonId},y=>{y?this.errorCb(y):s&&(this.success[s]=!0)},x))}remove(){this.errorCb=null}},In=It.postMapLoadEvent.bind(It),Mn=new class extends Ge{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(x){let s=this.mapInstanceIdMap.get(x);return s||(s=a.u(),this.mapInstanceIdMap.set(x,s)),s}getEventId(x){const s=this.eventIdPerMapInstanceMap.get(x)||0;return this.eventIdPerMapInstanceMap.set(x,s+1),s}postStyleLoadEvent(x,s){const{map:u,style:y,importedStyles:S}=s;if(!a.e.EVENTS_URL||!x&&!a.e.ACCESS_TOKEN)return;const A=this.getMapInstanceId(u),M={mapInstanceId:A,eventId:this.getEventId(A),style:y};S.length&&(M.importedStyles=S),this.queueRequest({timestamp:Date.now(),payload:M},x)}processRequests(x){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,payload:u}=this.queue.shift();this.postEvent(s,u,()=>{},x)}},vn=Mn.postStyleLoadEvent.bind(Mn),Zn=new class extends Ge{constructor(){super("gljs.performance")}postPerformanceEvent(x,s){a.e.EVENTS_URL&&(x||a.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},x)}processRequests(x){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,performanceData:u}=this.queue.shift(),y=function(S){const A=performance.getEntriesByType("resource"),M=performance.getEntriesByType("mark"),D=function(J){const de={};if(J){for(const ce in J)if(ce!=="other")for(const fe of J[ce]){const ue=`${ce}ResolveRangeMin`,ve=`${ce}ResolveRangeMax`,Ee=`${ce}RequestCount`,Pe=`${ce}RequestCachedCount`;de[ue]=Math.min(de[ue]||1/0,fe.startTime),de[ve]=Math.max(de[ve]||-1/0,fe.responseEnd);const ze=Ie=>{de[Ie]===void 0&&(de[Ie]=0),++de[Ie]};fe.transferSize!==void 0&&fe.transferSize===0&&ze(Pe),ze(Ee)}}return de}(function(J,de){const ce={};if(J)for(const fe of J){const ue=de(fe);ce[ue]===void 0&&(ce[ue]=[]),ce[ue].push(fe)}return ce}(A,P)),z=window.devicePixelRatio,U=navigator.connection||navigator.mozConnection||navigator.webkitConnection,H=U?U.effectiveType:void 0,K={counters:[],metadata:[],attributes:[]},X=(J,de,ce)=>{ce!=null&&J.push({name:de,value:ce.toString()})};for(const J in D)X(K.counters,J,D[J]);if(S.interactionRange[0]!==1/0&&S.interactionRange[1]!==-1/0&&(X(K.counters,"interactionRangeMin",S.interactionRange[0]),X(K.counters,"interactionRangeMax",S.interactionRange[1])),M)for(const J of Object.keys(T)){const de=T[J],ce=M.find(fe=>fe.name===de);ce&&X(K.counters,de,ce.startTime)}return X(K.counters,"visibilityHidden",S.visibilityHidden),X(K.attributes,"style",function(J){if(J)for(const de of J){const ce=de.name.split("?")[0];if(a.i(ce)){const fe=ce.split("/").slice(-2);if(fe.length===2)return`mapbox://styles/${fe[0]}/${fe[1]}`}}}(A)),X(K.attributes,"terrainEnabled",S.terrainEnabled?"true":"false"),X(K.attributes,"fogEnabled",S.fogEnabled?"true":"false"),X(K.attributes,"projection",S.projection),X(K.attributes,"zoom",S.zoom),X(K.metadata,"devicePixelRatio",z),X(K.metadata,"connectionEffectiveType",H),X(K.metadata,"navigatorUserAgent",navigator.userAgent),X(K.metadata,"screenWidth",window.screen.width),X(K.metadata,"screenHeight",window.screen.height),X(K.metadata,"windowWidth",window.innerWidth),X(K.metadata,"windowHeight",window.innerHeight),X(K.metadata,"mapWidth",S.width/z),X(K.metadata,"mapHeight",S.height/z),X(K.metadata,"webglRenderer",S.renderer),X(K.metadata,"webglVendor",S.vendor),X(K.metadata,"sdkVersion",b),X(K.metadata,"sdkIdentifier","mapbox-gl-js"),K}(u);for(const S of y.metadata);for(const S of y.counters);for(const S of y.attributes);this.postEvent(s,y,()=>{},x)}},Sr=Zn.postPerformanceEvent.bind(Zn),un=new class extends Ge{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(x,s,u,y){if(!a.e.API_URL||!a.e.SESSION_PATH)return;const S=He(a.e.API_URL+a.e.SESSION_PATH);S.params.push(`sku=${s||""}`),S.params.push(`access_token=${y||a.e.ACCESS_TOKEN||""}`);const A={url:ut(S),headers:{"Content-Type":"text/plain"}};this.pendingRequest=a.g(A,M=>{this.pendingRequest=null,u(M),this.saveEventData(),this.processRequests(y)})}getSessionAPI(x,s,u,y){this.skuToken=s,this.errorCb=y,a.e.SESSION_PATH&&a.e.API_URL&&(u||a.e.ACCESS_TOKEN?this.queueRequest({id:x,timestamp:Date.now()},u):this.errorCb(new Error(jt)))}processRequests(x){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:u}=this.queue.shift();s&&this.success[s]||this.getSession(u,this.skuToken,y=>{y?this.errorCb(y):s&&(this.success[s]=!0)},x)}remove(){this.errorCb=null}},er=un.getSessionAPI.bind(un),hr=new Set;function dn(x,s){s?hr.add(x):hr.delete(x)}class Ir{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(s,u){this._updatedSourceCaches[s]=u,this.setDirty()}discardSourceCacheUpdate(s){delete this._updatedSourceCaches[s]}updateLayer(s){const u=s.scope;this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._updatedLayers[u].add(s.id),this.setDirty()}removeLayer(s){const u=s.scope;this._removedLayers[u]=this._removedLayers[u]||{},this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._removedLayers[u][s.id]=s,this._updatedLayers[u].delete(s.id),this._updatedPaintProps.delete(s.fqid),this.setDirty()}getRemovedLayer(s){return this._removedLayers[s.scope]?this._removedLayers[s.scope][s.id]:null}discardLayerRemoval(s){this._removedLayers[s.scope]&&delete this._removedLayers[s.scope][s.id]}getLayerUpdatesByScope(){const s={};for(const u in this._updatedLayers)s[u]=s[u]||{},s[u].updatedIds=Array.from(this._updatedLayers[u].values());for(const u in this._removedLayers)s[u]=s[u]||{},s[u].removedIds=Object.keys(this._removedLayers[u]);return s}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(s){this._updatedPaintProps.add(s.fqid),this.setDirty()}getUpdatedImages(s){return this._updatedImages[s]?Array.from(this._updatedImages[s].values()):[]}updateImage(s,u){this._updatedImages[u]=this._updatedImages[u]||new Set,this._updatedImages[u].add(a.I.toString(s)),this.setDirty()}resetUpdatedImages(s){this._updatedImages[s]&&this._updatedImages[s].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function Zr(x){const{userImage:s}=x;return!!(s&&s.render&&s.render())&&(x.data.replace(new Uint8Array(s.data.buffer)),!0)}class sa extends a.E{constructor(s){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=s,s!=="raster"&&a.t()&&(this.imageRasterizerDispatcher=new a.D(a.x(),this,"Image Rasterizer Worker",1))}addScope(s){this.loaded.set(s,!1),this.imageProviders.set(s,new Map),this.images.set(s,new Map),this.updatedImages.set(s,new Set),this.callbackDispatchedThisFrame.set(s,new Set),this.patterns.set(s,new Map),this.atlasImage.set(s,new a.r({width:1,height:1}))}removeScope(s){this.loaded.delete(s),this.imageProviders.delete(s),this.images.delete(s),this.updatedImages.delete(s),this.callbackDispatchedThisFrame.delete(s),this.patterns.delete(s),this.atlasImage.delete(s);const u=this.atlasTexture.get(s);u&&(u.destroy(),this.atlasTexture.delete(s))}addImageProvider(s,u){this.imageProviders.has(u)||this.imageProviders.set(u,new Map),this.imageProviders.get(u).set(s.id,s)}removeImageProvider(s,u){this.imageProviders.has(u)&&this.imageProviders.get(u).delete(s)}getPendingImageProviders(){const s=[];for(const u of this.imageProviders.values())for(const y of u.values())y.hasPendingRequests()&&s.push(y);return s}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new a.y),this._imageRasterizer}isLoaded(){for(const s of this.loaded.keys())if(!this.loaded.get(s))return!1;return!0}setLoaded(s,u){if(this.loaded.get(u)!==s&&(this.loaded.set(u,s),s)){for(const{ids:y,callback:S}of this.requestors)this._notify(y,u,S);this.requestors=[]}}hasImage(s,u){return!!this.getImage(s,u)}getImage(s,u){return this.images.get(u).get(s.toString())}addImage(s,u,y){this._validate(s,y)&&this.images.get(u).set(s.toString(),y)}_validate(s,u){let y=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new a.z(new Error(`Image "${s.name}" has invalid "stretchX" value`))),y=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new a.z(new Error(`Image "${s.name}" has invalid "stretchY" value`))),y=!1),this._validateContent(u.content,u)||(this.fire(new a.z(new Error(`Image "${s.name}" has invalid "content" value`))),y=!1),y}_validateStretch(s,u){if(!s)return!0;let y=0;for(const S of s){if(S[0]<y||S[1]<S[0]||u<S[1])return!1;y=S[1]}return!0}_validateContent(s,u){return s?s.length!==4||!u.usvg&&(s[0]<0||u.data.width<s[0]||s[1]<0||u.data.height<s[1]||s[2]<0||u.data.width<s[2]||s[3]<0||u.data.height<s[3])?!1:!(s[2]<s[0]||s[3]<s[1]):!0}updateImage(s,u,y){const S=this.images.get(u).get(s.toString());y.version=S.version+1,this.images.get(u).set(s.toString(),y),this.updatedImages.get(u).add(s),this.removeFromImageRasterizerCache(s,u)}clearUpdatedImages(s){this.updatedImages.get(s).clear()}removeFromImageRasterizerCache(s,u){this.spriteFormat!=="raster"&&(a.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[s],scope:u}):this.imageRasterizer.removeImagesFromCacheByIds([s],u))}removeImage(s,u){const y=this.images.get(u),S=y.get(s.toString());y.delete(s.toString()),this.patterns.get(u).delete(s.toString()),this.removeFromImageRasterizerCache(s,u),S.userImage&&S.userImage.onRemove&&S.userImage.onRemove()}listImages(s){return Array.from(this.images.get(s).keys()).map(u=>a.I.from(u))}getImages(s,u,y){const S=[],A=[],M=this.imageProviders.get(u);for(const H of s){if(!H.iconsetId){S.push(H);continue}const K=M.get(H.iconsetId);K&&(this.getImage(H,u)?A.push(H):K.addPendingRequest(H))}if(S.length===0)return void this._notify(A,u,y);let D=!0;const z=!!this.loaded.get(u),U=this.images.get(u);if(!z)for(const H of S)U.has(H.toString())||(D=!1);z||D?this._notify(S,u,y):this.requestors.push({ids:S,scope:u,callback:y})}rasterizeImages(s,u){const y=new Map,{tasks:S,scope:A}=s;for(const[M,D]of S.entries()){const z=this.getImage(D.id,A);z&&y.set(M,{image:z,imageVariant:D})}this._rasterizeImages(A,y,u)}_rasterizeImages(s,u,y){if(a.t())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:u,scope:s},y);else{const S=new Map;for(const[A,{image:M,imageVariant:D}]of u.entries())S.set(A,this.imageRasterizer.rasterize(D,M,s,0));y(void 0,S)}}getUpdatedImages(s){return this.updatedImages.get(s)||new Set}_notify(s,u,y){const S=this.images.get(u),A=new Map;for(const M of s){if(!S.get(M.toString())){if(M.iconsetId)continue;this.fire(new a.A("styleimagemissing",{id:M.name}))}const D=S.get(M.toString());if(!D){a.w(`Image "${M.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const z={data:D.usvg?null:D.data.clone(),pixelRatio:D.pixelRatio,sdf:D.sdf,usvg:D.usvg,version:D.version,stretchX:D.stretchX,stretchY:D.stretchY,content:D.content,hasRenderCallback:!!(D.userImage&&D.userImage.render)};D.usvg&&Object.assign(z,{width:D.icon.usvg_tree.width,height:D.icon.usvg_tree.height}),A.set(a.I.toString(M),z)}y(null,A)}getPixelSize(s){const{width:u,height:y}=this.atlasImage.get(s);return{width:u,height:y}}getPattern(s,u,y){const S=s.toString(),A=this.patterns.get(u),M=A.get(S),D=this.getImage(s,u);if(!D)return null;if(M){if(M.position.version===D.version)return M.position;M.position.version=D.version}else{if(D.usvg&&!D.data){const z=this.getPatternInFlightId(S,u);if(this.patternsInFlight.has(z))return null;this.patternsInFlight.add(z);const U=new a.B(s).scaleSelf(a.q.devicePixelRatio),H=new Map([[U.toString(),{image:D,imageVariant:U}]]);return this._rasterizeImages(u,H,(K,X)=>this.storePatternImage(U,u,D,y,X)),null}this.storePattern(s,u,D)}return this._updatePatternAtlas(u,y),A.get(S).position}getPatternInFlightId(s,u){return a.C(s,u)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(s,u,y,S,A){const M=s.toString(),D=A?A.get(M):void 0;D&&(y.data=D,this.storePattern(s.id,u,y),this._updatePatternAtlas(u,S),this.patternsInFlight.delete(this.getPatternInFlightId(s.id.toString(),u)))}storePattern(s,u,y){const S={w:y.data.width+2*a.F,h:y.data.height+2*a.F,x:0,y:0},A=new a.G(S,y,a.F);this.patterns.get(u).set(s.toString(),{bin:S,position:A})}bind(s,u){const y=s.gl;let S=this.atlasTexture.get(u);S?this.dirty&&(S.update(this.atlasImage.get(u)),this.dirty=!1):(S=new a.T(s,this.atlasImage.get(u),y.RGBA8),this.atlasTexture.set(u,S)),S.bind(y.LINEAR,y.CLAMP_TO_EDGE)}_updatePatternAtlas(s,u){const y=this.patterns.get(s),S=Array.from(y.values()).map(({bin:U})=>U),{w:A,h:M}=a.H(S),D=this.atlasImage.get(s);D.resize({width:A||1,height:M||1});const z=this.images.get(s);for(const[U,{bin:H,position:K}]of y.entries()){let X=K.padding;const J=H.x+X,de=H.y+X,ce=z.get(U).data,fe=ce.width,ue=ce.height;X=X>1?X-1:X,a.r.copy(ce,D,{x:0,y:0},{x:J,y:de},{width:fe,height:ue},u),a.r.copy(ce,D,{x:0,y:ue-X},{x:J,y:de-X},{width:fe,height:X},u),a.r.copy(ce,D,{x:0,y:0},{x:J,y:de+ue},{width:fe,height:X},u),a.r.copy(ce,D,{x:fe-X,y:0},{x:J-X,y:de},{width:X,height:ue},u),a.r.copy(ce,D,{x:0,y:0},{x:J+fe,y:de},{width:X,height:ue},u),a.r.copy(ce,D,{x:fe-X,y:ue-X},{x:J-X,y:de-X},{width:X,height:X},u),a.r.copy(ce,D,{x:0,y:ue-X},{x:J+fe,y:de-X},{width:X,height:X},u),a.r.copy(ce,D,{x:0,y:0},{x:J+fe,y:de+ue},{width:X,height:X},u),a.r.copy(ce,D,{x:fe-X,y:0},{x:J-X,y:de+ue},{width:X,height:X},u)}this.dirty=!0}beginFrame(){for(const s of this.images.keys())this.callbackDispatchedThisFrame.set(s,new Set)}dispatchRenderCallbacks(s,u){const y=this.images.get(u);for(const S of s){if(this.callbackDispatchedThisFrame.get(u).has(S.toString()))continue;this.callbackDispatchedThisFrame.get(u).add(S.toString());const A=y.get(S.toString());Zr(A)&&this.updateImage(S,u,A)}}}function Mi(x){const s=x.key,u=x.value,y=x.valueSpec||{},S=x.objectElementValidators||{},A=x.style,M=x.styleSpec;let D=[];const z=a.K(u);if(z!=="object")return[new a.V(s,u,`object expected, ${z} found`)];for(const U in u){const H=U.split(".")[0];let K;S[H]?K=S[H]:y[H]?K=yi:S["*"]?K=S["*"]:y["*"]&&(K=yi),K?D=D.concat(K({key:(s&&`${s}.`)+U,value:u[U],valueSpec:y[H]||y["*"],style:A,styleSpec:M,object:u,objectKey:U},u)):D.push(new a.J(s,u[U],`unknown property "${U}"`))}for(const U in y)S[U]||y[U].required&&y[U].default===void 0&&u[U]===void 0&&D.push(new a.V(s,u,`missing required property "${U}"`));return D}function Ci(x){const s=x.value,u=x.valueSpec,y=x.style,S=x.styleSpec,A=x.key,M=x.arrayElementValidator||yi;if(a.K(s)!=="array")return[new a.V(A,s,`array expected, ${a.K(s)} found`)];if(u.length&&s.length!==u.length)return[new a.V(A,s,`array length ${u.length} expected, length ${s.length} found`)];if(u["min-length"]&&s.length<u["min-length"])return[new a.V(A,s,`array length at least ${u["min-length"]} expected, length ${s.length} found`)];let D={type:u.value,values:u.values,minimum:u.minimum,maximum:u.maximum,function:void 0};S.$version<7&&(D.function=u.function),a.K(u.value)==="object"&&(D=u.value);let z=[];for(let U=0;U<s.length;U++)z=z.concat(M({array:s,arrayIndex:U,value:s[U],valueSpec:D,style:y,styleSpec:S,key:`${A}[${U}]`},!0));return z}function ls(x){const s=x.key,u=x.value,y=x.valueSpec;let S=a.K(u);if(S==="number"&&u!=u&&(S="NaN"),S!=="number")return[new a.V(s,u,`number expected, ${S} found`)];if("minimum"in y){let A=y.minimum;if(a.K(y.minimum)==="array"&&(A=y.minimum[x.arrayIndex]),u<A)return[new a.V(s,u,`${u} is less than the minimum value ${A}`)]}if("maximum"in y){let A=y.maximum;if(a.K(y.maximum)==="array"&&(A=y.maximum[x.arrayIndex]),u>A)return[new a.V(s,u,`${u} is greater than the maximum value ${A}`)]}return[]}function wa(x){const s=x.valueSpec,u=a.M(x.value.type);let y,S,A,M={};const D=u!=="categorical"&&x.value.property===void 0,z=!D,U=a.K(x.value.stops)==="array"&&a.K(x.value.stops[0])==="array"&&a.K(x.value.stops[0][0])==="object",H=Mi({key:x.key,value:x.value,valueSpec:x.styleSpec.function,style:x.style,styleSpec:x.styleSpec,objectElementValidators:{stops:function(J){if(u==="identity")return[new a.V(J.key,J.value,'identity function may not have a "stops" property')];let de=[];const ce=J.value;return de=de.concat(Ci({key:J.key,value:ce,valueSpec:J.valueSpec,style:J.style,styleSpec:J.styleSpec,arrayElementValidator:K})),a.K(ce)==="array"&&ce.length===0&&de.push(new a.V(J.key,ce,"array must have at least one stop")),de},default:function(J){return yi({key:J.key,value:J.value,valueSpec:s,style:J.style,styleSpec:J.styleSpec})}}});return u==="identity"&&D&&H.push(new a.V(x.key,x.value,'missing required property "property"')),u==="identity"||x.value.stops||H.push(new a.V(x.key,x.value,'missing required property "stops"')),u==="exponential"&&x.valueSpec.expression&&!a.N(x.valueSpec)&&H.push(new a.V(x.key,x.value,"exponential functions not supported")),x.styleSpec.$version>=8&&(z&&!a.O(x.valueSpec)?H.push(new a.V(x.key,x.value,"property functions not supported")):D&&!a.Q(x.valueSpec)&&H.push(new a.V(x.key,x.value,"zoom functions not supported"))),u!=="categorical"&&!U||x.value.property!==void 0||H.push(new a.V(x.key,x.value,'"property" property is required')),H;function K(J){let de=[];const ce=J.value,fe=J.key;if(a.K(ce)!=="array")return[new a.V(fe,ce,`array expected, ${a.K(ce)} found`)];if(ce.length!==2)return[new a.V(fe,ce,`array length 2 expected, length ${ce.length} found`)];if(U){if(a.K(ce[0])!=="object")return[new a.V(fe,ce,`object expected, ${a.K(ce[0])} found`)];if(ce[0].zoom===void 0)return[new a.V(fe,ce,"object stop key must have zoom")];if(ce[0].value===void 0)return[new a.V(fe,ce,"object stop key must have value")];const ue=a.M(ce[0].zoom);if(typeof ue!="number")return[new a.V(fe,ce[0].zoom,"stop zoom values must be numbers")];if(A&&A>ue)return[new a.V(fe,ce[0].zoom,"stop zoom values must appear in ascending order")];ue!==A&&(A=ue,S=void 0,M={}),de=de.concat(Mi({key:`${fe}[0]`,value:ce[0],valueSpec:{zoom:{}},style:J.style,styleSpec:J.styleSpec,objectElementValidators:{zoom:ls,value:X}}))}else de=de.concat(X({key:`${fe}[0]`,value:ce[0],style:J.style,styleSpec:J.styleSpec},ce));return a.S(a.U(ce[1]))?de.concat([new a.V(`${fe}[1]`,ce[1],"expressions are not allowed in function stops.")]):de.concat(yi({key:`${fe}[1]`,value:ce[1],valueSpec:s,style:J.style,styleSpec:J.styleSpec}))}function X(J,de){const ce=a.K(J.value),fe=a.M(J.value),ue=J.value!==null?J.value:de;if(y){if(ce!==y)return[new a.V(J.key,ue,`${ce} stop domain type must match previous stop domain type ${y}`)]}else y=ce;if(ce!=="number"&&ce!=="string"&&ce!=="boolean"&&typeof fe!="number"&&typeof fe!="string"&&typeof fe!="boolean")return[new a.V(J.key,ue,"stop domain value must be a number, string, or boolean")];if(ce!=="number"&&u!=="categorical"){let ve=`number expected, ${ce} found`;return a.O(s)&&u===void 0&&(ve+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new a.V(J.key,ue,ve)]}return u!=="categorical"||ce!=="number"||typeof fe=="number"&&isFinite(fe)&&Math.floor(fe)===fe?u!=="categorical"&&ce==="number"&&typeof fe=="number"&&typeof S=="number"&&S!==void 0&&fe<S?[new a.V(J.key,ue,"stop domain values must appear in ascending order")]:(S=fe,u==="categorical"&&fe in M?[new a.V(J.key,ue,"stop domain values must be unique")]:(M[fe]=!0,[])):[new a.V(J.key,ue,`integer expected, found ${String(fe)}`)]}}function Xa(x){const s=(x.expressionContext==="property"?a.W:a.X)(a.U(x.value),x.valueSpec);if(s.result==="error")return s.value.map(y=>new a.V(`${x.key}${y.key}`,x.value,y.message));const u=s.value.expression||s.value._styleExpression.expression;if(x.expressionContext==="property"&&x.propertyKey==="text-font"&&!u.outputDefined())return[new a.V(x.key,x.value,`Invalid data expression for "${x.propertyKey}". Output values must be contained as literals within the expression.`)];if(x.expressionContext==="property"&&x.propertyType==="layout"&&!a.Y(u))return[new a.V(x.key,x.value,'"feature-state" data expressions are not supported with layout properties.')];if(x.expressionContext==="filter")return Ds(u,x);if(x.expressionContext&&x.expressionContext.indexOf("cluster")===0){if(!a.Z(u,["zoom","feature-state"]))return[new a.V(x.key,x.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(x.expressionContext==="cluster-initial"&&!a._(u))return[new a.V(x.key,x.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ds(x,s){const u=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(s.valueSpec&&s.valueSpec.expression)for(const S of s.valueSpec.expression.parameters)u.delete(S);if(u.size===0)return[];const y=[];return x instanceof a.$&&u.has(x.name)?[new a.V(s.key,s.value,`["${x.name}"] expression is not supported in a filter for a ${s.object.type} layer with id: ${s.object.id}`)]:(x.eachChild(S=>{y.push(...Ds(S,s))}),y)}function Ft(x){const s=x.key,u=x.value,y=x.valueSpec,S=[];return Array.isArray(y.values)?y.values.indexOf(a.M(u))===-1&&S.push(new a.V(s,u,`expected one of [${y.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(y.values).indexOf(a.M(u))===-1&&S.push(new a.V(s,u,`expected one of [${Object.keys(y.values).join(", ")}], ${JSON.stringify(u)} found`)),S}function Hn(x){return a.a1(a.U(x.value))?Xa(a.L({},x,{expressionContext:"filter",valueSpec:x.styleSpec[`filter_${x.layerType||"fill"}`]})):Zt(x)}function Zt(x){const s=x.value,u=x.key;if(a.K(s)!=="array")return[new a.V(u,s,`array expected, ${a.K(s)} found`)];const y=x.styleSpec;let S,A=[];if(s.length<1)return[new a.V(u,s,"filter array must have at least 1 element")];switch(A=A.concat(Ft({key:`${u}[0]`,value:s[0],valueSpec:y.filter_operator,style:x.style,styleSpec:x.styleSpec})),a.M(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&a.M(s[1])==="$type"&&A.push(new a.V(u,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&A.push(new a.V(u,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(S=a.K(s[1]),S!=="string"&&A.push(new a.V(`${u}[1]`,s[1],`string expected, ${S} found`)));for(let M=2;M<s.length;M++)S=a.K(s[M]),a.M(s[1])==="$type"?A=A.concat(Ft({key:`${u}[${M}]`,value:s[M],valueSpec:y.geometry_type,style:x.style,styleSpec:x.styleSpec})):S!=="string"&&S!=="number"&&S!=="boolean"&&A.push(new a.V(`${u}[${M}]`,s[M],`string, number, or boolean expected, ${S} found`));break;case"any":case"all":case"none":for(let M=1;M<s.length;M++)A=A.concat(Zt({key:`${u}[${M}]`,value:s[M],style:x.style,styleSpec:x.styleSpec}));break;case"has":case"!has":S=a.K(s[1]),s.length!==2?A.push(new a.V(u,s,`filter array for "${s[0]}" operator must have 2 elements`)):S!=="string"&&A.push(new a.V(`${u}[1]`,s[1],`string expected, ${S} found`))}return A}function pn(x,s){const u=x.key,y=x.style,S=x.layer,A=x.styleSpec,M=x.value,D=x.objectKey,z=A[`${s}_${x.layerType}`];if(!z)return[];const U=D.match(/^(.*)-use-theme$/);if(s==="paint"&&U&&z[U[1]])return a.S(M)?[].concat(yi({key:x.key,value:M,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:y,styleSpec:A,expressionContext:"property",propertyType:s,propertyKey:D})):yi({key:u,value:M,valueSpec:{type:"string"},style:y,styleSpec:A});const H=D.match(/^(.*)-transition$/);if(s==="paint"&&H&&z[H[1]]&&z[H[1]].transition)return yi({key:u,value:M,valueSpec:A.transition,style:y,styleSpec:A});const K=x.valueSpec||z[D];if(!K)return[new a.J(u,M,`unknown property "${D}"`)];let X;if(a.K(M)==="string"&&a.O(K)&&!K.tokens&&(X=/^{([^}]+)}$/.exec(M))){const de=`\`{ "type": "identity", "property": ${X?JSON.stringify(X[1]):'"_"'} }\``;return[new a.V(u,M,`"${D}" does not support interpolation syntax
Use an identity property function instead: ${de}.`)]}const J=[];if(x.layerType==="symbol")D!=="text-field"||!y||y.glyphs||y.imports||J.push(new a.V(u,M,'use of "text-field" requires a style "glyphs" property')),D==="text-font"&&a.a2(a.U(M))&&a.M(M.type)==="identity"&&J.push(new a.V(u,M,'"text-font" does not support identity functions'));else if(x.layerType==="model"&&s==="paint"&&S&&S.layout&&S.layout.hasOwnProperty("model-id")&&a.O(K)&&(a.a3(K)||a.Q(K))){const de=a.W(a.U(M),K),ce=de.value.expression||de.value._styleExpression.expression;ce&&!a.Z(ce,["measure-light"])&&(D==="model-emissive-strength"&&a._(ce)&&a.Y(ce)||J.push(new a.V(u,M,`${D} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return J.concat(yi({key:x.key,value:M,valueSpec:K,style:y,styleSpec:A,expressionContext:"property",propertyType:s,propertyKey:D}))}function tr(x){return pn(x,"paint")}function Qn(x){return pn(x,"layout")}function Yr(x){let s=[];const u=x.value,y=x.key,S=x.style,A=x.styleSpec;u.type||u.ref||s.push(new a.V(y,u,'either "type" or "ref" is required'));let M=a.M(u.type);const D=a.M(u.ref);if(u.id){const z=a.M(u.id);for(let U=0;U<x.arrayIndex;U++){const H=S.layers[U];a.M(H.id)===z&&s.push(new a.V(y,u.id,`duplicate layer id "${u.id}", previously used at line ${H.id.__line__}`))}}if("ref"in u){let z;["type","source","source-layer","filter","layout"].forEach(U=>{U in u&&s.push(new a.V(y,u[U],`"${U}" is prohibited for ref layers`))}),S.layers.forEach(U=>{a.M(U.id)===D&&(z=U)}),z?z.ref?s.push(new a.V(y,u.ref,"ref cannot reference another ref layer")):M=a.M(z.type):typeof D=="string"&&s.push(new a.V(y,u.ref,`ref layer "${D}" not found`))}else if(M!=="background"&&M!=="sky"&&M!=="slot")if(u.source){const z=S.sources&&S.sources[u.source],U=z&&a.M(z.type);z?U==="vector"&&M==="raster"?s.push(new a.V(y,u.source,`layer "${u.id}" requires a raster source`)):U==="raster"&&M!=="raster"?s.push(new a.V(y,u.source,`layer "${u.id}" requires a vector source`)):U!=="vector"||u["source-layer"]?U==="raster-dem"&&M!=="hillshade"?s.push(new a.V(y,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):U!=="raster-array"||["raster","raster-particle"].includes(M)?M==="line"&&u.paint&&(u.paint["line-gradient"]||u.paint["line-trim-offset"])&&U==="geojson"&&!z.lineMetrics?s.push(new a.V(y,u,`layer "${u.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):M==="raster-particle"&&U!=="raster-array"&&s.push(new a.V(y,u.source,`layer "${u.id}" requires a 'raster-array' source.`)):s.push(new a.V(y,u.source,"raster-array source can only be used with layer type 'raster'.")):s.push(new a.V(y,u,`layer "${u.id}" must specify a "source-layer"`)):s.push(new a.V(y,u.source,`source "${u.source}" not found`))}else s.push(new a.V(y,u,'missing required property "source"'));return s=s.concat(Mi({key:y,value:u,valueSpec:A.layer,style:x.style,styleSpec:x.styleSpec,objectElementValidators:{"*":()=>[],type:()=>yi({key:`${y}.type`,value:u.type,valueSpec:A.layer.type,style:x.style,styleSpec:x.styleSpec,object:u,objectKey:"type"}),filter:z=>Hn(a.L({layerType:M},z)),layout:z=>Mi({layer:u,key:z.key,value:z.value,valueSpec:{},style:z.style,styleSpec:z.styleSpec,objectElementValidators:{"*":U=>Qn(a.L({layerType:M},U))}}),paint:z=>Mi({layer:u,key:z.key,value:z.value,valueSpec:{},style:z.style,styleSpec:z.styleSpec,objectElementValidators:{"*":U=>tr(a.L({layerType:M,layer:u},U))}})}})),s}function pi(x){const s=x.value,u=x.key,y=a.K(s);return y!=="string"?[new a.V(u,s,`string expected, ${y} found`)]:[]}const Ua={promoteId:function x({key:s,value:u}){if(a.K(u)==="string")return pi({key:s,value:u});if(Array.isArray(u)){const y=[],S=a.U(u),A=a.X(S);return A.result==="error"&&A.value.forEach(M=>{y.push(new a.V(`${s}${M.key}`,null,`${M.message}`))}),a.Z(A.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||y.push(new a.V(`${s}`,null,"promoteId expression should be only feature dependent")),y}{const y=[];for(const S in u)y.push(...x({key:`${s}.${S}`,value:u[S]}));return y}}};function Ji(x){const s=x.value,u=x.key,y=x.styleSpec,S=x.style;if(!s.type)return[new a.V(u,s,'"type" is required')];const A=a.M(s.type);let M=[];switch(["vector","raster","raster-dem","raster-array"].includes(A)&&(s.url||s.tiles||M.push(new a.J(u,s,'Either "url" or "tiles" is required.'))),A){case"vector":case"raster":case"raster-dem":case"raster-array":return M=M.concat(Mi({key:u,value:s,valueSpec:y[`source_${A.replace("-","_")}`],style:x.style,styleSpec:y,objectElementValidators:Ua})),M;case"geojson":if(M=Mi({key:u,value:s,valueSpec:y.source_geojson,style:S,styleSpec:y,objectElementValidators:Ua}),s.cluster)for(const D in s.clusterProperties){const[z,U]=s.clusterProperties[D],H=typeof z=="string"?[z,["accumulated"],["get",D]]:z;M.push(...Xa({key:`${u}.${D}.map`,value:U,expressionContext:"cluster-map"})),M.push(...Xa({key:`${u}.${D}.reduce`,value:H,expressionContext:"cluster-reduce"}))}return M;case"video":return Mi({key:u,value:s,valueSpec:y.source_video,style:S,styleSpec:y});case"image":return Mi({key:u,value:s,valueSpec:y.source_image,style:S,styleSpec:y});case"canvas":return[new a.V(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ft({key:`${u}.type`,value:s.type,valueSpec:{values:Xs(y)}})}}function Xs(x){return x.source.reduce((s,u)=>{const y=x[u];return y.type.type==="enum"&&(s=s.concat(Object.keys(y.type.values))),s},[])}function Ka(x){const s=x.value,u=x.styleSpec,y=u.light,S=x.style;let A=[];const M=a.K(s);if(s===void 0)return A;if(M!=="object")return A=A.concat([new a.V("light",s,`object expected, ${M} found`)]),A;for(const D in s){const z=D.match(/^(.*)-transition$/),U=D.match(/^(.*)-use-theme$/);A=A.concat(U&&y[U[1]]?yi({key:D,value:s[D],valueSpec:{type:"string"},style:S,styleSpec:u}):z&&y[z[1]]&&y[z[1]].transition?yi({key:D,value:s[D],valueSpec:u.transition,style:S,styleSpec:u}):y[D]?yi({key:D,value:s[D],valueSpec:y[D],style:S,styleSpec:u}):[new a.V(D,s[D],`unknown property "${D}"`)])}return A}function La(x){const s=x.value;let u=[];if(!s)return u;const y=a.K(s);if(y!=="object")return u=u.concat([new a.V("light-3d",s,`object expected, ${y} found`)]),u;const S=x.styleSpec,A=S["light-3d"],M=x.key,D=x.style,z=x.style.lights;for(const K of["type","id"])if(!(K in s))return u=u.concat([new a.V("light-3d",s,`missing property ${K} on light`)]),u;if(s.type&&z)for(let K=0;K<x.arrayIndex;K++){const X=a.M(s.type),J=z[K];a.M(J.type)===X&&u.push(new a.V(M,s.id,`duplicate light type "${s.type}", previously defined at line ${J.id.__line__}`))}const U=`properties_light_${s.type}`;if(!(U in S))return u=u.concat([new a.V("light-3d",s,`Invalid light type ${s.type}`)]),u;const H=S[U];for(const K in s)if(K==="properties"){const X=s[K],J=a.K(X);if(J!=="object")return u=u.concat([new a.V("properties",X,`object expected, ${J} found`)]),u;for(const de in X)u=u.concat(H[de]?yi({key:de,value:X[de],valueSpec:H[de],style:D,styleSpec:S}):[new a.J(x.key,X[de],`unknown property "${de}"`)])}else{const X=K.match(/^(.*)-transition$/),J=K.match(/^(.*)-use-theme$/);u=u.concat(J&&A[J[1]]?yi({key:K,value:s[K],valueSpec:{type:"string"},style:D,styleSpec:S}):X&&A[X[1]]&&A[X[1]].transition?yi({key:K,value:s[K],valueSpec:S.transition,style:D,styleSpec:S}):A[K]?yi({key:K,value:s[K],valueSpec:A[K],style:D,styleSpec:S}):[new a.J(K,s[K],`unknown property "${K}"`)])}return u}function cs(x){const s=x.value,u=x.key,y=x.style,S=x.styleSpec,A=S.terrain;let M=[];const D=a.K(s);if(s===void 0||D==="null")return M;if(D!=="object")return M=M.concat([new a.V("terrain",s,`object expected, ${D} found`)]),M;for(const z in s){const U=z.match(/^(.*)-transition$/),H=z.match(/^(.*)-use-theme$/);M=M.concat(H&&A[H[1]]?yi({key:z,value:s[z],valueSpec:{type:"string"},style:y,styleSpec:S}):U&&A[U[1]]&&A[U[1]].transition?yi({key:z,value:s[z],valueSpec:S.transition,style:y,styleSpec:S}):A[z]?yi({key:z,value:s[z],valueSpec:A[z],style:y,styleSpec:S}):[new a.J(z,s[z],`unknown property "${z}"`)])}if(s.source){const z=y.sources&&y.sources[s.source],U=z&&a.M(z.type);z?U!=="raster-dem"&&M.push(new a.V(u,s.source,`terrain cannot be used with a source of type ${String(U)}, it only be used with a "raster-dem" source type`)):M.push(new a.V(u,s.source,`source "${s.source}" not found`))}else M.push(new a.V(u,s,'terrain is missing required property "source"'));return M}function Os(x){const s=x.value,u=x.style,y=x.styleSpec,S=y.fog;let A=[];const M=a.K(s);if(s===void 0)return A;if(M!=="object")return A=A.concat([new a.V("fog",s,`object expected, ${M} found`)]),A;for(const D in s){const z=D.match(/^(.*)-transition$/),U=D.match(/^(.*)-use-theme$/);A=A.concat(U&&S[U[1]]?yi({key:D,value:s[D],valueSpec:{type:"string"},style:u,styleSpec:y}):z&&S[z[1]]&&S[z[1]].transition?yi({key:D,value:s[D],valueSpec:y.transition,style:u,styleSpec:y}):S[D]?yi({key:D,value:s[D],valueSpec:S[D],style:u,styleSpec:y}):[new a.J(D,s[D],`unknown property "${D}"`)])}return A}const vs={"*":()=>[],array:Ci,boolean:function(x){const s=x.value,u=x.key,y=a.K(s);return y!=="boolean"?[new a.V(u,s,`boolean expected, ${y} found`)]:[]},number:ls,color:function(x){const s=x.key,u=x.value,y=a.K(u);return y!=="string"?[new a.V(s,u,`color expected, ${y} found`)]:a.a0.parseCSSColor(u)===null?[new a.V(s,u,`color expected, "${u}" found`)]:[]},enum:Ft,filter:Hn,function:wa,layer:Yr,object:Mi,source:Ji,model:a.a4,light:Ka,"light-3d":La,terrain:cs,fog:Os,string:pi,formatted:function(x){return pi(x).length===0?[]:Xa(x)},resolvedImage:function(x){return pi(x).length===0?[]:Xa(x)},projection:function(x){const s=x.value,u=x.styleSpec,y=u.projection,S=x.style;let A=[];const M=a.K(s);if(M==="object")for(const D in s)A=A.concat(yi({key:D,value:s[D],valueSpec:y[D],style:S,styleSpec:u}));else M!=="string"&&(A=A.concat([new a.V("projection",s,`object or string expected, ${M} found`)]));return A},import:function(x){const{value:s,styleSpec:u}=x,{data:y,...S}=s;Object.defineProperty(S,"__line__",{value:s.__line__,enumerable:!1});let A=Mi(a.L({},x,{value:S,valueSpec:u.import}));return a.M(S.id)===""&&A.push(new a.V(`${x.key}.id`,S,"import id can't be an empty string")),y&&(A=A.concat(Yc(y,u,{key:`${x.key}.data`}))),A},iconset:function(x){const s=x.value,u=x.key,y=x.styleSpec,S=x.style;if(!s.type)return[new a.V(u,s,'"type" is required')];const A=a.M(s.type);let M=[];if(M=M.concat(Mi({key:u,value:s,valueSpec:y[`iconset_${A}`],style:S,styleSpec:y})),A==="source"&&s.source){const D=S.sources&&S.sources[s.source],z=D&&a.M(D.type);D?z!=="raster-array"&&M.push(new a.V(u,s.source,`iconset cannot be used with a source of type ${String(z)}, it only be used with a "raster-array" source type`)):M.push(new a.V(u,s.source,`source "${s.source}" not found`))}return M}};function yi(x,s=!1){const u=x.value,y=x.valueSpec,S=x.styleSpec;if(y.expression&&a.a2(a.M(u)))return wa(x);if(y.expression&&a.S(a.U(u)))return Xa(x);if(y.type&&vs[y.type]){const A=vs[y.type](x);return s===!0&&A.length>0&&a.K(x.value)==="array"?Xa(x):A}return Mi(a.L({},x,{valueSpec:y.type?S[y.type]:y}))}function Is(x){const s=x.value,u=x.key,y=pi(x);return y.length||(s.indexOf("{fontstack}")===-1&&y.push(new a.V(u,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&y.push(new a.V(u,s,'"glyphs" url must include a "{range}" token'))),y}function Yc(x,s=a.a5,u={}){return yi({key:u.key||"",value:x,valueSpec:s.$root,styleSpec:s,style:x,objectElementValidators:{glyphs:Is,"*":()=>[]}})}function ks(x,s=a.a5){return Be(Yc(x,s))}const Kl=x=>Be(Ji(x)),Hd=x=>Be(Ka(x)),Yl=x=>Be(La(x)),Kt=x=>Be(cs(x)),el=x=>Be(Os(x)),Fu=x=>Be(function(s){const u=s.value,y=s.style,S=s.styleSpec,A=S.snow;let M=[];const D=a.K(u);if(u===void 0)return M;if(D!=="object")return M=M.concat([new a.V("snow",u,`object expected, ${D} found`)]),M;for(const z in u){const U=z.match(/^(.*)-transition$/);M=M.concat(U&&A[U[1]]&&A[U[1]].transition?yi({key:z,value:u[z],valueSpec:S.transition,style:y,styleSpec:S}):A[z]?yi({key:z,value:u[z],valueSpec:A[z],style:y,styleSpec:S}):[new a.J(z,u[z],`unknown property "${z}"`)])}return M}(x)),Te=x=>Be(function(s){const u=s.value,y=s.style,S=s.styleSpec,A=S.rain;let M=[];const D=a.K(u);if(u===void 0)return M;if(D!=="object")return M=M.concat([new a.V("rain",u,`object expected, ${D} found`)]),M;for(const z in u){const U=z.match(/^(.*)-transition$/);M=M.concat(U&&A[U[1]]&&A[U[1]].transition?yi({key:z,value:u[z],valueSpec:S.transition,style:y,styleSpec:S}):A[z]?yi({key:z,value:u[z],valueSpec:A[z],style:y,styleSpec:S}):[new a.J(z,u[z],`unknown property "${z}"`)])}return M}(x)),te=x=>Be(Yr(x)),le=x=>Be(Hn(x)),ye=x=>Be(tr(x)),Me=x=>Be(Qn(x)),De=x=>Be(a.a4(x));function Be(x){return x.slice().sort((s,u)=>s.line&&u.line?s.line-u.line:0)}function Le(x,s){let u=!1;if(s&&s.length)for(const y of s)y instanceof a.J?a.w(y.message):(x.fire(new a.z(new Error(y.message))),u=!0);return u}let Ue;class Ye extends a.E{constructor(s,u="flat"){super(),this._transitionable=new a.a6(Ue||(Ue=new a.a7({anchor:new a.a8(a.a5.light.anchor),position:new a.a9(a.a5.light.position),color:new a.a8(a.a5.light.color),intensity:new a.a8(a.a5.light.intensity)}))),this.setLight(s,u),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,u,y={}){this._validate(Hd,s,y)||(this._transitionable.setTransitionOrValue(s),this.id=u)}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,u,y){return(!y||y.validate!==!1)&&Le(this,s.call(ks,a.l({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.a5})))}}let it=class extends a.E{constructor(x,s,u,y){super(),this.scope=u,this._transitionable=new a.a6(new a.a7({source:new a.a8(a.a5.terrain.source),exaggeration:new a.a8(a.a5.terrain.exaggeration)}),u,y),this._transitionable.setTransitionOrValue(x,y),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=s}get(){return this._transitionable.serialize()}set(x,s){this._transitionable.setTransitionOrValue(x,s)}updateTransitions(x){this._transitioning=this._transitionable.transitioned(x,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(x){this.properties=this._transitioning.possiblyEvaluate(x)}getExaggeration(x){return this._transitioning.possiblyEvaluate(new a.aa(x)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const x=this._transitionable._values.exaggeration;if(!x)return null;const s=x.value.expression;if(!s)return null;let u=-1,y=-1,S=1;for(const A of s.zoomStops)S=s.evaluate(new a.aa(A)),S>.01?(u=A,y=-1):y=A;return S<.01&&u>0&&y>u?[u,y]:null}isZoomDependent(){const x=this._transitionable._values.exaggeration;return x!=null&&x.value!=null&&x.value.expression!=null&&x.value.expression instanceof a.ab}};const Xe=45,St=65,qt=.05;function nn(x,s,u,y){const S=a.af(Xe,St,u),[A,M]=Fn(x,y);let D=1-Math.min(1,Math.exp((s-A)/(M-A)*-6));return D*=D*D,D=Math.min(1,1.00747*D),D*S*x.alpha}function Fn(x,s){const u=.5/Math.tan(.5*s);return[x.range[0]+u,x.range[1]+u]}function zn(x,s,u,y,S){const A=a.ad([],[s,u,y],S.mercatorFogMatrix);return nn(x,a.ae(A),S.pitch,S._fov)}function Ln(x,s,u,y,S,A,M){const D=[[u,y,0],[S,y,0],[S,A,0],[u,A,0]];let z=Number.MAX_VALUE,U=-Number.MAX_VALUE;for(const H of D){const K=a.ad([],H,s),X=a.ae(K);z=Math.min(z,X),U=Math.max(U,X)}return[nn(x,z,M.pitch,M._fov),nn(x,U,M.pitch,M._fov)]}class cr extends a.E{constructor(s,u,y,S){super();const A=new a.a7({range:new a.a8(a.a5.fog.range),color:new a.a8(a.a5.fog.color),"color-use-theme":new a.a8({type:"string","property-type":"data-constant",default:"default"}),"high-color":new a.a8(a.a5.fog["high-color"]),"high-color-use-theme":new a.a8({type:"string","property-type":"data-constant",default:"default"}),"space-color":new a.a8(a.a5.fog["space-color"]),"space-color-use-theme":new a.a8({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new a.a8(a.a5.fog["horizon-blend"]),"star-intensity":new a.a8(a.a5.fog["star-intensity"]),"vertical-range":new a.a8(a.a5.fog["vertical-range"])});this._transitionable=new a.a6(A,y,new Map(S)),this.set(s,S),this._transitioning=this._transitionable.untransitioned(),this._transform=u,this.properties=new a.ag(A),this.scope=y}get state(){const s=this._transform,u=s.projection.name==="globe",y=a.ah(s.zoom),S=this.properties.get("range"),A=[.5,3];return{range:u?[a.ai(A[0],S[0],y),a.ai(A[1],S[1],y)]:S,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(s,u,y={}){if(this._validate(el,s,y))return;const S=a.l({},s);for(const A of Object.keys(a.a5.fog))S[A]===void 0&&(S[A]=a.a5.fog[A].default);this._options=S,this._transitionable.setTransitionOrValue(this._options,u)}getOpacity(s){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.af(Xe,St,s))*u.a}getOpacityAtLatLng(s,u){return this._transform.projection.supportsFog?function(y,S,A){const M=a.ac.fromLngLat(S),D=A.elevation?A.elevation.getAtPointOrZero(M):0;return zn(y,M.x,M.y,D,A)}(this.state,s,u):0}getOpacityForTile(s){if(!this._transform.projection.supportsFog)return[1,1];const u=this._transform.calculateFogTileMatrix(s.toUnwrapped());return Ln(this.state,u,0,0,a.aj,a.aj,this._transform)}getOpacityForBounds(s,u,y,S,A){return this._transform.projection.supportsFog?Ln(this.state,s,u,y,S,A,this._transform):[1,1]}getFovAdjustedRange(s){return this._transform.projection.supportsFog?Fn(this.state,s):[0,1]}isVisibleOnFrustum(s){if(!this._transform.projection.supportsFog)return!1;const u=[4,5,6,7];for(const y of u){const S=s.points[y];let A;if(S[2]>=0)A=S;else{const M=s.points[y-4];A=a.ak(M,S,M[2]/(M[2]-S[2]))}if(zn(this.state,A[0],A[1],0,this._transform)>=qt)return!0}return!1}updateConfig(s){this._transitionable.setTransitionOrValue(this._options,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,u,y){return(!y||y.validate!==!1)&&Le(this,s.call(ks,a.l({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.a5})))}}let Qr,or,Lr,Cr,Jr=class extends a.E{constructor(x,s,u,y){super();const S=Qr||(Qr=new a.a7({density:new a.a8(a.a5.snow.density),intensity:new a.a8(a.a5.snow.intensity),color:new a.a8(a.a5.snow.color),opacity:new a.a8(a.a5.snow.opacity),vignette:new a.a8(a.a5.snow.vignette),"vignette-color":new a.a8(a.a5.snow["vignette-color"]),"center-thinning":new a.a8(a.a5.snow["center-thinning"]),direction:new a.a8(a.a5.snow.direction),"flake-size":new a.a8(a.a5.snow["flake-size"])}));this._transitionable=new a.a6(S,u,new Map(y)),this.set(x,y),this._transitioning=this._transitionable.untransitioned(),this.properties=new a.ag(S),this.scope=u}get state(){const x=this.properties.get("opacity"),s=this.properties.get("color"),u=this.properties.get("direction"),y=a.al(u[0]),S=-Math.max(a.al(u[1]),.01),A=[Math.cos(y)*Math.cos(S),Math.sin(y)*Math.cos(S),Math.sin(S)],M=this.properties.get("vignette"),D=this.properties.get("vignette-color");return D.a=M,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new a.am(s.r,s.g,s.b,s.a*x),direction:A,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:D}}get(){return this._transitionable.serialize()}set(x,s,u={}){if(this._validate(Fu,x,u))return;const y=a.l({},x);for(const S of Object.keys(a.a5.snow))y[S]===void 0&&(y[S]=a.a5.snow[S].default);this._options=y,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(x){this._transitionable.setTransitionOrValue(this._options,new Map(x))}updateTransitions(x){this._transitioning=this._transitionable.transitioned(x,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(x){this.properties=this._transitioning.possiblyEvaluate(x)}_validate(x,s,u){return(!u||u.validate!==!1)&&Le(this,x.call(ks,a.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:a.a5})))}},mi=class extends a.E{constructor(x,s,u,y){super();const S=or||(or=new a.a7({density:new a.a8(a.a5.rain.density),intensity:new a.a8(a.a5.rain.intensity),color:new a.a8(a.a5.rain.color),opacity:new a.a8(a.a5.rain.opacity),vignette:new a.a8(a.a5.rain.vignette),"vignette-color":new a.a8(a.a5.rain["vignette-color"]),"center-thinning":new a.a8(a.a5.rain["center-thinning"]),direction:new a.a8(a.a5.rain.direction),"droplet-size":new a.a8(a.a5.rain["droplet-size"]),"distortion-strength":new a.a8(a.a5.rain["distortion-strength"])}));this._transitionable=new a.a6(S,u,new Map(y)),this.set(x,y),this._transitioning=this._transitionable.untransitioned(),this.properties=new a.ag(S),this.scope=u}get state(){const x=this.properties.get("opacity"),s=this.properties.get("color"),u=this.properties.get("direction"),y=a.al(u[0]),S=-Math.max(a.al(u[1]),.01),A=[Math.cos(y)*Math.cos(S),Math.sin(y)*Math.cos(S),Math.sin(S)],M=this.properties.get("vignette-color");return M.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new a.am(s.r,s.g,s.b,s.a*x),direction:A,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:M}}get(){return this._transitionable.serialize()}set(x,s,u={}){if(this._validate(Te,x,u))return;const y=a.l({},x);for(const S of Object.keys(a.a5.rain))y[S]===void 0&&(y[S]=a.a5.rain[S].default);this._options=y,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(x){this._transitionable.setTransitionOrValue(this._options,new Map(x))}updateTransitions(x){this._transitioning=this._transitionable.transitioned(x,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(x){this.properties=this._transitioning.possiblyEvaluate(x)}_validate(x,s,u){return(!u||u.validate!==!1)&&Le(this,x.call(ks,a.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:a.a5})))}};class Ti extends a.E{constructor(s,u,y,S){super(),this.scope=y,this._options=s,this.properties=new a.ag(u),this._transitionable=new a.a6(u,y,new Map(S)),this._transitionable.setTransitionOrValue(s.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(s){this._transitionable.setTransitionOrValue(this._options.properties,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(s,u){this._options=s,this._transitionable.setTransitionOrValue(s.properties,u)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class ea{constructor(s,u,y,S){this.screenBounds=s,this.cameraPoint=u,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=y,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,S)}static createFromScreenPoints(s,u){let y,S;if(s instanceof a.P||typeof s[0]=="number"){const A=a.P.convert(s);y=[A],S=u.isPointAboveHorizon(A)}else{const A=a.P.convert(s[0]),M=a.P.convert(s[1]),D=A.add(M)._div(2);y=[A,M],S=a.ao(A,M).every(z=>u.isPointAboveHorizon(z))&&u.isPointAboveHorizon(D)}return new ea(y,u.getCameraPoint(),S,u)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(s){return a.ao(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],s)}bufferedCameraGeometry(s){const u=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],S=a.ao(u,y,0,!1);return this.cameraPoint.y>y.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<y.x?S.splice(3,0,this.cameraPoint):this.cameraPoint.x>=y.x?S[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(S[3]=this.cameraPoint)),a.ap(S,s)}bufferedCameraGeometryGlobe(s){const u=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],S=a.ao(u,y,s),A=this.cameraPoint.clone();switch(3*((A.y>u.y)+(A.y>y.y))+((A.x>u.x)+(A.x>y.x))){case 0:S[0]=A,S[4]=A.clone();break;case 1:S.splice(1,0,A);break;case 2:S[1]=A;break;case 3:S.splice(4,0,A);break;case 5:S.splice(2,0,A);break;case 6:S[3]=A;break;case 7:S.splice(3,0,A);break;case 8:S[2]=A}return S}containsTile(s,u,y,S=0){const A=s.queryPadding/u._pixelsPerMercatorPixel+1,M=y?this._bufferedCameraMercator(A,u):this._bufferedScreenMercator(A,u);let D=s.tileID.wrap+(M.unwrapped?S:0);const z=M.polygon.map(fe=>a.aq(s.tileTransform,fe,D));if(!a.ar(z,0,0,a.aj,a.aj))return;D=s.tileID.wrap+(this.screenGeometryMercator.unwrapped?S:0);const U=this.screenGeometryMercator.polygon.map(fe=>a.as(s.tileTransform,fe,D)),H=U.map(fe=>new a.P(fe[0],fe[1])),K=u.getFreeCameraOptions().position||new a.ac(0,0,0),X=a.as(s.tileTransform,K,D),J=U.map(fe=>{const ue=a.at(fe,fe,X);return a.au(ue,ue),new a.av(X,ue)}),de=a.aw(s,1,u.zoom)*u._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:H,tilespaceRays:J,bufferedTilespaceGeometry:z,bufferedTilespaceBounds:(ce=a.ax(z),ce.min.x=a.aD(ce.min.x,0,a.aj),ce.min.y=a.aD(ce.min.y,0,a.aj),ce.max.x=a.aD(ce.max.x,0,a.aj),ce.max.y=a.aD(ce.max.y,0,a.aj),ce),tile:s,tileID:s.tileID,pixelToTileUnitsFactor:de};var ce}_bufferedScreenMercator(s,u){const y=us(s);if(this._screenRaycastCache[y])return this._screenRaycastCache[y];{let S;return S=u.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(s),u):{polygon:this.bufferedScreenGeometry(s).map(A=>u.pointCoordinate3D(A)),unwrapped:!0},this._screenRaycastCache[y]=S,S}}_bufferedCameraMercator(s,u){const y=us(s);if(this._cameraRaycastCache[y])return this._cameraRaycastCache[y];{let S;return S=u.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(s),u):{polygon:this.bufferedCameraGeometry(s).map(A=>u.pointCoordinate3D(A)),unwrapped:!0},this._cameraRaycastCache[y]=S,S}}_projectAndResample(s,u){const y=function(A,M){const D=a.az([],M.pixelMatrix,M.globeMatrix),z=[0,-a.aE,0,1],U=[0,a.aE,0,1],H=[0,0,0,1];a.aA(z,z,D),a.aA(U,U,D),a.aA(H,H,D);const K=new a.P(z[0]/z[3],z[1]/z[3]),X=new a.P(U[0]/U[3],U[1]/U[3]),J=a.aB(A,K)&&z[3]<H[3],de=a.aB(A,X)&&U[3]<H[3];if(!J&&!de)return null;const ce=function(Oe,Ce,Fe){for(let $e=1;$e<Oe.length;$e++){const st=qi(Ce.pointCoordinate3D(Oe[$e-1]).x),et=qi(Ce.pointCoordinate3D(Oe[$e]).x);if(Fe<0){if(st<et)return{idx:$e,t:-st/(et-1-st)}}else if(et<st)return{idx:$e,t:(1-st)/(et+1-st)}}return null}(A,M,J?-1:1);if(!ce)return null;const{idx:fe,t:ue}=ce;let ve=fe>1?Ar(A.slice(0,fe),M):[],Ee=fe<A.length?Ar(A.slice(fe),M):[];ve=ve.map(Oe=>new a.P(qi(Oe.x),Oe.y)),Ee=Ee.map(Oe=>new a.P(qi(Oe.x),Oe.y));const Pe=[...ve];Pe.length===0&&Pe.push(Ee[Ee.length-1]);const ze=a.ai(Pe[Pe.length-1].y,(Ee.length===0?ve[0]:Ee[0]).y,ue);let Ie;return Ie=J?[new a.P(0,ze),new a.P(0,0),new a.P(1,0),new a.P(1,ze)]:[new a.P(1,ze),new a.P(1,1),new a.P(0,1),new a.P(0,ze)],Pe.push(...Ie),Ee.length===0?Pe.push(ve[0]):Pe.push(...Ee),{polygon:Pe.map(Oe=>new a.ac(Oe.x,Oe.y)),unwrapped:!1}}(s,u);if(y)return y;const S=function(A,M){let D=!1,z=-1/0,U=0;for(let K=0;K<A.length-1;K++)A[K].x>z&&(z=A[K].x,U=K);for(let K=0;K<A.length-1;K++){const X=(U+K)%(A.length-1),J=A[X],de=A[X+1];Math.abs(J.x-de.x)>.5&&(J.x<de.x?(J.x+=1,X===0&&(A[A.length-1].x+=1)):(de.x+=1,X+1===A.length-1&&(A[0].x+=1)),D=!0)}const H=a.ay(M.center.lng);return D&&H<Math.abs(H-1)&&A.forEach(K=>{K.x-=1}),{polygon:A,unwrapped:D}}(Ar(s,u).map(A=>new a.P(qi(A.x),A.y)),u);return{polygon:S.polygon.map(A=>new a.ac(A.x,A.y)),unwrapped:S.unwrapped}}}function Ar(x,s){return a.aC(x,u=>{const y=s.pointCoordinate3D(u);u.x=y.x,u.y=y.y},1/256)}function qi(x){return x<0?1+x%1:x%1}function us(x){return 100*x|0}function fa(x,s,u,y,S){const A=function(D,z){if(D)return S(D);if(z){if(x.url&&z.tiles&&x.tiles&&delete x.tiles,z.variants){if(!Array.isArray(z.variants))return S(new Error("variants must be an array"));for(const H of z.variants){if(H==null||typeof H!="object"||H.constructor!==Object)return S(new Error("variant must be an object"));if(!Array.isArray(H.capabilities))return S(new Error("capabilities must be an array"));if(H.capabilities.length===1&&H.capabilities[0]==="meshopt"){z=a.l(z,H);break}}}const U=a.aF(a.l({},z,x),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);U.tiles=s.canonicalizeTileset(U,x.url),S(null,U)}},M=function(D,z,U){if(!D)return null;if(!z&&!U)return D;U=U||D.worldview_default;const H=Object.values(D.language||{});if(H.length===0)return null;const K=Object.values(D.worldview||{});if(K.length===0)return null;const X=H.every(de=>de===z),J=K.every(de=>de===U);return X&&J?D:z in(D.language_options||{})||U in(D.worldview_options||{})?null:D.language_options&&D.worldview_options?D:null}(x.data,u,y);return M?a.q.frame(()=>A(null,M)):x.url?a.n(s.transformRequest(s.normalizeSourceURL(x.url,null,u,y),a.R.Source),A):a.q.frame(()=>{const{data:D,...z}=x;A(null,z)})}function Fa(x,s){const u=Math.pow(2,s.z),y=Math.floor(a.ay(x.getWest())*u),S=Math.floor(a.aH(x.getNorth())*u),A=Math.ceil(a.ay(x.getEast())*u),M=Math.ceil(a.aH(x.getSouth())*u);return s.x>=y&&s.x<A&&s.y>=S&&s.y<M}class ci{constructor(s,u,y){this.bounds=s?a.aG.convert(this.validateBounds(s)):null,this.minzoom=u||0,this.maxzoom=y||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}addExtraBounds(s){if(s){this.extraBounds||(this.extraBounds=[]);for(const u of s)this.extraBounds.push(a.aG.convert(this.validateBounds(u)))}}contains(s){if(s.z>this.maxzoom||s.z<this.minzoom||this.bounds&&!Fa(this.bounds,s))return!1;if(!this.extraBounds)return!0;for(const u of this.extraBounds)if(Fa(u,s))return!0;return!1}static fromTileJSON(s){if(!s.bounds&&!s.extra_bounds)return null;const u=new ci(s.bounds,s.minzoom,s.maxzoom);return u.addExtraBounds(s.extra_bounds),u}}class Ca extends a.E{constructor(s,u,y,S){if(super(),this.id=s,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.l(this,a.aF(u,["url","scheme","tileSize","promoteId"])),this._options=a.l({type:"vector"},u),this._collectResourceTiming=!!u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S),this._tileWorkers={},this._deduped=new a.aI}load(s){this._loaded=!1,this.fire(new a.A("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,y=this.map.getWorldview();this._tileJSONRequest=fa(this._options,this.map._requestManager,u,y,(S,A)=>{if(this._tileJSONRequest=null,this._loaded=!0,S)u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),y&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${y}`),this.fire(new a.z(S));else if(A){if(a.l(this,A),this.hasWorldviews=!!A.worldview_options,A.worldview_default&&(this.worldviewDefault=A.worldview_default),A.vector_layers){this.vectorLayers=A.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const M of A.vector_layers)this.vectorLayerIds.push(M.id),A.worldview&&A.worldview[M.source]&&this.localizableLayerIds.add(M.id)}this.tileBounds=ci.fromTileJSON(A),mt(A.tiles,this.map._requestManager._customAccessToken),this.fire(new a.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.A("data",{dataType:"source",sourceDataType:"content"}))}s&&s(S)})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();const s=a.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return a.l({},this._options)}loadTile(s,u){const y=s.tileID.canonical.url(this.tiles,this.scheme),S=this.map._requestManager.normalizeTileURL(y),A=this.map._requestManager.transformRequest(S,a.R.Tile),M=this.map.style?this.map.style.getLut(this.scope):null,D=M?{image:M.image.clone()}:null,z={request:A,data:void 0,uid:s.uid,tileID:s.tileID,tileZoom:s.tileZoom,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,lut:D,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:a.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:s.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:s.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&a.f(y)&&(z.worldview=this.map.getWorldview()||this.worldviewDefault,z.localizableLayerIds=this.localizableLayerIds),z.request.collectResourceTiming=this._collectResourceTiming,s.actor&&s.state!=="expired")s.state==="loading"?s.reloadCallback=u:s.request=s.actor.send("reloadTile",z,U.bind(this));else if(s.actor=this._tileWorkers[S]=this._tileWorkers[S]||this.dispatcher.getActor(),this.dispatcher.ready)s.request=s.actor.send("loadTile",z,U.bind(this),void 0,!0);else{const H=a.aJ.call({deduped:this._deduped},z,(K,X)=>{K||!X?U.call(this,K):(z.data={cacheControl:X.cacheControl,expires:X.expires,rawData:X.rawData.slice(0)},s.actor&&s.actor.send("loadTile",z,U.bind(this),void 0,!0))},!0);s.request={cancel:H}}function U(H,K){return delete s.request,s.aborted?u(null):H&&H.status!==404?u(H):(K&&K.resourceTiming&&(s.resourceTiming=K.resourceTiming),this.map._refreshExpiredTiles&&K&&s.setExpiryData(K),s.loadVectorData(K,this.map.painter),a.aK(this.dispatcher),u(null),void(s.reloadCallback&&(this.loadTile(s,s.reloadCallback),s.reloadCallback=null)))}}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(s,u){s.actor&&s.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope}),s.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class No extends a.E{constructor(s,u,y,S){super(),this.id=s,this.dispatcher=y,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.l({type:"raster"},u),a.l(this,a.aF(u,["url","scheme","tileSize"]))}load(s){this._loaded=!1,this.fire(new a.A("dataloading",{dataType:"source"})),this._tileJSONRequest=fa(this._options,this.map._requestManager,null,null,(u,y)=>{this._tileJSONRequest=null,this._loaded=!0,u?this.fire(new a.z(u)):y&&(a.l(this,y),y.raster_layers&&(this.rasterLayers=y.raster_layers,this.rasterLayerIds=this.rasterLayers.map(S=>S.id)),this.tileBounds=ci.fromTileJSON(y),mt(y.tiles),this.fire(new a.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.A("data",{dataType:"source",sourceDataType:"content"}))),s&&s(u)})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();const s=a.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return a.l({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s,u){const y=a.q.devicePixelRatio>=2,S=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),y,this.tileSize);s.request=a.o(this.map._requestManager.transformRequest(S,a.R.Tile),(A,M,D,z)=>(delete s.request,s.aborted?(s.state="unloaded",u(null)):A?(s.state="errored",u(A)):M?(this.map._refreshExpiredTiles&&s.setExpiryData({cacheControl:D,expires:z}),s.setTexture(M,this.map.painter),s.state="loaded",a.aK(this.dispatcher),void u(null)):u(null)))}abortTile(s,u){s.request&&(s.request.cancel(),delete s.request),u&&u()}unloadTile(s,u){s.texture&&s.texture instanceof a.T?(s.destroy(!0),s.texture&&s.texture instanceof a.T&&this.map.painter.saveTileTexture(s.texture)):s.destroy(),u&&u()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class rs extends No{constructor(s,u,y,S){super(s,u,y,S),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._options=a.l({type:"raster-array"},u)}triggerRepaint(s){const u=this.map.painter._terrain,y=this.map.style.getSourceCache(this.id);u&&u.enabled&&y&&u._clearRenderCacheForTile(y.id,s.tileID),this.map.triggerRepaint()}loadTile(s,u){const y=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),S=this.map._requestManager.transformRequest(y,a.R.Tile),A={request:S,uid:s.uid,tileID:s.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};s.source=this.id,s.scope=this.scope,s.requestParams=S,s.actor||(s.actor=this.dispatcher.getActor());const M=(D,z,U,H)=>{if(delete s.request,s.aborted)return s.state="unloaded",u(null);if(D)return D.name==="AbortError"?void 0:(s.state="errored",u(D));if(this.map._refreshExpiredTiles&&z&&s.setExpiryData({cacheControl:U,expires:H}),this.partial)s.state="empty";else{if(!z)return u(null);s.state="loaded",s._isHeaderLoaded=!0,s._mrt=z}u(null)};s.request=this.partial?s.fetchHeader(void 0,M.bind(this)):s.actor.send("loadTile",A,M.bind(this),void 0,!0)}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(s,u){const y=s.texture;y&&y instanceof a.T?(s.destroy(!0),this.map.painter.saveTileTexture(y)):(s.destroy(),s.flushQueues(),s._isHeaderLoaded=!1,delete s._mrt,delete s.textureDescriptor),s.fbo&&(s.fbo.destroy(),delete s.fbo),delete s.request,delete s.requestParams,delete s.neighboringTiles,s.state="unloaded"}prepareTile(s,u,y){s._isHeaderLoaded&&(s.state!=="empty"&&(s.state="reloading"),s.fetchBand(u,y,(S,A)=>{if(S)return s.state="errored",this.fire(new a.z(S)),void this.triggerRepaint(s);A&&(s._isHeaderLoaded=!0,s.setTexture(A,this.map.painter),s.state="loaded",this.triggerRepaint(s))}))}getInitialBand(s){if(!this.rasterLayers)return 0;const u=this.rasterLayers.find(({id:A})=>A===s),y=u&&u.fields,S=y&&y.bands&&y.bands;return S?S[0]:0}getTextureDescriptor(s,u,y){if(!s)return;const S=u.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!S)return;let A=null;u instanceof a.aN?A=u.paint.get("raster-array-band"):u instanceof a.aO&&(A=u.paint.get("raster-particle-array-band"));const M=A||this.getInitialBand(S);if(M!=null)if(s.textureDescriptor){if(!s.updateNeeded(S,M)||y)return Object.assign({},s.textureDescriptor,{texture:s.texture})}else this.prepareTile(s,S,M)}getImages(s,u){const y=new Map;for(const S of s)for(const A of u){const[M,D]=A.split("/"),z=S.getLayer(M);if(!z||!z.hasBand(D)||!z.hasDataForBand(D))continue;const{bytes:U,tileSize:H,buffer:K}=z.getBandView(D),X=H+2*K,J={data:new a.r({width:X,height:X},U),pixelRatio:2,sdf:!1,usvg:!1,version:0};y.set(A,J)}return y}}const nf={vector:Ca,raster:No,"raster-dem":class extends No{constructor(x,s,u,y){super(x,s,u,y),this.type="raster-dem",this.maxzoom=22,this._options=a.l({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}loadTile(x,s){const u=this.map._requestManager.normalizeTileURL(x.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function y(S,A){S&&(x.state="errored",s(S)),A&&(x.dem=A,x.dem.onDeserialize(),x.needsHillshadePrepare=!0,x.needsDEMTextureUpload=!0,x.state="loaded",s(null))}x.request=a.o(this.map._requestManager.transformRequest(u,a.R.Tile),(function(S,A,M,D){if(delete x.request,x.aborted)x.state="unloaded",s(null);else if(S)x.state="errored",s(S);else if(A){this.map._refreshExpiredTiles&&x.setExpiryData({cacheControl:M,expires:D});const z=ImageBitmap&&A instanceof ImageBitmap&&a.t(),U=1-(A.width-a.aL(A.width))/2;U<1||x.neighboringTiles||(x.neighboringTiles=this._getNeighboringTiles(x.tileID));const H=z?A:a.q.getImageData(A,U),K={uid:x.uid,tileID:x.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:H,encoding:this.encoding,padding:U};x.actor&&x.state!=="expired"||(x.actor=this.dispatcher.getActor(),x.actor.send("loadTile",K,y.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(x){const s=x.canonical,u=Math.pow(2,s.z),y=(s.x-1+u)%u,S=s.x===0?x.wrap-1:x.wrap,A=(s.x+1+u)%u,M=s.x+1===u?x.wrap+1:x.wrap,D={};return D[new a.aM(x.overscaledZ,S,s.z,y,s.y).key]={backfilled:!1},D[new a.aM(x.overscaledZ,M,s.z,A,s.y).key]={backfilled:!1},s.y>0&&(D[new a.aM(x.overscaledZ,S,s.z,y,s.y-1).key]={backfilled:!1},D[new a.aM(x.overscaledZ,x.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},D[new a.aM(x.overscaledZ,M,s.z,A,s.y-1).key]={backfilled:!1}),s.y+1<u&&(D[new a.aM(x.overscaledZ,S,s.z,y,s.y+1).key]={backfilled:!1},D[new a.aM(x.overscaledZ,x.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},D[new a.aM(x.overscaledZ,M,s.z,A,s.y+1).key]={backfilled:!1}),D}},"raster-array":rs,geojson:class extends a.E{constructor(x,s,u,y){super(),this.id=x,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(y),this._data=s.data,this._options=a.l({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.minzoom!==void 0&&(this.minzoom=s.minzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const S=a.aj/this.tileSize;this.workerOptions=a.l({source:this.id,scope:this.scope,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*S,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*S,extent:a.aj,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:a.aj,radius:(s.clusterRadius!==void 0?s.clusterRadius:50)*S,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter,dynamic:s.dynamic},s.workerOptions)}onAdd(x){this.map=x,this.setData(this._data)}setData(x){return this._data=x,this._updateWorkerData(),this}updateData(x){if(!this._options.dynamic)return this.fire(new a.z(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof x!="string"&&(x.type==="Feature"&&(x={type:"FeatureCollection",features:[x]}),x.type!=="FeatureCollection"))return this.fire(new a.z(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof x!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const s=new Map;for(const u of this._data.features)s.set(u.id,u);for(const u of x.features)s.set(u.id,u);this._data.features=[...s.values()]}else this._data=x;return this._updateWorkerData(!0),this}getClusterExpansionZoom(x,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:x,source:this.id,scope:this.scope},s),this}getClusterChildren(x,s){return this.actor.send("geojson.getClusterChildren",{clusterId:x,source:this.id,scope:this.scope},s),this}getClusterLeaves(x,s,u,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:x,limit:s,offset:u},y),this}_updateWorkerData(x=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.A("dataloading",{dataType:"source"})),this._loaded=!1;const s=a.l({append:x},this.workerOptions);s.scope=this.scope;const u=this._data;typeof u=="string"?(s.request=this.map._requestManager.transformRequest(a.q.resolveURL(u),a.R.Source),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(u),this._pendingLoad=this.actor.send(`${this.type}.loadData`,s,(y,S)=>{if(this._loaded=!0,this._pendingLoad=null,y)this.fire(new a.z(y));else{const A={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&S&&S.resourceTiming&&S.resourceTiming[this.id]&&(A.resourceTiming=S.resourceTiming[this.id]),x&&(this._partialReload=!0),this.fire(new a.A("data",A)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(x),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const x=a.C(this.id,this.scope);this.map.style.clearSource(x),this._updateWorkerData()}loadTile(x,s){const u=x.actor?"reloadTile":"loadTile";x.actor=this.actor;const y=this.map.style?this.map.style.getLut(this.scope):null,S=y?{image:y.image.clone()}:null,A=this._partialReload,M={type:this.type,uid:x.uid,tileID:x.tileID,tileZoom:x.tileZoom,zoom:x.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:S,scope:this.scope,pixelRatio:a.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:x.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:A};x.request=this.actor.send(u,M,(D,z)=>A&&!z?(x.state="loaded",s(null)):(delete x.request,x.destroy(),x.aborted?s(null):D?s(D):(x.loadVectorData(z,this.map.painter,u==="reloadTile"),s(null))),void 0,u==="loadTile")}abortTile(x){x.request&&(x.request.cancel(),delete x.request),x.aborted=!0}unloadTile(x,s){this.actor.send("removeTile",{uid:x.uid,type:this.type,source:this.id,scope:this.scope}),x.destroy()}onRemove(x){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends a.aP{constructor(x,s,u,y){super(x,s,u,y),this.roundZoom=!0,this.type="video",this.options=s}load(){this._loaded=!1;const x=this.options;this.urls=[];for(const s of x.urls)this.urls.push(this.map._requestManager.transformRequest(s,a.R.Source).url);a.aQ(this.urls,(s,u)=>{this._loaded=!0,s?this.fire(new a.z(s)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(x){if(this.video){const s=this.video.seekable;x<s.start(0)||x>s.end(0)?this.fire(new a.z(new a.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=x}}getVideo(){return this.video}onAdd(x){this.map||(this.map=x,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const x=this.map.painter.context,s=x.gl;this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new a.T(x,this.video,s.RGBA8),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(x)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:a.aP,model:class extends a.E{constructor(x,s,u,y){super(),this.id=x,this.type="model",this.models=[],this._loaded=!1,this._options=s}load(){const x=[];for(const s in this._options.models){const u=this._options.models[s],y=a.aS(this.map._requestManager.transformRequest(u.uri,a.R.Model).url).then(S=>{if(!S)return;const A=a.aT(S),M=new a.aU(s,u.position,u.orientation,A);M.computeBoundsAndApplyParent(),this.models.push(M)}).catch(S=>{this.fire(new a.z(new Error(`Could not load model ${s} from ${u.uri}: ${S.message}`)))});x.push(y)}Promise.allSettled(x).then(()=>{this._loaded=!0,this.fire(new a.A("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(s=>{this._loaded=!0,this.fire(new a.z(new Error(`Could not load models: ${s.message}`)))})}onAdd(x){this.map=x,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(x,s){}serialize(){return this._options}},"batched-model":class extends a.E{constructor(x,s,u,y){super(),this.type="batched-model",this.id=x,this.tileSize=512,this._options=s,this.tiles=this._options.tiles,this.maxzoom=s.maxzoom||19,this.minzoom=s.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=u,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(y)}onAdd(x){this.map=x,this.load()}reload(){this.cancelTileJSONRequest();const x=a.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(x))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(x){this._loaded=!1,this.fire(new a.A("dataloading",{dataType:"source"}));const s=Array.isArray(this.map._language)?this.map._language.join():this.map._language,u=this.map.getWorldview();this._tileJSONRequest=fa(this._options,this.map._requestManager,s,u,(y,S)=>{this._tileJSONRequest=null,this._loaded=!0,y?(s&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${s}`),u&&u.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${u}`),this.fire(new a.z(y))):S&&(a.l(this,S),S.bounds&&(this.tileBounds=new ci(S.bounds,this.minzoom,this.maxzoom)),mt(S.tiles,this.map._requestManager._customAccessToken),this.fire(new a.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.A("data",{dataType:"source",sourceDataType:"content"}))),x&&x(y)})}hasTransition(){return!1}hasTile(x){return!this.tileBounds||this.tileBounds.contains(x.canonical)}loaded(){return this._loaded}loadTile(x,s){const u=this.map._requestManager.normalizeTileURL(x.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(u,a.R.Tile),data:void 0,uid:x.uid,tileID:x.tileID,tileZoom:x.tileZoom,zoom:x.tileID.overscaledZ,tileSize:this.tileSize*x.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:x.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:a.q.devicePixelRatio,promoteId:this.promoteId};if(x.actor&&x.state!=="expired")if(x.state==="loading")x.reloadCallback=s;else{if(x.buckets){const A=Object.values(x.buckets);for(const M of A)M.dirty=!0;return void(x.state="loaded")}x.request=x.actor.send("reloadTile",y,S.bind(this))}else x.actor=this.dispatcher.getActor(),x.request=x.actor.send("loadTile",y,S.bind(this),void 0,!0);function S(A,M){return x.aborted?s(null):A&&A.status!==404?s(A):(this.map._refreshExpiredTiles&&M&&x.setExpiryData(M),x.loadModelData(M,this.map.painter),x.state="loaded",void s(null))}}serialize(){return a.l({},this._options)}},canvas:class extends a.aP{constructor(x,s,u,y){super(x,s,u,y),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(S=>!Array.isArray(S)||S.length!==2||S.some(A=>typeof A!="number"))||this.fire(new a.z(new a.V(`sources.${x}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.z(new a.V(`sources.${x}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new a.z(new a.V(`sources.${x}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new a.z(new a.V(`sources.${x}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.z(new a.V(`sources.${x}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.z(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(x){this.map=x,this.load(),this.canvas&&this.animate&&this.play()}onRemove(x){this.pause()}prepare(){let x=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,x=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,x=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context;this.texture?!x&&!this._playing||this.texture instanceof a.aR||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.T(s,this.canvas,s.gl.RGBA8,{premultiply:!0}),this._prepareData(s)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const x of[this.canvas.width,this.canvas.height])if(isNaN(x)||x<=0)return!0;return!1}},custom:class extends a.E{constructor(x,s,u,y){super(),this.id=x,this.type="custom",this._dataType="raster",this._dispatcher=u,this._implementation=s,this.setEventedParent(y),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.z(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.z(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new ci(this._implementation.bounds,this.minzoom,this.maxzoom)),s.update=this._update.bind(this),s.clearTiles=this._clearTiles.bind(this),s.coveringTiles=this._coveringTiles.bind(this),a.l(this,a.aF(s,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.aF(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.A("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(x){this.map=x,this._loaded=!1,this.fire(new a.A("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(x),this.load()}onRemove(x){this._implementation.onRemove&&this._implementation.onRemove(x)}hasTile(x){if(this._implementation.hasTile){const{x:s,y:u,z:y}=x.canonical;return this._implementation.hasTile({x:s,y:u,z:y})}return!this.tileBounds||this.tileBounds.contains(x.canonical)}loadTile(x,s){const{x:u,y,z:S}=x.tileID.canonical,A=new AbortController;x.request=Promise.resolve(this._implementation.loadTile({x:u,y,z:S},{signal:A.signal})).then((function(M){return delete x.request,x.aborted?(x.state="unloaded",s(null)):M===void 0?(x.state="errored",s(null)):M===null?(this.loadTileData(x,{width:this.tileSize,height:this.tileSize,data:null}),x.state="loaded",s(null)):function(D){return D instanceof ImageData||D instanceof HTMLCanvasElement||D instanceof ImageBitmap||D instanceof HTMLImageElement}(M)?(this.loadTileData(x,M),x.state="loaded",void s(null)):(x.state="errored",s(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(M=>{M.name!=="AbortError"&&(x.state="errored",s(M))}),x.request.cancel=()=>A.abort()}loadTileData(x,s){x.setTexture(s,this.map.painter)}unloadTile(x,s){if(x.texture&&x.texture instanceof a.T?(x.destroy(!0),x.texture&&x.texture instanceof a.T&&this.map.painter.saveTileTexture(x.texture)):x.destroy(),this._implementation.unloadTile){const{x:u,y,z:S}=x.tileID.canonical;this._implementation.unloadTile({x:u,y,z:S})}s&&s()}abortTile(x,s){x.request&&x.request.cancel&&(x.request.cancel(),delete x.request),s&&s()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(x=>({x:x.canonical.x,y:x.canonical.y,z:x.canonical.z}))}_clearTiles(){const x=a.C(this.id,this.scope);this.map.style.clearSource(x)}_update(){this.fire(new a.A("data",{dataType:"source",sourceDataType:"content"}))}}},rf=function(x,s,u,y){const S=new nf[s.type](x,s,u,y);if(S.id!==x)throw new Error(`Expected Source id to be ${x} instead of ${S.id}`);return a.aV(["load","abort","unload","serialize","prepare"],S),S};function Gd(x,s,u=""){return`${u}:${s.id||""}:${s.layer.id}:${function(y){if("layerId"in y)return`layer:${y.layerId}`;{const{featuresetId:S,importId:A}=y;return`featureset:${S}${A?`:import:${A}`:""}`}}(x.target)}`}function af(x,s,u,y=""){if(x.uniqueFeatureID){const S=Gd(x,s,y);if(u.has(S))return!0;u.add(S)}return!1}function Cc(x,s,u,y,S=!1){const A=s.sourceCache.transform,M=s.sourceCache.tilesIn(x,s.has3DLayers,S);M.sort(tl);const D=[];for(const z of M){const U=z.tile.queryRenderedFeatures(s,z,u,y,A,S);Object.keys(U).length&&D.push({wrappedTileID:z.tile.tileID.wrapped().key,queryResults:U})}return D.length===0?{}:function(z){const U={},H={};for(const K of z){const X=K.queryResults,J=K.wrappedTileID,de=H[J]=H[J]||{};for(const ce in X){const fe=X[ce],ue=de[ce]=de[ce]||{},ve=U[ce]=U[ce]||[];for(const Ee of fe)ue[Ee.featureIndex]||(ue[Ee.featureIndex]=!0,ve.push(Ee))}}return U}(D)}function dp(x,s,u,y,S){const A={},M=y.queryRenderedSymbols(x),D=[];for(const z of Object.keys(M).map(Number))D.push(S[z]);D.sort(tl);for(const z of D){const U=z.featureIndex.lookupSymbolFeatures(M[z.bucketInstanceId],z.bucketIndex,z.sourceLayerIndex,s,u);for(const H in U){const K=A[H]=A[H]||[],X=U[H];X.sort((J,de)=>{const ce=z.featureSortOrder;if(ce){const fe=ce.indexOf(J.featureIndex);return ce.indexOf(de.featureIndex)-fe}return de.featureIndex-J.featureIndex});for(const J of X)K.push(J)}}return A}function Do(x,s){const u=x.getRenderableIds().map(A=>x.getTileByID(A)),y=[],S={};for(let A=0;A<u.length;A++){const M=u[A],D=M.tileID.canonical.key;S[D]||(S[D]=!0,M.querySourceFeatures(y,s))}return y}function tl(x,s){const u=x.tileID,y=s.tileID;return u.overscaledZ-y.overscaledZ||u.canonical.y-y.canonical.y||u.wrap-y.wrap||u.canonical.x-y.canonical.x}function Hm(x,s){const u={};if(!s)return u;for(const y of x){const S=y.layerIds.map(A=>s.getLayer(A)).filter(Boolean);if(S.length!==0){y.layers=S,y.stateDependentLayerIds&&(y.stateDependentLayers=y.stateDependentLayerIds.map(A=>S.filter(M=>M.id===A)[0]));for(const A of S)u[A.fqid]=y}}return u}const Ks=32,Ys=33,jc=new Uint16Array(8184);for(let x=0;x<2046;x++){let s=x+2,u=0,y=0,S=0,A=0,M=0,D=0;for(1&s?S=A=M=Ks:u=y=D=Ks;(s>>=1)>1;){const U=u+S>>1,H=y+A>>1;1&s?(S=u,A=y,u=M,y=D):(u=S,y=A,S=M,A=D),M=U,D=H}const z=4*x;jc[z+0]=u,jc[z+1]=y,jc[z+2]=S,jc[z+3]=A}const _l=new Uint16Array(2178),Oo=new Uint8Array(1089),bl=new Uint16Array(1089);function sf(x){return x===0?-.03125:x===32?.03125:0}const Gm={type:2,extent:a.aj,loadGeometry:()=>[[new a.P(0,0),new a.P(a.aj+1,0),new a.P(a.aj+1,a.aj+1),new a.P(0,a.aj+1),new a.P(0,0)]]};class Ql{constructor(s,u,y,S,A){this.tileID=s,this.uid=a.a$(),this.uses=0,this.tileSize=u,this.tileZoom=y,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=A,S&&S.style&&(this._lastUpdatedBrightness=S.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",S&&S.transform&&(this.projection=S.transform.projection)}registerFadeDuration(s){const u=s+this.timeAdded;u<a.q.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=a.aW(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(s,u,y){if(this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=Hm(s.buckets,u.style),this.hasSymbolBuckets=!1;for(const S in this.buckets){const A=this.buckets[S];if(A instanceof a.b1){if(this.hasSymbolBuckets=!0,!y)break;A.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const S in this.buckets){const A=this.buckets[S];if(A instanceof a.b1&&A.hasRTLText){this.hasRTLText=!0,a.b2();break}}this.queryPadding=0;for(const S in this.buckets){const A=this.buckets[S],M=u.style.getOwnLayer(S);if(!M)continue;const D=M.queryRadius(A);this.queryPadding=Math.max(this.queryPadding,D)}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage),s.lineAtlas&&(this.lineAtlas=s.lineAtlas),this._lastUpdatedBrightness=s.brightness}else this.collisionBoxArray=new a.b0}unloadVectorData(){if(this.hasData()){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(s,u,y){s&&(s.resourceTiming&&(this.resourceTiming=s.resourceTiming),this.buckets=Object.assign({},this.buckets,Hm(s.buckets,u.style)),s.featureIndex&&(this.latestFeatureIndex=s.featureIndex))}getBucket(s){return this.buckets[s.fqid]}upload(s){for(const S in this.buckets){const A=this.buckets[S];A.uploadPending()&&A.upload(s)}const u=s.gl,y=this.imageAtlas;y&&!y.uploaded&&(this.imageAtlasTexture=new a.T(s,y.image,u.RGBA8,{useMipmap:!!y.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new a.T(s,this.glyphAtlasImage,u.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new a.T(s,this.lineAtlas.image,u.R8),this.lineAtlas.uploaded=!0)}prepare(s,u,y){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture,y),!u||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const S=u.style.getBrightness();(this._lastUpdatedBrightness||S)&&(this._lastUpdatedBrightness&&S&&Math.abs(this._lastUpdatedBrightness-S)<.001||(this.updateBuckets(u,this._lastUpdatedBrightness!==S),this._lastUpdatedBrightness=S))}queryRenderedFeatures(s,u,y,S,A,M){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const D=function(z,U){const H=a.bn([],[.5*z.width,.5*-z.height,1]);return a.bo(H,H,[1,-1,0]),a.az(H,H,z.calculateProjMatrix(U.toUnwrapped())),Float32Array.from(H)}(A,this.tileID);return this.latestFeatureIndex.query(s,{tilespaceGeometry:u,pixelPosMatrix:D,transform:S,availableImages:y,tileTransform:this.tileTransform})}querySourceFeatures(s,u){const y=this.latestFeatureIndex;if(!y||!y.rawTileData)return;const S=y.loadVTLayers(),A=u?u.sourceLayer:"",M=S._geojsonTileLayer||S[A];if(!M)return;const D=a.b3(u&&u.filter),{z,x:U,y:H}=this.tileID.canonical,K={z,x:U,y:H};for(let X=0;X<M.length;X++){const J=M.feature(X);if(D.needGeometry){const fe=a.b4(J,!0);if(!D.filter(new a.aa(this.tileID.overscaledZ),fe,this.tileID.canonical))continue}else if(!D.filter(new a.aa(this.tileID.overscaledZ),J))continue;const de=y.getId(J,A),ce=new a.b5(J,z,U,H,de);ce.tile=K,s.push(ce)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(s){const u=this.expirationTime;if(s.cacheControl){const y=a.b6(s.cacheControl);y["max-age"]&&(this.expirationTime=Date.now()+1e3*y["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const y=Date.now();let S=!1;if(this.expirationTime>y)S=!1;else if(u)if(this.expirationTime<u)S=!0;else{const A=this.expirationTime-u;A?this.expirationTime=y+Math.max(A,3e4):S=!0}else S=!0;S?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(s){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&s&&this.updateBuckets(s)}updateBuckets(s,u){if(!this.latestFeatureIndex||!s.style)return;const y=this.latestFeatureIndex.loadVTLayers(),S=s.style.listImages(),A=s.style.getBrightness();for(const M in this.buckets){if(!s.style.hasLayer(M))continue;const D=this.buckets[M],z=D.layers[0],U=z.sourceLayer||"_geojsonTileLayer",H=y[U],K=s.style.getLayerSourceCache(z);let X={};K&&(X=K._state.getState(U,void 0));const J=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},de=Object.keys(X).length>0&&!u;de&&!D.stateDependentLayers.length&&!u||D.update(X,H,S,J,de?D.stateDependentLayers:D.layers,u,A),(D instanceof a.b7||D instanceof a.b8)&&s._terrain&&s._terrain.enabled&&K&&D.uploadPending()&&s._terrain._clearRenderCacheForTile(K.id,this.tileID);const ce=s&&s.style&&s.style.getOwnLayer(M);ce&&(this.queryPadding=Math.max(this.queryPadding,ce.queryRadius(D)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=a.q.now()+s}setTexture(s,u){const y=u.context,S=y.gl;this.texture=this.texture||u.getTileTexture(s.width),this.texture&&this.texture instanceof a.T?this.texture.update(s):(this.texture=new a.T(y,s,S.RGBA8,{useMipmap:!0}),this.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE))}setDependencies(s,u){const y={};for(const S of u)y[S]=!0;this.dependencies[s]=y}hasDependency(s,u){for(const y of s){const S=this.dependencies[y];if(S){for(const A of u)if(S[A])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(s,u){if(!u||u.name==="mercator"||this._tileDebugBuffer)return;const y=a.b9(Gm,this.tileID.canonical,this.tileTransform)[0],S=new a.ba,A=new a.bb;for(let M=0;M<y.length;M++){const{x:D,y:z}=y[M];S.emplaceBack(D,z),A.emplaceBack(M)}A.emplaceBack(0),this._tileDebugIndexBuffer=s.createIndexBuffer(A),this._tileDebugBuffer=s.createVertexBuffer(S,a.bc.members),this._tileDebugSegments=a.bd.simpleSegment(0,0,S.length,A.length)}_makeTileBoundsBuffers(s,u){if(this._tileBoundsBuffer||!u||u.name==="mercator")return;const y=a.b9(Gm,this.tileID.canonical,this.tileTransform)[0];let S,A;if(this.isRaster){const M=function(D,z){const U=a.aW(D,z),H=Math.pow(2,D.z);for(let fe=0;fe<Ys;fe++)for(let ue=0;ue<Ys;ue++){const ve=a.aX((D.x+(ue+sf(ue))/Ks)/H),Ee=a.aY((D.y+(fe+sf(fe))/Ks)/H),Pe=z.project(ve,Ee),ze=fe*Ys+ue;_l[2*ze+0]=Math.round((Pe.x*U.scale-U.x)*a.aj),_l[2*ze+1]=Math.round((Pe.y*U.scale-U.y)*a.aj)}Oo.fill(0),bl.fill(0);for(let fe=2045;fe>=0;fe--){const ue=4*fe,ve=jc[ue+0],Ee=jc[ue+1],Pe=jc[ue+2],ze=jc[ue+3],Ie=ve+Pe>>1,Oe=Ee+ze>>1,Ce=Ie+Oe-Ee,Fe=Oe+ve-Ie,$e=Ee*Ys+ve,st=ze*Ys+Pe,et=Oe*Ys+Ie,_t=Math.hypot((_l[2*$e+0]+_l[2*st+0])/2-_l[2*et+0],(_l[2*$e+1]+_l[2*st+1])/2-_l[2*et+1])>=16;Oo[et]=Oo[et]||(_t?1:0),fe<1022&&(Oo[et]=Oo[et]||Oo[(Ee+Fe>>1)*Ys+(ve+Ce>>1)]||Oo[(ze+Fe>>1)*Ys+(Pe+Ce>>1)])}const K=new a.aZ,X=new a.a_;let J=0;function de(fe,ue){const ve=ue*Ys+fe;return bl[ve]===0&&(K.emplaceBack(_l[2*ve+0],_l[2*ve+1],fe*a.aj/Ks,ue*a.aj/Ks),bl[ve]=++J),bl[ve]-1}function ce(fe,ue,ve,Ee,Pe,ze){const Ie=fe+ve>>1,Oe=ue+Ee>>1;if(Math.abs(fe-Pe)+Math.abs(ue-ze)>1&&Oo[Oe*Ys+Ie])ce(Pe,ze,fe,ue,Ie,Oe),ce(ve,Ee,Pe,ze,Ie,Oe);else{const Ce=de(fe,ue),Fe=de(ve,Ee),$e=de(Pe,ze);X.emplaceBack(Ce,Fe,$e)}}return ce(0,0,Ks,Ks,Ks,0),ce(Ks,Ks,0,0,0,Ks),{vertices:K,indices:X}}(this.tileID.canonical,u);S=M.vertices,A=M.indices}else{S=new a.aZ,A=new a.a_;for(const{x:D,y:z}of y)S.emplaceBack(D,z,0,0);const M=a.be(S.int16.subarray(0,4*S.length),void 0,4);for(let D=0;D<M.length;D+=3)A.emplaceBack(M[D],M[D+1],M[D+2])}this._tileBoundsBuffer=s.createVertexBuffer(S,a.bf.members),this._tileBoundsIndexBuffer=s.createIndexBuffer(A),this._tileBoundsSegments=a.bd.simpleSegment(0,0,S.length,A.length)}_makeGlobeTileDebugBuffers(s,u){const y=u.projection;if(!y||y.name!=="globe"||u.freezeTileCoverage)return;const S=this.tileID.canonical,A=a.bg(S,u),M=a.bh(A),D=a.ah(u.zoom);let z;D>0&&(z=a.bi(new Float64Array(16),u.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(s,S,u,M,z,D),this._makeGlobeTileDebugTextBuffer(s,S,u,M,z,D)}_globePoint(s,u,y,S,A,M,D){let z=a.bj(s,u,y);if(M){const U=1<<y.z,H=a.ay(S.center.lng),K=a.aH(S.center.lat),X=(y.x+.5)/U-H;let J=0;X>.5?J=-1:X<-.5&&(J=1);let de=(s/a.aj+y.x)/U+J,ce=(u/a.aj+y.y)/U;de=(de-H)*S._pixelsPerMercatorPixel+H,ce=(ce-K)*S._pixelsPerMercatorPixel+K;const fe=[de*S.worldSize,ce*S.worldSize,0];a.ad(fe,fe,M),z=a.bk(z,fe,D)}return a.ad(z,z,A)}_makeGlobeTileDebugBorderBuffer(s,u,y,S,A,M){const D=new a.ba,z=new a.bb,U=new a.bl,H=(X,J,de,ce,fe)=>{const ue=(de-X)/(fe-1),ve=(ce-J)/(fe-1),Ee=D.length;for(let Pe=0;Pe<fe;Pe++){const ze=X+Pe*ue,Ie=J+Pe*ve;D.emplaceBack(ze,Ie);const Oe=this._globePoint(ze,Ie,u,y,S,A,M);U.emplaceBack(Oe[0],Oe[1],Oe[2]),z.emplaceBack(Ee+Pe)}},K=a.aj;H(0,0,K,0,16),H(K,0,K,K,16),H(K,K,0,K,16),H(0,K,0,0,16),this._tileDebugIndexBuffer=s.createIndexBuffer(z),this._tileDebugBuffer=s.createVertexBuffer(D,a.bc.members),this._globeTileDebugBorderBuffer=s.createVertexBuffer(U,a.bm.members),this._tileDebugSegments=a.bd.simpleSegment(0,0,D.length,z.length)}_makeGlobeTileDebugTextBuffer(s,u,y,S,A,M){const D=a.aj/4,z=new a.ba,U=new a.a_,H=new a.bl,K=25;U.reserve(32),z.reserve(K),H.reserve(K);const X=(J,de)=>K*J+de;for(let J=0;J<K;J++){const de=J*D;for(let ce=0;ce<K;ce++){const fe=ce*D;z.emplaceBack(fe,de);const ue=this._globePoint(fe,de,u,y,S,A,M);H.emplaceBack(ue[0],ue[1],ue[2])}}for(let J=0;J<4;J++)for(let de=0;de<4;de++){const ce=X(J,de),fe=X(J,de+1),ue=X(J+1,de),ve=X(J+1,de+1);U.emplaceBack(ce,fe,ue),U.emplaceBack(ue,fe,ve)}this._tileDebugTextIndexBuffer=s.createIndexBuffer(U),this._tileDebugTextBuffer=s.createVertexBuffer(z,a.bc.members),this._globeTileDebugTextBuffer=s.createVertexBuffer(H,a.bm.members),this._tileDebugTextSegments=a.bd.simpleSegment(0,0,K,32)}destroy(s=!1){for(const u in this.buckets)this.buckets[u].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!s&&this.texture&&this.texture instanceof a.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}a.bp.setPbf(a.bq);class hp extends Ql{constructor(s,u,y,S,A){super(s,u,y,S,A),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(s){return this._mrt&&this._mrt.getLayer(s)}setTexture(s,u){const y=u.context,S=y.gl;this.texture=this.texture||u.getTileTexture(s.width),this.texture&&this.texture instanceof a.T?this.texture.update(s,{premultiply:!1}):this.texture=new a.T(y,s,S.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(s=16384,u){const y=this._mrt=new a.bp(30),S=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(s-1)}});return this.entireBuffer=null,this.request=a.br(S,(A,M,D,z)=>{if(A)u(A);else try{const U=y.getHeaderLength(M);if(U>s)return void(this.request=this.fetchHeader(U,u));y.parseHeader(M),this._isHeaderLoaded=!0;let H=0;for(const K of Object.values(y.layers))H=Math.max(H,K.dataIndex[K.dataIndex.length-1].lastByte);M.byteLength>=H&&(this.entireBuffer=M),u(null,this.entireBuffer||M,D,z)}catch(U){u(U)}}),this.request}fetchBand(s,u,y){const S=this._mrt;if(!this._isHeaderLoaded||!S)return void y(new Error("Tile header is not ready"));const A=this.actor;if(!A)return void y(new Error("Can't fetch tile band without an actor"));let M;const D=(K,X)=>{M.complete(K,X),K?y(K):(this.updateTextureDescriptor(s,u),y(null,this.textureDescriptor&&this.textureDescriptor.img))},z=(K,X)=>{if(K)return y(K);const J=A.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:X,task:M},D,void 0,!0);this._workQueue.push(()=>{J&&J.cancel(),M.cancel()})},U=S.getLayer(s);if(!U)return void y(new Error(`Unknown sourceLayer "${s}"`));if(U.hasDataForBand(u))return this.updateTextureDescriptor(s,u),void y(null,this.textureDescriptor?this.textureDescriptor.img:null);const H=U.getDataRange([u]);if(M=S.createDecodingTask(H),!M||M.tasks.length)if(this.flushQueues(),this.entireBuffer)z(null,this.entireBuffer.slice(H.firstByte,H.lastByte+1));else{const K=Object.assign({},this.requestParams,{headers:{Range:`bytes=${H.firstByte}-${H.lastByte}`}}),X=a.br(K,z);this._fetchQueue.push(()=>{X.cancel(),M.cancel()})}else y(null)}updateNeeded(s,u){return(!this.textureDescriptor||this.textureDescriptor.band!==u||this.textureDescriptor.layer!==s)&&this.state!=="errored"}updateTextureDescriptor(s,u){if(!this._mrt)return;const y=this._mrt.getLayer(s);if(!y||!y.hasBand(u)||!y.hasDataForBand(u))return;const{bytes:S,tileSize:A,buffer:M,offset:D,scale:z}=y.getBandView(u),U=A+2*M,H=new a.r({width:U,height:U},S),K=this.texture;K&&K instanceof a.T&&K.update(H,{premultiply:!1}),this.textureDescriptor={layer:s,band:u,img:H,buffer:M,offset:D,tileSize:A,format:y.pixelFormat,mix:[z,256*z,65536*z,16777216*z]}}}class vx{constructor(s,u){this.max=s,this.onRemove=u,this.reset()}reset(){for(const s in this.data)for(const u of this.data[s])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(s,u,y){const S=s.wrapped().key;this.data[S]===void 0&&(this.data[S]=[]);const A={value:u,timeout:void 0};if(y!==void 0&&(A.timeout=setTimeout(()=>{this.remove(s,A)},y)),this.data[S].push(A),this.order.push(S),this.order.length>this.max){const M=this._getAndRemoveByKey(this.order[0]);M&&this.onRemove(M)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const u=this.data[s].shift();return u.timeout&&clearTimeout(u.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),u.value}getByKey(s){const u=this.data[s];return u?u[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,u){if(!this.has(s))return this;const y=s.wrapped().key,S=u===void 0?0:this.data[y].indexOf(u),A=this.data[y][S];return this.data[y].splice(S,1),A.timeout&&clearTimeout(A.timeout),this.data[y].length===0&&delete this.data[y],this.onRemove(A.value),this.order.splice(this.order.indexOf(y),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(s){const u=[];for(const y in this.data)for(const S of this.data[y])s(S.value)||u.push(S);for(const y of u)this.remove(y.value.tileID,y)}}class Bu{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,u,y){const S=String(u);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][S]=this.stateChanges[s][S]||{},a.l(this.stateChanges[s][S],y),this.deletedStates[s]===null){this.deletedStates[s]={};for(const A in this.state[s])A!==S&&(this.deletedStates[s][A]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][S]===null){this.deletedStates[s][S]={};for(const A in this.state[s][S])y[A]||(this.deletedStates[s][S][A]=null)}else for(const A in y)this.deletedStates[s]&&this.deletedStates[s][S]&&this.deletedStates[s][S][A]===null&&delete this.deletedStates[s][S][A]}removeFeatureState(s,u,y){if(this.deletedStates[s]===null)return;const S=String(u);if(this.deletedStates[s]=this.deletedStates[s]||{},y&&u!==void 0)this.deletedStates[s][S]!==null&&(this.deletedStates[s][S]=this.deletedStates[s][S]||{},this.deletedStates[s][S][y]=null);else if(u!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][S])for(y in this.deletedStates[s][S]={},this.stateChanges[s][S])this.deletedStates[s][S][y]=null;else this.deletedStates[s][S]=null;else this.deletedStates[s]=null}getState(s,u){const y=this.state[s]||{},S=this.stateChanges[s]||{},A=this.deletedStates[s];if(A===null)return{};if(u!==void 0){const D=String(u),z=a.l({},y[D],S[D]);if(A){const U=A[u];if(U===null)return{};for(const H in U)delete z[H]}return z}const M=a.l({},y,S);if(A)for(const D in A)delete M[D];return M}initializeTileState(s,u){s.refreshFeatureState(u)}coalesceChanges(s,u){const y={};for(const S in this.stateChanges){this.state[S]=this.state[S]||{};const A={};for(const M in this.stateChanges[S])this.state[S][M]||(this.state[S][M]={}),a.l(this.state[S][M],this.stateChanges[S][M]),A[M]=this.state[S][M];y[S]=A}for(const S in this.deletedStates){this.state[S]=this.state[S]||{};const A={};if(this.deletedStates[S]===null)for(const M in this.state[S])A[M]={},this.state[S][M]={};else for(const M in this.deletedStates[S]){if(this.deletedStates[S][M]===null)this.state[S][M]={};else if(this.state[S][M])for(const D of Object.keys(this.deletedStates[S][M]))delete this.state[S][M][D];A[M]=this.state[S][M]}y[S]=y[S]||{},a.l(y[S],A)}if(this.stateChanges={},this.deletedStates={},Object.keys(y).length!==0)for(const S in s)s[S].refreshFeatureState(u)}}class _s extends a.E{constructor(s,u,y){super(),this.id=s,this._onlySymbols=y,u.on("data",S=>{S.dataType==="source"&&S.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&S.dataType==="source"&&S.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),u.on("error",()=>{this._sourceErrored=!0}),this._source=u,this._tiles={},this._cache=new vx(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Bu,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(s){this.map=s,this._minTileCacheSize=this._minTileCacheSize===void 0&&s?s._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&s?s._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const s in this._tiles)if(!this._tiles[s].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(s,u){return s.isSymbolTile=this._onlySymbols,s.isExtraShadowCaster=this._shadowCasterTiles[s.tileID.key],this._source.loadTile(s,u)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s)}_abortTile(s){if(this._source.abortTile)return this._source.abortTile(s)}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const y=this._tiles[u];y.upload(s),y.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(s=>s.tileID).sort(of).map(s=>s.key)}getRenderableIds(s,u){const y=[];for(const S in this._tiles)this._isIdRenderable(+S,s,u)&&y.push(this._tiles[S]);return s?y.sort((S,A)=>{const M=S.tileID,D=A.tileID,z=new a.P(M.canonical.x,M.canonical.y)._rotate(this.transform.angle),U=new a.P(D.canonical.x,D.canonical.y)._rotate(this.transform.angle);return M.overscaledZ-D.overscaledZ||U.y-z.y||U.x-z.x}).map(S=>S.tileID.key):y.map(S=>S.tileID).sort(of).map(S=>S.key)}hasRenderableParent(s){const u=this.findLoadedParent(s,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(s,u,y){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(u||!this._tiles[s].holdingForFade())&&(y||!this._shadowCasterTiles[s])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(+s,"reloading")}}_reloadTile(s,u){const y=this._tiles[s];y&&(y.state!=="loading"&&(y.state=u),this._loadTile(y,this._tileLoaded.bind(this,y,s,u)))}_tileLoaded(s,u,y,S){if(S)if(s.state="errored",S.status!==404)this._source.fire(new a.z(S,{tile:s}));else{if(this._source.fire(new a.A("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:s})),!(s.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const A=this.map.painter.terrain;this.update(this.transform,A.getScaledDemTileSize(),!0),A.resetTileLookupCache(this.id)}else this.update(this.transform)}else s.timeAdded=a.q.now(),y==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(u,s),this._source.type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),this._source.fire(new a.A("data",{dataType:"source",tile:s,coord:s.tileID,sourceCacheId:this.id}))}_backfillDEM(s){const u=this.getRenderableIds();for(let S=0;S<u.length;S++){const A=u[S];if(s.neighboringTiles&&s.neighboringTiles[A]){const M=this.getTileByID(A);y(s,M),y(M,s)}}function y(S,A){if(!S.dem||S.dem.borderReady)return;S.needsHillshadePrepare=!0,S.needsDEMTextureUpload=!0;let M=A.tileID.canonical.x-S.tileID.canonical.x;const D=A.tileID.canonical.y-S.tileID.canonical.y,z=Math.pow(2,S.tileID.canonical.z),U=A.tileID.key;M===0&&D===0||Math.abs(D)>1||(Math.abs(M)>1&&(Math.abs(M+z)===1?M+=z:Math.abs(M-z)===1&&(M-=z)),A.dem&&S.dem&&(S.dem.backfillBorder(A.dem,M,D),S.neighboringTiles&&S.neighboringTiles[U]&&(S.neighboringTiles[U].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,u,y,S){for(const A in this._tiles){let M=this._tiles[A];if(S[A]||!M.hasData()||M.tileID.overscaledZ<=u||M.tileID.overscaledZ>y)continue;let D=M.tileID;for(;M&&M.tileID.overscaledZ>u+1;){const U=M.tileID.scaledTo(M.tileID.overscaledZ-1);M=this._tiles[U.key],M&&M.hasData()&&(D=U)}let z=D;for(;z.overscaledZ>u;)if(z=z.scaledTo(z.overscaledZ-1),s[z.key]){S[D.key]=D;break}}}findLoadedParent(s,u){if(s.key in this._loadedParentTiles){const y=this._loadedParentTiles[s.key];return y&&y.tileID.overscaledZ>=u?y:null}for(let y=s.overscaledZ-1;y>=u;y--){const S=s.scaledTo(y),A=this._getLoadedTile(S);if(A)return A}}_getLoadedTile(s){const u=this._tiles[s.key];return u&&u.hasData()?u:this._cache.getByKey(this._source.reparseOverscaled?s.wrapped().key:s.canonical.key)}updateCacheSize(s,u){u=u||this._source.tileSize;const y=Math.ceil(s.width/u)+1,S=Math.ceil(s.height/u)+1,A=Math.floor(y*S*5),M=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,A):A,D=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,M):M;this._cache.setMaxSize(D)}handleWrapJump(s){const u=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,u){const y={};for(const S in this._tiles){const A=this._tiles[S];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+u),y[A.tileID.key]=A}this._tiles=y;for(const S in this._timers)clearTimeout(this._timers[S]),delete this._timers[S];for(const S in this._tiles)this._setTileReloadTimer(+S,this._tiles[S])}}update(s,u,y,S,A){if(this.transform=s,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!y)return;this.updateCacheSize(s,u),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const M=this._source.type==="batched-model";let D,z=this._source.maxzoom;const U=this.map&&this.map.painter?this.map.painter._terrain:null;if(U&&U.sourceCache===this&&U.attenuationRange()){const X=U.attenuationRange()[0],J=Math.floor(X)-Math.log2(U.getDemUpscale());z>J&&(z=J)}if(this.used||this.usedForTerrain){if(this._source.tileID)D=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(X=>new a.aM(X.canonical.z,X.wrap,X.canonical.z,X.canonical.x,X.canonical.y));else if(this.tileCoverLift!==0){const X=s.clone();X.tileCoverLift=this.tileCoverLift,D=X.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:z,roundZoom:this._source.roundZoom&&!y,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:M}),this._source.minzoom<=1&&s.projection.name==="globe"&&(D.push(new a.aM(1,0,1,0,0)),D.push(new a.aM(1,0,1,1,0)),D.push(new a.aM(1,0,1,0,1)),D.push(new a.aM(1,0,1,1,1)))}else if(D=s.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:z,roundZoom:this._source.roundZoom&&!y,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:M}),this._source.hasTile){const X=this._source.hasTile.bind(this._source);D=D.filter(J=>X(J))}}else D=[];if(D.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Qc(this._source.type)){const X=s.coveringZoomLevel({tileSize:u||this._source.tileSize,roundZoom:this._source.roundZoom&&!y}),J=Math.min(X,this._source.maxzoom);if(M){const de=s.extendTileCover(D,J);for(const ce of de)D.push(ce)}else if(A){const de=s.extendTileCover(D,J,this.transform._camera.forward());for(const ce of de)D.push(ce)}else if(this.castsShadows&&S){const de=s.extendTileCover(D,J,S);for(const ce of de)this._shadowCasterTiles[ce.key]=!0,D.push(ce)}}const H=this._updateRetainedTiles(D);if(Qc(this._source.type)&&D.length!==0){const X={},J={},de=Object.keys(H);for(const fe of de){const ue=H[fe],ve=this._tiles[fe];if(!ve||ve.fadeEndTime&&ve.fadeEndTime<=a.q.now())continue;const Ee=this.findLoadedParent(ue,Math.max(ue.overscaledZ-_s.maxOverzooming,this._source.minzoom));Ee&&(this._addTile(Ee.tileID),X[Ee.tileID.key]=Ee.tileID),J[fe]=ue}const ce=D[D.length-1].overscaledZ;for(const fe in this._tiles){const ue=this._tiles[fe];if(H[fe]||!ue.hasData())continue;let ve=ue.tileID;for(;ve.overscaledZ>ce;){ve=ve.scaledTo(ve.overscaledZ-1);const Ee=this._tiles[ve.key];if(Ee&&Ee.hasData()&&J[ve.key]){H[fe]=ue.tileID;break}}}for(const fe in X)H[fe]||(this._coveredTiles[fe]=!0,H[fe]=X[fe])}for(const X in H)this._tiles[X].clearFadeHold();const K=a.bs(this._tiles,H);for(const X of K){const J=this._tiles[X];J.hasSymbolBuckets&&!J.holdingForFade()?J.setHoldDuration(this.map._fadeDuration):J.hasSymbolBuckets&&!J.symbolFadeFinished()||this._removeTile(+X)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(+s)}_updateRetainedTiles(s){const u={};if(s.length===0)return u;const y={},S=s.reduce((U,H)=>Math.min(U,H.overscaledZ),1/0),A=s[0].overscaledZ,M=Math.max(A-_s.maxOverzooming,this._source.minzoom),D=Math.max(A+_s.maxUnderzooming,this._source.minzoom),z={};for(const U of s){const H=this._addTile(U);u[U.key]=U,H.hasData()||S<this._source.maxzoom&&(z[U.key]=U)}this._retainLoadedChildren(z,S,D,u);for(const U of s){let H=this._tiles[U.key];if(H.hasData())continue;if(U.canonical.z>=this._source.maxzoom){const X=U.children(this._source.maxzoom)[0],J=this.getTile(X);if(J&&J.hasData()){u[X.key]=X;continue}}else{const X=U.children(this._source.maxzoom);if(u[X[0].key]&&u[X[1].key]&&u[X[2].key]&&u[X[3].key])continue}let K=H.wasRequested();for(let X=U.overscaledZ-1;X>=M;--X){const J=U.scaledTo(X);if(y[J.key]||(y[J.key]=!0,H=this.getTile(J),!H&&K&&(H=this._addTile(J)),H&&(u[J.key]=J,K=H.wasRequested(),H.hasData())))break}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const u=[];let y,S=this._tiles[s].tileID;for(;S.overscaledZ>0;){if(S.key in this._loadedParentTiles){y=this._loadedParentTiles[S.key];break}u.push(S.key);const A=S.scaledTo(S.overscaledZ-1);if(y=this._getLoadedTile(A),y)break;S=A}for(const A of u)this._loadedParentTiles[A]=y}}_addTile(s){let u=this._tiles[s.key];if(u)return u.isExtraShadowCaster!==!0||this._shadowCasterTiles[s.key]||this._reloadTile(s.key,"reloading"),u;u=this._cache.getAndRemove(s),u&&(this._setTileReloadTimer(s.key,u),u.tileID=s,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,u)));const y=!!u;if(!y){const S=this.map?this.map.painter:null,A=this._source.tileSize*s.overscaleFactor();u=this._source.type==="raster-array"?new hp(s,A,this.transform.tileZoom,S,this._isRaster):new Ql(s,A,this.transform.tileZoom,S,this._isRaster),this._loadTile(u,this._tileLoaded.bind(this,u,s.key,u.state))}return u.uses++,this._tiles[s.key]=u,y||this._source.fire(new a.A("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(s,u){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const y=u.getExpiryTimeout();y&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},y))}_removeTile(s){const u=this._tiles[s];u&&(u.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),u.uses>0||(u.hasData()&&u.state!=="reloading"||u.state==="empty"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(+s);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(s,u,y){const S=[],A=this.transform;if(!A)return S;const M=A.projection.name==="globe",D=a.ay(A.center.lng);for(const z in this._tiles){const U=this._tiles[z];if(y&&U.clearQueryDebugViz(),U.holdingForFade())continue;let H;if(M){const K=U.tileID.canonical;if(K.z===0){const X=[Math.abs(a.aD(D,...Jl(K,-1))-D),Math.abs(a.aD(D,...Jl(K,1))-D)];H=[0,2*X.indexOf(Math.min(...X))-1]}else{const X=[Math.abs(a.aD(D,...Jl(K,-1))-D),Math.abs(a.aD(D,...Jl(K,0))-D),Math.abs(a.aD(D,...Jl(K,1))-D)];H=[X.indexOf(Math.min(...X))-1]}}else H=[0];for(const K of H){const X=s.containsTile(U,A,u,K);X&&S.push(X)}}return S}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(s){return this._getRenderableCoordinates(s)}_getRenderableCoordinates(s,u){const y=this.getRenderableIds(s,u).map(A=>this._tiles[A].tileID),S=this.transform.projection.name==="globe";for(const A of y)A.projMatrix=this.transform.calculateProjMatrix(A.toUnwrapped()),A.expandedProjMatrix=S?this.transform.calculateProjMatrix(A.toUnwrapped(),!1,!0):A.projMatrix;return y}sortCoordinatesByDistance(s){const u=s.slice(),y=this.transform._camera.position,S=this.transform._camera.forward(),A={};for(const M of u){const D=1/(1<<M.canonical.z);A[M.key]=((M.canonical.x+.5)*D+M.wrap-y[0])*S[0]+((M.canonical.y+.5)*D-y[1])*S[1]-y[2]*S[2]}return u.sort((M,D)=>A[M.key]-A[D.key]),u}hasTransition(){if(this._source.hasTransition())return!0;if(Qc(this._source.type))for(const s in this._tiles){const u=this._tiles[s];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=a.q.now())return!0}return!1}setFeatureState(s,u,y){this._state.updateState(s=s||"_geojsonTileLayer",u,y)}removeFeatureState(s,u,y){this._state.removeFeatureState(s=s||"_geojsonTileLayer",u,y)}getFeatureState(s,u){return this._state.getState(s=s||"_geojsonTileLayer",u)}setDependencies(s,u,y){const S=this._tiles[s];S&&S.setDependencies(u,y)}reloadTilesForDependencies(s,u){for(const y in this._tiles)this._tiles[y].hasDependency(s,u)&&this._reloadTile(+y,"reloading");this._cache.filter(y=>!y.hasDependency(s,u))}_preloadTiles(s,u){if(!this._sourceLoaded){const z=()=>{this._sourceLoaded&&(this._source.off("data",z),this._preloadTiles(s,u))};return void this._source.on("data",z)}const y=new Map,S=Array.isArray(s)?s:[s],A=this.map.painter.terrain,M=this.usedForTerrain&&A?A.getScaledDemTileSize():this._source.tileSize;for(const z of S){const U=z.coveringTiles({tileSize:M,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const H of U)y.set(H.key,H);this.usedForTerrain&&z.updateElevation(!1)}const D=Array.from(y.values());a.bt(D,(z,U)=>{const H=new Ql(z,this._source.tileSize*z.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(H,K=>{this._source.type==="raster-dem"&&H.dem&&this._backfillDEM(H),U(K,H)})},u)}}function of(x,s){const u=Math.abs(2*x.wrap)-+(x.wrap<0),y=Math.abs(2*s.wrap)-+(s.wrap<0);return x.overscaledZ-s.overscaledZ||y-u||s.canonical.y-x.canonical.y||s.canonical.x-x.canonical.x}function Qc(x){return x==="raster"||x==="image"||x==="video"||x==="custom"}function Jl(x,s){const u=1<<x.z;return[x.x/u+s,(x.x+1)/u+s]}_s.maxOverzooming=10,_s.maxUnderzooming=3;class _x{constructor(s){this.style=s,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const s=!1,u=!1;for(const y in this.style._mergedLayers){const S=this.style._mergedLayers[y];if(S.type==="fill-extrusion")this.layers.push({layer:S,visible:s,visibilityChanged:u});else if(S.type==="model"){const A=this.style.getLayerSource(S);A&&A.type==="batched-model"&&this.layers.push({layer:S,visible:s,visibilityChanged:u})}}}onNewFrame(s){this.layersGotHidden=!1;for(const u of this.layers){const y=u.layer;let S=!1;y.type==="fill-extrusion"?S=!y.isHidden(s)&&y.paint.get("fill-extrusion-opacity")>0:y.type==="model"&&(S=!y.isHidden(s)&&y.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!S&&u.visible,u.visible=S}}updateZOffset(s,u){this.currentBuildingBuckets=[];for(const S of this.layers){const A=S.layer,M=this.style.getLayerSourceCache(A);let D=1;A.type==="fill-extrusion"&&(D=S.visible?A.paint.get("fill-extrusion-vertical-scale"):0);let z=M?M.getTile(u):null;if(!z&&M&&u.canonical.z>M.getSource().minzoom){let U=u.scaledTo(Math.min(M.getSource().maxzoom,u.overscaledZ-1));for(;U.overscaledZ>=M.getSource().minzoom&&(z=M.getTile(U),!z&&U.overscaledZ!==0);)U=U.scaledTo(U.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:z?z.getBucket(A):null,tileID:z?z.tileID:u,verticalScale:D})}s.hasAnyZOffset=!1;let y=!1;for(let S=0;S<s.symbolInstances.length;S++){const A=s.symbolInstances.get(S),M=A.zOffset,D=this._getHeightAtTileOffset(u,A.tileAnchorX,A.tileAnchorY);A.zOffset=D!==Number.NEGATIVE_INFINITY?D:M,y||M===A.zOffset||(y=!0),s.hasAnyZOffset||A.zOffset===0||(s.hasAnyZOffset=!0)}y&&(s.zOffsetBuffersNeedUpload=!0,s.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(s,u,y,S){let A=u,M=y;if(s.canonical.z!==S.canonical.z){const D=S.canonical,z=1/(1<<s.canonical.z-D.z);A=(u+s.canonical.x*a.aj)*z-D.x*a.aj|0,M=(y+s.canonical.y*a.aj)*z-D.y*a.aj|0}return{tileX:A,tileY:M}}_getHeightAtTileOffset(s,u,y){let S,A;for(let M=0;M<this.layers.length;++M){if(this.layers[M].layer.type!=="fill-extrusion")continue;const{bucket:D,tileID:z,verticalScale:U}=this.currentBuildingBuckets[M];if(!D)continue;const{tileX:H,tileY:K}=this._mapCoordToOverlappingTile(s,u,y,z),X=D.getHeightAtTileCoord(H,K);X&&X.height!==void 0&&(X.hidden?S=X.height:A=Math.max(X.height*U,A||0))}if(A!==void 0)return A;for(let M=0;M<this.layers.length;++M){const D=this.layers[M];if(D.layer.type!=="model"||!D.visible)continue;const{bucket:z,tileID:U}=this.currentBuildingBuckets[M];if(!z)continue;const{tileX:H,tileY:K}=this._mapCoordToOverlappingTile(s,u,y,U),X=z.getHeightAtTileCoord(H,K);if(X&&!X.hidden)return X.height===void 0&&S!==void 0?Math.min(X.maxHeight,S)*X.verticalScale:X.height?X.height*X.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function lf(x,s){const u={};for(const y in x)y!=="ref"&&(u[y]=x[y]);return a.bu.forEach(y=>{y in s&&(u[y]=s[y])}),u}function fp(x){x=x.slice();const s=Object.create(null);for(let u=0;u<x.length;u++)s[x[u].id]=x[u];for(let u=0;u<x.length;u++)"ref"in x[u]&&(x[u]=lf(x[u],s[x[u].ref]));return x}const Rr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function Io(x,s,u){u.push({command:Rr.addSource,args:[x,s[x]]})}function Vu(x,s,u){s.push({command:Rr.removeSource,args:[x]}),u[x]=!0}function pp(x,s,u,y){Vu(x,u,y),Io(x,s,u)}function Jc(x,s,u){let y;for(y in x[u])if(x[u].hasOwnProperty(y)&&y!=="data"&&!a.bv(x[u][y],s[u][y]))return!1;for(y in s[u])if(s[u].hasOwnProperty(y)&&y!=="data"&&!a.bv(x[u][y],s[u][y]))return!1;return!0}function eu(x,s,u,y,S,A){let M;for(M in s=s||{},x=x||{})x.hasOwnProperty(M)&&(a.bv(x[M],s[M])||u.push({command:A,args:[y,M,s[M],S]}));for(M in s)s.hasOwnProperty(M)&&!x.hasOwnProperty(M)&&(a.bv(x[M],s[M])||u.push({command:A,args:[y,M,s[M],S]}))}function ec(x){return x.id}function Wd(x,s){return x[s.id]=s,x}class mp{constructor(s,u){this.reset(s,u)}reset(s,u){this.points=s||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=a.aD(s,0,1);let u=1,y=this._distances[u];const S=s*this.paddedLength+this.padding;for(;y<S&&u<this._distances.length;)y=this._distances[++u];const A=u-1,M=this._distances[A],D=y-M,z=D>0?(S-M)/D:0;return this.points[A].mult(1-z).add(this.points[u].mult(z))}}class cf{constructor(s,u,y){const S=this.boxCells=[],A=this.circleCells=[];this.xCellCount=Math.ceil(s/y),this.yCellCount=Math.ceil(u/y);for(let M=0;M<this.xCellCount*this.yCellCount;M++)S.push([]),A.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=u,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,u,y,S,A){this._forEachCell(u,y,S,A,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(u),this.bboxes.push(y),this.bboxes.push(S),this.bboxes.push(A)}insertCircle(s,u,y,S){this._forEachCell(u-S,y-S,u+S,y+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(u),this.circles.push(y),this.circles.push(S)}_insertBoxCell(s,u,y,S,A,M){this.boxCells[A].push(M)}_insertCircleCell(s,u,y,S,A,M){this.circleCells[A].push(M)}_query(s,u,y,S,A,M){if(y<0||s>this.width||S<0||u>this.height)return!A&&[];const D=[];if(s<=0&&u<=0&&this.width<=y&&this.height<=S){if(A)return!0;for(let z=0;z<this.boxKeys.length;z++)D.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const U=this.circles[3*z],H=this.circles[3*z+1],K=this.circles[3*z+2];D.push({key:this.circleKeys[z],x1:U-K,y1:H-K,x2:U+K,y2:H+K})}return M?D.filter(M):D}return this._forEachCell(s,u,y,S,this._queryCell,D,{hitTest:A,seenUids:{box:{},circle:{}}},M),A?D.length>0:D}_queryCircle(s,u,y,S,A){const M=s-y,D=s+y,z=u-y,U=u+y;if(D<0||M>this.width||U<0||z>this.height)return!S&&[];const H=[];return this._forEachCell(M,z,D,U,this._queryCellCircle,H,{hitTest:S,circle:{x:s,y:u,radius:y},seenUids:{box:{},circle:{}}},A),S?H.length>0:H}query(s,u,y,S,A){return this._query(s,u,y,S,!1,A)}hitTest(s,u,y,S,A){return this._query(s,u,y,S,!0,A)}hitTestCircle(s,u,y,S){return this._queryCircle(s,u,y,!0,S)}_queryCell(s,u,y,S,A,M,D,z){const U=D.seenUids,H=this.boxCells[A];if(H!==null){const X=this.bboxes;for(const J of H)if(!U.box[J]){U.box[J]=!0;const de=4*J;if(s<=X[de+2]&&u<=X[de+3]&&y>=X[de+0]&&S>=X[de+1]&&(!z||z(this.boxKeys[J]))){if(D.hitTest)return M.push(!0),!0;M.push({key:this.boxKeys[J],x1:X[de],y1:X[de+1],x2:X[de+2],y2:X[de+3]})}}}const K=this.circleCells[A];if(K!==null){const X=this.circles;for(const J of K)if(!U.circle[J]){U.circle[J]=!0;const de=3*J;if(this._circleAndRectCollide(X[de],X[de+1],X[de+2],s,u,y,S)&&(!z||z(this.circleKeys[J]))){if(D.hitTest)return M.push(!0),!0;{const ce=X[de],fe=X[de+1],ue=X[de+2];M.push({key:this.circleKeys[J],x1:ce-ue,y1:fe-ue,x2:ce+ue,y2:fe+ue})}}}}}_queryCellCircle(s,u,y,S,A,M,D,z){const U=D.circle,H=D.seenUids,K=this.boxCells[A];if(K!==null){const J=this.bboxes;for(const de of K)if(!H.box[de]){H.box[de]=!0;const ce=4*de;if(this._circleAndRectCollide(U.x,U.y,U.radius,J[ce+0],J[ce+1],J[ce+2],J[ce+3])&&(!z||z(this.boxKeys[de])))return M.push(!0),!0}}const X=this.circleCells[A];if(X!==null){const J=this.circles;for(const de of X)if(!H.circle[de]){H.circle[de]=!0;const ce=3*de;if(this._circlesCollide(J[ce],J[ce+1],J[ce+2],U.x,U.y,U.radius)&&(!z||z(this.circleKeys[de])))return M.push(!0),!0}}}_forEachCell(s,u,y,S,A,M,D,z){const U=this._convertToXCellCoord(s),H=this._convertToYCellCoord(u),K=this._convertToXCellCoord(y),X=this._convertToYCellCoord(S);for(let J=U;J<=K;J++)for(let de=H;de<=X;de++)if(A.call(this,s,u,y,S,this.xCellCount*de+J,M,D,z))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,u,y,S,A,M){const D=S-s,z=A-u,U=y+M;return U*U>D*D+z*z}_circleAndRectCollide(s,u,y,S,A,M,D){const z=(M-S)/2,U=Math.abs(s-(S+z));if(U>z+y)return!1;const H=(D-A)/2,K=Math.abs(u-(A+H));if(K>H+y)return!1;if(U<=z||K<=H)return!0;const X=U-z,J=K-H;return X*X+J*J<=y*y}}const Uu={unknown:0,flipRequired:1,flipNotRequired:2},bs=Math.tan(85*Math.PI/180);function wl(x,s,u,y,S,A,M){const D=a.bz();if(u)if(A.name==="globe"){const z=a.bA(S,s);a.az(D,D,z)}else{const z=a.bB([],M);D[0]=z[0],D[1]=z[1],D[4]=z[2],D[5]=z[3],y||a.by(D,D,S.angle)}else a.az(D,S.labelPlaneMatrix,x);return D}function Zd(x,s,u,y,S,A,M){const D=wl(x,s,u,y,S,A,M);return A.name==="globe"&&u||(D[2]=D[6]=D[10]=D[14]=0),D}function Xd(x,s,u,y,S,A,M){if(u){if(A.name==="globe"){const D=wl(x,s,u,y,S,A,M);return a.bi(D,D),a.az(D,x,D),D}{const D=a.bw(x),z=a.bx([]);return z[0]=M[0],z[1]=M[1],z[4]=M[2],z[5]=M[3],a.az(D,D,z),y||a.by(D,D,-S.angle),D}}return S.glCoordMatrix}function ko(x,s,u,y){const S=[x,s,u,1];u?a.aA(S,S,y):Ry(S,S,y);const A=S[3];return S[0]/=A,S[1]/=A,S[2]/=A,S}function Mc(x,s){return Math.min(.5+x/s*.5,1.5)}function gp(x,s){const u=x[0]/x[3],y=x[1]/x[3];return u>=-s[0]&&u<=s[0]&&y>=-s[1]&&y<=s[1]}function Kd(x,s,u,y,S,A,M,D,z,U){const H=u.transform,K=y?x.textSizeData:x.iconSizeData,X=a.bH(K,u.transform.zoom),J=H.projection.name==="globe",de=[256/u.width*2+1,256/u.height*2+1],ce=y?x.text.dynamicLayoutVertexArray:x.icon.dynamicLayoutVertexArray;ce.clear();let fe=null;J&&(fe=y?x.text.globeExtVertexArray:x.icon.globeExtVertexArray);const ue=x.lineVertexArray,ve=y?x.text.placedSymbolArray:x.icon.placedSymbolArray,Ee=u.transform.width/u.transform.height;let Pe,ze=!1;for(let Ie=0;Ie<ve.length;Ie++){const Oe=ve.get(Ie),{numGlyphs:Ce,writingMode:Fe}=Oe;if(Fe!==a.bI.vertical||ze||Pe===a.bI.horizontal||(ze=!0),Pe=Fe,(Oe.hidden||Fe===a.bI.vertical)&&!ze){Kr(Ce,ce);continue}ze=!1;const $e=new a.P(Oe.tileAnchorX,Oe.tileAnchorY);let{x:st,y:et,z:_t}=H.projection.projectTilePoint($e.x,$e.y,U.canonical);if(z){const[yn,Tn,gn]=z($e);st+=yn,et+=Tn,_t+=gn}const xt=[st,et,_t,1];if(a.aA(xt,xt,s),!gp(xt,de)){Kr(Ce,ce);continue}const Bt=xt[3],Je=Mc(u.transform.getCameraToCenterDistance(H.projection),Bt),lt=a.bJ(K,X,Oe),Ke=M?lt/Je:lt*Je,Et=ko(st,et,_t,S);if(Et[3]<=0){Kr(Ce,ce);continue}let ct={};const Dt=a.al(x.layers[0].layout.get("text-max-angle")),wt=Math.cos(Dt),Ot=M?null:z,zt=Ro(Oe,Ke,!1,D,s,S,A,x.glyphOffsetArray,ue,ce,fe,Et,$e,ct,Ee,Ot,H.projection,U,M,wt);ze=zt.useVertical,Ot&&zt.needsFlipping&&(ct={}),(zt.notEnoughRoom||ze||zt.needsFlipping&&Ro(Oe,Ke,!0,D,s,S,A,x.glyphOffsetArray,ue,ce,fe,Et,$e,ct,Ee,Ot,H.projection,U,M,wt).notEnoughRoom)&&Kr(Ce,ce)}y?(x.text.dynamicLayoutVertexBuffer.updateData(ce),fe&&x.text.globeExtVertexBuffer&&x.text.globeExtVertexBuffer.updateData(fe)):(x.icon.dynamicLayoutVertexBuffer.updateData(ce),fe&&x.icon.globeExtVertexBuffer&&x.icon.globeExtVertexBuffer.updateData(fe))}function Yd(x,s,u,y,S,A,M,D,z,U,H,K,X,J,de,ce,fe){const{lineStartIndex:ue,glyphStartIndex:ve,segment:Ee}=D,Pe=ve+D.numGlyphs,ze=ue+D.lineLength,Ie=s.getoffsetX(ve),Oe=s.getoffsetX(Pe-1),Ce=Qd(x*Ie,u,y,S,A,M,Ee,ue,ze,z,U,H,K,X,!0,J,de,ce,fe);if(!Ce)return null;const Fe=Qd(x*Oe,u,y,S,A,M,Ee,ue,ze,z,U,H,K,X,!0,J,de,ce,fe);return Fe?{first:Ce,last:Fe}:null}function $u(x,s,u,y){return x===a.bI.horizontal&&Math.abs(y)>Math.abs(u)?{useVertical:!0}:x===a.bI.vertical?y>0?{needsFlipping:!0}:null:s!==Uu.unknown&&function(S,A){return S===0||Math.abs(A/S)>bs}(u,y)?s===Uu.flipRequired?{needsFlipping:!0}:null:u<0?{needsFlipping:!0}:null}function Ro(x,s,u,y,S,A,M,D,z,U,H,K,X,J,de,ce,fe,ue,ve,Ee){const Pe=s/24,ze=x.lineOffsetX*Pe,Ie=x.lineOffsetY*Pe,{lineStartIndex:Oe,glyphStartIndex:Ce,numGlyphs:Fe,segment:$e,writingMode:st,flipState:et}=x,_t=Oe+x.lineLength,xt=Bt=>{if(H){const[Et,ct,Dt]=Bt.up,wt=U.length;a.bK(H,wt+0,Et,ct,Dt),a.bK(H,wt+1,Et,ct,Dt),a.bK(H,wt+2,Et,ct,Dt),a.bK(H,wt+3,Et,ct,Dt)}const[Je,lt,Ke]=Bt.point;a.bL(U,Je,lt,Ke,Bt.angle)};if(Fe>1){const Bt=Yd(Pe,D,ze,Ie,u,K,X,x,z,A,J,ce,!1,fe,ue,ve,Ee);if(!Bt)return{notEnoughRoom:!0};if(y&&!u){let[Je,lt,Ke]=Bt.first.point,[Et,ct,Dt]=Bt.last.point;[Je,lt]=ko(Je,lt,Ke,M),[Et,ct]=ko(Et,ct,Dt,M);const wt=$u(st,et,(Et-Je)*de,ct-lt);if(x.flipState=wt&&wt.needsFlipping?Uu.flipRequired:Uu.flipNotRequired,wt)return wt}xt(Bt.first);for(let Je=Ce+1;Je<Ce+Fe-1;Je++){const lt=Qd(Pe*D.getoffsetX(Je),ze,Ie,u,K,X,$e,Oe,_t,z,A,J,ce,!1,!1,fe,ue,ve,Ee);if(!lt)return U.length-=4*(Je-Ce),{notEnoughRoom:!0};xt(lt)}xt(Bt.last)}else{if(y&&!u){const Je=ko(X.x,X.y,0,S),lt=Oe+$e+1,Ke=new a.P(z.getx(lt),z.gety(lt)),Et=ko(Ke.x,Ke.y,0,S),ct=Et[3]>0?Et:Wm(X,Ke,Je,1,S,void 0,fe,ue.canonical),Dt=$u(st,et,(ct[0]-Je[0])*de,ct[1]-Je[1]);if(x.flipState=Dt&&Dt.needsFlipping?Uu.flipRequired:Uu.flipNotRequired,Dt)return Dt}const Bt=Qd(Pe*D.getoffsetX(Ce),ze,Ie,u,K,X,$e,Oe,_t,z,A,J,ce,!1,!1,fe,ue,ve,Ee);if(!Bt)return{notEnoughRoom:!0};xt(Bt)}return{}}function bx(x,s,u,y,S){const{x:A,y:M,z:D}=y.projectTilePoint(x.x,x.y,s);if(!S)return ko(A,M,D,u);const[z,U,H]=S(x);return ko(A+z,M+U,D+H,u)}function Wm(x,s,u,y,S,A,M,D){const z=bx(x.sub(s)._unit()._add(x),D,S,M,A);return a.at(z,u,z),a.au(z,z),a.bF(z,u,z,y)}function Qd(x,s,u,y,S,A,M,D,z,U,H,K,X,J,de,ce,fe,ue,ve){const Ee=y?x-s:x+s;let Pe=Ee>0?1:-1,ze=0;y&&(Pe*=-1,ze=Math.PI),Pe<0&&(ze+=Math.PI);let Ie=D+M+(Pe>0?0:1)|0,Oe=S,Ce=S,Fe=0,$e=0;const st=Math.abs(Ee),et=[],_t=[];let xt=A,Bt=xt,Je=a.bC([]);const lt=()=>Wm(Bt,xt,Ce,st-Fe+1,H,X,ce,fe.canonical);for(;Fe+$e<=st;){if(Ie+=Pe,Ie<D||Ie>=z)return null;if(Ce=Oe,Bt=xt,et.push(Ce),J&&_t.push(Bt),xt=new a.P(U.getx(Ie),U.gety(Ie)),Oe=K[Ie],!Oe){const gn=bx(xt,fe.canonical,H,ce,X);Oe=gn[3]>0?K[Ie]=gn:lt()}Fe+=$e;const yn=a.at([],Oe,Ce),Tn=a.bD(Ce,Oe);if(u&&Tn>0&&$e>0&&a.bE(Je,yn)/($e*Tn)<ve)return null;$e=Tn,Je=yn}de&&X&&(K[Ie]&&(Oe=lt(),$e=a.bD(Ce,Oe),Je=a.at([],Oe,Ce)),K[Ie]=Oe);const Ke=(st-Fe)/$e,Et=xt.sub(Bt)._mult(Ke)._add(Bt),ct=a.bF([],Ce,Je,Ke);let Dt=[0,0,1],wt=Je[0],Ot=Je[1];if(ue&&(Dt=ce.upVector(fe.canonical,Et.x,Et.y),Dt[0]!==0||Dt[1]!==0||Dt[2]!==1)){const yn=[Dt[2],0,-Dt[0]],Tn=a.bG([],Dt,yn);a.au(yn,yn),a.au(Tn,Tn),wt=a.bE(Je,yn),Ot=a.bE(Je,Tn)}if(u){const yn=a.bG([],Dt,Je);a.au(yn,yn),a.bF(ct,ct,yn,u*Pe)}const zt=ze+Math.atan2(Ot,wt);return et.push(ct),J&&_t.push(Et),{point:ct,angle:zt,path:et,tilePath:_t,up:Dt}}function Kr(x,s){const u=s.length,y=u+4*x;s.resize(y),s.float32.fill(-1/0,4*u,4*y)}function Ry(x,s,u){const y=s[0],S=s[1];return x[0]=u[0]*y+u[4]*S+u[12],x[1]=u[1]*y+u[5]*S+u[13],x[3]=u[3]*y+u[7]*S+u[15],x}const Vn=100;class zy{constructor(s,u,y=new cf(s.width+200,s.height+200,25),S=new cf(s.width+200,s.height+200,25)){this.transform=s,this.grid=y,this.ignoredGrid=S,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+Vn,this.screenBottomBoundary=s.height+Vn,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.fogState=u}placeCollisionBox(s,u,y,S,A,M,D,z){let U=y.projectedAnchorX,H=y.projectedAnchorY,K=y.projectedAnchorZ;const X=y.elevation,J=y.tileID,de=s.getProjection();if(X&&J){const[Ie,Oe,Ce]=de.upVector(J.canonical,y.tileAnchorX,y.tileAnchorY),Fe=de.upVectorScale(J.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;U+=Ie*X*Fe,H+=Oe*X*Fe,K+=Ce*X*Fe}const ce=this.projectAndGetPerspectiveRatio(D,U,H,K,y.tileID,de.name==="globe"||!!X||this.transform.pitch>0,de),fe=M*ce.perspectiveRatio,ue=(y.x1*u+S.x-y.padding)*fe+ce.point.x,ve=(y.y1*u+S.y-y.padding)*fe+ce.point.y,Ee=(y.x2*u+S.x+y.padding)*fe+ce.point.x,Pe=(y.y2*u+S.y+y.padding)*fe+ce.point.y,ze=ce.perspectiveRatio<=.55||ce.occluded;return!this.isInsideGrid(ue,ve,Ee,Pe)||!A&&this.grid.hitTest(ue,ve,Ee,Pe,z)||ze?{box:[],offscreen:!1,occluded:ce.occluded}:{box:[ue,ve,Ee,Pe],offscreen:this.isOffscreen(ue,ve,Ee,Pe),occluded:!1}}placeCollisionCircles(s,u,y,S,A,M,D,z,U,H,K,X,J,de,ce){const fe=[],ue=this.transform.elevation,ve=s.getProjection(),Ee=ue?ue.getAtTileOffsetFunc(ce,this.transform.center.lat,this.transform.worldSize,ve):null,Pe=new a.P(y.tileAnchorX,y.tileAnchorY);let{x:ze,y:Ie,z:Oe}=ve.projectTilePoint(Pe.x,Pe.y,ce.canonical);if(Ee){const[Dt,wt,Ot]=Ee(Pe);ze+=Dt,Ie+=wt,Oe+=Ot}const Ce=ve.name==="globe",Fe=this.projectAndGetPerspectiveRatio(D,ze,Ie,Oe,ce,Ce||!!ue||this.transform.pitch>0,ve),{perspectiveRatio:$e}=Fe,st=(K?M/$e:M*$e)/a.bO,et=ko(ze,Ie,Oe,z),_t=y.lineOffsetX*st,xt=y.lineOffsetY*st,Bt=a.al(s.layers[0].layout.get("text-max-angle")),Je=Math.cos(Bt),lt=Fe.signedDistanceFromCamera>0?Yd(st,A,_t,xt,!1,et,Pe,y,S,z,{},ue&&!K?Ee:null,K&&!!ue,ve,ce,K,Je):null;let Ke=!1,Et=!1,ct=!0;if(lt&&!Fe.occluded){const Dt=.5*J*$e+de,wt=new a.P(-100,-100),Ot=new a.P(this.screenRightBoundary,this.screenBottomBoundary),zt=new mp,{first:yn,last:Tn}=lt,gn=yn.path.length;let Pn=[];for(let ir=gn-1;ir>=1;ir--)Pn.push(yn.path[ir]);for(let ir=1;ir<Tn.path.length;ir++)Pn.push(Tn.path[ir]);const Sn=2.5*Dt;U&&(Pn=Pn.map(([ir,$n,ur],Yn)=>(Ee&&!Ce&&(ur=Ee(Yn<gn-1?yn.tilePath[gn-1-Yn]:Tn.tilePath[Yn-gn+2])[2]),ko(ir,$n,ur,U))),Pn.some(ir=>ir[3]<=0)&&(Pn=[]));let qn=[];if(Pn.length>0){let ir=1/0,$n=-1/0,ur=1/0,Yn=-1/0;for(const Bn of Pn)ir=Math.min(ir,Bn[0]),ur=Math.min(ur,Bn[1]),$n=Math.max($n,Bn[0]),Yn=Math.max(Yn,Bn[1]);$n>=wt.x&&ir<=Ot.x&&Yn>=wt.y&&ur<=Ot.y&&(qn=[Pn.map(Bn=>new a.P(Bn[0],Bn[1]))],(ir<wt.x||$n>Ot.x||ur<wt.y||Yn>Ot.y)&&(qn=a.bM(qn,wt.x,wt.y,Ot.x,Ot.y)))}for(const ir of qn){zt.reset(ir,.25*Dt);let $n=0;$n=zt.length<=.5*Dt?1:Math.ceil(zt.paddedLength/Sn)+1;for(let ur=0;ur<$n;ur++){const Yn=ur/Math.max($n-1,1),Bn=zt.lerp(Yn),Tr=Bn.x+Vn,ei=Bn.y+Vn;fe.push(Tr,ei,Dt,0);const ar=Tr-Dt,Er=ei-Dt,Fr=Tr+Dt,Ur=ei+Dt;if(ct=ct&&this.isOffscreen(ar,Er,Fr,Ur),Et=Et||this.isInsideGrid(ar,Er,Fr,Ur),!u&&this.grid.hitTestCircle(Tr,ei,Dt,X)&&(Ke=!0,!H))return{circles:[],offscreen:!1,collisionDetected:Ke,occluded:!1}}}}return{circles:!H&&Ke||!Et?[]:fe,offscreen:ct,collisionDetected:Ke,occluded:Fe.occluded}}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let y=1/0,S=1/0,A=-1/0,M=-1/0;for(const H of s){const K=new a.P(H.x+Vn,H.y+Vn);y=Math.min(y,K.x),S=Math.min(S,K.y),A=Math.max(A,K.x),M=Math.max(M,K.y),u.push(K)}const D=this.grid.query(y,S,A,M).concat(this.ignoredGrid.query(y,S,A,M)),z={},U={};for(const H of D){const K=H.key;if(z[K.bucketInstanceId]===void 0&&(z[K.bucketInstanceId]={}),z[K.bucketInstanceId][K.featureIndex])continue;const X=[new a.P(H.x1,H.y1),new a.P(H.x2,H.y1),new a.P(H.x2,H.y2),new a.P(H.x1,H.y2)];a.bN(u,X)&&(z[K.bucketInstanceId][K.featureIndex]=!0,U[K.bucketInstanceId]===void 0&&(U[K.bucketInstanceId]=[]),U[K.bucketInstanceId].push(K.featureIndex))}return U}insertCollisionBox(s,u,y,S,A){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:S,collisionGroupID:A},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,u,y,S,A){const M=u?this.ignoredGrid:this.grid,D={bucketInstanceId:y,featureIndex:S,collisionGroupID:A};for(let z=0;z<s.length;z+=4)M.insertCircle(D,s[z],s[z+1],s[z+2])}projectAndGetPerspectiveRatio(s,u,y,S,A,M,D){const z=[u,y,S,1];let U=!1;S||this.transform.pitch>0?(a.aA(z,z,s),this.fogState&&A&&D.name!=="globe"&&(U=function(X,J,de,ce,fe,ue){const ve=ue.calculateFogTileMatrix(fe),Ee=[J,de,ce];return a.ad(Ee,Ee,ve),nn(X,a.ae(Ee),ue.pitch,ue._fov)}(this.fogState,u,y,S,A.toUnwrapped(),this.transform)>.9)):Ry(z,z,s);const H=z[3];return{point:new a.P((z[0]/H+1)/2*this.transform.width+Vn,(-z[1]/H+1)/2*this.transform.height+Vn),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(D)/H*.5,1.5),signedDistanceFromCamera:H,occluded:M&&z[2]>H||U}}isOffscreen(s,u,y,S){return y<Vn||s>=this.screenRightBoundary||S<Vn||u>this.screenBottomBoundary}isInsideGrid(s,u,y,S){return y>=0&&s<this.gridRightBoundary&&S>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const s=a.bx([]);return a.bo(s,s,[-100,-100,0]),s}}function Zm(x,s,u){const y=s.createTileMatrix(x,x.worldSize,u.toUnwrapped());return a.az(new Float32Array(16),x.projMatrix,y)}function xp(x,s,u){if(s.projection.name===u.projection.name)return x.projMatrix;const y=u.clone();return y.setProjection(s.projection),Zm(y,s.getProjection(),x)}function yp(x,s,u){return s.name===u.projection.name?x.projMatrix:Zm(u,s,x)}class Sl{constructor(s,u,y,S){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?u:-u))):S&&y?1:0,this.placed=y}isHidden(){return this.opacity===0&&!this.placed}}class Jd{constructor(s,u,y,S,A,M=!1){this.text=new Sl(s?s.text:null,u,y,A),this.icon=new Sl(s?s.icon:null,u,S,A),this.clipped=M}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class qu{constructor(s,u,y,S=!1){this.text=s,this.icon=u,this.skipFade=y,this.clipped=S}}class kn{constructor(){this.invProjMatrix=a.bz(),this.viewportMatrix=a.bz(),this.circles=[]}}class vi{constructor(s,u,y,S,A){this.bucketInstanceId=s,this.featureIndex=u,this.sourceLayerIndex=y,this.bucketIndex=S,this.tileID=A}}class ai{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const u=++this.maxGroupID;this.collisionGroups[s]={ID:u,predicate:y=>y.collisionGroupID===u}}return this.collisionGroups[s]}}function go(x,s,u,y,S){const{horizontalAlign:A,verticalAlign:M}=a.bV(x),D=-(A-.5)*s,z=-(M-.5)*u,U=a.bU(x,y);return new a.P(D+U[0]*S,z+U[1]*S)}function tu(x,s,u,y,S){const A=new a.P(x,s);return u&&A._rotate(y?S:-S),A}class ii{constructor(s,u,y,S,A,M){this.transform=s.clone(),this.projection=s.projection.name,this.collisionIndex=new zy(this.transform,A),this.buildingIndex=M,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new ai(y),this.collisionCircleArrays={},this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,u,y,S,A=1){const M=y.getBucket(u),D=y.latestFeatureIndex;if(!M||!D||u.fqid!==M.layerIds[0])return;const z=M.layers[0].layout,U=M.layers[0].paint,H=y.collisionBoxArray,K=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),X=y.tileSize/a.aj,J=y.tileID.toUnwrapped();this.transform.setProjection(M.projection);const de=(ce=y.tileID,fe=M.getProjection(),ue=this.transform,fe.name===this.projection?ue.calculateProjMatrix(ce.toUnwrapped()):Zm(ue,fe,ce));var ce,fe,ue;const ve=z.get("text-pitch-alignment")==="map",Ee=z.get("text-rotation-alignment")==="map";u.compileFilter(u.options);const Pe=u.dynamicFilter(),ze=u.dynamicFilterNeedsFeature(),Ie=this.transform.calculatePixelsToTileUnitsMatrix(y),Oe=Zd(de,y.tileID.canonical,ve,Ee,this.transform,M.getProjection(),Ie);let Ce=null;if(ve){const lt=Xd(de,y.tileID.canonical,ve,Ee,this.transform,M.getProjection(),Ie);Ce=a.az([],this.transform.labelPlaneMatrix,lt)}let Fe=null;Pe&&y.latestFeatureIndex&&(Fe={unwrappedTileID:J,dynamicFilter:Pe,dynamicFilterNeedsFeature:ze}),this.retainedQueryData[M.bucketInstanceId]=new vi(M.bucketInstanceId,D,M.sourceLayerIndex,M.index,y.tileID);const[$e,st]=M.layers[0].layout.get("text-size-scale-range"),et=a.aD(A,$e,st),[_t,xt]=z.get("icon-size-scale-range"),Bt=a.aD(A,_t,xt),Je={bucket:M,layout:z,paint:U,posMatrix:de,textLabelPlaneMatrix:Oe,labelToScreenMatrix:Ce,clippingData:Fe,scale:K,textPixelRatio:X,holdingForFade:y.holdingForFade(),collisionBoxArray:H,partiallyEvaluatedTextSize:a.bH(M.textSizeData,this.transform.zoom,et),partiallyEvaluatedIconSize:a.bH(M.iconSizeData,this.transform.zoom,Bt),collisionGroup:this.collisionGroups.get(M.sourceID),latestFeatureIndex:y.latestFeatureIndex};if(S)for(const lt of M.sortKeyRanges){const{sortKey:Ke,symbolInstanceStart:Et,symbolInstanceEnd:ct}=lt;s.push({sortKey:Ke,symbolInstanceStart:Et,symbolInstanceEnd:ct,parameters:Je})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:M.symbolInstances.length,parameters:Je})}attemptAnchorPlacement(s,u,y,S,A,M,D,z,U,H,K,X,J,de,ce,fe,ue,ve){const{textOffset0:Ee,textOffset1:Pe,crossTileID:ze}=X,Ie=[Ee,Pe],Oe=go(s,y,S,Ie,A),Ce=this.collisionIndex.placeCollisionBox(de,A,u,tu(Oe.x,Oe.y,M,D,this.transform.angle),K,z,U,H.predicate);if(fe){const Fe=de.getSymbolInstanceIconSize(ve,this.transform.zoom,X.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(de,Fe,fe,tu(Oe.x,Oe.y,M,D,this.transform.angle),K,z,U,H.predicate).box.length===0)return}if(Ce.box.length>0){let Fe;return this.prevPlacement&&this.prevPlacement.variableOffsets[ze]&&this.prevPlacement.placements[ze]&&this.prevPlacement.placements[ze].text&&(Fe=this.prevPlacement.variableOffsets[ze].anchor),this.variableOffsets[ze]={textOffset:Ie,width:y,height:S,anchor:s,textScale:A,prevAnchor:Fe},this.markUsedJustification(de,s,X,ce),de.allowVerticalPlacement&&(this.markUsedOrientation(de,ce,X),this.placedOrientations[ze]=ce),{shift:Oe,placedGlyphBoxes:Ce}}}placeLayerBucketPart(s,u,y,S,A=1){const{bucket:M,layout:D,paint:z,posMatrix:U,textLabelPlaneMatrix:H,labelToScreenMatrix:K,clippingData:X,textPixelRatio:J,holdingForFade:de,collisionBoxArray:ce,partiallyEvaluatedTextSize:fe,partiallyEvaluatedIconSize:ue,collisionGroup:ve,latestFeatureIndex:Ee}=s.parameters,Pe=D.get("text-optional"),ze=D.get("icon-optional"),Ie=D.get("text-allow-overlap"),Oe=D.get("icon-allow-overlap"),Ce=D.get("text-rotation-alignment")==="map",Fe=D.get("text-pitch-alignment")==="map",$e=z.get("symbol-z-offset"),st=D.get("symbol-elevation-reference")==="sea",[et,_t]=D.get("text-size-scale-range"),[xt,Bt]=D.get("icon-size-scale-range"),Je=a.aD(A,et,_t),lt=a.aD(A,xt,Bt);this.transform.setProjection(M.projection);let Ke=Ie&&(Oe||!M.hasIconData()||ze),Et=Oe&&(Ie||!M.hasTextData()||Pe);const ct=!$e.isConstant();!M.collisionArrays&&ce&&M.deserializeCollisionBoxes(ce),y&&S&&M.updateCollisionDebugBuffers(this.transform.zoom,ce,Je,lt);const Dt=(wt,Ot,zt)=>{const{crossTileID:yn,numVerticalGlyphVertices:Tn}=wt;let gn=null;if(X&&X.dynamicFilterNeedsFeature||ct){const kr=this.retainedQueryData[M.bucketInstanceId];gn=Ee.loadFeature({featureIndex:wt.featureIndex,bucketIndex:kr.bucketIndex,sourceLayerIndex:kr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(X&&!(0,X.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},gn,this.retainedQueryData[M.bucketInstanceId].tileID.canonical,new a.P(wt.tileAnchorX,wt.tileAnchorY),this.transform.calculateDistanceTileData(X.unwrappedTileID)))return this.placements[yn]=new qu(!1,!1,!1,!0),void u.add(yn);const Pn=$e.evaluate(gn,{});if(u.has(yn))return;if(de)return void(this.placements[yn]=new qu(!1,!1,!1));let Sn=!1,qn=!1,ir=!0,$n=!1,ur=!1,Yn=null,Bn={box:null,offscreen:null,occluded:null},Tr={box:null},ei=null,ar=null,Er=null,Fr=0,Ur=0,ti=0;zt.textFeatureIndex?Fr=zt.textFeatureIndex:wt.useRuntimeCollisionCircles&&(Fr=wt.featureIndex),zt.verticalTextFeatureIndex&&(Ur=zt.verticalTextFeatureIndex);const Pi=kr=>{kr.tileID=this.retainedQueryData[M.bucketInstanceId].tileID;const qr=this.transform.elevation;kr.elevation=st?Pn:Pn+(qr?qr.getAtTileOffset(kr.tileID,kr.tileAnchorX,kr.tileAnchorY):0),kr.elevation+=wt.zOffset},ta=zt.textBox;if(ta){Pi(ta);const kr=Hr=>{let Di=a.bI.horizontal;if(M.allowVerticalPlacement&&!Hr&&this.prevPlacement){const za=this.prevPlacement.placedOrientations[yn];za&&(this.placedOrientations[yn]=za,Di=za,this.markUsedOrientation(M,Di,wt))}return Di},qr=(Hr,Di)=>{if(M.allowVerticalPlacement&&Tn>0&&zt.verticalTextBox){for(const za of M.writingModes)if(za===a.bI.vertical?(Bn=Di(),Tr=Bn):Bn=Hr(),Bn&&Bn.box&&Bn.box.length)break}else Bn=Hr()};if(D.get("text-variable-anchor")){let Hr=D.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[yn]){const bi=this.prevPlacement.variableOffsets[yn];Hr.indexOf(bi.anchor)>0&&(Hr=Hr.filter(xa=>xa!==bi.anchor),Hr.unshift(bi.anchor))}const Di=(bi,xa,di)=>{const Sa=M.getSymbolInstanceTextSize(fe,wt,this.transform.zoom,Ot),io=(bi.x2-bi.x1)*Sa+2*bi.padding,Ho=(bi.y2-bi.y1)*Sa+2*bi.padding,ao=wt.hasIconTextFit&&!Oe?xa:null;ao&&Pi(ao);let Go={box:[],offscreen:!1,occluded:!1};const xc=Ie?2*Hr.length:Hr.length;for(let Wo=0;Wo<xc;++Wo){const ul=this.attemptAnchorPlacement(Hr[Wo%Hr.length],bi,io,Ho,Sa,Ce,Fe,J,U,ve,Wo>=Hr.length,wt,Ot,M,di,ao,fe,ue);if(ul&&(Go=ul.placedGlyphBoxes,Go&&Go.box&&Go.box.length)){Sn=!0,Yn=ul.shift;break}}return Go};qr(()=>Di(ta,zt.iconBox,a.bI.horizontal),()=>{const bi=zt.verticalTextBox;return bi&&Pi(bi),M.allowVerticalPlacement&&!(Bn&&Bn.box&&Bn.box.length)&&Tn>0&&bi?Di(bi,zt.verticalIconBox,a.bI.vertical):{box:null,offscreen:null,occluded:null}}),Bn&&(Sn=Bn.box,ir=Bn.offscreen,$n=Bn.occluded);const za=kr(!(!Bn||!Bn.box));if(!Sn&&this.prevPlacement){const bi=this.prevPlacement.variableOffsets[yn];bi&&(this.variableOffsets[yn]=bi,this.markUsedJustification(M,bi.anchor,wt,za))}}else{const Hr=(Di,za)=>{const bi=M.getSymbolInstanceTextSize(fe,wt,this.transform.zoom,Ot,A),xa=this.collisionIndex.placeCollisionBox(M,bi,Di,new a.P(0,0),Ie,J,U,ve.predicate);return xa&&xa.box&&xa.box.length&&(this.markUsedOrientation(M,za,wt),this.placedOrientations[yn]=za),xa};qr(()=>Hr(ta,a.bI.horizontal),()=>{const Di=zt.verticalTextBox;return M.allowVerticalPlacement&&Tn>0&&Di?(Pi(Di),Hr(Di,a.bI.vertical)):{box:null,offscreen:null,occluded:null}}),kr(!!(Bn&&Bn.box&&Bn.box.length))}}if(ei=Bn,Sn=ei&&ei.box&&ei.box.length>0,ir=ei&&ei.offscreen,$n=ei&&ei.occluded,wt.useRuntimeCollisionCircles){const kr=M.text.placedSymbolArray.get(wt.centerJustifiedTextSymbolIndex>=0?wt.centerJustifiedTextSymbolIndex:wt.verticalPlacedTextSymbolIndex),qr=a.bJ(M.textSizeData,fe,kr),Hr=D.get("text-padding");ar=this.collisionIndex.placeCollisionCircles(M,Ie,kr,M.lineVertexArray,M.glyphOffsetArray,qr,U,H,K,y,Fe,ve.predicate,wt.collisionCircleDiameter*qr/a.bO,Hr,this.retainedQueryData[M.bucketInstanceId].tileID),Sn=Ie||ar.circles.length>0&&!ar.collisionDetected,ir=ir&&ar.offscreen,$n=ar.occluded}if(zt.iconFeatureIndex&&(ti=zt.iconFeatureIndex),zt.iconBox){const kr=qr=>{Pi(qr);const Hr=wt.hasIconTextFit&&Yn?tu(Yn.x,Yn.y,Ce,Fe,this.transform.angle):new a.P(0,0),Di=M.getSymbolInstanceIconSize(ue,this.transform.zoom,wt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(M,Di,qr,Hr,Oe,J,U,ve.predicate)};Tr&&Tr.box&&Tr.box.length&&zt.verticalIconBox?(Er=kr(zt.verticalIconBox),qn=Er.box.length>0):(Er=kr(zt.iconBox),qn=Er.box.length>0),ir=ir&&Er.offscreen,ur=Er.occluded}const Ni=Pe||wt.numHorizontalGlyphVertices===0&&Tn===0,rr=ze||wt.numIconVertices===0;if(Ni||rr?rr?Ni||(qn=qn&&Sn):Sn=qn&&Sn:qn=Sn=qn&&Sn,Sn&&ei&&ei.box&&this.collisionIndex.insertCollisionBox(ei.box,D.get("text-ignore-placement"),M.bucketInstanceId,Tr&&Tr.box&&Ur?Ur:Fr,ve.ID),qn&&Er&&this.collisionIndex.insertCollisionBox(Er.box,D.get("icon-ignore-placement"),M.bucketInstanceId,ti,ve.ID),ar&&(Sn&&this.collisionIndex.insertCollisionCircles(ar.circles,D.get("text-ignore-placement"),M.bucketInstanceId,Fr,ve.ID),y)){const kr=M.bucketInstanceId;let qr=this.collisionCircleArrays[kr];qr===void 0&&(qr=this.collisionCircleArrays[kr]=new kn);for(let Hr=0;Hr<ar.circles.length;Hr+=4)qr.circles.push(ar.circles[Hr+0]),qr.circles.push(ar.circles[Hr+1]),qr.circles.push(ar.circles[Hr+2]),qr.circles.push(ar.collisionDetected?1:0)}const _i=M.projection.name!=="globe";Ke=Ke&&(_i||!$n),Et=Et&&(_i||!ur),this.placements[yn]=new qu(Sn||Ke,qn||Et,ir||M.justReloaded),u.add(yn)};if(M.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(M,this.retainedQueryData[M.bucketInstanceId].tileID),M.elevationType==="road"&&M.updateRoadElevation(),M.updateZOffset(),M.sortFeaturesByY){const wt=M.getSortedSymbolIndexes(this.transform.angle);for(let Ot=wt.length-1;Ot>=0;--Ot){const zt=wt[Ot];Dt(M.symbolInstances.get(zt),zt,M.collisionArrays[zt])}M.hasAnyZOffset&&a.w(`${M.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(M.hasAnyZOffset){const wt=M.getSortedIndexesByZOffset();for(let Ot=0;Ot<wt.length;++Ot){const zt=wt[Ot];Dt(M.symbolInstances.get(zt),zt,M.collisionArrays[zt])}}else for(let wt=s.symbolInstanceStart;wt<s.symbolInstanceEnd;wt++)Dt(M.symbolInstances.get(wt),wt,M.collisionArrays[wt]);if(y&&M.bucketInstanceId in this.collisionCircleArrays){const wt=this.collisionCircleArrays[M.bucketInstanceId];a.bi(wt.invProjMatrix,U),wt.viewportMatrix=this.collisionIndex.getViewportMatrix()}M.justReloaded=!1}markUsedJustification(s,u,y,S){const{leftJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:M,rightJustifiedTextSymbolIndex:D,verticalPlacedTextSymbolIndex:z,crossTileID:U}=y,H=a.bT(u),K=S===a.bI.vertical?z:H==="left"?A:H==="center"?M:H==="right"?D:-1;A>=0&&(s.text.placedSymbolArray.get(A).crossTileID=K>=0&&A!==K?0:U),M>=0&&(s.text.placedSymbolArray.get(M).crossTileID=K>=0&&M!==K?0:U),D>=0&&(s.text.placedSymbolArray.get(D).crossTileID=K>=0&&D!==K?0:U),z>=0&&(s.text.placedSymbolArray.get(z).crossTileID=K>=0&&z!==K?0:U)}markUsedOrientation(s,u,y){const S=u===a.bI.horizontal||u===a.bI.horizontalOnly?u:0,A=u===a.bI.vertical?u:0,{leftJustifiedTextSymbolIndex:M,centerJustifiedTextSymbolIndex:D,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:U}=y,H=s.text.placedSymbolArray;M>=0&&(H.get(M).placedOrientation=S),D>=0&&(H.get(D).placedOrientation=S),z>=0&&(H.get(z).placedOrientation=S),U>=0&&(H.get(U).placedOrientation=A)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let y=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const S=u?u.symbolFadeChange(s):1,A=u?u.opacities:{},M=u?u.variableOffsets:{},D=u?u.placedOrientations:{};for(const z in this.placements){const U=this.placements[z],H=A[z];H?(this.opacities[z]=new Jd(H,S,U.text,U.icon,null,U.clipped),y=y||U.text!==H.text.placed||U.icon!==H.icon.placed):(this.opacities[z]=new Jd(null,S,U.text,U.icon,U.skipFade,U.clipped),y=y||U.text||U.icon)}for(const z in A){const U=A[z];if(!this.opacities[z]){const H=new Jd(U,S,!1,!1);H.isHidden()||(this.opacities[z]=H,y=y||U.text.placed||U.icon.placed)}}for(const z in M)this.variableOffsets[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.variableOffsets[z]=M[z]);for(const z in D)this.placedOrientations[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.placedOrientations[z]=D[z]);y?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:s)}updateLayerOpacities(s,u,y,S){const A=new Set;for(const M of u){const D=M.getBucket(s);D&&M.latestFeatureIndex&&s.fqid===D.layerIds[0]&&(this.updateBucketOpacities(D,A,M,M.collisionBoxArray,y,S,M.tileID,s.scope),D.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(D,M.tileID),D.elevationType==="road"&&D.updateRoadElevation(),D.updateZOffset())}}updateBucketOpacities(s,u,y,S,A,M,D,z){s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const U=s.layers[0].layout,H=s.layers[0].paint,K=!!s.layers[0].dynamicFilter(),X=new Jd(null,0,!1,!1,!0),J=U.get("text-allow-overlap"),de=U.get("icon-allow-overlap"),ce=U.get("text-variable-anchor"),fe=U.get("text-rotation-alignment")==="map",ue=U.get("text-pitch-alignment")==="map",ve=H.get("symbol-z-offset"),Ee=U.get("symbol-elevation-reference")==="sea",Pe=!ve.isConstant(),ze=new Jd(null,0,J&&(de||!s.hasIconData()||U.get("icon-optional")),de&&(J||!s.hasTextData()||U.get("text-optional")),!0);!s.collisionArrays&&S&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(S);const Ie=(Ce,Fe,$e)=>{for(let st=0;st<Fe/4;st++)Ce.opacityVertexArray.emplaceBack($e)};let Oe=0;M&&s.updateReplacement(D,M);for(let Ce=0;Ce<s.symbolInstances.length;Ce++){const Fe=s.symbolInstances.get(Ce),{numHorizontalGlyphVertices:$e,numVerticalGlyphVertices:st,crossTileID:et,numIconVertices:_t,tileAnchorX:xt,tileAnchorY:Bt}=Fe;let Je=null;const lt=this.retainedQueryData[s.bucketInstanceId];Pe&&Fe&&lt&&(Je=y.latestFeatureIndex.loadFeature({featureIndex:Fe.featureIndex,bucketIndex:lt.bucketIndex,sourceLayerIndex:lt.sourceLayerIndex,layoutVertexArrayOffset:0}));const Ke=ve.evaluate(Je,{}),Et=u.has(et);let ct=this.opacities[et];Et?ct=X:ct||(ct=ze,this.opacities[et]=ct),u.add(et);const Dt=$e>0||st>0,wt=_t>0,Ot=this.placedOrientations[et],zt=Ot===a.bI.vertical,yn=Ot===a.bI.horizontal||Ot===a.bI.horizontalOnly;!Dt&&!wt||ct.isHidden()||Oe++;let Tn=!1;if((Dt||wt)&&M)for(const gn of s.activeReplacements){if(a.bP(gn,A,a.bQ.Symbol,z)||gn.min.x>xt||xt>gn.max.x||gn.min.y>Bt||Bt>gn.max.y)continue;const Pn=a.bR(xt,Bt,D.canonical,gn.footprintTileId.canonical);if(Tn=a.bS(Pn,gn.footprint),Tn)break}if(Dt){const gn=Tn?Tl:Hu(ct.text);Ie(s.text,$e,zt?Tl:gn),Ie(s.text,st,yn?Tl:gn);const Pn=ct.text.isHidden(),{leftJustifiedTextSymbolIndex:Sn,centerJustifiedTextSymbolIndex:qn,rightJustifiedTextSymbolIndex:ir,verticalPlacedTextSymbolIndex:$n}=Fe,ur=s.text.placedSymbolArray,Yn=Pn||zt?1:0;Sn>=0&&(ur.get(Sn).hidden=Yn),qn>=0&&(ur.get(qn).hidden=Yn),ir>=0&&(ur.get(ir).hidden=Yn),$n>=0&&(ur.get($n).hidden=Pn||yn?1:0);const Bn=this.variableOffsets[et];Bn&&this.markUsedJustification(s,Bn.anchor,Fe,Ot);const Tr=this.placedOrientations[et];Tr&&(this.markUsedJustification(s,"left",Fe,Tr),this.markUsedOrientation(s,Tr,Fe))}if(wt){const gn=Tn?Tl:Hu(ct.icon),{placedIconSymbolIndex:Pn,verticalPlacedIconSymbolIndex:Sn}=Fe,qn=s.icon.placedSymbolArray,ir=ct.icon.isHidden()?1:0;Pn>=0&&(Ie(s.icon,_t,zt?Tl:gn),qn.get(Pn).hidden=ir),Sn>=0&&(Ie(s.icon,Fe.numVerticalIconVertices,yn?Tl:gn),qn.get(Sn).hidden=ir)}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const gn=s.collisionArrays[Ce];if(gn){let Pn=new a.P(0,0),Sn=!0;if(gn.textBox||gn.verticalTextBox){if(ce){const ir=this.variableOffsets[et];ir?(Pn=go(ir.anchor,ir.width,ir.height,ir.textOffset,ir.textScale),fe&&Pn._rotate(ue?this.transform.angle:-this.transform.angle)):Sn=!1}K&&(Sn=!ct.clipped),gn.textBox&&eh(s.textCollisionBox.collisionVertexArray,ct.text.placed,!Sn||zt,Ke,Ee,Pn.x,Pn.y),gn.verticalTextBox&&eh(s.textCollisionBox.collisionVertexArray,ct.text.placed,!Sn||yn,Ke,Ee,Pn.x,Pn.y)}const qn=Sn&&!!(!yn&&gn.verticalIconBox);gn.iconBox&&eh(s.iconCollisionBox.collisionVertexArray,ct.icon.placed,qn,Ke,Ee,Fe.hasIconTextFit?Pn.x:0,Fe.hasIconTextFit?Pn.y:0),gn.verticalIconBox&&eh(s.iconCollisionBox.collisionVertexArray,ct.icon.placed,!qn,Ke,Ee,Fe.hasIconTextFit?Pn.x:0,Fe.hasIconTextFit?Pn.y:0)}}}if(s.fullyClipped=Oe===0,s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){const Ce=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=Ce.invProjMatrix,s.placementViewportMatrix=Ce.viewportMatrix,s.collisionCircleArray=Ce.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,u){const y=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*y>s}setStale(){this.stale=!0}}function eh(x,s,u,y,S,A,M){x.emplaceBack(s?1:0,u?1:0,A||0,M||0,y,S?1:0),x.emplaceBack(s?1:0,u?1:0,A||0,M||0,y,S?1:0),x.emplaceBack(s?1:0,u?1:0,A||0,M||0,y,S?1:0),x.emplaceBack(s?1:0,u?1:0,A||0,M||0,y,S?1:0)}const vp=Math.pow(2,25),_p=Math.pow(2,24),Qs=Math.pow(2,17),ka=Math.pow(2,16),B_=Math.pow(2,9),bp=Math.pow(2,8),wx=Math.pow(2,1);function Hu(x){if(x.opacity===0&&!x.placed)return 0;if(x.opacity===1&&x.placed)return 4294967295;const s=x.placed?1:0,u=Math.floor(127*x.opacity);return u*vp+s*_p+u*Qs+s*ka+u*B_+s*bp+u*wx+s}const Tl=0;class Xm{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&s.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(s,u,y,S,A,M){const D=this._bucketParts;for(;this._currentTileIndex<s.length;)if(u.getBucketParts(D,S,s[this._currentTileIndex],this._sortAcrossTiles,M),this._currentTileIndex++,A())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort((z,U)=>z.sortKey-U.sortKey));this._currentPartIndex<D.length;){const z=D[this._currentPartIndex];if(u.placeLayerBucketPart(z,this._seenCrossTileIDs,y,z.symbolInstanceStart===0,M),this._currentPartIndex++,A())return!0}return!1}}class Rs{constructor(s,u,y,S,A,M,D,z,U){this.placement=new ii(s,A,M,D,z,U),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(s,u,y,S,A){const M=a.q.now(),D=()=>{const z=a.q.now()-M;return!this._forceFullPlacement&&z>2};for(;this._currentPlacementIndex>=0;){const z=u[s[this._currentPlacementIndex]],U=this.placement.collisionIndex.transform.zoom;if(z.type==="symbol"&&(!z.minzoom||z.minzoom<=U)&&(!z.maxzoom||z.maxzoom>U)){const H=z,K=H.layout.get("symbol-z-elevate"),X=H.layout.get("symbol-sort-key").constantOr(1)!==void 0,J=H.layout.get("symbol-z-order"),de=J==="viewport-y"||J==="auto"&&!(J!=="viewport-y"&&X),ce=H.layout.get("text-allow-overlap")||H.layout.get("icon-allow-overlap")||H.layout.get("text-ignore-placement")||H.layout.get("icon-ignore-placement"),fe=de&&ce,ue=this._inProgressLayer=this._inProgressLayer||new Xm(H),ve=a.C(z.source,z.scope);if(ue.continuePlacement(K||fe?S[ve]:y[ve],this.placement,this._showCollisionBoxes,z,D,A))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const El=512/a.aj/2;class Js{constructor(s,u,y){this.tileID=s,this.bucketInstanceId=y,this.index=new a.bW(u.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const S=s.canonical.x*a.aj,A=s.canonical.y*a.aj;for(let M=0;M<u.length;M++){const{key:D,crossTileID:z,tileAnchorX:U,tileAnchorY:H}=u.get(M),K=Math.floor((S+U)*El),X=Math.floor((A+H)*El);this.index.add(K,X),this.keys.push(D),this.crossTileIDs.push(z)}this.index.finish()}findMatches(s,u,y){const S=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z),A=El/Math.pow(2,u.canonical.z-this.tileID.canonical.z),M=u.canonical.x*a.aj,D=u.canonical.y*a.aj;for(let z=0;z<s.length;z++){const U=s.get(z);if(U.crossTileID)continue;const{key:H,tileAnchorX:K,tileAnchorY:X}=U,J=Math.floor((M+K)*A),de=Math.floor((D+X)*A),ce=this.index.range(J-S,de-S,J+S,de+S).sort((fe,ue)=>fe-ue);for(const fe of ce){const ue=this.crossTileIDs[fe];if(this.keys[fe]===H&&!y.has(ue)){y.add(ue),U.crossTileID=ue;break}}}}}class Sx{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class th{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const u=Math.round((s-this.lng)/360);if(u!==0)for(const y in this.indexes){const S=this.indexes[y],A={};for(const M in S){const D=S[M];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+u),A[D.tileID.key]=D}this.indexes[y]=A}this.lng=s}addBucket(s,u,y){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let A=0;A<u.symbolInstances.length;A++)u.symbolInstances.get(A).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]=new Set);const S=this.usedCrossTileIDs[s.overscaledZ];for(const A in this.indexes){const M=this.indexes[A];if(Number(A)>s.overscaledZ)for(const D in M){const z=M[D];z.tileID.isChildOf(s)&&z.findMatches(u.symbolInstances,s,S)}else{const D=M[s.scaledTo(Number(A)).key];D&&D.findMatches(u.symbolInstances,s,S)}}for(let A=0;A<u.symbolInstances.length;A++){const M=u.symbolInstances.get(A);M.crossTileID||(M.crossTileID=y.generate(),S.add(M.crossTileID))}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new Js(s,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(s,u){for(const y of u.crossTileIDs)this.usedCrossTileIDs[s].delete(y)}removeStaleBuckets(s){let u=!1;for(const y in this.indexes){const S=this.indexes[y];for(const A in S)s[S[A].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,S[A]),delete S[A],u=!0)}return u}}class pa{constructor(){this.layerIndexes={},this.crossTileIDs=new Sx,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,u,y,S){let A=this.layerIndexes[s.fqid];A===void 0&&(A=this.layerIndexes[s.fqid]=new th);let M=!1;const D={};S.name!=="globe"&&A.handleWrapJump(y);for(const z of u){const U=z.getBucket(s);U&&s.fqid===U.layerIds[0]&&(U.bucketInstanceId||(U.bucketInstanceId=++this.maxBucketInstanceId),A.addBucket(z.tileID,U,this.crossTileIDs)&&(M=!0),D[U.bucketInstanceId]=!0)}return A.removeStaleBuckets(D)&&(M=!0),M}pruneUnusedLayers(s){const u={};s.forEach(y=>{u[y]=!0});for(const y in this.layerIndexes)u[y]||delete this.layerIndexes[y]}}const eo=771;class pr{constructor(s,u,y,S){this.blendFunction=s,this.blendColor=u,this.mask=y,this.blendEquation=S}}pr.Replace=[1,0,1,0],pr.disabled=new pr(pr.Replace,a.am.transparent,[!1,!1,!1,!1]),pr.unblended=new pr(pr.Replace,a.am.transparent,[!0,!0,!0,!0]),pr.alphaBlended=new pr([1,eo,1,eo],a.am.transparent,[!0,!0,!0,!0]),pr.alphaBlendedNonPremultiplied=new pr([770,eo,770,eo],a.am.transparent,[!0,!0,!0,!0]),pr.multiply=new pr([774,0,774,0],a.am.transparent,[!0,!0,!0,!0]);class _n{constructor(s,u,y){this.func=s,this.mask=u,this.range=y}}_n.ReadOnly=!1,_n.ReadWrite=!0,_n.disabled=new _n(519,_n.ReadOnly,[0,1]);const uf=7680;class Kn{constructor(s,u,y,S,A,M){this.test=s,this.ref=u,this.mask=y,this.fail=S,this.depthFail=A,this.pass=M}}Kn.disabled=new Kn({func:519,mask:0},0,0,uf,uf,uf);const tc=1029,Pc=2305;class Jn{constructor(s,u,y){this.enable=s,this.mode=u,this.frontFace=y}}function wp(x,s){const u=a.c1(x,3);a.c3(x,s),a.c7(x,3,u)}function Al(x,s){const u=a.bY([]);return a.bZ(u,u,-s),a.b_(u,u,-x),u}function Tx(x,s){const u=[x[0],x[1],0],y=[s[0],s[1],0];if(a.ae(u)>=1e-15){const M=a.au([],u);a.b$(y,M,a.bE(y,M)),s[0]=y[0],s[1]=y[1]}const S=a.bG([],s,x);if(a.c0(S)<1e-15)return null;const A=Math.atan2(-S[1],S[0]);return Al(Math.atan2(Math.sqrt(x[0]*x[0]+x[1]*x[1]),-x[2]),A)}Jn.disabled=new Jn(!1,tc,Pc),Jn.backCCW=new Jn(!0,tc,Pc),Jn.backCW=new Jn(!0,tc,2304),Jn.frontCW=new Jn(!0,1028,2304),Jn.frontCCW=new Jn(!0,1028,Pc);class df{constructor(s,u){this.position=s,this.orientation=u}get position(){return this._position}set position(s){if(s){const u=s instanceof a.ac?s:new a.ac(s[0],s[1],s[2]);this._renderWorldCopies&&(u.x=a.bX(u.x,0,1)),this._position=u}else this._position=null}lookAtPoint(s,u){if(this.orientation=null,!this.position)return;const y=this.position,S=this._elevation?this._elevation.getAtPointOrZero(a.ac.fromLngLat(s)):0,A=a.ac.fromLngLat(s,S),M=[A.x-y.x,A.y-y.y,A.z-y.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=Tx(M,u)}setPitchBearing(s,u){this.orientation=Al(a.al(s),a.al(-u))}}class ds{constructor(s,u){this._transform=a.bx([]),this.orientation=u,this.position=s}get mercatorPosition(){const s=this.position;return new a.ac(s[0],s[1],s[2])}get position(){const s=a.c1(this._transform,3);return[s[0],s[1],s[2]]}set position(s){var u;s&&a.c7(this._transform,3,[(u=s)[0],u[1],u[2],1])}get orientation(){return this._orientation}set orientation(s){this._orientation=s||a.bY([]),s&&wp(this._transform,this._orientation)}getPitchBearing(){const s=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(s[0]*s[0]+s[1]*s[1]),-s[2])}}setPitchBearing(s,u){this._orientation=Al(s,u),wp(this._transform,this._orientation)}forward(){const s=a.c1(this._transform,2);return[-s[0],-s[1],-s[2]]}up(){const s=a.c1(this._transform,1);return[-s[0],-s[1],-s[2]]}right(){const s=a.c1(this._transform,0);return[s[0],s[1],s[2]]}getCameraToWorld(s,u){const y=new Float64Array(16);return a.bi(y,this.getWorldToCamera(s,u)),y}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(s,u,y){const S=this.position;a.b$(S,S,-s);const A=new Float64Array(16);return a.bn(A,[y,y,y]),a.bo(A,A,S),A[10]*=u,A}getWorldToCamera(s,u){const y=new Float64Array(16),S=new Float64Array(4),A=this.position;return a.c2(S,this._orientation),a.b$(A,A,-s),a.c3(y,S),a.bo(y,y,A),y[1]*=-1,y[5]*=-1,y[9]*=-1,y[13]*=-1,y[8]*=u,y[9]*=u,y[10]*=u,y[11]*=u,y}getCameraToClipPerspective(s,u,y,S){const A=new Float64Array(16);return a.c4(A,s,u,y,S),A}getCameraToClipOrthographic(s,u,y,S,A,M){const D=new Float64Array(16);return a.c5(D,s,u,y,S,A,M),D}getDistanceToElevation(s,u=!1){const y=s===0?0:a.c6(s,u?a.aY(this.position[1]):this.position[1]),S=this.forward();return(y-this.position[2])/S[2]}clone(){return new ds([...this.position],[...this.orientation])}}const zs={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class nh{constructor(s=0,u=0,y=0,S=0){if(isNaN(s)||s<0||isNaN(u)||u<0||isNaN(y)||y<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=u,this.left=y,this.right=S}interpolate(s,u,y){return u.top!=null&&s.top!=null&&(this.top=a.ai(s.top,u.top,y)),u.bottom!=null&&s.bottom!=null&&(this.bottom=a.ai(s.bottom,u.bottom,y)),u.left!=null&&s.left!=null&&(this.left=a.ai(s.left,u.left,y)),u.right!=null&&s.right!=null&&(this.right=a.ai(s.right,u.right,y)),this}getCenter(s,u){const y=a.aD((this.left+s-this.right)/2,0,s),S=a.aD((this.top+u-this.bottom)/2,0,u);return new a.P(y,S)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new nh(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const nu=15;class rh{constructor(s,u,y,S,A,M,D){this.tileSize=512,this._renderWorldCopies=A===void 0||A,this._minZoom=s||0,this._maxZoom=u||22,this._minPitch=y??0,this._maxPitch=S??60,this.setProjection(M),this.setMaxBounds(D),this.width=0,this.height=0,this._center=new a.cd(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new nh,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new ds,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const s=new rh(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return s._elevation=this._elevation,s._centerAltitude=this._centerAltitude,s._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,s.tileSize=this.tileSize,s.mercatorFromTransition=this.mercatorFromTransition,s.width=this.width,s.height=this.height,s.cameraElevationReference=this.cameraElevationReference,s._center=this._center,s._setZoom(this.zoom),s._seaLevelZoom=this._seaLevelZoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._nearZ=this._nearZ,s._farZ=this._farZ,s._averageElevation=this._averageElevation,s._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._camera=this._camera.clone(),s._calcMatrices(),s.freezeTileCoverage=this.freezeTileCoverage,s.frustumCorners=this.frustumCorners,s._allowWorldUnderZoom=this._allowWorldUnderZoom,s}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<nu}get elevation(){return this._elevation}set elevation(s){this._elevation!==s&&(this._elevation=s,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(s,u=!1){const y=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||y)&&this._updateCameraOnTerrain(),(s||y)&&this._constrainCamera(u),this._calcMatrices()}getProjection(){return a.aF(this.projection,["name","center","parallels"])}setProjection(s){this.projectionOptions=s||{name:"mercator"};const u=this.projection?this.getProjection():void 0;this.projection=a.ce(this.projectionOptions);const y=this.getProjection(),S=!a.bv(u,y);return S&&this._calcMatrices(),this.mercatorFromTransition=!1,S}setOrthographicProjectionAtLowPitch(s){return this._orthographicProjectionAtLowPitch!==s&&(this._orthographicProjectionAtLowPitch=s,this._calcMatrices(),!0)}setMercatorFromTransition(){const s=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.ce({name:"mercator"});const u=s!==this.projection.name;return u&&this._calcMatrices(),u}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get cameraWorldSize(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.c6(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return a.bX(this.rotation,-180,180)}set bearing(s){this.rotation=s}get rotation(){return-this.angle/Math.PI*180}set rotation(s){const u=-s*Math.PI/180;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=a.cf(),a.cg(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const u=a.aD(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=a.al(s),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const s=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/s)}get averageElevation(){return this._averageElevation}set averageElevation(s){this._averageElevation=s,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(s){const u=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(s){this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(s){this._tileCoverLift!==s&&(this._tileCoverLift=s)}_updateCameraOnTerrain(){const s=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,u=this.elevation&&s===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||s===Number.NEGATIVE_INFINITY&&(!u||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const y=this._elevation;u||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&y.exaggeration()&&this._centerAltitudeValidForExaggeration!==y.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*y.exaggeration(),this._centerAltitudeValidForExaggeration=y.exaggeration()):(this._centerAltitude=s||0,this._centerAltitudeValidForExaggeration=y.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const s=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],y=this.horizonLineFromTop();let S=0,A=0;for(let M=0;M<u.length;M++){const D=new a.P(u[M][0]*this.width,y+u[M][1]*(this.height-y)),z=s.pointCoordinate(D);if(!z)continue;const U=1/Math.hypot(z[0]-this._camera.position[0],z[1]-this._camera.position[1]);S+=z[3]*U,A+=U}return A===0?NaN:S/A}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const s=this._seaLevelZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),y=this.pixelsPerMeter/this.worldSize*u,S=this._mercatorZfromZoom(s),A=this._mercatorZfromZoom(this._maxZoom),M=Math.max(S-y,A);this._setZoom(this._zoomFromMercatorZ(M))}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}computeZoomRelativeTo(s){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,s.toAltitude()));let y;y=s.z<this._camera.position[2]?[u.x,u.y,u.z]:[s.x,s.y,s.z];const S=a.ae(a.at([],this._camera.position,y));return a.aD(this._zoomFromMercatorZ(S),this._minZoom,this._maxZoom)}setFreeCameraOptions(s){if(!this.height||!s.position&&!s.orientation)return;this._updateCameraState();let u=!1;if(s.orientation&&!a.ch(s.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(s.orientation)),s.position){const y=[s.position.x,s.position.y,s.position.z];a.ci(y,this._camera.position)||(this._setCameraPosition(y),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const s=this._camera.position,u=new df;return u.position=new a.ac(s[0],s[1],s[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(s){if(!a.cj(s))return!1;a.ck(s,s);const u=a.cl([],[0,0,-1],s),y=a.cl([],[0,-1,0],s);if(y[2]<0)return!1;const S=Tx(u,y);return!!S&&(this._camera.orientation=S,!0)}_setCameraPosition(s){const u=this.zoomScale(this.minZoom)*this.tileSize,y=this.zoomScale(this.maxZoom)*this.tileSize,S=this.cameraToCenterDistance;s[2]=a.aD(s[2],S/y,S/u),this._camera.position=s}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,u,y){this._unmodified=!1,this._edgeInsets.interpolate(s,u,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const u=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(s){const u=[new a.cm(0,s)];if(this.renderWorldCopies){const y=this.pointCoordinate(new a.P(0,0)),S=this.pointCoordinate(new a.P(this.width,0)),A=this.pointCoordinate(new a.P(this.width,this.height)),M=this.pointCoordinate(new a.P(0,this.height)),D=Math.floor(Math.min(y.x,S.x,A.x,M.x)),z=Math.floor(Math.max(y.x,S.x,A.x,M.x)),U=1;for(let H=D-U;H<=z+U;H++)H!==0&&u.push(new a.cm(H,s))}return u}isLODDisabled(s){return(!s||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(s,u,y){let S=[];const A=y!=null,M=!A;if(M&&this.zoom<u||A&&y[0]===0&&y[1]===0)return S;const D=new Set,z=(H,K,X,J,de)=>{const ce=a.cK(K,H,X,J,de);D.has(ce)||(S.push(new a.aM(H,K,X,J,de)),D.add(ce))};for(let H=0;H<s.length;H++){const K=s[H];if(M&&K.canonical.z!==u)continue;const X=K.canonical,J=K.overscaledZ,de=K.wrap,ce=1<<X.z,fe=X.x+1<ce,ue=X.x>0,ve=X.y+1<ce,Ee=X.y>0,Pe=K.wrap-(ue?0:1),ze=K.wrap+(fe?0:1),Ie=ue?X.x-1:ce-1,Oe=fe?X.x+1:0;if(A)y[0]<0?(z(J,ze,X.z,Oe,X.y),y[1]<0&&ve&&(z(J,de,X.z,X.x,X.y+1),z(J,ze,X.z,Oe,X.y+1)),y[1]>0&&Ee&&(z(J,de,X.z,X.x,X.y-1),z(J,ze,X.z,Oe,X.y-1))):y[0]>0?(z(J,Pe,X.z,Ie,X.y),y[1]<0&&ve&&(z(J,de,X.z,X.x,X.y+1),z(J,Pe,X.z,Ie,X.y+1)),y[1]>0&&Ee&&(z(J,de,X.z,X.x,X.y-1),z(J,Pe,X.z,Ie,X.y-1))):y[1]<0&&ve?z(J,de,X.z,X.x,X.y+1):Ee&&z(J,de,X.z,X.x,X.y-1);else{const Ce=K.visibleQuadrants;1&Ce&&(z(J,Pe,X.z,Ie,X.y),Ee&&(z(J,de,X.z,X.x,X.y-1),z(J,Pe,X.z,Ie,X.y-1))),2&Ce&&(z(J,ze,X.z,Oe,X.y),Ee&&(z(J,de,X.z,X.x,X.y-1),z(J,ze,X.z,Oe,X.y-1))),4&Ce&&(z(J,Pe,X.z,Ie,X.y),ve&&(z(J,de,X.z,X.x,X.y+1),z(J,Pe,X.z,Ie,X.y+1))),8&Ce&&(z(J,ze,X.z,Oe,X.y),ve&&(z(J,de,X.z,X.x,X.y+1),z(J,ze,X.z,Oe,X.y+1)))}}const U=[];for(const H of S)S.some(K=>H.isChildOf(K))||U.push(H);if(S=U.filter(H=>!s.some(K=>!!(H.overscaledZ<u&&K.isChildOf(H))||H.equals(K)||H.isChildOf(K))),M){const H=1<<u,K=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),X=[H*K.x,H*K.y],J=4,de=J*J;S=S.filter(ce=>{const fe=ce.canonical.x+.5-X[0],ue=ce.canonical.y+.5-X[1];return fe*fe+ue*ue<de})}return S}coveringTiles(s){let u=this.coveringZoomLevel(s);const y=u,S=this.elevation&&this.elevation.exaggeration(),A=S&&!s.isTerrainDEM,M=this.projection.name==="mercator";if(s.minzoom!==void 0&&u<s.minzoom)return[];s.maxzoom!==void 0&&u>s.maxzoom&&(u=s.maxzoom);const D=this.locationCoordinate(this.center),z=this.center.lat,U=1<<u,H=[U*D.x,U*D.y,0],K=this.projection.name==="globe",X=!K,J=a.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,X),de=K?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ce=U*a.c6(1,this.center.lat),fe=this._camera.position[2]/a.c6(1,this.center.lat),ue=[U*de.x,U*de.y,fe*(X?1:ce)],ve=K||S,Ee=this.cameraToCenterDistance/s.tileSize*(s.roundZoom?1:.502),Pe=this.isLODDisabled(!0)?u:0;let ze;if(this._elevation&&s.isTerrainDEM)ze=1e4*this._elevation.exaggeration();else if(this._elevation){const Ke=this._elevation.getMinMaxForVisibleTiles();ze=Ke?Ke.max:this._centerAltitude}else ze=this._centerAltitude;const Ie=s.isTerrainDEM?-ze:this._elevation?this._elevation.getMinElevationBelowMSL():0,Oe=this.projection.isReprojectedInTileSpace?a.co(this):1,Ce=Ke=>{const ct=new a.ac(Ke.x+25e-6,Ke.y,Ke.z),Dt=new a.ac(Ke.x,Ke.y+25e-6,Ke.z),wt=Ke.toLngLat(),Ot=ct.toLngLat(),zt=Dt.toLngLat(),yn=this.locationCoordinate(wt),Tn=this.locationCoordinate(Ot),gn=this.locationCoordinate(zt),Pn=Math.hypot(Tn.x-yn.x,Tn.y-yn.y),Sn=Math.hypot(gn.x-yn.x,gn.y-yn.y);return Math.sqrt(Pn*Sn)*Oe/25e-6},Fe=Ke=>{const Et=ze,ct=Ie;return{aabb:a.cr(this,U,0,0,0,Ke,ct,Et,this.projection),zoom:0,x:0,y:0,minZ:ct,maxZ:Et,wrap:Ke,fullyVisible:!1}},$e=[];let st=[];const et=u,_t=s.reparseOverscaled?y:u,xt=(fe-this._centerAltitude)*ce,Bt=Ke=>{if(!this._elevation||!Ke.tileID||!M)return;const Et=this._elevation.getMinMaxForTile(Ke.tileID),ct=Ke.aabb;Et?(ct.min[2]=Et.min,ct.max[2]=Et.max,ct.center[2]=(ct.min[2]+ct.max[2])/2):(Ke.shouldSplit=lt(Ke),Ke.shouldSplit||(ct.min[2]=ct.max[2]=ct.center[2]=this._centerAltitude))},Je=(Ke,Et)=>{if(.707*Et<Ke)return 1;const ct=Et/Ke;return ct/(1.4144271570014144+(Math.pow(1.1,ct-1.4144271570014144+1)-1)/(1.1-1)-1)},lt=Ke=>{if(Ke.zoom<Pe)return!0;if(Ke.zoom===et)return!1;if(Ke.shouldSplit!=null)return Ke.shouldSplit;const Et=Ke.aabb.distanceX(ue),ct=Ke.aabb.distanceY(ue);let Dt=xt,wt=1;if(K){Dt=Ke.aabb.distanceZ(ue);const Sn=Math.pow(2,Ke.zoom),qn=a.aY((Ke.y+1)/Sn),ir=a.aY(Ke.y/Sn),$n=Math.min(Math.max(z,qn),ir),ur=a.cP($n)/a.cP(z);if(wt=$n===z?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,ur/this._mercatorScaleRatio),this.zoom<=a.cL&&Ke.zoom===et-1&&ur>=.9)return!0}else if(A&&(Dt=Ke.aabb.distanceZ(ue)*ce),this.projection.isReprojectedInTileSpace&&y<=5){const Sn=Math.pow(2,Ke.zoom),qn=Ce(new a.ac((Ke.x+.5)/Sn,(Ke.y+.5)/Sn));wt=qn>.85?1:qn}if(!M){const Sn=Math.sqrt(Et*Et+ct*ct+Dt*Dt);let qn=(1<<et-Ke.zoom)*Ee*wt;return qn*=Je(Math.max(Dt,xt),Sn),Sn<qn}let Ot=Number.MAX_VALUE,zt=0;const yn=Ke.aabb.getCorners(),Tn=[];for(const Sn of yn){a.at(Tn,Sn,ue),K||(A?Tn[2]*=ce:Tn[2]=xt);const qn=a.bE(Tn,this._camera.forward());qn<Ot&&(Ot=qn,zt=Math.abs(Tn[2]))}let gn=(1<<et-Ke.zoom)*Ee*wt;if(gn*=Je(Math.max(zt,xt),Ot),Ot<gn)return!0;const Pn=Ke.aabb.closestPoint(H);return Pn[0]===H[0]&&Pn[1]===H[1]};if(this.renderWorldCopies)for(let Ke=1;Ke<=3;Ke++)$e.push(Fe(-Ke)),$e.push(Fe(Ke));for($e.push(Fe(0));$e.length>0;){const Ke=$e.pop(),Et=Ke.x,ct=Ke.y;let Dt=Ke.fullyVisible;const wt=()=>this.projection.name==="globe"&&(Ke.y===0||Ke.y===(1<<Ke.zoom)-1);if(!Dt){let Ot=ve?Ke.aabb.intersects(J):Ke.aabb.intersectsFlat(J);if(Ot===0&&wt()){const zt=new a.cp(Ke.zoom,Et,ct);Ot=a.cq(this,U,zt,!0).intersects(J)}if(Ot===0)continue;Dt=Ot===2}if(Ke.zoom!==et&&lt(Ke))for(let Ot=0;Ot<4;Ot++){const zt=(Et<<1)+Ot%2,yn=(ct<<1)+(Ot>>1),Tn={aabb:M?Ke.aabb.quadrant(Ot):a.cr(this,U,Ke.zoom+1,zt,yn,Ke.wrap,Ke.minZ,Ke.maxZ,this.projection),zoom:Ke.zoom+1,x:zt,y:yn,wrap:Ke.wrap,fullyVisible:Dt,tileID:void 0,shouldSplit:void 0,minZ:Ke.minZ,maxZ:Ke.maxZ};A&&!K&&(Tn.tileID=new a.aM(Ke.zoom+1===et?_t:Ke.zoom+1,Ke.wrap,Ke.zoom+1,zt,yn),Bt(Tn)),$e.push(Tn)}else{const Ot=Ke.zoom===et?_t:Ke.zoom;if(s.minzoom&&s.minzoom>Ot)continue;let zt=0;if(!Dt){let Pn=ve?Ke.aabb.intersectsPrecise(J):Ke.aabb.intersectsPreciseFlat(J);if(Pn===0&&wt()){const Sn=new a.cp(Ke.zoom,Et,ct);Pn=a.cq(this,U,Sn,!0).intersectsPrecise(J)}if(Pn===0)continue;if(s.calculateQuadrantVisibility)if(J.containsPoint(Ke.aabb.center))zt=15;else for(let Sn=0;Sn<4;Sn++)Ke.aabb.quadrant(Sn).intersects(J)!==0&&(zt|=1<<Sn)}const yn=H[0]-(.5+Et+(Ke.wrap<<Ke.zoom))*(1<<u-Ke.zoom),Tn=H[1]-.5-ct,gn=Ke.tileID?Ke.tileID:new a.aM(Ot,Ke.wrap,Ke.zoom,Et,ct);s.calculateQuadrantVisibility&&(gn.visibleQuadrants=zt),st.push({tileID:gn,distanceSq:yn*yn+Tn*Tn})}}if(this.fogCullDistSq){const Ke=this.fogCullDistSq,Et=this.horizonLineFromTop();st=st.filter(ct=>{const Dt=[0,0,0,1],wt=[a.aj,a.aj,0,1],Ot=this.calculateFogTileMatrix(ct.tileID.toUnwrapped());a.aA(Dt,Dt,Ot),a.aA(wt,wt,Ot);const zt=a.cs([],Dt,wt),yn=a.ct([],Dt,wt),Tn=a.cM(zt,yn);if(Tn===0)return!0;let gn=!1;const Pn=this._elevation;if(Pn&&Tn>Ke&&Et!==0){const Sn=this.calculateProjMatrix(ct.tileID.toUnwrapped());let qn;s.isTerrainDEM||(qn=Pn.getMinMaxForTile(ct.tileID)),qn||(qn={min:Ie,max:ze});const ir=a.cu(this.rotation),$n=[ir[0]*a.aj,ir[1]*a.aj,qn.max];a.ad($n,$n,Sn),gn=(1-$n[1])*this.height*.5<Et}return Tn<Ke||gn})}return st.sort((Ke,Et)=>Ke.distanceSq-Et.distanceSq).map(Ke=>Ke.tileID)}resize(s,u){this.width=s,this.height=u,this.pixelsToGLUnits=[2/s,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){const u=a.aD(s.lat,-a.cv,a.cv),y=this.projection.project(s.lng,u);return new a.P(y.x*this.worldSize,y.y*this.worldSize)}unproject(s){return this.projection.unproject(s.x/this.worldSize,s.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.c6(1,this.center.lat)/this.worldSize}setLocationAtPoint(s,u){let y,S;const A=this.centerPoint;if(this.projection.name==="globe"){const D=this.worldSize;y=(u.x-A.x)/D,S=(u.y-A.y)/D}else{const D=this.pointCoordinate(u),z=this.pointCoordinate(A);y=D.x-z.x,S=D.y-z.y}const M=this.locationCoordinate(s);this.setLocation(new a.ac(M.x-y,M.y-S))}setLocation(s){this.center=this.coordinateLocation(s),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(s,u){return this.projection.locationPoint(this,s,u)}locationPoint3D(s,u){return this.projection.locationPoint(this,s,u,!0)}pointLocation(s){return this.coordinateLocation(this.pointCoordinate(s))}pointLocation3D(s,u){return this.coordinateLocation(this.pointCoordinate3D(s,u))}locationCoordinate(s,u){const y=u?a.c6(u,s.lat):void 0,S=this.projection.project(s.lng,s.lat);return new a.ac(S.x,S.y,y)}coordinateLocation(s){return this.projection.unproject(s.x,s.y)}pointRayIntersection(s,u){const y=u??this._centerAltitude,S=[s.x,s.y,0,1],A=[s.x,s.y,1,1];a.aA(S,S,this.pixelMatrixInverse),a.aA(A,A,this.pixelMatrixInverse);const M=A[3];a.cw(S,S,1/S[3]),a.cw(A,A,1/M);const D=S[2],z=A[2];return{p0:S,p1:A,t:D===z?0:(y-D)/(z-D)}}screenPointToMercatorRay(s){const u=[s.x,s.y,0,1],y=[s.x,s.y,1,1];return a.aA(u,u,this.pixelMatrixInverse),a.aA(y,y,this.pixelMatrixInverse),a.cw(u,u,1/u[3]),a.cw(y,y,1/y[3]),u[2]=a.c6(u[2],this._center.lat)*this.worldSize,y[2]=a.c6(y[2],this._center.lat)*this.worldSize,a.cw(u,u,1/this.worldSize),a.cw(y,y,1/this.worldSize),new a.av([u[0],u[1],u[2]],a.au([],a.at([],y,u)))}rayIntersectionCoordinate(s){const{p0:u,p1:y,t:S}=s,A=a.c6(u[2],this._center.lat),M=a.c6(y[2],this._center.lat);return new a.ac(a.ai(u[0],y[0],S)/this.worldSize,a.ai(u[1],y[1],S)/this.worldSize,a.ai(A,M,S))}pointCoordinate(s,u=this._centerAltitude){return this.projection.pointCoordinate(this,s.x,s.y,u)}pointCoordinate3D(s,u){if(!this.elevation)return this.pointCoordinate(s,u);let y=this.projection.pointCoordinate3D(this,s.x,s.y);if(y)return new a.ac(y[0],y[1],y[2]);let S=0,A=this.horizonLineFromTop();if(s.y>A)return this.pointCoordinate(s,u);const M=.02*A,D=s.clone();for(let z=0;z<10&&A-S>M;z++){D.y=a.ai(S,A,.66);const U=this.projection.pointCoordinate3D(this,D.x,D.y);U?(A=D.y,y=U):S=D.y}return y?new a.ac(y[0],y[1],y[2]):this.pointCoordinate(s)}isPointAboveHorizon(s){return this.projection.isPointAboveHorizon(this,s)}isPointOnSurface(s){if(s.y<0||s.y>this.height||s.x<0||s.x>this.width)return!1;if(this.elevation||this.zoom>=a.cx)return!this.isPointAboveHorizon(s);const u=this.pointCoordinate(s);return u.y>=0&&u.y<=1}_coordinatePoint(s,u){const y=u&&this.elevation?this.elevation.getAtPointOrZero(s,this._centerAltitude):this._centerAltitude,S=[s.x*this.worldSize,s.y*this.worldSize,y+s.toAltitude(),1];return a.aA(S,S,this.pixelMatrix),S[3]>0?new a.P(S[0]/S[3],S[1]/S[3]):new a.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:s,left:u}=this._edgeInsets,y=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,A=this.pointLocation3D(new a.P(u,s)),M=this.pointLocation3D(new a.P(S,s)),D=this.pointLocation3D(new a.P(S,y)),z=this.pointLocation3D(new a.P(u,y));let U=Math.min(A.lng,M.lng,D.lng,z.lng),H=Math.max(A.lng,M.lng,D.lng,z.lng),K=Math.min(A.lat,M.lat,D.lat,z.lat),X=Math.max(A.lat,M.lat,D.lat,z.lat);const J=Math.pow(2,-this.zoom)/16*270,de=this.projection.name==="globe"?1:4,ce=(fe,ue,ve,Ee,Pe)=>{const ze=(fe+ve)/2,Ie=(ue+Ee)/2,Oe=new a.P(ze,Ie),{lng:Ce,lat:Fe}=this.pointLocation3D(Oe),$e=Math.max(0,U-Ce,K-Fe,Ce-H,Fe-X);U=Math.min(U,Ce),H=Math.max(H,Ce),K=Math.min(K,Fe),X=Math.max(X,Fe),(Pe<de||$e>J)&&(ce(fe,ue,ze,Ie,Pe+1),ce(ze,Ie,ve,Ee,Pe+1))};if(ce(u,s,S,s,1),ce(S,s,S,y,1),ce(S,y,u,y,1),ce(u,y,u,s,1),this.projection.name==="globe"){const[fe,ue]=a.cy(this);fe?(X=90,H=180,U=-180):ue&&(K=-90,H=180,U=-180)}return new a.aG(new a.cd(U,K),new a.cd(H,X))}_getBoundsRectangular(s,u){const{top:y,left:S}=this._edgeInsets,A=this.height-this._edgeInsets.bottom,M=this.width-this._edgeInsets.right,D=new a.P(S,y),z=new a.P(M,y),U=new a.P(M,A),H=new a.P(S,A);let K=this.pointCoordinate(D,s),X=this.pointCoordinate(z,s);const J=this.pointCoordinate(U,u),de=this.pointCoordinate(H,u),ce=(fe,ue)=>(ue.y-fe.y)/(ue.x-fe.x);return K.y>1&&X.y>=0?K=new a.ac((1-de.y)/ce(de,K)+de.x,1):K.y<0&&X.y<=1&&(K=new a.ac(-de.y/ce(de,K)+de.x,0)),X.y>1&&K.y>=0?X=new a.ac((1-J.y)/ce(J,X)+J.x,1):X.y<0&&K.y<=1&&(X=new a.ac(-J.y/ce(J,X)+J.x,0)),new a.aG().extend(this.coordinateLocation(K)).extend(this.coordinateLocation(X)).extend(this.coordinateLocation(de)).extend(this.coordinateLocation(J))}_getBoundsRectangularTerrain(){const s=this.elevation;if(!s.visibleDemTiles.length||s.isUsingMockSource())return this._getBoundsRectangular(0,0);const u=s.visibleDemTiles.reduce((y,S)=>{if(S.dem){const A=S.dem.tree;y.min=Math.min(y.min,A.minimums[0]),y.max=Math.max(y.max,A.maximums[0])}return y},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(u.min*s.exaggeration(),u.max*s.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(s=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,y=this.height/2-u*(1-this._horizonShift);return s?Math.max(0,y):y}getMaxBounds(){return this.maxBounds}setMaxBounds(s){this.maxBounds=s,this.minLat=-a.cv,this.maxLat=a.cv,this.minLng=-180,this.maxLng=180,s&&(this.minLat=s.getSouth(),this.maxLat=s.getNorth(),this.minLng=s.getWest(),this.maxLng=s.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.ay(this.minLng)*this.tileSize,this.worldMaxX=a.ay(this.maxLng)*this.tileSize,this.worldMinY=a.aH(this.maxLat)*this.tileSize,this.worldMaxY=a.aH(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(s,u){return this.projection.createTileMatrix(this,u,s)}calculateDistanceTileData(s){const u=s.key,y=this._distanceTileDataCache;if(y[u])return y[u];const S=s.canonical,A=1/this.height,M=this.cameraWorldSize,D=M/this.zoomScale(S.z),z=(S.x+Math.pow(2,S.z)*s.wrap)*D,U=S.y*D,H=this.point;H.x*=M/this.worldSize,H.y*=M/this.worldSize;const K=this.angle,X=Math.sin(-K),J=-Math.cos(-K);return y[u]={bearing:[X,J],center:[(H.x-z)*A,(H.y-U)*A],scale:D/a.aj*A},y[u]}calculateFogTileMatrix(s){const u=s.key,y=this._fogTileMatrixCache;if(y[u])return y[u];const S=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,s);return a.az(S,this.worldToFogMatrix,S),y[u]=new Float32Array(S),y[u]}calculateProjMatrix(s,u=!1,y=!1){const S=s.key;let A;if(A=y?this._expandedProjMatrixCache:u?this._alignedProjMatrixCache:this._projMatrixCache,A[S])return A[S];const M=this.calculatePosMatrix(s,this.worldSize);let D;return D=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:y?this.expandedFarZProjMatrix:u?this.alignedProjMatrix:this.projMatrix,a.az(M,D,M),A[S]=new Float32Array(M),A[S]}calculatePixelsToTileUnitsMatrix(s){const u=s.tileID.key,y=this._pixelsToTileUnitsCache;if(y[u])return y[u];const S=a.cz(s,this);return y[u]=S,y[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const s=1/this.worldSize,u=a.bn([],[s,s,s]);return a.az(u,u,this.globeMatrix),u}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const s=this._elevation;this._updateCameraState();const u=a.c6(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(u),S=this._camera.forward(),A=a.c6(1,this._center.lat);y[2]/=A,S[2]/=A,a.au(S,S);const M=s.raycast(y,S,s.exaggeration());if(M){const D=a.bF([],y,S,M),z=new a.ac(D[0],D[1],a.c6(D[2],a.aY(D[1]))),U=(z.z+a.ae([z.x-y[0],z.y-y[1],z.z-y[2]*A]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(U),this._centerAltitude=z.toAltitude(),this._center=this.coordinateLocation(z),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(s=!1){if(!this._elevation)return;const u=this._elevation,y=a.c6(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(y),A=u.getAtPointOrZero(new a.ac(...S)),M=this.pixelsPerMeter/this.worldSize*A,D=this._minimumHeightOverTerrain(),z=S[2]-M;if(z<=D)if(z<0||s){const U=this.locationCoordinate(this._center,this._centerAltitude),H=[S[0],S[1],U.z-S[2]],K=a.ae(H);H[2]-=(D-z)/this._pixelsPerMercatorPixel;const X=a.ae(H);if(X===0)return;a.b$(H,H,K/X*this._pixelsPerMercatorPixel),this._camera.position=[S[0],S[1],U.z*this._pixelsPerMercatorPixel-H[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const s=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||s){const X=this.center;return X.lat=a.aD(X.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!s)&&(X.lng=a.aD(X.lng,this.minLng,this.maxLng)),this.center=X,void(this._constraining=!1)}const u=this._unmodified,{x:y,y:S}=this.point;let A=0,M=y,D=S;const z=this.width/2,U=this.height/2,H=this.worldMinY*this.scale,K=this.worldMaxY*this.scale;if(S-U<H&&(D=H+U),S+U>K&&(D=K-U),K-H<this.height&&(A=Math.max(A,this.height/(K-H)),D=(K+H)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const X=this.worldMinX*this.scale,J=this.worldMaxX*this.scale,de=this.worldSize/2-(X+J)/2;M=(y+de+this.worldSize)%this.worldSize-de,M-z<X&&(M=X+z),M+z>J&&(M=J-z),J-X<this.width&&(A=Math.max(A,this.width/(J-X)),M=(J+X)/2)}M===y&&D===S||this._allowWorldUnderZoom||(this.center=this.unproject(new a.P(M,D))),A&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(A)),this._constrainCamera(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){let s=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(s=Math.max(s,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),s}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const s=this.centerOffset,u=this.projection.name==="globe",y=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=a.c6(1,this.center.lat)/a.c6(1,a.cN));const S=a.cA(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,S),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const A=this.projection.zAxisUnit==="meters"?y:1,M=this._camera.getWorldToCamera(this.worldSize,A);let D;const z=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(z[8]=2*-s.x/this.width,z[9]=2*s.y/this.height,this.isOrthographic){let Fe=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),$e=Fe*this.aspect,st=-$e,et=-Fe;$e-=s.x,st-=s.x,Fe+=s.y,et+=s.y,D=this._camera.getCameraToClipOrthographic(st,$e,et,Fe,this._nearZ,this._farZ),((_t,xt,Bt,Je)=>{for(let lt=0;lt<16;lt++)_t[lt]=a.ai(xt[lt],Bt[lt],Je)})(D,D,z,a.cO(this.pitch>=nu?1:this.pitch/nu))}else D=z;const U=a.cB([],z,M);let H=a.cB([],D,M);if(this.projection.isReprojectedInTileSpace){const Fe=this.locationCoordinate(this.center),$e=a.bx([]);a.bo($e,$e,[Fe.x*this.worldSize,Fe.y*this.worldSize,0]),a.az($e,$e,a.cC(this)),a.bo($e,$e,[-Fe.x*this.worldSize,-Fe.y*this.worldSize,0]),a.az(H,H,$e),a.az(U,U,$e),this.inverseAdjustmentMatrix=a.cD(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=a.cE([],H,[this.worldSize,this.worldSize,this.worldSize/A,1]),this.projMatrix=H,this.invProjMatrix=a.bi(new Float64Array(16),this.projMatrix),u){const Fe=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Fe[8]=2*-s.x/this.width,Fe[9]=2*s.y/this.height,this.expandedFarZProjMatrix=a.cB([],Fe,M)}else this.expandedFarZProjMatrix=this.projMatrix;const K=a.bi([],D);this.frustumCorners=a.cF.fromInvProjectionMatrix(K,this.horizonLineFromTop(),this.height),this.cameraFrustum=a.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!u);const X=new Float32Array(16);a.bx(X),a.cE(X,X,[1,-1,1]),a.cG(X,X,this._pitch),a.by(X,X,this.angle);const J=a.c4(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=a.bw(J);const de=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;J[8]=2*-s.x/this.width,J[9]=2*(s.y+de)/this.height,this.skyboxMatrix=a.az(X,J,X);const ce=this.point,fe=ce.x,ue=ce.y,ve=this.width%2/2,Ee=this.height%2/2,Pe=Math.cos(this.angle),ze=Math.sin(this.angle),Ie=fe-Math.round(fe)+Pe*ve+ze*Ee,Oe=ue-Math.round(ue)+Pe*Ee+ze*ve,Ce=new Float64Array(H);if(a.bo(Ce,Ce,[Ie>.5?Ie-1:Ie,Oe>.5?Oe-1:Oe,0]),this.alignedProjMatrix=Ce,H=a.bz(),a.cE(H,H,[this.width/2,-this.height/2,1]),a.bo(H,H,[1,-1,0]),this.labelPlaneMatrix=H,H=a.bz(),a.cE(H,H,[1,-1,1]),a.bo(H,H,[-1,-1,0]),a.cE(H,H,[2/this.width,2/this.height,1]),this.glCoordMatrix=H,this.pixelMatrix=a.az(new Float64Array(16),this.labelPlaneMatrix,U),this._calcFogMatrices(),this._distanceTileDataCache={},H=a.bi(new Float64Array(16),this.pixelMatrix),!H)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=H,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.cH(this);const Fe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.ad(Fe,Fe,M),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=H;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const s=this.cameraWorldSizeForFog,u=this.cameraPixelsPerMeter,y=this._camera.position,S=1/this.height/this._pixelsPerMercatorPixel,A=[s,s,u];a.b$(A,A,S),a.b$(y,y,-1),a.cI(y,y,A);const M=a.bz();a.bo(M,M,y),a.cE(M,M,A),this.mercatorFogMatrix=M,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(s,u,S)}_computeCameraPosition(s){const u=(s=s||this.pixelsPerMeter)/this.pixelsPerMeter,y=this._camera.forward(),S=this.point,A=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*u-s/this.worldSize*this._centerAltitude;return[S.x/this.worldSize-y[0]*A,S.y/this.worldSize-y[1]*A,s/this.worldSize*this._centerAltitude-y[2]*A]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(s){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),y=this._camera.position[2],S=s[2];let A=1;this.projection.wrap&&(this.center=this.center.wrap()),S>0&&(A=Math.min((u-y)/S,1)),this._camera.position=a.bF([],this._camera.position,s,A),this._updateStateFromCamera()}_updateStateFromCamera(){const s=this._camera.position,u=this._camera.forward(),{pitch:y,bearing:S}=this._camera.getPitchBearing(),A=a.c6(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,M=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.al(this._maxPitch)),D=Math.max((s[2]-A)/Math.cos(y),M),z=this._zoomFromMercatorZ(D);a.bF(s,s,u,D),this._pitch=a.aD(y,a.al(this.minPitch),a.al(this.maxPitch)),this.angle=a.bX(S,-Math.PI,Math.PI),this._setZoom(a.aD(z,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.ac(s[0],s[1],s[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(s){return Math.pow(2,s)*this.tileSize}_mercatorZfromZoom(s){return this.cameraToCenterDistance/this._worldSizeFromZoom(s)}_minimumHeightOverTerrain(){const s=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(s)}_zoomFromMercatorZ(s){return this.scaleZoom(this.cameraToCenterDistance/(s*this.tileSize))}zoomFromMercatorZAdjusted(s){let u=0,y=a.cx,S=0,A=1/0;for(;y-u>1e-6&&y>u;){const M=u+.5*(y-u),D=this.tileSize*Math.pow(2,M),z=this.getCameraToCenterDistance(this.projection,M,D),U=this.scaleZoom(z/(s*this.tileSize)),H=Math.abs(M-U);H<A&&(A=H,S=M),M<U?u=M:y=M}return S}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(s,u){const y=Math.min(s.x,u.x),S=Math.max(s.x,u.x),A=Math.min(s.y,u.y),M=Math.max(s.y,u.y);if(A<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const D=[new a.P(y,A),new a.P(S,M),new a.P(y,M),new a.P(S,A)],z=this.renderWorldCopies?-3:0,U=this.renderWorldCopies?4:1;for(const H of D){const K=this.pointRayIntersection(H);if(K.t<0)return!0;const X=this.rayIntersectionCoordinate(K);if(X.x<z||X.y<0||X.x>U||X.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.cJ(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.P(0,0),new a.P(this.width,this.height))}zoomDeltaToMovement(s,u){const y=a.ae(a.at([],this._camera.position,s)),S=this._zoomFromMercatorZ(y)+u;return y-this._mercatorZfromZoom(S)}getCameraPoint(){if(this.projection.name==="globe"){const s=function([u,y,S],A){const M=[u,y,S,1];a.aA(M,M,A);const D=M[3]=Math.max(M[3],1e-6);return M[0]/=D,M[1]/=D,M[2]/=D,M}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.P(s[0],s[1])}{const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,s))}}getCameraToCenterDistance(s,u=this.zoom,y=this.worldSize){const S=a.cA(s,u,this.width,this.height,1024),A=s.pixelSpaceConversion(this.center.lat,y,S);let M=.5/Math.tan(.5*this._fov)*this.height*A;return this.isOrthographic&&(M=a.ai(1,M,a.cO(this.pitch>=nu?1:this.pitch/nu))),M}getWorldToCameraMatrix(){const s=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&a.az(s,s,this.globeMatrix),s}getFrustum(s){return a.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,this.projection.zAxisUnit==="meters")}}const ih=(x,s)=>{if(s>0&&x.terrain&&a.w("Cutoff is currently disabled on terrain"),s<=0||x.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const u=x.transform,y=Math.max(Math.abs(u._zoom-(x.minCutoffZoom-1)),1),S=u.isLODDisabled(!1)?a.af(60,45,u.pitch):a.af(30,15,u.pitch),A=u._farZ-u._nearZ,M=s*u.height,D=((1-(z=S))*u.cameraToCenterDistance+z*(u._farZ+M))*y;var z;return{shouldRenderCutoff:S<1,uniformValues:{u_cutoff_params:[u._nearZ,u._farZ,(D-u._nearZ)/A,(D-M-u._nearZ)/A]}}},to={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Sp{constructor(s,u){this.aabb=s,this.lastCascade=u}}class Tp{add(s,u){const y=this.receivers[s.key];y!==void 0?(y.aabb.min[0]=Math.min(y.aabb.min[0],u.min[0]),y.aabb.min[1]=Math.min(y.aabb.min[1],u.min[1]),y.aabb.min[2]=Math.min(y.aabb.min[2],u.min[2]),y.aabb.max[0]=Math.max(y.aabb.max[0],u.max[0]),y.aabb.max[1]=Math.max(y.aabb.max[1],u.max[1]),y.aabb.max[2]=Math.max(y.aabb.max[2],u.max[2])):this.receivers[s.key]=new Sp(u,null)}clear(){this.receivers={}}get(s){return this.receivers[s.key]}computeRequiredCascades(s,u,y){const S=a.cV.fromPoints(s.points);let A=0;for(const M in this.receivers){const D=this.receivers[M];if(!D||!S.intersectsAabb(D.aabb))continue;D.aabb.min=S.closestPoint(D.aabb.min),D.aabb.max=S.closestPoint(D.aabb.max);const z=D.aabb.getCorners();for(let U=0;U<y.length;U++){let H=!0;for(const K of z){const X=[K[0]*u,K[1]*u,K[2]];if(a.ad(X,X,y[U].matrix),X[0]<-1||X[0]>1||X[1]<-1||X[1]>1){H=!1;break}}if(D.lastCascade=U,A=Math.max(A,U),H)break}}return A+1}}class nl{constructor(s){this.painter=s,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Tp,this._depthMode=new _n(s.context.gl.LEQUAL,_n.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,s.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),s.tp.registerParameter(to,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),s.tp.registerParameter(to,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),s.tp.registerParameter(to,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),s.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const s of this._cascades)s.texture.destroy(),s.framebuffer.destroy();this._cascades=[]}updateShadowParameters(s,u){const y=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!u||!u.properties)return;const S=u.properties.get("shadow-intensity");if(!u.shadowsEnabled()||S<=0||(this._shadowLayerCount=y.style.order.reduce((de,ce)=>{const fe=y.style._mergedLayers[ce];return de+(fe.hasShadowPass()&&!fe.isHidden(s.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const A=y.context,M=to.shadowMapResolution,D=to.shadowMapResolution;if(this._cascades.length===0||to.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let de=0;de<to.cascadeCount;++de){const ce=y._shadowMapDebug,fe=A.gl,ue=A.createFramebuffer(M,D,ce,"texture"),ve=new a.T(A,{width:M,height:D,data:null},fe.DEPTH_COMPONENT16);if(ue.depthAttachment.set(ve.texture),ce){const Ee=new a.T(A,{width:M,height:D,data:null},fe.RGBA8);ue.colorAttachment.set(Ee.texture)}this._cascades.push({framebuffer:ue,texture:ve,matrix:[],far:0,boundingSphereRadius:0,frustum:new a.cn,scale:0})}}this.shadowDirection=Km(u);let z=0;if(s.elevation){const de=s.elevation,ce=[1e4,-1e4];de.visibleDemTiles.filter(fe=>fe.dem).forEach(fe=>{const ue=fe.dem.tree;ce[0]=Math.min(ce[0],ue.minimums[0]),ce[1]=Math.max(ce[1],ue.maximums[0])}),ce[0]!==1e4&&(z=(ce[1]-ce[0])*de.exaggeration())}const U=1.5*s.cameraToCenterDistance,H=3*U,K=new Float64Array(16);for(let de=0;de<this._cascades.length;++de){const ce=this._cascades[de];let fe=s.height/50,ue=1;to.cascadeCount===1?ue=H:de===0?ue=U:(fe=U,ue=H);const[ve,Ee]=Ym(s,this.shadowDirection,fe,ue,to.shadowMapResolution,z);ce.scale=s.scale,ce.matrix=ve,ce.boundingSphereRadius=Ee,a.bi(K,ce.matrix),ce.frustum=a.cn.fromInvProjectionMatrix(K,1,0,!0),ce.far=ue}const X=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[X].far,this._cascades[X].far],this._uniformValues.u_shadow_intensity=S,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/to.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=to.shadowMapResolution,this._uniformValues.u_shadowmap_0=zs.ShadowMap0,this._uniformValues.u_shadowmap_1=zs.ShadowMap0+1,this._groundShadowTiles=y.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const J=y.transform.elevation;for(const de of this._groundShadowTiles){let ce={min:0,max:0};if(J){const fe=J.getMinMaxForTile(de);fe&&(ce=fe)}this.addShadowReceiver(de.toUnwrapped(),ce.min,ce.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(s){this._enabled=s}drawShadowPass(s,u){if(!this.enabled)return;const y=this.painter,S=y.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(y.transform.getFrustum(0),y.transform.worldSize,this._cascades),S.viewport.set([0,0,to.shadowMapResolution,to.shadowMapResolution]);for(let A=0;A<this._numCascadesToRender;++A){y.currentShadowCascade=A,S.bindFramebuffer.set(this._cascades[A].framebuffer.framebuffer),S.clear({color:a.am.white,depth:1});for(const M of s.order){const D=s._mergedLayers[M];if(!D.hasShadowPass()||D.isHidden(y.transform.zoom))continue;const z=s.getLayerSourceCache(D),U=z?u[z.id]:void 0;(D.type==="model"||U&&U.length)&&y.renderLayer(y,z,D,U)}}y.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const s=this.painter,u=s.style,y=s.context,S=u.directionalLight,A=u.ambientLight;if(!S||!A)return;const M=[],D=ih(s,s.longestCutoffRange);D.shouldRenderCutoff&&M.push("RENDER_CUTOFF"),M.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&M.push("NORMAL_OFFSET");const z=nc(u,S,A),U=new _n(y.gl.LEQUAL,_n.ReadOnly,s.depthRangeFor3D);for(const H of this._groundShadowTiles){const K=H.toUnwrapped(),X=s.isTileAffectedByFog(H),J=s.getOrCreateProgram("groundShadow",{defines:M,overrideFog:X});this.setupShadows(K,J),s.uploadCommonUniforms(y,J,K,null,D);const de={u_matrix:s.transform.calculateProjMatrix(K),u_ground_shadow_factor:z};J.draw(s,y.gl.TRIANGLES,U,Kn.disabled,pr.multiply,Jn.disabled,de,"ground_shadow",s.tileExtentBuffer,s.quadTriangleIndexBuffer,s.tileExtentSegments,null,s.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?pr.unblended:pr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(s){const u=this.painter.transform,y=u.calculatePosMatrix(s,u.worldSize);return a.az(y,this._cascades[this.painter.currentShadowCascade].matrix,y),Float32Array.from(y)}calculateShadowPassMatrixFromMatrix(s){return a.az(s,this._cascades[this.painter.currentShadowCascade].matrix,s),Float32Array.from(s)}setupShadows(s,u,y,S=0){if(!this.enabled)return;const A=this.painter.transform,M=this.painter.context,D=M.gl,z=this._uniformValues,U=new Float64Array(16),H=A.calculatePosMatrix(s,A.worldSize);for(let K=0;K<this._cascades.length;K++)a.az(U,this._cascades[K].matrix,H),z[K===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(U),M.activeTexture.set(D.TEXTURE0+zs.ShadowMap0+K),this._cascades[K].texture.bind(D.NEAREST,D.CLAMP_TO_EDGE);if(this.useNormalOffset=!!y,this.useNormalOffset){const K=a.cT(s.canonical),X=2/A.tileSize*a.aj/to.shadowMapResolution,J=X*this._cascades[0].boundingSphereRadius,de=X*this._cascades[this._cascades.length-1].boundingSphereRadius,ce=(y==="vector-tile"?1:3)/Math.pow(2,S-s.canonical.z-(1-A.zoom+Math.floor(A.zoom)));z.u_shadow_normal_offset=[K,J*ce,de*ce],z.u_shadow_bias=[6e-5,.0012,.012]}else z.u_shadow_bias=[36e-5,.0012,.012];u.setShadowUniformValues(M,z)}setupShadowsFromMatrix(s,u,y=!1){if(!this.enabled)return;const S=this.painter.context,A=S.gl,M=this._uniformValues,D=new Float64Array(16);for(let z=0;z<to.cascadeCount;z++)a.az(D,this._cascades[z].matrix,s),M[z===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(D),S.activeTexture.set(A.TEXTURE0+zs.ShadowMap0+z),this._cascades[z].texture.bind(A.NEAREST,A.CLAMP_TO_EDGE);if(this.useNormalOffset=y,y){const z=to.normalOffset;M.u_shadow_normal_offset=[1,z,z],M.u_shadow_bias=[6e-5,.0012,.012]}else M.u_shadow_bias=[36e-5,.0012,.012];u.setShadowUniformValues(S,M)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(s,u,y,S){if(S[2]>=0)return{};const A=function(z,U,H){const K=H/(1<<z.canonical.z);return new a.cV([z.canonical.x*K+z.wrap*H,z.canonical.y*K+z.wrap*H,0],[(z.canonical.x+1)*K+z.wrap*H,(z.canonical.y+1)*K+z.wrap*H,U])}(s,u,y).getCorners(),M=u/-S[2];S[0]<0?(a.cU(A[0],A[0],[S[0]*M,0,0]),a.cU(A[3],A[3],[S[0]*M,0,0])):S[0]>0&&(a.cU(A[1],A[1],[S[0]*M,0,0]),a.cU(A[2],A[2],[S[0]*M,0,0])),S[1]<0?(a.cU(A[0],A[0],[0,S[1]*M,0]),a.cU(A[1],A[1],[0,S[1]*M,0])):S[1]>0&&(a.cU(A[2],A[2],[0,S[1]*M,0]),a.cU(A[3],A[3],[0,S[1]*M,0]));const D={};return D.vertices=A,D.planes=[rl(A[1],A[0],A[4]),rl(A[2],A[1],A[5]),rl(A[3],A[2],A[6]),rl(A[0],A[3],A[7])],D}addShadowReceiver(s,u,y){this._receivers.add(s,a.cV.fromTileIdAndHeight(s,u,y))}getMaxCascadeForTile(s){const u=this._receivers.get(s);return u&&u.lastCascade?u.lastCascade:0}}function rl(x,s,u){const y=a.at([],u,s),S=a.at([],x,s),A=a.bG([],y,S),M=a.ae(A);return M===0?[0,0,1,0]:(a.b$(A,A,1/M),[A[0],A[1],A[2],-a.bE(A,s)])}function Km(x){const s=x.properties.get("direction"),u=a.cR(s.x,s.y,s.z);u[2]=a.aD(u[2],0,75);const y=a.cW([u[0],u[1],u[2]]);return a.cS(y.x,y.y,y.z)}function nc(x,s,u){const y=s.properties.get("color-use-theme")==="none",S=s.properties.get("color"),A=s.properties.get("intensity"),M=s.properties.get("direction"),D=[M.x,M.y,M.z],z=u.properties.get("color-use-theme")==="none",U=u.properties.get("color"),H=u.properties.get("intensity"),K=Math.max(a.bE([0,0,1],D),0),X=[0,0,0];a.b$(X,U.toRenderColor(z?null:x.getLut(s.scope)).toArray01Linear().slice(0,3),H);const J=[0,0,0];return a.b$(J,S.toRenderColor(y?null:x.getLut(u.scope)).toArray01Linear().slice(0,3),K*A),a.cX([X[0]>0?X[0]/(X[0]+J[0]):0,X[1]>0?X[1]/(X[1]+J[1]):0,X[2]>0?X[2]/(X[2]+J[2]):0])}function Ym(x,s,u,y,S,A){const M=x.zoom,D=x.scale,z=x.worldSize,U=1/z,H=x.aspect,K=Math.sqrt(1+H*H)*Math.tan(.5*x.fovX),X=K*K,J=y-u,de=y+u;let ce,fe;X>J/de?(ce=y,fe=y*K):(ce=.5*de*(1+X),fe=.5*Math.sqrt(J*J+2*(y*y+u*u)*X+de*de*X*X));const ue=x.projection.pixelsPerMeter(x.center.lat,z),ve=x._camera.getCameraToWorldMercator(),Ee=[0,0,-ce*U];a.ad(Ee,Ee,ve);let Pe=fe*U;const ze=x._edgeInsets;if(!(ze.left===0&&ze.top===0&&ze.right===0&&ze.bottom===0||ze.left===ze.right&&ze.top===ze.bottom)){const Dt=x._camera.getWorldToCamera(x.worldSize,x.projection.zAxisUnit==="meters"?ue:1),wt=x._camera.getCameraToClipPerspective(x._fov,x.width/x.height,u,y);wt[8]=2*-x.centerOffset.x/x.width,wt[9]=2*x.centerOffset.y/x.height;const Ot=new Float64Array(16);a.cB(Ot,wt,Dt);const zt=new Float64Array(16);a.bi(zt,Ot);const yn=a.cn.fromInvProjectionMatrix(zt,z,M,!0);for(const Tn of yn.points){const gn=((Ie=Tn)[0]/=D,Ie[1]/=D,Ie[2]=a.c6(Ie[2],x._center.lat),Ie);Pe=Math.max(Pe,a.c0(a.cY([],Ee,gn)))}}var Ie;Pe*=S/(S-1);const Oe=Math.acos(s[2]),Ce=Math.atan2(-s[0],-s[1]),Fe=new ds;Fe.position=Ee,Fe.setPitchBearing(Oe,Ce);const $e=Fe.getWorldToCamera(z,ue),st=Pe*z,et=Math.min(x._mercatorZfromZoom(17)*z*-2,-2*st),_t=Fe.getCameraToClipOrthographic(-st,st,-st,st,et,(st+A*ue)/s[2]),xt=new Float64Array(16);a.az(xt,_t,$e);const Bt=a.cS(Math.floor(1e6*Ee[0])/1e6*z,Math.floor(1e6*Ee[1])/1e6*z,0),Je=.5*S,lt=[0,0,0];a.ad(lt,Bt,xt),a.b$(lt,lt,Je);const Ke=[Math.floor(lt[0]),Math.floor(lt[1]),Math.floor(lt[2])],Et=[0,0,0];a.at(Et,lt,Ke),a.b$(Et,Et,-1/Je);const ct=new Float64Array(16);return a.bx(ct),a.bo(ct,ct,Et),a.az(xt,ct,xt),[xt,st]}class ru extends a.E{constructor(s){super(),this.requestManager=s,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(s,u){return a.aS(this.requestManager.transformRequest(u,a.R.Model).url).then(y=>{if(!y)return;const S=a.aT(y),A=new a.aU(s,void 0,void 0,S);return A.computeBoundsAndApplyParent(),A}).catch(y=>{if(y&&y.status===404)return null;this.fire(new a.z(new Error(`Could not load model ${s} from ${u}: ${y.message}`)))})}load(s,u,y={forceReload:!1}){this.models[u]||(this.models[u]={});const S=Object.keys(s),A=[],M=[];for(const D of S){const z=s[D];this.hasURLBeenRequested(z)&&!y.forceReload||(this.modelByURL[z]={modelId:D,scope:u},A.push(this.loadModel(D,z)),M.push(D)),this.models[u][D]||(this.models[u][D]={model:null,numReferences:1})}this.numModelsLoading[u]=(this.numModelsLoading[u]||0)+M.length,Promise.allSettled(A).then(D=>{for(let z=0;z<D.length;z++){const{status:U}=D[z];if(U==="rejected")continue;const{value:H}=D[z];this.models[u][M[z]]||(this.models[u][M[z]]={model:null,numReferences:1}),this.models[u][M[z]].model=H}this.numModelsLoading[u]-=M.length,this.fire(new a.A("data",{dataType:"style"}))}).catch(D=>{this.fire(new a.z(new Error(`Could not load models: ${D.message}`)))})}isLoaded(){for(const s in this.numModelsLoading)if(this.numModelsLoading[s]>0)return!1;return!0}hasModel(s,u,y={exactIdMatch:!1}){return!!(y.exactIdMatch?this.getModel(s,u):this.getModelByURL(this.modelUris[u][s]))}getModel(s,u){return this.models[u]||(this.models[u]={}),this.models[u][s]?this.models[u][s].model:void 0}getModelByURL(s){if(!s)return null;const u=this.modelByURL[s];return u?this.models[u.scope][u.modelId].model:null}hasModelBeenAdded(s,u){return this.models[u]&&this.models[u][s]!==void 0}getModelURIs(s){return this.modelUris[s]||{}}addModel(s,u,y){this.models[y]||(this.models[y]={}),this.modelUris[y]||(this.modelUris[y]={});const S=this.requestManager.normalizeModelURL(u);if((this.hasModel(s,y,{exactIdMatch:!0})||this.hasModelBeenAdded(s,y))&&this.modelUris[y][s]===S)this.models[y][s].numReferences++;else if(this.hasURLBeenRequested(S)){const{scope:A,modelId:M}=this.modelByURL[S];this.models[A][M].numReferences++}else this.modelUris[y][s]=S,this.load({[s]:this.modelUris[y][s]},y)}addModelURLs(s,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const y=this.modelUris[u];for(const S in s)y[S]=this.requestManager.normalizeModelURL(s[S])}reloadModels(s){this.load(this.modelUris[s],s,{forceReload:!0})}addModelsFromBucket(s,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const y={};for(const S of s)this.hasModel(S,u,{exactIdMatch:!0})||this.hasURLBeenRequested(S)?this.models[u][S].numReferences++:this.modelUris[u][S]&&!this.hasURLBeenRequested(S)?y[S]=this.modelUris[u][S]:!this.hasURLBeenRequested(S)&&a.cZ(S,!1)&&(this.modelUris[u][S]=this.requestManager.normalizeModelURL(S),y[S]=this.modelUris[u][S]);this.load(y,u)}hasURLBeenRequested(s){return this.modelByURL[s]!==void 0}removeModel(s,u,y=!1){if(this.models[u]&&this.models[u][s]&&(this.models[u][s].numReferences--,this.models[u][s].numReferences===0)){const S=this.modelUris[u][s];y||delete this.modelUris[u][s],delete this.modelByURL[S];const A=this.models[u][s].model;if(!A)return;delete this.models[u][s],A.destroy()}}destroy(){for(const s of Object.keys(this.models))for(const u of Object.keys(this.models[s])){const y=this.models[s][u].model;delete this.models[s][u],y&&y.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(s){return this.models[s]||(this.models[s]={}),Object.keys(this.models[s])}upload(s,u){this.models[u]||(this.models[u]={});for(const y in this.models[u])this.models[u][y].model&&this.models[u][y].model.upload(s.context)}}const Ex=new a.a7({data:new a.a8(a.a5.colorTheme.data)}),V_={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function ah(x){return x=x||{},Object.assign(x,V_)}class Qm extends a.E{constructor(s){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},a.aV(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=s,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(s=>{s.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new a.z(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=s.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=s.stylesheet.indoor.buildingFeaturesetId,this._scope=s.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:s=>(s.feature&&s.feature.properties.floorplan&&this.selectFloorplan(s.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(s){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(M,D){const[z,U]=M,{center:H,radius:K}=D,[X,J]=H,de=Math.abs(z-X);return Math.sqrt((de>180?360-de:de)**2+(U-J)**2)<=K}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new a.A("floorplangone")));const u={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},y=new a.P(this._map.transform.width/2,this._map.transform.height/2),S=[new a.P(0,0),new a.P(this._map.transform.width,this._map.transform.height)],A=this._map.queryRenderedFeatures(s?S:y,u);A.length>0&&(this._selectedFloorplan&&A[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=A[0],this._floorplanSelected(!1)))}_floorplanSelected(s){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(A){const[[M,D],[z,U]]=A,H=(z-M+360)%360,K=H>180?360-H:H;return{center:[(M+K/2+360)%360,(D+U)/2],radius:Math.sqrt(K**2+(U-D)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const u=this._floorplanStates[this._indoorData.id].selectedBuilding,y=this._floorplanStates[this._indoorData.id].selectedLevel;let S;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const A of this._indoorData.levels)A.id===this._selectedLevel.id&&(S=A.id);if(this.fire(new a.A("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:S})),u){const A=this._indoorData.buildings.find(M=>M.id===u);this._buildingSelected(A,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(y){const A=this._indoorData.levels.find(M=>M.id===y);this._updateLevels(A,s)}else s&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(s,u){u&&s&&s.extent&&this._map.fitBounds(s.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=s?s.id:void 0;const y=this._indoorData.levels.filter(S=>s.levels.includes(S.id));this.fire(new a.A("buildingselected",{buildingId:s.id,levels:y}))}_levelSelected(s){if(s==="overview")this._updateLevels(void 0,!0);else{const u=this._indoorData.levels.find(y=>y.id===s);this._updateLevels(u,!0)}this.fire(new a.A("levelselected",{levelId:s==="overview"?void 0:s}))}_updateLevels(s,u){if(!s)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(u&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function y(U){const H=U.indexOf("/floor/");if(H===-1)return U;const K=H+7,X=U.indexOf("/",K);return X===-1?U.slice(K):U.slice(K,X)}this._selectedLevel=s,this._floorplanStates[this._indoorData.id].selectedLevel=s?s.id:void 0;const S=[],A={},M={},D={},z={};for(const U of this._indoorData.levels)if(S.push(U.id),A[U.id]=U.height,M[U.id]=U.base,s){if(this.mergeFloors){const H=y(s.id),K=y(U.id);D[U.id]=K===H?"true":"false"}else D[U.id]=U.id===s.id?"true":"false";z[U.id]=U.base<s.base?"true":"false"}else z[U.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",S]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",A]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",M]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",D]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",z]),s&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!s.isUnderground),u&&s.extent)){const U=this._map.cameraForBounds(s.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),H=this._map.getZoom(),K=U.zoom?Math.abs(H-U.zoom):0;this._map.fitBounds(s.extent,K>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:H})}}selectFloorplan(s){const u={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},y=[new a.P(0,0),new a.P(this._map.transform.width,this._map.transform.height)],S=this._map.queryRenderedFeatures(y,u);if(S.length>0){for(const A of S)if(JSON.parse(A.properties["indoor-data"]).floorplanIDs.includes(s)){this._selectedFloorplan=A,this._floorplanSelected(!0);break}}}selectBuilding(s){const u=this._indoorData.buildings.find(y=>y.id===s);this._buildingSelected(u,!0)}selectLevel(s){this._levelSelected(s)}}function Ep(x){if(!x.metadata||!x.metadata.content_area)return;const s=a.q.devicePixelRatio,{left:u,top:y,width:S,height:A}=x.metadata.content_area,M=u*s,D=y*s;return[M,D,M+S*s,D+A*s]}function hf(x){if(x)return x.map(([s,u])=>[s*a.q.devicePixelRatio,u*a.q.devicePixelRatio])}class Ax{constructor(s,u,y){this.id=s,this.scope=u,this.sourceCache=y,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(s){this.missingRequests.has(s.name)||this.pendingRequests.has(s.name)||this.pendingRequests.add(s.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const s=new Map;if(!this.sourceCache.loaded())return s;const u=this.sourceCache.getVisibleCoordinates();if(u.length===0)return s;const y=this.sourceCache.getSource();if(!(y instanceof rs))return s;const S=u.map(M=>this.sourceCache.getTile(M)),A=y.getImages(S,Array.from(this.pendingRequests));for(const[M,D]of A)s.set(a.I.from({name:M,iconsetId:this.id}),D),this.pendingRequests.delete(M);for(const M of this.pendingRequests)this.missingRequests.add(M);return this.pendingRequests.clear(),s}}const zo=(x,s)=>Le(x,s&&s.filter(u=>u.identifier!=="source.canvas")),sh=a.aF(Rr,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),Jm=a.aF(Rr,["setCenter","setZoom","setBearing","setPitch"]),Nc=new Set(["background","sky","slot","custom"]),rc={version:8,layers:[],sources:{}},eg={duration:300,delay:0};class il extends a.E{constructor(s,u={}){super(),this.map=s,this.scope=u.scope||"",this.globalId=null,this.fragments=[],this.importDepth=u.importDepth||0,this.importsCache=u.importsCache||new Map,this.resolvedImports=u.resolvedImports||new Set,this.transition=a.l({},eg),this._buildingIndex=new _x(this),this.crossTileSymbolIndex=new pa,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=u.styleChanges||new Ir,this.dispatcher=u.dispatcher?u.dispatcher:new a.D(a.d0(),this),u.imageManager?this.imageManager=u.imageManager:(this.imageManager=new sa(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=u.glyphManager?u.glyphManager:new a.d1(s._requestManager,u.localFontFamily?a.d2.all:u.localIdeographFontFamily?a.d2.ideographs:a.d2.none,u.localFontFamily||u.localIdeographFontFamily),u.modelManager?this.modelManager=u.modelManager:(this.modelManager=new ru(s._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=u.configOptions?u.configOptions:new Map,this._configDependentLayers=u.configDependentLayers?u.configDependentLayers:new Set,this._config=u.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:u.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=u.initialConfig,this.dispatcher.broadcast("setReferrer",a.d3());const y=this;this._rtlTextPluginCallback=il.registerForPluginStateChange(S=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},(A,M)=>{if(a.d4(A),M&&M.every(D=>D))for(const D in y._sourceCaches){const z=y._sourceCaches[D],U=z.getSource().type;U!=="vector"&&U!=="geojson"||z.reload()}})}),this.on("data",S=>{if(S.dataType!=="source"||S.sourceDataType!=="metadata")return;const A=this.getOwnSource(S.sourceId);if(A&&A.vectorLayerIds)for(const M in this._layers){const D=this._layers[M];D.source===A.id&&this._validateLayer(D)}})}load(s){return s?(typeof s=="string"?this.loadURL(s):this.loadJSON(s),this):this}_getGlobalId(s){if(!s)return null;if(typeof s=="string"){if(a.f(s))return s;const u=a.d5(s);if(!u.startsWith("http"))try{return new URL(u,location.href).toString()}catch{return u}return u}return`json://${a.d6(JSON.stringify(s))}`}_diffStyle(s,u,y){this.globalId=this._getGlobalId(s);const S=(A,M)=>{try{M(null,this.setState(A,y))}catch(D){M(D,!1)}};if(typeof s=="string"){const A=this.map._requestManager.normalizeStyleURL(s),M=this.map._requestManager.transformRequest(A,a.R.Style);a.n(M,(D,z)=>{D?this.fire(new a.z(D)):z&&S(z,u)})}else typeof s=="object"&&S(s,u)}loadURL(s,u={}){this.fire(new a.A("dataloading",{dataType:"style"}));const y=typeof u.validate=="boolean"?u.validate:!a.f(s);this.globalId=this._getGlobalId(s),s=this.map._requestManager.normalizeStyleURL(s,u.accessToken),this.resolvedImports.add(s);const S=this.importsCache.get(s);if(S)return this._load(S,y);const A=this.map._requestManager.transformRequest(s,a.R.Style);this._request=a.n(A,(M,D)=>{if(this._request=null,M)this.fire(new a.z(M));else if(D)return this.importsCache.set(s,D),this._load(D,y)})}loadJSON(s,u={}){this.fire(new a.A("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(s),this._request=a.q.frame(()=>{this._request=null,this._load(s,u.validate!==!1)})}loadEmpty(){this.fire(new a.A("dataloading",{dataType:"style"})),this._load(rc,!1)}_loadImports(s,u,y){if(this.importDepth>=4)return a.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const S=[];for(const A of s){const M=this._createFragmentStyle(A),D=new Promise(H=>{M.once("style.import.load",H),M.once("error",H)}).then(()=>this.mergeAll());if(S.push(D),this.resolvedImports.has(A.url)){M.loadEmpty();continue}const z=A.data||this.importsCache.get(A.url);z?(M.loadJSON(z,{validate:u}),this._isInternalStyle(z)&&(M.globalId=null)):A.url?M.loadURL(A.url,{validate:u}):M.loadEmpty();const U={style:M,id:A.id,config:A.config};if(y){const H=this.fragments.findIndex(({id:K})=>K===y);this.fragments=this.fragments.slice(0,H).concat(U).concat(this.fragments.slice(H))}else this.fragments.push(U)}return Promise.allSettled(S)}getImportGlobalIds(s=this,u=new Set){for(const y of s.fragments)y.style.globalId&&u.add(y.style.globalId),this.getImportGlobalIds(y.style,u);return[...u.values()]}_createFragmentStyle(s){const u=this.scope?a.C(s.id,this.scope):s.id;let y;const S=this._initialConfig&&this._initialConfig[u];(s.config||S)&&(y=a.l({},s.config,S));const A=new il(this.map,{scope:u,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:y,configOptions:this.options,colorThemeOverride:s["color-theme"],configDependentLayers:this._configDependentLayers});return A.setEventedParent(this.map,{style:A}),A}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(s){return this.isRootStyle()&&(s.fragment||!!s.schema&&s.fragment!==!1)}_load(s,u){const y=s.indoor?ah(s.schema):s.schema;if(this._isInternalStyle(s)){const M=a.l({},rc,{imports:[{id:"basemap",data:s,url:""}]});return void this._load(M,u)}if(this.updateConfig(this._config,y),u&&zo(this,ks(s)))return;this._loaded=!0,this.stylesheet=a.d7(s);const S=()=>{for(const U in s.sources)this.addSource(U,s.sources[U],{validate:!1,isInitialLoad:!0});if(s.iconsets)for(const U in s.iconsets)this.addIconset(U,s.iconsets[U]);s.sprite?this._loadIconset(s.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.setGlyphsUrl(s.glyphs);const M=fp(this.stylesheet.layers);if(this._order=M.map(U=>U.id),this.stylesheet.light&&a.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const U=this.stylesheet.lights[0];this.light=new Ye(U.properties,U.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Ye(this.stylesheet.light)),this._layers={};for(const U of M){const H=a.dc(U,this.scope,this._styleColorTheme.lut,this.options);H.configDependencies.size!==0&&this._configDependentLayers.add(H.fqid),H.setEventedParent(this,{layer:{id:H.id}}),this._layers[H.id]=H;const K=this.getOwnLayerSourceCache(H),X=!!this.directionalLight&&this.directionalLight.shadowsEnabled();K&&H.canCastShadows()&&X&&(K.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const D=this.stylesheet.terrain;D&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(D,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new a.A("data",{dataType:"style"}));const z=this.isRootStyle();s.imports?this._loadImports(s.imports,u).then(()=>{this._reloadImports(),this.fire(new a.A(z?"style.load":"style.import.load"))}).catch(U=>{this.fire(new a.z(new Error("Failed to load imports",U))),this.fire(new a.A(z?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new a.A(z?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const A=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(A){const M=this._evaluateColorThemeData(A);this._loadColorTheme(M).then(()=>{S()}).catch(D=>{a.w(`Couldn't load color theme from the stylesheet: ${D}`),S()})}else this._styleColorTheme.lut=null,S()}isRootStyle(){return this.importDepth===0}mergeAll(){let s,u,y,S,A,M,D,z,U,H;const K={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(X=>{if(X.stylesheet){if(X.light!=null&&(s=X.light),X.stylesheet.lights)for(const J of X.stylesheet.lights)J.type==="ambient"&&X.ambientLight!=null&&(u=X.ambientLight),J.type==="directional"&&X.directionalLight!=null&&(y=X.directionalLight);S=this._prioritizeTerrain(S,X.terrain,X.stylesheet.terrain),X.stylesheet.fog&&X.fog!=null&&(A=X.fog),X.stylesheet.snow&&X.snow!=null&&(M=X.snow),X.stylesheet.rain&&X.rain!=null&&(D=X.rain),X.stylesheet.camera!=null&&(H=X.stylesheet.camera),X.stylesheet.projection!=null&&(z=X.stylesheet.projection),X.stylesheet.transition!=null&&(U=X.stylesheet.transition),K[X.scope]=X._styleColorTheme}}),this.light=s,this.ambientLight=u,this.directionalLight=y,this.fog=A,this.snow=M,this.rain=D,this._styleColorThemeForScope=K,S===null?delete this.terrain:this.terrain=S,this.camera=H||{"camera-projection":"perspective"},this.projection=z||{name:"mercator"},this.transition=a.l({},eg,U),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(s){const u=y=>{for(const S of y.fragments)u(S.style);s(y)};u(this)}_prioritizeTerrain(s,u,y){const S=s&&s.drapeRenderMode===0;return y===null?u&&u.drapeRenderMode===0?u:S?s:null:u!=null&&(!s||S||u&&u.drapeRenderMode===1)?u:s}mergeTerrain(){let s;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(u=>{s=this._prioritizeTerrain(s,u.terrain,u.stylesheet.terrain)}),s===null?delete this.terrain:this.terrain=s}mergeProjection(){let s;this.forEachFragmentStyle(u=>{u.stylesheet.projection!=null&&(s=u.stylesheet.projection)}),this.projection=s||{name:"mercator"}}mergeSources(){const s={},u={},y={};this.forEachFragmentStyle(S=>{for(const A in S._sourceCaches){const M=a.C(A,S.scope);s[M]=S._sourceCaches[A]}for(const A in S._otherSourceCaches){const M=a.C(A,S.scope);u[M]=S._otherSourceCaches[A]}for(const A in S._symbolSourceCaches){const M=a.C(A,S.scope);y[M]=S._symbolSourceCaches[A]}}),this._mergedSourceCaches=s,this._mergedOtherSourceCaches=u,this._mergedSymbolSourceCaches=y}mergeLayers(){const s={},u=[],y={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(A=>{for(const M of A._order){const D=A._layers[M];if(D.type==="slot"){const z=a.d8(M);if(s[z])continue;s[z]=[]}D.slot&&s[D.slot]?s[D.slot].push(D):u.push(D)}}),this._mergedOrder=[];const S=(A=[])=>{for(const M of A)if(M.type==="slot"){const D=a.d8(M.id);s[D]&&S(s[D]),this._mergedSlots.push(D)}else{const D=a.C(M.id,M.scope);this._mergedOrder.push(D),y[D]=M,M.is3D(!!this.terrain)&&(this._has3DLayers=!0),M.type==="circle"&&(this._hasCircleLayers=!0),M.type==="symbol"&&(this._hasSymbolLayers=!0),M.type==="clip"&&(this._clipLayerPresent=!0)}};S(u),this._mergedOrder.sort((A,M)=>{const D=y[A],z=y[M];return D.hasInitialOcclusionOpacityProperties?z.is3D(!!this.terrain)?1:0:D.is3D(!!this.terrain)&&z.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=y,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(s){return this.stylesheet.camera=a.l({},this.stylesheet.camera,s),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(s){return s.data?function(u,y,S){const A=a.l({},y);for(const D of Object.keys(a.a5.colorTheme))A[D]===void 0&&(A[D]=a.a5.colorTheme[D].default);const M=new a.a6(Ex,u,new Map(S));return M.setTransitionOrValue(A,S),M.untransitioned().possiblyEvaluate(new a.aa(0))}(this.scope,s,this.options).get("data"):null}_loadColorTheme(s){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const u=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((y,S)=>{const A="data:image/png;base64,";if(!s||s.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void y();let M=s;M.startsWith(A)||(M=A+M);const D=a.I.from("mapbox-reserved-lut"),z=new Image;z.src=M,z.onerror=()=>{this._styleColorTheme.lutLoading=!1,S(new Error("Failed to load image data"))},z.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==u)return void y();this._styleColorTheme.lutLoading=!1;const{width:U,height:H,data:K}=a.q.getImageData(z);if(H>32)return void S(new Error("The height of the image must be less than or equal to 32 pixels."));if(U!==H*H)return void S(new Error("The width of the image must be equal to the height squared."));this.getImage(D)&&this.removeImage(D),this.addImage(D,{data:new a.r({width:U,height:H},K),pixelRatio:1,sdf:!1,usvg:!1,version:0});const X=this.imageManager.getImage(D,this.scope);X?(this._styleColorTheme.lut={image:X.data,data:s},y()):S(new Error("Missing LUT image."))}})}getLut(s){const u=this._styleColorThemeForScope[s];return u?u.lut:null}setProjection(s){s?this.stylesheet.projection=s:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(s){this._spriteRequest=function(u,y,S){let A,M,D;const z=a.q.devicePixelRatio>1?"@2x":"";let U=a.n(y.transformRequest(y.normalizeSpriteURL(u,z,".json"),a.R.SpriteJSON),(X,J)=>{U=null,D||(D=X,A=J,K())}),H=a.o(y.transformRequest(y.normalizeSpriteURL(u,z,".png"),a.R.SpriteImage),(X,J)=>{H=null,D||(D=X,M=J,K())});function K(){if(D)S(D);else if(A&&M){const X=a.q.getImageData(M),J={};for(const de in A){const{width:ce,height:fe,x:ue,y:ve,sdf:Ee,pixelRatio:Pe,stretchX:ze,stretchY:Ie,content:Oe}=A[de],Ce=new a.r({width:ce,height:fe});a.r.copy(X,Ce,{x:ue,y:ve},{x:0,y:0},{width:ce,height:fe},null),J[de]={data:Ce,pixelRatio:Pe,sdf:Ee,stretchX:ze,stretchY:Ie,content:Oe,usvg:!1}}S(null,J)}}return{cancel(){U&&(U.cancel(),U=null),H&&(H.cancel(),H=null)}}}(s,this.map._requestManager,(u,y)=>{if(this._spriteRequest=null,u)this.fire(new a.z(u));else if(y){const S=new Map;for(const A in y)S.set(a.I.from(A),y[A]);this.addImages(S)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new a.A("data",{dataType:"style"}))})}addIconset(s,u){if(u.type==="sprite")return void this._loadSprite(u.url);const y=this.getOwnSourceCache(u.source);if(!y)return void this.fire(new a.z(new Error(`Source "${u.source}" as specified by iconset "${s}" does not exist and cannot be used as an iconset source`)));const S=y.getSource();if(S.type!=="raster-array")return void this.fire(new a.z(new Error(`Source "${u.source}" as specified by iconset "${s}" is not a "raster-array" source and cannot be used as an iconset source`)));S.partial=!1;const A=new Ax(s,this.scope,y);this.imageManager.addImageProvider(A,this.scope)}removeIconset(s){this.imageManager.removeImageProvider(s,this.scope)}_loadIconset(s){if(!a.f(s)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(s);const u=this.map._spriteFormat==="auto";var y,S;this._spriteRequest=(S=(A,M)=>{if(this._spriteRequest=null,A)u?this._loadSprite(s):this.fire(new a.z(A));else if(M){const D=new Map;for(const z in M)D.set(a.I.from(z),M[z]);this.addImages(D)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new a.A("data",{dataType:"style"}))},a.br((y=this.map._requestManager).transformRequest(y.normalizeIconsetURL(s),a.R.Iconset),(A,M)=>{if(A)return void S(A);const D={},z=a.c_(new a.bq(M));for(const U of z.icons){const H={version:1,pixelRatio:a.q.devicePixelRatio,content:Ep(U),stretchX:U.metadata?hf(U.metadata.stretch_x_areas):void 0,stretchY:U.metadata?hf(U.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:U};D[U.name]=H}S(null,D)}))}_validateLayer(s){const u=this.getOwnSource(s.source);if(!u)return;const y=s.sourceLayer;y&&(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(y)===-1)&&this.fire(new a.z(new Error(`Source layer "${y}" does not exist on source "${u.id}" as specified by style layer "${s.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const s in this._sourceCaches)if(!this._sourceCaches[s].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:s}of this.fragments)if(!s.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((s,u)=>{const y=this.fragments[u];return y&&y.style&&(s.data=y.style.serialize()),s})}_serializeSources(){const s={};for(const u in this._sourceCaches){const y=this._sourceCaches[u].getSource();s[y.id]||(s[y.id]=y.serialize())}return s}_serializeLayers(s){const u=[];for(const y of s){const S=this._layers[y];S&&S.type!=="custom"&&u.push(S.serialize())}return u}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const s in this._sourceCaches)if(this._sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(s){return s?this.order:this._mergedOrder}isLayerDraped(s){return!!this.terrain&&s.isDraped(this.getLayerSourceCache(s))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(s){const u=this.getOwnLayer(s);if(u)return u;this.fire(new a.z(new Error(`The layer '${s}' does not exist in the map's style.`)))}_checkSource(s){const u=this.getOwnSource(s);if(u)return u;this.fire(new a.z(new Error(`The source '${s}' does not exist in the map's style.`)))}precompilePrograms(s,u){const y=this.map.painter;if(y)for(let S=s.minzoom||0;S<(s.maxzoom||25.5);S++){const A=s.getProgramIds();if(A)for(const M of A){const D=s.getDefaultProgramParams(M,u.zoom,this._styleColorTheme.lut);D&&(y.style=this,this.fog&&(y._fogVisible=!0,D.overrideFog=!0,y.getOrCreateProgram(M,D)),y._fogVisible=!1,D.overrideFog=!1,y.getOrCreateProgram(M,D),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(D.overrideRtt=!0,y.getOrCreateProgram(M,D)))}}}update(s){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(s),this.directionalLight&&this.directionalLight.recalculate(s);const u=this.calculateLightsBrightness();s.brightness=u||0,u!==this._brightness&&(this._brightness=u,this.dispatcher.broadcast("setBrightness",u));const y=this._changes.isDirty();let S=!1;if(this._changes.isDirty()){const D=this._changes.getLayerUpdatesByScope();for(const z in D){const{updatedIds:U,removedIds:H}=D[z];(U||H)&&(this._updateWorkerLayers(z,U,H),S=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(s),this.light&&this.light.updateTransitions(s),this.ambientLight&&this.ambientLight.updateTransitions(s),this.directionalLight&&this.directionalLight.updateTransitions(s),this.fog&&this.fog.updateTransitions(s),this.snow&&this.snow.updateTransitions(s),this.rain&&this.rain.updateTransitions(s),this._changes.reset()}const A={};for(const D in this._mergedSourceCaches){const z=this._mergedSourceCaches[D];A[D]=z.used,z.used=!1,z.tileCoverLift=0}for(const D of this._mergedOrder){const z=this._mergedLayers[D];if(z.recalculate(s,this._availableImages),!z.isHidden(s.zoom)){const U=this.getLayerSourceCache(z);U&&(U.used=!0,U.tileCoverLift=Math.max(U.tileCoverLift,z.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(z,s)}):this.precompilePrograms(z,s))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&S&&this.mergeLayers();const M=this.imageManager.getPendingImageProviders();for(const D of M)D.sourceCache.used=!0;for(const D in A){const z=this._mergedSourceCaches[D];A[D]!==z.used&&z.getSource().fire(new a.A("data",{sourceDataType:"visibility",dataType:"source",sourceId:z.getSource().id}))}this.light&&this.light.recalculate(s),this.terrain&&this.terrain.recalculate(s),this.fog&&this.fog.recalculate(s),this.snow&&this.snow.recalculate(s),this.rain&&this.rain.recalculate(s),this.z=s.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),y&&this.fire(new a.A("data",{dataType:"style"}))}updateImageProviders(){const s=this.imageManager.getPendingImageProviders();for(const u of s){const y=u.resolvePendingRequests(),S=this.getFragmentStyle(u.scope);S&&S.addImages(y)}}_updateTilesForChangedImages(){const s={};for(const u in this._mergedSourceCaches){const y=this._mergedSourceCaches[u].getSource().scope;s[y]=s[y]||this._changes.getUpdatedImages(y),s[y].length!==0&&this._mergedSourceCaches[u].reloadTilesForDependencies(["icons","patterns"],s[y])}for(const u in s)this._changes.resetUpdatedImages(u)}_updateWorkerLayers(s,u,y){const S=this.getFragmentStyle(s);S&&this.dispatcher.broadcast("updateLayers",{layers:u?S._serializeLayers(u):[],scope:s,removedIds:y||[],options:S.options})}setState(s,u){if(this._checkLoaded(),zo(this,ks(s)))return!1;(s=a.d7(s)).layers=fp(s.layers);const y=function(M,D){if(!M)return[{command:Rr.setStyle,args:[D]}];let z=[];try{if(!a.bv(M.version,D.version))return[{command:Rr.setStyle,args:[D]}];if(a.bv(M.center,D.center)||z.push({command:Rr.setCenter,args:[D.center]}),a.bv(M.zoom,D.zoom)||z.push({command:Rr.setZoom,args:[D.zoom]}),a.bv(M.bearing,D.bearing)||z.push({command:Rr.setBearing,args:[D.bearing]}),a.bv(M.pitch,D.pitch)||z.push({command:Rr.setPitch,args:[D.pitch]}),a.bv(M.sprite,D.sprite)||z.push({command:Rr.setSprite,args:[D.sprite]}),a.bv(M.glyphs,D.glyphs)||z.push({command:Rr.setGlyphs,args:[D.glyphs]}),a.bv(M.imports,D.imports)||function(J=[],de=[],ce){de=de||[];const fe=(J=J||[]).map(ec),ue=de.map(ec),ve=J.reduce(Wd,{}),Ee=de.reduce(Wd,{}),Pe=fe.slice();let ze,Ie,Oe,Ce;for(ze=0,Ie=0;ze<fe.length;ze++)Oe=fe[ze],Ee.hasOwnProperty(Oe)?Ie++:(ce.push({command:Rr.removeImport,args:[Oe]}),Pe.splice(Pe.indexOf(Oe,Ie),1));for(ze=0,Ie=0;ze<ue.length;ze++)Oe=ue[ue.length-1-ze],Pe[Pe.length-1-ze]!==Oe&&(ve.hasOwnProperty(Oe)?(ce.push({command:Rr.removeImport,args:[Oe]}),Pe.splice(Pe.lastIndexOf(Oe,Pe.length-Ie),1)):Ie++,Ce=Pe[Pe.length-ze],ce.push({command:Rr.addImport,args:[Ee[Oe],Ce]}),Pe.splice(Pe.length-ze,0,Oe));for(const Fe of de){const $e=ve[Fe.id];$e&&!a.bv($e,Fe)&&ce.push({command:Rr.updateImport,args:[Fe.id,Fe]})}}(M.imports,D.imports,z),a.bv(M.transition,D.transition)||z.push({command:Rr.setTransition,args:[D.transition]}),a.bv(M.light,D.light)||z.push({command:Rr.setLight,args:[D.light]}),a.bv(M.fog,D.fog)||z.push({command:Rr.setFog,args:[D.fog]}),a.bv(M.snow,D.snow)||z.push({command:Rr.setSnow,args:[D.snow]}),a.bv(M.rain,D.rain)||z.push({command:Rr.setRain,args:[D.rain]}),a.bv(M.projection,D.projection)||z.push({command:Rr.setProjection,args:[D.projection]}),a.bv(M.lights,D.lights)||z.push({command:Rr.setLights,args:[D.lights]}),a.bv(M.camera,D.camera)||z.push({command:Rr.setCamera,args:[D.camera]}),a.bv(M.iconsets,D.iconsets)||function(J,de,ce){let fe;for(fe in de=de||{},J=J||{})J.hasOwnProperty(fe)&&(de.hasOwnProperty(fe)||ce.push({command:Rr.removeIconset,args:[fe]}));for(fe in de){if(!de.hasOwnProperty(fe))continue;const ue=de[fe];J.hasOwnProperty(fe)?a.bv(J[fe],ue)||(ce.push({command:Rr.removeIconset,args:[fe]}),ce.push({command:Rr.addIconset,args:[fe,ue]})):ce.push({command:Rr.addIconset,args:[fe,ue]})}}(M.iconsets,D.iconsets,z),!a.bv(M["color-theme"],D["color-theme"]))return[{command:Rr.setStyle,args:[D]}];const U={},H=[];(function(J,de,ce,fe){let ue;for(ue in de=de||{},J=J||{})J.hasOwnProperty(ue)&&(de.hasOwnProperty(ue)||Vu(ue,ce,fe));for(ue in de){if(!de.hasOwnProperty(ue))continue;const ve=de[ue];J.hasOwnProperty(ue)?a.bv(J[ue],ve)||(J[ue].type==="geojson"&&ve.type==="geojson"&&Jc(J,de,ue)?ce.push({command:Rr.setGeoJSONSourceData,args:[ue,ve.data]}):pp(ue,de,ce,fe)):Io(ue,de,ce)}})(M.sources,D.sources,H,U);const K=[];M.layers&&M.layers.forEach(J=>{J.source&&U[J.source]?z.push({command:Rr.removeLayer,args:[J.id]}):K.push(J)});let X=M.terrain;X&&U[X.source]&&(z.push({command:Rr.setTerrain,args:[void 0]}),X=void 0),z=z.concat(H),a.bv(X,D.terrain)||z.push({command:Rr.setTerrain,args:[D.terrain]}),function(J,de,ce){de=de||[];const fe=(J=J||[]).map(ec),ue=de.map(ec),ve=J.reduce(Wd,{}),Ee=de.reduce(Wd,{}),Pe=fe.slice(),ze=Object.create(null);let Ie,Oe,Ce,Fe,$e,st,et;for(Ie=0,Oe=0;Ie<fe.length;Ie++)Ce=fe[Ie],Ee.hasOwnProperty(Ce)?Oe++:(ce.push({command:Rr.removeLayer,args:[Ce]}),Pe.splice(Pe.indexOf(Ce,Oe),1));for(Ie=0,Oe=0;Ie<ue.length;Ie++)Ce=ue[ue.length-1-Ie],Pe[Pe.length-1-Ie]!==Ce&&(ve.hasOwnProperty(Ce)?(ce.push({command:Rr.removeLayer,args:[Ce]}),Pe.splice(Pe.lastIndexOf(Ce,Pe.length-Oe),1)):Oe++,st=Pe[Pe.length-Ie],ce.push({command:Rr.addLayer,args:[Ee[Ce],st]}),Pe.splice(Pe.length-Ie,0,Ce),ze[Ce]=!0);for(Ie=0;Ie<ue.length;Ie++)if(Ce=ue[Ie],Fe=ve[Ce],$e=Ee[Ce],!ze[Ce]&&!a.bv(Fe,$e))if(a.bv(Fe.source,$e.source)&&a.bv(Fe["source-layer"],$e["source-layer"])&&a.bv(Fe.type,$e.type)){for(et in eu(Fe.layout,$e.layout,ce,Ce,null,Rr.setLayoutProperty),eu(Fe.paint,$e.paint,ce,Ce,null,Rr.setPaintProperty),a.bv(Fe.slot,$e.slot)||ce.push({command:Rr.setSlot,args:[Ce,$e.slot]}),a.bv(Fe.filter,$e.filter)||ce.push({command:Rr.setFilter,args:[Ce,$e.filter]}),a.bv(Fe.minzoom,$e.minzoom)&&a.bv(Fe.maxzoom,$e.maxzoom)||ce.push({command:Rr.setLayerZoomRange,args:[Ce,$e.minzoom,$e.maxzoom]}),Fe)Fe.hasOwnProperty(et)&&et!=="layout"&&et!=="paint"&&et!=="filter"&&et!=="metadata"&&et!=="minzoom"&&et!=="maxzoom"&&et!=="slot"&&(et.indexOf("paint.")===0?eu(Fe[et],$e[et],ce,Ce,et.slice(6),Rr.setPaintProperty):a.bv(Fe[et],$e[et])||ce.push({command:Rr.setLayerProperty,args:[Ce,et,$e[et]]}));for(et in $e)$e.hasOwnProperty(et)&&!Fe.hasOwnProperty(et)&&et!=="layout"&&et!=="paint"&&et!=="filter"&&et!=="metadata"&&et!=="minzoom"&&et!=="maxzoom"&&et!=="slot"&&(et.indexOf("paint.")===0?eu(Fe[et],$e[et],ce,Ce,et.slice(6),Rr.setPaintProperty):a.bv(Fe[et],$e[et])||ce.push({command:Rr.setLayerProperty,args:[Ce,et,$e[et]]}))}else ce.push({command:Rr.removeLayer,args:[Ce]}),st=Pe[Pe.lastIndexOf(Ce)+1],ce.push({command:Rr.addLayer,args:[$e,st]})}(K,D.layers,z)}catch(U){console.warn("Unable to compute style diff:",U),z=[{command:Rr.setStyle,args:[D]}]}return z}(this.serialize(),s).filter(M=>!(M.command in Jm));if(y.length===0)return!1;const S=y.filter(M=>!(M.command in sh));if(S.length>0)throw new Error(`Unimplemented: ${S.map(M=>M.command).join(", ")}.`);const A=[];return y.forEach(M=>{A.push(this[M.command](...M.args))}),u&&Promise.all(A).then(u).catch(u),this.stylesheet=s,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(s){for(const[u,y]of s.entries()){if(this.getImage(u))return this.fire(new a.z(new Error(`An image with the name "${u.name}" already exists.`)));this.imageManager.addImage(u,this.scope,y),this._changes.updateImage(u,this.scope)}return this._updateWorkerImages(),this.fire(new a.A("data",{dataType:"style"})),this}addImage(s,u){return this.getImage(s)?this.fire(new a.z(new Error(`An image with the name "${s.name}" already exists.`))):(this.imageManager.addImage(s,this.scope,u),this._changes.updateImage(s,this.scope),this._updateWorkerImages(),this.fire(new a.A("data",{dataType:"style"})),this)}updateImage(s,u,y=!1){this.imageManager.updateImage(s,this.scope,u),y&&(this._changes.updateImage(s,this.scope),this._updateWorkerImages(),this.fire(new a.A("data",{dataType:"style"})))}getImage(s){return this.imageManager.getImage(s,this.scope)}removeImage(s){return this.getImage(s)?(this.imageManager.removeImage(s,this.scope),this._changes.updateImage(s,this.scope),this._updateWorkerImages(),this.fire(new a.A("data",{dataType:"style"})),this):this.fire(new a.z(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModelURLs(s){return this.modelManager.addModelURLs(s,this.scope),this._updateWorkerModels(),this.fire(new a.A("data",{dataType:"style"})),this}addModel(s,u,y={}){return this._checkLoaded(),this._validate(De,`models.${s}`,u,null,y)||(this.modelManager.addModel(s,u,this.scope),this.fire(new a.A("data",{dataType:"style"}))),this}hasModel(s){return this.modelManager.hasModel(s,this.scope)}removeModel(s){return this.hasModel(s)?(this.modelManager.removeModel(s,this.scope),this.fire(new a.A("data",{dataType:"style"})),this):this.fire(new a.z(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(s,u,y={}){if(this._checkLoaded(),this.getOwnSource(s)!==void 0)throw new Error(`There is already a source with ID "${s}".`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(Kl,`sources.${s}`,u,null,y))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const S=rf(s,u,this.dispatcher,this);S.scope=this.scope,S.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(S.id),source:S.serialize(),sourceId:S.id}));const A=M=>{const D=(M?"symbol:":"other:")+S.id,z=a.C(D,this.scope),U=this._sourceCaches[D]=new _s(z,S,M);(M?this._symbolSourceCaches:this._otherSourceCaches)[S.id]=U,U.onAdd(this.map)};A(!1),u.type!=="vector"&&u.type!=="geojson"||A(!0),S.onAdd&&S.onAdd(this.map),y.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(s){this._checkLoaded();const u=this.getOwnSource(s);if(!u)throw new Error("There is no source with this ID");for(const S in this._layers)if(this._layers[S].source===s)return this.fire(new a.z(new Error(`Source "${s}" cannot be removed while layer "${S}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===s)return this.fire(new a.z(new Error(`Source "${s}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const S=Object.entries(this.stylesheet.iconsets).find(([A,M])=>M.type==="source"&&M.source===s);if(S)return this.fire(new a.z(new Error(`Source "${s}" cannot be removed while iconset "${S[0]}" is using it.`)))}const y=this.getOwnSourceCaches(s);for(const S of y){const A=a.d8(S.id);delete this._sourceCaches[A],this._changes.discardSourceCacheUpdate(S.id),S.fire(new a.A("data",{sourceDataType:"metadata",dataType:"source",sourceId:S.getSource().id})),S.setEventedParent(null),S.clearTiles()}return delete this._otherSourceCaches[s],delete this._symbolSourceCaches[s],this.mergeSources(),u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(s,u){this._checkLoaded(),this.getOwnSource(s).setData(u),this._changes.setDirty()}getOwnSource(s){const u=this.getOwnSourceCache(s);return u&&u.getSource()}getOwnSources(){const s=[];for(const u in this._otherSourceCaches){const y=this.getOwnSourceCache(u);y&&s.push(y.getSource())}return s}areTilesLoaded(){const s=this._mergedSourceCaches;for(const u in s){const y=s[u]._tiles;for(const S in y){const A=y[S];if(A.state!=="loaded"&&A.state!=="errored")return!1}}return!0}setLights(s){if(this._checkLoaded(),!s)return delete this.ambientLight,void delete this.directionalLight;const u=this._getTransitionParameters();for(const S of s){if(this._validate(Yl,"lights",S))return;switch(S.type){case"ambient":if(this.ambientLight){const A=this.ambientLight;A.set(S),A.updateTransitions(u)}else this.ambientLight=new Ti(S,Lr||(Lr=new a.a7({color:new a.a8(a.a5.properties_light_ambient.color),"color-use-theme":new a.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new a.a8(a.a5.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const A=this.directionalLight;A.set(S),A.updateTransitions(u)}else this.directionalLight=new Ti(S,Cr||(Cr=new a.a7({direction:new a.an(a.a5.properties_light_directional.direction),color:new a.a8(a.a5.properties_light_directional.color),"color-use-theme":new a.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new a.a8(a.a5.properties_light_directional.intensity),"cast-shadows":new a.a8(a.a5.properties_light_directional["cast-shadows"]),"shadow-quality":new a.a8(a.a5.properties_light_directional["shadow-quality"]),"shadow-intensity":new a.a8(a.a5.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const y=new a.aa(this.z||0,u);this.ambientLight&&this.ambientLight.recalculate(y),this.directionalLight&&this.directionalLight.recalculate(y),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const s=this.directionalLight,u=this.ambientLight;if(!s||!u)return;const y=X=>.2126*(X[0]<=.03928?X[0]/12.92:Math.pow((X[0]+.055)/1.055,2.4))+.7152*(X[1]<=.03928?X[1]/12.92:Math.pow((X[1]+.055)/1.055,2.4))+.0722*(X[2]<=.03928?X[2]/12.92:Math.pow((X[2]+.055)/1.055,2.4)),S=s.properties.get("color").toRenderColor(null).toArray01(),A=s.properties.get("intensity"),M=s.properties.get("direction"),D=1-a.cR(M.x,M.y,M.z)[2]/90,z=y(S)*A*D,U=u.properties.get("color").toRenderColor(null).toArray01(),H=u.properties.get("intensity"),K=y(U)*H;return Number(((z+K)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const s=[];return this.directionalLight&&s.push(this.directionalLight.get()),this.ambientLight&&s.push(this.ambientLight.get()),s}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(s){if(s==null||s===""&&this.isRootStyle())return this;if(a.d9(s)){const u=a.da(s),y=this.fragments.find(({id:A})=>A===u);if(!y)return;const S=a.d8(s);return y.style.getFragmentStyle(S)}{const u=this.fragments.find(({id:y})=>y===s);return u?u.style:void 0}}setFeaturesetSelectors(s){if(!s)return;const u={},y=(S,A="")=>`${S}::${A}`;this._featuresetSelectors={};for(const S in s){const A=this._featuresetSelectors[S]=[];for(const M of s[S].selectors){if(M.featureNamespace){const z=this.getOwnLayer(M.layer);if(!z){a.w(`Layer is undefined for selector: ${M.layer}`);continue}const U=y(z.source,z.sourceLayer);if(U in u&&u[U]!==M.featureNamespace){a.w(`"featureNamespace ${M.featureNamespace} of featureset ${S}'s selector is not associated to the same source, skip this selector`);continue}u[U]=M.featureNamespace}let D;if(M.properties)for(const z in M.properties){const U=a.X(M.properties[z]);U.result==="success"&&(D=D||{},D[z]=U.value)}A.push({layerId:M.layer,namespace:M.featureNamespace,properties:D,uniqueFeatureID:M._uniqueFeatureID})}}}getFeaturesetDescriptors(s){const u=this.getFragmentStyle(s);if(!u||!u.stylesheet.featuresets)return[];const y=[];for(const S in u.stylesheet.featuresets)y.push({featuresetId:S,importId:u.scope?u.scope:void 0});return y}getFeaturesetLayers(s,u){const y=this.getFragmentStyle(u),S=y.stylesheet.featuresets;if(!S||!S[s])return this.fire(new a.z(new Error(`The featureset '${s}' does not exist in the map's style and cannot be queried.`))),[];const A=[];for(const M of S[s].selectors){const D=y.getOwnLayer(M.layer);D&&A.push(D)}return A}getConfigProperty(s,u){const y=this.getFragmentStyle(s);if(!y)return null;const S=a.C(u,y.scope),A=y.options.get(S),M=A?A.value||A.default:null;return M?M.serialize():null}setConfigProperty(s,u,y){const S=this.getFragmentStyle(s);if(!S)return;const A=S.stylesheet.indoor?ah(S.stylesheet.schema):S.stylesheet.schema;if(!A||!A[u])return;const M=a.X(y);if(M.result!=="success")return void zo(this,M.value);const D=M.value.expression,z=a.C(u,S.scope),U=S.options.get(z);if(!U)return;let H;const{minValue:K,maxValue:X,stepValue:J,type:de,values:ce}=A[u],fe=a.X(A[u].default);fe.result==="success"&&(H=fe.value.expression),H?(this.options.set(z,Object.assign({},U,{value:D,default:H,minValue:K,maxValue:X,stepValue:J,type:de,values:ce})),this.updateConfigDependencies(u)):this.fire(new a.z(new Error(`No schema defined for the config option "${u}" in the "${s}" fragment.`)))}getConfig(s){const u=this.getFragmentStyle(s);if(!u)return null;const y=u.stylesheet.schema;if(!y)return null;const S={};for(const A in y){const M=a.C(A,u.scope),D=u.options.get(M),z=D?D.value||D.default:null;S[A]=z?z.serialize():null}return S}setConfig(s,u){const y=this.getFragmentStyle(s);y&&(y.updateConfig(u,y.stylesheet.schema),this.updateConfigDependencies())}getSchema(s){const u=this.getFragmentStyle(s);return u?u.stylesheet.schema:null}setSchema(s,u){const y=this.getFragmentStyle(s);y&&(y.stylesheet.schema=u,y.updateConfig(y._config,u),this.updateConfigDependencies())}updateConfig(s,u){if(this._config=s,s||u)if(u)for(const y in u){let S,A;const M=a.X(u[y].default);if(M.result==="success"&&(S=M.value.expression),s&&s[y]!==void 0){const X=a.X(s[y]);X.result==="success"&&(A=X.value.expression)}const{minValue:D,maxValue:z,stepValue:U,type:H,values:K}=u[y];if(S){const X=a.C(y,this.scope);this.options.set(X,{default:S,value:A,minValue:D,maxValue:z,stepValue:U,type:H,values:K})}else this.fire(new a.z(new Error(`No schema defined for config option "${y}".`)))}else this.fire(new a.z(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(s){for(const u of this._configDependentLayers){const y=this.getLayer(u);if(y){if(s&&!y.configDependencies.has(s))continue;y.possiblyEvaluateVisibility(),this._updateLayer(y)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(u=>{const y=u._styleColorTheme.colorThemeOverride?u._styleColorTheme.colorThemeOverride:u._styleColorTheme.colorTheme;if(y){const S=u._evaluateColorThemeData(y);(!u._styleColorTheme.lut&&S!==""||u._styleColorTheme.lut&&S!==u._styleColorTheme.lut.data)&&u.setColorTheme(y)}}),this._changes.setDirty()}addLayer(s,u,y={}){this._checkLoaded();const S=s.id;if(this._layers[S])return void this.fire(new a.z(new Error(`Layer with id "${S}" already exists on this map`)));let A;if(s.type==="custom"){if(zo(this,a.db(s)))return;A=a.dc(s,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof s.source=="object"&&(this.addSource(S,s.source),s=a.d7(s),s=a.l(s,{source:S})),this._validate(te,`layers.${S}`,s,{arrayIndex:-1},y))return;A=a.dc(s,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(A),A.setEventedParent(this,{layer:{id:S}})}A.configDependencies.size!==0&&this._configDependentLayers.add(A.fqid);let M=this._order.length;if(u){const H=this._order.indexOf(u);if(H===-1)return void this.fire(new a.z(new Error(`Layer with id "${u}" does not exist on this map.`)));A.slot===this._layers[u].slot?M=H:a.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(M,0,S),this._layerOrderChanged=!0,this._layers[S]=A;const D=this.getOwnLayerSourceCache(A),z=!!this.directionalLight&&this.directionalLight.shadowsEnabled();D&&A.canCastShadows()&&z&&(D.castsShadows=!0);const U=this._changes.getRemovedLayer(A);if(U&&A.source&&D&&A.type!=="custom"){this._changes.discardLayerRemoval(A);const H=a.C(A.source,A.scope);U.type!==A.type?this._changes.updateSourceCache(H,"clear"):(this._changes.updateSourceCache(H,"reload"),D.pause())}this._updateLayer(A),A.onAdd&&A.onAdd(this.map),A.scope=this.scope,this.mergeLayers()}moveLayer(s,u){this._checkLoaded();const y=this._checkLayer(s);if(!y||s===u)return;const S=this._order.indexOf(s);this._order.splice(S,1);let A=this._order.length;if(u){const M=this._order.indexOf(u);if(M===-1)return void this.fire(new a.z(new Error(`Layer with id "${u}" does not exist on this map.`)));y.slot===this._layers[u].slot?A=M:a.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(A,0,s),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(s){this._checkLoaded();const u=this._checkLayer(s);if(!u)return;u.setEventedParent(null);const y=this._order.indexOf(s);this._order.splice(y,1),delete this._layers[s],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(u.fqid),this._changes.removeLayer(u);const S=this.getOwnLayerSourceCache(u);if(S&&S.castsShadows){let A=!1;for(const M in this._layers)if(this._layers[M].source===u.source&&this._layers[M].canCastShadows()){A=!0;break}S.castsShadows=A}u.onRemove&&u.onRemove(this.map),this.mergeLayers()}getOwnLayer(s){return this._layers[s]}hasLayer(s){return s in this._mergedLayers}hasLayerType(s){for(const u in this._layers)if(this._layers[u].type===s)return!0;return!1}setLayerZoomRange(s,u,y){this._checkLoaded();const S=this._checkLayer(s);S&&(S.minzoom===u&&S.maxzoom===y||(u!=null&&(S.minzoom=u),y!=null&&(S.maxzoom=y),this._updateLayer(S)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(s,u){this._checkLoaded();const y=this._checkLayer(s);y&&y.slot!==u&&(y.slot=u,this._updateLayer(y))}setFilter(s,u,y={}){this._checkLoaded();const S=this._checkLayer(s);if(S&&!a.bv(S.filter,u))return u==null?(S.filter=void 0,void this._updateLayer(S)):void(this._validate(le,`layers.${S.id}.filter`,u,{layerType:S.type},y)||(S.filter=a.d7(u),this._updateLayer(S)))}getFilter(s){const u=this._checkLayer(s);if(u)return a.d7(u.filter)}setLayoutProperty(s,u,y,S={}){this._checkLoaded();const A=this._checkLayer(s);if(A&&!a.bv(A.getLayoutProperty(u),y)){if(y!=null&&(!S||S.validate!==!1)&&zo(A,Me.call(ks,{key:`layers.${s}.layout.${u}`,layerType:A.type,objectKey:u,value:y,styleSpec:a.a5,style:{glyphs:!0,sprite:!0}})))return;A.setLayoutProperty(u,y),A.configDependencies.size!==0&&this._configDependentLayers.add(A.fqid),this._updateLayer(A)}}getLayoutProperty(s,u){const y=this._checkLayer(s);if(y)return y.getLayoutProperty(u)}setPaintProperty(s,u,y,S={}){this._checkLoaded();const A=this._checkLayer(s);if(!A||a.bv(A.getPaintProperty(u),y)||y!=null&&(!S||S.validate!==!1)&&zo(A,ye.call(ks,{key:`layers.${s}.paint.${u}`,layerType:A.type,objectKey:u,value:y,styleSpec:a.a5})))return;const M=A.setPaintProperty(u,y);A.configDependencies.size!==0&&this._configDependentLayers.add(A.fqid),M&&this._updateLayer(A),this._changes.updatePaintProperties(A)}getPaintProperty(s,u){const y=this._checkLayer(s);if(y)return y.getPaintProperty(u)}setFeatureState(s,u){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){const{featuresetId:z,importId:U}=s.target,H=this.getFragmentStyle(U),K=H.getFeaturesetLayers(z);for(const{source:X,sourceLayer:J}of K)H.setFeatureState({id:s.id,source:X,sourceLayer:J},u)}else if("layerId"in s.target){const{layerId:z}=s.target,U=this.getLayer(z);this.setFeatureState({id:s.id,source:U.source,sourceLayer:U.sourceLayer},u)}return}const y=s.source,S=s.sourceLayer,A=this._checkSource(y);if(!A)return;const M=A.type;if(M==="geojson"&&S)return void this.fire(new a.z(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(M==="vector"&&!S)return void this.fire(new a.z(new Error("The sourceLayer parameter must be provided for vector source types.")));s.id===void 0&&this.fire(new a.z(new Error("The feature id parameter must be provided.")));const D=this.getOwnSourceCaches(y);for(const z of D)z.setFeatureState(S,s.id,u)}removeFeatureState(s,u){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){const{featuresetId:z,importId:U}=s.target,H=this.getFragmentStyle(U),K=H.getFeaturesetLayers(z);for(const{source:X,sourceLayer:J}of K)H.removeFeatureState({id:s.id,source:X,sourceLayer:J},u)}else if("layerId"in s.target){const{layerId:z}=s.target,U=this.getLayer(z);this.removeFeatureState({id:s.id,source:U.source,sourceLayer:U.sourceLayer},u)}return}const y=s.source,S=this._checkSource(y);if(!S)return;const A=S.type,M=A==="vector"?s.sourceLayer:void 0;if(A==="vector"&&!M)return void this.fire(new a.z(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&typeof s.id!="string"&&typeof s.id!="number")return void this.fire(new a.z(new Error("A feature id is required to remove its specific state property.")));const D=this.getOwnSourceCaches(y);for(const z of D)z.removeFeatureState(M,s.id,u)}getFeatureState(s){if(this._checkLoaded(),"target"in s){let A;if("featuresetId"in s.target){const{featuresetId:M,importId:D}=s.target,z=this.getFragmentStyle(D),U=z.getFeaturesetLayers(M);for(const{source:H,sourceLayer:K}of U){const X=z.getFeatureState({id:s.id,source:H,sourceLayer:K});if(X&&!A)A=X;else if(!a.bv(A,X))return void this.fire(new a.z(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in s.target){const{layerId:M}=s.target,D=this.getLayer(M);A=this.getFeatureState({id:s.id,source:D.source,sourceLayer:D.sourceLayer})}return A}const u=s.source,y=s.sourceLayer,S=this._checkSource(u);if(S){if(S.type!=="vector"||y)return s.id===void 0&&this.fire(new a.z(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(u)[0].getFeatureState(y,s.id);this.fire(new a.z(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(s){return this.stylesheet.transition=a.l({},this.stylesheet.transition,s),this.transition=this.stylesheet.transition,this}getTransition(){return a.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const s=this.getTerrain(),u=s&&this.terrain&&this.terrain.scope===this.scope?s:this.stylesheet.terrain;return a.dd({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:u,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},y=>y!==void 0)}_updateFilteredLayers(s){for(const u of Object.values(this._mergedLayers))s(u)&&this._updateLayer(u)}_updateLayer(s){this._changes.updateLayer(s);const u=this.getLayerSourceCache(s),y=a.C(s.source,s.scope),S=this._changes.getUpdatedSourceCaches();s.source&&!S[y]&&u&&u.getSource().type!=="raster"&&(this._changes.updateSourceCache(y,"reload"),u.pause()),s.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(s){const u=D=>this._mergedLayers[D].is3D(!!this.terrain),y=this.order,S={},A=[];for(let D=y.length-1;D>=0;D--){const z=y[D];if(u(z)){S[z]=D;for(const U of s){const H=U[z];if(H)for(const K of H)A.push(K)}}}A.sort((D,z)=>z.intersectionZ-D.intersectionZ);const M=[];for(let D=y.length-1;D>=0;D--){const z=y[D];if(u(z))for(let U=A.length-1;U>=0;U--){const H=A[U].feature;if(H.layer&&S[H.layer.id]<D)break;M.push(H),A.pop()}else for(const U of s){const H=U[z];if(H)for(const K of H)M.push(K.feature)}}return M}queryRenderedFeatures(s,u,y){let S;u&&!Array.isArray(u)&&u.filter&&(this._validate(le,"queryRenderedFeatures.filter",u.filter,null,u),S=a.b3(u.filter));const A={},M=H=>{if(Nc.has(H.type))return;const K=this.getOwnLayerSourceCache(H),X=A[K.id]=A[K.id]||{sourceCache:K,layers:{},has3DLayers:!1};H.is3D(!!this.terrain)&&(X.has3DLayers=!0),X.layers[H.fqid]=X.layers[H.fqid]||{styleLayer:H,targets:[]},X.layers[H.fqid].targets.push({filter:S})};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new a.z(new Error("parameters.layers must be an Array."))),[];for(const H of u.layers){const K=this._layers[H];if(!K)return this.fire(new a.z(new Error(`The layer '${H}' does not exist in the map's style and cannot be queried for features.`))),[];M(K)}}else for(const H in this._layers)M(this._layers[H]);const D=this._queryRenderedFeatures(s,A,y),z=this._flattenAndSortRenderedFeatures(D),U=[];for(const H of z)a.de(H.layer.id)===this.scope&&U.push(H);return U}queryRenderedFeatureset(s,u,y){let S;u&&!Array.isArray(u)&&u.filter&&(this._validate(le,"queryRenderedFeatures.filter",u.filter,null,u),S=a.b3(u.filter));const A="mock",M=[];if(u&&u.target)M.push(Object.assign({},u,{targetId:A,filter:S}));else{const H=this.getFeaturesetDescriptors();for(const K of H)M.push({targetId:A,filter:S,target:K});for(const{style:K}of this.fragments){const X=K.getFeaturesetDescriptors();for(const J of X)M.push({targetId:A,filter:S,target:J})}}const D=this.queryRenderedTargets(s,M,y),z=[],U=new Set;for(const H of D)for(const K of H.variants[A])af(K,H,U)||z.push(new a.df(H,K));return z}queryRenderedTargets(s,u,y){const S={},A=(D,z,U,H)=>{const K=S[z.id]=S[z.id]||{sourceCache:z,layers:{},has3DLayers:!1};if(K.layers[D.fqid]=K.layers[D.fqid]||{styleLayer:D,targets:[]},D.is3D(!!this.terrain)&&(K.has3DLayers=!0),!H)return U.uniqueFeatureID=!1,void K.layers[D.fqid].targets.push(U);K.layers[D.fqid].targets.push(Object.assign({},U,{namespace:H.namespace,properties:H.properties,uniqueFeatureID:H.uniqueFeatureID}))};for(const D of u)if("featuresetId"in D.target){const{featuresetId:z,importId:U}=D.target,H=this.getFragmentStyle(U);if(!H||!H._featuresetSelectors)continue;const K=H._featuresetSelectors[z];if(!K){this.fire(new a.z(new Error(`The featureset '${z}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const X of K){const J=H.getOwnLayer(X.layerId);J&&!Nc.has(J.type)&&A(J,H.getOwnLayerSourceCache(J),D,X)}}else if("layerId"in D.target){const{layerId:z}=D.target,U=this.getLayer(z);if(!U||Nc.has(U.type))continue;A(U,this.getLayerSourceCache(U),D)}const M=this._queryRenderedFeatures(s,S,y);return this._flattenAndSortRenderedFeatures(M)}_queryRenderedFeatures(s,u,y){const S=[],A=!!this.map._showQueryGeometry,M=ea.createFromScreenPoints(s,y);for(const D in u){const z=Cc(M,u[D],this._availableImages,y,A);Object.keys(z).length&&S.push(z)}if(this.placement)for(const D in u){if(!u[D].sourceCache._onlySymbols)continue;const z=dp(M.screenGeometry,u[D],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(z).length&&S.push(z)}return S}querySourceFeatures(s,u){const y=u&&u.filter;y&&this._validate(le,"querySourceFeatures.filter",y,null,u);let S=[];const A=this.getOwnSourceCaches(s);for(const M of A)S=S.concat(Do(M,u));return S}addSourceType(s,u,y){return il.getSourceType(s)?y(new Error(`A source type called "${s}" already exists.`)):(il.setSourceType(s,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:s,url:u.workerSourceURL},y):y(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(s,u,y={}){this._checkLoaded();const S=this.light.getLight();let A=!1;for(const D in s)if(!a.bv(s[D],S[D])){A=!0;break}if(!A)return;const M=this._getTransitionParameters();this.light.setLight(s,u,y),this.light.updateTransitions(M)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=a.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&a.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(s,u=1){if(this._checkLoaded(),!s)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),u===0&&delete this.terrain,s===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let y=s;const S=s.source==null;if(u===1){if(this.disableElevatedTerrain)return;if(typeof y.source=="object"){const D="terrain-dem-src";this.addSource(D,y.source),y=a.d7(y),y=a.l(y,{source:D})}const A=a.l({},y),M={};if(this.terrain&&S){A.source=this.terrain.get().source;const D=this.terrain?this.getFragmentStyle(this.terrain.scope):null;D&&(M.style=D.serialize())}if(this._validate(Kt,"terrain",A,M))return}if(!this.terrain||this.terrain.scope!==this.scope&&!S||this.terrain&&u!==this.terrain.drapeRenderMode){if(!y)return;this._createTerrain(y,u),this.fire(new a.A("data",{dataType:"style"}))}else{const A=this.terrain,M=A.get();for(const D of Object.keys(a.a5.terrain))!y.hasOwnProperty(D)&&a.a5.terrain[D].default&&(y[D]=a.a5.terrain[D].default);for(const D in s)if(!a.bv(s[D],M[D])){A.set(s,this.options),this.stylesheet.terrain=s;const z=this._getTransitionParameters({duration:0});A.updateTransitions(z),this.fire(new a.A("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(s){const u=this.fog=new cr(s,this.map.transform,this.scope,this.options);this.stylesheet.fog=u.get();const y=this._getTransitionParameters({duration:0});u.updateTransitions(y)}_createSnow(s){const u=this.snow=new Jr(s,this.map.transform,this.scope,this.options);this.stylesheet.snow=u.get();const y=this._getTransitionParameters({duration:0});u.updateTransitions(y)}_createRain(s){const u=this.rain=new mi(s,this.map.transform,this.scope,this.options);this.stylesheet.rain=u.get();const y=this._getTransitionParameters({duration:0});u.updateTransitions(y)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const s of this.map._markers)s._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(s){if(this._checkLoaded(),!s)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog;if(!a.bv(u.get(),s)){u.set(s,this.options),this.stylesheet.fog=u.get();const y=this._getTransitionParameters({duration:0});u.updateTransitions(y)}}else this._createFog(s);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(s){if(this._checkLoaded(),!s)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const u=this.snow;if(!a.bv(u.get(),s)){u.set(s,this.options),this.stylesheet.snow=u.get();const y=this._getTransitionParameters({duration:0});u.updateTransitions(y)}}else this._createSnow(s);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(s){if(this._checkLoaded(),!s)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const u=this.rain;if(!a.bv(u.get(),s)){u.set(s,this.options),this.stylesheet.rain=u.get();const y=this._getTransitionParameters({duration:0});u.updateTransitions(y)}}else this._createRain(s);this._markersNeedUpdate=!0}_reloadColorTheme(){const s=()=>{for(const S in this._layers)this._layers[S].lut=this._styleColorTheme.lut;for(const S in this._sourceCaches)this._sourceCaches[S].clearTiles()},u=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!u)return this._styleColorTheme.lut=null,void s();const y=this._evaluateColorThemeData(u);this._loadColorTheme(y).then(()=>{this.fire(new a.A("colorthemeset")),s()}).catch(S=>{a.w(`Couldn't set color theme: ${S}`)})}setColorTheme(s){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&a.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=s,this._reloadColorTheme()}setImportColorTheme(s,u){const y=this.getFragmentStyle(s);y&&(y._styleColorTheme.colorThemeOverride=u,y._reloadColorTheme())}_getTransitionParameters(s){return{now:a.q.now(),transition:a.l(this.transition,s)}}updateDrapeFirstLayers(){if(!this.terrain)return;const s=[],u=[];for(const y of this._mergedOrder)this.isLayerDraped(this._mergedLayers[y])?s.push(y):u.push(y);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...s),this._drapedFirstOrder.push(...u)}_createTerrain(s,u){const y=this.terrain=new it(s,u,this.scope,this.options);u===1&&(this.stylesheet.terrain=s),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const S=this._getTransitionParameters({duration:0});y.updateTransitions(S)}_force3DLayerUpdate(){for(const s in this._layers){const u=this._layers[s];u.type==="fill-extrusion"&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const s in this._layers){const u=this._layers[s];u.type==="symbol"&&this._updateLayer(u)}}_validate(s,u,y,S,A={}){if(A&&A.validate===!1)return!1;const M=a.l({},this.serialize());return zo(this,s.call(ks,a.l({key:u,style:M,value:y,styleSpec:a.a5},S)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.dg.off("pluginStateChange",this._rtlTextPluginCallback);for(const s in this._mergedLayers)this._mergedLayers[s].setEventedParent(null);for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles(),this._mergedSourceCaches[s].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(s){const u=this.getSourceCaches(s);for(const y of u)y.clearTiles()}clearSources(){for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles()}reloadSource(s){const u=this.getSourceCaches(s);for(const y of u)y.resume(),y.reload()}reloadSources(){for(const s of this.getSources())s.reload&&s.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(s=>{s.modelManager.reloadModels(s.scope)})}updateSources(s){let u;this.directionalLight&&(u=Km(this.directionalLight));const y=new Set;for(const S in this._mergedLayers){const A=this._mergedLayers[S];A.hasElevation()&&!y.has(A.source)&&y.add(A.source)}for(const S in this._mergedSourceCaches){const A=this._mergedSourceCaches[S],M=y.has(A._source.id);A.update(s,void 0,void 0,u,M)}}_generateCollisionBoxes(){for(const s in this._sourceCaches){const u=this._sourceCaches[s];u.resume(),u.reload()}}_updatePlacement(s,u,y,S,A,M,D=!1){let z=!1,U=!1;const H={},K={};for(const X of this._mergedOrder){const J=this._mergedLayers[X];if(J.type!=="symbol")continue;const de=a.C(J.source,J.scope);let ce=H[de];if(!ce){const ue=this.getLayerSourceCache(J);if(!ue)continue;const ve=ue.getRenderableIds(!0).map(Ee=>ue.getTileByID(Ee));K[de]=ve.slice(),ce=H[de]=ve.sort((Ee,Pe)=>Pe.tileID.overscaledZ-Ee.tileID.overscaledZ||(Ee.tileID.isLessThan(Pe.tileID)?-1:1))}const fe=this.crossTileSymbolIndex.addLayer(J,ce,u.center.lng,u.projection);z=z||fe}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),D=D||this._layerOrderChanged||S===0,this._layerOrderChanged&&this.fire(new a.A("neworder")),(D||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.q.now(),u.zoom))&&(this.pauseablePlacement=new Rs(u,this._mergedOrder,D,y,S,A,this.placement,this.fog&&u.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,H,K,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.q.now()),U=!0),z&&this.pauseablePlacement.placement.setStale()),U||z){this._buildingIndex.onNewFrame(u.zoom);for(let X=0;X<this._mergedOrder.length;X++){const J=this._mergedLayers[this._mergedOrder[X]];if(J.type!=="symbol")continue;const de=this.isLayerClipped(J);this.placement.updateLayerOpacities(J,H[a.C(J.source,J.scope)],X,de?M:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.q.now())}}_releaseSymbolFadeTiles(){for(const s in this._sourceCaches)this._sourceCaches[s].releaseSymbolFadeTiles()}addImport(s,u){this._checkLoaded();const y=this.stylesheet.imports=this.stylesheet.imports||[];if(y.findIndex(({id:A})=>A===s.id)!==-1)return void this.fire(new a.z(new Error(`Import with id '${s.id}' already exists in the map's style.`)));if(!u)return y.push(s),this._loadImports([s],!0);const S=y.findIndex(({id:A})=>A===u);return S===-1&&this.fire(new a.z(new Error(`Import with id "${u}" does not exist on this map.`))),this.stylesheet.imports=y.slice(0,S).concat(s).concat(y.slice(S)),this._loadImports([s],!0,u)}updateImport(s,u){this._checkLoaded();const y=this.stylesheet.imports||[],S=this.getImportIndex(s);return S===-1?this:typeof u=="string"?(this.setImportUrl(s,u),this):(u.url&&u.url!==y[S].url&&this.setImportUrl(s,u.url),a.bv(u.config,y[S].config)||this.setImportConfig(s,u.config,u.data.schema),a.bv(u.data,y[S].data)||this.setImportData(s,u.data),this)}moveImport(s,u){this._checkLoaded();let y=this.stylesheet.imports||[];const S=this.getImportIndex(s);if(S===-1)return this;const A=this.getImportIndex(u);if(A===-1)return this;const M=y[S],D=this.fragments[S];return y=y.filter(({id:z})=>z!==s),this.fragments=this.fragments.filter(({id:z})=>z!==s),this.stylesheet.imports=y.slice(0,A).concat(M).concat(y.slice(A)),this.fragments=this.fragments.slice(0,A).concat(D).concat(this.fragments.slice(A)),this.mergeLayers(),this}setImportUrl(s,u){this._checkLoaded();const y=this.stylesheet.imports||[],S=this.getImportIndex(s);if(S===-1)return this;y[S].url=u;const A=this.fragments[S];return A.style=this._createFragmentStyle(y[S]),A.style.on("style.import.load",()=>this.mergeAll()),A.style.loadURL(u),this}setImportData(s,u){this._checkLoaded();const y=this.getImportIndex(s),S=this.stylesheet.imports||[];return y===-1?this:u?(this.fragments[y].style.setState(u),this._reloadImports(),this):(delete S[y].data,this.setImportUrl(s,S[y].url))}setImportConfig(s,u,y){this._checkLoaded();const S=this.getImportIndex(s),A=this.stylesheet.imports||[];if(S===-1)return this;u?A[S].config=u:delete A[S].config;const M=this.fragments[S];y&&M.style.stylesheet&&(M.style.stylesheet.schema=y);const D=M.style.stylesheet&&M.style.stylesheet.schema;return M.config=u,M.style.updateConfig(u,D),this.updateConfigDependencies(),this}removeImport(s){this._checkLoaded();const u=this.stylesheet.imports||[],y=this.getImportIndex(s);y!==-1&&(u.splice(y,1),this.fragments[y].style._remove(),this.fragments.splice(y,1),this._reloadImports())}getImportIndex(s){const u=(this.stylesheet.imports||[]).findIndex(y=>y.id===s);return u===-1&&this.fire(new a.z(new Error(`Import '${s}' does not exist in the map's style and cannot be updated.`))),u}getLayer(s){return this._mergedLayers[s]}getSources(){const s=[];for(const u in this._mergedOtherSourceCaches){const y=this._mergedOtherSourceCaches[u];y&&s.push(y.getSource())}return s}getSource(s,u){const y=this.getSourceCache(s,u);return y&&y.getSource()}getLayerSource(s){const u=this.getLayerSourceCache(s);return u&&u.getSource()}getSourceCache(s,u){const y=a.C(s,u);return this._mergedOtherSourceCaches[y]}getLayerSourceCache(s){const u=a.C(s.source,s.scope);return s.type==="symbol"?this._mergedSymbolSourceCaches[u]:this._mergedOtherSourceCaches[u]}getSourceCaches(s){if(s==null)return Object.values(this._mergedSourceCaches);const u=[];return this._mergedOtherSourceCaches[s]&&u.push(this._mergedOtherSourceCaches[s]),this._mergedSymbolSourceCaches[s]&&u.push(this._mergedSymbolSourceCaches[s]),u}updateSourceCaches(){const s=this._changes.getUpdatedSourceCaches();for(const u in s){const y=s[u];y==="reload"?this.reloadSource(u):y==="clear"&&this.clearSource(u)}}updateLayers(s){const u=this._changes.getUpdatedPaintProperties();for(const y of u){const S=this.getLayer(y);S&&S.updateTransitions(s)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(s){this.stylesheet.glyphs=s,this.glyphManager.setURL(s,this.scope)}getImages(s,u,y){this.imageManager.getImages(u.images,u.scope,y),this._updateTilesForChangedImages();const S=M=>{if(M){const D=u.images.map(z=>a.I.toString(z));M.setDependencies(u.tileID.key,u.type,D)}},A=a.C(u.source,u.scope);S(this._mergedOtherSourceCaches[A]),S(this._mergedSymbolSourceCaches[A])}rasterizeImages(s,u,y){this.imageManager.rasterizeImages(u,y)}getGlyphs(s,u,y){this.glyphManager.getGlyphs(u.stacks,u.scope,y)}getResource(s,u,y){return a.dh(u,y)}getOwnSourceCache(s){return this._otherSourceCaches[s]}getOwnLayerSourceCache(s){return s.type==="symbol"?this._symbolSourceCaches[s.source]:this._otherSourceCaches[s.source]}getOwnSourceCaches(s){const u=[];return this._otherSourceCaches[s]&&u.push(this._otherSourceCaches[s]),this._symbolSourceCaches[s]&&u.push(this._symbolSourceCaches[s]),u}_isSourceCacheLoaded(s){const u=this.getOwnSourceCaches(s);return u.length===0?(this.fire(new a.z(new Error(`There is no source with ID '${s}'`))),!1):u.every(y=>y.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(s,u){if(!this._clipLayerPresent&&s.type!=="fill-extrusion")return!1;const y=s.type==="fill-extrusion"&&s.sourceLayer==="building";if(s.is3D(!!this.terrain)){if(y||u&&u.type==="batched-model"||s.type==="model")return!0}else if(s.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(s=>{s.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}il.getSourceType=function(x){return nf[x]},il.setSourceType=function(x,s){nf[x]=s},il.registerForPluginStateChange=a.c$;var oh=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,ff=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Cx=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,tg="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Lo=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Ap=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,en=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,al=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Cp=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,xo=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Fo=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return clamp(mix(lerpx.x,lerpx.y,f.y),0.0,1.0);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Cl=[];ch(oh,Cl),ch(Cx,Cl),ch(ff,Cl);const Bo={"_prelude_fog.vertex.glsl":Ap,"_prelude_terrain.vertex.glsl":Lo,"_prelude_shadow.vertex.glsl":xo,"_prelude_fog.fragment.glsl":en,"_prelude_shadow.fragment.glsl":Fo,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":al,"_prelude_raster_particle.glsl":Cp},iu={};jr("",Lo),jr(en,Ap),jr(Fo,xo),jr(al,""),jr(Cp,"");const ic=jr(ff,Cx),lh=oh;var jl={background:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in highp vec3 v_normal;in highp float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
uniform lowp float u_opacity;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 apply_lighting_linear(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec4 color=vec4(v_color.rgb,1.0);vec3 normal=normalize(v_normal);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
shadowed_lighting_factor=dot(normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=mix(color.rgb,v_color.rgb,v_color.a);color*=u_opacity;
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_height));
#endif
#ifdef RENDER_CUTOFF
color*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_height);
#endif
glFragColor=vec4(linearTosRGB(color.rgb),color.a);
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3f;out vec4 v_color;out highp vec3 v_normal;out highp float v_height;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));vec3 pos=a_pos_3f;v_height=pos.z;gl_Position=u_matrix*vec4(pos,1.0);
#ifdef RENDER_SHADOWS
vec3 shadow_pos=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);v_depth_shadows=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),buildingDepth:jr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:jr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:jr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:jr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:jr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:jr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:jr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:jr(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:jr(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
void main() {vec3 color=vec3(241.0/255.0,236.0/255.0,225.0/255.0);
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,normal);
#endif
if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(v_normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:jr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:jr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:jr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:jr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:jr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:jr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:jr(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:jr(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(abs(v_z_offset) > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
#endif
}`),terrainRaster:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:jr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:jr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,tg),skyboxGradient:jr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,tg),skyboxCapture:jr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:jr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:jr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:jr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:jr("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:jr("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:jr("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:jr("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function ch(x,s){const u=x.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let y of u)if(y=y.trim(),y[0]==="#"&&y.includes("if")&&!y.includes("endif")){y=y.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const S=y.split(" ");for(const A of S)s.includes(A)||s.push(A)}}function jr(x,s){const u=/#include\s+"([^"]+)"/g,y=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let S=s.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);S&&(S=S.map(U=>{const H=U.split(" ");return H[H.length-1]}),S=[...new Set(S)]);const A={},M=[],D=[];if(x=x.replace(u,(U,H)=>(D.push(H),"")),(s=s.replace(u,(U,H)=>(M.push(H),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let z=[...Cl];ch(x,z),ch(s,z);for(const U of[...M,...D])Bo[U]||console.error(`Undefined include: ${U}`),iu[U]||(iu[U]=[],ch(Bo[U],iu[U])),z=[...z,...iu[U]];return{fragmentSource:x=x.replace(y,(U,H,K,X,J)=>(A[J]=!0,H==="define"?`
#ifndef HAS_UNIFORM_u_${J}
in ${K} ${X} ${J};
#else
uniform ${K} ${X} u_${J};
#endif
`:H==="initialize"?`
#ifdef HAS_UNIFORM_u_${J}
    ${K} ${X} ${J} = u_${J};
#endif
`:H==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${J}
    in ${K} ${X} ${J};
#endif
`:H==="initialize-attribute"?"":void 0)),vertexSource:s=s.replace(y,(U,H,K,X,J)=>{const de=X==="float"?"vec2":X,ce=J.match(/color/)?"color":de;return H==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${J}
in ${K} ${X} a_${J};
#endif
`:A[J]?H==="define"?`
#ifndef HAS_UNIFORM_u_${J}
uniform lowp float u_${J}_t;
in ${K} ${de} a_${J};
out ${K} ${X} ${J};
#else
uniform ${K} ${X} u_${J};
#endif
`:H==="initialize"?ce==="vec4"?`
#ifndef HAS_UNIFORM_u_${J}
    ${J} = a_${J};
#else
    ${K} ${X} ${J} = u_${J};
#endif
`:`
#ifndef HAS_UNIFORM_u_${J}
    ${J} = unpack_mix_${ce}(a_${J}, u_${J}_t);
#else
    ${K} ${X} ${J} = u_${J};
#endif
`:H==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${J}
    in ${K} ${X} a_${J};
    out ${K} ${X} ${J};
#endif
`:H==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${J}
    ${J} = a_${J};
#endif
`:void 0:H==="define"?`
#ifndef HAS_UNIFORM_u_${J}
uniform lowp float u_${J}_t;
in ${K} ${de} a_${J};
#else
uniform ${K} ${X} u_${J};
#endif
`:H==="define-instanced"?ce==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${J}0;
in vec4 a_${J}1;
in vec4 a_${J}2;
in vec4 a_${J}3;
#else
uniform ${K} ${X} u_${J};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${K} ${de} a_${J};
#else
uniform ${K} ${X} u_${J};
#endif
`:H==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${J}
    ${K} ${X} ${J} = a_${J};
#endif
`:ce==="vec4"?`
#ifndef HAS_UNIFORM_u_${J}
    ${K} ${X} ${J} = a_${J};
#else
    ${K} ${X} ${J} = u_${J};
#endif
`:`
#ifndef HAS_UNIFORM_u_${J}
    ${K} ${X} ${J} = unpack_mix_${ce}(a_${J}, u_${J}_t);
#else
    ${K} ${X} ${J} = u_${J};
#endif
`}),staticAttributes:S,usedDefines:z,vertexIncludes:M,fragmentIncludes:D}}class Gu{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(s,u,y,S,A,M,D,z){this.context=s;let U=this.boundPaintVertexBuffers.length!==S.length;for(let K=0;!U&&K<S.length;K++)this.boundPaintVertexBuffers[K]!==S[K]&&(U=!0);let H=this.boundDynamicVertexBuffers.length!==D.length;for(let K=0;!H&&K<D.length;K++)this.boundDynamicVertexBuffers[K]!==D[K]&&(H=!0);if(!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==y||U||H||this.boundIndexBuffer!==A||this.boundVertexOffset!==M)this.freshBind(u,y,S,A,M,D,z);else{s.bindVertexArrayOES.set(this.vao);for(const K of D)K&&(K.bind(),z&&K.instanceCount&&K.setVertexAttribDivisor(s.gl,u,z));A&&A.dynamicDraw&&A.bind()}}freshBind(s,u,y,S,A,M,D){const z=s.numAttributes,U=this.context,H=U.gl;this.vao&&this.destroy(),this.vao=U.gl.createVertexArray(),U.bindVertexArrayOES.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=S,this.boundVertexOffset=A,this.boundDynamicVertexBuffers=M,u.enableAttributes(H,s),u.bind(),u.setVertexAttribPointers(H,s,A);for(const K of y)K.enableAttributes(H,s),K.bind(),K.setVertexAttribPointers(H,s,A);for(const K of M)K&&(K.enableAttributes(H,s),K.bind(),K.setVertexAttribPointers(H,s,A),D&&K.instanceCount&&K.setVertexAttribDivisor(H,s,D));S&&S.bind(),U.currentNumAttributes=z}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function U_(x,s){const u=Math.pow(2,s.canonical.z),y=s.canonical.y;return[new a.ac(0,y/u).toLngLat().lat,new a.ac(0,(y+1)/u).toLngLat().lat]}function Vo(x,s,u,y,S,A,M){const D=x.context,z=D.gl,U=u.hillshadeFBO;if(!U)return;x.prepareDrawTile();const H=x.isTileAffectedByFog(s),K=x.getOrCreateProgram("hillshade",{overrideFog:H});D.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,U.colorAttachment.get());const X=((fe,ue,ve,Ee)=>{const Pe=ve.paint.get("hillshade-shadow-color"),ze=ve.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Ie=ve.paint.get("hillshade-highlight-color"),Oe=ve.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Ce=ve.paint.get("hillshade-accent-color"),Fe=ve.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",$e=ve.paint.get("hillshade-emissive-strength");let st=a.al(ve.paint.get("hillshade-illumination-direction"));if(ve.paint.get("hillshade-illumination-anchor")==="viewport")st-=fe.transform.angle;else if(fe.style&&fe.style.enable3dLights()&&fe.style.directionalLight){const _t=fe.style.directionalLight.properties.get("direction"),xt=a.cR(_t.x,_t.y,_t.z);st=a.al(xt[1])}const et=!fe.options.moving;return{u_matrix:Ee||fe.transform.calculateProjMatrix(ue.tileID.toUnwrapped(),et),u_image:0,u_latrange:U_(0,ue.tileID),u_light:[ve.paint.get("hillshade-exaggeration"),st],u_shadow:Pe.toRenderColor(ze?null:ve.lut),u_highlight:Ie.toRenderColor(Oe?null:ve.lut),u_emissive_strength:$e,u_accent:Ce.toRenderColor(Fe?null:ve.lut)}})(x,u,y,x.terrain?s.projMatrix:null);x.uploadCommonUniforms(D,K,s.toUnwrapped());const{tileBoundsBuffer:J,tileBoundsIndexBuffer:de,tileBoundsSegments:ce}=x.getTileBoundsBuffers(u);K.draw(x,z.TRIANGLES,S,A,M,Jn.disabled,X,y.id,J,de,ce)}function jp(x,s,u){if(!s.needsDEMTextureUpload)return;const y=x.context,S=y.gl;y.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||x.getTileTexture(u.stride);const A=u.getPixels();s.demTexture?s.demTexture.update(A,{premultiply:!1}):s.demTexture=new a.T(y,A,S.R32F,{premultiply:!1}),s.needsDEMTextureUpload=!1}function ac(x,s,u){const y=x.context,S=y.gl;if(!s.dem)return;const A=s.dem;if(y.activeTexture.set(S.TEXTURE1),jp(x,s,A),!s.demTexture)return;s.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);const M=A.dim;y.activeTexture.set(S.TEXTURE0);let D=s.hillshadeFBO;if(!D){const X=new a.T(y,{width:M,height:M,data:null},S.RGBA8);X.bind(S.LINEAR,S.CLAMP_TO_EDGE),D=s.hillshadeFBO=y.createFramebuffer(M,M,!0,"renderbuffer"),D.colorAttachment.set(X.texture)}y.bindFramebuffer.set(D.framebuffer),y.viewport.set([0,0,M,M]);const{tileBoundsBuffer:z,tileBoundsIndexBuffer:U,tileBoundsSegments:H}=x.getMercatorTileBoundsBuffers(),K=[];x.linearFloatFilteringSupported()&&K.push("TERRAIN_DEM_FLOAT_FORMAT"),x.getOrCreateProgram("hillshadePrepare",{defines:K}).draw(x,S.TRIANGLES,_n.disabled,Kn.disabled,pr.unblended,Jn.disabled,((X,J)=>{const de=J.stride,ce=a.bz();return a.c5(ce,0,a.aj,-a.aj,0,0,1),a.bo(ce,ce,[0,-a.aj,0]),{u_matrix:ce,u_image:1,u_dimension:[de,de],u_zoom:X.overscaledZ}})(s.tileID,A),u.id,z,U,H),s.needsHillshadePrepare=!1}class Ki{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ng extends Ki{getDefault(){return a.am.transparent}set(s){const u=this.current;(s.r!==u.r||s.g!==u.g||s.b!==u.b||s.a!==u.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class uh extends Ki{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class jx extends Ki{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class rg extends Ki{getDefault(){return[!0,!0,!0,!0]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||s[3]!==u[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class pf extends Ki{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class au extends Ki{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class ig extends Ki{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const u=this.current;(s.func!==u.func||s.ref!==u.ref||s.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class Mp extends Ki{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class Uo extends Ki{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=s,this.dirty=!1}}class yo extends Ki{getDefault(){return[0,1]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class su extends Ki{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=s,this.dirty=!1}}class vo extends Ki{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class sc extends Ki{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.BLEND):u.disable(u.BLEND),this.current=s,this.dirty=!1}}class Wu extends Ki{getDefault(){const s=this.gl;return[s.ONE,s.ZERO,s.ONE,s.ZERO]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||s[3]!==u[3]||this.dirty)&&(this.gl.blendFuncSeparate(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class dh extends Ki{getDefault(){return a.am.transparent}set(s){const u=this.current;(s.r!==u.r||s.g!==u.g||s.b!==u.b||s.a!==u.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class hh extends Ki{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(s,s),this.current=s,this.dirty=!1)}}class mf extends Ki{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=s,this.dirty=!1}}class ws extends Ki{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class ma extends Ki{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}let Hi=class extends Ki{getDefault(){return null}set(x){(x!==this.current||this.dirty)&&(this.gl.useProgram(x),this.current=x,this.dirty=!1)}};class ou extends Ki{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class oc extends Ki{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||s[3]!==u[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Pp extends Ki{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class Dc extends Ki{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class gf extends Ki{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class Mx extends Ki{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class xf extends Ki{getDefault(){return null}set(s){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class yf extends Ki{getDefault(){return null}set(s){this.gl&&(s!==this.current||this.dirty)&&(this.gl.bindVertexArray(s),this.current=s,this.dirty=!1)}}class fh extends Ki{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class vf extends Ki{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class Px extends Ki{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class lu extends Ki{constructor(s,u){super(s),this.context=s,this.parent=u}getDefault(){return null}}class cu extends lu{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class lc extends lu{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class cc extends lu{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,this.attachment(),u.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class Np extends lc{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const Dp=(x,s,u)=>({u_matrix:x,u_image0:0,u_skirt_height:s,u_ground_shadow_factor:u}),ph=(x,s,u,y,S,A,M,D,z,U,H,K,X,J,de,ce)=>({u_proj_matrix:Float32Array.from(x),u_globe_matrix:s,u_normalize_matrix:Float32Array.from(y),u_merc_matrix:u,u_zoom_transition:S,u_merc_center:A,u_image0:0,u_frustum_tl:M,u_frustum_tr:D,u_frustum_br:z,u_frustum_bl:U,u_globe_pos:H,u_globe_radius:K,u_viewport:X,u_grid_matrix:ce?Float32Array.from(ce):new Float32Array(9),u_skirt_height:J,u_far_z_cutoff:de});function _f(x,s){return x!=null&&s!=null&&!(!x.hasData()||!s.hasData())&&x.demTexture!=null&&s.demTexture!=null&&x.tileID.key!==s.tileID.key}const Ml=new class{constructor(){this.operations={}}newMorphing(x,s,u,y,S){if(x in this.operations){const A=this.operations[x];A.to.tileID.key!==u.tileID.key&&(A.queued=u)}else this.operations[x]={startTime:y,phase:0,duration:S,from:s,to:u,queued:null}}getMorphValuesForProxy(x){if(!(x in this.operations))return null;const s=this.operations[x];return{from:s.from,to:s.to,phase:s.phase}}update(x){for(const s in this.operations){const u=this.operations[s];for(u.phase=(x-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,x)){delete this.operations[s];break}}}_nextOp(x,s){return!!x.queued&&(x.from=x.to,x.to=x.queued,x.queued=null,x.phase=0,x.startTime=s,!0)}_validOp(x){return x.from.hasData()&&x.to.hasData()}},Ya={0:null,1:"TERRAIN_VERTEX_MORPHING"};function uu(x,s,u){if(s===0)return 0;const y=s<1&&u===514?.25/s:1;return 6*Math.pow(1.5,22-x)*Math.max(s,1)*y}function Nx(x,s){const u=1<<x.z;return!s&&(x.x===0||x.x===u-1)||x.y===0||x.y===u-1}const _o=x=>({u_matrix:x});function Op(x,s,u,y,S){if(S>0){const A=a.q.now(),M=(A-x.timeAdded)/S,D=s?(A-s.timeAdded)/S:-1,z=u.getSource(),U=y.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),H=!s||Math.abs(s.tileID.overscaledZ-U)>Math.abs(x.tileID.overscaledZ-U),K=H&&x.refreshedUponExpiration?1:a.aD(H?M:1-D,0,1);return x.refreshedUponExpiration&&M>=1&&(x.refreshedUponExpiration=!1),s?{opacity:1,mix:1-K}:{opacity:K,mix:0}}return{opacity:1,mix:0}}class ag extends _s{constructor(s){const u={type:"raster-dem",maxzoom:s.transform.maxZoom},y=new a.D(a.d0(),null),S=rf("mock-dem",u,y,s.style);super("mock-dem",S,!1),S.setEventedParent(this),this._sourceLoaded=!0}_loadTile(s,u){s.state="loaded",u(null)}}class $a extends _s{constructor(s){const u=rf("proxy",{type:"geojson",maxzoom:s.transform.maxZoom},new a.D(a.d0(),null),s.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=s,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(s,u,y){if(s.freezeTileCoverage)return;this.transform=s;const S=s.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((A,M)=>{if(A[M.key]="",!this._tiles[M.key]){const D=new Ql(M,this._source.tileSize*M.overscaleFactor(),s.tileZoom);D.state="loaded",this._tiles[M.key]=D}return A},{});for(const A in this._tiles)A in S||(this.freeFBO(A),this._tiles[A].unloadVectorData(),delete this._tiles[A])}freeFBO(s){const u=this.proxyCachedFBO[s];if(u!==void 0){const y=Object.values(u);this.renderCachePool.push(...y),delete this.proxyCachedFBO[s]}}deallocRenderCache(){this.renderCache.forEach(s=>s.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class bf extends a.aM{constructor(s,u,y){super(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,s.canonical.y),this.proxyTileKey=u,this.projMatrix=y}}class Zu extends a.dt{constructor(s,u){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},s.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=s,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[y,S,A]=function(z){const U=new a.ba,H=new a.a_,K=131;U.reserve(17161),H.reserve(33800);const X=a.aj/128,J=a.aj+X/2,de=J+X;for(let fe=-X;fe<de;fe+=X)for(let ue=-X;ue<de;ue+=X){const ve=ue<0||ue>J||fe<0||fe>J?24575:0,Ee=a.aD(Math.round(ue),0,a.aj),Pe=a.aD(Math.round(fe),0,a.aj);U.emplaceBack(Ee+ve,Pe)}const ce=(fe,ue)=>{const ve=ue*K+fe;H.emplaceBack(ve+1,ve,ve+K),H.emplaceBack(ve+K,ve+K+1,ve+1)};for(let fe=1;fe<129;fe++)for(let ue=1;ue<129;ue++)ce(ue,fe);return[0,129].forEach(fe=>{for(let ue=0;ue<130;ue++)ce(ue,fe),ce(fe,ue)}),[U,H,32768]}(),M=s.context;this.gridBuffer=M.createVertexBuffer(y,a.bc.members),this.gridIndexBuffer=M.createIndexBuffer(S),this.gridSegments=a.bd.simpleSegment(0,0,y.length,S.length),this.gridNoSkirtSegments=a.bd.simpleSegment(0,0,y.length,A),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new $a(u.map),this.orthoMatrix=a.bz(),a.c5(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,a.aj,0,a.aj,0,1);const D=M.gl;this._overlapStencilMode=new Kn({func:D.GEQUAL,mask:255},0,255,D.KEEP,D.KEEP,D.REPLACE),this._previousZoom=s.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new ag(u.map),this._pendingGroundEffectLayers=[]}set style(s){s.on("data",this._onStyleDataEvent.bind(this)),this._style=s,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(s,u,y){if(s&&s.terrain){this._style!==s&&(this.style=s,this._evaluationZoom=void 0);const S=s.terrain.properties,A=s.terrain.drapeRenderMode===0,M=s.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=a.q.now();const D=s.terrain&&s.terrain.scope,z=S.get("source"),U=A?this._mockSourceCache:s.getSourceCache(z,D);if(!U)return void a.w(`Couldn't find terrain source "${z}".`);if(this.sourceCache=U,this._attenuationRange=s.terrain.getAttenuationRange(),this._exaggeration=M?this.calculateExaggeration(u):S.get("exaggeration"),!u.projection.requiresDraping&&M&&this._exaggeration===0)return void this._disable();this.enabled=!0;const H=()=>{this.sourceCache.used&&a.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const K=this.getScaledDemTileSize();this.sourceCache.update(u,K,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,H(),this._initializing=!0),H(),u.updateElevation(!0,y),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0,this._previousZoom=u.zoom}else this._disable()}calculateExaggeration(s){if(this._attenuationRange&&s.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(s.zoom);const u=this._previousCameraAltitude,y=s.getFreeCameraOptions().position.z/s.pixelsPerMeter*s.worldSize;this._previousCameraAltitude=y;const S=u!=null?y-u:Number.MAX_VALUE;if(Math.abs(S)<2)return this._exaggeration;const A=s.zoom,M=this._style.terrain;if(!this._previousUpdateTimestamp)return M.getExaggeration(A);let D=A-this._previousZoom;const z=this._previousUpdateTimestamp;let U=A;this._evaluationZoom!=null&&(U=this._evaluationZoom,Math.abs(A-U)>.5&&(D=.5*(A-U+D)),D*S<0&&(U+=D)),this._evaluationZoom=U;const H=M.getExaggeration(U),K=H===M.getExaggeration(Math.max(0,U-.1));if(K&&Math.abs(H-this._exaggeration)<.01)return H;let X=Math.min(.1,.00375*(this._updateTimestamp-z));return(K||H<.1||Math.abs(D)<1e-4)&&(X=Math.min(.2,4*X)),a.ai(this._exaggeration,H,X)}resetTileLookupCache(s){this._findCoveringTileCache[s]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(s){s.coord&&s.dataType==="source"?this._clearRenderCacheForTile(s.sourceCacheId,s.coord):s.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const s in this._style._mergedSourceCaches)this._style._mergedSourceCaches[s].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(s=>s.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const s=2*this.proxySourceCache.getSource().tileSize;return[s,s]}set useVertexMorphing(s){this._useVertexMorphing=s}updateTileBinding(s){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,y=this.painter.transform;this._initializing&&(this._initializing=y._centerAltitude===0&&this.getAtPointOrZero(a.ac.fromLngLat(y.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const S=this.proxyCoords=u.getIds().map(z=>{const U=u.getTileByID(z).tileID;return U.projMatrix=y.calculateProjMatrix(U.toUnwrapped()),U});(function(z,U){const H=U.transform.pointCoordinate(U.transform.getCameraPoint()),K=new a.P(H.x,H.y);z.sort((X,J)=>{if(J.overscaledZ-X.overscaledZ)return J.overscaledZ-X.overscaledZ;const de=new a.P(X.canonical.x+(1<<X.canonical.z)*X.wrap,X.canonical.y),ce=new a.P(J.canonical.x+(1<<J.canonical.z)*J.wrap,J.canonical.y),fe=K.mult(1<<X.canonical.z);return fe.x-=.5,fe.y-=.5,fe.distSqr(de)-fe.distSqr(ce)})})(S,this.painter);const A=this.proxyToSource||{};this.proxyToSource={},S.forEach(z=>{this.proxyToSource[z.key]={}}),this.terrainTileForTile={};const M=this._style._mergedSourceCaches;for(const z in M){const U=M[z];if(!U.used||(U!==this.sourceCache&&this.resetTileLookupCache(U.id),this._setupProxiedCoordsForOrtho(U,s[z],A),U.usedForTerrain))continue;const H=s[z];U.getSource().reparseOverscaled&&this._assignTerrainTiles(H)}this.proxiedCoords[u.id]=S.map(z=>new bf(z,z.key,this.orthoMatrix)),this._assignTerrainTiles(S),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(A),this.renderingToTexture=!1;const D={};this._visibleDemTiles=[];for(const z of this.proxyCoords){const U=this.terrainTileForTile[z.key];if(!U)continue;const H=U.tileID.key;H in D||(this._visibleDemTiles.push(U),D[H]=H)}}_assignTerrainTiles(s){this._initializing||s.forEach(u=>{if(this.terrainTileForTile[u.key])return;const y=this._findTileCoveringTileID(u,this.sourceCache);y&&(this.terrainTileForTile[u.key]=y)})}_prepareDEMTextures(){const s=this.painter.context,u=s.gl;for(const y in this.terrainTileForTile){const S=this.terrainTileForTile[y],A=S.dem;!A||S.demTexture&&!S.needsDEMTextureUpload||(s.activeTexture.set(u.TEXTURE1),jp(this.painter,S,A))}}_prepareDemTileUniforms(s,u,y,S){if(!u||u.demTexture==null)return!1;const A=s.tileID.canonical,M=Math.pow(2,u.tileID.canonical.z-A.z),D=S||"";return y[`u_dem_tl${D}`]=[A.x*M%1,A.y*M%1],y[`u_dem_scale${D}`]=M,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let s=0;const u=this._visibleDemTiles.reduce((y,S)=>{if(!S.dem)return y;const A=S.dem.tree.minimums[0];return A>0&&s++,y+A},0);return s?u/s:0}_updateEmptyDEMTexture(){const s=this.painter.context,u=s.gl;s.activeTexture.set(u.TEXTURE2);const y=this._getLoadedAreaMinimum(),S=new a.du({width:1,height:1},new Float32Array([y]));this._emptyDEMTextureDirty=!1;let A=this._emptyDEMTexture;return A?A.update(S,{premultiply:!1}):A=this._emptyDEMTexture=new a.T(s,S,u.R32F,{premultiply:!1}),A}setupElevationDraw(s,u,y){const S=this.painter.context,A=S.gl,M={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};M.u_exaggeration=this.exaggeration();let D=null,z=null,U=1;if(y&&y.morphing&&this._useVertexMorphing){const J=y.morphing.srcDemTile,de=y.morphing.dstDemTile;U=y.morphing.phase,J&&de&&(this._prepareDemTileUniforms(s,J,M,"_prev")&&(z=J),this._prepareDemTileUniforms(s,de,M)&&(D=de))}const H=J=>J&&J.demTexture&&this.painter.linearFloatFilteringSupported()?A.LINEAR:A.NEAREST;let K=null;var X;if(this.enabled?z&&D?(K=D.demTexture,S.activeTexture.set(A.TEXTURE4),z.demTexture.bind(H(z),A.CLAMP_TO_EDGE),M.u_dem_lerp=U):(D=this.terrainTileForTile[s.tileID.key],K=this._prepareDemTileUniforms(s,D,M)?D.demTexture:this.emptyDEMTexture):K=this.emptyDEMTexture,S.activeTexture.set(A.TEXTURE2),K&&(M.u_dem_size=(X=K).size[0]===1?1:X.size[0]-2,K.bind(H(D),A.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(y&&y.useDepthForOcclusion,u,M),y&&y.useMeterToDem&&D){const J=(1<<D.tileID.canonical.z)*a.c6(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;M.u_meter_to_dem=J}if(y&&y.labelPlaneMatrixInv&&(M.u_label_plane_matrix_inv=y.labelPlaneMatrixInv),u.setTerrainUniformValues(S,M),this.painter.transform.projection.name==="globe"){const J=this.globeUniformValues(this.painter.transform,s.tileID.canonical,y&&y.useDenormalizedUpVectorScale);u.setGlobeUniformValues(S,J)}}globeUniformValues(s,u,y){const S=s.projection;return{u_tile_tl_up:S.upVector(u,0,0),u_tile_tr_up:S.upVector(u,a.aj,0),u_tile_br_up:S.upVector(u,a.aj,a.aj),u_tile_bl_up:S.upVector(u,0,a.aj),u_tile_up_scale:y?a.dv(1):S.upVectorScale(u,s.center.lat,s.worldSize).metersToTile}}renderToBackBuffer(s){const u=this.painter,y=this.painter.context;s.length!==0&&(y.bindFramebuffer.set(null),y.viewport.set([0,0,u.width,u.height]),u.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(S,A,M,D,z){if(S.transform.projection.name==="globe")(function(U,H,K,X,J){const de=U.context,ce=de.gl;let fe,ue;const ve=U.transform,Ee=a.dl(U,de,ve),Pe=(_t,xt)=>{if(ue===xt)return;const Bt=[Ya[xt],"PROJECTION_GLOBE_VIEW"];Ee&&Bt.push("CUSTOM_ANTIALIASING");const Je=U.isTileAffectedByFog(_t);fe=U.getOrCreateProgram("globeRaster",{defines:Bt,overrideFog:Je}),ue=xt},ze=U.colorModeForRenderPass(),Ie=new _n(ce.LEQUAL,_n.ReadWrite,U.depthRangeFor3D);Ml.update(J);const Oe=a.dm(ve),Ce=[a.ay(ve.center.lng),a.aH(ve.center.lat)],Fe=U.globeSharedBuffers,$e=[ve.width*a.q.devicePixelRatio,ve.height*a.q.devicePixelRatio],st=Float32Array.from(ve.globeMatrix),et={useDenormalizedUpVectorScale:!0};{const _t=U.transform,xt=uu(_t.zoom,H.exaggeration(),H.sourceCache._source.tileSize);ue=-1;const Bt=ce.TRIANGLES;for(const Je of X){const lt=K.getTile(Je),Ke=Kn.disabled,Et=H.prevTerrainTileForTile[Je.key],ct=H.terrainTileForTile[Je.key];_f(Et,ct)&&Ml.newMorphing(Je.key,Et,ct,J,250),de.activeTexture.set(ce.TEXTURE0),lt.texture&&lt.texture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);const Dt=Ml.getMorphValuesForProxy(Je.key),wt=Dt?1:0;Dt&&a.L(et,{morphing:{srcDemTile:Dt.from,dstDemTile:Dt.to,phase:a.dk(Dt.phase)}});const Ot=a.dn(Je.canonical),zt=a.dp(Ot.getCenter().lat),yn=a.dq(Je.canonical,Ot,zt,_t.worldSize/_t._pixelsPerMercatorPixel),Tn=a.bh(a.dr(Je.canonical)),gn=ph(_t.expandedFarZProjMatrix,st,Oe,Tn,a.ah(_t.zoom),Ce,_t.frustumCorners.TL,_t.frustumCorners.TR,_t.frustumCorners.BR,_t.frustumCorners.BL,_t.globeCenterInViewSpace,_t.globeRadius,$e,xt,_t._farZ,yn);if(Pe(Je,wt),fe&&(H.setupElevationDraw(lt,fe,et),U.uploadCommonUniforms(de,fe,Je.toUnwrapped()),Fe)){const[Pn,Sn,qn]=Fe.getGridBuffers(zt,xt!==0);fe.draw(U,Bt,Ie,Ke,ze,Jn.backCCW,gn,"globe_raster",Pn,Sn,qn)}}}if(Fe&&(U.renderDefaultNorthPole||U.renderDefaultSouthPole)){const _t=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ee&&_t.push("CUSTOM_ANTIALIASING"),fe=U.getOrCreateProgram("globeRaster",{defines:_t});for(const xt of X){const{x:Bt,y:Je,z:lt}=xt.canonical,Ke=Je===0,Et=Je===(1<<lt)-1,[ct,Dt,wt,Ot]=Fe.getPoleBuffers(lt,!1);if(Ot&&(Ke||Et)){const zt=K.getTile(xt);de.activeTexture.set(ce.TEXTURE0),zt.texture&&zt.texture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);let yn=a.ds(lt,Bt,ve);const Tn=a.bh(a.dr(xt.canonical)),gn=(Pn,Sn)=>Pn.draw(U,ce.TRIANGLES,Ie,Kn.disabled,ze,Jn.disabled,ph(ve.expandedFarZProjMatrix,yn,yn,Tn,0,Ce,ve.frustumCorners.TL,ve.frustumCorners.TR,ve.frustumCorners.BR,ve.frustumCorners.BL,ve.globeCenterInViewSpace,ve.globeRadius,$e,0,ve._farZ),"globe_pole_raster",Sn,wt,Ot);H.setupElevationDraw(zt,fe,et),U.uploadCommonUniforms(de,fe,xt.toUnwrapped()),Ke&&U.renderDefaultNorthPole&&gn(fe,ct),Et&&U.renderDefaultSouthPole&&(yn=a.cE(a.bz(),yn,[1,-1,1]),gn(fe,Dt))}}}})(S,A,M,D,z);else{const U=S.context,H=U.gl;let K,X;const J=S.shadowRenderer,de=ih(S,S.longestCutoffRange),ce=ze=>{if(X===ze)return;const Ie=[];Ie.push(Ya[ze]),de.shouldRenderCutoff&&Ie.push("RENDER_CUTOFF"),J&&(Ie.push("RENDER_SHADOWS","DEPTH_TEXTURE"),J.useNormalOffset&&Ie.push("NORMAL_OFFSET")),K=S.getOrCreateProgram("terrainRaster",{defines:Ie}),X=ze},fe=S.colorModeForRenderPass(),ue=new _n(H.LEQUAL,_n.ReadWrite,S.depthRangeFor3D);Ml.update(z);const ve=S.transform,Ee=uu(ve.zoom,A.exaggeration(),A.sourceCache._source.tileSize);let Pe=[0,0,0];if(J){const ze=S.style.directionalLight,Ie=S.style.ambientLight;ze&&Ie&&(Pe=nc(S.style,ze,Ie))}{X=-1;const ze=H.TRIANGLES,[Ie,Oe]=[A.gridIndexBuffer,A.gridSegments];for(const Ce of D){const Fe=M.getTile(Ce),$e=Kn.disabled,st=A.prevTerrainTileForTile[Ce.key],et=A.terrainTileForTile[Ce.key];_f(st,et)&&Ml.newMorphing(Ce.key,st,et,z,250),U.activeTexture.set(H.TEXTURE0),Fe.texture&&Fe.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE);const _t=Ml.getMorphValuesForProxy(Ce.key),xt=_t?1:0;let Bt;_t&&(Bt={morphing:{srcDemTile:_t.from,dstDemTile:_t.to,phase:a.dk(_t.phase)}});const Je=Dp(Ce.projMatrix,Nx(Ce.canonical,ve.renderWorldCopies)?Ee/10:Ee,Pe);if(ce(xt),!K)continue;A.setupElevationDraw(Fe,K,Bt);const lt=Ce.toUnwrapped();J&&J.setupShadows(lt,K),S.uploadCommonUniforms(U,K,lt,null,de),K.draw(S,ze,ue,$e,fe,Jn.backCCW,Je,"terrain_raster",A.gridBuffer,Ie,Oe)}}}}(u,this,this.proxySourceCache,s,this._updateTimestamp),this.renderingToTexture=!0,u.gpuTimingDeferredRenderEnd(),s.splice(0,s.length))}renderBatch(s){if(this._drapedRenderBatches.length===0)return s+1;this.renderingToTexture=!0;const u=this.painter,y=this.painter.context,S=this.proxySourceCache,A=this.proxiedCoords[S.id],M=this._drapedRenderBatches.shift(),D=u.style.order,z=[];let U=0;for(const H of A){const K=S.getTileByID(H.proxyTileKey),X=S.proxyCachedFBO[H.key]?S.proxyCachedFBO[H.key][s]:void 0,J=X!==void 0?S.renderCache[X]:this.pool[U++],de=X!==void 0;if(K.texture=J.tex,de&&!J.dirty){z.push(K.tileID);continue}let ce;y.bindFramebuffer.set(J.fb.framebuffer),this.renderedToTile=!1,J.dirty&&(y.clear({color:a.am.transparent,stencil:0}),J.dirty=!1);for(let fe=M.start;fe<=M.end;++fe){const ue=u.style._mergedLayers[D[fe]];if(ue.isHidden(u.transform.zoom))continue;const ve=u.style.getLayerSourceCache(ue),Ee=ve?this.proxyToSource[H.key][ve.id]:[H];if(!Ee)continue;const Pe=Ee;y.viewport.set([0,0,J.fb.width,J.fb.height]),ce!==(ve?ve.id:null)&&(this._setupStencil(J,Ee,ue,ve),ce=ve?ve.id:null),u.renderLayer(u,ve,ue,Pe)}if(this._drapedRenderBatches.length===0)for(const fe of this._pendingGroundEffectLayers){const ue=u.style._mergedLayers[D[fe]];if(ue.isHidden(u.transform.zoom))continue;const ve=u.style.getLayerSourceCache(ue),Ee=ve?this.proxyToSource[H.key][ve.id]:[H];if(!Ee)continue;const Pe=Ee;y.viewport.set([0,0,J.fb.width,J.fb.height]),ce!==(ve?ve.id:null)&&(this._setupStencil(J,Ee,ue,ve),ce=ve?ve.id:null),u.renderLayer(u,ve,ue,Pe)}this.renderedToTile?(J.dirty=!0,z.push(K.tileID)):de||--U,U===5&&(U=0,this.renderToBackBuffer(z))}return this.renderToBackBuffer(z),this.renderingToTexture=!1,y.bindFramebuffer.set(null),y.viewport.set([0,0,u.width,u.height]),M.end+1}postRender(){}isLayerOrderingCorrect(s){const u=s.order.length;let y=-1,S=u;for(let A=0;A<u;++A)this._style.isLayerDraped(s._mergedLayers[s.order[A]])?y=Math.max(y,A):S=Math.min(S,A);return S>y}getMinElevationBelowMSL(){let s=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{s=Math.min(s,u.dem.tree.minimums[0])}),s===0?s:(s-30)*this._exaggeration}raycast(s,u,y){if(!this._visibleDemTiles)return null;const S=this._visibleDemTiles.filter(A=>A.dem).map(A=>{const M=A.tileID,D=1<<M.overscaledZ,{x:z,y:U}=M.canonical,H=z/D,K=(z+1)/D,X=U/D,J=(U+1)/D;return{minx:H,miny:X,maxx:K,maxy:J,t:A.dem.tree.raycastRoot(H,X,K,J,s,u,y),tile:A}});S.sort((A,M)=>(A.t!==null?A.t:Number.MAX_VALUE)-(M.t!==null?M.t:Number.MAX_VALUE));for(const A of S){if(A.t==null)return null;const M=A.tile.dem.tree.raycast(A.minx,A.miny,A.maxx,A.maxy,s,u,y);if(M!=null)return M}return null}_createFBO(){const s=this.painter.context,u=s.gl,y=this.drapeBufferSize;s.activeTexture.set(u.TEXTURE0);const S=new a.T(s,{width:y[0],height:y[1],data:null},u.RGBA8);S.bind(u.LINEAR,u.CLAMP_TO_EDGE);const A=s.createFramebuffer(y[0],y[1],!0,null);return A.colorAttachment.set(S.texture),A.depthAttachment=new Np(s,A.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=s.createRenderbuffer(s.gl.DEPTH_STENCIL,y[0],y[1]),this._stencilRef=0,A.depthAttachment.set(this._sharedDepthStencil),s.clear({stencil:0})):A.depthAttachment.set(this._sharedDepthStencil),s.extTextureFilterAnisotropic&&u.texParameterf(u.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax),{fb:A,tex:S,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const s in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[s].hasTransition())return!0;return this._style.order.some(s=>{const u=this._style._mergedLayers[s],y=u.isHidden(this.painter.transform.zoom);return u.type==="hillshade"||u.type==="custom"?!y&&u.shouldRedrape():!y&&u.hasTransition()})}_clearLineLayersFromRenderCache(){let s=!1;for(const y of this._style.getSources())if(y instanceof Ca){s=!0;break}if(!s)return;const u={};for(let y=0;y<this._style.order.length;++y){const S=this._style._mergedLayers[this._style.order[y]],A=this._style.getLayerSourceCache(S);if(A&&!u[A.id]&&!S.isHidden(this.painter.transform.zoom)&&S.type==="line"&&S.widthExpression()instanceof a.ab){u[A.id]=!0;for(const M of this.proxyCoords){const D=this.proxyToSource[M.key][A.id];if(D)for(const z of D)this._clearRenderCacheForTile(A.id,z)}}}}_clearRasterLayersFromRenderCache(){let s=!1;for(const y in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[y]._source instanceof No){s=!0;break}if(!s)return;const u={};for(let y=0;y<this._style.order.length;++y){const S=this._style._mergedLayers[this._style.order[y]],A=this._style.getLayerSourceCache(S);if(!A||u[A.id]||S.isHidden(this.painter.transform.zoom)||S.type!=="raster")continue;const M=S.paint.get("raster-fade-duration");for(const D of this.proxyCoords){const z=this.proxyToSource[D.key][A.id];if(z)for(const U of z){const H=Op(A.getTile(U),A.findLoadedParent(U,0),A,this.painter.transform,M);(H.opacity!==1||H.mix!==0)&&this._clearRenderCacheForTile(A.id,U)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const s=this._style.order,u=s.length;if(u===0)return;const y=[];this._pendingGroundEffectLayers=[];let S,A=0,M=this._style._mergedLayers[s[A]];for(;!this._style.isLayerDraped(M)&&M.isHidden(this.painter.transform.zoom)&&++A<u;)M=this._style._mergedLayers[s[A]];for(;A<u;++A){const D=this._style._mergedLayers[s[A]];D.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(D)?S===void 0&&(S=A):(D.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(A),S!==void 0&&(y.push({start:S,end:A-1}),S=void 0)))}if(S!==void 0&&y.push({start:S,end:A-1}),y.length!==0){const D=y[y.length-1];this._pendingGroundEffectLayers.every(z=>z>D.end)||a.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=y}_setupRenderCache(s){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const M=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let D=0;D<M.length;++D){const z=Object.values(M[D]);u.renderCachePool.push(...z)}}return}this._clearRasterLayersFromRenderCache();const y=this.proxyCoords,S=this._tilesDirty;for(let M=y.length-1;M>=0;M--){const D=y[M];if(u.getTileByID(D.key),u.proxyCachedFBO[D.key]!==void 0){const z=s[D.key],U=this.proxyToSource[D.key];let H=0;for(const K in U){const X=U[K],J=z[K];if(!J||J.length!==X.length||X.some((de,ce)=>de!==J[ce]||S[K]&&S[K].hasOwnProperty(de.key))){H=-1;break}++H}for(const K in u.proxyCachedFBO[D.key])u.renderCache[u.proxyCachedFBO[D.key][K]].dirty=H<0||H!==Object.values(z).length}}const A=[...this._drapedRenderBatches];A.sort((M,D)=>D.end-D.start-(M.end-M.start));for(const M of A)for(const D of y){if(u.proxyCachedFBO[D.key])continue;let z=u.renderCachePool.pop();z===void 0&&u.renderCache.length<50&&(z=u.renderCache.length,u.renderCache.push(this._createFBO())),z!==void 0&&(u.proxyCachedFBO[D.key]={},u.proxyCachedFBO[D.key][M.start]=z,u.renderCache[z].dirty=!0)}this._tilesDirty={}}_setupStencil(s,u,y,S){if(!S||!this._sourceTilesOverlap[S.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const A=this.painter.context,M=A.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let D;if(y.isTileClipped())D=u.length,this._overlapStencilMode.test={func:M.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);D=1,this._overlapStencilMode.test={func:M.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+D>255&&(A.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=D,this._overlapStencilMode.ref=this._stencilRef,y.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(s){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[s.key]),this._overlapStencilMode):Kn.disabled}_renderTileClippingMasks(s,u){const y=this.painter,S=this.painter.context,A=S.gl;y._tileClippingMaskIDs={},S.setColorMode(pr.disabled),S.setDepthMode(_n.disabled);const M=y.getOrCreateProgram("clippingMask");for(const D of s){const z=y._tileClippingMaskIDs[D.key]=--u;M.draw(y,A.TRIANGLES,_n.disabled,new Kn({func:A.ALWAYS,mask:0},z,255,A.KEEP,A.KEEP,A.REPLACE),pr.disabled,Jn.disabled,_o(D.projMatrix),"$clipping",y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}pointCoordinate(s){const u=this.painter.transform;if(s.x<0||s.x>u.width||s.y<0||s.y>u.height)return null;const y=[s.x,s.y,1,1];a.aA(y,y,u.pixelMatrixInverse),a.cw(y,y,1/y[3]),y[0]/=u.worldSize,y[1]/=u.worldSize;const S=u._camera.position,A=a.c6(1,u.center.lat),M=[S[0],S[1],S[2]/A,0],D=a.cY([],y.slice(0,3),M);a.au(D,D);const z=this.raycast(M,D,this._exaggeration);return z!==null&&z?(a.bF(M,M,D,z),M[3]=M[2],M[2]*=A,M):null}_setupProxiedCoordsForOrtho(s,u,y){if(s.getSource()instanceof a.aP)return this._setupProxiedCoordsForImageSource(s,u,y);this._findCoveringTileCache[s.id]=this._findCoveringTileCache[s.id]||{};const S=this.proxiedCoords[s.id]=[],A=this.proxyCoords;for(let z=0;z<A.length;z++){const U=A[z],H=this._findTileCoveringTileID(U,s);if(H){const K=this._createProxiedId(U,H,y[U.key]&&y[U.key][s.id]);S.push(K),this.proxyToSource[U.key][s.id]=[K]}}let M=!1;const D=new Set;for(let z=0;z<u.length;z++){const U=s.getTile(u[z]);if(!U||!U.hasData())continue;const H=this._findTileCoveringTileID(U.tileID,this.proxySourceCache);if(H&&H.tileID.canonical.z!==U.tileID.canonical.z){const K=this.proxyToSource[H.tileID.key][s.id],X=this._createProxiedId(H.tileID,U,y[H.tileID.key]&&y[H.tileID.key][s.id]);K?K.splice(K.length-1,0,X):this.proxyToSource[H.tileID.key][s.id]=[X];const J=this.proxyToSource[H.tileID.key][s.id];D.has(J)||D.add(J),S.push(X),M=!0}}if(this._sourceTilesOverlap[s.id]=M,M&&this._debugParams.sortTilesHiZFirst)for(const z of D)z.sort((U,H)=>H.overscaledZ-U.overscaledZ)}_setupProxiedCoordsForImageSource(s,u,y){if(!s.getSource().loaded())return;const S=this.proxiedCoords[s.id]=[],A=this.proxyCoords,M=s.getSource(),D=M.tileID;if(!D)return;const z=new a.P(D.x,D.y)._div(1<<D.z),U=M.coordinates.map(a.ac.fromLngLat).reduce((K,X)=>(K.min.x=Math.min(K.min.x,X.x-z.x),K.min.y=Math.min(K.min.y,X.y-z.y),K.max.x=Math.max(K.max.x,X.x-z.x),K.max.y=Math.max(K.max.y,X.y-z.y),K),{min:new a.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),H=(K,X)=>{const J=K.wrap+K.canonical.x/(1<<K.canonical.z),de=K.canonical.y/(1<<K.canonical.z),ce=a.aj/(1<<K.canonical.z),fe=X.wrap+X.canonical.x/(1<<X.canonical.z),ue=X.canonical.y/(1<<X.canonical.z);return J+ce<fe+U.min.x||J>fe+U.max.x||de+ce<ue+U.min.y||de>ue+U.max.y};for(let K=0;K<A.length;K++){const X=A[K];for(let J=0;J<u.length;J++){const de=s.getTile(u[J]);if(!de||!de.hasData()||H(X,de.tileID))continue;const ce=this._createProxiedId(X,de,y[X.key]&&y[X.key][s.id]),fe=this.proxyToSource[X.key][s.id];fe?fe.push(ce):this.proxyToSource[X.key][s.id]=[ce],S.push(ce)}}}_createProxiedId(s,u,y){let S=this.orthoMatrix;if(y){const A=y.find(M=>M.key===u.tileID.key);if(A)return A}if(u.tileID.key!==s.key){const A=s.canonical.z-u.tileID.canonical.z;let M,D,z;S=a.bz();const U=u.tileID.wrap-s.wrap<<s.overscaledZ;A>0?(M=a.aj>>A,D=M*((u.tileID.canonical.x<<A)-s.canonical.x+U),z=M*((u.tileID.canonical.y<<A)-s.canonical.y)):(M=a.aj<<-A,D=a.aj*(u.tileID.canonical.x-(s.canonical.x+U<<-A)),z=a.aj*(u.tileID.canonical.y-(s.canonical.y<<-A))),a.c5(S,0,M,0,M,0,1),a.bo(S,S,[D,z,0])}return new bf(u.tileID,s.key,S)}_findTileCoveringTileID(s,u){let y=u.getTile(s);if(y&&y.hasData())return y;const S=this._findCoveringTileCache[u.id],A=S[s.key];if(y=A?u.getTileByID(A):null,y&&y.hasData()||A===null)return y;let M=y?y.tileID:s,D=M.overscaledZ;const z=u.getSource().minzoom,U=[];if(!A){const K=u.getSource().maxzoom;if(s.canonical.z>=K){const X=s.canonical.z-K;u.getSource().reparseOverscaled?(D=Math.max(s.canonical.z+2,u.transform.tileZoom),M=new a.aM(D,s.wrap,K,s.canonical.x>>X,s.canonical.y>>X)):X!==0&&(D=K,M=new a.aM(D,s.wrap,K,s.canonical.x>>X,s.canonical.y>>X))}M.key!==s.key&&(U.push(M.key),y=u.getTile(M))}const H=K=>{U.forEach(X=>{S[X]=K}),U.length=0};for(D-=1;D>=z&&(!y||!y.hasData());D--){y&&H(y.tileID.key);const K=M.calculateScaledKey(D);if(y=u.getTileByID(K),y&&y.hasData())break;const X=S[K];if(X===null)break;X===void 0?U.push(K):y=u.getTileByID(X)}return H(y?y.tileID.key:null),y&&y.hasData()?y:null}findDEMTileFor(s){return this.enabled?this._findTileCoveringTileID(s,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(s,u){let y=this._tilesDirty[s];y||(y=this._tilesDirty[s]={}),y[u.key]=!0}}function mh(x,s,u){const y=function(D,z,U){const H=a.bE(z,D),K=a.bE(U,[.2126,.7152,.0722]),X=(de,ce,fe)=>(1-fe)*de+fe*ce,J=X(1-.3*Math.min(K,1),1,Math.min(H+1,1));return X(.92,1,Math.asin(a.aD(z[2],-1,1))/Math.PI+.5)*J}(x,[0,0,1],s),S=[0,0,0];a.b$(S,u.slice(0,3),y);const A=[0,0,0];a.b$(A,s.slice(0,3),x[2]);const M=[0,0,0];return a.cU(M,S,A),a.cX(M)}const wf=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Xu=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class du{static cacheKey(s,u,y,S){let A=`${u}${S?S.cacheKey:""}`;for(const M of y)s.usedDefines.includes(M)&&(A+=`/${M}`);return A}constructor(s,u,y,S,A,M){const D=s.gl;this.program=D.createProgram(),this.configuration=S,this.name=u,this.fixedDefines=[...M];const z=S?S.getBinderAttributes():[],U=(y.staticAttributes||[]).concat(z);let H=S?S.defines():[];H=H.concat(M.map(fe=>`#define ${fe}`));const K=`#version 300 es
`;let X=K+H.concat("precision mediump float;",lh,ic.fragmentSource).join(`
`);for(const fe of y.fragmentIncludes)X+=`
${Bo[fe]}`;X+=`
${y.fragmentSource}`;let J=K+H.concat("precision highp float;",lh,ic.vertexSource).join(`
`);for(const fe of y.vertexIncludes)J+=`
${Bo[fe]}`;this.forceManualRenderingForInstanceIDShaders=s.forceManualRenderingForInstanceIDShaders&&y.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(J+=`
uniform int u_instanceID;
`),J+=`
${y.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(J=J.replaceAll("gl_InstanceID","u_instanceID"));const de=D.createShader(D.FRAGMENT_SHADER);if(D.isContextLost())return void(this.failedToCreate=!0);D.shaderSource(de,X),D.compileShader(de),D.attachShader(this.program,de);const ce=D.createShader(D.VERTEX_SHADER);if(D.isContextLost())this.failedToCreate=!0;else{D.shaderSource(ce,J),D.compileShader(ce),D.attachShader(this.program,ce),this.attributes={},this.numAttributes=U.length;for(let fe=0;fe<this.numAttributes;fe++)if(U[fe]){const ue=U[fe].startsWith("a_")?U[fe]:`a_${U[fe]}`;D.bindAttribLocation(this.program,fe,ue),this.attributes[ue]=fe}D.linkProgram(this.program),D.deleteShader(ce),D.deleteShader(de),this.fixedUniforms=A(s),this.binderUniforms=S?S.getUniforms(s):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(fe=>({u_instanceID:new a.cc(fe)}))(s)),(M.includes("TERRAIN")||u.indexOf("symbol")!==-1||u.indexOf("circle")!==-1)&&(this.terrainUniforms=(fe=>({u_dem:new a.cc(fe),u_dem_prev:new a.cc(fe),u_dem_tl:new a.c9(fe),u_dem_scale:new a.cb(fe),u_dem_tl_prev:new a.c9(fe),u_dem_scale_prev:new a.cb(fe),u_dem_size:new a.cb(fe),u_dem_lerp:new a.cb(fe),u_exaggeration:new a.cb(fe),u_depth:new a.cc(fe),u_depth_size_inv:new a.c9(fe),u_depth_range_unpack:new a.c9(fe),u_occluder_half_size:new a.cb(fe),u_occlusion_depth_offset:new a.cb(fe),u_meter_to_dem:new a.cb(fe),u_label_plane_matrix_inv:new a.c8(fe)}))(s)),M.includes("GLOBE")&&(this.globeUniforms=(fe=>({u_tile_tl_up:new a.ca(fe),u_tile_tr_up:new a.ca(fe),u_tile_br_up:new a.ca(fe),u_tile_bl_up:new a.ca(fe),u_tile_up_scale:new a.cb(fe)}))(s)),M.includes("FOG")&&(this.fogUniforms=(fe=>({u_fog_matrix:new a.c8(fe),u_fog_range:new a.c9(fe),u_fog_color:new a.cQ(fe),u_fog_horizon_blend:new a.cb(fe),u_fog_vertical_limit:new a.c9(fe),u_fog_temporal_offset:new a.cb(fe),u_frustum_tl:new a.ca(fe),u_frustum_tr:new a.ca(fe),u_frustum_br:new a.ca(fe),u_frustum_bl:new a.ca(fe),u_globe_pos:new a.ca(fe),u_globe_radius:new a.cb(fe),u_globe_transition:new a.cb(fe),u_is_globe:new a.cc(fe),u_viewport:new a.c9(fe)}))(s)),M.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(fe=>({u_cutoff_params:new a.cQ(fe)}))(s)),M.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(fe=>({u_lighting_ambient_color:new a.ca(fe),u_lighting_directional_dir:new a.ca(fe),u_lighting_directional_color:new a.ca(fe),u_ground_radiance:new a.ca(fe)}))(s)),M.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(fe=>({u_light_matrix_0:new a.c8(fe),u_light_matrix_1:new a.c8(fe),u_fade_range:new a.c9(fe),u_shadow_normal_offset:new a.ca(fe),u_shadow_intensity:new a.cb(fe),u_shadow_texel_size:new a.cb(fe),u_shadow_map_resolution:new a.cb(fe),u_shadow_direction:new a.ca(fe),u_shadow_bias:new a.ca(fe),u_shadowmap_0:new a.cc(fe),u_shadowmap_1:new a.cc(fe)}))(s))}}setTerrainUniformValues(s,u){if(!this.terrainUniforms)return;const y=this.terrainUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const S in u)y[S]&&y[S].set(this.program,S,u[S])}}setGlobeUniformValues(s,u){if(!this.globeUniforms)return;const y=this.globeUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const S in u)y[S]&&y[S].set(this.program,S,u[S])}}setFogUniformValues(s,u){if(!this.fogUniforms)return;const y=this.fogUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const S in u)y[S].set(this.program,S,u[S])}}setCutoffUniformValues(s,u){if(!this.cutoffUniforms)return;const y=this.cutoffUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const S in u)y[S].set(this.program,S,u[S])}}setLightsUniformValues(s,u){if(!this.lightsUniforms)return;const y=this.lightsUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const S in u)y[S].set(this.program,S,u[S])}}setShadowUniformValues(s,u){if(this.failedToCreate||!this.shadowUniforms)return;const y=this.shadowUniforms;s.program.set(this.program);for(const S in u)y[S].set(this.program,S,u[S])}_drawDebugWireframe(s,u,y,S,A,M,D,z,U,H){const K=s.options.wireframe;if(K.terrain===!1&&K.layers2D===!1&&K.layers3D===!1)return;const X=s.context;if(!(!(!K.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!K.layers2D||s._terrain&&s._terrain.renderingToTexture||!wf.includes(this.name))||!(!K.layers3D||!Xu.includes(this.name))))return;const J=X.gl,de=s.wireframeDebugCache.getLinesFromTrianglesBuffer(s.frameCounter,A,X);if(!de)return;const ce=[...this.fixedDefines];ce.push("DEBUG_WIREFRAME");const fe=s.getOrCreateProgram(this.name,{config:this.configuration,defines:ce});X.program.set(fe.program);const ue=(Pe,ze,Ie)=>{if(ze[Pe]&&Ie[Pe])for(const Oe in ze[Pe])Ie[Pe][Oe]&&Ie[Pe][Oe].set(Ie.program,Oe,ze[Pe][Oe].current)};U&&U.setUniforms(fe.program,X,fe.binderUniforms,D,{zoom:z}),ue("fixedUniforms",this,fe),ue("terrainUniforms",this,fe),ue("globeUniforms",this,fe),ue("fogUniforms",this,fe),ue("lightsUniforms",this,fe),ue("shadowUniforms",this,fe),de.bind(),X.setColorMode(new pr([J.ONE,J.ONE_MINUS_SRC_ALPHA,J.ZERO,J.ONE],a.am.transparent,[!0,!0,!0,!1])),X.setDepthMode(new _n(u.func===J.LESS?J.LEQUAL:u.func,_n.ReadOnly,u.range)),X.setStencilMode(Kn.disabled);const ve=3*M.primitiveLength*2,Ee=3*M.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Pe=H||1;for(let ze=0;ze<Pe;++ze)fe.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",ze),J.drawElements(J.LINES,ve,J.UNSIGNED_SHORT,Ee)}else H&&H>1?J.drawElementsInstanced(J.LINES,ve,J.UNSIGNED_SHORT,Ee,H):J.drawElements(J.LINES,ve,J.UNSIGNED_SHORT,Ee);A.bind(),X.program.set(this.program),X.setDepthMode(u),X.setStencilMode(y),X.setColorMode(S)}checkUniforms(s,u,y){if(this.fixedDefines.includes(u)){for(const S of Object.keys(y))if(!y[S].initialized)throw new Error(`Program '${this.name}', from draw '${s}': uniform ${S} not set but required by ${u} being defined`)}}draw(s,u,y,S,A,M,D,z,U,H,K,X,J,de,ce,fe){const ue=s.context,ve=ue.gl;if(this.failedToCreate)return;ue.program.set(this.program),ue.setDepthMode(y),ue.setStencilMode(S),ue.setColorMode(A),ue.setCullFace(M);for(const ze of Object.keys(this.fixedUniforms))this.fixedUniforms[ze].set(this.program,ze,D[ze]);de&&de.setUniforms(this.program,ue,this.binderUniforms,X,{zoom:J});const Ee={[ve.POINTS]:1,[ve.LINES]:2,[ve.TRIANGLES]:3,[ve.LINE_STRIP]:1}[u];this.checkUniforms(z,"RENDER_SHADOWS",this.shadowUniforms);const Pe=fe&&fe>0?1:void 0;for(const ze of K.get()){const Ie=ze.vaos||(ze.vaos={});if((Ie[z]||(Ie[z]=new Gu)).bind(ue,this,U,de?de.getPaintVertexBuffers():[],H,ze.vertexOffset,ce||[],Pe),this.forceManualRenderingForInstanceIDShaders){const Oe=fe||1;for(let Ce=0;Ce<Oe;++Ce)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ce),H?ve.drawElements(u,ze.primitiveLength*Ee,ve.UNSIGNED_SHORT,ze.primitiveOffset*Ee*2):ve.drawArrays(u,ze.vertexOffset,ze.vertexLength)}else fe&&fe>1?ve.drawElementsInstanced(u,ze.primitiveLength*Ee,ve.UNSIGNED_SHORT,ze.primitiveOffset*Ee*2,fe):H?ve.drawElements(u,ze.primitiveLength*Ee,ve.UNSIGNED_SHORT,ze.primitiveOffset*Ee*2):ve.drawArrays(u,ze.vertexOffset,ze.vertexLength);u===ve.TRIANGLES&&H&&this._drawDebugWireframe(s,y,S,A,H,ze,X,J,de,fe)}}}function Ip(x,s,u=0){const y=Math.pow(2,s.tileID.overscaledZ),S=s.tileSize*Math.pow(2,x.transform.tileZoom)/y,A=S*(s.tileID.canonical.x+s.tileID.wrap*y),M=S*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture?s.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/a.aw(s,1,x.transform.tileZoom),u_pixel_coord_upper:[A>>16,M>>16],u_pixel_coord_lower:[65535&A,65535&M],u_pattern_transition:u}}const Sf={terrain:0,flat:1},Ly=a.bz(),Ku=(x,s,u,y,S,A,M,D,z,U,H,K,X,J,de,ce,fe,ue)=>{const ve=s.style.light,Ee=ve.properties.get("position"),Pe=[Ee.x,Ee.y,Ee.z],ze=a.dx();ve.properties.get("anchor")==="viewport"&&(a.dy(ze,-s.transform.angle),a.dz(Pe,Pe,ze));const Ie=ve.properties.get("color"),Oe=s.transform,Ce={u_matrix:x,u_lightpos:Pe,u_lightintensity:ve.properties.get("intensity"),u_lightcolor:[Ie.r,Ie.g,Ie.b],u_vertical_gradient:+u,u_opacity:y,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ly,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:Sf[U],u_base_type:Sf[H],u_ao:S,u_edge_radius:A,u_width_scale:M,u_flood_light_color:de,u_vertical_scale:ce,u_flood_light_intensity:fe,u_ground_shadow_factor:ue};return Oe.projection.name==="globe"&&(Ce.u_tile_id=[D.canonical.x,D.canonical.y,1<<D.canonical.z],Ce.u_zoom_transition=K,Ce.u_inv_rot_matrix=J,Ce.u_merc_center=X,Ce.u_up_dir=Oe.projection.upVector(new a.cp(0,0,0),X[0]*a.aj,X[1]*a.aj),Ce.u_height_lift=z),Ce},gh=(x,s,u,y,S,A)=>({u_matrix:x,u_edge_radius:s,u_width_scale:u,u_vertical_scale:y,u_height_type:Sf[S],u_base_type:Sf[A]}),Dx=(x,s,u,y,S,A,M,D,z,U,H,K,X,J,de,ce,fe,ue)=>{const ve=Ku(x,s,u,y,S,A,M,D,U,H,K,X,J,de,ce,fe,1,[0,0,0]),Ee={u_height_factor:-Math.pow(2,D.overscaledZ)/z.tileSize/8};return a.l(ve,Ip(s,z,ue),Ee)},kp=(x,s,u)=>({u_matrix:x,u_emissive_strength:s,u_ground_shadow_factor:u}),Ox=(x,s,u,y,S,A=0)=>a.l(kp(x,s,S),Ip(u,y,A)),Rp=(x,s,u,y)=>({u_matrix:x,u_world:u,u_emissive_strength:s,u_ground_shadow_factor:y}),Fy=(x,s,u,y,S,A,M=0)=>a.l(Ox(x,s,u,y,A,M),{u_world:S}),Tf=(x,s)=>({u_matrix:x,u_ground_shadow_factor:s}),xh=(x,s,u,y,S)=>({u_matrix:x,u_camera_pos:[s[0],s[1],s[2]],u_depth_bias:u,u_height_scale:y,u_reset_depth:S}),Ix=(x,s,u,y)=>{const S=a.aj/u.tileSize;return{u_matrix:x,u_camera_to_center_distance:s.getCameraToCenterDistance(y),u_extrude_scale:[s.pixelsToGLUnits[0]/S,s.pixelsToGLUnits[1]/S]}},Oc=(x,s,u=1)=>({u_matrix:x,u_color:s.toRenderColor(null),u_overlay:0,u_overlay_scale:u}),kx=a.bz(),Ef=(x,s,u,y,S,A,M)=>{const D=x.transform,z=D.projection.name==="globe",U=z?a.dA(D.zoom,s.canonical)*D._pixelsPerMercatorPixel:a.aw(u,1,A),H={u_matrix:s.projMatrix,u_extrude_scale:U,u_intensity:M,u_inv_rot_matrix:kx,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(z){H.u_inv_rot_matrix=y,H.u_merc_center=S,H.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],H.u_zoom_transition=a.ah(D.zoom);const K=S[0]*a.aj,X=S[1]*a.aj;H.u_up_dir=D.projection.upVector(new a.cp(0,0,0),K,X)}return H};function sg(x,[s,u,y,S],[A,M]){if(A===M)return[0,0,0,0];const D=255*(x-1)/(x*(M-A));return[s*D,u*D,y*D,S*D]}function zp(x,s,[u,y]){return u===y?0:.5/x+(s-u)*(x-1)/(x*(y-u))}const bo=(x,s,u,y,S,A,M,D,z,U,H,K,X,J,de,ce,fe,ue,ve,Ee,Pe)=>({u_matrix:x,u_normalize_matrix:s,u_globe_matrix:u,u_merc_matrix:y,u_grid_matrix:S,u_tl_parent:A,u_scale_parent:U,u_fade_t:H.mix,u_opacity:H.opacity*K.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:K.paint.get("raster-brightness-min"),u_brightness_high:K.paint.get("raster-brightness-max"),u_saturation_factor:a.dB(K.paint.get("raster-saturation")),u_contrast_factor:a.dC(K.paint.get("raster-contrast")),u_spin_weights:og(K.paint.get("raster-hue-rotate")),u_perspective_transform:X,u_raster_elevation:J,u_zoom_transition:M,u_merc_center:D,u_cutoff_params:z,u_colorization_mix:sg(a.dD,ce,ue),u_colorization_offset:zp(a.dD,fe,ue),u_color_ramp:de,u_texture_offset:[Ee/(ve+2*Ee),ve/(ve+2*Ee)],u_texture_res:[ve+2*Ee,ve+2*Ee],u_emissive_strength:Pe});function og(x){x*=Math.PI/180;const s=Math.sin(x),u=Math.cos(x);return[(2*u+1)/3,(-Math.sqrt(3)*s-u+1)/3,(Math.sqrt(3)*s-u+1)/3]}const wo=.05,Ic=(x,s,u,y,S,A,M,D,z,U,H,K)=>({u_matrix:x,u_normalize_matrix:s,u_globe_matrix:u,u_merc_matrix:y,u_grid_matrix:S,u_tl_parent:A,u_scale_parent:U,u_fade_t:H.mix,u_opacity:H.opacity,u_image0:0,u_image1:1,u_raster_elevation:K,u_zoom_transition:M,u_merc_center:D,u_cutoff_params:z}),uc=(x,s,u,y,S,A,M,D,z,U)=>({u_particle_texture:x,u_particle_texture_side_len:s,u_tile_offset:u,u_velocity:y,u_color_ramp:A,u_velocity_res:S,u_max_speed:M,u_uv_offset:D,u_data_scale:[255*z[0],255*z[1]],u_data_offset:U,u_particle_pos_scale:1.1,u_particle_pos_offset:[wo,wo]}),Af=(x,s,u,y,S,A,M,D,z,U)=>({u_particle_texture:x,u_particle_texture_side_len:s,u_velocity:u,u_velocity_res:y,u_max_speed:S,u_speed_factor:A,u_reset_rate:M,u_rand_seed:Math.random(),u_uv_offset:D,u_data_scale:[255*z[0],255*z[1]],u_data_offset:U,u_particle_pos_scale:1.1,u_particle_pos_offset:[wo,wo]}),Lp=a.bz(),Cf=(x,s,u,y,S,A,M,D,z,U,H,K,X,J,de,ce,fe,ue,ve,Ee,Pe,ze,Ie)=>{const Oe=S.transform,Ce={u_is_size_zoom_constant:+(x==="constant"||x==="source"),u_is_size_feature_constant:+(x==="constant"||x==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Oe.getCameraToCenterDistance(ve),u_rotate_symbol:+u,u_aspect_ratio:Oe.width/Oe.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:A,u_label_plane_matrix:M,u_coord_matrix:D,u_is_text:+U,u_elevation_from_sea:z?1:0,u_pitch_with_map:+y,u_texsize:H,u_texsize_icon:K,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Lp,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Lp,u_up_vector:[0,-1,0],u_color_adj_mat:Pe,u_icon_transition:ze||0,u_gamma_scale:y?S.transform.getCameraToCenterDistance(ve)*Math.cos(S.terrain?0:S.transform._pitch):1,u_device_pixel_ratio:a.q.devicePixelRatio,u_is_halo:1,u_scale_factor:Ie||1,u_ground_shadow_factor:Ee,u_inv_matrix:a.bi(a.bz(),M)};return ve.name==="globe"&&(Ce.u_tile_id=[J.canonical.x,J.canonical.y,1<<J.canonical.z],Ce.u_zoom_transition=de,Ce.u_inv_rot_matrix=fe,Ce.u_merc_center=ce,Ce.u_camera_forward=Oe._camera.forward(),Ce.u_ecef_origin=a.dE(Oe.globeMatrix,J.toUnwrapped()),Ce.u_tile_matrix=Float32Array.from(Oe.globeMatrix),Ce.u_up_vector=ue),Ce},Yu=(x,s,u,y)=>({u_matrix:x,u_emissive_strength:s,u_opacity:u,u_color:y}),jf=(x,s,u,y,S,A,M,D,z)=>a.l(function(U,H,K,X,J,de){const{width:ce,height:fe}=X.imageManager.getPixelSize(H),ue=Math.pow(2,de.tileID.overscaledZ),ve=de.tileSize*Math.pow(2,X.transform.tileZoom)/ue,Ee=ve*(de.tileID.canonical.x+de.tileID.wrap*ue),Pe=ve*de.tileID.canonical.y;return{u_image:0,u_pattern_tl:K.tl,u_pattern_br:K.br,u_texsize:[ce,fe],u_pattern_size:K.displaySize,u_pattern_units_to_pixels:J?[X.transform.width,-1*X.transform.height]:[1/a.aw(de,1,X.transform.tileZoom),1/a.aw(de,1,X.transform.tileZoom)],u_pixel_coord_upper:[Ee>>16,Pe>>16],u_pixel_coord_lower:[65535&Ee,65535&Pe]}}(0,A,M,y,D,z),{u_matrix:x,u_emissive_strength:s,u_opacity:u}),Fp=new Float32Array(a.bx([])),Qu=(x,s,u,y,S,A,M,D,z,U,H,K,X,J=[0,0,0],de)=>{const ce=S.style.light,fe=ce.properties.get("position"),ue=[-fe.x,-fe.y,fe.z],ve=a.dx();ce.properties.get("anchor")==="viewport"&&(a.dy(ve,-S.transform.angle),a.dz(ue,ue,ve));const Ee=H.alphaMode==="MASK",Pe=ce.properties.get("color").toRenderColor(null),ze=X.paint.get("model-ambient-occlusion-intensity"),Ie=X.paint.get("model-color").constantOr(a.am.white).toRenderColor(null),Oe=X.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:x,u_lighting_matrix:s,u_normal_matrix:u,u_node_matrix:y||Fp,u_lightpos:ue,u_lightintensity:ce.properties.get("intensity"),u_lightcolor:[Pe.r,Pe.g,Pe.b],u_camera_pos:J,u_opacity:A,u_baseTextureIsAlpha:0,u_alphaMask:+Ee,u_alphaCutoff:H.alphaCutoff,u_baseColorFactor:[M.r,M.g,M.b,M.a],u_emissiveFactor:[D[0],D[1],D[2],1],u_metallicFactor:z,u_roughnessFactor:U,u_baseColorTexture:zs.BaseColor,u_metallicRoughnessTexture:zs.MetallicRoughness,u_normalTexture:zs.Normal,u_occlusionTexture:zs.Occlusion,u_emissionTexture:zs.Emission,u_lutTexture:zs.LUT,u_color_mix:[Ie.r,Ie.g,Ie.b,Oe],u_aoIntensity:ze,u_emissive_strength:K,u_occlusionTextureTransform:de||[0,0,0,0]}},yh=(x,s=Fp,u=Fp)=>({u_matrix:x,u_instance:s,u_node_matrix:u}),lg={fillExtrusion:x=>({u_matrix:new a.c8(x),u_lightpos:new a.ca(x),u_lightintensity:new a.cb(x),u_lightcolor:new a.ca(x),u_vertical_gradient:new a.cb(x),u_opacity:new a.cb(x),u_edge_radius:new a.cb(x),u_width_scale:new a.cb(x),u_ao:new a.c9(x),u_height_type:new a.cc(x),u_base_type:new a.cc(x),u_tile_id:new a.ca(x),u_zoom_transition:new a.cb(x),u_inv_rot_matrix:new a.c8(x),u_merc_center:new a.c9(x),u_up_dir:new a.ca(x),u_height_lift:new a.cb(x),u_flood_light_color:new a.ca(x),u_vertical_scale:new a.cb(x),u_flood_light_intensity:new a.cb(x),u_ground_shadow_factor:new a.ca(x)}),fillExtrusionDepth:x=>({u_matrix:new a.c8(x),u_edge_radius:new a.cb(x),u_width_scale:new a.cb(x),u_vertical_scale:new a.cb(x),u_height_type:new a.cc(x),u_base_type:new a.cc(x)}),fillExtrusionPattern:x=>({u_matrix:new a.c8(x),u_lightpos:new a.ca(x),u_lightintensity:new a.cb(x),u_lightcolor:new a.ca(x),u_vertical_gradient:new a.cb(x),u_height_factor:new a.cb(x),u_edge_radius:new a.cb(x),u_width_scale:new a.cb(x),u_ao:new a.c9(x),u_height_type:new a.cc(x),u_base_type:new a.cc(x),u_tile_id:new a.ca(x),u_zoom_transition:new a.cb(x),u_inv_rot_matrix:new a.c8(x),u_merc_center:new a.c9(x),u_up_dir:new a.ca(x),u_height_lift:new a.cb(x),u_image:new a.cc(x),u_texsize:new a.c9(x),u_pixel_coord_upper:new a.c9(x),u_pixel_coord_lower:new a.c9(x),u_tile_units_to_pixels:new a.cb(x),u_opacity:new a.cb(x),u_pattern_transition:new a.cb(x)}),fillExtrusionGroundEffect:x=>({u_matrix:new a.c8(x),u_opacity:new a.cb(x),u_ao_pass:new a.cb(x),u_meter_to_tile:new a.cb(x),u_ao:new a.c9(x),u_flood_light_intensity:new a.cb(x),u_flood_light_color:new a.ca(x),u_attenuation:new a.cb(x),u_edge_radius:new a.cb(x),u_fb:new a.cc(x),u_fb_size:new a.cb(x),u_dynamic_offset:new a.cb(x)}),fill:x=>({u_matrix:new a.c8(x),u_emissive_strength:new a.cb(x),u_ground_shadow_factor:new a.ca(x)}),fillPattern:x=>({u_matrix:new a.c8(x),u_emissive_strength:new a.cb(x),u_image:new a.cc(x),u_texsize:new a.c9(x),u_pixel_coord_upper:new a.c9(x),u_pixel_coord_lower:new a.c9(x),u_tile_units_to_pixels:new a.cb(x),u_ground_shadow_factor:new a.ca(x),u_pattern_transition:new a.cb(x)}),fillOutline:x=>({u_matrix:new a.c8(x),u_emissive_strength:new a.cb(x),u_world:new a.c9(x),u_ground_shadow_factor:new a.ca(x)}),fillOutlinePattern:x=>({u_matrix:new a.c8(x),u_emissive_strength:new a.cb(x),u_world:new a.c9(x),u_image:new a.cc(x),u_texsize:new a.c9(x),u_pixel_coord_upper:new a.c9(x),u_pixel_coord_lower:new a.c9(x),u_tile_units_to_pixels:new a.cb(x),u_ground_shadow_factor:new a.ca(x),u_pattern_transition:new a.cb(x)}),building:x=>({u_matrix:new a.c8(x),u_normal_matrix:new a.c8(x),u_opacity:new a.cb(x)}),buildingDepth:x=>({u_matrix:new a.c8(x)}),elevatedStructuresDepth:x=>({u_matrix:new a.c8(x),u_depth_bias:new a.cb(x)}),elevatedStructures:x=>({u_matrix:new a.c8(x),u_ground_shadow_factor:new a.ca(x)}),elevatedStructuresDepthReconstruct:x=>({u_matrix:new a.c8(x),u_camera_pos:new a.ca(x),u_depth_bias:new a.cb(x),u_height_scale:new a.cb(x),u_reset_depth:new a.cb(x)}),circle:a.dF,collisionBox:x=>({u_matrix:new a.c8(x),u_camera_to_center_distance:new a.cb(x),u_extrude_scale:new a.c9(x)}),collisionCircle:x=>({u_matrix:new a.c8(x),u_inv_matrix:new a.c8(x),u_camera_to_center_distance:new a.cb(x),u_viewport_size:new a.c9(x)}),debug:x=>({u_color:new a.di(x),u_matrix:new a.c8(x),u_overlay:new a.cc(x),u_overlay_scale:new a.cb(x)}),clippingMask:x=>({u_matrix:new a.c8(x)}),heatmap:x=>({u_extrude_scale:new a.cb(x),u_intensity:new a.cb(x),u_matrix:new a.c8(x),u_inv_rot_matrix:new a.c8(x),u_merc_center:new a.c9(x),u_tile_id:new a.ca(x),u_zoom_transition:new a.cb(x),u_up_dir:new a.ca(x)}),heatmapTexture:x=>({u_image:new a.cc(x),u_color_ramp:new a.cc(x),u_opacity:new a.cb(x)}),hillshade:x=>({u_matrix:new a.c8(x),u_image:new a.cc(x),u_latrange:new a.c9(x),u_light:new a.c9(x),u_shadow:new a.di(x),u_highlight:new a.di(x),u_emissive_strength:new a.cb(x),u_accent:new a.di(x)}),hillshadePrepare:x=>({u_matrix:new a.c8(x),u_image:new a.cc(x),u_dimension:new a.c9(x),u_zoom:new a.cb(x)}),line:a.dG,linePattern:a.dH,raster:x=>({u_matrix:new a.c8(x),u_normalize_matrix:new a.c8(x),u_globe_matrix:new a.c8(x),u_merc_matrix:new a.c8(x),u_grid_matrix:new a.dj(x),u_tl_parent:new a.c9(x),u_scale_parent:new a.cb(x),u_fade_t:new a.cb(x),u_opacity:new a.cb(x),u_image0:new a.cc(x),u_image1:new a.cc(x),u_brightness_low:new a.cb(x),u_brightness_high:new a.cb(x),u_saturation_factor:new a.cb(x),u_contrast_factor:new a.cb(x),u_spin_weights:new a.ca(x),u_perspective_transform:new a.c9(x),u_raster_elevation:new a.cb(x),u_zoom_transition:new a.cb(x),u_merc_center:new a.c9(x),u_cutoff_params:new a.cQ(x),u_colorization_mix:new a.cQ(x),u_colorization_offset:new a.cb(x),u_color_ramp:new a.cc(x),u_texture_offset:new a.c9(x),u_texture_res:new a.c9(x),u_emissive_strength:new a.cb(x)}),rasterParticle:x=>({u_matrix:new a.c8(x),u_normalize_matrix:new a.c8(x),u_globe_matrix:new a.c8(x),u_merc_matrix:new a.c8(x),u_grid_matrix:new a.dj(x),u_tl_parent:new a.c9(x),u_scale_parent:new a.cb(x),u_fade_t:new a.cb(x),u_opacity:new a.cb(x),u_image0:new a.cc(x),u_image1:new a.cc(x),u_raster_elevation:new a.cb(x),u_zoom_transition:new a.cb(x),u_merc_center:new a.c9(x),u_cutoff_params:new a.cQ(x)}),rasterParticleTexture:x=>({u_texture:new a.cc(x),u_opacity:new a.cb(x)}),rasterParticleDraw:x=>({u_particle_texture:new a.cc(x),u_particle_texture_side_len:new a.cb(x),u_tile_offset:new a.c9(x),u_velocity:new a.cc(x),u_color_ramp:new a.cc(x),u_velocity_res:new a.c9(x),u_max_speed:new a.cb(x),u_uv_offset:new a.c9(x),u_data_scale:new a.c9(x),u_data_offset:new a.cb(x),u_particle_pos_scale:new a.cb(x),u_particle_pos_offset:new a.c9(x)}),rasterParticleUpdate:x=>({u_particle_texture:new a.cc(x),u_particle_texture_side_len:new a.cb(x),u_velocity:new a.cc(x),u_velocity_res:new a.c9(x),u_max_speed:new a.cb(x),u_speed_factor:new a.cb(x),u_reset_rate:new a.cb(x),u_rand_seed:new a.cb(x),u_uv_offset:new a.c9(x),u_data_scale:new a.c9(x),u_data_offset:new a.cb(x),u_particle_pos_scale:new a.cb(x),u_particle_pos_offset:new a.c9(x)}),symbol:x=>({u_is_size_zoom_constant:new a.cc(x),u_is_size_feature_constant:new a.cc(x),u_size_t:new a.cb(x),u_size:new a.cb(x),u_camera_to_center_distance:new a.cb(x),u_rotate_symbol:new a.cc(x),u_aspect_ratio:new a.cb(x),u_fade_change:new a.cb(x),u_matrix:new a.c8(x),u_label_plane_matrix:new a.c8(x),u_coord_matrix:new a.c8(x),u_is_text:new a.cc(x),u_elevation_from_sea:new a.cc(x),u_pitch_with_map:new a.cc(x),u_texsize:new a.c9(x),u_texsize_icon:new a.c9(x),u_texture:new a.cc(x),u_texture_icon:new a.cc(x),u_gamma_scale:new a.cb(x),u_device_pixel_ratio:new a.cb(x),u_tile_id:new a.ca(x),u_zoom_transition:new a.cb(x),u_inv_rot_matrix:new a.c8(x),u_merc_center:new a.c9(x),u_camera_forward:new a.ca(x),u_tile_matrix:new a.c8(x),u_up_vector:new a.ca(x),u_ecef_origin:new a.ca(x),u_is_halo:new a.cc(x),u_icon_transition:new a.cb(x),u_color_adj_mat:new a.c8(x),u_scale_factor:new a.cb(x),u_ground_shadow_factor:new a.ca(x),u_inv_matrix:new a.c8(x)}),background:x=>({u_matrix:new a.c8(x),u_emissive_strength:new a.cb(x),u_opacity:new a.cb(x),u_color:new a.di(x)}),backgroundPattern:x=>({u_matrix:new a.c8(x),u_emissive_strength:new a.cb(x),u_opacity:new a.cb(x),u_image:new a.cc(x),u_pattern_tl:new a.c9(x),u_pattern_br:new a.c9(x),u_texsize:new a.c9(x),u_pattern_size:new a.c9(x),u_pixel_coord_upper:new a.c9(x),u_pixel_coord_lower:new a.c9(x),u_pattern_units_to_pixels:new a.c9(x)}),terrainRaster:x=>({u_matrix:new a.c8(x),u_image0:new a.cc(x),u_skirt_height:new a.cb(x),u_ground_shadow_factor:new a.ca(x)}),skybox:x=>({u_matrix:new a.c8(x),u_sun_direction:new a.ca(x),u_cubemap:new a.cc(x),u_opacity:new a.cb(x),u_temporal_offset:new a.cb(x)}),skyboxGradient:x=>({u_matrix:new a.c8(x),u_color_ramp:new a.cc(x),u_center_direction:new a.ca(x),u_radius:new a.cb(x),u_opacity:new a.cb(x),u_temporal_offset:new a.cb(x)}),skyboxCapture:x=>({u_matrix_3f:new a.dj(x),u_sun_direction:new a.ca(x),u_sun_intensity:new a.cb(x),u_color_tint_r:new a.cQ(x),u_color_tint_m:new a.cQ(x),u_luminance:new a.cb(x)}),globeRaster:x=>({u_proj_matrix:new a.c8(x),u_globe_matrix:new a.c8(x),u_normalize_matrix:new a.c8(x),u_merc_matrix:new a.c8(x),u_zoom_transition:new a.cb(x),u_merc_center:new a.c9(x),u_image0:new a.cc(x),u_grid_matrix:new a.dj(x),u_skirt_height:new a.cb(x),u_far_z_cutoff:new a.cb(x),u_frustum_tl:new a.ca(x),u_frustum_tr:new a.ca(x),u_frustum_br:new a.ca(x),u_frustum_bl:new a.ca(x),u_globe_pos:new a.ca(x),u_globe_radius:new a.cb(x),u_viewport:new a.c9(x)}),globeAtmosphere:x=>({u_frustum_tl:new a.ca(x),u_frustum_tr:new a.ca(x),u_frustum_br:new a.ca(x),u_frustum_bl:new a.ca(x),u_horizon:new a.cb(x),u_transition:new a.cb(x),u_fadeout_range:new a.cb(x),u_color:new a.cQ(x),u_high_color:new a.cQ(x),u_space_color:new a.cQ(x),u_temporal_offset:new a.cb(x),u_horizon_angle:new a.cb(x)}),model:x=>({u_matrix:new a.c8(x),u_lighting_matrix:new a.c8(x),u_normal_matrix:new a.c8(x),u_node_matrix:new a.c8(x),u_lightpos:new a.ca(x),u_lightintensity:new a.cb(x),u_lightcolor:new a.ca(x),u_camera_pos:new a.ca(x),u_opacity:new a.cb(x),u_baseColorFactor:new a.cQ(x),u_emissiveFactor:new a.cQ(x),u_metallicFactor:new a.cb(x),u_roughnessFactor:new a.cb(x),u_baseTextureIsAlpha:new a.cc(x),u_alphaMask:new a.cc(x),u_alphaCutoff:new a.cb(x),u_baseColorTexture:new a.cc(x),u_metallicRoughnessTexture:new a.cc(x),u_normalTexture:new a.cc(x),u_occlusionTexture:new a.cc(x),u_emissionTexture:new a.cc(x),u_lutTexture:new a.cc(x),u_color_mix:new a.cQ(x),u_aoIntensity:new a.cb(x),u_emissive_strength:new a.cb(x),u_occlusionTextureTransform:new a.cQ(x)}),modelDepth:x=>({u_matrix:new a.c8(x),u_instance:new a.c8(x),u_node_matrix:new a.c8(x)}),groundShadow:x=>({u_matrix:new a.c8(x),u_ground_shadow_factor:new a.ca(x)}),stars:x=>({u_matrix:new a.c8(x),u_up:new a.ca(x),u_right:new a.ca(x),u_intensity_multiplier:new a.cb(x)}),snowParticle:x=>({u_modelview:new a.c8(x),u_projection:new a.c8(x),u_time:new a.cb(x),u_cam_pos:new a.ca(x),u_velocityConeAperture:new a.cb(x),u_velocity:new a.cb(x),u_horizontalOscillationRadius:new a.cb(x),u_horizontalOscillationRate:new a.cb(x),u_boxSize:new a.cb(x),u_billboardSize:new a.cb(x),u_simpleShapeParameters:new a.c9(x),u_screenSize:new a.c9(x),u_thinningCenterPos:new a.c9(x),u_thinningShape:new a.ca(x),u_thinningAffectedRatio:new a.cb(x),u_thinningParticleOffset:new a.cb(x),u_particleColor:new a.cQ(x),u_direction:new a.ca(x)}),rainParticle:x=>({u_modelview:new a.c8(x),u_projection:new a.c8(x),u_time:new a.cb(x),u_cam_pos:new a.ca(x),u_texScreen:new a.cc(x),u_velocityConeAperture:new a.cb(x),u_velocity:new a.cb(x),u_boxSize:new a.cb(x),u_rainDropletSize:new a.c9(x),u_distortionStrength:new a.cb(x),u_rainDirection:new a.ca(x),u_color:new a.cQ(x),u_screenSize:new a.c9(x),u_thinningCenterPos:new a.c9(x),u_thinningShape:new a.ca(x),u_thinningAffectedRatio:new a.cb(x),u_thinningParticleOffset:new a.cb(x),u_shapeDirectionalPower:new a.cb(x),u_shapeNormalPower:new a.cb(x),u_mode:new a.cb(x)}),vignette:x=>({u_vignetteShape:new a.ca(x),u_vignetteColor:new a.cQ(x)}),occlusion:x=>({u_matrix:new a.c8(x),u_anchorPos:new a.ca(x),u_screenSizePx:new a.c9(x),u_occluderSizePx:new a.c9(x),u_color:new a.cQ(x)})};class kc{constructor(s,u,y,S){this.id=kc.uniqueIdxCounter,kc.uniqueIdxCounter++,this.context=s;const A=s.gl;this.buffer=A.createBuffer(),this.dynamicDraw=!!y,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),A.bufferData(A.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||S||u.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){this.id=kc.uniqueIdxCounter,kc.uniqueIdxCounter++;const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}kc.uniqueIdxCounter=0;const Rx={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Bp{constructor(s,u,y,S,A,M){this.length=u.length,this.attributes=y,this.itemSize=u.bytesPerElement,this.dynamicDraw=S,this.instanceCount=M,this.context=s;const D=s.gl;this.buffer=D.createBuffer(),s.bindVertexBuffer.set(this.buffer),D.bufferData(D.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?D.DYNAMIC_DRAW:D.STATIC_DRAW),this.dynamicDraw||A||u.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,u){for(let y=0;y<this.attributes.length;y++){const S=u.attributes[this.attributes[y].name];S!==void 0&&s.enableVertexAttribArray(S)}}setVertexAttribPointers(s,u,y){for(let S=0;S<this.attributes.length;S++){const A=this.attributes[S],M=u.attributes[A.name];M!==void 0&&s.vertexAttribPointer(M,A.components,s[Rx[A.type]],!1,this.itemSize,A.offset+this.itemSize*(y||0))}}setVertexAttribDivisor(s,u,y){for(let S=0;S<this.attributes.length;S++){const A=u.attributes[this.attributes[S].name];A!==void 0&&this.instanceCount&&this.instanceCount>0&&s.vertexAttribDivisor(A,y)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class dc{constructor(s,u,y,S,A){this.context=s,this.width=u,this.height=y;const M=this.framebuffer=s.gl.createFramebuffer();S&&(this.colorAttachment=new cu(s,M)),A&&(this.depthAttachmentType=A,this.depthAttachment=A==="renderbuffer"?new lc(s,M):new cc(s,M))}destroy(){const s=this.context.gl;if(this.colorAttachment){const u=this.colorAttachment.get();u&&s.deleteTexture(u)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const u=this.depthAttachment.get();u&&s.deleteRenderbuffer(u)}else{const u=this.depthAttachment.get();u&&s.deleteTexture(u)}s.deleteFramebuffer(this.framebuffer)}}class si{constructor(s,u){this.gl=s,this.clearColor=new ng(this),this.clearDepth=new uh(this),this.clearStencil=new jx(this),this.colorMask=new rg(this),this.depthMask=new pf(this),this.stencilMask=new au(this),this.stencilFunc=new ig(this),this.stencilOp=new Mp(this),this.stencilTest=new Uo(this),this.depthRange=new yo(this),this.depthTest=new su(this),this.depthFunc=new vo(this),this.blend=new sc(this),this.blendFunc=new Wu(this),this.blendColor=new dh(this),this.blendEquation=new hh(this),this.cullFace=new mf(this),this.cullFaceSide=new ws(this),this.frontFace=new ma(this),this.program=new Hi(this),this.activeTexture=new ou(this),this.viewport=new oc(this),this.bindFramebuffer=new Pp(this),this.bindRenderbuffer=new Dc(this),this.bindTexture=new gf(this),this.bindVertexBuffer=new Mx(this),this.bindElementBuffer=new xf(this),this.bindVertexArrayOES=new yf(this),this.pixelStoreUnpack=new fh(this),this.pixelStoreUnpackPremultiplyAlpha=new vf(this),this.pixelStoreUnpackFlipY=new Px(this),this.options=u?Object.assign({},u):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=s.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=s.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=s.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=u&&!!u.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=s.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=s.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=s.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),this.maxPointSize=s.getParameter(s.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,u,y){return new kc(this,s,u,y)}createVertexBuffer(s,u,y,S,A){return new Bp(this,s,u,y,S,A)}createRenderbuffer(s,u,y){const S=this.gl,A=S.createRenderbuffer();return this.bindRenderbuffer.set(A),S.renderbufferStorage(S.RENDERBUFFER,s,u,y),this.bindRenderbuffer.set(null),A}createFramebuffer(s,u,y,S){return new dc(this,s,u,y,S)}clear({color:s,depth:u,stencil:y,colorMask:S}){const A=this.gl;let M=0;s&&(M|=A.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set(S||[!0,!0,!0,!0])),u!==void 0&&(M|=A.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),y!==void 0&&(M|=A.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),A.clear(M)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){a.bv(s.blendFunction,pr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor),s.blendEquation?this.blendEquation.set(s.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(s.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Gi;function ja(x,s,u,y,S,A,M){const D=x.context,z=D.gl,U=x.transform,H=x.getOrCreateProgram("collisionBox"),K=[];let X=0,J=0;for(let Pe=0;Pe<y.length;Pe++){const ze=y[Pe],Ie=s.getTile(ze),Oe=Ie.getBucket(u);if(!Oe)continue;const Ce=xp(ze,Oe,U);let Fe=Ce;S[0]===0&&S[1]===0||(Fe=x.translatePosMatrix(Ce,Ie,S,A));const $e=M?Oe.textCollisionBox:Oe.iconCollisionBox,st=Oe.collisionCircleArray;if(st.length>0){const et=a.bz(),_t=Fe;a.cB(et,Oe.placementInvProjMatrix,U.glCoordMatrix),a.cB(et,et,Oe.placementViewportMatrix),K.push({circleArray:st,circleOffset:J,transform:_t,invTransform:et,projection:Oe.getProjection()}),X+=st.length/4,J=X}$e&&(x.terrain&&x.terrain.setupElevationDraw(Ie,H),H.draw(x,z.LINES,_n.disabled,Kn.disabled,x.colorModeForRenderPass(),Jn.disabled,Ix(Fe,U,Ie,Oe.getProjection()),u.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,null,U.zoom,null,[$e.collisionVertexBuffer,$e.collisionVertexBufferExt]))}if(!M||!K.length)return;const de=x.getOrCreateProgram("collisionCircle"),ce=new a.dI;ce.resize(4*X),ce._trim();let fe=0;for(const Pe of K)for(let ze=0;ze<Pe.circleArray.length/4;ze++){const Ie=4*ze,Oe=Pe.circleArray[Ie+0],Ce=Pe.circleArray[Ie+1],Fe=Pe.circleArray[Ie+2],$e=Pe.circleArray[Ie+3];ce.emplace(fe++,Oe,Ce,Fe,$e,0),ce.emplace(fe++,Oe,Ce,Fe,$e,1),ce.emplace(fe++,Oe,Ce,Fe,$e,2),ce.emplace(fe++,Oe,Ce,Fe,$e,3)}(!Gi||Gi.length<2*X)&&(Gi=function(Pe){const ze=2*Pe,Ie=new a.a_;Ie.resize(ze),Ie._trim();for(let Oe=0;Oe<ze;Oe++){const Ce=6*Oe;Ie.uint16[Ce+0]=4*Oe+0,Ie.uint16[Ce+1]=4*Oe+1,Ie.uint16[Ce+2]=4*Oe+2,Ie.uint16[Ce+3]=4*Oe+2,Ie.uint16[Ce+4]=4*Oe+3,Ie.uint16[Ce+5]=4*Oe+0}return Ie}(X));const ue=D.createIndexBuffer(Gi,!0),ve=D.createVertexBuffer(ce,a.dJ.members,!0);for(const Pe of K){const ze={u_matrix:Pe.transform,u_inv_matrix:Pe.invTransform,u_camera_to_center_distance:(Ee=U).getCameraToCenterDistance(Pe.projection),u_viewport_size:[Ee.width,Ee.height]};de.draw(x,z.TRIANGLES,_n.disabled,Kn.disabled,x.colorModeForRenderPass(),Jn.disabled,ze,u.id,ve,ue,a.bd.simpleSegment(0,2*Pe.circleOffset,Pe.circleArray.length,Pe.circleArray.length/2),null,U.zoom)}var Ee;ve.destroy(),ue.destroy()}const Ju=a.bz();function Rc(x){const s=x._camera.getWorldToCamera(x.worldSize,1),u=a.az([],s,x.globeMatrix);a.bi(u,u);const y=[0,0,0],S=[0,1,0,0];return a.aA(S,S,u),y[0]=S[0],y[1]=S[1],y[2]=S[2],a.au(y,y),y}function zc({width:x,height:s,anchor:u,textOffset:y,textScale:S},A){const{horizontalAlign:M,verticalAlign:D}=a.bV(u),z=-(M-.5)*x,U=-(D-.5)*s,H=a.bU(u,y);return new a.P((z/S+H[0])*A,(U/S+H[1])*A)}function Mf(x,s,u,y,S,A,M,D,z,U){const H=x.text.placedSymbolArray,K=x.text.dynamicLayoutVertexArray,X=x.icon.dynamicLayoutVertexArray,J={},de=x.getProjection(),ce=yp(M,de,S),fe=S.elevation,ue=de.upVectorScale(M.canonical,S.center.lat,S.worldSize).metersToTile;K.clear();for(let ve=0;ve<H.length;ve++){const Ee=H.get(ve),{tileAnchorX:Pe,tileAnchorY:ze,numGlyphs:Ie}=Ee,Oe=Ee.hidden||!Ee.crossTileID||x.allowVerticalPlacement&&!Ee.placedOrientation?null:y[Ee.crossTileID];if(Oe){let Ce=0,Fe=0,$e=0;if(fe){const Et=fe?fe.getAtTileOffset(M,Pe,ze):0,[ct,Dt,wt]=de.upVector(M.canonical,Pe,ze);Ce=Et*ct*ue,Fe=Et*Dt*ue,$e=Et*wt*ue}let[st,et,_t,xt]=ko(Ee.projectedAnchorX+Ce,Ee.projectedAnchorY+Fe,Ee.projectedAnchorZ+$e,u?ce:A);const Bt=Mc(S.getCameraToCenterDistance(de),xt);let Je=a.bJ(x.textSizeData,z,Ee)*Bt/a.bO;u&&(Je*=x.tilePixelRatio/D);const lt=zc(Oe,Je);u?({x:st,y:et,z:_t}=de.projectTilePoint(Pe+lt.x,ze+lt.y,M.canonical),[st,et,_t]=ko(st+Ce,et+Fe,_t+$e,A)):(s&&lt._rotate(-S.angle),st+=lt.x,et+=lt.y,_t=0);const Ke=x.allowVerticalPlacement&&Ee.placedOrientation===a.bI.vertical?Math.PI/2:0;for(let Et=0;Et<Ie;Et++)a.bL(K,st,et,_t,Ke);U&&Ee.associatedIconIndex>=0&&(J[Ee.associatedIconIndex]={x:st,y:et,z:_t,angle:Ke})}else Kr(Ie,K)}if(U){X.clear();const ve=x.icon.placedSymbolArray;for(let Ee=0;Ee<ve.length;Ee++){const Pe=ve.get(Ee),{numGlyphs:ze}=Pe,Ie=J[Ee];if(Pe.hidden||!Ie)Kr(ze,X);else{const{x:Oe,y:Ce,z:Fe,angle:$e}=Ie;for(let st=0;st<ze;st++)a.bL(X,Oe,Ce,Fe,$e)}}x.icon.dynamicLayoutVertexBuffer.updateData(X)}x.text.dynamicLayoutVertexBuffer.updateData(K)}function ed(x,s,u,y,S,A,M={}){const D=u.paint.get("icon-translate"),z=u.paint.get("text-translate"),U=u.paint.get("icon-translate-anchor"),H=u.paint.get("text-translate-anchor"),K=u.layout.get("icon-rotation-alignment"),X=u.layout.get("text-rotation-alignment"),J=u.layout.get("icon-pitch-alignment"),de=u.layout.get("text-pitch-alignment"),ce=u.layout.get("icon-keep-upright"),fe=u.layout.get("text-keep-upright"),ue=u.paint.get("icon-color-saturation"),ve=u.paint.get("icon-color-contrast"),Ee=u.paint.get("icon-color-brightness-min"),Pe=u.paint.get("icon-color-brightness-max"),ze=u.layout.get("symbol-elevation-reference")==="sea",Ie=x.context,Oe=Ie.gl,Ce=x.transform,Fe=K==="map",$e=X==="map",st=J==="map",et=de==="map",_t=u.layout.get("symbol-sort-key").constantOr(1)!==void 0;let xt=!1;const Bt=x.depthModeForSublayer(0,_n.ReadOnly),Je=new _n(x.context.gl.LEQUAL,_n.ReadOnly,x.depthRangeFor3D),lt=[a.ay(Ce.center.lng),a.aH(Ce.center.lat)],Ke=u.layout.get("text-variable-anchor"),Et=Ce.projection.name==="globe",ct=[],Dt=[0,-1,0];for(const wt of y){const Ot=s.getTile(wt),zt=Ot.getBucket(u);if(!zt||zt.projection.name==="mercator"&&Et||zt.fullyClipped)continue;const yn=zt.projection.name==="globe",Tn=yn?a.ah(Ce.zoom):0,gn=yp(wt,zt.getProjection(),Ce),Pn=Ce.calculatePixelsToTileUnitsMatrix(Ot),Sn=Ke&&zt.hasTextData(),qn=zt.hasIconTextFit()&&Sn&&zt.hasIconData(),ir=zt.elevationType==="road"?Je:Bt,$n=zt.getProjection().createInversionMatrix(Ce,wt.canonical),ur=x.shadowRenderer,Yn=zt.elevationType==="road"&&!!ur&&ur.enabled;let Bn=[0,0,0];if(Yn){const Ni=x.style.directionalLight,rr=x.style.ambientLight;Ni&&rr&&(Bn=nc(x.style,Ni,rr))}const Tr=Ni=>{Ce.depthOcclusionForSymbolsAndCircles&&(u.hasInitialOcclusionOpacityProperties||x.terrain)&&(Ni.push("DEPTH_D24"),Ni.push("DEPTH_OCCLUSION"))},ei=()=>{const Ni=Fe&&u.layout.get("symbol-placement")!=="point",rr=[];Tr(rr);const _i=Ni||qn,kr=u.paint.get("icon-image-cross-fade");x.terrainRenderModeElevated()&&st&&rr.push("PITCH_WITH_MAP_TERRAIN"),yn&&(rr.push("PROJECTION_GLOBE_VIEW"),_i&&rr.push("PROJECTED_POS_ON_VIEWPORT")),kr>0&&rr.push("ICON_TRANSITION"),zt.icon.zOffsetVertexBuffer&&rr.push("Z_OFFSET"),ue===0&&ve===0&&Ee===0&&Pe===1||rr.push("COLOR_ADJUSTMENT"),zt.sdfIcons&&rr.push("RENDER_SDF"),Yn&&rr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const qr=zt.icon.programConfigurations.get(u.id),Hr=x.getOrCreateProgram("symbol",{config:qr,defines:rr}),Di=Ot.imageAtlasTexture?Ot.imageAtlasTexture.size:[0,0],za=zt.iconSizeData,bi=a.bH(za,Ce.zoom),xa=st||Ce.pitch!==0,di=wl(gn,Ot.tileID.canonical,st,Fe,Ce,zt.getProjection(),Pn),Sa=Xd(gn,Ot.tileID.canonical,st,Fe,Ce,zt.getProjection(),Pn),io=x.translatePosMatrix(Sa,Ot,D,U,!0),Ho=x.translatePosMatrix(gn,Ot,D,U),ao=_i?Ju:di,Go=Fe&&!st&&!Ni;let xc=Dt;!Et&&!Ce.mercatorFromTransition||Fe||(xc=Rc(Ce));const Wo=yn?xc:Dt,ul=u.getColorAdjustmentMatrix(ue,ve,Ee,Pe),Es=Cf(za.kind,bi,Go,st,x,Ho,ao,io,ze,!1,Di,[0,0],!0,wt,Tn,lt,$n,Wo,zt.getProjection(),Bn,ul,kr),xd=Ot.imageAtlasTexture?Ot.imageAtlasTexture:null,so=u.layout.get("icon-size").constantOr(0)!==1||zt.iconsNeedLinear,nm=zt.sdfIcons||x.options.rotating||x.options.zooming||so||xa?Oe.LINEAR:Oe.NEAREST,rm=zt.sdfIcons&&u.paint.get("icon-halo-width").constantOr(1)!==0,im=x.terrain&&st&&Ni?a.bi(a.bz(),di):Ju;if(Ni&&zt.icon){const hi=Ce.elevation,_u=hi?hi.getAtTileOffsetFunc(wt,Ce.center.lat,Ce.worldSize,zt.getProjection()):null,am=Zd(gn,Ot.tileID.canonical,st,Fe,Ce,zt.getProjection(),Pn);Kd(zt,gn,x,!1,am,Sa,st,ce,_u,wt)}return{program:Hr,buffers:zt.icon,uniformValues:Es,atlasTexture:xd,atlasTextureIcon:null,atlasInterpolation:nm,atlasInterpolationIcon:null,isSDF:zt.sdfIcons,hasHalo:rm,depthMode:ir,tile:Ot,renderWithShadows:Yn,labelPlaneMatrixInv:im}},ar=()=>{const Ni=$e&&u.layout.get("symbol-placement")!=="point",rr=[],_i=Ni||Ke||qn;x.terrainRenderModeElevated()&&et&&rr.push("PITCH_WITH_MAP_TERRAIN"),yn&&(rr.push("PROJECTION_GLOBE_VIEW"),_i&&rr.push("PROJECTED_POS_ON_VIEWPORT")),zt.text.zOffsetVertexBuffer&&rr.push("Z_OFFSET"),zt.iconsInText&&rr.push("RENDER_TEXT_AND_SYMBOL"),rr.push("RENDER_SDF"),Yn&&rr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Tr(rr);const kr=zt.text.programConfigurations.get(u.id),qr=x.getOrCreateProgram("symbol",{config:kr,defines:rr});let Hr,Di=[0,0],za=null;const bi=zt.textSizeData;zt.iconsInText&&(Di=Ot.imageAtlasTexture?Ot.imageAtlasTexture.size:[0,0],za=Ot.imageAtlasTexture?Ot.imageAtlasTexture:null,Hr=et||Ce.pitch!==0||x.options.rotating||x.options.zooming||bi.kind==="composite"||bi.kind==="camera"?Oe.LINEAR:Oe.NEAREST);const xa=Ot.glyphAtlasTexture?Ot.glyphAtlasTexture.size:[0,0],di=u.layout.get("text-size-scale-range"),Sa=a.aD(x.scaleFactor,di[0],di[1]),io=a.bH(bi,Ce.zoom,Sa),Ho=wl(gn,Ot.tileID.canonical,et,$e,Ce,zt.getProjection(),Pn),ao=Xd(gn,Ot.tileID.canonical,et,$e,Ce,zt.getProjection(),Pn),Go=x.translatePosMatrix(ao,Ot,z,H,!0),xc=x.translatePosMatrix(gn,Ot,z,H),Wo=_i?Ju:Ho,ul=$e&&!et&&!Ni;let Es=Dt;!Et&&!Ce.mercatorFromTransition||$e||(Es=Rc(Ce));const xd=Cf(bi.kind,io,ul,et,x,xc,Wo,Go,ze,!0,xa,Di,!0,wt,Tn,lt,$n,yn?Es:Dt,zt.getProjection(),Bn,null,null,Sa),so=Ot.glyphAtlasTexture?Ot.glyphAtlasTexture:null,nm=Oe.LINEAR,rm=u.paint.get("text-halo-width").constantOr(1)!==0,im=x.terrain&&et&&Ni?a.bi(a.bz(),Ho):Ju;if(Ni&&zt.text){const hi=Ce.elevation,_u=hi?hi.getAtTileOffsetFunc(wt,Ce.center.lat,Ce.worldSize,zt.getProjection()):null,am=Zd(gn,Ot.tileID.canonical,et,$e,Ce,zt.getProjection(),Pn);Kd(zt,gn,x,!0,am,ao,et,fe,_u,wt)}return{program:qr,buffers:zt.text,uniformValues:xd,atlasTexture:so,atlasTextureIcon:za,atlasInterpolation:nm,atlasInterpolationIcon:Hr,isSDF:!0,hasHalo:rm,depthMode:ir,tile:Ot,renderWithShadows:Yn,labelPlaneMatrixInv:im}},Er=zt.icon.segments.get().length,Fr=zt.text.segments.get().length,Ur=Er&&!M.onlyText?ei():null,ti=Fr&&!M.onlyIcons?ar():null,Pi=u.paint.get("icon-opacity").constantOr(1),ta=u.paint.get("text-opacity").constantOr(1);if(_t&&zt.canOverlap){xt=!0;const Ni=Pi&&!M.onlyText?zt.icon.segments.get():[],rr=ta&&!M.onlyIcons?zt.text.segments.get():[];for(const _i of Ni)ct.push({segments:new a.bd([_i]),sortKey:_i.sortKey,state:Ur});for(const _i of rr)ct.push({segments:new a.bd([_i]),sortKey:_i.sortKey,state:ti})}else M.onlyText||ct.push({segments:Pi?zt.icon.segments:new a.bd([]),sortKey:0,state:Ur}),M.onlyIcons||ct.push({segments:ta?zt.text.segments:new a.bd([]),sortKey:0,state:ti})}xt&&ct.sort((wt,Ot)=>wt.sortKey-Ot.sortKey);for(const wt of ct){const Ot=wt.state;if(Ot)if(x.terrain?x.terrain.setupElevationDraw(Ot.tile,Ot.program,{useDepthForOcclusion:Ce.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Ot.labelPlaneMatrixInv}):x.setupDepthForOcclusion(Ce.depthOcclusionForSymbolsAndCircles,Ot.program),Ie.activeTexture.set(Oe.TEXTURE0),Ot.atlasTexture&&Ot.atlasTexture.bind(Ot.atlasInterpolation,Oe.CLAMP_TO_EDGE,!0),Ot.atlasTextureIcon&&(Ie.activeTexture.set(Oe.TEXTURE1),Ot.atlasTextureIcon&&Ot.atlasTextureIcon.bind(Ot.atlasInterpolationIcon,Oe.CLAMP_TO_EDGE,!0)),Ot.renderWithShadows&&x.shadowRenderer.setupShadows(Ot.tile.tileID.toUnwrapped(),Ot.program,"vector-tile",Ot.tile.tileID.overscaledZ),x.uploadCommonLightUniforms(x.context,Ot.program),Ot.hasHalo){const zt=Ot.uniformValues;zt.u_is_halo=1,td(Ot.buffers,wt.segments,u,x,Ot.program,Ot.depthMode,S,A,zt,2),zt.u_is_halo=0}else{if(Ot.isSDF){const zt=Ot.uniformValues;Ot.hasHalo&&(zt.u_is_halo=1,td(Ot.buffers,wt.segments,u,x,Ot.program,Ot.depthMode,S,A,zt,1)),zt.u_is_halo=0}td(Ot.buffers,wt.segments,u,x,Ot.program,Ot.depthMode,S,A,Ot.uniformValues,1)}}}function td(x,s,u,y,S,A,M,D,z,U){const H=[x.dynamicLayoutVertexBuffer,x.opacityVertexBuffer,x.iconTransitioningVertexBuffer,x.globeExtVertexBuffer,x.zOffsetVertexBuffer];S.draw(y,y.context.gl.TRIANGLES,A,M,D,Jn.disabled,z,u.id,x.layoutVertexBuffer,x.indexBuffer,s,u.paint,y.transform.zoom,x.programConfigurations.get(u.id),H,U)}function Pf(x,s){const u=1<<x.canonical.z,y=(s.x*u-x.canonical.x-x.wrap*u)*a.aj,S=(s.y*u-x.canonical.y)*a.aj,A=a.dS(s.z,s.y);return a.cS(y,S,A)}function Ma(x,s,u,y,S){if(!u.layout||u.layout.get("fill-elevation-reference")==="none")return;const A=x.context.gl,M=new _n(x.context.gl.LEQUAL,_n.ReadWrite,x.depthRangeFor3D),D=new _n(x.context.gl.GREATER,_n.ReadWrite,x.depthRangeFor3D),z=function(J){const de=a.cJ(J.pitch);let ce=.01;return J.isOrthographic&&(ce=a.ai(1e-4,ce,a.cO(de>=nu?1:de/nu))),2*ce}(x.transform),U=x.transform.getFreeCameraOptions().position,H="elevatedStructuresDepthReconstruct",K=x.getOrCreateProgram(H,{defines:["DEPTH_RECONSTRUCTION"]}),X=x.getOrCreateProgram(H);for(const J of y){const de=s.getTile(J),ce=de.getBucket(u);if(!ce)continue;const fe=ce.elevatedStructures;if(!fe)continue;const ue=ce.elevationBufferData.heightRange,ve=Pf(J.toUnwrapped(),U),Ee=x.translatePosMatrix(J.projMatrix,de,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));let Pe,ze,Ie,Oe;if(S==="initialize"){if(!ue||ue.min>=1||fe.depthSegments.segments[0].primitiveLength===0)continue;Pe=xh(Ee,ve,z,1,0),ze=M,Ie=fe.depthSegments,Oe=K}else if(S==="reset"){if(!ue||ue.min>=0||fe.maskSegments.segments[0].primitiveLength===0)continue;Pe=xh(Ee,ve,0,0,1),ze=D,Ie=fe.maskSegments,Oe=K}else if(S==="geometry"){if(fe.depthSegments.segments[0].primitiveLength===0)continue;Pe=xh(Ee,ve,z,1,0),ze=M,Ie=fe.depthSegments,Oe=X}Oe.draw(x,A.TRIANGLES,ze,Kn.disabled,pr.disabled,Jn.disabled,Pe,u.id,fe.vertexBuffer,fe.indexBuffer,Ie,u.paint,x.transform.zoom)}}function mn(x,s,u){const{painter:y,sourceCache:S,layer:A,coords:M,colorMode:D,elevationType:z,terrainEnabled:U,pass:H}=x,K=y.context.gl,X=A.paint.get("fill-pattern"),J=A.paint.get("fill-pattern-cross-fade"),de=X.constantOr(null);let ce=z;z!=="road"||s&&!U||(ce="none");const fe=ce==="road",ue=x.painter.shadowRenderer,ve=fe&&!!ue&&ue.enabled,Ee=new _n(y.context.gl.LEQUAL,_n.ReadOnly,y.depthRangeFor3D);let Pe=[0,0,0];if(ve){const Oe=y.style.directionalLight,Ce=y.style.ambientLight;Oe&&Ce&&(Pe=nc(y.style,Oe,Ce))}const ze=X&&X.constantOr(1),Ie=(Oe,Ce)=>{let Fe,$e,st,et,_t;Ce?(Fe=ze&&!A.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",st=K.LINES):(Fe=ze?"fillPattern":"fill",st=K.TRIANGLES);for(const xt of M){const Bt=S.getTile(xt);if(ze&&!Bt.patternsLoaded())continue;const Je=Bt.getBucket(A);if(!Je)continue;const lt=s?Je.elevationBufferData:Je.bufferData;if(lt.isEmpty())continue;y.prepareDrawTile();const Ke=lt.programConfigurations.get(A.id),Et=y.isTileAffectedByFog(xt),ct=[],Dt=[];fe&&(ct.push("ELEVATED_ROADS"),Dt.push(lt.elevatedLayoutVertexBuffer)),ve&&ct.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),ze&&(y.context.activeTexture.set(K.TEXTURE0),Bt.imageAtlasTexture&&Bt.imageAtlasTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE),Ke.updatePaintBuffers());let wt=!1;if(de&&Bt.imageAtlas){const gn=Bt.imageAtlas,Pn=a.dN.from(de),Sn=Pn.getPrimary().scaleSelf(a.q.devicePixelRatio).toString(),qn=Pn.getSecondary(),ir=gn.patternPositions.get(Sn),$n=qn?gn.patternPositions.get(qn.scaleSelf(a.q.devicePixelRatio).toString()):null;wt=!!ir&&!!$n,ir&&Ke.setConstantPatternPositions(ir,$n)}J>0&&(wt||Ke.getPatternTransitionVertexBuffer("fill-pattern"))&&ct.push("FILL_PATTERN_TRANSITION");const Ot=y.getOrCreateProgram(Fe,{config:Ke,overrideFog:Et,defines:ct}),zt=y.translatePosMatrix(xt.projMatrix,Bt,A.paint.get("fill-translate"),A.paint.get("fill-translate-anchor"));ve&&ue.setupShadows(Bt.tileID.toUnwrapped(),Ot,"vector-tile",Bt.tileID.overscaledZ);const yn=A.paint.get("fill-emissive-strength");if(Ce){et=lt.lineIndexBuffer,_t=lt.lineSegments;const gn=y.terrain&&y.terrain.renderingToTexture?y.terrain.drapeBufferSize:[K.drawingBufferWidth,K.drawingBufferHeight];$e=Fe==="fillOutlinePattern"&&ze?Fy(zt,yn,y,Bt,gn,Pe,J):Rp(zt,yn,gn,Pe)}else et=lt.indexBuffer,_t=lt.triangleSegments,$e=ze?Ox(zt,yn,y,Bt,Pe,J):kp(zt,yn,Pe);y.uploadCommonUniforms(y.context,Ot,xt.toUnwrapped());let Tn=Oe;(z==="road"&&!U||z==="offset")&&(Tn=Ee),Ot.draw(y,st,Tn,u||y.stencilModeForClipping(xt),D,Jn.disabled,$e,A.id,lt.layoutVertexBuffer,et,_t,A.paint,y.transform.zoom,Ke,Dt)}};y.renderPass===H&&Ie(y.depthModeForSublayer(1,y.renderPass==="opaque"?_n.ReadWrite:_n.ReadOnly),!1),ce==="none"&&y.renderPass==="translucent"&&A.paint.get("fill-antialias")&&Ie(y.depthModeForSublayer(A.getPaintProperty("fill-outline-color")?2:0,_n.ReadOnly),!0)}function vh(x,s,u,y,S,A,M,D){u.resetLayerRenderingStats(x);const z=x.context,U=z.gl,H=x.transform,K=u.paint.get("fill-extrusion-pattern"),X=u.paint.get("fill-extrusion-pattern-cross-fade"),J=K.constantOr(null),de=K.constantOr(1),ce=u.paint.get("fill-extrusion-opacity"),fe=x.style.enable3dLights(),ue=u.paint.get(fe&&!de?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),ve=[u.paint.get("fill-extrusion-ambient-occlusion-intensity"),ue],Ee=u.layout.get("fill-extrusion-edge-radius"),Pe=Ee>0&&!u.paint.get("fill-extrusion-rounded-roof"),ze=Pe?0:Ee,Ie=H.projection.name==="globe"?a.dT():0,Oe=H.projection.name==="globe",Ce=Oe?a.ah(H.zoom):0,Fe=[a.ay(H.center.lng),a.aH(H.center.lat)],$e=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",st=u.paint.get("fill-extrusion-flood-light-color").toRenderColor($e?null:u.lut).toArray01().slice(0,3),et=u.paint.get("fill-extrusion-flood-light-intensity"),_t=u.paint.get("fill-extrusion-vertical-scale"),xt=u.paint.get("fill-extrusion-line-width").constantOr(1)!==0,Bt=u.paint.get("fill-extrusion-height-alignment"),Je=u.paint.get("fill-extrusion-base-alignment"),lt=ih(x,u.paint.get("fill-extrusion-cutoff-fade-range")),Ke=[];let Et;Oe&&Ke.push("PROJECTION_GLOBE_VIEW"),ve[0]>0&&Ke.push("FAUX_AO"),Pe&&Ke.push("ZERO_ROOF_RADIUS"),D&&Ke.push("HAS_CENTROID"),et>0&&Ke.push("FLOOD_LIGHT"),lt.shouldRenderCutoff&&Ke.push("RENDER_CUTOFF"),xt&&Ke.push("RENDER_WALL_MODE");const ct=x.renderPass==="shadow",Dt=x.shadowRenderer,wt=ct&&!!Dt,Ot=ct?Jn.disabled:Jn.backCCW;x.shadowRenderer&&(x.shadowRenderer.useNormalOffset=!0);let zt=[0,0,0];if(Dt){const gn=x.style.directionalLight,Pn=x.style.ambientLight;gn&&Pn&&(zt=nc(x.style,gn,Pn)),ct||(Ke.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Dt.useNormalOffset&&Ke.push("NORMAL_OFFSET")),Et=Ke.concat(["SHADOWS_SINGLE_CASCADE"])}const yn=wt?"fillExtrusionDepth":de?"fillExtrusionPattern":"fillExtrusion",Tn=u.getLayerRenderingStats();for(const gn of y){const Pn=s.getTile(gn),Sn=Pn.getBucket(u);if(!Sn||Sn.projection.name!==H.projection.name)continue;let qn=!1;Dt&&(qn=Dt.getMaxCascadeForTile(gn.toUnwrapped())===0);const ir=x.isTileAffectedByFog(gn),$n=Sn.programConfigurations.get(u.id);let ur=!1;if(J&&Pn.imageAtlas){const Fr=Pn.imageAtlas,Ur=a.dN.from(J),ti=Ur.getPrimary().scaleSelf(a.q.devicePixelRatio).toString(),Pi=Ur.getSecondary(),ta=Fr.patternPositions.get(ti),Ni=Pi?Fr.patternPositions.get(Pi.scaleSelf(a.q.devicePixelRatio).toString()):null;ur=!!ta&&!!Ni,ta&&$n.setConstantPatternPositions(ta,Ni)}X>0&&(ur||$n.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&Ke.push("FILL_EXTRUSION_PATTERN_TRANSITION");const Yn=x.getOrCreateProgram(yn,{config:$n,defines:qn?Et:Ke,overrideFog:ir});if(x.terrain&&x.terrain.setupElevationDraw(Pn,Yn,{useMeterToDem:!0}),!Sn.centroidVertexBuffer){const Fr=Yn.attributes.a_centroid_pos;Fr!==void 0&&U.vertexAttrib2f(Fr,0,0)}!ct&&Dt&&Dt.setupShadows(Pn.tileID.toUnwrapped(),Yn,"vector-tile",Pn.tileID.overscaledZ),de&&(x.context.activeTexture.set(U.TEXTURE0),Pn.imageAtlasTexture&&Pn.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),$n.updatePaintBuffers());const Bn=u.paint.get("fill-extrusion-vertical-gradient"),Tr=1/Sn.tileToMeter;let ei;if(ct&&Dt){if(zx(Pn.tileID,Sn,x))continue;const Fr=Dt.calculateShadowPassMatrixFromTile(Pn.tileID.toUnwrapped());ei=gh(Fr,ze,Tr,_t,Bt,Je)}else{const Fr=x.translatePosMatrix(gn.expandedProjMatrix,Pn,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Ur=H.projection.createInversionMatrix(H,gn.canonical);ei=de?Dx(Fr,x,Bn,ce,ve,ze,Tr,gn,Pn,Ie,Bt,Je,Ce,Fe,Ur,st,_t,X):Ku(Fr,x,Bn,ce,ve,ze,Tr,gn,Ie,Bt,Je,Ce,Fe,Ur,st,_t,et,zt)}x.uploadCommonUniforms(z,Yn,gn.toUnwrapped(),null,lt);let ar=Sn.segments;if(H.projection.name==="mercator"&&!ct&&(ar=Sn.getVisibleSegments(Pn.tileID,x.terrain,x.transform.getFrustum(0)),!ar.get().length))continue;if(Tn)if(ct)for(const Fr of ar.get())Tn.numRenderedVerticesInShadowPass+=Fr.primitiveLength;else for(const Fr of ar.get())Tn.numRenderedVerticesInTransparentPass+=Fr.primitiveLength;const Er=[];(x.terrain||D)&&Er.push(Sn.centroidVertexBuffer),Oe&&Er.push(Sn.layoutVertexExtBuffer),xt&&Er.push(Sn.wallVertexBuffer),Yn.draw(x,z.gl.TRIANGLES,S,A,M,Ot,ei,u.id,Sn.layoutVertexBuffer,Sn.indexBuffer,ar,u.paint,x.transform.zoom,$n,Er)}x.shadowRenderer&&(x.shadowRenderer.useNormalOffset=!1)}function nd(x,s,u,y,S,A,M,D,z,U,H,K,X,J,de,ce,fe,ue,ve){const Ee=x.context,Pe=Ee.gl,ze=x.transform,Ie=x.transform.zoom,Oe=[],Ce=ih(x,u.paint.get("fill-extrusion-cutoff-fade-range"));U==="clear"?(Oe.push("CLEAR_SUBPASS"),ve&&(Oe.push("CLEAR_FROM_TEXTURE"),Ee.activeTexture.set(Pe.TEXTURE0),ve.bind(Pe.LINEAR,Pe.CLAMP_TO_EDGE))):U==="sdf"&&Oe.push("SDF_SUBPASS"),fe&&Oe.push("HAS_CENTROID"),Ce.shouldRenderCutoff&&Oe.push("RENDER_CUTOFF");const Fe=u.layout.get("fill-extrusion-edge-radius"),$e=(st,et,_t,xt,Bt)=>{const Je=et.programConfigurations.get(u.id),lt=x.isTileAffectedByFog(st),Ke=x.getOrCreateProgram("fillExtrusionGroundEffect",{config:Je,defines:Oe,overrideFog:lt}),Et=((Dt,wt,Ot,zt,yn,Tn,gn,Pn,Sn,qn,ir)=>({u_matrix:wt,u_opacity:Ot,u_ao_pass:zt?1:0,u_meter_to_tile:yn,u_ao:Tn,u_flood_light_intensity:gn,u_flood_light_color:Pn,u_attenuation:Sn,u_edge_radius:qn,u_fb:0,u_fb_size:ir,u_dynamic_offset:1}))(0,xt,H,z,Bt,[K,X*Bt],J,de,ce,Ie>=17?0:Fe*Bt,ve?ve.size[0]:0),ct=[];fe&&ct.push(et.hiddenByLandmarkVertexBuffer),x.uploadCommonUniforms(Ee,Ke,st.toUnwrapped(),null,Ce),Ke.draw(x,Ee.gl.TRIANGLES,S,A,M,D,Et,u.id,et.vertexBuffer,et.indexBuffer,_t,u.paint,Ie,Je,ct)};for(const st of y){const et=s.getTile(st),_t=et.getBucket(u);if(!_t||_t.projection.name!==ze.projection.name||!_t.groundEffect||_t.groundEffect&&!_t.groundEffect.hasData())continue;const xt=_t.groundEffect,Bt=1/_t.tileToMeter;{const Je=x.translatePosMatrix(st.projMatrix,et,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),lt=xt.getDefaultSegment();$e(st,xt,lt,Je,Bt)}if(ue)for(let Je=0;Je<4;Je++){const lt=a.dU[Je](st),Ke=s.getTile(lt);if(!Ke)continue;const Et=Ke.getBucket(u);if(!Et||Et.projection.name!==ze.projection.name||!Et.groundEffect||Et.groundEffect&&!Et.groundEffect.hasData())continue;const ct=Et.groundEffect;let Dt,wt;Je===0?(Dt=[-a.aj,0,0],wt=1):Je===1?(Dt=[a.aj,0,0],wt=0):Je===2?(Dt=[0,-a.aj,0],wt=3):(Dt=[0,a.aj,0],wt=2);const Ot=ct.regionSegments[wt];if(!Ot)continue;const zt=new Float32Array(16);a.bo(zt,st.projMatrix,Dt),$e(st,ct,Ot,x.translatePosMatrix(zt,et,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Bt)}}}function hu(x,s,u,y,S,A,M){y.centroidVertexArray.length===0&&y.createCentroidsBuffer();const D=A?A.findDEMTileFor(u):null;if(!(D&&D.dem||M))return;A&&D&&D.dem&&y.selfDEMTileTimestamp!==D.dem._timestamp&&(y.borderDoneWithNeighborZ=[-1,-1,-1,-1],y.selfDEMTileTimestamp=D.dem._timestamp);const z=ue=>new a.P(Math.ceil((ue+a.dX)*a.dY),0),U=ue=>{const ve=s.getSource().minzoom,Ee=ze=>{const Ie=s.getTileByID(ze);if(Ie&&Ie.hasData())return Ie.getBucket(S)},Pe=[0,-1,1];for(const ze of Pe){if(ue.overscaledZ+ze<ve)continue;const Ie=Ee(ue.calculateScaledKey(ue.overscaledZ+ze));if(Ie)return Ie}},H=[0,0,0],K=(ue,ve)=>(H[0]=Math.min(ue.min.y,ve.min.y),H[1]=Math.max(ue.max.y,ve.max.y),H[2]=a.aj-ve.min.x>ue.max.x?ve.min.x-a.aj:ue.max.x,H),X=(ue,ve)=>(H[0]=Math.min(ue.min.x,ve.min.x),H[1]=Math.max(ue.max.x,ve.max.x),H[2]=a.aj-ve.min.y>ue.max.y?ve.min.y-a.aj:ue.max.y,H),J=[(ue,ve)=>K(ue,ve),(ue,ve)=>K(ve,ue),(ue,ve)=>X(ue,ve),(ue,ve)=>X(ve,ue)],de=(ue,ve,Ee,Pe,ze,Ie,Oe)=>{if(!A)return 0;const Ce=[[Ie?Ee:ue,Ie?ue:Ee,0],[Ie?Ee:ve,Ie?ve:Ee,0]],Fe=Oe<0?a.aj+Oe:Oe,$e=[Ie?Fe:(ue+ve)/2,Ie?(ue+ve)/2:Fe,0];return Ee===0&&Oe<0||Ee!==0&&Oe>0?A.getForTilePoints(ze,[$e],!0,Pe):Ce.push($e),A.getForTilePoints(u,Ce,!0,D),Math.max(Ce[0][2],Ce[1][2],$e[2])/A.exaggeration()};for(let ue=0;ue<4;ue++){const ve=y.borderFeatureIndices[ue];if(ve.length===0)continue;const Ee=a.dU[ue](u),Pe=U(Ee);if(!(Pe&&Pe instanceof a.dV))continue;const ze=A?A.findDEMTileFor(Ee):null;if(!(ze&&ze.dem||M)||(A&&ze&&ze.dem&&y.borderDEMTileTimestamp[ue]!==ze.dem._timestamp&&(y.borderDoneWithNeighborZ[ue]=-1,y.borderDEMTileTimestamp[ue]=ze.dem._timestamp),y.borderDoneWithNeighborZ[ue]===Pe.canonical.z))continue;Pe.centroidVertexArray.length===0&&Pe.createCentroidsBuffer();const Ie=(ue<2?1:5)-ue,Oe=Pe.borderDoneWithNeighborZ[Ie]!==y.canonical.z,Ce=Pe.borderFeatureIndices[Ie];let Fe=0;if(y.canonical.z!==Pe.canonical.z){for(const $e of ve)y.showCentroid(y.featuresOnBorder[$e]);if(Oe)for(const $e of Ce)Pe.showCentroid(Pe.featuresOnBorder[$e]);y.borderDoneWithNeighborZ[ue]=Pe.canonical.z,Pe.borderDoneWithNeighborZ[Ie]=y.canonical.z}for(const $e of ve){const st=y.featuresOnBorder[$e],et=y.centroidData[st.centroidDataIndex],_t=st.borders[ue];let xt;for(;Fe<Ce.length;){xt=Pe.featuresOnBorder[Ce[Fe]];const Bt=xt.borders[Ie];if(Bt[1]>_t[0]+3||Bt[0]>_t[0]-3)break;Pe.showCentroid(xt),Fe++}if(xt&&Fe<Ce.length){const Bt=Fe;let Je=0;for(;!(xt.borders[Ie][0]>_t[1]-3)&&(Je++,++Fe!==Ce.length);)xt=Pe.featuresOnBorder[Ce[Fe]];xt=Pe.featuresOnBorder[Ce[Bt]];let lt=!1;if(Je>=1){const ct=xt.borders[Ie];Math.abs(_t[0]-ct[0])<3&&Math.abs(_t[1]-ct[1])<3&&(Je=1,lt=!0,Fe=Bt+1)}else if(Je===0){y.showCentroid(st);continue}const Ke=Pe.centroidData[xt.centroidDataIndex];M&&lt&&(((ce=et).flags|(fe=Ke).flags)&a.dW?(ce.flags|=a.dW,fe.flags|=a.dW):(ce.flags&=~a.dW,fe.flags&=~a.dW));const Et=st.intersectsCount()>1||xt.intersectsCount()>1;if(Je>1)Fe=Bt,et.centroidXY=Ke.centroidXY=new a.P(0,0);else if(ze&&ze.dem&&!Et){const ct=J[ue](et,Ke),Dt=ue%2?a.aj-1:0,wt=de(ct[0],Math.min(a.aj-1,ct[1]),Dt,ze,Ee,ue<2,ct[2]);et.centroidXY=Ke.centroidXY=z(wt)}else Et?et.centroidXY=Ke.centroidXY=new a.P(0,0):(et.centroidXY=y.encodeBorderCentroid(st),Ke.centroidXY=Pe.encodeBorderCentroid(xt));y.writeCentroidToBuffer(et),Pe.writeCentroidToBuffer(Ke)}else y.showCentroid(st)}y.borderDoneWithNeighborZ[ue]=Pe.canonical.z,Pe.borderDoneWithNeighborZ[Ie]=y.canonical.z}var ce,fe;(y.needsCentroidUpdate||!y.centroidVertexBuffer&&y.centroidVertexArray.length!==0)&&y.uploadCentroid(x)}const rd=[1,0,0],Un=[0,1,0],Vp=[0,0,1];function zx(x,s,u){const y=u.transform,S=u.shadowRenderer;if(!S)return!0;const A=x.toUnwrapped(),M=y.tileSize*S._cascades[u.currentShadowCascade].scale;let D=s.maxHeight;if(y.elevation){const ce=y.elevation.getMinMaxForTile(x);ce&&(D+=ce.max)}const z=[...S.shadowDirection];z[2]=-z[2];const U=S.computeSimplifiedTileShadowVolume(A,D,M,z);if(!U)return!1;const H=[rd,Un,Vp,z,[z[0],0,z[2]],[0,z[1],z[2]]],K=y.projection.name==="globe",X=y.scaleZoom(M),J=a.cn.fromInvProjectionMatrix(y.invProjMatrix,y.worldSize,X,!K),de=S.getCurrentCascadeFrustum();return J.intersectsPrecise(U.vertices,U.planes,H)===0||de.intersectsPrecise(U.vertices,U.planes,H)===0}function So(x){return[x[0]*a.dZ,x[1]*a.dZ,x[2]*a.dZ,0]}function Ra(x,s,u,y,S,A,M,D,z){const U=y.getSource(),H=u.globeSharedBuffers;if(!H)return;let K,X,J;if(s&&(K=y.getTile(s)),U instanceof a.aP?(X=U.texture,J=a.ds(0,0,u.transform)):K&&s&&(X=K.texture,J=a.ds(s.canonical.z,s.canonical.x,u.transform)),!X||!J)return;x||(J=a.cE(a.bz(),J,[1,-1,1]));const de=u.context,ce=de.gl,fe=S.paint.get("raster-resampling")==="nearest"?ce.NEAREST:ce.LINEAR,ue=u.colorModeForDrapableLayerRenderPass(A),ve=M.defines;ve.push("GLOBE_POLES");const Ee=new _n(ce.LEQUAL,_n.ReadWrite,u.depthRangeFor3D),Pe=Float32Array.from(u.transform.expandedFarZProjMatrix),ze=Float32Array.from(a.bh(a.dr(new a.cp(0,0,0))));u.terrain&&u.terrain.prepareDrawTile(),de.activeTexture.set(ce.TEXTURE0),X.bind(fe,ce.CLAMP_TO_EDGE),de.activeTexture.set(ce.TEXTURE1),X.bind(fe,ce.CLAMP_TO_EDGE),"useMipmap"in X&&de.extTextureFilterAnisotropic&&u.transform.pitch>20&&ce.texParameterf(ce.TEXTURE_2D,de.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,de.extTextureFilterAnisotropicMax);const[Ie,Oe,Ce,Fe]=s?H.getPoleBuffers(s.canonical.z,!1):H.getPoleBuffers(0,!0),$e=S.paint.get("raster-elevation");let st;x?(st=Ie,u.renderDefaultNorthPole=$e!==0):(st=Oe,u.renderDefaultSouthPole=$e!==0);const et=So(M.mix),_t=((Bt,Je,lt,Ke,Et,ct,Dt,wt,Ot,zt,yn,Tn,gn)=>bo(Bt,Je,lt,new Float32Array(16),new Float32Array(9),[0,0],Ke,[0,0],[0,0,0,0],1,{opacity:1,mix:0},ct,[0,0],wt,2,zt,yn,Tn,1,0,gn))(Pe,ze,J,a.ah(u.transform.zoom),0,S,0,$e,0,et,M.offset,M.range,A),xt=u.getOrCreateProgram("raster",{defines:ve});u.uploadCommonUniforms(de,xt,null),xt.draw(u,ce.TRIANGLES,Ee,z,ue,D,_t,S.id,st,Ce,Fe)}function cg(x){const s=x._nearZ,u=x.projection.farthestPixelDistance(x),y=u-s,S=.2*x.height,A=s+S;return[s,u,(A-S-s)/y,(A-s)/y]}function Up(x,s,u,y){if(x)return s instanceof rs&&x instanceof hp?s.getTextureDescriptor(x,u,!0):{texture:x.texture,mix:So(y.mix),offset:y.offset,buffer:0,tileSize:1}}var $p=a.d_([{name:"a_index",type:"Int16",components:1}]);class Lx{constructor(s,u,y,S){const A={width:y[0],height:y[1],data:null},M=s.gl;this.targetColorTexture=new a.T(s,A,M.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new a.T(s,A,M.RGBA8,{useMipmap:!1}),this.context=s,this.updateParticleTexture(u,S),this.lastInvalidatedAt=0}updateParticleTexture(s,u){if(this.particleTextureDimension===u.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const y=this.context.gl,S=u.width*u.height;this.particleTexture0=new a.T(this.context,u,y.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new a.T(this.context,u,y.RGBA8,{premultiply:!1,useMipmap:!1});const A=new a.d$;A.reserve(S);for(let M=0;M<S;M++)A.emplaceBack(M);this.particleIndexBuffer=this.context.createVertexBuffer(A,$p.members,!0),this.particleSegment=a.bd.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=u.width}update(s){return!(this.lastInvalidatedAt<s&&(this.lastInvalidatedAt=a.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function fu(x,s,u){if(!x)return null;const y=s.getTextureDescriptor(x,u,!0);if(!y)return null;let{texture:S,mix:A,offset:M,tileSize:D,buffer:z,format:U}=y;if(!S||!U)return null;let H=!1;return U==="uint32"&&(H=!0,A[3]=0,A=sg(a.e0,A,[0,u.paint.get("raster-particle-max-speed")]),M=zp(a.e0,M,[0,u.paint.get("raster-particle-max-speed")])),{texture:S,textureOffset:[z/(D+2*z),D/(D+2*z)],tileSize:D,scalarData:H,scale:A,offset:M,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[U]]}}function Nf(x){const s=x._nearZ,u=x.projection.farthestPixelDistance(x),y=u-s,S=.2*x.height,A=s+S;return[s,u,(A-S-s)/y,(A-s)/y]}const qp=new a.am(1,0,0,1),Hp=new a.am(0,1,0,1),ug=new a.am(0,0,1,1),To=new a.am(1,0,1,1),pu=new a.am(0,1,1,1);function id(x,s,u,y,S,A,M){const D=x.context,z=x.transform,U=D.gl,H=z.projection.name==="globe",K=H?["PROJECTION_GLOBE_VIEW"]:[];let X=a.bw(u.projMatrix);if(H&&a.ah(z.zoom)>0){const et=a.bg(u.canonical,z),_t=a.e1(et);X=a.az(new Float32Array(16),z.globeMatrix,_t),a.az(X,z.projMatrix,X)}const J=a.bz();J[12]+=2*S/(a.q.devicePixelRatio*z.width),J[13]+=2*A/(a.q.devicePixelRatio*z.height),a.az(X,J,X);const de=x.getOrCreateProgram("debug",{defines:K}),ce=s.getTileByID(u.key);x.terrain&&x.terrain.setupElevationDraw(ce,de);const fe=_n.disabled,ue=Kn.disabled,ve=x.colorModeForRenderPass(),Ee="$debug";D.activeTexture.set(U.TEXTURE0),x.emptyTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),H?ce._makeGlobeTileDebugBuffers(x.context,z):ce._makeDebugTileBoundsBuffers(x.context,z.projection);const Pe=ce._tileDebugBuffer||x.debugBuffer,ze=ce._tileDebugIndexBuffer||x.debugIndexBuffer,Ie=ce._tileDebugSegments||x.debugSegments;if(de.draw(x,U.LINE_STRIP,fe,ue,ve,Jn.disabled,Oc(X,y),Ee,Pe,ze,Ie,null,null,null,[ce._globeTileDebugBorderBuffer]),M){const et=ce.latestRawTileData,_t=Math.floor((et&&et.byteLength||0)/1024);let xt=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(xt+=` => ${u.overscaledZ}`),xt+=` ${ce.state}`,xt+=` ${_t}kb`,function(Bt,Je){Bt.initDebugOverlayCanvas();const lt=Bt.debugOverlayCanvas,Ke=Bt.context.gl,Et=Bt.debugOverlayCanvas.getContext("2d");Et.clearRect(0,0,lt.width,lt.height),Et.shadowColor="white",Et.shadowBlur=2,Et.lineWidth=1.5,Et.strokeStyle="white",Et.textBaseline="top",Et.font="bold 36px Open Sans, sans-serif",Et.fillText(Je,5,5),Et.strokeText(Je,5,5),Bt.debugOverlayTexture.update(lt),Bt.debugOverlayTexture.bind(Ke.LINEAR,Ke.CLAMP_TO_EDGE)}(x,xt)}const Oe=s.getTile(u).tileSize,Ce=512/Math.min(Oe,512)*(u.overscaledZ/z.zoom)*.5,Fe=ce._tileDebugTextBuffer||x.debugBuffer,$e=ce._tileDebugTextIndexBuffer||x.quadTriangleIndexBuffer,st=ce._tileDebugTextSegments||x.debugSegments;de.draw(x,U.TRIANGLES,fe,ue,pr.alphaBlended,Jn.disabled,Oc(X,a.am.transparent,Ce),Ee,Fe,$e,st,null,null,null,[ce._globeTileDebugTextBuffer])}function Gp(x,s,u,y){ad(x,0,s+u/2,x.transform.width,u,y)}function Wp(x,s,u,y){ad(x,s-u/2,0,u,x.transform.height,y)}function ad(x,s,u,y,S,A){const M=x.context,D=M.gl;D.enable(D.SCISSOR_TEST),D.scissor(s*a.q.devicePixelRatio,u*a.q.devicePixelRatio,y*a.q.devicePixelRatio,S*a.q.devicePixelRatio),M.clear({color:A}),D.disable(D.SCISSOR_TEST)}const Fx=a.d_([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Pl}=Fx;function ui(x,s,u,y){x.emplaceBack(s,u,y)}class Df{constructor(s){this.vertexArray=new a.e2,this.indices=new a.a_,ui(this.vertexArray,-1,-1,1),ui(this.vertexArray,1,-1,1),ui(this.vertexArray,-1,1,1),ui(this.vertexArray,1,1,1),ui(this.vertexArray,-1,-1,-1),ui(this.vertexArray,1,-1,-1),ui(this.vertexArray,-1,1,-1),ui(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=s.createVertexBuffer(this.vertexArray,Pl),this.indexBuffer=s.createIndexBuffer(this.indices),this.segment=a.bd.simpleSegment(0,0,36,12)}}function mu(x,s,u,y,S,A){const M=x.context.gl,D=s.paint.get("sky-atmosphere-color"),z=s.paint.get("sky-atmosphere-halo-color"),U=s.paint.get("sky-atmosphere-sun-intensity"),H=((K,X,J,de,ce)=>({u_matrix_3f:K,u_sun_direction:X,u_sun_intensity:J,u_color_tint_r:[de.r,de.g,de.b,de.a],u_color_tint_m:[ce.r,ce.g,ce.b,ce.a],u_luminance:5e-5}))(a.e4(a.dx(),y),S,U,D,z);M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_CUBE_MAP_POSITIVE_X+A,s.skyboxTexture,0),u.draw(x,M.TRIANGLES,_n.disabled,Kn.disabled,pr.unblended,Jn.frontCW,H,"skyboxCapture",s.skyboxGeometry.vertexBuffer,s.skyboxGeometry.indexBuffer,s.skyboxGeometry.segment)}const dg=a.d_([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Bx{constructor(s){const u=new a.e5;u.emplaceBack(-1,1,1,0,0),u.emplaceBack(1,1,1,1,0),u.emplaceBack(1,-1,1,1,1),u.emplaceBack(-1,-1,1,0,1);const y=new a.a_;y.emplaceBack(0,1,2),y.emplaceBack(2,3,0),this.vertexBuffer=s.createVertexBuffer(u,dg.members),this.indexBuffer=s.createIndexBuffer(y),this.segments=a.bd.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Vx=a.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class By{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class _h{constructor(s){this.colorModeAlphaBlendedWriteRGB=new pr([1,eo,1,eo],a.am.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new pr([1,0,1,0],a.am.transparent,[!1,!1,!1,!0]),this.params=new By,this.updateNeeded=!0,s.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),s.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(s){const u=s.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Bx(u);const y=this.params.sizeRange,S=this.params.intensityRange,A=function(H){const K=a.ea(30),X=[];for(let J=0;J<H;++J){const de=2*Math.PI*K(),ce=Math.acos(1-2*K())-.5*Math.PI;X.push(a.cS(Math.cos(ce)*Math.cos(de),Math.cos(ce)*Math.sin(de),Math.sin(ce)))}return X}(this.params.starsCount),M=a.ea(300),D=new a.e6,z=new a.a_;let U=0;for(let H=0;H<A.length;++H){const K=a.b$([],A[H],200),X=Math.max(0,1+.01*y*(1*M()-.5)),J=Math.max(0,1+.01*S*(1*M()-.5));D.emplaceBack(K[0],K[1],K[2],-1,-1,X,J),D.emplaceBack(K[0],K[1],K[2],1,-1,X,J),D.emplaceBack(K[0],K[1],K[2],1,1,X,J),D.emplaceBack(K[0],K[1],K[2],-1,1,X,J),z.emplaceBack(U+0,U+1,U+2),z.emplaceBack(U+0,U+2,U+3),U+=4}this.starsVx=u.createVertexBuffer(D,Vx.members),this.starsIdx=u.createIndexBuffer(z),this.starsSegments=a.bd.simpleSegment(0,0,D.length,z.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(s,u){const y=s.context,S=y.gl,A=s.transform,M=new _n(S.LEQUAL,_n.ReadOnly,[0,1]),D=a.ah(A.zoom),z=s.style.getLut(u.scope),U=u.properties.get("color-use-theme")==="none",H=u.properties.get("color").toRenderColor(U?null:z).toArray01(),K=u.properties.get("high-color-use-theme")==="none",X=u.properties.get("high-color").toRenderColor(K?null:z).toArray01(),J=u.properties.get("space-color-use-theme")==="none",de=u.properties.get("space-color").toRenderColor(J?null:z).toArray01PremultipliedAlpha(),ce=5e-4,fe=a.e7(u.properties.get("horizon-blend"),0,1,ce,.25),ue=a.dl(s,y,A)&&fe===ce?A.worldSize/(2*Math.PI*1.025)-1:A.globeRadius,ve=s.frameCounter/1e3%1,Ee=a.ae(A.globeCenterInViewSpace),Pe=Math.sqrt(Math.pow(Ee,2)-Math.pow(ue,2)),ze=Math.acos(Pe/Ee),Ie=Oe=>{const Ce=A.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Oe&&Ce.push("ALPHA_PASS");const Fe=s.getOrCreateProgram("globeAtmosphere",{defines:Ce}),$e=((et,_t,xt,Bt,Je,lt,Ke,Et,ct,Dt,wt,Ot)=>({u_frustum_tl:et,u_frustum_tr:_t,u_frustum_br:xt,u_frustum_bl:Bt,u_horizon:Je,u_transition:lt,u_fadeout_range:Ke,u_color:Et,u_high_color:ct,u_space_color:Dt,u_temporal_offset:wt,u_horizon_angle:Ot}))(A.frustumCorners.TL,A.frustumCorners.TR,A.frustumCorners.BR,A.frustumCorners.BL,A.frustumCorners.horizon,D,fe,H,X,de,ve,ze);s.uploadCommonUniforms(y,Fe);const st=this.atmosphereBuffer;st&&Fe.draw(s,S.TRIANGLES,M,Kn.disabled,Oe?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Jn.backCW,$e,Oe?"atmosphere_glow_alpha":"atmosphere_glow",st.vertexBuffer,st.indexBuffer,st.segments)};Ie(!1),Ie(!0)}drawStars(s,u){const y=a.aD(u.properties.get("star-intensity"),0,1);if(y===0)return;const S=s.context,A=S.gl,M=s.transform,D=s.getOrCreateProgram("stars"),z=a.bY([]);a.b_(z,z,-M._pitch),a.bZ(z,z,-M.angle),a.b_(z,z,a.al(M._center.lat)),a.e8(z,z,-a.al(M._center.lng));const U=a.c3(new Float32Array(16),z),H=a.az([],M.starsProjMatrix,U),K=a.e4([],U),X=a.e9([],K),J=[0,1,0];a.dz(J,J,X),a.b$(J,J,this.params.sizeMultiplier);const de=[1,0,0];a.dz(de,de,X),a.b$(de,de,this.params.sizeMultiplier);const ce=(fe=J,ue=de,ve=y,{u_matrix:Float32Array.from(H),u_up:fe,u_right:ue,u_intensity_multiplier:ve});var fe,ue,ve;s.uploadCommonUniforms(S,D),this.starsVx&&this.starsIdx&&D.draw(s,A.TRIANGLES,_n.disabled,Kn.disabled,this.colorModeAlphaBlendedWriteRGB,Jn.disabled,ce,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function sd(x,s){const u=[...x],y=s.cameraWorldSizeForFog/s.worldSize,S=a.bx([]);return a.cE(S,S,[y,y,1]),a.az(u,S,u),a.az(u,s.worldToFogMatrix,u),u}function Xt(x,s,u,y,S){const A=u.material,M=y.context,{baseColorTexture:D,metallicRoughnessTexture:z}=A.pbrMetallicRoughness,{normalTexture:U,occlusionTexture:H,emissionTexture:K}=A;function X(de,ce,fe){if(de&&(x.push(ce),M.activeTexture.set(M.gl.TEXTURE0+fe),de.gfxTexture)){const{minFilter:ue,magFilter:ve,wrapS:Ee,wrapT:Pe}=de.sampler;de.gfxTexture.bindExtraParam(ue,ve,Ee,Pe)}}X(D,"HAS_TEXTURE_u_baseColorTexture",zs.BaseColor),X(z,"HAS_TEXTURE_u_metallicRoughnessTexture",zs.MetallicRoughness),X(U,"HAS_TEXTURE_u_normalTexture",zs.Normal),X(H,"HAS_TEXTURE_u_occlusionTexture",zs.Occlusion),X(K,"HAS_TEXTURE_u_emissionTexture",zs.Emission),S&&(S.texture||(S.texture=new a.ed(y.context,S.image,[S.image.height,S.image.height,S.image.height],M.gl.RGBA8)),M.activeTexture.set(M.gl.TEXTURE0+zs.LUT),S.texture&&S.texture.bind(M.gl.LINEAR,M.gl.CLAMP_TO_EDGE),x.push("APPLY_LUT_ON_GPU")),u.texcoordBuffer&&(x.push("HAS_ATTRIBUTE_a_uv_2f"),s.push(u.texcoordBuffer)),u.colorBuffer&&(x.push(u.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),s.push(u.colorBuffer)),u.normalBuffer&&(x.push("HAS_ATTRIBUTE_a_normal_3f"),s.push(u.normalBuffer)),u.pbrBuffer&&(x.push("HAS_ATTRIBUTE_a_pbr"),x.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),s.push(u.pbrBuffer)),A.alphaMode!=="OPAQUE"&&A.alphaMode!=="MASK"||x.push("UNPREMULT_TEXTURE_IN_SHADER"),A.defined||x.push("DIFFUSE_SHADED");const J=y.shadowRenderer;J&&(x.push("RENDER_SHADOWS","DEPTH_TEXTURE"),J.useNormalOffset&&x.push("NORMAL_OFFSET"))}function fn(x,s,u,y,S,A){const M=u.paint.get("model-opacity").constantOr(1),D=s.context,z=new _n(s.context.gl.LEQUAL,_n.ReadWrite,s.depthRangeFor3D),U=s.transform,H=x.mesh,K=H.material,X=K.pbrMetallicRoughness,J=s.style.fog;let de;de=s.transform.projection.zAxisUnit==="pixels"?[...x.nodeModelMatrix]:a.az([],y.zScaleMatrix,x.nodeModelMatrix),a.az(de,y.negCameraPosMatrix,de);const ce=a.bi([],de);a.ee(ce,ce);const fe=u.paint.get("model-color-use-theme").constantOr("default")==="none",ue=u.paint.get("model-emissive-strength").constantOr(0),ve=Qu(new Float32Array(x.worldViewProjection),new Float32Array(de),new Float32Array(ce),null,s,M,X.baseColorFactor.toRenderColor(null),K.emissiveFactor,X.metallicFactor,X.roughnessFactor,K,ue,u),Ee={defines:[]},Pe=[],ze=s.shadowRenderer;ze&&(ze.useNormalOffset=!1),Xt(Ee.defines,Pe,H,s,fe?null:u.lut);let Ie=null;if(J){const Fe=sd(x.nodeModelMatrix,s.transform);if(Ie=new Float32Array(Fe),U.projection.name!=="globe"){const $e=H.aabb.min,st=H.aabb.max,[et,_t]=J.getOpacityForBounds(Fe,$e[0],$e[1],st[0],st[1]);Ee.overrideFog=et>=qt||_t>=qt}}const Oe=ih(s,u.paint.get("model-cutoff-fade-range"));Oe.shouldRenderCutoff&&Ee.defines.push("RENDER_CUTOFF");const Ce=s.getOrCreateProgram("model",Ee);s.uploadCommonUniforms(D,Ce,null,Ie,Oe),s.renderPass!=="shadow"&&ze&&ze.setupShadowsFromMatrix(x.nodeModelMatrix,Ce),Ce.draw(s,D.gl.TRIANGLES,z,S,A,H.material.doubleSided?Jn.disabled:Jn.backCCW,ve,u.id,H.vertexBuffer,H.indexBuffer,H.segments,u.paint,s.transform.zoom,void 0,Pe)}function Nl(x,s,u,y,S,A,M){let D;D=x.projection.name==="globe"?a.ef(u,x):[...u],a.az(D,D,s.matrix);const z=a.az([],y,D);if(s.meshes)for(const U of s.meshes){if(U.material.alphaMode!=="BLEND"){M.push({mesh:U,depth:0,modelIndex:S,worldViewProjection:z,nodeModelMatrix:D});continue}const H=a.ad([],U.centroid,z);!x.isOrthographic&&H[2]<=0||A.push({mesh:U,depth:H[2],modelIndex:S,worldViewProjection:z,nodeModelMatrix:D})}if(s.children)for(const U of s.children)Nl(x,U,u,y,S,A,M)}function Yi(x,s,u,y){const S=u.shadowRenderer;if(!S)return;const A=S.getShadowPassDepthMode(),M=S.getShadowPassColorMode(),D=S.calculateShadowPassMatrixFromMatrix(s),z=yh(D);u.getOrCreateProgram("modelDepth",{defines:u._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(u,u.context.gl.TRIANGLES,A,Kn.disabled,M,Jn.backCCW,z,y.id,x.vertexBuffer,x.indexBuffer,x.segments,y.paint,u.transform.zoom,void 0,void 0)}function rt(x,s,u){const y=s.updateZoomBasedPaintProperties(),S=function(A,M,D){let z,U,H,K=A.terrain?A.terrain.exaggeration():0;if(A.terrain&&K>0){const X=A.terrain,J=X.findDEMTileFor(D);J&&J.dem?z=a.el.create(X,D,J):K=0}if(K===0&&(M.terrainElevationMin=0,M.terrainElevationMax=0),K===M.validForExaggeration&&(K===0||z&&z._demTile&&z._demTile.tileID===M.validForDEMTile.id&&z._dem._timestamp===M.validForDEMTile.timestamp))return!1;for(const X in M.instancesPerModel){const J=M.instancesPerModel[X];for(let de=0;de<J.instancedDataArray.length;++de){const ce=(z?K*z.getElevationAt(0|J.instancedDataArray.float32[16*de],0|J.instancedDataArray.float32[16*de+1],!0,!0):0)+J.instancesEvaluatedElevation[de];J.instancedDataArray.float32[16*de+6]=ce,U=U?Math.min(M.terrainElevationMin,ce):ce,H=H?Math.max(M.terrainElevationMax,ce):ce}}return M.terrainElevationMin=U||0,M.terrainElevationMax=H||0,M.validForExaggeration=K,M.validForDEMTile=z&&z._demTile?{id:z._demTile.tileID,timestamp:z._dem._timestamp}:{id:void 0,timestamp:0},!0}(x,s,u);(y||S)&&(s.uploaded=!1,s.upload(x.context))}const $o={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new a.cV([0,0,0],[a.aj,a.aj,0])};function od(x,s){const u=1<<x.canonical.z,y=s.getFreeCameraOptions().position,S=s.elevation,A=x.canonical.x/u,M=(x.canonical.x+1)/u,D=x.canonical.y/u,z=(x.canonical.y+1)/u;let U=s._centerAltitude;if(S){const J=S.getMinMaxForTile(x);J&&J.max>U&&(U=J.max)}const H=a.aD(y.x,A,M)-y.x,K=a.aD(y.y,D,z)-y.y,X=a.c6(U,s.center.lat)-y.z;return s._zoomFromMercatorZ(Math.sqrt(H*H+K*K+X*X))}function Zp(x,s,u,y,S,A,M){const D=x.context,z=x.renderPass==="shadow",U=x.shadowRenderer,H=z&&U?U.getShadowPassDepthMode():new _n(D.gl.LEQUAL,_n.ReadWrite,x.depthRangeFor3D),K=x.isTileAffectedByFog(A);if(u.meshes)for(const X of u.meshes){const J=["MODEL_POSITION_ON_GPU"],de=[];let ce,fe,ue;y.instancedDataArray.length>20&&J.push("INSTANCED_ARRAYS");const ve=ih(x,s.paint.get("model-cutoff-fade-range"));if(ve.shouldRenderCutoff&&J.push("RENDER_CUTOFF"),z&&U)ce=x.getOrCreateProgram("modelDepth",{defines:J}),fe=yh(M.shadowTileMatrix,M.shadowTileMatrix,Float32Array.from(u.matrix)),ue=U.getShadowPassColorMode();else{Xt(J,de,X,x,s.paint.get("model-color-use-theme").constantOr("default")==="none"?null:s.lut),ce=x.getOrCreateProgram("model",{defines:J,overrideFog:K});const Pe=X.material,ze=Pe.pbrMetallicRoughness,Ie=s.paint.get("model-opacity").constantOr(1),Oe=s.paint.get("model-emissive-strength").constantOr(0);fe=Qu(A.expandedProjMatrix,Float32Array.from(u.matrix),new Float32Array(16),null,x,Ie,ze.baseColorFactor.toRenderColor(null),Pe.emissiveFactor,ze.metallicFactor,ze.roughnessFactor,Pe,Oe,s,S),U&&(M.shadowUniformsInitialized?ce.setShadowUniformValues(D,U.getShadowUniformValues()):(U.setupShadows(A.toUnwrapped(),ce,"model-tile",A.overscaledZ),M.shadowUniformsInitialized=!0)),ue=ve.shouldRenderCutoff||Ie<1||Pe.alphaMode!=="OPAQUE"?pr.alphaBlended:pr.unblended}x.uploadCommonUniforms(D,ce,A.toUnwrapped(),null,ve);const Ee=X.material.doubleSided?Jn.disabled:Jn.backCCW;if(y.instancedDataArray.length>20)de.push(y.instancedDataBuffer),ce.draw(x,D.gl.TRIANGLES,H,Kn.disabled,ue,Ee,fe,s.id,X.vertexBuffer,X.indexBuffer,X.segments,s.paint,x.transform.zoom,void 0,de,y.instancedDataArray.length);else{const Pe=z?"u_instance":"u_normal_matrix";for(let ze=0;ze<y.instancedDataArray.length;++ze)fe[Pe]=new Float32Array(y.instancedDataArray.arrayBuffer,64*ze,16),ce.draw(x,D.gl.TRIANGLES,H,Kn.disabled,ue,Ee,fe,s.id,X.vertexBuffer,X.indexBuffer,X.segments,s.paint,x.transform.zoom,void 0,de)}}if(u.children)for(const X of u.children)Zp(x,s,X,y,S,A,M)}const hg=[1,-1,1];function Ux(x,s,u,y){if(!u.modelManager)return!0;const S=u.modelManager;if(!u.shadowRenderer)return!0;const A=u.shadowRenderer,M=s.aabb;let D=!0,z=x.maxHeight;if(z===0){let H=0;for(const K in x.instancesPerModel){const X=S.getModel(K,y);X?H=Math.max(H,Math.max(Math.max(X.aabb.max[0],X.aabb.max[1]),X.aabb.max[2])):D=!1}z=x.maxScale*H*1.41+x.maxVerticalOffset,D&&(x.maxHeight=z)}M.max[2]=z,M.min[2]+=x.terrainElevationMin,M.max[2]+=x.terrainElevationMax,a.ad(M.min,M.min,s.tileMatrix),a.ad(M.max,M.max,s.tileMatrix);const U=M.intersects(A.getCurrentCascadeFrustum());return u.currentShadowCascade===0&&(x.isInsideFirstShadowMapFrustum=U===2),U===0}function $x(x,s){const u=x.uniformValues.u_cutoff_params[0],y=x.uniformValues.u_cutoff_params[1],S=x.uniformValues.u_cutoff_params[2],A=x.uniformValues.u_cutoff_params[3];return y===u||A===S?1:a.aD(((s-u)/(y-u)-S)/(A-S),0,1)}function bh(x,s,u,y){if(s.pitch<20)return 1;const S=s.getWorldToCameraMatrix();a.az(S,S,x);const A=a.ei(u.min[0],u.min[1],u.min[2],1);let M=a.aA(a.ej(),A,S),D=M,z=M;A[1]=u.max[1],M=a.aA(a.ej(),A,S),D=M[1]<D[1]?M:D,z=M[1]>z[1]?M:z,A[0]=u.max[0],M=a.aA(a.ej(),A,S),D=M[1]<D[1]?M:D,z=M[1]>z[1]?M:z,A[1]=u.min[1],M=a.aA(a.ej(),A,S),D=M[1]<D[1]?M:D,z=M[1]>z[1]?M:z;const U=a.aD(y[0],0,1),H=100*s.pixelsPerMeter*a.aD(y[1],0,1),K=a.aD(y[2],0,1),X=a.ek(a.ej(),D,z,U),J=Math.tan(.5*s.fovX),de=-X[2]*J;if(H===0)return X[1]<-Math.abs(de)?K:1;const ce=(-Math.abs(de)-X[1])/H,fe=(ve,Ee,Pe)=>(1-Pe)*ve+Pe*Ee,ue=a.aD(fe(1,K,ce),K,1);return fe(1,ue,a.aD((s.pitch-20)/20,0,1))}class Vy{}class qx{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(s,u,y){{const K=this._storage.get(u.id);if(K)return K.lastUsedFrameIdx=s,K.buf}const S=y.gl,A=S.getBufferParameter(S.ELEMENT_ARRAY_BUFFER,S.BUFFER_SIZE),M=new ArrayBuffer(A),D=new Int16Array(M);S.getBufferSubData(S.ELEMENT_ARRAY_BUFFER,0,new Int16Array(M));const z=new a.en;for(let K=0;K<A/2;K+=3){const X=D[K],J=D[K+1],de=D[K+2];z.emplaceBack(X,J),z.emplaceBack(J,de),z.emplaceBack(de,X)}const U=y.bindVertexArrayOES.current,H=new Vy;return H.buf=new kc(y,z),H.lastUsedFrameIdx=s,this._storage.set(u.id,H),y.bindVertexArrayOES.set(U),H.buf}update(s){for(const[u,y]of this._storage)s-y.lastUsedFrameIdx>30&&(y.buf.destroy(),this._storage.delete(u))}destroy(){for(const[s,u]of this._storage)u.buf.destroy(),this._storage.delete(s)}}class Hx{constructor(s){this.occluderSize=30,this.depthOffset=-1e-4,s.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),s.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Xp=a.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class Kp{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class fg{constructor(s,u){this.revealStart=11,this.revealRange=2,s.registerParameter(this,[...u,"Reveal"],"revealStart",{min:0,max:17,step:.05}),s.registerParameter(this,[...u,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const Gx=a.d_([{type:"Float32",name:"a_pos_2f",components:2}]);class pg{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(s,u){const y=s.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const M=new a.eo,D=new a.a_;M.emplaceBack(-1,-1),M.emplaceBack(1,-1),M.emplaceBack(1,1),M.emplaceBack(-1,1),D.emplaceBack(0,1,2),D.emplaceBack(0,2,3),this.vignetteVx=s.context.createVertexBuffer(M,Gx.members),this.vignetteIdx=s.context.createIndexBuffer(D)}const S=a.bd.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){s.uploadCommonUniforms(s.context,y);const M={u_vignetteShape:(A={vignetteShape:[u.start,u.range,Math.pow(10,u.fadePower)],vignetteColor:[u.color.r,u.color.g,u.color.b,u.color.a*u.strength]}).vignetteShape,u_vignetteColor:A.vignetteColor};y.draw(s,s.context.gl.TRIANGLES,_n.disabled,Kn.disabled,pr.alphaBlended,Jn.disabled,M,"vignette",this.vignetteVx,this.vignetteIdx,S)}var A}}class wh{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(s,u){const y=s.getFreeCameraOptions().position,S=y.toAltitude(),A=y.toLngLat(),M=a.al(A.lng),D=a.al(A.lat),z=s.pixelsPerMeter/u,U=M*a.eq,H=a.eq*Math.log(Math.tan(Math.PI/4+D/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const K=-this._offsetYPrev+H,X=-this._elevationPrev+S;this._accumulatedOffsetX+=(-this._offsetXPrev+U)*z,this._accumulatedOffsetY+=K*z,this._accumulatedElevation+=X*z,this._offsetXPrev=U,this._offsetYPrev=H,this._elevationPrev=S}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function ld(x,s){return[-(x[0]-Math.floor(x[0]/s)*s),-(x[1]-Math.floor(x[1]/s)*s),-(x[2]-Math.floor(x[2]/s)*s)]}function mg(x){const s=a.ea(1323123451230),u=[];for(let y=0;y<x;++y){const S=2*s()-1,A=2*s()-1,M=2*s()-1;u.push(a.cS(S,A,M))}return u}function Lc(x,s,u,y,S){const A=a.aD((S-u)/(y-u),0,1);return(1-A)*x+A*s}class Ls{constructor(s){this._movement=new wh,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new pg,this._ppmScaleFactor=s}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(s,u){const y=s.transform;this._movement.update(y,this._ppmScaleFactor);const S=y.starsProjMatrix,A=a.bY([]);a.b_(A,A,a.al(90)-y._pitch),a.bZ(A,A,-y.angle);const M=a.c3(new Float32Array(16),A),D=a.ep(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),z=a.ee([],D),U=a.az([],z,M),H=Date.now()/1e3;return this._accumulatedTimeFromStart+=(H-this._prevTime)*u,this._prevTime=H,{projectionMatrix:S,modelviewMatrix:U}}}class Uy extends Ls{constructor(s){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new fg(s.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(s){const u=s.context;if(!this.particlesVx){const y=mg(this.particlesCount),S=new a.er,A=new a.a_;let M=0;const D=a.ea(1323123451230);for(let z=0;z<y.length;++z){const U=y[z],H=[2*D()-1,D(),D(),D()];S.emplaceBack(U[0],U[1],U[2],-1,-1,...H),S.emplaceBack(U[0],U[1],U[2],1,-1,...H),S.emplaceBack(U[0],U[1],U[2],1,1,...H),S.emplaceBack(U[0],U[1],U[2],-1,1,...H),A.emplaceBack(M+0,M+1,M+2),A.emplaceBack(M+0,M+2,M+3),M+=4}this.particlesVx=u.createVertexBuffer(S,Xp.members),this.particlesIdx=u.createIndexBuffer(A)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.rain)return;const u=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},y=s.transform.zoom;if(u.revealStart>y)return;const S=Lc(0,1,u.revealStart,u.revealStart+u.revealRange,y);if(!this.particlesVx||!this.particlesIdx)return;const A=structuredClone(this._params);let M=[-A.direction.x,A.direction.y,-100];a.au(M,M);const D=structuredClone(this._vignetteParams);D.strength*=S,A.overrideStyleParameters||(A.intensity=s.style.rain.state.density,A.timeFactor=s.style.rain.state.intensity,A.color=structuredClone(s.style.rain.state.color),M=structuredClone(s.style.rain.state.direction),A.screenThinning.intensity=s.style.rain.state.centerThinning,A.dropletSizeX=s.style.rain.state.dropletSize[0],A.dropletSizeYScale=s.style.rain.state.dropletSize[1]/s.style.rain.state.dropletSize[0],A.distortionStrength=100*s.style.rain.state.distortionStrength,D.strength=1,D.color=structuredClone(s.style.rain.state.vignetteColor));const z=this.updateOnRender(s,A.timeFactor),U=s.context,H=U.gl,K=s.transform;this.screenTexture&&this.screenTexture.size[0]===s.width&&this.screenTexture.size[1]===s.height||(this.screenTexture=new a.T(U,{width:s.width,height:s.height,data:null},H.RGBA8)),A.distortionStrength>0&&(U.activeTexture.set(H.TEXTURE0),this.screenTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),H.copyTexSubImage2D(H.TEXTURE_2D,0,0,0,0,0,s.width,s.height));const X=s.getOrCreateProgram("rainParticle");s.uploadCommonUniforms(U,X),U.activeTexture.set(H.TEXTURE0),this.screenTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE);const J=[A.color.r,A.color.g,A.color.b,A.color.a],de=(ce,fe)=>{const ue=ld(this._movement.getPosition(),ce),ve=A.dropletSizeX,Ee=A.dropletSizeX*A.dropletSizeYScale,Pe=s.width/2,ze=s.height/2,Ie=Lc(0,A.screenThinning.start,0,1,A.screenThinning.intensity),Oe=Lc(.001,A.screenThinning.range,0,1,A.screenThinning.intensity),Ce=Lc(0,A.screenThinning.particleOffset,0,1,A.screenThinning.intensity),Fe=($e={modelview:z.modelviewMatrix,projection:z.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ue,velocityConeAperture:A.velocityConeAperture,velocity:A.velocity,boxSize:ce,rainDropletSize:[ve,Ee],distortionStrength:A.distortionStrength,rainDirection:M,color:J,screenSize:[K.width,K.height],thinningCenterPos:[Pe,ze],thinningShape:[Ie,Oe,Math.pow(10,A.screenThinning.fadePower)],thinningAffectedRatio:A.screenThinning.affectedRatio,thinningParticleOffset:Ce,shapeDirectionalPower:A.shapeDirPower,shapeNormalPower:A.shapeNormalPower,mode:fe?0:1},{u_modelview:Float32Array.from($e.modelview),u_projection:Float32Array.from($e.projection),u_time:$e.time,u_cam_pos:$e.camPos,u_texScreen:0,u_velocityConeAperture:$e.velocityConeAperture,u_velocity:$e.velocity,u_boxSize:$e.boxSize,u_rainDropletSize:$e.rainDropletSize,u_distortionStrength:$e.distortionStrength,u_rainDirection:$e.rainDirection,u_color:$e.color,u_screenSize:$e.screenSize,u_thinningCenterPos:$e.thinningCenterPos,u_thinningShape:$e.thinningShape,u_thinningAffectedRatio:$e.thinningAffectedRatio,u_thinningParticleOffset:$e.thinningParticleOffset,u_shapeDirectionalPower:$e.shapeDirectionalPower,u_shapeNormalPower:$e.shapeNormalPower,u_mode:$e.mode});var $e;const st=Math.round(A.intensity*this.particlesCount),et=a.bd.simpleSegment(0,0,4*st,2*st);X.draw(s,H.TRIANGLES,_n.disabled,Kn.disabled,pr.alphaBlended,Jn.disabled,Fe,"rain_particles",this.particlesVx,this.particlesIdx,et)};A.distortionStrength>0&&de(A.boxSize,!0),de(A.boxSize,!1),this._vignette.draw(s,D)}}const Yp=a.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class Bi extends Ls{constructor(s){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new fg(s.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(s){const u=s.context;if(!this.particlesVx){const y=mg(this.particlesCount),S=new a.es,A=new a.a_;let M=0;const D=a.ea(1323123451230);for(let z=0;z<y.length;++z){const U=y[z],H=D(),K=D(),X=D(),J=[z/y.length,H,K,X],de=[D(),D()];S.emplaceBack(U[0],U[1],U[2],-1,-1,...J,...de),S.emplaceBack(U[0],U[1],U[2],1,-1,...J,...de),S.emplaceBack(U[0],U[1],U[2],1,1,...J,...de),S.emplaceBack(U[0],U[1],U[2],-1,1,...J,...de),A.emplaceBack(M+0,M+1,M+2),A.emplaceBack(M+0,M+2,M+3),M+=4}this.particlesVx=u.createVertexBuffer(S,Yp.members),this.particlesIdx=u.createIndexBuffer(A)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.snow)return;const u=structuredClone(this._params);let y=[-u.direction.x,u.direction.y,-100];a.au(y,y);const S=structuredClone(this._vignetteParams),A=u.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},M=s.transform.zoom;if(A.revealStart>M)return;const D=Lc(0,1,A.revealStart,A.revealStart+A.revealRange,M);S.strength*=D,u.overrideStyleParameters||(u.intensity=s.style.snow.state.density,u.timeFactor=s.style.snow.state.intensity,u.color=structuredClone(s.style.snow.state.color),y=structuredClone(s.style.snow.state.direction),u.screenThinning.intensity=s.style.snow.state.centerThinning,u.billboardSize=2.79*s.style.snow.state.flakeSize,S.strength=1,S.color=structuredClone(s.style.snow.state.vignetteColor));const z=this.updateOnRender(s,u.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const U=s.context,H=U.gl,K=s.transform,X=s.getOrCreateProgram("snowParticle");s.uploadCommonUniforms(U,X),((J,de,ce)=>{const fe=ld(this._movement.getPosition(),J),ue=K.width/2,ve=K.height/2,Ee=Lc(0,ce.screenThinning.start,0,1,ce.screenThinning.intensity),Pe=Lc(.001,ce.screenThinning.range,0,1,ce.screenThinning.intensity),ze=Lc(0,ce.screenThinning.particleOffset,0,1,ce.screenThinning.intensity),Ie=(Oe={modelview:z.modelviewMatrix,projection:z.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:fe,velocityConeAperture:ce.velocityConeAperture,velocity:ce.velocity,horizontalOscillationRadius:ce.horizontalOscillationRadius,horizontalOscillationRate:ce.horizontalOscillationRate,boxSize:J,billboardSize:1*ce.billboardSize,simpleShapeParameters:[ce.shapeFadeStart,ce.shapeFadePower],screenSize:[K.width,K.height],thinningCenterPos:[ue,ve],thinningShape:[Ee,Pe,Math.pow(10,ce.screenThinning.fadePower)],thinningAffectedRatio:ce.screenThinning.affectedRatio,thinningParticleOffset:ze,color:[ce.color.r,ce.color.g,ce.color.b,ce.color.a],direction:y},{u_modelview:Float32Array.from(Oe.modelview),u_projection:Float32Array.from(Oe.projection),u_time:Oe.time,u_cam_pos:Oe.camPos,u_velocityConeAperture:Oe.velocityConeAperture,u_velocity:Oe.velocity,u_horizontalOscillationRadius:Oe.horizontalOscillationRadius,u_horizontalOscillationRate:Oe.horizontalOscillationRate,u_boxSize:Oe.boxSize,u_billboardSize:Oe.billboardSize,u_simpleShapeParameters:Oe.simpleShapeParameters,u_screenSize:Oe.screenSize,u_thinningCenterPos:Oe.thinningCenterPos,u_thinningShape:Oe.thinningShape,u_thinningAffectedRatio:Oe.thinningAffectedRatio,u_thinningParticleOffset:Oe.thinningParticleOffset,u_particleColor:Oe.color,u_direction:Oe.direction});var Oe;const Ce=Math.round(ce.intensity*this.particlesCount),Fe=a.bd.simpleSegment(0,0,4*Ce,2*Ce);this.particlesVx&&this.particlesIdx&&X.draw(s,H.TRIANGLES,_n.disabled,Kn.disabled,pr.alphaBlended,Jn.disabled,Ie,"snow_particles",this.particlesVx,this.particlesIdx,Fe)})(u.boxSize,0,u),this._vignette.draw(s,S)}}const Vr={symbol:function(x,s,u,y,S){if(x.renderPass!=="translucent")return;const A=Kn.disabled,M=x.colorModeForRenderPass(),D=u.layout.get("text-variable-anchor"),z=u.layout.get("text-size-scale-range"),U=a.aD(x.scaleFactor,z[0],z[1]);D&&function(X,J,de,ce,fe,ue,ve,Ee){const Pe=J.transform,ze=fe==="map",Ie=ue==="map";for(const Oe of X){const Ce=ce.getTile(Oe),Fe=Ce.getBucket(de);if(!Fe||!Fe.text||!Fe.text.segments.get().length)continue;const $e=a.bH(Fe.textSizeData,Pe.zoom,Ee),st=yp(Oe,Fe.getProjection(),Pe),et=Pe.calculatePixelsToTileUnitsMatrix(Ce),_t=wl(st,Ce.tileID.canonical,Ie,ze,Pe,Fe.getProjection(),et),xt=Fe.hasIconTextFit()&&Fe.hasIconData();$e&&Mf(Fe,ze,Ie,ve,Pe,_t,Oe,Math.pow(2,Pe.zoom-Ce.tileID.overscaledZ),$e,xt)}}(y,x,u,s,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),S,U);const H=u.paint.get("icon-opacity").constantOr(1)!==0,K=u.paint.get("text-opacity").constantOr(1)!==0;u.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(H||K)?ed(x,s,u,y,A,M):(H&&ed(x,s,u,y,A,M,{onlyIcons:!0}),K&&ed(x,s,u,y,A,M,{onlyText:!0})),s.map.showCollisionBoxes&&(ja(x,s,u,y,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),ja(x,s,u,y,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(x,s,u,y){if(x.renderPass!=="translucent")return;const S=u.paint.get("circle-opacity"),A=u.paint.get("circle-stroke-width"),M=u.paint.get("circle-stroke-opacity"),D=u.layout.get("circle-sort-key").constantOr(1)!==void 0,z=u.paint.get("circle-emissive-strength");if(S.constantOr(1)===0&&(A.constantOr(1)===0||M.constantOr(1)===0))return;const U=x.context,H=U.gl,K=x.transform,X=x.depthModeForSublayer(0,_n.ReadOnly),J=Kn.disabled,de=x.colorModeForDrapableLayerRenderPass(z),ce=K.projection.name==="globe",fe=[a.ay(K.center.lng),a.aH(K.center.lat)],ue=[];for(let Ee=0;Ee<y.length;Ee++){const Pe=y[Ee],ze=s.getTile(Pe),Ie=ze.getBucket(u);if(!Ie||Ie.projection.name!==K.projection.name)continue;const Oe=Ie.programConfigurations.get(u.id),Ce=a.dK(u),Fe=x.isTileAffectedByFog(Pe);ce&&Ce.push("PROJECTION_GLOBE_VIEW"),Ce.push("DEPTH_D24"),x.terrain&&K.depthOcclusionForSymbolsAndCircles&&Ce.push("DEPTH_OCCLUSION");const $e=x.getOrCreateProgram("circle",{config:Oe,defines:Ce,overrideFog:Fe}),st=Ie.layoutVertexBuffer,et=Ie.globeExtVertexBuffer,_t=Ie.indexBuffer,xt=K.projection.createInversionMatrix(K,Pe.canonical),Bt={programConfiguration:Oe,program:$e,layoutVertexBuffer:st,globeExtVertexBuffer:et,indexBuffer:_t,uniformValues:a.dL(x,Pe,ze,xt,fe,u),tile:ze};if(D){const Je=Ie.segments.get();for(const lt of Je)ue.push({segments:new a.bd([lt]),sortKey:lt.sortKey,state:Bt})}else ue.push({segments:Ie.segments,sortKey:0,state:Bt})}D&&ue.sort((Ee,Pe)=>Ee.sortKey-Pe.sortKey);const ve={useDepthForOcclusion:K.depthOcclusionForSymbolsAndCircles};for(const Ee of ue){const{programConfiguration:Pe,program:ze,layoutVertexBuffer:Ie,globeExtVertexBuffer:Oe,indexBuffer:Ce,uniformValues:Fe,tile:$e}=Ee.state,st=Ee.segments;x.terrain&&x.terrain.setupElevationDraw($e,ze,ve),x.uploadCommonUniforms(U,ze,$e.tileID.toUnwrapped()),ze.draw(x,H.TRIANGLES,X,J,de,Jn.disabled,Fe,u.id,Ie,Ce,st,u.paint,K.zoom,Pe,[Oe])}},heatmap:function(x,s,u,y){if(u.paint.get("heatmap-opacity")!==0)if(x.renderPass==="offscreen"){const S=x.context,A=S.gl,M=Kn.disabled,D=new pr([A.ONE,A.ONE,A.ONE,A.ONE],a.am.transparent,[!0,!0,!0,!0]);(function(J,de,ce,fe){const ue=J.gl,ve=de.width*fe,Ee=de.height*fe;J.activeTexture.set(ue.TEXTURE1),J.viewport.set([0,0,ve,Ee]);let Pe=ce.heatmapFbo;if(!Pe||Pe&&(Pe.width!==ve||Pe.height!==Ee)){Pe&&Pe.destroy();const ze=ue.createTexture();ue.bindTexture(ue.TEXTURE_2D,ze),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_S,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_T,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MIN_FILTER,ue.LINEAR),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MAG_FILTER,ue.LINEAR),Pe=ce.heatmapFbo=J.createFramebuffer(ve,Ee,!0,null),function(Ie,Oe,Ce,Fe,$e,st){const et=Ie.gl;et.texImage2D(et.TEXTURE_2D,0,Ie.extRenderToTextureHalfFloat?et.RGBA16F:et.RGBA,$e,st,0,et.RGBA,Ie.extRenderToTextureHalfFloat?et.HALF_FLOAT:et.UNSIGNED_BYTE,null),Fe.colorAttachment.set(Ce)}(J,0,ze,Pe,ve,Ee)}else ue.bindTexture(ue.TEXTURE_2D,Pe.colorAttachment.get()),J.bindFramebuffer.set(Pe.framebuffer)})(S,x,u,x.transform.projection.name==="globe"?.5:.25),S.clear({color:a.am.transparent});const z=x.transform,U=z.projection.name==="globe",H=U?["PROJECTION_GLOBE_VIEW"]:[],K=U?Jn.frontCCW:Jn.disabled,X=[a.ay(z.center.lng),a.aH(z.center.lat)];for(let J=0;J<y.length;J++){const de=y[J];if(s.hasRenderableParent(de))continue;const ce=s.getTile(de),fe=ce.getBucket(u);if(!fe||fe.projection.name!==z.projection.name)continue;const ue=x.isTileAffectedByFog(de),ve=fe.programConfigurations.get(u.id),Ee=x.getOrCreateProgram("heatmap",{config:ve,defines:H,overrideFog:ue}),{zoom:Pe}=x.transform;x.terrain&&x.terrain.setupElevationDraw(ce,Ee),x.uploadCommonUniforms(S,Ee,de.toUnwrapped());const ze=z.projection.createInversionMatrix(z,de.canonical);Ee.draw(x,A.TRIANGLES,_n.disabled,M,D,K,Ef(x,de,ce,ze,X,Pe,u.paint.get("heatmap-intensity")),u.id,fe.layoutVertexBuffer,fe.indexBuffer,fe.segments,u.paint,x.transform.zoom,ve,U?[fe.globeExtVertexBuffer]:null)}S.viewport.set([0,0,x.width,x.height])}else x.renderPass==="translucent"&&(x.context.setColorMode(x.colorModeForRenderPass()),function(S,A){const M=S.context,D=M.gl,z=A.heatmapFbo;if(!z)return;M.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,z.colorAttachment.get()),M.activeTexture.set(D.TEXTURE1);let U=A.colorRampTexture;U||(U=A.colorRampTexture=new a.T(M,A.colorRamp,D.RGBA8)),U.bind(D.LINEAR,D.CLAMP_TO_EDGE),S.getOrCreateProgram("heatmapTexture").draw(S,D.TRIANGLES,_n.disabled,Kn.disabled,S.colorModeForRenderPass(),Jn.disabled,((H,K,X,J)=>({u_image:0,u_color_ramp:1,u_opacity:K.paint.get("heatmap-opacity")}))(0,A),A.id,S.viewportBuffer,S.quadTriangleIndexBuffer,S.viewportSegments,A.paint,S.transform.zoom)}(x,u))},line:function(x,s,u,y){if(x.renderPass!=="translucent")return;const S=u.paint.get("line-opacity"),A=u.paint.get("line-width");if(S.constantOr(1)===0||A.constantOr(1)===0)return;const M=u.paint.get("line-emissive-strength"),D=u.paint.get("line-occlusion-opacity"),z=u.layout.get("line-elevation-reference"),U=u.layout.get("line-width-unit")==="meters",H=z==="sea",K=!(!x.terrain||!x.terrain.enabled),X=x.context,J=X.gl;if(u.hasElevatedBuckets&&x.transform.projection.name==="globe")return;const de=u.layout.get("line-cross-slope"),ce=de!==void 0,fe=de<1,ue=x.colorModeForDrapableLayerRenderPass(M),ve=x.terrain&&x.terrain.renderingToTexture,Ee=ve?1:a.q.devicePixelRatio,Pe=u.paint.get("line-dasharray"),ze=Pe.constantOr(1),Ie=u.layout.get("line-cap"),Oe=Pe.constantOr(null),Ce=Ie.constantOr(null),Fe=u.paint.get("line-pattern"),$e=Fe.constantOr(1),st=u.paint.get("line-pattern-cross-fade"),et=Fe.constantOr(null),_t=u.paint.get("line-opacity").constantOr(1);let xt=!$e&&_t!==1||x.depthOcclusion&&D>0&&D<1;const Bt=u.paint.get("line-gradient"),Je=$e?"linePattern":"line",lt=a.dM(u);let Ke;if(ve&&x.terrain&&x.terrain.clipOrMaskOverlapStencilType()&&(xt=!1),D!==0&&x.depthOcclusion){const wt=u.paint._values["line-opacity"];wt&&wt.value&&wt.value.kind==="constant"?Ke=wt.value:a.w(`Occlusion opacity for layer ${u.id} is supported only when line-opacity isn't data-driven.`)}A.value.kind!=="constant"&&A.value.isLineProgressConstant===!1&&lt.push("VARIABLE_LINE_WIDTH");const Et=(wt,Ot,zt,yn,Tn,gn)=>{for(const Pn of wt){const Sn=s.getTile(Pn);if($e&&!Sn.patternsLoaded())continue;const qn=Sn.getBucket(u);if(!qn||qn.elevationType!=="none"&&!Tn||qn.elevationType==="none"&&Tn)continue;x.prepareDrawTile();const ir=[...Ot],$n=x.shadowRenderer,ur=qn.elevationType==="road"&&!!$n&&$n.enabled;let Yn=[0,0,0];if(ur){const rr=x.style.directionalLight,_i=x.style.ambientLight;rr&&_i&&(Yn=nc(x.style,rr,_i)),ir.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const Bn=qn.programConfigurations.get(u.id);let Tr=!1;if(et&&Sn.imageAtlas){const rr=a.dN.from(et),_i=rr.getPrimary().scaleSelf(Ee).toString(),kr=Sn.imageAtlas.patternPositions.get(_i),qr=rr.getSecondary(),Hr=qr?Sn.imageAtlas.patternPositions.get(qr.scaleSelf(Ee).toString()):null;Tr=!!kr&&!!Hr,kr&&Bn.setConstantPatternPositions(kr,Hr)}st>0&&(Tr||Bn.getPatternTransitionVertexBuffer("line-pattern"))&&ir.push("LINE_PATTERN_TRANSITION");const ei=x.isTileAffectedByFog(Pn),ar=x.getOrCreateProgram(Je,{config:Bn,defines:ir,overrideFog:ei,overrideRtt:!Tn&&void 0});if(!$e&&Oe&&Ce&&Sn.lineAtlas){const rr=Sn.lineAtlas.getDash(Oe,Ce);rr&&Bn.setConstantPatternPositions(rr)}ur&&$n.setupShadows(Sn.tileID.toUnwrapped(),ar,"vector-tile",Sn.tileID.overscaledZ);let[Er,Fr]=u.paint.get("line-trim-offset");(Ce==="round"||Ce==="square")&&Er!==Fr&&(Er===0&&(Er-=1),Fr===1&&(Fr+=1));const Ur=ve?Pn.projMatrix:null,ti=U?1/qn.tileToMeter/a.aw(Sn,1,x.transform.zoom):1,Pi=U?1/qn.tileToMeter/a.aw(Sn,1,Math.floor(x.transform.zoom)):1,ta=$e?a.dO(x,Sn,u,Ur,Ee,ti,Pi,[Er,Fr],Yn,st):a.dP(x,Sn,u,Ur,qn.lineClipsArray.length,Ee,ti,Pi,[Er,Fr],Yn);if(Bt){const rr=qn.gradients[u.id];let _i=rr.texture;if(u.gradientVersion!==rr.version){let kr=256;if(u.stepInterpolant){const qr=s.getSource().maxzoom,Hr=Pn.canonical.z===qr?Math.ceil(1<<x.transform.maxZoom-Pn.canonical.z):1;kr=a.aD(a.dQ(qn.maxLineLength/a.aj*1024*Hr),256,X.maxTextureSize)}rr.gradient=a.dR({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:kr,image:rr.gradient||void 0,clips:qn.lineClipsArray}),rr.texture?rr.texture.update(rr.gradient):rr.texture=new a.T(X,rr.gradient,J.RGBA8),rr.version=u.gradientVersion,_i=rr.texture}X.activeTexture.set(J.TEXTURE1),_i.bind(u.stepInterpolant?J.NEAREST:J.LINEAR,J.CLAMP_TO_EDGE)}ze&&(X.activeTexture.set(J.TEXTURE0),Sn.lineAtlasTexture&&Sn.lineAtlasTexture.bind(J.LINEAR,J.REPEAT),Bn.updatePaintBuffers()),$e&&(X.activeTexture.set(J.TEXTURE0),Sn.imageAtlasTexture&&Sn.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),Bn.updatePaintBuffers()),Tn&&!H&&x.terrain.setupElevationDraw(Sn,ar),x.uploadCommonUniforms(X,ar,Pn.toUnwrapped());const Ni=rr=>{Ke!=null&&(Ke.value=_t*D),ar.draw(x,J.TRIANGLES,zt,rr,ue,Jn.disabled,ta,u.id,qn.layoutVertexBuffer,qn.indexBuffer,qn.segments,u.paint,x.transform.zoom,Bn,[qn.layoutVertexBuffer2,qn.patternVertexBuffer,qn.zOffsetVertexBuffer]),Ke!=null&&(Ke.value=_t)};if(xt&&!Tn){const rr=x.stencilModeForClipping(Pn).ref;rr===0&&ve&&X.clear({stencil:0});const _i={func:J.EQUAL,mask:255};ta.u_alpha_discard_threshold=.8,Ni(new Kn(_i,rr,255,J.KEEP,J.KEEP,J.INVERT)),ta.u_alpha_discard_threshold=0,Ni(new Kn(_i,rr,255,J.KEEP,J.KEEP,J.KEEP))}else ta.u_alpha_discard_threshold=xt&&Tn&&gn?.8:0,Ni(Tn?yn:x.stencilModeForClipping(Pn))}};let ct=x.depthModeForSublayer(0,_n.ReadOnly);const Dt=new _n(x.depthOcclusion?J.GREATER:J.LEQUAL,_n.ReadOnly,x.depthRangeFor3D);if(u.hasNonElevatedBuckets){const wt=!ve&&x.terrain;D!==0&&wt?a.w(`Occlusion opacity for layer ${u.id} is supported on terrain only if the layer has line-z-offset enabled.`):wt?a.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${u.id}.`):Et(y,lt,ct,Kn.disabled,!1,!0)}if(u.hasElevatedBuckets){z==="hd-road-markup"?K||(ct=Dt,lt.push("ELEVATED_ROADS")):(lt.push("ELEVATED"),ct=Dt,ce&&lt.push(fe?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),H&&lt.push("ELEVATION_REFERENCE_SEA"));const wt=xt?x.stencilModeFor3D():Kn.disabled;x.forceTerrainMode=!0,Et(y,lt,ct,wt,!0,!0),xt&&Et(y,lt,ct,wt,!0,!1),x.forceTerrainMode=!1}xt&&(x.resetStencilClippingMasks(),ve&&X.clear({stencil:0})),D===0||x.depthOcclusion||ve||x.layersWithOcclusionOpacity.push(x.currentLayer)},fill:function(x,s,u,y){const S=u.paint.get("fill-color"),A=u.paint.get("fill-opacity");if(A.constantOr(1)===0)return;const M=u.paint.get("fill-emissive-strength"),D=x.colorModeForDrapableLayerRenderPass(M),z=u.paint.get("fill-pattern"),U=x.opaquePassEnabledForLayer()&&!z.constantOr(1)&&S.constantOr(a.am.transparent).a===1&&A.constantOr(0)===1?"opaque":"translucent";let H="none";u.layout.get("fill-elevation-reference")!=="none"?H="road":u.paint.get("fill-z-offset").constantOr(1)!==0&&(H="offset");const K=!(!x.terrain||!x.terrain.enabled),X={painter:x,sourceCache:s,layer:u,coords:y,colorMode:D,elevationType:H,terrainEnabled:K,pass:U};if(x.renderPass!=="shadow")if(H!=="offset"){if(mn(X,!1),H==="road"){const J=!K&&x.renderPass==="translucent";J&&Ma(x,s,u,y,"geometry"),mn(X,!0,Kn.disabled),J&&function(de){const{painter:ce,sourceCache:fe,layer:ue,coords:ve,colorMode:Ee}=de,Pe=ce.context.gl,ze=de.painter.shadowRenderer,Ie=!!ze&&ze.enabled,Oe=new _n(ce.context.gl.LEQUAL,_n.ReadOnly,ce.depthRangeFor3D);let Ce=[0,0,0];if(Ie){const Fe=ce.style.directionalLight,$e=ce.style.ambientLight;Fe&&$e&&(Ce=nc(ce.style,Fe,$e))}for(const Fe of ve){const $e=fe.getTile(Fe),st=$e.getBucket(ue);if(!st)continue;const et=st.elevatedStructures;if(!et||!et.renderableSegments||et.renderableSegments.segments[0].primitiveLength===0)continue;ce.prepareDrawTile();const _t=st.bufferData.programConfigurations.get(ue.id),xt=ce.isTileAffectedByFog(Fe),Bt=[];Ie&&Bt.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const Je=ce.getOrCreateProgram("elevatedStructures",{config:_t,overrideFog:xt,defines:Bt}),lt=ce.translatePosMatrix(Fe.projMatrix,$e,ue.paint.get("fill-translate"),ue.paint.get("fill-translate-anchor"));Ie&&ze.setupShadows($e.tileID.toUnwrapped(),Je,"vector-tile",$e.tileID.overscaledZ);const Ke=Tf(lt,Ce);ce.uploadCommonUniforms(ce.context,Je,Fe.toUnwrapped()),Je.draw(ce,Pe.TRIANGLES,Oe,Kn.disabled,Ee,Jn.backCCW,Ke,ue.id,et.vertexBuffer,et.indexBuffer,et.renderableSegments,ue.paint,ce.transform.zoom,_t,[et.vertexBufferNormal])}}(X)}}else mn(X,!1,x.stencilModeFor3D());else x.shadowRenderer&&H==="road"&&!K&&function(J){const{painter:de,sourceCache:ce,layer:fe,coords:ue}=J,ve=de.context.gl,Ee=J.painter.shadowRenderer;for(const Pe of ue){const ze=ce.getTile(Pe),Ie=ze.getBucket(fe);if(!Ie)continue;const Oe=Ie.elevatedStructures;if(!Oe||!Oe.shadowCasterSegments||Oe.shadowCasterSegments.segments[0].primitiveLength===0)continue;de.prepareDrawTile();const Ce=Ie.bufferData.programConfigurations.get(fe.id),Fe=de.isTileAffectedByFog(Pe),$e=de.getOrCreateProgram("elevatedStructuresDepth",{config:Ce,overrideFog:Fe}),st=Ee.calculateShadowPassMatrixFromTile(ze.tileID.toUnwrapped());de.uploadCommonUniforms(de.context,$e,Pe.toUnwrapped());const et={u_matrix:st,u_depth_bias:.001};$e.draw(de,ve.TRIANGLES,Ee.getShadowPassDepthMode(),Kn.disabled,Ee.getShadowPassColorMode(),Jn.disabled,et,fe.id,Oe.vertexBuffer,Oe.indexBuffer,Oe.shadowCasterSegments,fe.paint,de.transform.zoom,Ce)}}(X)},"fill-extrusion":function(x,s,u,y){const S=u.paint.get("fill-extrusion-opacity"),A=x.context,M=A.gl,D=x.terrain,z=D&&D.renderingToTexture;if(S===0)return;const U=x.conflationActive&&x.style.isLayerClipped(u,s.getSource()),H=x.style.order.indexOf(u.fqid);if(U&&function(K,X,J,de,ce){for(const fe of de){const ue=X.getTile(fe).getBucket(J);ue&&(ue.updateReplacement(fe,K.replacementSource,ce),ue.uploadCentroid(K.context))}}(x,s,u,y,H),D||U)for(const K of y){const X=s.getTile(K).getBucket(u);X&&hu(x.context,s,K,X,u,D,U)}if(x.renderPass==="shadow"&&x.shadowRenderer){const K=x.shadowRenderer;if(D&&S<.65&&u._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof a.ab)return;const X=K.getShadowPassDepthMode(),J=K.getShadowPassColorMode();vh(x,s,u,y,X,Kn.disabled,J,U)}else if(x.renderPass==="translucent"){const K=!u.paint.get("fill-extrusion-pattern").constantOr(1),X=u.paint.get("fill-extrusion-color").constantOr(a.am.white);if(!z&&X.a!==0){const J=new _n(x.context.gl.LEQUAL,_n.ReadWrite,x.depthRangeFor3D);S===1&&K?vh(x,s,u,y,J,Kn.disabled,pr.unblended,U):(vh(x,s,u,y,J,Kn.disabled,pr.disabled,U),vh(x,s,u,y,J,x.stencilModeFor3D(),x.colorModeForRenderPass(),U),x.resetStencilClippingMasks())}if(x.style.enable3dLights()&&K&&(!D&&x.transform.projection.name!=="globe"||z)){const J=u.paint.get("fill-extrusion-opacity"),de=u.paint.get("fill-extrusion-ambient-occlusion-intensity"),ce=u.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),fe=u.paint.get("fill-extrusion-flood-light-intensity"),ue=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",ve=u.paint.get("fill-extrusion-flood-light-color").toRenderColor(ue?null:u.lut).toArray01().slice(0,3),Ee=de>0&&ce>0,Pe=fe>0,ze=(Oe,Ce,Fe)=>(1-Fe)*Oe+Fe*Ce,Ie=Oe=>{const Ce=x.depthModeForSublayer(1,_n.ReadOnly,M.LEQUAL,!0),Fe=u.paint.get(Oe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),$e=ze(.1,3,Fe),st=x._showOverdrawInspector;if(!st){const et=new Kn({func:M.ALWAYS,mask:255},255,255,M.KEEP,M.KEEP,M.REPLACE),_t=new pr([M.ONE,M.ONE,M.ONE,M.ONE],a.am.transparent,[!1,!1,!1,!0],M.MIN);nd(x,s,u,y,Ce,et,_t,Jn.disabled,Oe,"sdf",J,de,ce,fe,ve,$e,U,!1)}{const et=st?Kn.disabled:new Kn({func:M.EQUAL,mask:255},255,255,M.KEEP,M.DECR,M.DECR),_t=st?x.colorModeForRenderPass():new pr([M.ONE_MINUS_DST_ALPHA,M.DST_ALPHA,M.ONE,M.ONE],a.am.transparent,[!0,!0,!0,!0]);nd(x,s,u,y,Ce,et,_t,Jn.disabled,Oe,"color",J,de,ce,fe,ve,$e,U,!1)}};if(z){const Oe=(Ce,Fe,$e)=>{const st=x.depthModeForSublayer(1,_n.ReadOnly,M.LEQUAL,!1),et=u.paint.get(Ce?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),_t=ze(.1,3,et);{const xt=new pr([M.ONE,M.ONE,M.ONE,M.ONE],a.am.transparent,[!1,!1,!1,!0]);nd(x,s,u,y,st,Kn.disabled,xt,Jn.disabled,Ce,"clear",J,de,ce,fe,ve,_t,U,Fe)}{const xt=new Kn({func:M.ALWAYS,mask:255},255,255,M.KEEP,M.KEEP,M.REPLACE),Bt=new pr([M.ONE,M.ONE,M.ONE,M.ONE],a.am.transparent,[!1,!1,!1,!0],M.MIN);nd(x,s,u,y,st,xt,Bt,Jn.disabled,Ce,"sdf",J,de,ce,fe,ve,_t,U,Fe)}{const xt=Ce?M.ZERO:M.ONE_MINUS_DST_ALPHA,Bt=new Kn({func:M.EQUAL,mask:255},255,255,M.KEEP,M.DECR,M.DECR),Je=new pr([xt,M.DST_ALPHA,M.ONE_MINUS_DST_ALPHA,M.ZERO],a.am.transparent,[!0,!0,!0,!0]);nd(x,s,u,y,st,Bt,Je,Jn.disabled,Ce,"color",J,de,ce,fe,ve,_t,U,Fe)}{const xt=new pr([M.ONE,M.ONE,M.ONE,Ce?M.ZERO:M.ONE],a.am.transparent,[!1,!1,!1,!0],Ce?M.FUNC_ADD:M.MAX);nd(x,s,u,y,st,Kn.disabled,xt,Jn.disabled,Ce,"clear",J,de,ce,fe,ve,_t,U,Fe,$e)}};if(Ee||Pe){let Ce;if(x.prepareDrawTile(),D){const Fe=D.drapeBufferSize[0],$e=D.drapeBufferSize[1];Ce=D.framebufferCopyTexture,Ce&&(!Ce||Ce.size[0]===Fe&&Ce.size[1]===$e)||(Ce&&Ce.destroy(),Ce=D.framebufferCopyTexture=new a.T(A,new a.r({width:Fe,height:$e}),M.RGBA8)),Ce.bind(M.LINEAR,M.CLAMP_TO_EDGE),M.copyTexSubImage2D(M.TEXTURE_2D,0,0,0,0,0,Fe,$e)}Ee&&Oe(!0,!1,Ce),Pe&&Oe(!1,!0,Ce)}}else Ee&&Ie(!0),Pe&&Ie(!1),(Ee||Pe)&&x.resetStencilClippingMasks()}}},hillshade:function(x,s,u,y){if(x.renderPass!=="offscreen"&&x.renderPass!=="translucent"||x.style.disableElevatedTerrain)return;const S=x.context,A=x.terrain&&x.terrain.renderingToTexture,[M,D]=x.renderPass!=="translucent"||A?[{},y]:x.stencilConfigForOverlap(y);for(const z of D){const U=s.getTile(z);if(U.needsHillshadePrepare&&x.renderPass==="offscreen")ac(x,U,u);else if(x.renderPass==="translucent"){const H=x.depthModeForSublayer(0,_n.ReadOnly),K=u.paint.get("hillshade-emissive-strength"),X=x.colorModeForDrapableLayerRenderPass(K),J=A&&x.terrain?x.terrain.stencilModeForRTTOverlap(z):M[z.overscaledZ];Vo(x,z,U,u,H,J,X)}}S.viewport.set([0,0,x.width,x.height]),x.resetStencilClippingMasks()},raster:function(x,s,u,y,S,A){if(x.renderPass!=="translucent"||u.paint.get("raster-opacity")===0)return;const M=x.transform.projection.name==="globe",D=u.paint.get("raster-elevation")!==0,z=D&&M;if(x.renderElevatedRasterBackface&&!z)return;const U=x.context,H=U.gl,K=s.getSource(),X=function(Ie,Oe,Ce,Fe){const $e=Oe.paint.get("raster-color"),st=Ie.type==="raster-array",et=[],_t=Oe.paint.get("raster-resampling"),xt=Oe.paint.get("raster-color-mix");let Bt=Oe.paint.get("raster-color-range");const Je=[xt[0],xt[1],xt[2],0],lt=xt[3];let Ke=_t==="nearest"?Fe.NEAREST:Fe.LINEAR;if(st&&(et.push("RASTER_ARRAY"),$e||et.push("RASTER_COLOR"),_t==="linear"&&et.push("RASTER_ARRAY_LINEAR"),Ke=Fe.NEAREST,!Bt&&Ie.rasterLayers)){const Et=Ie.rasterLayers.find(({id:ct})=>ct===Oe.sourceLayer);Et&&Et.fields&&Et.fields.range&&(Bt=Et.fields.range)}if(Bt=Bt||[0,1],$e){et.push("RASTER_COLOR"),Ce.activeTexture.set(Fe.TEXTURE2),Oe.updateColorRamp(Bt);let Et=Oe.colorRampTexture;Et||(Et=Oe.colorRampTexture=new a.T(Ce,Oe.colorRamp,Fe.RGBA8)),Et.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE)}return{mix:Je,range:Bt,offset:lt,defines:et,resampling:Ke}}(K,u,U,H);if(K instanceof a.aP&&!y.length&&!M)return;const J=u.paint.get("raster-emissive-strength"),de=x.colorModeForDrapableLayerRenderPass(J),ce=x.terrain&&x.terrain.renderingToTexture,fe=!x.options.moving,ue=u.paint.get("raster-resampling")==="nearest"?H.NEAREST:H.LINEAR;if(K instanceof a.aP&&!y.length&&(K.onNorthPole||K.onSouthPole)){const Ie=D?x.stencilModeFor3D():Kn.disabled;return void Ra(!!K.onNorthPole,null,x,s,u,J,X,Jn.disabled,Ie)}if(!y.length)return;const[ve,Ee]=K instanceof a.aP||ce?[{},y]:x.stencilConfigForOverlap(y),Pe=Ee[Ee.length-1].overscaledZ;z&&X.defines.push("PROJECTION_GLOBE_VIEW"),D&&X.defines.push("RENDER_CUTOFF");const ze=(Ie,Oe,Ce)=>{for(const Fe of Ie){const $e=Fe.toUnwrapped(),st=s.getTile(Fe);if(ce&&(!st||!st.hasData()))continue;U.activeTexture.set(H.TEXTURE0);const et=Up(st,K,u,X);if(!et||!et.texture)continue;const{texture:_t,mix:xt,offset:Bt,tileSize:Je,buffer:lt}=et;let Ke,Et;ce?(Ke=_n.disabled,Et=Fe.projMatrix):D?(Ke=new _n(H.LEQUAL,_n.ReadWrite,x.depthRangeFor3D),Et=M?Float32Array.from(x.transform.expandedFarZProjMatrix):x.transform.calculateProjMatrix($e,fe)):(Ke=x.depthModeForSublayer(Fe.overscaledZ-Pe,u.paint.get("raster-opacity")===1?_n.ReadWrite:_n.ReadOnly,H.LESS),Et=x.transform.calculateProjMatrix($e,fe));const ct=x.terrain&&ce?x.terrain.stencilModeForRTTOverlap(Fe):ve[Fe.overscaledZ],Dt=A?0:u.paint.get("raster-fade-duration");st.registerFadeDuration(Dt);const wt=s.findLoadedParent(Fe,0),Ot=Op(st,wt,s,x.transform,Dt);let zt,yn;x.terrain&&x.terrain.prepareDrawTile(),U.activeTexture.set(H.TEXTURE0),_t.bind(ue,H.CLAMP_TO_EDGE),U.activeTexture.set(H.TEXTURE1),wt?(wt.texture&&wt.texture.bind(ue,H.CLAMP_TO_EDGE),zt=Math.pow(2,wt.tileID.overscaledZ-st.tileID.overscaledZ),yn=[st.tileID.canonical.x*zt%1,st.tileID.canonical.y*zt%1]):_t.bind(ue,H.CLAMP_TO_EDGE),"useMipmap"in _t&&U.extTextureFilterAnisotropic&&x.transform.pitch>20&&H.texParameterf(H.TEXTURE_2D,U.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,U.extTextureFilterAnisotropicMax);const Tn=x.transform;let gn;const Pn=D?cg(Tn):[0,0,0,0];let Sn,qn,ir,$n,ur,Yn=0;if(z&&K instanceof a.aP&&K.coordinates.length>3)Sn=Float32Array.from(a.bh(a.dr(new a.cp(0,0,0)))),qn=Float32Array.from(Tn.globeMatrix),ir=Float32Array.from(a.dm(Tn)),$n=[a.ay(Tn.center.lng),a.aH(Tn.center.lat)],gn=K.elevatedGlobePerspectiveTransform,ur=K.elevatedGlobeGridMatrix||new Float32Array(9);else if(z){const ar=a.dn(Fe.canonical);Yn=a.dp(ar.getCenter().lat),Sn=Float32Array.from(a.bh(a.dr(Fe.canonical))),qn=Float32Array.from(Tn.globeMatrix),ir=Float32Array.from(a.dm(Tn)),$n=[a.ay(Tn.center.lng),a.aH(Tn.center.lat)],gn=[0,0],ur=Float32Array.from(a.dq(Fe.canonical,ar,Yn,Tn.worldSize/Tn._pixelsPerMercatorPixel))}else gn=K instanceof a.aP?K.perspectiveTransform:[0,0],Sn=new Float32Array(16),qn=new Float32Array(9),ir=new Float32Array(16),$n=[0,0],ur=new Float32Array(9);const Bn=bo(Et,Sn,qn,ir,ur,yn||[0,0],a.ah(x.transform.zoom),$n,Pn,zt||1,Ot,u,gn,D?u.paint.get("raster-elevation"):0,2,xt,Bt,X.range,Je,lt,J),Tr=x.isTileAffectedByFog(Fe),ei=x.getOrCreateProgram("raster",{defines:X.defines,overrideFog:Tr});if(x.uploadCommonUniforms(U,ei,$e),K instanceof a.aP){const ar=K.elevatedGlobeVertexBuffer,Er=K.elevatedGlobeIndexBuffer;if(ce||!M)K.boundsBuffer&&K.boundsSegments&&ei.draw(x,H.TRIANGLES,Ke,Kn.disabled,de,Jn.disabled,Bn,u.id,K.boundsBuffer,x.quadTriangleIndexBuffer,K.boundsSegments);else if(ar&&Er){const Fr=Tn.zoom<=a.cL?K.elevatedGlobeSegments:K.getSegmentsForLongitude(Tn.center.lng);Fr&&ei.draw(x,H.TRIANGLES,Ke,Kn.disabled,de,Oe,Bn,u.id,ar,Er,Fr)}}else if(z){Ke=new _n(H.LEQUAL,_n.ReadOnly,x.depthRangeFor3D);const ar=x.globeSharedBuffers;if(ar){const[Er,Fr,Ur]=ar.getGridBuffers(Yn,!1);ei.draw(x,H.TRIANGLES,Ke,Ce||ct,x.colorModeForRenderPass(),Oe,Bn,u.id,Er,Fr,Ur)}}else{const{tileBoundsBuffer:ar,tileBoundsIndexBuffer:Er,tileBoundsSegments:Fr}=x.getTileBoundsBuffers(st);ei.draw(x,H.TRIANGLES,Ke,ct,de,Jn.disabled,Bn,u.id,ar,Er,Fr)}}if(!(K instanceof a.aP)&&z)for(const Fe of Ie){const $e=Fe.canonical.y===(1<<Fe.canonical.z)-1;Fe.canonical.y===0&&Ra(!0,Fe,x,s,u,J,X,Oe,Ce||Kn.disabled),$e&&Ra(!1,Fe,x,s,u,J,X,Oe===Jn.frontCW?Jn.backCW:Jn.frontCW,Ce||Kn.disabled)}};z?ze(Ee,x.renderElevatedRasterBackface?Jn.backCW:Jn.frontCW,x.stencilModeFor3D()):ze(Ee,Jn.disabled,void 0),x.resetStencilClippingMasks()},"raster-particle":function(x,s,u,y,S,A){x.renderPass==="offscreen"&&function(M,D,z,U){if(!U.length)return;const H=M.context,K=H.gl,X=D.getSource();if(!(X instanceof rs))return;const J=Math.ceil(Math.sqrt(z.paint.get("raster-particle-count")));let de=z.particlePositionRGBAImage;if(!de||de.width!==J){const Ee=function(Pe){const ze=Pe*Pe,Ie=new Uint8Array(4*ze),Oe=function(Fe){return Fe|=0,Fe=Math.imul(2747636419^Fe,2654435769),Fe=Math.imul(Fe^Fe>>>16,2654435769),((Fe=Math.imul(Fe^Fe>>>16,2654435769))>>>0)/4294967296},Ce=1/1.1;for(let Fe=0;Fe<ze;Fe++){const $e=Ce*(Oe(2*Fe+0)+wo),st=Ce*(Oe(2*Fe+1)+wo),et=255*$e%1,_t=255*st%1,xt=et,Bt=st-_t/255,Je=_t;Ie[4*Fe+0]=255*($e-et/255),Ie[4*Fe+1]=255*xt,Ie[4*Fe+2]=255*Bt,Ie[4*Fe+3]=255*Je}return Ie}(J);de=z.particlePositionRGBAImage=new a.r({width:J,height:J},Ee)}let ce=z.particleFramebuffer;ce?ce.width!==J&&(ce.destroy(),ce=z.particleFramebuffer=H.createFramebuffer(J,J,!0,null)):ce=z.particleFramebuffer=H.createFramebuffer(J,J,!0,null);const fe=[];for(const Ee of U){const Pe=D.getTile(Ee);if(!(Pe instanceof hp))continue;const ze=fu(Pe,X,z);if(!ze)continue;const Ie=[Pe.tileSize,Pe.tileSize];let Oe=z.tileFramebuffer;Oe||(Oe=z.tileFramebuffer=H.createFramebuffer(Ie[0],Ie[1],!0,null));let Ce=Pe.rasterParticleState;Ce||(Ce=Pe.rasterParticleState=new Lx(H,Ee,Ie,de));const Fe=Ce.update(z.lastInvalidatedAt);Ce.particleTextureDimension!==J&&Ce.updateParticleTexture(Ee,de);const $e=Ce.targetColorTexture;Ce.targetColorTexture=Ce.backgroundColorTexture,Ce.backgroundColorTexture=$e;const st=Ce.particleTexture0;Ce.particleTexture0=Ce.particleTexture1,Ce.particleTexture1=st,fe.push([Ee,ze,Ce,Fe])}if(fe.length===0)return;const ue=a.q.now(),ve=z.previousDrawTimestamp?.001*(ue-z.previousDrawTimestamp):.0167;if(z.previousDrawTimestamp=ue,z.hasColorMap()){H.activeTexture.set(K.TEXTURE0+2);let Ee=z.colorRampTexture;Ee||(Ee=z.colorRampTexture=new a.T(H,z.colorRamp,K.RGBA8)),Ee.bind(K.LINEAR,K.CLAMP_TO_EDGE)}H.bindFramebuffer.set(z.tileFramebuffer.framebuffer),function(Ee,Pe,ze){const Ie=Ee.context,Oe=Ie.gl,Ce=Pe.tileFramebuffer;Ie.activeTexture.set(Oe.TEXTURE0);const Fe={u_texture:0,u_opacity:1.05*(st=Pe.paint.get("raster-particle-fade-opacity-factor"))/(st+.05)},$e=Ee.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var st;for(const et of ze){const[,,_t,xt]=et;Ce.colorAttachment.set(_t.targetColorTexture.texture),Ie.viewport.set([0,0,Ce.width,Ce.height]),Ie.clear({color:a.am.transparent}),xt&&(_t.backgroundColorTexture.bind(Oe.NEAREST,Oe.CLAMP_TO_EDGE),$e.draw(Ee,Oe.TRIANGLES,_n.disabled,Kn.disabled,pr.alphaBlended,Jn.disabled,Fe,Pe.id,Ee.viewportBuffer,Ee.quadTriangleIndexBuffer,Ee.viewportSegments))}}(M,z,fe),function(Ee,Pe,ze,Ie){const Oe=Ee.context,Ce=Oe.gl,Fe=ze.tileFramebuffer,$e=Ee.transform.projection.name==="globe",st=ze.paint.get("raster-particle-max-speed");for(const et of Ie){const[_t,xt,Bt]=et;Oe.activeTexture.set(Ce.TEXTURE0+0),xt.texture.bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE),Fe.colorAttachment.set(Bt.targetColorTexture.texture);const Je=Ee.getOrCreateProgram("rasterParticleDraw",{defines:xt.defines,overrideFog:!1});Oe.activeTexture.set(Ce.TEXTURE0+1);const lt=xt.scalarData?[]:[0,1,2,3].map(ct=>a.dU[ct](_t));lt.push(_t);const Ke=_t.canonical.x,Et=_t.canonical.y;for(const ct of lt){const Dt=Pe.getTile($e?ct.wrapped():ct);if(!Dt)continue;const wt=Dt.rasterParticleState;if(!wt)continue;const Ot=ct.canonical.x+(1<<ct.canonical.z)*(ct.wrap-_t.wrap),zt=ct.canonical.y;wt.particleTexture0.bind(Ce.NEAREST,Ce.CLAMP_TO_EDGE);const yn=uc(1,wt.particleTexture0.size[0],[Ot-Ke,zt-Et],0,xt.texture.size,2,st,xt.textureOffset,xt.scale,xt.offset);Je.draw(Ee,Ce.POINTS,_n.disabled,Kn.disabled,pr.alphaBlended,Jn.disabled,yn,ze.id,wt.particleIndexBuffer,void 0,wt.particleSegment)}}}(M,D,z,fe),H.bindFramebuffer.set(z.particleFramebuffer.framebuffer),function(Ee,Pe,ze,Ie){const Oe=Ee.context,Ce=Oe.gl,Fe=Pe.paint.get("raster-particle-max-speed"),$e=Ie*Pe.paint.get("raster-particle-speed-factor")*.15,st=function(_t){return Math.pow(_t,6)}(.01+1*Pe.paint.get("raster-particle-reset-rate-factor")),et=Pe.particleFramebuffer;Oe.viewport.set([0,0,et.width,et.height]);for(const _t of ze){const[,xt,Bt]=_t;Oe.activeTexture.set(Ce.TEXTURE0+0),xt.texture.bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE),Oe.activeTexture.set(Ce.TEXTURE0+1);const Je=Bt.particleTexture0;Je.bind(Ce.NEAREST,Ce.CLAMP_TO_EDGE);const lt=Af(1,Je.size[0],0,xt.texture.size,Fe,$e,st,xt.textureOffset,xt.scale,xt.offset);et.colorAttachment.set(Bt.particleTexture1.texture),Oe.clear({color:a.am.transparent}),Ee.getOrCreateProgram("rasterParticleUpdate",{defines:xt.defines}).draw(Ee,Ce.TRIANGLES,_n.disabled,Kn.disabled,pr.unblended,Jn.disabled,lt,Pe.id,Ee.viewportBuffer,Ee.quadTriangleIndexBuffer,Ee.viewportSegments)}}(M,z,fe,ve)}(x,s,u,y),x.renderPass==="translucent"&&(function(M,D,z,U,H){const K=M.context,X=K.gl,J=D.getSource().tileSize,de=5*(1-a.af(a.cx,a.cx+1,M.transform.zoom))*J+z.paint.get("raster-particle-elevation"),ce=!M.options.moving,fe=M.transform.projection.name==="globe";if(!U.length)return;const[ue,ve]=M.stencilConfigForOverlap(U),Ee=[];fe&&Ee.push("PROJECTION_GLOBE_VIEW");const Pe=M.stencilModeFor3D();for(const ze of ve){const Ie=ze.toUnwrapped(),Oe=D.getTile(ze);if(!Oe.rasterParticleState)continue;const Ce=Oe.rasterParticleState,Fe=100;Oe.registerFadeDuration(Fe);const $e=D.findLoadedParent(ze,0),st=Op(Oe,$e,D,M.transform,Fe);let et,_t;M.terrain&&M.terrain.prepareDrawTile(),K.activeTexture.set(X.TEXTURE0),Ce.targetColorTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),K.activeTexture.set(X.TEXTURE1),$e&&$e.rasterParticleState?($e.rasterParticleState.targetColorTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),et=Math.pow(2,$e.tileID.overscaledZ-Oe.tileID.overscaledZ),_t=[Oe.tileID.canonical.x*et%1,Oe.tileID.canonical.y*et%1]):Ce.targetColorTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE);const xt=fe?Float32Array.from(M.transform.expandedFarZProjMatrix):M.transform.calculateProjMatrix(Ie,ce),Bt=M.transform,Je=Nf(Bt),lt=a.dn(ze.canonical),Ke=a.dp(lt.getCenter().lat);let Et,ct,Dt,wt,Ot;fe?(Et=Float32Array.from(a.bh(a.dr(ze.canonical))),ct=Float32Array.from(Bt.globeMatrix),Dt=Float32Array.from(a.dm(Bt)),wt=[a.ay(Bt.center.lng),a.aH(Bt.center.lat)],Ot=Float32Array.from(a.dq(ze.canonical,lt,Ke,Bt.worldSize/Bt._pixelsPerMercatorPixel))):(Et=new Float32Array(16),ct=new Float32Array(9),Dt=new Float32Array(16),wt=[0,0],Ot=new Float32Array(9));const zt=Ic(xt,Et,ct,Dt,Ot,_t||[0,0],a.ah(M.transform.zoom),wt,Je,et||1,st,de),yn=M.isTileAffectedByFog(ze),Tn=M.getOrCreateProgram("rasterParticle",{defines:Ee,overrideFog:yn});if(M.uploadCommonUniforms(K,Tn,Ie),fe){const gn=new _n(X.LEQUAL,_n.ReadOnly,M.depthRangeFor3D),Pn=0,Sn=M.globeSharedBuffers;if(Sn){const[qn,ir,$n]=Sn.getGridBuffers(Ke,Pn!==0);Tn.draw(M,X.TRIANGLES,gn,Pe,pr.alphaBlended,M.renderElevatedRasterBackface?Jn.frontCCW:Jn.backCCW,zt,z.id,qn,ir,$n)}}else{const gn=M.depthModeForSublayer(0,_n.ReadOnly),Pn=ue[ze.overscaledZ],{tileBoundsBuffer:Sn,tileBoundsIndexBuffer:qn,tileBoundsSegments:ir}=M.getTileBoundsBuffers(Oe);Tn.draw(M,X.TRIANGLES,gn,Pn,pr.alphaBlended,Jn.disabled,zt,z.id,Sn,qn,ir)}}M.resetStencilClippingMasks()}(x,s,u,y),x.style.map.triggerRepaint())},background:function(x,s,u,y){const S=u.paint.get("background-color"),A=u.paint.get("background-color-use-theme").constantOr("default")==="none",M=u.paint.get("background-opacity"),D=u.paint.get("background-emissive-strength"),z=u.paint.get("background-pitch-alignment")==="viewport";if(M===0)return;const U=x.context,H=U.gl,K=x.transform,X=K.tileSize,J=u.paint.get("background-pattern");let de;if(J!==void 0&&(J===null||(de=x.imageManager.getPattern(a.I.from(J.toString()),u.scope,x.style.getLut(u.scope)),!de)))return;const ce=!J&&S.a===1&&M===1&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass!==ce)return;const fe=Kn.disabled,ue=x.depthModeForSublayer(0,ce==="opaque"?_n.ReadWrite:_n.ReadOnly),ve=x.colorModeForDrapableLayerRenderPass(D),Ee=J?"backgroundPattern":"background";let Pe,ze=y;if(ze||(Pe=x.getBackgroundTiles(),ze=Object.values(Pe).map(Ie=>Ie.tileID)),J&&(U.activeTexture.set(H.TEXTURE0),x.imageManager.bind(x.context,u.scope)),z){const Ie=x.getOrCreateProgram(Ee,{overrideFog:!1,overrideRtt:!0}),Oe=new Float32Array(a.bx([])),Ce=new a.aM(0,0,0,0,0),Fe=J?jf(Oe,D,M,x,0,u.scope,de,z,{tileID:Ce,tileSize:X}):Yu(Oe,D,M,S.toRenderColor(A?null:u.lut));Ie.draw(x,H.TRIANGLES,ue,fe,ve,Jn.disabled,Fe,u.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments)}else for(const Ie of ze){const Oe=x.isTileAffectedByFog(Ie),Ce=x.getOrCreateProgram(Ee,{overrideFog:Oe}),Fe=Ie.toUnwrapped(),$e=y?Ie.projMatrix:x.transform.calculateProjMatrix(Fe);x.prepareDrawTile();const st=s?s.getTile(Ie):Pe?Pe[Ie.key]:new Ql(Ie,X,K.zoom,x),et=J?jf($e,D,M,x,0,u.scope,de,z,{tileID:Ie,tileSize:X}):Yu($e,D,M,S.toRenderColor(A?null:u.lut));x.uploadCommonUniforms(U,Ce,Fe);const{tileBoundsBuffer:_t,tileBoundsIndexBuffer:xt,tileBoundsSegments:Bt}=x.getTileBoundsBuffers(st);Ce.draw(x,H.TRIANGLES,ue,fe,ve,Jn.disabled,et,u.id,_t,xt,Bt)}},sky:function(x,s,u){const y=x._atmosphere?a.ah(x.transform.zoom):1,S=u.paint.get("sky-opacity")*y;if(S===0)return;const A=x.context,M=u.paint.get("sky-type"),D=new _n(A.gl.LEQUAL,_n.ReadOnly,[0,1]),z=x.frameCounter/1e3%1;M==="atmosphere"?x.renderPass==="offscreen"?u.needsSkyboxCapture(x)&&(function(U,H,K,X){const J=U.context,de=J.gl;let ce=H.skyboxFbo;if(!ce){ce=H.skyboxFbo=J.createFramebuffer(32,32,!0,null),H.skyboxGeometry=new Df(J),H.skyboxTexture=J.gl.createTexture(),de.bindTexture(de.TEXTURE_CUBE_MAP,H.skyboxTexture),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_WRAP_S,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_WRAP_T,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_MIN_FILTER,de.LINEAR),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_MAG_FILTER,de.LINEAR);for(let Ee=0;Ee<6;++Ee)de.texImage2D(de.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,0,de.RGBA,32,32,0,de.RGBA,de.UNSIGNED_BYTE,null)}J.bindFramebuffer.set(ce.framebuffer),J.viewport.set([0,0,32,32]);const fe=H.getCenter(U,!0),ue=U.getOrCreateProgram("skyboxCapture"),ve=new Float64Array(16);a.bx(ve),a.e3(ve,ve,.5*-Math.PI),mu(U,H,ue,ve,fe,0),a.bx(ve),a.e3(ve,ve,.5*Math.PI),mu(U,H,ue,ve,fe,1),a.bx(ve),a.cG(ve,ve,.5*-Math.PI),mu(U,H,ue,ve,fe,2),a.bx(ve),a.cG(ve,ve,.5*Math.PI),mu(U,H,ue,ve,fe,3),a.bx(ve),mu(U,H,ue,ve,fe,4),a.bx(ve),a.e3(ve,ve,Math.PI),mu(U,H,ue,ve,fe,5),J.viewport.set([0,0,U.width,U.height])}(x,u),u.markSkyboxValid(x)):x.renderPass==="sky"&&function(U,H,K,X,J){const de=U.context,ce=de.gl,fe=U.transform,ue=U.getOrCreateProgram("skybox");de.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_CUBE_MAP,H.skyboxTexture);const ve=((Ee,Pe,ze,Ie,Oe)=>({u_matrix:Ee,u_sun_direction:Pe,u_cubemap:0,u_opacity:Ie,u_temporal_offset:Oe}))(fe.skyboxMatrix,H.getCenter(U,!1),0,X,J);U.uploadCommonUniforms(de,ue),ue.draw(U,ce.TRIANGLES,K,Kn.disabled,U.colorModeForRenderPass(),Jn.backCW,ve,"skybox",H.skyboxGeometry.vertexBuffer,H.skyboxGeometry.indexBuffer,H.skyboxGeometry.segment)}(x,u,D,S,z):M==="gradient"&&x.renderPass==="sky"&&function(U,H,K,X,J){const de=U.context,ce=de.gl,fe=U.transform,ue=U.getOrCreateProgram("skyboxGradient");H.skyboxGeometry||(H.skyboxGeometry=new Df(de)),de.activeTexture.set(ce.TEXTURE0);let ve=H.colorRampTexture;ve||(ve=H.colorRampTexture=new a.T(de,H.colorRamp,ce.RGBA8)),ve.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);const Ee=((Pe,ze,Ie,Oe,Ce)=>({u_matrix:Pe,u_color_ramp:0,u_center_direction:ze,u_radius:a.al(Ie),u_opacity:Oe,u_temporal_offset:Ce}))(fe.skyboxMatrix,H.getCenter(U,!1),H.paint.get("sky-gradient-radius"),X,J);U.uploadCommonUniforms(de,ue),ue.draw(U,ce.TRIANGLES,K,Kn.disabled,U.colorModeForRenderPass(),Jn.backCW,Ee,"skyboxGradient",H.skyboxGeometry.vertexBuffer,H.skyboxGeometry.indexBuffer,H.skyboxGeometry.segment)}(x,u,D,S,z)},debug:function(x,s,u,y,S,A){for(let M=0;M<u.length;M++)if(S){const U=new a.am(y.r*.8,y.g*.8,y.b*.8,1);id(x,s,u[M],y,-1,-1,A),id(x,s,u[M],y,-1,1,A),id(x,s,u[M],y,1,1,A),id(x,s,u[M],y,1,-1,A),id(x,s,u[M],U,0,0,A)}else id(x,s,u[M],y,0,0,A)},custom:function(x,s,u,y){const S=x.context,A=u.implementation;if(!x.transform.projection.unsupportedLayers||!x.transform.projection.unsupportedLayers.includes("custom")||x.terrain&&(x.terrain.renderingToTexture||x.renderPass==="offscreen")&&u.isDraped(s)){if(x.renderPass==="offscreen"){const M=A.prerender;if(M){if(x.setCustomLayerDefaults(),S.setColorMode(x.colorModeForRenderPass()),x.transform.projection.name==="globe"){const D=x.transform.pointMerc;M.call(A,S.gl,x.transform.customLayerMatrix(),x.transform.getProjection(),x.transform.globeToMercatorMatrix(),a.ah(x.transform.zoom),[D.x,D.y],x.transform.pixelsPerMeterRatio)}else M.call(A,S.gl,x.transform.customLayerMatrix());S.setDirty(),x.setBaseState()}}else if(x.renderPass==="translucent"){if(x.terrain&&x.terrain.renderingToTexture){const D=A.renderToTile;if(D){const z=y[0].canonical,U={x:z.x+y[0].wrap*(A.wrapTileId?0:1<<z.z),y:z.y,z:z.z};S.setDepthMode(_n.disabled),S.setStencilMode(Kn.disabled),S.setColorMode(x.colorModeForRenderPass()),x.setCustomLayerDefaults(),D.call(A,S.gl,U),S.setDirty(),x.setBaseState()}return}x.setCustomLayerDefaults(),S.setColorMode(x.colorModeForRenderPass()),S.setStencilMode(Kn.disabled);const M=A.renderingMode==="3d"?new _n(x.context.gl.LEQUAL,_n.ReadWrite,x.depthRangeFor3D):x.depthModeForSublayer(0,_n.ReadOnly);if(S.setDepthMode(M),x.transform.projection.name==="globe"){const D=x.transform.pointMerc;A.render(S.gl,x.transform.customLayerMatrix(),x.transform.getProjection(),x.transform.globeToMercatorMatrix(),a.ah(x.transform.zoom),[D.x,D.y],x.transform.pixelsPerMeterRatio)}else A.render(S.gl,x.transform.customLayerMatrix());S.setDirty(),x.setBaseState(),S.bindFramebuffer.set(null)}}else a.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(x,s,u,y){if(x.renderPass==="opaque")return;const S=u.paint.get("model-opacity").constantOr(1);if(S===0)return;const A=u.paint.get("model-cast-shadows");if(x.renderPass==="shadow"&&(!A||x.terrain&&S<.65&&u._transitionablePaint._values["model-opacity"].value.expression instanceof a.ab))return;const M=x.shadowRenderer,D=u.paint.get("model-receive-shadows");M&&(M.useNormalOffset=!0,D||(M.enabled=!1));const z=()=>{M&&(M.useNormalOffset=!0,D||(M.enabled=!0))},U=s.getSource();if(x.renderPass==="light-beam"&&U.type!=="batched-model")return;if(U.type==="vector"||U.type==="geojson")return function(ue,ve,Ee,Pe,ze){const Ie=ue.transform;if(Ie.projection.name!=="mercator")return void a.w(`Drawing 3D models for ${Ie.projection.name} projection is not yet implemented`);const Oe=Ie.getFreeCameraOptions().position;if(!ue.modelManager)return;const Ce=ue.modelManager;Ee.modelManager=Ce;const Fe=ue.shadowRenderer;if(!Ee._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const $e=Ee._unevaluatedLayout._values["model-id"],st=Object.assign({},Ee.layout.get("model-id").parameters),et=ue.style.order.indexOf(Ee.fqid);for(const _t of Pe){const xt=ve.getTile(_t).getBucket(Ee);if(!xt||xt.projection.name!==Ie.projection.name)continue;const Bt=xt.getModelUris();Bt&&!xt.modelsRequested&&(Ce.addModelsFromBucket(Bt,ze),xt.modelsRequested=!0);const Je=od(_t,Ie);st.zoom=Je;const lt=$e.possiblyEvaluate(st);if(rt(ue,xt,_t),$o.shadowUniformsInitialized=!1,$o.useSingleShadowCascade=!!Fe&&Fe.getMaxCascadeForTile(_t.toUnwrapped())===0,ue.renderPass==="shadow"&&Fe){if(ue.currentShadowCascade===1&&xt.isInsideFirstShadowMapFrustum)continue;const ct=Ie.calculatePosMatrix(_t.toUnwrapped(),Ie.worldSize);if($o.tileMatrix.set(ct),$o.shadowTileMatrix=Float32Array.from(Fe.calculateShadowPassMatrixFromMatrix(ct)),$o.aabb.min.fill(0),$o.aabb.max[0]=$o.aabb.max[1]=a.aj,$o.aabb.max[2]=0,Ux(xt,$o,ue,Ee.scope))continue}const Ke=1<<_t.canonical.z,Et=[((Oe.x-_t.wrap)*Ke-_t.canonical.x)*a.aj,(Oe.y*Ke-_t.canonical.y)*a.aj,Oe.z*Ke*a.aj];ue.conflationActive&&Object.keys(xt.instancesPerModel).length>0&&ue.style.isLayerClipped(Ee,ve.getSource())&&xt.updateReplacement(_t,ue.replacementSource,et,ze)&&(xt.uploaded=!1,xt.upload(ue.context));for(let ct in xt.instancesPerModel){const Dt=xt.instancesPerModel[ct];Dt.features.length>0&&(ct=lt.evaluate(Dt.features[0].feature,{}));const wt=Ce.getModel(ct,ze);if(wt||Ce.hasURLBeenRequested(ct)||xt.modelUris.includes(ct)||(xt.modelUris.push(ct),xt.modelsRequested=!1),wt&&wt.uploaded)for(const Ot of wt.nodes)Zp(ue,Ee,Ot,Dt,Et,_t,$o)}}}(x,s,u,y,U.type==="vector"?u.scope:""),void z();if(!U.loaded())return;if(U.type==="batched-model")return function(ue,ve,Ee,Pe){Ee.resetLayerRenderingStats(ue);const ze=ue.context,Ie=ue.transform,Oe=ue.style.fog,Ce=ue.shadowRenderer;if(Ie.projection.name!=="mercator")return void a.w(`Drawing 3D landmark models for ${Ie.projection.name} projection is not yet implemented`);const Fe=ue.transform.getFreeCameraOptions().position,$e=a.b$([],[Fe.x,Fe.y,Fe.z],ue.transform.worldSize),st=a.eb([],$e),et=a.bx([]),_t=a.ec(Ie.center.lat,Ie.zoom),xt=a.bn([],[1,1,1/_t]);a.bo(et,et,st);const Bt=Ee.paint.get("model-opacity").constantOr(1),Je=new _n(ze.gl.LEQUAL,_n.ReadWrite,ue.depthRangeFor3D),lt=new _n(ze.gl.LEQUAL,_n.ReadOnly,ue.depthRangeFor3D),Ke=new a.cV([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Et=ue.renderPass==="shadow",ct=Et&&Ce?Ce.getCurrentCascadeFrustum():Ie.getFrustum(Ie.scaleZoom(Ie.worldSize)),Dt=Ee.paint.get("model-front-cutoff"),wt=Dt[2]<1,Ot=ih(ue,Ee.paint.get("model-cutoff-fade-range")),zt=Ee.getLayerRenderingStats();(function(yn,Tn,gn,Pn){const Sn=yn.terrain?yn.terrain.exaggeration():0,qn=yn.transform.zoom;for(const ir of Pn){const $n=Tn.getTile(ir).getBucket(gn);$n&&($n.setFilter(gn.filter),yn.conflationActive&&$n.updateReplacement(ir,yn.replacementSource),$n.evaluateScale(yn,gn),yn.terrain&&Sn>0&&$n.elevationUpdate(yn.terrain,Sn,ir,gn.source),$n.needsReEvaluation(yn,qn,gn)&&$n.evaluate(gn))}})(ue,ve,Ee,Pe),function(){let yn,Tn,gn;wt?(yn=Pe.length-1,Tn=-1,gn=-1):(yn=0,Tn=Pe.length,gn=1);const Pn=new Float64Array(16),Sn=a.eg(),qn=new a.P(0,0);for(let ir=yn;ir!==Tn;ir+=gn){const $n=Pe[ir],ur=ve.getTile($n).getBucket(Ee);if(!ur||!ur.uploaded)continue;let Yn=!1;Ce&&(Yn=Ce.getMaxCascadeForTile($n.toUnwrapped())===0);const Bn=Ie.calculatePosMatrix($n.toUnwrapped(),Ie.worldSize),Tr=ur.modelTraits;!Et&&wt&&(a.bi(Pn,Bn),a.ad(Sn,$e,Pn),qn.x=Sn[0],qn.y=Sn[1]);const ei=[];ur.setFilter(Ee.filter);for(const ar of ur.getNodesInfo()){if(ar.hiddenByReplacement||!ar.node.meshes)continue;const Er=ar.node;let Fr=0;ue.terrain&&Er.elevation&&(Fr=Er.elevation*ue.terrain.exaggeration());const Ur=(()=>{const Di=ar.aabb;return Ke.min=[...Di.min],Ke.max=[...Di.max],Ke.min[2]+=Fr,Ke.max[2]+=Fr,a.ad(Ke.min,Ke.min,Bn),a.ad(Ke.max,Ke.max,Bn),Ke})(),ti=ar.evaluatedScale;if(ti[0]<=1&&ti[1]<=1&&ti[2]<=1&&Ur.intersects(ct)===0)continue;if(!Et&&wt){const Di=.16666666666666666;ar.cameraCollisionOpacity=$e[0]>Ur.min[0]&&$e[0]<Ur.max[0]&&$e[1]>Ur.min[1]&&$e[1]<Ur.max[1]&&$e[2]*_t<Ur.max[2]&&Er.footprint&&a.bS(qn,Er.footprint)?Math.max(ar.cameraCollisionOpacity-Di,0):Math.min(1,ar.cameraCollisionOpacity+Di)}const Pi=[...Bn],ta=Er.anchor?Er.anchor[0]:0,Ni=Er.anchor?Er.anchor[1]:0;a.bo(Pi,Pi,[ta*(ti[0]-1),Ni*(ti[1]-1),Fr]),a.ci(ti,a.eh)||a.cE(Pi,Pi,ti);const rr=a.az([],Pi,Er.matrix),_i=a.az([],Ie.expandedFarZProjMatrix,rr),kr=a.az([],Ie.expandedFarZProjMatrix,Pi),qr=a.aA([],[ta,Ni,Fr,1],_i)[2];Er.hidden=!1;let Hr=Bt;Et||(wt&&(Hr*=ar.cameraCollisionOpacity,Hr*=bh(Pi,Ie,ar.aabb,Dt)),Hr*=$x(Ot,qr)),Hr!==0?ei.push({nodeInfo:ar,depth:qr,opacity:Hr,wvpForNode:_i,wvpForTile:kr,nodeModelMatrix:rr,tileModelMatrix:Pi}):Er.hidden=!0}Et||ei.sort((ar,Er)=>!wt||ar.opacity===1&&Er.opacity===1?ar.depth<Er.depth?-1:1:ar.opacity===1?-1:Er.opacity===1?1:ar.depth>Er.depth?-1:1);for(const ar of ei){const Er=ar.nodeInfo,Fr=Er.node;let Ur=a.az([],xt,ar.tileModelMatrix);a.az(Ur,et,Ur);const ti=a.bi([],Ur);a.ee(ti,ti),a.cE(ti,ti,hg),Ur=a.az(Ur,Ur,Fr.matrix);const Pi=ue.renderPass==="light-beam",ta=Ee.paint.get("model-color-use-theme").constantOr("default")==="none",Ni=Tr&a.em.HasMapboxMeshFeatures,rr=Ni?0:Er.evaluatedRMEA[0][2];for(let _i=0;_i<Fr.meshes.length;++_i){const kr=Fr.meshes[_i],qr=_i===Fr.lightMeshIndex;let Hr=ar.wvpForNode;if(qr){if(!Pi&&!ue.terrain&&ue.shadowRenderer){ue.currentLayer<ue.firstLightBeamLayer&&(ue.firstLightBeamLayer=ue.currentLayer);continue}Hr=ar.wvpForTile}else if(Pi)continue;const Di={defines:[]},za=[];if(!Et&&Ce&&(Ce.useNormalOffset=!!kr.normalBuffer),Xt(Di.defines,za,kr,ue,ta?null:Ee.lut),Ni||Di.defines.push("DIFFUSE_SHADED"),Yn&&Di.defines.push("SHADOWS_SINGLE_CASCADE"),zt&&(Et?zt.numRenderedVerticesInShadowPass+=kr.vertexArray.length:zt.numRenderedVerticesInTransparentPass+=kr.vertexArray.length),Et){Yi(kr,ar.nodeModelMatrix,ue,Ee);continue}let bi=null;if(Oe){const ao=sd(ar.nodeModelMatrix,ue.transform);if(bi=new Float32Array(ao),Ie.projection.name!=="globe"){const Go=kr.aabb.min,xc=kr.aabb.max,[Wo,ul]=Oe.getOpacityForBounds(ao,Go[0],Go[1],xc[0],xc[1]);Di.overrideFog=Wo>=qt||ul>=qt}}const xa=kr.material;let di;xa.occlusionTexture&&xa.occlusionTexture.offsetScale&&(di=xa.occlusionTexture.offsetScale,Di.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const Sa=ue.getOrCreateProgram("model",Di);!Et&&Ce&&Ce.setupShadowsFromMatrix(ar.tileModelMatrix,Sa,Ce.useNormalOffset),ue.uploadCommonUniforms(ze,Sa,null,bi);const io=xa.pbrMetallicRoughness;io.metallicFactor=.9,io.roughnessFactor=.5;const Ho=Qu(new Float32Array(Hr),new Float32Array(Ur),new Float32Array(ti),new Float32Array(Fr.matrix),ue,ar.opacity,io.baseColorFactor.toRenderColor(null),xa.emissiveFactor,io.metallicFactor,io.roughnessFactor,xa,rr,Ee,[0,0,0],di);!qr&&(Er.hasTranslucentParts||ar.opacity<1)&&Sa.draw(ue,ze.gl.TRIANGLES,Je,Kn.disabled,pr.disabled,Jn.backCCW,Ho,Ee.id,kr.vertexBuffer,kr.indexBuffer,kr.segments,Ee.paint,ue.transform.zoom,void 0,za),Sa.draw(ue,ze.gl.TRIANGLES,qr?lt:Je,Kn.disabled,qr||ar.opacity<1||Er.hasTranslucentParts?pr.alphaBlended:pr.unblended,Jn.backCCW,Ho,Ee.id,kr.vertexBuffer,kr.indexBuffer,kr.segments,Ee.paint,ue.transform.zoom,void 0,za)}}}}()}(x,s,u,y),void z();if(U.type!=="model")return;const H=U.getModels(),K=[],X=x.transform.getFreeCameraOptions().position,J=a.b$([],[X.x,X.y,X.z],x.transform.worldSize);a.eb(J,J);const de=[],ce=[];let fe=0;for(const ue of H){const ve=u.paint.get("model-rotation").constantOr(null),Ee=u.paint.get("model-scale").constantOr(null),Pe=u.paint.get("model-translation").constantOr(null);ue.computeModelMatrix(x,ve,Ee,Pe,!0,!0,!1);const ze=a.bx([]),Ie=a.ec(ue.position.lat,x.transform.zoom),Oe=a.bn([],[1,1,1/Ie]);a.bo(ze,ze,J),K.push({zScaleMatrix:Oe,negCameraPosMatrix:ze});for(const Ce of ue.nodes)Nl(x.transform,Ce,ue.matrix,x.transform.expandedFarZProjMatrix,fe,de,ce);fe++}if(de.sort((ue,ve)=>ve.depth-ue.depth),x.renderPass!=="shadow"){if(S===1)for(const ue of ce)fn(ue,x,u,K[ue.modelIndex],Kn.disabled,x.colorModeForRenderPass());else{for(const ue of ce)fn(ue,x,u,K[ue.modelIndex],Kn.disabled,pr.disabled);for(const ue of ce)fn(ue,x,u,K[ue.modelIndex],x.stencilModeFor3D(),x.colorModeForRenderPass());x.resetStencilClippingMasks()}for(const ue of de)fn(ue,x,u,K[ue.modelIndex],Kn.disabled,x.colorModeForRenderPass());z()}else{for(const ue of ce)Yi(ue.mesh,ue.nodeModelMatrix,x,u);for(const ue of de)Yi(ue.mesh,ue.nodeModelMatrix,x,u);z()}}},Sh={line:function(x,s,u){if(x.hasElevatedBuckets=!1,x.hasNonElevatedBuckets=!1,x._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||x._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(s){const y=s.getVisibleCoordinates();for(const S of y){const A=s.getTile(S).getBucket(x);if(A&&(A.elevationType!=="none"?x.hasElevatedBuckets=!0:x.hasNonElevatedBuckets=!0,x.hasElevatedBuckets&&x.hasNonElevatedBuckets))break}}}else x.hasNonElevatedBuckets=!0},model:function(x,s,u){const y=s.getSource();if(!y.loaded())return;if(y.type==="vector"||y.type==="geojson")return void(u.modelManager&&u.modelManager.upload(u,y.type==="vector"?x.scope:""));if(y.type==="batched-model"||y.type!=="model")return;const S=y.getModels();for(const A of S)A.upload(u.context)},raster:function(x,s,u){const y=s.getSource();if(!(y instanceof rs&&y.loaded()))return;const S=x.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!S)return;const A=x.paint.get("raster-array-band")||y.getInitialBand(S);if(A==null)return;const M=s.getIds().map(D=>s.getTileByID(D));for(const D of M)D.updateNeeded(S,A)&&y.prepareTile(D,S,A)},"raster-particle":function(x,s,u){const y=s.getSource();if(!(y instanceof rs&&y.loaded()))return;const S=x.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!S)return;const A=x.paint.get("raster-particle-array-band")||y.getInitialBand(S);if(A==null)return;const M=s.getIds().map(D=>s.getTileByID(D));for(const D of M)D.updateNeeded(S,A)&&y.prepareTile(D,S,A)}},hc={fill:Ma};class Th{constructor(s,u,y,S,A){this.context=new si(s,u),this.transform=y,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=A,this._timeStamp=a.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const M=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const z of M)this._debugParams.enabledLayers[z]=!0;A.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),A.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),A.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),A.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),A.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),A.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const z of M)A.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],z);this.occlusionParams=new Hx(A),this.setup(),this.numSublayers=_s.maxUnderzooming+_s.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new a.et,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new nl(this),this._wireframeDebugCache=new qx,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const D=new a.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new a.T(this.context,D,s.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=S}updateTerrain(s,u){const y=!!s&&!!s.terrain&&this.transform.projection.supportsTerrain;if(!(y||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Zu(this,s));const S=this._terrain;this.transform.elevation=y?S:null,S.update(s,this.transform,u),this.transform.elevation&&!S.enabled&&(this.transform.elevation=null)}_updateFog(s){const u=s.fog;if(!u||this.transform.projection.name==="globe"||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[y,S]=u.getFovAdjustedRange(this.transform._fov);if(y>S)return void(this.transform.fogCullDistSq=null);const A=y+.78*(S-y);this.transform.fogCullDistSq=A*A}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(s){s&&!this._terrain&&(this._terrain=new Zu(this,this.style)),this._forceTerrainMode=s}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(s,u){if(this.width=s*a.q.devicePixelRatio,this.height=u*a.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style.order)this.style._mergedLayers[y].resize()}setup(){const s=this.context,u=new a.ba;u.emplaceBack(0,0),u.emplaceBack(a.aj,0),u.emplaceBack(0,a.aj),u.emplaceBack(a.aj,a.aj),this.tileExtentBuffer=s.createVertexBuffer(u,a.bc.members),this.tileExtentSegments=a.bd.simpleSegment(0,0,4,2);const y=new a.ba;y.emplaceBack(0,0),y.emplaceBack(a.aj,0),y.emplaceBack(0,a.aj),y.emplaceBack(a.aj,a.aj),this.debugBuffer=s.createVertexBuffer(y,a.bc.members),this.debugSegments=a.bd.simpleSegment(0,0,4,5);const S=new a.ba;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(-1,1),S.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(S,a.bc.members),this.viewportSegments=a.bd.simpleSegment(0,0,4,2);const A=new a.aZ;A.emplaceBack(0,0,0,0),A.emplaceBack(a.aj,0,a.aj,0),A.emplaceBack(0,a.aj,0,a.aj),A.emplaceBack(a.aj,a.aj,a.aj,a.aj),this.mercatorBoundsBuffer=s.createVertexBuffer(A,a.bf.members),this.mercatorBoundsSegments=a.bd.simpleSegment(0,0,4,2);const M=new a.a_;M.emplaceBack(0,1,2),M.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(M);const D=new a.bb;for(const U of[0,1,3,2,0])D.emplaceBack(U);this.debugIndexBuffer=s.createIndexBuffer(D),this.emptyTexture=new a.T(s,new a.r({width:1,height:1},Uint8Array.of(0,0,0,0)),s.gl.RGBA8),this.identityMat=a.bz();const z=this.context.gl;this.stencilClearMode=new Kn({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(s){return s._makeTileBoundsBuffers(this.context,this.transform.projection),s._tileBoundsBuffer?{tileBoundsBuffer:s._tileBoundsBuffer,tileBoundsIndexBuffer:s._tileBoundsIndexBuffer,tileBoundsSegments:s._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const s=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,s.TRIANGLES,_n.disabled,this.stencilClearMode,pr.disabled,Jn.disabled,_o(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(s,u,y){if(!u||this.currentStencilSource===u.id||!s.isTileClipped()||!y||y.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let D=!1;for(const z of y)if(this._tileClippingMaskIDs[z.key]===void 0){D=!0;break}if(!D)return}this.currentStencilSource=u.id;const S=this.context,A=S.gl;this.nextStencilID+y.length>256&&this.clearStencil(),S.setColorMode(pr.disabled),S.setDepthMode(_n.disabled);const M=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const D of y){const z=u.getTile(D),U=this._tileClippingMaskIDs[D.key]=this.nextStencilID++,{tileBoundsBuffer:H,tileBoundsIndexBuffer:K,tileBoundsSegments:X}=this.getTileBoundsBuffers(z);M.draw(this,A.TRIANGLES,_n.disabled,new Kn({func:A.ALWAYS,mask:0},U,255,A.KEEP,A.KEEP,A.REPLACE),pr.disabled,Jn.disabled,_o(D.projMatrix),"$clipping",H,K,X)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,u=this.context.gl;return new Kn({func:u.NOTEQUAL,mask:255},s,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(s){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(s);const u=this.context.gl;return new Kn({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(s){const u=this.context.gl,y=s.sort((M,D)=>D.overscaledZ-M.overscaledZ),S=y[y.length-1].overscaledZ,A=y[0].overscaledZ-S+1;if(A>1){this.currentStencilSource=void 0,this.nextStencilID+A>256&&this.clearStencil();const M={};for(let D=0;D<A;D++)M[D+S]=new Kn({func:u.GEQUAL,mask:255},D+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=A,[M,y]}return[{[S]:Kn.disabled},y]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new pr([s.CONSTANT_COLOR,s.ONE,s.CONSTANT_COLOR,s.ONE],new a.am(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?pr.unblended:pr.alphaBlended}colorModeForDrapableLayerRenderPass(s){const u=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new pr([u.ONE,u.ONE_MINUS_SRC_ALPHA,u.CONSTANT_ALPHA,u.ONE_MINUS_SRC_ALPHA],new a.am(0,0,0,s===void 0?0:s),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(s,u,y,S=!1){if(this.depthOcclusion)return new _n(this.context.gl.GREATER,_n.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!S)return _n.disabled;const A=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new _n(y||this.context.gl.LEQUAL,u,[A,A])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const s=this.context.gl,u=Math.ceil(this.width),y=Math.ceil(this.height),S=this.context.bindFramebuffer.get(),A=s.getParameter(s.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===u&&this.depthFBO.height===y||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),u!==0&&y!==0&&(this.depthFBO=new dc(this.context,u,y,!1,"texture"),this.depthTexture=new a.T(this.context,{width:u,height:y,data:null},s.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(S),s.bindTexture(s.TEXTURE_2D,A),this.depthFBO&&(s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),s.blitFramebuffer(0,0,u,y,0,0,u,y,s.DEPTH_BUFFER_BIT,s.NEAREST),s.bindFramebuffer(s.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((s,u)=>s+u/this._fpsHistory.length,0))}render(s,u){const y=a.q.now();this._dt=y-this._timeStamp,this._timeStamp=y,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=s.map.repaint,this.style=s,this.options=u;const S=this.style._mergedLayers,A=!(!this.terrain||!this.terrain.enabled),M=()=>this.style._getOrder(A).filter(Je=>{const lt=S[Je];return!(lt.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[lt.type]});let D=M(),z=!1,U=!1;for(const Je of D){const lt=S[Je];lt.type==="circle"&&(z=!0),lt.type==="symbol"&&(lt.hasInitialOcclusionOpacityProperties?U=!0:z=!0)}let H=D.map(Je=>S[Je]);const K=this.style._mergedSourceCaches;this.imageManager=s.imageManager,this.modelManager=s.modelManager,this.symbolFadeChange=s.placement.symbolFadeChange(a.q.now()),this.imageManager.beginFrame();let X=0,J=!1;for(const Je in K){const lt=K[Je];lt.used&&(lt.prepare(this.context),lt.getSource().usedInConflation&&++X)}let de=!1;for(const Je of H)Je.isHidden(this.transform.zoom)||(Je.type==="clip"&&(de=!0),this.prepareLayer(Je));const ce={},fe={},ue={},ve={},Ee={};for(const Je in K){const lt=K[Je];ce[Je]=lt.getVisibleCoordinates(),fe[Je]=ce[Je].slice().reverse(),ue[Je]=lt.getVisibleCoordinates(!0).reverse(),ve[Je]=lt.getShadowCasterCoordinates(),Ee[Je]=lt.sortCoordinatesByDistance(ce[Je])}const Pe=Je=>{const lt=this.style.getLayerSourceCache(Je);return lt&&lt.used?lt.getSource():null};if(X||de||this._clippingActiveLastFrame){const Je=[],lt=[];let Ke=0;for(const Et of H)this.isSourceForClippingOrConflation(Et,Pe(Et))&&(Je.push(Et),lt.push(Ke)),Ke++;if(Je&&(de||Je.length>1)||this._clippingActiveLastFrame){de=!1;const Et=[];for(let ct=0;ct<Je.length;ct++){const Dt=Je[ct],wt=lt[ct],Ot=this.style.getLayerSourceCache(Dt);if(!Ot||!Ot.used||!Ot.getSource().usedInConflation&&Dt.type!=="clip")continue;let zt=a.ev,yn=a.bQ.None;const Tn=[];let gn=!0;if(Dt.type==="clip"){zt=wt;for(const Pn of Dt.layout.get("clip-layer-types"))yn|=Pn==="model"?a.bQ.Model:Pn==="symbol"?a.bQ.Symbol:a.bQ.FillExtrusion;for(const Pn of Dt.layout.get("clip-layer-scope"))Tn.push(Pn);Dt.isHidden(this.transform.zoom)?gn=!1:de=!0}gn&&Et.push({layer:Dt.fqid,cache:Ot,order:zt,clipMask:yn,clipScope:Tn})}this.replacementSource.setSources(Et),J=!0}}this._clippingActiveLastFrame=de,J||this.replacementSource.clear(),this.conflationActive=J,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let Je=0;Je<H.length;Je++){const lt=H[Je],Ke=lt.cutoffRange();if(this.longestCutoffRange=Math.max(Ke,this.longestCutoffRange),Ke>0){const Et=Pe(lt);Et&&(this.minCutoffZoom=Math.max(Et.minzoom,this.minCutoffZoom)),lt.minzoom&&(this.minCutoffZoom=Math.max(lt.minzoom,this.minCutoffZoom))}lt.is3D(A)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=Je),this._lastOcclusionLayer=Je)}const ze=this.style&&this.style.fog;ze?(this._fogVisible=ze.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=ze.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(ue),this.opaquePassCutoff=0,D=M(),H=D.map(Je=>S[Je]));const Ie=this._shadowRenderer;if(Ie){Ie.updateShadowParameters(this.transform,this.style.directionalLight);for(const Je in K)for(const lt of ce[Je]){let Ke={min:0,max:0};this.terrain&&(Ke=this.terrain.getMinMaxForTile(lt)||Ke),Ie.addShadowReceiver(lt.toUnwrapped(),Ke.min,Ke.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.eu(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new _h(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Oe=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Ce=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Oe&&!this._snow&&(this._snow=new Bi(this)),!Oe&&this._snow&&(this._snow.destroy(),delete this._snow),Ce&&!this._rain&&(this._rain=new Uy(this)),!Ce&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!hr.has(this.context.gl))return;this.renderPass="offscreen";for(const Je of H){const lt=s.getLayerSourceCache(Je);if(!Je.hasOffscreenPass()||Je.isHidden(this.transform.zoom))continue;const Ke=lt?fe[lt.id]:void 0;(Je.type==="custom"||Je.type==="raster"||Je.type==="raster-particle"||Je.isSky()||Ke&&Ke.length)&&this.renderLayer(this,lt,Je,Ke)}this.depthRangeFor3D=[0,1-(H.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,ve)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Fe=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),$e=(()=>{if(u.showOverdrawInspector)return a.am.black;const Je=this.style.fog;if(Je&&this.transform.projection.supportsFog){const lt=this.style.getLut(Je.scope);if(!Fe){const Ke=Je.properties.get("color-use-theme")==="none",Et=Je.properties.get("color").toRenderColor(Ke?null:lt).toArray01();return new a.am(...Et)}if(Fe){const Ke=Je.properties.get("space-color-use-theme")==="none",Et=Je.properties.get("space-color").toRenderColor(Ke?null:lt).toArray01();return new a.am(...Et)}}return a.am.transparent})();if(this.context.clear({color:$e,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Fe&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=D.length-1;this.currentLayer>=0;this.currentLayer--){const Je=H[this.currentLayer],lt=s.getLayerSourceCache(Je);if(Je.isSky())continue;const Ke=lt?(Je.is3D(A)?Ee:fe)[lt.id]:void 0;this._renderTileClippingMasks(Je,lt,Ke),this.renderLayer(this,lt,Je,Ke)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Fe&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||a.ah(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<D.length;this.currentLayer++){const Je=H[this.currentLayer],lt=s.getLayerSourceCache(Je);Je.isSky()&&this.renderLayer(this,lt,Je,lt?fe[lt.id]:void 0)}function st(Je,lt){let Ke;return lt&&(Ke=(Je.type==="symbol"?ue:Je.is3D(A)?Ee:fe)[lt.id]),Ke}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<D.length;){const Je=H[this.currentLayer];if(Je.type==="raster"||Je.type==="raster-particle"){const lt=s.getLayerSourceCache(Je);this.renderLayer(this,lt,Je,st(Je,lt))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let et=0;Ie&&(et=Ie.getShadowCastingLayerCount());let _t=!1,xt=-1;for(let Je=0;Je<D.length;++Je){const lt=H[Je];lt.isHidden(this.transform.zoom)||lt.is3D(A)&&(xt=Je)}U&&xt===-1&&(z=!0);let Bt=!1;for(;this.currentLayer<D.length;){const Je=H[this.currentLayer],lt=s.getLayerSourceCache(Je);if(Je.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(Je)){if(Je.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!Bt&&Je.is3D(A)&&!A){const Ke=this.currentLayer,Et=ct=>{for(this.currentLayer=0;this.currentLayer<H.length;this.currentLayer++){const Dt=H[this.currentLayer];if(hc[Dt.type]){const wt=this.style.getLayerSourceCache(Dt);hc[Dt.type](this,wt,Dt,st(Dt,wt),ct)}}};Et("initialize"),Et("reset"),this.currentLayer=Ke,Bt=!0}if(z&&!_t&&this.terrain&&!this.transform.isOrthographic&&(_t=!0,this.blitDepth()),U&&xt!==-1&&this.currentLayer===xt+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(Je,lt,lt?ce[lt.id]:void 0),this.renderLayer(this,lt,Je,st(Je,lt)),!this.terrain&&Ie&&et>0&&Je.hasShadowPass()&&--et==0&&(Ie.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Ke=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Ke;this.currentLayer++){const Et=H[this.currentLayer];if(!Et.hasLightBeamPass())continue;const ct=s.getLayerSourceCache(Et);this.renderLayer(this,ct,Et,ct?fe[ct.id]:void 0)}this.currentLayer=Ke,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Ke=this.currentLayer;this.depthOcclusion=!0;for(const Et of this.layersWithOcclusionOpacity){this.currentLayer=Et;const ct=H[this.currentLayer],Dt=s.getLayerSourceCache(ct),wt=Dt?fe[Dt.id]:void 0;this.terrain||this._renderTileClippingMasks(ct,Dt,Dt?ce[Dt.id]:void 0),this.renderLayer(this,Dt,ct,wt)}this.depthOcclusion=!1,this.currentLayer=Ke,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Je=null;H.forEach(lt=>{const Ke=s.getLayerSourceCache(lt);Ke&&!lt.isHidden(this.transform.zoom)&&Ke.getVisibleCoordinates().length&&(!Je||Je.getSource().maxzoom<Ke.getSource().maxzoom)&&(Je=Ke)}),Je&&this.options.showTileBoundaries&&Vr.debug(this,Je,Je.getVisibleCoordinates(),a.am.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Vr.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new a.am(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(Je){const lt=Je.transform.padding;Gp(Je,Je.transform.height-(lt.top||0),3,qp),Gp(Je,lt.bottom||0,3,Hp),Wp(Je,lt.left||0,3,ug),Wp(Je,Je.transform.width-(lt.right||0),3,To);const Ke=Je.transform.centerPoint;(function(Et,ct,Dt,wt){ad(Et,ct-1,Dt-10,2,20,wt),ad(Et,ct-10,Dt-1,20,2,wt)})(Je,Ke.x,Je.transform.height-Ke.y,pu)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),J||(this.conflationActive=!1)}prepareLayer(s){this.gpuTimingStart(s);const{unsupportedLayers:u}=this.transform.projection,y=!u||!u.includes(s.type);if(Sh[s.type]&&(y||this.terrain&&s.type==="custom")){const S=this.style.getLayerSourceCache(s);Sh[s.type](s,S,this)}this.gpuTimingEnd()}renderLayer(s,u,y,S){y.isHidden(this.transform.zoom)||(y.type==="background"||y.type==="sky"||y.type==="custom"||y.type==="model"||y.type==="raster"||y.type==="raster-particle"||S&&S.length)&&(this.id=y.id,this.gpuTimingStart(y),s.transform.projection.unsupportedLayers&&s.transform.projection.unsupportedLayers.includes(y.type)&&(!s.terrain||y.type!=="custom")||y.type==="clip"||Vr[y.type](s,u,y,S,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(s){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery,y=this.context.gl;let S=this.gpuTimers[s.id];S||(S=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:y.createQuery()}),S.calls++,y.beginQuery(u.TIME_ELAPSED_EXT,S.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const s=this.context.extTimerQuery,u=this.context.gl,y=u.createQuery();this.deferredRenderGpuTimeQueries.push(y),u.beginQuery(s.TIME_ELAPSED_EXT,y)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const s=this.gpuTimers;return this.gpuTimers={},s}collectDeferredRenderGpuQueries(){const s=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],s}queryGpuTimers(s){const u={};for(const y in s){const S=s[y],A=this.context.extTimerQuery,M=A.getQueryParameter(S.query,this.context.gl.QUERY_RESULT)/1e6;A.deleteQueryEXT(S.query),u[y]=M}return u}queryGpuTimeDeferredRender(s){if(!this.options.gpuTimingDeferredRender)return 0;const u=this.context.gl;let y=0;for(const S of s)y+=u.getQueryParameter(S,u.QUERY_RESULT)/1e6,u.deleteQuery(S);return y}translatePosMatrix(s,u,y,S,A){if(!y[0]&&!y[1])return s;const M=A?S==="map"?this.transform.angle:0:S==="viewport"?-this.transform.angle:0;if(M){const U=Math.sin(M),H=Math.cos(M);y=[y[0]*H-y[1]*U,y[0]*U+y[1]*H]}const D=[A?y[0]:a.aw(u,y[0],this.transform.zoom),A?y[1]:a.aw(u,y[1],this.transform.zoom),0],z=new Float32Array(16);return a.bo(z,s,D),z}saveTileTexture(s){const u=s.size[0],y=this._tileTextures[u];y?y.push(s):this._tileTextures[u]=[s]}getTileTexture(s){const u=this._tileTextures[s];return u&&u.length>0?u.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(s,u,y){const S=y===void 0?this.terrain&&this.terrain.renderingToTexture:y,A=[];return this.style&&this.style.enable3dLights()&&(s==="globeRaster"||s==="terrainRaster"?(A.push("LIGHTING_3D_MODE"),A.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):S||A.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||A.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(A.push("TERRAIN"),this.linearFloatFilteringSupported()&&A.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&A.push("GLOBE"),!this._fogVisible||S||u!==void 0&&!u||A.push("FOG","FOG_DITHERING"),S&&A.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&A.push("OVERDRAW_INSPECTOR"),A}getOrCreateProgram(s,u){this.cache=this.cache||{};const y=u&&u.defines||[],S=u&&u.config,A=this.currentGlobalDefines(s,u&&u.overrideFog,u&&u.overrideRtt).concat(y),M=du.cacheKey(jl[s],s,A,S);return this.cache[M]||(this.cache[M]=new du(this.context,s,jl[s],S,lg[s],A)),this.cache[M]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(s,u){if(this.style.enable3dLights()){const y=this.style.directionalLight,S=this.style.ambientLight;if(y&&S){const A=((M,D,z)=>{const U=M.properties.get("direction"),H=M.properties.get("color-use-theme")==="none",K=M.properties.get("color").toRenderColor(H?null:z.getLut(M.scope)).toArray01(),X=M.properties.get("intensity"),J=D.properties.get("color-use-theme")==="none",de=D.properties.get("color").toRenderColor(J?null:z.getLut(D.scope)).toArray01(),ce=D.properties.get("intensity"),fe=[U.x,U.y,U.z],ue=a.dw(de,ce),ve=a.dw(K,X);return{u_lighting_ambient_color:ue,u_lighting_directional_dir:fe,u_lighting_directional_color:ve,u_ground_radiance:mh(fe,ve,ue)}})(y,S,this.style);u.setLightsUniformValues(s,A)}}}uploadCommonUniforms(s,u,y,S,A){if(this.uploadCommonLightUniforms(s,u),this.terrain&&this.terrain.renderingToTexture)return;const M=this.style.fog;if(M){const D=M.getOpacity(this.transform.pitch),z=((U,H,K,X,J,de,ce,fe,ue,ve,Ee,Pe)=>{const ze=U.transform,Ie=H.properties.get("color-use-theme")==="none",Oe=H.properties.get("color").toRenderColor(Ie?null:U.style.getLut(H.scope)).toArray01();Oe[3]=X;const Ce=U.frameCounter/1e3%1,[Fe,$e]=H.properties.get("vertical-range");return{u_fog_matrix:K?ze.calculateFogTileMatrix(K):Pe||U.identityMat,u_fog_range:H.getFovAdjustedRange(ze._fov),u_fog_color:Oe,u_fog_horizon_blend:H.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Fe,$e),$e],u_fog_temporal_offset:Ce,u_frustum_tl:J,u_frustum_tr:de,u_frustum_br:ce,u_frustum_bl:fe,u_globe_pos:ue,u_globe_radius:ve,u_viewport:Ee,u_globe_transition:a.ah(ze.zoom),u_is_globe:+(ze.projection.name==="globe")}})(this,M,y,D,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.q.devicePixelRatio,this.transform.height*a.q.devicePixelRatio],S);u.setFogUniformValues(s,z)}A&&u.setCutoffUniformValues(s,A.uniformValues)}setTileLoadedFlag(s){this.tileLoaded=s}saveCanvasCopy(){const s=this.canvasCopy();s&&(this.frameCopies.push(s),this.tileLoaded=!1)}canvasCopy(){const s=this.context.gl,u=s.createTexture();return s.bindTexture(s.TEXTURE_2D,u),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGBA,0,0,s.drawingBufferWidth,s.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const s=this.style&&this.style.fog;return!!s&&s.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const s=this._backgroundTiles,u=this._backgroundTiles={},y=this.transform.coveringTiles({tileSize:512});for(const S of y)u[S.key]=s[S.key]||new Ql(S,512,this.transform.tileZoom,this);return u}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(s,u){return!(!s.is3D(!(!this.terrain||!this.terrain.enabled))||s.type!=="clip"&&(s.minzoom&&s.minzoom>this.transform.zoom||(this.style._clipLayerPresent||s.sourceLayer!=="building")&&(!u||u.type!=="batched-model")))}isTileAffectedByFog(s){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let u=this._cachedTileFogOpacities[s.key];return u||(this._cachedTileFogOpacities[s.key]=u=this.style.fog.getOpacityForTile(s)),u[0]>=qt||u[1]>=qt}setupDepthForOcclusion(s,u,y){const S=this.context,A=S.gl,M=!!y;var D;y||(y={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),S.activeTexture.set(A.TEXTURE3),s&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),y.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],y.u_depth_range_unpack=[2/((D=this.depthRangeFor3D)[1]-D[0]),-1-2*D[0]/(D[1]-D[0])],y.u_occluder_half_size=.5*this.occlusionParams.occluderSize,y.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),S.activeTexture.set(A.TEXTURE0),M||u.setTerrainUniformValues(S,y)}}function cd(x,s){let u=!1,y=null;const S=()=>{y=null,u&&(x(),y=setTimeout(S,s),u=!1)};return()=>(u=!0,y||S(),y)}class Eh{constructor(s){this._hashName=s&&encodeURIComponent(s),a.aV(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=cd(this._updateHashUnthrottled.bind(this),300)}addTo(s){return this._map=s,window.addEventListener("hashchange",this._onHashChange,!1),s.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const s=this._map;if(!s)return"";const u=Ah(s);if(this._hashName){const y=this._hashName;let S=!1;const A=location.hash.slice(1).split("&").map(M=>{const D=M.split("=")[0];return D===y?(S=!0,`${D}=${u}`):M}).filter(M=>M);return S||A.push(`${y}=${u}`),`#${A.join("&")}`}return`#${u}`}_getCurrentHash(){const s=location.hash.replace("#","");if(this._hashName){let u;return s.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(u=y)}),(u&&u[1]||"").split("/")}return s.split("/")}_onHashChange(){const s=this._map;if(!s)return!1;const u=this._getCurrentHash();if(u.length>=3&&!u.some(y=>isNaN(Number(y)))){const y=s.dragRotate.isEnabled()&&s.touchZoomRotate.isEnabled()?+(u[3]||0):s.getBearing();return s.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:y,pitch:+(u[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Ah(x,s){const u=x.getCenter(),y=Math.round(100*x.getZoom())/100,S=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),A=Math.pow(10,S),M=Math.round(u.lng*A)/A,D=Math.round(u.lat*A)/A,z=x.getBearing(),U=x.getPitch();let H=s?`/${M}/${D}/${y}`:`${y}/${D}/${M}`;return(z||U)&&(H+="/"+Math.round(10*z)/10),U&&(H+=`/${Math.round(U)}`),H}const Ch={linearity:.3,easing:a.ew(0,0,.3,1)},gg=a.l({deceleration:2500,maxSpeed:1400},Ch),Wx=a.l({deceleration:20,maxSpeed:1400},Ch),Eo=a.l({deceleration:1e3,maxSpeed:360},Ch),sl=a.l({deceleration:1e3,maxSpeed:90},Ch);class jh{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.q.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,u=a.q.now();for(;s.length>0&&u-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const u={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:A}of this._inertiaBuffer)u.zoom+=A.zoomDelta||0,u.bearing+=A.bearingDelta||0,u.pitch+=A.pitchDelta||0,A.panDelta&&u.pan._add(A.panDelta),A.around&&(u.around=A.around),A.pinchAround&&(u.pinchAround=A.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(u.pan.mag()){const A=gu(u.pan.mag(),y,a.l({},gg,s||{}));S.offset=u.pan.mult(A.amount/u.pan.mag()),S.center=this._map.transform.center,fc(S,A)}if(u.zoom){const A=gu(u.zoom,y,Wx);S.zoom=this._map.transform.zoom+A.amount,fc(S,A)}if(u.bearing){const A=gu(u.bearing,y,Eo);S.bearing=this._map.transform.bearing+a.aD(A.amount,-179,179),fc(S,A)}if(u.pitch){const A=gu(u.pitch,y,sl);S.pitch=this._map.transform.pitch+A.amount,fc(S,A)}if(S.zoom||S.bearing){const A=u.pinchAround===void 0?u.around:u.pinchAround;S.around=A?this._map.unproject(A):this._map.getCenter()}return this.clear(),S.noMoveStart=!0,S}}function fc(x,s){(!x.duration||x.duration<s.duration)&&(x.duration=s.duration,x.easing=s.easing)}function gu(x,s,u){const{maxSpeed:y,linearity:S,deceleration:A}=u,M=a.aD(x*S/(s/1e3),-y,y),D=Math.abs(M)/(A*S);return{easing:u.easing,duration:1e3*D,amount:M*(D/2)}}class no extends a.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u,y,S={}){const A=ke(u.getCanvasContainer(),y),M=u.unproject(A);super(s,a.l({point:A,lngLat:M,originalEvent:y},S)),this._defaultPrevented=!1,this.target=u}}class pc extends a.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u,y){const S=s==="touchend"?y.changedTouches:y.touches,A=qe(u.getCanvasContainer(),S),M=A.map(z=>u.unproject(z)),D=A.reduce((z,U,H,K)=>z.add(U.div(K.length)),new a.P(0,0));super(s,{points:A,point:D,lngLats:M,lngLat:u.unproject(D),originalEvent:y}),this._defaultPrevented=!1}}class ud extends a.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u){super("wheel",{originalEvent:u}),this._defaultPrevented=!1}}class xu{constructor(s,u){this._map=s,this._clickTolerance=u.clickTolerance}reset(){this._mousedownPos=void 0}wheel(s){return this._firePreventable(new ud(this._map,s))}mousedown(s,u){return this._mousedownPos=u,this._firePreventable(new no(s.type,this._map,s))}mouseup(s){this._map.fire(new no(s.type,this._map,s))}preclick(s){const u=a.l({},s);u.type="preclick",this._map.fire(new no(u.type,this._map,u))}click(s,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(s),this._map.fire(new no(s.type,this._map,s)))}dblclick(s){return this._firePreventable(new no(s.type,this._map,s))}mouseover(s){this._map.fire(new no(s.type,this._map,s))}mouseout(s){this._map.fire(new no(s.type,this._map,s))}touchstart(s){return this._firePreventable(new pc(s.type,this._map,s))}touchmove(s){this._map.fire(new pc(s.type,this._map,s))}touchend(s){this._map.fire(new pc(s.type,this._map,s))}touchcancel(s){this._map.fire(new pc(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class qo{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(s){this._map.fire(new no(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new no("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new no(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ol{constructor(s,u){this._map=s,this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,u){this.isEnabled()&&s.shiftKey&&s.button===0&&(ge(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(s,u){if(!this._active)return;const y=u,S=this._startPos,A=this._lastPos;if(!S||!A||A.equals(y)||!this._box&&y.dist(S)<this._clickTolerance)return;this._lastPos=y,this._box||(this._box=W("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));const M=Math.min(S.x,y.x),D=Math.max(S.x,y.x),z=Math.min(S.y,y.y),U=Math.max(S.y,y.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${M}px,${z}px)`,this._box.style.width=D-M+"px",this._box.style.height=U-z+"px")})}mouseupWindow(s,u){if(!this._active)return;const y=this._startPos,S=u;if(y&&s.button===0){if(this.reset(),me(),y.x!==S.x||y.y!==S.y)return this._map.fire(new a.A("boxzoomend",{originalEvent:s})),{cameraAnimation:A=>A.fitScreenCoordinates(y,S,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",s)}}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ae(),delete this._startPos,delete this._lastPos}_fireEvent(s,u){return this._map.fire(new a.A(s,{originalEvent:u}))}}function Dl(x,s){const u={};for(let y=0;y<x.length;y++)u[x[y].identifier]=s[y];return u}class xg{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(s,u,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=s.timeStamp),y.length===this.numTouches&&(this.centroid=function(S){const A=new a.P(0,0);for(const M of S)A._add(M);return A.div(S.length)}(u),this.touches=Dl(y,u)))}touchmove(s,u,y){if(this.aborted||!this.centroid)return;const S=Dl(y,u);for(const A in this.touches){const M=S[A];(!M||M.dist(this.touches[A])>30)&&(this.aborted=!0)}}touchend(s,u,y){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),y.length===0){const S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class la{constructor(s){this.singleTap=new xg(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(s,u,y){this.singleTap.touchstart(s,u,y)}touchmove(s,u,y){this.singleTap.touchmove(s,u,y)}touchend(s,u,y){const S=this.singleTap.touchend(s,u,y);if(S){const A=s.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(S)<30;if(A&&M||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class mc{constructor(){this._zoomIn=new la({numTouches:1,numTaps:2}),this._zoomOut=new la({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,u,y){this._zoomIn.touchstart(s,u,y),this._zoomOut.touchstart(s,u,y)}touchmove(s,u,y){this._zoomIn.touchmove(s,u,y),this._zoomOut.touchmove(s,u,y)}touchend(s,u,y){const S=this._zoomIn.touchend(s,u,y),A=this._zoomOut.touchend(s,u,y);return S?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()+1,around:M.unproject(S)},{originalEvent:s})}):A?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()-1,around:M.unproject(A)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Qa={0:1,2:2},gc={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class Mh{constructor(s){this.reset(),this._clickTolerance=s.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(s,u){return!1}_move(s,u){return{}}mousedown(s,u){if(this._lastPoint)return;const y=tt(s);this._correctButton(s,y)&&(this._lastPoint=u,this._eventButton=y)}mousemoveWindow(s,u){const y=this._lastPoint;if(y){if(s.preventDefault(),this._eventButton!=null&&function(S,A){const M=Qa[A];return S.buttons===void 0||(S.buttons&M)!==M}(s,this._eventButton))this.reset();else if(this._moved||!(u.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(y,u)}}mouseupWindow(s){this._lastPoint&&tt(s)===this._eventButton&&(this._moved&&me(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qp extends Mh{mousedown(s,u){super.mousedown(s,u),this._lastPoint&&(this._active=!0)}_correctButton(s,u){return u===0&&!s.ctrlKey}_move(s,u){return{around:u,panDelta:u.sub(s)}}}class Jp extends Mh{constructor(s){super(s),this._pitchRotateKey=s.pitchRotateKey?gc[s.pitchRotateKey]:void 0}_correctButton(s,u){return this._pitchRotateKey?u===0&&s[this._pitchRotateKey]:u===0&&s.ctrlKey||u===2}_move(s,u){const y=.8*(u.x-s.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(s){this._pitchRotateKey||s.preventDefault()}}class dd extends Mh{constructor(s){super(s),this._pitchRotateKey=s.pitchRotateKey?gc[s.pitchRotateKey]:void 0}_correctButton(s,u){return this._pitchRotateKey?u===0&&s[this._pitchRotateKey]:u===0&&s.ctrlKey||u===2}_move(s,u){const y=-.5*(u.y-s.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(s){this._pitchRotateKey||s.preventDefault()}}class yu{constructor(s,u){this._map=s,this._el=s.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),a.aV(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}touchstart(s,u,y){return this._calculateTransform(s,u,y)}touchmove(s,u,y){if(this._active&&!(y.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(y.length===1&&!a.ex())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return s.cancelable&&s.preventDefault(),this._calculateTransform(s,u,y)}}touchend(s,u,y){this._calculateTransform(s,u,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,u,y){y.length>0&&(this._active=!0);const S=Dl(y,u),A=new a.P(0,0),M=new a.P(0,0);let D=0;for(const U in S){const H=S[U],K=this._touches[U];K&&(A._add(H),M._add(H.sub(K)),D++,S[U]=H)}if(this._touches=S,D<this._minTouches||!M.mag())return;const z=M.div(D);return this._sum._add(z),this._sum.mag()<this._clickTolerance?void 0:{around:A.div(D),panDelta:z}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=W("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class hd{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(s){}_move(s,u,y){return{}}touchstart(s,u,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([u[0],u[1]]))}touchmove(s,u,y){const S=this._firstTwoTouches;if(!S)return;s.preventDefault();const[A,M]=S,D=Ph(y,u,A),z=Ph(y,u,M);if(!D||!z)return;const U=this._aroundCenter?null:D.add(z).div(2);return this._move([D,z],U,s)}touchend(s,u,y){if(!this._firstTwoTouches)return;const[S,A]=this._firstTwoTouches,M=Ph(y,u,S),D=Ph(y,u,A);M&&D||(this._active&&me(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ph(x,s,u){for(let y=0;y<x.length;y++)if(x[y].identifier===u)return s[y]}function Of(x,s){return Math.log(x/s)/Math.LN2}class yg extends hd{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,u){const y=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(Of(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Of(this._distance,y),pinchAround:u}}}function Nh(x,s){return 180*x.angleWith(s)/Math.PI}class Zx extends hd{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,u){const y=this._vector;if(this._vector=s[0].sub(s[1]),y&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Nh(this._vector,y),pinchAround:u}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const u=25/(Math.PI*this._minDiameter)*360,y=this._startVector;if(!y)return!1;const S=Nh(s,y);return Math.abs(S)<u}}function If(x){return Math.abs(x.y)>Math.abs(x.x)}class Xx extends hd{constructor(s){super(),this._map=s}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(s){this._lastPoints=s,If(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,u,y){const S=this._lastPoints;if(!S)return;const A=s[0].sub(S[0]),M=s[1].sub(S[1]);return this._map._cooperativeGestures&&!a.ex()&&y.touches.length<3||(this._valid=this.gestureBeginsVertically(A,M,y.timeStamp),!this._valid)?void 0:(this._lastPoints=s,this._active=!0,{pitchDelta:(A.y+M.y)/2*-.5})}gestureBeginsVertically(s,u,y){if(this._valid!==void 0)return this._valid;const S=s.mag()>=2,A=u.mag()>=2;if(!S&&!A)return;if(!S||!A)return this._firstMove==null&&(this._firstMove=y),y-this._firstMove<100&&void 0;const M=s.y>0==u.y>0;return If(s)&&If(u)&&M}}const Kx={panStep:100,bearingStep:15,pitchStep:10};class $y{constructor(){const s=Kx;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let u=0,y=0,S=0,A=0,M=0;switch(s.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:s.shiftKey?y=-1:(s.preventDefault(),A=-1);break;case 39:s.shiftKey?y=1:(s.preventDefault(),A=1);break;case 38:s.shiftKey?S=1:(s.preventDefault(),M=-1);break;case 40:s.shiftKey?S=-1:(s.preventDefault(),M=1);break;default:return}return this._rotationDisabled&&(y=0,S=0),{cameraAnimation:D=>{const z=D.getZoom();D.easeTo({duration:300,easeId:"keyboardHandler",easing:Yx,zoom:u?Math.round(z)+u*(s.shiftKey?2:1):z,bearing:D.getBearing()+y*this._bearingStep,pitch:D.getPitch()+S*this._pitchStep,offset:[-A*this._panStep,-M*this._panStep],center:D.getCenter()},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Yx(x){return x*(2-x)}const is=4.000244140625,Ss=1/450;class Qx{constructor(s,u){this._map=s,this._el=s.getCanvasContainer(),this._handler=u,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Ss,a.aV(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(s){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(s.ctrlKey||s.metaKey||this.isZooming()||a.ex()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const y=a.q.now(),S=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,u!==0&&u%is==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=u,this._timeout=window.setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(S*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),s.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=s,this._delta-=u,this._active||this._start(s)),s.preventDefault()}_onTimeout(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=ke(this._el,s);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._map.transform;this._type==="wheel"&&s.projection.wrap&&(s._center.lng>=180||s._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const u=()=>s._terrainEnabled()&&this._aroundCoord?s.computeZoomRelativeTo(this._aroundCoord):s.zoom;if(this._delta!==0){const U=this._type==="wheel"&&Math.abs(this._delta)>is?this._wheelZoomRate:this._defaultZoomRate;let H=2/(1+Math.exp(-Math.abs(this._delta*U)));this._delta<0&&H!==0&&(H=1/H);const K=u(),X=Math.pow(2,K),J=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):X;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(J*H))),this._type==="wheel"&&(this._startZoom=K,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const y=typeof this._targetZoom=="number"?this._targetZoom:u(),S=this._startZoom,A=this._easing;let M,D=!1;if(this._type==="wheel"&&S&&A){const U=Math.min((a.q.now()-this._lastWheelEventTime)/200,1),H=A(U);M=a.ai(S,y,H),U<1?this._frameId||(this._frameId=!0):D=!0}else M=y,D=!0;this._active=!0,D&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let z=M-u();return z*this._lastDelta<0&&(z=0),{noInertia:!0,needsRenderFrame:!D,zoomDelta:z,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let u=a.ey;if(this._prevEase){const y=this._prevEase,S=(a.q.now()-y.start)/y.duration,A=y.easing(S+.01)-y.easing(S),M=.27/Math.sqrt(A*A+1e-4)*.01,D=Math.sqrt(.0729-M*M);u=a.ew(M,D,.25,1)}return this._prevEase={start:a.q.now(),duration:s,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=W("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class Jx{constructor(s,u){this._clickZoom=s,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class e0{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(s,u){return s.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(s.shiftKey?-1:1),around:y.unproject(u)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class t0{constructor(){this._tap=new la({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(s,u,y){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=u[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(s,u,y))}touchmove(s,u,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const S=u[0],A=S.y-this._swipePoint.y;return this._swipePoint=S,s.preventDefault(),this._active=!0,{zoomDelta:A/128}}}else this._tap.touchmove(s,u,y)}touchend(s,u,y){this._tapTime?this._swipePoint&&y.length===0&&this.reset():this._tap.touchend(s,u,y)&&(this._tapTime=s.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class n0{constructor(s,u,y){this._el=s,this._mousePan=u,this._touchPan=y}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class vg{constructor(s,u,y){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=u,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class r0{constructor(s,u,y,S){this._el=s,this._touchZoom=u,this._touchRotate=y,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Wi=x=>x.zoom||x.drag||x.pitch||x.rotate;class i0 extends a.A{}class qy{constructor(){this.constants=[1,1,.01],this.radius=0}setup(s,u){const y=a.at([],u,s);this.radius=a.ae(y[2]<0?a.eA([],y,this.constants):[y[0],y[1],0])}projectRay(s){a.eA(s,s,this.constants),a.au(s,s),a.eB(s,s,this.constants);const u=a.b$([],s,this.radius);if(u[2]>0){const y=a.b$([],[0,0,1],a.bE(u,[0,0,1])),S=a.b$([],a.au([],[u[0],u[1],0]),this.radius),A=a.cU([],u,a.b$([],a.at([],a.cU([],S,y),u),2));u[0]=A[0],u[1]=A[1]}return u}}function fd(x){return x.panDelta&&x.panDelta.mag()||x.zoomDelta||x.bearingDelta||x.pitchDelta}class a0{constructor(s,u){this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new jh(s),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new qy,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),a.aV(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[window,"blur",void 0]];for(const[S,A,M]of this._listeners){const D=S===document?this.handleWindowEvent:this.handleEvent;S.addEventListener(A,D,M)}}destroy(){for(const[s,u,y]of this._listeners){const S=s===document?this.handleWindowEvent:this.handleEvent;s.removeEventListener(u,S,y)}}_addDefaultHandlers(s){const u=this._map,y=u.getCanvasContainer();this._add("mapEvent",new xu(u,s));const S=u.boxZoom=new ol(u,s);this._add("boxZoom",S);const A=new mc,M=new e0;u.doubleClickZoom=new Jx(M,A),this._add("tapZoom",A),this._add("clickZoom",M);const D=new t0;this._add("tapDragZoom",D);const z=u.touchPitch=new Xx(u);this._add("touchPitch",z);const U=new Jp(s),H=new dd(s);u.dragRotate=new vg(s,U,H),this._add("mouseRotate",U,["mousePitch"]),this._add("mousePitch",H,["mouseRotate"]);const K=new Qp(s),X=new yu(u,s);u.dragPan=new n0(y,K,X),this._add("mousePan",K),this._add("touchPan",X,["touchZoom","touchRotate"]);const J=new Zx,de=new yg;u.touchZoomRotate=new r0(y,de,J,D),this._add("touchRotate",J,["touchPan","touchZoom"]),this._add("touchZoom",de,["touchPan","touchRotate"]),this._add("blockableMapEvent",new qo(u));const ce=u.scrollZoom=new Qx(u,this);this._add("scrollZoom",ce,["mousePan"]);const fe=u.keyboard=new $y;this._add("keyboard",fe);for(const ue of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])s.interactive&&s[ue]&&u[ue].enable(s[ue])}_add(s,u,y){this._handlers.push({handlerName:s,handler:u,allowed:y}),this._handlersById[s]=u}stop(s){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Wi(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(s,u,y){for(const S in s)if(S!==y&&(!u||u.indexOf(S)<0))return!0;return!1}handleWindowEvent(s){this.handleEvent(s,`${s.type}Window`)}_getMapTouches(s){const u=[];for(const y of s)this._el.contains(y.target)&&u.push(y);return u}handleEvent(s,u){this._updatingCamera=!0;const y=s.type==="renderFrame",S=y?void 0:s,A={needsRenderFrame:!1},M={},D={},z=s.touches?this._getMapTouches(s.touches):void 0,U=z?qe(this._el,z):y?void 0:ke(this._el,s);for(const{handlerName:X,handler:J,allowed:de}of this._handlers){if(!J.isEnabled())continue;let ce;this._blockedByActive(D,de,X)?J.reset():J[u||s.type]&&(ce=J[u||s.type](s,U,z),this.mergeHandlerResult(A,M,ce,X,S),ce&&ce.needsRenderFrame&&this._triggerRenderFrame()),(ce||J.isActive())&&(D[X]=J)}const H={};for(const X in this._previousActiveHandlers)D[X]||(H[X]=S);this._previousActiveHandlers=D,(Object.keys(H).length||fd(A))&&(this._changes.push([A,M,H]),this._triggerRenderFrame()),(Object.keys(D).length||fd(A))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:K}=A;K&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],K(this._map))}mergeHandlerResult(s,u,y,S,A){if(!y)return;a.l(s,y);const M={handlerName:S,originalEvent:y.originalEvent||A};y.zoomDelta!==void 0&&(u.zoom=M),y.panDelta!==void 0&&(u.drag=M),y.pitchDelta!==void 0&&(u.pitch=M),y.bearingDelta!==void 0&&(u.rotate=M)}_applyChanges(){const s={},u={},y={};for(const[S,A,M]of this._changes)S.panDelta&&(s.panDelta=(s.panDelta||new a.P(0,0))._add(S.panDelta)),S.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(s.around=S.around),S.aroundCoord!==void 0&&(s.aroundCoord=S.aroundCoord),S.pinchAround!==void 0&&(s.pinchAround=S.pinchAround),S.noInertia&&(s.noInertia=S.noInertia),a.l(u,A),a.l(y,M);this._updateMapTransform(s,u,y),this._changes=[]}_updateMapTransform(s,u,y){const S=this._map,A=S.transform,M=ve=>[ve.x,ve.y,ve.z];if((ve=>{const Ee=this._eventsInProgress.drag;return Ee&&!this._handlersById[Ee.handlerName].isActive()})()&&!fd(s)){const ve=A.zoom;A.cameraElevationReference="sea",this._originalZoom!=null&&A._orthographicProjectionAtLowPitch&&A.projection.name!=="globe"&&A.pitch===0?(A.cameraElevationReference="ground",A.zoom=this._originalZoom):(A.recenterOnTerrain(),A.cameraElevationReference="ground"),ve!==A.zoom&&this._map._update(!0)}if(A._isCameraConstrained&&S._stop(!0),!fd(s))return void this._fireEvents(u,y,!0);let{panDelta:D,zoomDelta:z,bearingDelta:U,pitchDelta:H,around:K,aroundCoord:X,pinchAround:J}=s;A._isCameraConstrained&&(z>0&&(z=0),A._isCameraConstrained=!1),J!==void 0&&(K=J),(z||(ve=>u[ve]&&!this._eventsInProgress[ve])("drag"))&&K&&(this._dragOrigin=M(A.pointCoordinate3D(K)),this._originalZoom=A.zoom,this._trackingEllipsoid.setup(A._camera.position,this._dragOrigin)),A.cameraElevationReference="sea",S._stop(!0),K=K||S.transform.centerPoint,U&&(A.bearing+=U),H&&(A.pitch+=H),A._updateCameraState();const de=[0,0,0];if(D)if(A.projection.name==="mercator"){const ve=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(K).dir),Ee=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(K.sub(D)).dir);de[0]=Ee[0]-ve[0],de[1]=Ee[1]-ve[1]}else{const ve=A.pointCoordinate(K);if(A.projection.name==="globe"){D=D.rotate(-A.angle);const Ee=A._pixelsPerMercatorPixel/A.worldSize;de[0]=-D.x*a.ez(a.aY(ve.y))*Ee,de[1]=-D.y*a.ez(A.center.lat)*Ee}else{const Ee=A.pointCoordinate(K.sub(D));ve&&Ee&&(de[0]=Ee.x-ve.x,de[1]=Ee.y-ve.y)}}const ce=A.zoom,fe=[0,0,0];if(z){const ve=M(X||A.pointCoordinate3D(K)),Ee={dir:a.au([],a.at([],ve,A._camera.position))};if(Ee.dir[2]<0){const Pe=A.zoomDeltaToMovement(ve,z);a.b$(fe,Ee.dir,Pe)}}const ue=a.cU(de,de,fe);A._translateCameraConstrained(ue),z&&Math.abs(A.zoom-ce)>1e-4&&A.recenterOnTerrain(),A.cameraElevationReference="ground",this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(u,y,!0)}_fireEvents(s,u,y){const S=Wi(this._eventsInProgress),A=Wi(s),M={};for(const H in s){const{originalEvent:K}=s[H];this._eventsInProgress[H]||(M[`${H}start`]=K),this._eventsInProgress[H]=s[H]}!S&&A&&this._fireEvent("movestart",A.originalEvent);for(const H in M)this._fireEvent(H,M[H]);A&&this._fireEvent("move",A.originalEvent);for(const H in s){const{originalEvent:K}=s[H];this._fireEvent(H,K)}const D={};let z;for(const H in this._eventsInProgress){const{handlerName:K,originalEvent:X}=this._eventsInProgress[H];this._handlersById[K].isActive()||(delete this._eventsInProgress[H],z=u[K]||X,D[`${H}end`]=z)}for(const H in D)this._fireEvent(H,D[H]);const U=Wi(this._eventsInProgress);if(y&&(S||A)&&!U){this._updatingCamera=!0;const H=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),K=X=>X!==0&&-this._bearingSnap<X&&X<this._bearingSnap;H?(K(H.bearing||this._map.getBearing())&&(H.bearing=0),this._map.easeTo(H,{originalEvent:z})):(this._map.fire(new a.A("moveend",{originalEvent:z})),K(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(s,u){this._map.fire(new a.A(s,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{this._frameId=void 0,this.handleEvent(new i0("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const pd="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class s0 extends a.E{constructor(s,u){super(),this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=u.bearingSnap,this._respectPrefersReducedMotion=u.respectPrefersReducedMotion!==!1,a.aV(["_renderFrameCallback"],this)}getCenter(){return new a.cd(this.transform.center.lng,this.transform.center.lat)}setCenter(s,u){return this.jumpTo({center:s},u)}panBy(s,u,y){return s=a.P.convert(s).mult(-1),this.panTo(this.transform.center,a.l({offset:s},u),y)}panTo(s,u,y){return this.easeTo(a.l({center:s},u),y)}getZoom(){return this.transform.zoom}setZoom(s,u){return this.jumpTo({zoom:s},u),this}zoomTo(s,u,y){return this.easeTo(a.l({zoom:s},u),y)}zoomIn(s,u){return this.zoomTo(this.getZoom()+1,s,u),this}zoomOut(s,u){return this.zoomTo(this.getZoom()-1,s,u),this}getBearing(){return this.transform.bearing}setBearing(s,u){return this.jumpTo({bearing:s},u),this}getPadding(){return this.transform.padding}setPadding(s,u){return this.jumpTo({padding:s},u),this}rotateTo(s,u,y){return this.easeTo(a.l({bearing:s},u),y)}resetNorth(s,u){return this.rotateTo(0,a.l({duration:1e3},s),u),this}resetNorthPitch(s,u){return this.easeTo(a.l({bearing:0,pitch:0,duration:1e3},s),u),this}snapToNorth(s,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,u):this}getPitch(){return this.transform.pitch}setPitch(s,u){return this.jumpTo({pitch:s},u),this}cameraForBounds(s,u){s=a.aG.convert(s);const y=u&&u.bearing||0,S=u&&u.pitch||0,A=s.getNorthWest(),M=s.getSouthEast();return this._cameraForBounds(this.transform,A,M,y,S,u)}_extendPadding(s){const u={top:0,right:0,bottom:0,left:0};return s==null?a.l({},u,this.transform.padding):typeof s=="number"?{top:s,bottom:s,right:s,left:s}:a.l({},u,s)}_extendCameraOptions(s){return(s=a.l({offset:[0,0],maxZoom:this.transform.maxZoom},s)).padding=this._extendPadding(s.padding),s}_minimumAABBFrustumDistance(s,u){const y=u.max[0]-u.min[0],S=u.max[1]-u.min[1];return y/S>s.aspect?y/(2*Math.tan(.5*s.fovX)*s.aspect):S/(2*Math.tan(.5*s.fovY)*s.aspect)}_cameraForBoundsOnGlobe(s,u,y,S,A,M){const D=s.clone(),z=this._extendCameraOptions(M);D.bearing=S,D.pitch=A;const U=a.cd.convert(u),H=a.cd.convert(y),K=.5*(U.lat+H.lat),X=.5*(U.lng+H.lng),J=a.eC(K,X),de=a.au([],J),ce=a.au([],a.bG([],de,[0,1,0])),fe=a.bG([],ce,de),ue=[ce[0],ce[1],ce[2],0,fe[0],fe[1],fe[2],0,de[0],de[1],de[2],0,0,0,0,1],ve=[J,a.eC(U.lat,U.lng),a.eC(H.lat,U.lng),a.eC(H.lat,H.lng),a.eC(U.lat,H.lng),a.eC(K,U.lng),a.eC(K,H.lng),a.eC(U.lat,X),a.eC(H.lat,X)];let Ee=a.cV.fromPoints(ve.map(ct=>[a.bE(ce,ct),a.bE(fe,ct),a.bE(de,ct)]));const Pe=a.ad([],Ee.center,ue);a.eD(Pe)===0&&a.eE(Pe,0,0,1),a.au(Pe,Pe),a.b$(Pe,Pe,a.aE),D.center=a.eF(Pe);const ze=D.getWorldToCameraMatrix(),Ie=a.bi(new Float64Array(16),ze);Ee=a.cV.applyTransform(Ee,a.az([],ze,ue));const Oe=this._extendAABB(Ee,D,z,S);if(!Oe)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ee=Oe,a.ad(Pe,Pe,ze);const Ce=.5*(Ee.max[2]-Ee.min[2]),Fe=this._minimumAABBFrustumDistance(D,Ee),$e=a.b$([],[0,0,1],Ce),st=a.cU($e,Pe,$e),et=Fe+(D.pitch===0?0:a.bD(Pe,st)),_t=D.globeCenterInViewSpace,xt=a.at([],Pe,[_t[0],_t[1],_t[2]]);a.au(xt,xt),a.b$(xt,xt,et);const Bt=a.cU([],Pe,xt);a.ad(Bt,Bt,Ie);const Je=a.eq/a.aE,lt=a.ae(Bt),Ke=a.c6(Math.max(lt*Je-a.eq,Number.EPSILON),0),Et=Math.min(D.zoomFromMercatorZAdjusted(Ke),z.maxZoom);return Et>.5*(a.cL+a.cx)?(D.setProjection({name:"mercator"}),D.zoom=Et,this._cameraForBounds(D,u,y,S,A,M)):{center:D.center,zoom:Et,bearing:S,pitch:A}}_extendAABB(s,u,y,S){const A=.5*((y.padding.left||0)+(y.padding.right||0)),M=.5*((y.padding.top||0)+(y.padding.bottom||0)),D=M,z=A,U=A,H=M,K=u.width-(z+U),X=u.height-(D+H),J=a.at([],s.max,s.min),de=Math.min(K/J[0],X/J[1]),ce=Math.min(u.scaleZoom(u.scale*de),y.maxZoom);if(isNaN(ce))return null;const fe=u.scale/u.zoomScale(ce),ue=new a.cV([s.min[0]-z*fe,s.min[1]-H*fe,s.min[2]],[s.max[0]+U*fe,s.max[1]+D*fe,s.max[2]]),ve=(typeof y.offset.x=="number"&&typeof y.offset.y=="number"?new a.P(y.offset.x,y.offset.y):a.P.convert(y.offset)).rotate(-a.al(S));return ue.center[0]-=ve.x*fe,ue.center[1]+=ve.y*fe,ue}queryTerrainElevation(s,u){const y=this.transform.elevation;return y?(u=a.l({},{exaggerated:!0},u),y.getAtPoint(a.ac.fromLngLat(s),null,u.exaggerated)):null}_cameraForBounds(s,u,y,S,A,M){if(s.projection.name==="globe")return this._cameraForBoundsOnGlobe(s,u,y,S,A,M);const D=s.clone(),z=this._extendCameraOptions(M);D.bearing=S,D.pitch=A;const U=a.cd.convert(u),H=a.cd.convert(y),K=new a.cd(U.lng,H.lat),X=new a.cd(H.lng,U.lat),J=D.project(U),de=D.project(H),ce=this.queryTerrainElevation(U),fe=this.queryTerrainElevation(H),ue=this.queryTerrainElevation(K),ve=this.queryTerrainElevation(X),Ee=[[J.x,J.y,Math.min(ce||0,fe||0,ue||0,ve||0)],[de.x,de.y,Math.max(ce||0,fe||0,ue||0,ve||0)]];let Pe=a.cV.fromPoints(Ee);const ze=D.getWorldToCameraMatrix(),Ie=a.bi(new Float64Array(16),ze);Pe=a.cV.applyTransform(Pe,ze);const Oe=this._extendAABB(Pe,D,z,S);if(!Oe)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Pe=Oe;const Ce=.5*a.at([],Pe.max,Pe.min)[2],Fe=this._minimumAABBFrustumDistance(D,Pe),$e=[0,0,1,0];a.aA($e,$e,ze),a.eG($e,$e);const st=a.b$([],$e,Fe+Ce),et=a.cU([],Pe.center,st);a.ad(Pe.center,Pe.center,Ie),a.ad(et,et,Ie);const _t=D.unproject(new a.P(Pe.center[0],Pe.center[1])),xt=a.eH(D.projection,_t),Bt=Math.pow(2,xt),Je=Math.min(D._zoomFromMercatorZ(et[2]*D.pixelsPerMeter*Bt/D.worldSize),z.maxZoom);return D.mercatorFromTransition&&Je<.5*(a.cL+a.cx)?(D.setProjection({name:"globe"}),D.zoom=Je,this._cameraForBounds(D,u,y,S,A,M)):{center:_t,zoom:Je,bearing:S,pitch:A}}fitBounds(s,u,y){const S=this.cameraForBounds(s,u);return this._fitInternal(S,u,y)}fitScreenCoordinates(s,u,y,S,A){const M=a.P.convert(s),D=a.P.convert(u),z=new a.P(Math.min(M.x,D.x),Math.min(M.y,D.y)),U=new a.P(Math.max(M.x,D.x),Math.max(M.y,D.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(M,D))return this;const H=this.transform.pointLocation3D(z),K=this.transform.pointLocation3D(U),X=this.transform.pointLocation3D(new a.P(z.x,U.y)),J=this.transform.pointLocation3D(new a.P(U.x,z.y)),de=[Math.min(H.lng,K.lng,X.lng,J.lng),Math.min(H.lat,K.lat,X.lat,J.lat)],ce=[Math.max(H.lng,K.lng,X.lng,J.lng),Math.max(H.lat,K.lat,X.lat,J.lat)],fe=S&&S.pitch?S.pitch:this.getPitch(),ue=this._cameraForBounds(this.transform,de,ce,y,fe,S);return this._fitInternal(ue,S,A)}_fitInternal(s,u,y){return s?(u=a.l(s,u)).linear?this.easeTo(u,y):this.flyTo(u,y):this}jumpTo(s,u){this.stop();const y=s.preloadOnly?this.transform.clone():this.transform;let S=!1,A=!1,M=!1;"zoom"in s&&y.zoom!==+s.zoom&&(S=!0,y.zoom=+s.zoom),s.center!==void 0&&(y.center=a.cd.convert(s.center)),"bearing"in s&&y.bearing!==+s.bearing&&(A=!0,y.bearing=+s.bearing),"pitch"in s&&y.pitch!==+s.pitch&&(M=!0,y.pitch=+s.pitch);const D=typeof s.padding=="number"?this._extendPadding(s.padding):s.padding;if(s.padding!=null&&!y.isPaddingEqual(D))if(s.retainPadding===!1){const z=y.clone();z.padding=D,y.setLocationAtPoint(y.center,z.centerPoint)}else y.padding=D;return s.preloadOnly?(this._preloadTiles(y),this):(this.fire(new a.A("movestart",u)).fire(new a.A("move",u)),S&&this.fire(new a.A("zoomstart",u)).fire(new a.A("zoom",u)).fire(new a.A("zoomend",u)),A&&this.fire(new a.A("rotatestart",u)).fire(new a.A("rotate",u)).fire(new a.A("rotateend",u)),M&&this.fire(new a.A("pitchstart",u)).fire(new a.A("pitch",u)).fire(new a.A("pitchend",u)),this.fire(new a.A("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.w(pd),this.transform.getFreeCameraOptions()}setFreeCameraOptions(s,u){const y=this.transform;if(!y.projection.supportsFreeCamera)return a.w(pd),this;this.stop();const S=y.zoom,A=y.pitch,M=y.bearing;y.setFreeCameraOptions(s);const D=S!==y.zoom,z=A!==y.pitch,U=M!==y.bearing;return this.fire(new a.A("movestart",u)).fire(new a.A("move",u)),D&&this.fire(new a.A("zoomstart",u)).fire(new a.A("zoom",u)).fire(new a.A("zoomend",u)),U&&this.fire(new a.A("rotatestart",u)).fire(new a.A("rotate",u)).fire(new a.A("rotateend",u)),z&&this.fire(new a.A("pitchstart",u)).fire(new a.A("pitch",u)).fire(new a.A("pitchend",u)),this.fire(new a.A("moveend",u)),this}easeTo(s,u){this._stop(!1,s.easeId),((s=a.l({offset:[0,0],duration:500,easing:a.ey},s)).animate===!1||this._prefersReducedMotion(s))&&(s.duration=0);const y=this.transform,S=this.getZoom(),A=this.getBearing(),M=this.getPitch(),D=this.getPadding(),z="zoom"in s?+s.zoom:S,U="bearing"in s?this._normalizeBearing(s.bearing,A):A,H="pitch"in s?+s.pitch:M,K=this._extendPadding(s.padding),X=a.P.convert(s.offset);let J,de,ce;if(y.projection.name==="globe"){const $e=a.ac.fromLngLat(y.center),st=X.rotate(-y.angle);$e.x+=st.x/y.worldSize,$e.y+=st.y/y.worldSize;const et=$e.toLngLat(),_t=a.cd.convert(s.center||et);this._normalizeCenter(_t),J=y.centerPoint.add(st),de=new a.P($e.x,$e.y).mult(y.worldSize),ce=new a.P(a.ay(_t.lng),a.aH(_t.lat)).mult(y.worldSize).sub(de)}else{J=y.centerPoint.add(X);const $e=y.pointLocation(J),st=a.cd.convert(s.center||$e);this._normalizeCenter(st),de=y.project($e),ce=y.project(st).sub(de)}const fe=y.zoomScale(z-S);let ue,ve;s.around&&(ue=a.cd.convert(s.around),ve=y.locationPoint(ue));const Ee=this._zooming||z!==S,Pe=this._rotating||A!==U,ze=this._pitching||H!==M,Ie=!y.isPaddingEqual(K),Oe=s.retainPadding===!1?y.clone():y,Ce=$e=>st=>{if(Ee&&($e.zoom=a.ai(S,z,st)),Pe&&($e.bearing=a.ai(A,U,st)),ze&&($e.pitch=a.ai(M,H,st)),Ie&&(Oe.interpolatePadding(D,K,st),J=Oe.centerPoint.add(X)),ue)$e.setLocationAtPoint(ue,ve);else{const et=$e.zoomScale($e.zoom-S),_t=z>S?Math.min(2,fe):Math.max(.5,fe),xt=Math.pow(_t,1-st),Bt=$e.unproject(de.add(ce.mult(st*xt)).mult(et));$e.setLocationAtPoint($e.renderWorldCopies?Bt.wrap():Bt,J)}return s.preloadOnly||this._fireMoveEvents(u),$e};if(s.preloadOnly){const $e=this._emulate(Ce,s.duration,y);return this._preloadTiles($e),this}const Fe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ee,this._rotating=Pe,this._pitching=ze,this._padding=Ie,this._easeId=s.easeId,this._prepareEase(u,s.noMoveStart,Fe),this._ease(Ce(y),$e=>{y.cameraElevationReference==="sea"&&y.recenterOnTerrain(),this._afterEase(u,$e)},s),this}_prepareEase(s,u,y={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),u||y.moving||this.fire(new a.A("movestart",s)),this._zooming&&!y.zooming&&this.fire(new a.A("zoomstart",s)),this._rotating&&!y.rotating&&this.fire(new a.A("rotatestart",s)),this._pitching&&!y.pitching&&this.fire(new a.A("pitchstart",s))}_fireMoveEvents(s){this.fire(new a.A("move",s)),this._zooming&&this.fire(new a.A("zoom",s)),this._rotating&&this.fire(new a.A("rotate",s)),this._pitching&&this.fire(new a.A("pitch",s))}_afterEase(s,u){if(this._easeId&&u&&this._easeId===u)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const y=this._zooming,S=this._rotating,A=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new a.A("zoomend",s)),S&&this.fire(new a.A("rotateend",s)),A&&this.fire(new a.A("pitchend",s)),this.fire(new a.A("moveend",s))}flyTo(s,u){if(this._prefersReducedMotion(s)){const ct=a.aF(s,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(ct,u)}this.stop(),s=a.l({offset:[0,0],speed:1.2,curve:1.42,easing:a.ey},s);const y=this.transform,S=this.getZoom(),A=this.getBearing(),M=this.getPitch(),D=this.getPadding(),z="zoom"in s?a.aD(+s.zoom,y.minZoom,y.maxZoom):S,U="bearing"in s?this._normalizeBearing(s.bearing,A):A,H="pitch"in s?+s.pitch:M,K=this._extendPadding(s.padding),X=y.zoomScale(z-S),J=a.P.convert(s.offset);let de=y.centerPoint.add(J);const ce=y.pointLocation(de),fe=a.cd.convert(s.center||ce);this._normalizeCenter(fe);const ue=y.project(ce),ve=y.project(fe).sub(ue);let Ee=s.curve;const Pe=Math.max(y.width,y.height),ze=Pe/X,Ie=ve.mag();if("minZoom"in s){const ct=a.aD(Math.min(s.minZoom,S,z),y.minZoom,y.maxZoom),Dt=Pe/y.zoomScale(ct-S);Ee=Math.sqrt(Dt/Ie*2)}const Oe=Ee*Ee;function Ce(ct){const Dt=(ze*ze-Pe*Pe+(ct?-1:1)*Oe*Oe*Ie*Ie)/(2*(ct?ze:Pe)*Oe*Ie);return Math.log(Math.sqrt(Dt*Dt+1)-Dt)}function Fe(ct){return(Math.exp(ct)-Math.exp(-ct))/2}function $e(ct){return(Math.exp(ct)+Math.exp(-ct))/2}const st=Ce(0);let et=function(ct){return $e(st)/$e(st+Ee*ct)},_t=function(ct){return Pe*(($e(st)*(Fe(Dt=st+Ee*ct)/$e(Dt))-Fe(st))/Oe)/Ie;var Dt},xt=(Ce(1)-st)/Ee;if(Math.abs(Ie)<1e-6||!isFinite(xt)){if(Math.abs(Pe-ze)<1e-6)return this.easeTo(s,u);const ct=ze<Pe?-1:1;xt=Math.abs(Math.log(ze/Pe))/Ee,_t=function(){return 0},et=function(Dt){return Math.exp(ct*Ee*Dt)}}s.duration="duration"in s?+s.duration:1e3*xt/("screenSpeed"in s?+s.screenSpeed/Ee:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0);const Bt=A!==U,Je=H!==M,lt=!y.isPaddingEqual(K),Ke=s.retainPadding===!1?y.clone():y,Et=ct=>Dt=>{const wt=Dt*xt,Ot=1/et(wt);ct.zoom=Dt===1?z:S+ct.scaleZoom(Ot),Bt&&(ct.bearing=a.ai(A,U,Dt)),Je&&(ct.pitch=a.ai(M,H,Dt)),lt&&(Ke.interpolatePadding(D,K,Dt),de=Ke.centerPoint.add(J));const zt=Dt===1?fe:ct.unproject(ue.add(ve.mult(_t(wt))).mult(Ot));return ct.setLocationAtPoint(ct.renderWorldCopies?zt.wrap():zt,de),ct._updateCameraOnTerrain(),s.preloadOnly||this._fireMoveEvents(u),ct};if(s.preloadOnly){const ct=this._emulate(Et,s.duration,y);return this._preloadTiles(ct),this}return this._zooming=!0,this._rotating=Bt,this._pitching=Je,this._padding=lt,this._prepareEase(u,!1),this._ease(Et(y),()=>this._afterEase(u),s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(s){}_cancelRenderFrame(s){}_stop(s,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const y=this._onEaseEnd;this._onEaseEnd=void 0,y.call(this,u)}if(!s){const y=this.handlers;y&&y.stop(!1)}return this}_ease(s,u,y){y.animate===!1||y.duration===0?(s(1),u()):(this._easeStart=a.q.now(),this._easeOptions=y,this._onEaseFrame=s,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const s=Math.min((a.q.now()-this._easeStart)/this._easeOptions.duration,1),u=this._onEaseFrame;u&&u(this._easeOptions.easing(s)),s<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(s,u){s=a.bX(s,-180,180);const y=Math.abs(s-u);return Math.abs(s-360-u)<y&&(s-=360),Math.abs(s+360-u)<y&&(s+=360),s}_normalizeCenter(s){const u=this.transform;if(u.maxBounds||u.projection.name!=="globe"&&!u.renderWorldCopies)return;const y=s.lng-u.center.lng;s.lng+=y>180?-360:y<-180?360:0}_prefersReducedMotion(s){return this._respectPrefersReducedMotion&&a.q.prefersReducedMotion&&!(s&&s.essential)}_emulate(s,u,y){const S=Math.ceil(15*u/1e3),A=[],M=s(y.clone());for(let D=0;D<=S;D++){const z=M(D/S);A.push(z.clone())}return A}_preloadTiles(s,u){}}class kf{constructor(s={}){this.options=s,a.aV(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(s){const u=this.options&&this.options.compact,y=s._getUIString("AttributionControl.ToggleAttribution");this._map=s,this._container=W("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=W("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",y);const S=W("span","mapboxgl-ctrl-icon",this._compactButton);return S.setAttribute("aria-hidden","true"),S.setAttribute("title",y),this._innerContainer=W("div","mapboxgl-ctrl-attrib-inner",this._container),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),u===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.e.ACCESS_TOKEN}];if(s){const y=u.reduce((S,A,M)=>(A.value&&(S+=`${A.key}=${A.value}${M<u.length-1?"&":""}`),S),"?");s.href=`${a.e.FEEDBACK_URL}/${y}#${Ah(this._map,!0)}`,s.rel="noopener nofollow"}}_updateData(s){!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let s=[];if(this._map.style.stylesheet){const S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}const u=this._map.style._mergedSourceCaches;for(const S in u){const A=u[S];if(A.used){const M=A.getSource();M.attribution&&s.indexOf(M.attribution)<0&&s.push(M.attribution)}}s.sort((S,A)=>S.length-A.length),s=s.filter((S,A)=>{for(let M=A+1;M<s.length;M++)if(s[M].indexOf(S)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=[...this.options.customAttribution,...s]:s.unshift(this.options.customAttribution));const y=s.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,s.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class md{constructor(){a.aV(["_updateLogo","_updateCompact"],this)}onAdd(s){this._map=s,this._container=W("div","mapboxgl-ctrl");const u=W("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const s=this._map.style._sourceCaches;if(Object.entries(s).length===0)return!0;for(const u in s){const y=s[u].getSource();if(y.hasOwnProperty("mapbox_logo")&&!y.mapbox_logo)return!1}return!0}_updateCompact(){const s=this._container.children;if(s.length){const u=s[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class Ol{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const u=++this._id;return this._queue.push({callback:s,id:u,cancelled:!1}),u}remove(s){const u=this._currentlyRunning,y=u?this._queue.concat(u):this._queue;for(const S of y)if(S.id===s)return void(S.cancelled=!0)}run(s=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const y of u)if(!y.cancelled&&(y.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class em{constructor(s){this.jumpTo(s)}getValue(s){if(s<=this._startTime)return this._start;if(s>=this._endTime)return this._end;const u=a.dk((s-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(s){return s>=this._startTime&&s<=this._endTime}jumpTo(s){this._startTime=-1/0,this._endTime=-1/0,this._start=s,this._end=s}easeTo(s,u,y){this._start=this.getValue(u),this._end=s,this._startTime=u,this._endTime=u+y}}const ca={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class Il extends a.A{constructor(s,u,y,S){const{point:A,lngLat:M,originalEvent:D,target:z}=s;super(s.type,{point:A,lngLat:M,originalEvent:D,target:z}),this.preventDefault=()=>{s.preventDefault()},this.id=u,this.interaction=y,this.feature=S}}class ll{constructor(s){this.map=s,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(s,u){if(this.typeById.has(s))throw new Error(`Interaction id "${s}" already exists.`);const y=u.filter;let S=u.type;y&&this.filters.set(s,a.b3(y)),S==="mouseover"&&(S="mouseenter"),S==="mouseout"&&(S="mouseleave");const A=this.interactionsByType.get(S)||new Map;S==="mouseenter"||S==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(s,u)):A.size===0&&this.map.on(S,this.handleType),A.size===0&&this.interactionsByType.set(S,A),A.set(s,u),this.typeById.set(s,S)}get(s){const u=this.typeById.get(s);if(!u)return;const y=this.interactionsByType.get(u);return y?y.get(s):void 0}remove(s){const u=this.typeById.get(s);if(!u)return;this.typeById.delete(s),this.filters.delete(s);const y=this.interactionsByType.get(u);y&&(y.delete(s),u==="mouseenter"||u==="mouseleave"?(this.delegatedInteractions.delete(s),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):y.size===0&&this.map.off(u,this.handleType))}queryTargets(s,u){const y=[];for(const[S,A]of u)A.target&&y.push({targetId:S,target:A.target,filter:this.filters.get(S)});return this.map.style.queryRenderedTargets(s,y,this.map.transform)}handleMove(s){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const u=this.queryTargets(s.point,Array.from(this.delegatedInteractions).reverse());u.length&&(s.type="mouseenter",this.handleType(s,u));const y=new Map;for(const[S,{feature:A}]of this.prevHoveredFeatures)this.hoveredFeatures.has(S)||y.set(A.id,A);y.size&&(s.type="mouseleave",this.handleType(s,Array.from(y.values())))}handleOut(s){const u=Array.from(this.hoveredFeatures.values()).map(({feature:y})=>y);u.length&&(s.type="mouseleave",this.handleType(s,u)),this.hoveredFeatures.clear()}handleType(s,u){const y=Array.from(this.interactionsByType.get(s.type)).reverse(),S=!!u;u=u||this.queryTargets(s.point,y);const A=s.type==="mouseenter";let M=!1;const D=new Set;for(const z of u){for(const[U,H]of y){if(!H.target)continue;const K=z.variants?z.variants[U]:null;if(K){for(const X of K){if(af(X,z,D,U))continue;const J=new a.df(z,X),de=Gd(X,z,U);S&&(J.state=this.map.getFeatureState(J));const ce=A?this.prevHoveredFeatures.get(de):null,fe=new Il(s,U,H,J),ue=ce?ce.stop:H.handler(fe);if(A&&this.hoveredFeatures.set(de,{feature:z,stop:ue}),ue!==!1){M=!0;break}}if(M)break}}if(M)break}if(!M)for(const[z,U]of y){const{handler:H,target:K}=U;if(!K&&H(new Il(s,z,U,null))!==!1)break}}}function Rf(x,s){if(Array.isArray(x)&&Array.isArray(s)){const u=new Set(x),y=new Set(s);return u.size===y.size&&x.every(S=>y.has(S))}return a.bv(x,s)}const Hy={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},Gy={showCompass:!0,showZoom:!0,visualizePitch:!1};class cl{constructor(s,u,y=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new Jp({clickTolerance:s.dragRotate._mouseRotate._clickTolerance}),this.map=s,y&&(this.mousePitch=new dd({clickTolerance:s.dragRotate._mousePitch._clickTolerance})),a.aV(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(s,u){this.mouseRotate.mousedown(s,u),this.mousePitch&&this.mousePitch.mousedown(s,u),ge()}move(s,u){const y=this.map,S=this.mouseRotate.mousemoveWindow(s,u),A=S&&S.bearingDelta;if(A&&y.setBearing(y.getBearing()+A),this.mousePitch){const M=this.mousePitch.mousemoveWindow(s,u),D=M&&M.pitchDelta;D&&y.setPitch(y.getPitch()+D)}}off(){const s=this.element;s.removeEventListener("mousedown",this.mousedown),s.removeEventListener("touchstart",this.touchstart),s.removeEventListener("touchmove",this.touchmove),s.removeEventListener("touchend",this.touchend),s.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ae(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(s){this.down(a.l({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),ke(this.element,s)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(s){this.move(s,ke(this.element,s))}mouseup(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()}touchstart(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=qe(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>s.preventDefault()},this._startPos))}touchmove(s){s.targetTouches.length!==1?this.reset():(this._lastPos=qe(this.element,s.targetTouches)[0],this.move({preventDefault:()=>s.preventDefault()},this._lastPos))}touchend(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function o0(x,s,u){if(x=new a.cd(x.lng,x.lat),s){const y=new a.cd(x.lng-360,x.lat),S=new a.cd(x.lng+360,x.lat),A=360*Math.ceil(Math.abs(x.lng-u.center.lng)/360),M=u.locationPoint3D(x).distSqr(s),D=s.x<0||s.y<0||s.x>u.width||s.y>u.height;u.locationPoint3D(y).distSqr(s)<M&&(D||Math.abs(y.lng-u.center.lng)<A)?x=y:u.locationPoint3D(S).distSqr(s)<M&&(D||Math.abs(S.lng-u.center.lng)<A)&&(x=S)}for(;Math.abs(x.lng-u.center.lng)>180;){const y=u.locationPoint3D(x);if(y.x>=0&&y.y>=0&&y.x<=u.width&&y.y<=u.height)break;x.lng>u.center.lng?x.lng-=360:x.lng+=360}return x}const zf={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},ro={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class ga extends a.E{constructor(s,u){super(),(s instanceof HTMLElement||u)&&(s=a.l({element:s},u)),a.aV(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:y="center",color:S="#3FB1CE",scale:A=1,draggable:M=!1,clickTolerance:D=0,rotation:z=ro.rotation,rotationAlignment:U=ro.rotationAlignment,pitchAlignment:H=ro.pitchAlignment,occludedOpacity:K=ro.occludedOpacity,altitude:X=ro.altitude}=s||{};this._anchor=y,this._color=S,this._scale=A,this._draggable=M,this._clickTolerance=D,this._rotation=z,this._rotationAlignment=U,this._pitchAlignment=H,this._occludedOpacity=K,this._altitude=X,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),s&&s.element?(this._element=s.element,this._offset=a.P.convert(s&&s.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=a.P.convert(s&&s.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",ce=>{ce.preventDefault()}),this._element.addEventListener("mousedown",ce=>{ce.preventDefault()});const J=this._element.classList;for(const ce in zf)J.remove(`mapboxgl-marker-anchor-${ce}`);J.add(`mapboxgl-marker-anchor-${this._anchor}`);const de=s&&s.className?s.className.trim().split(/\s+/):[];J.add(...de),this._popup=null}_createDefaultMarker(){const s=W("div"),u=$("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},s);if(this._altitude===0){const y=$("radialGradient",{id:"shadowGradient"},$("defs",{},u));$("stop",{offset:"10%","stop-opacity":.4},y),$("stop",{offset:"100%","stop-opacity":.05},y),$("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},u)}return $("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},u),$("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},u),$("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},u),s}addTo(s){return s===this._map||(this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._updateMoving),s.on("moveend",this._update),s.on("remove",this._clearFadeTimer),s._addMarker(this),this.setDraggable(this._draggable),this._update(),s.on("click",this._onMapClick)),this}remove(){const s=this._map;return s&&(s.off("click",this._onMapClick),s.off("move",this._updateMoving),s.off("moveend",this._update),s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler),s.off("mouseup",this._onUp),s.off("touchend",this._onUp),s.off("mousemove",this._onMove),s.off("touchmove",this._onMove),s.off("remove",this._clearFadeTimer),s._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=a.cd.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(s){return s===this._altitude||(this._defaultMarker&&(this._altitude===0&&s!==0||this._altitude!==0&&s===0)&&(this._element=this._createDefaultMarker()),this._altitude=s||ro.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const S=Math.sqrt(Math.pow(13.5,2)/2);s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(38.1-13.5+S)],"bottom-right":[-S,-1*(38.1-13.5+S)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,s._marker=this,s._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(s){const u=s.code,y=s.charCode||s.keyCode;u!=="Space"&&u!=="Enter"&&y!==32&&y!==13||this.togglePopup()}_onMapClick(s){const u=s.originalEvent.target,y=this._element;this._popup&&(u===y||y.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?(s.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(s.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const s=this._map,u=this._pos;if(!s||!u)return!1;const y=s.unproject(u,this._altitude),S=s.getFreeCameraOptions();if(!S.position)return!1;const A=S.position.toLngLat();return A.distanceTo(y)<.9*A.distanceTo(this._lngLat)}_evaluateOpacity(){const s=this._map;if(!s)return;const u=this._pos;if(!u||u.x<0||u.x>s.transform.width||u.y<0||u.y>s.transform.height)return void this._clearFadeTimer();const y=s.unproject(u,this._altitude);let S;s._showingGlobe()&&a.eK(s.transform,this._lngLat)?S=0:(S=1-s._queryFogOpacity(y),s.transform._terrainEnabled()&&s.getTerrain()&&this._behindTerrain()&&(S*=this._occludedOpacity)),this._element.style.opacity=`${S}`,this._element.style.pointerEvents=S>0?"auto":"none",this._popup&&this._popup._setOpacity(S),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const s=this._pos;if(!s||!this._map)return;const u=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${s.x}px,${s.y}px)
            ${zf[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${u.x}px,${u.y}px)
        `}_calculateXYTransform(){const s=this._pos,u=this._map,y=this.getPitchAlignment();if(!u||!s||y!=="map")return"";if(!u._showingGlobe()){const z=u.getPitch();return z?`rotateX(${z}deg)`:""}const S=a.cJ(a.eL(u.transform,this._lngLat)),A=s.sub(a.eM(u.transform)),M=Math.abs(A.x)+Math.abs(A.y);if(M===0)return"";const D=S/M;return`rotateX(${-A.y*D}deg) rotateY(${A.x*D}deg)`}_calculateZTransform(){const s=this._pos,u=this._map;if(!u||!s)return"";let y=0;const S=this.getRotationAlignment();if(S==="map")if(u._showingGlobe()){const A=u.project(new a.cd(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),M=u.project(new a.cd(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(A);y=a.cJ(Math.atan2(M.y,M.x))-90}else y=-u.getBearing();else if(S==="horizon"){const A=a.af(4,6,u.getZoom()),M=a.eM(u.transform);M.y+=A*u.transform.height;const D=s.sub(M),z=a.cJ(Math.atan2(D.y,D.x));y=(z>90?z-270:z+90)*(1-A)}return y+=this._rotation,y?`rotateZ(${y}deg)`:""}_update(s){cancelAnimationFrame(this._updateFrameId);const u=this._map;u&&(u.transform.renderWorldCopies&&(this._lngLat=o0(this._lngLat,this._pos,u.transform)),this._pos=u.project(this._lngLat,this._altitude),s===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),u._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(u._showingGlobe()||u.getTerrain()||u.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(s){return this._offset=a.P.convert(s),this._update(),this}addClassName(s){return this._element.classList.add(s),this}removeClassName(s){return this._element.classList.remove(s),this}toggleClassName(s){return this._element.classList.toggle(s)}_onMove(s){const u=this._map;if(!u)return;const y=this._pointerdownPos,S=this._positionDelta;if(y&&S){if(!this._isDragging){const A=this._clickTolerance||u._clickTolerance;if(s.point.dist(y)<A)return;this._isDragging=!0}this._pos=s.point.sub(S),this._lngLat=u.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.A("dragstart"))),this.fire(new a.A("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const s=this._map;s&&(s.off("mousemove",this._onMove),s.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.A("dragend")),this._state="inactive"}_addDragHandler(s){const u=this._map,y=this._pos;u&&y&&this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(y),this._pointerdownPos=s.point,this._state="pending",u.on("mousemove",this._onMove),u.on("touchmove",this._onMove),u.once("mouseup",this._onUp),u.once("touchend",this._onUp))}setDraggable(s){this._draggable=!!s;const u=this._map;return u&&(s?(u.on("mousedown",this._addDragHandler),u.on("touchstart",this._addDragHandler)):(u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||ro.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||ro.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s||ro.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(s){return this._occludedOpacity=s||ro.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const tm={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Lf={maxWidth:100,unit:"metric"},Fc={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Ao={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},Ts=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function vu(x=new a.P(0,0),s="bottom"){if(typeof x=="number"){const u=Math.round(Math.sqrt(.5*Math.pow(x,2)));switch(s){case"top":return new a.P(0,x);case"top-left":return new a.P(u,u);case"top-right":return new a.P(-u,u);case"bottom":return new a.P(0,-x);case"bottom-left":return new a.P(u,-u);case"bottom-right":return new a.P(-u,-u);case"left":return new a.P(x,0);case"right":return new a.P(-x,0)}return new a.P(0,0)}return x instanceof a.P||Array.isArray(x)?a.P.convert(x):a.P.convert(x[s]||[0,0])}return{version:b,supported:F.supported,setRTLTextPlugin:a.eN,getRTLTextPluginStatus:a.eO,Map:class extends s0{constructor(x){E.mark(T.create);const s=x;if((x=a.l({},Hy,x)).minZoom!=null&&x.maxZoom!=null&&x.minZoom>x.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(x.minPitch!=null&&x.maxPitch!=null&&x.minPitch>x.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(x.minPitch!=null&&x.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(x.maxPitch!=null&&x.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(x.antialias&&a.eI(window)&&(x.antialias=!1,a.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new rh(x.minZoom,x.maxZoom,x.minPitch,x.maxPitch,x.renderWorldCopies,null,null),x),this._repaint=!!x.repaint,this._interactive=x.interactive,this._minTileCacheSize=x.minTileCacheSize,this._maxTileCacheSize=x.maxTileCacheSize,this._failIfMajorPerformanceCaveat=x.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=x.preserveDrawingBuffer,this._antialias=x.antialias,this._trackResize=x.trackResize,this._bearingSnap=x.bearingSnap,this._refreshExpiredTiles=x.refreshExpiredTiles,this._fadeDuration=x.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=x.crossSourceCollisions,this._collectResourceTiming=x.collectResourceTiming,this._language=this._parseLanguage(x.language),this._worldview=x.worldview,this._renderTaskQueue=new Ol,this._domRenderTaskQueue=new Ol,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.a$(),this._locale=a.l({},ca,x.locale),this._clickTolerance=x.clickTolerance,this._cooperativeGestures=x.cooperativeGestures,this._performanceMetricsCollection=x.performanceMetricsCollection,this._tessellationStep=x.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=x.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new em(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=x.scaleFactor,this._requestManager=new Nt(x.transformRequest,x.accessToken,x.testMode),this._silenceAuthErrors=!!x.testMode,this._contextCreateOptions=x.contextCreateOptions?Object.assign({},x.contextCreateOptions):{},typeof x.container=="string"){const u=document.getElementById(x.container);if(!u)throw new Error(`Container '${x.container.toString()}' not found.`);this._container=u}else{if(!(x.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=x.container}if(this._container.childNodes.length>0&&a.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),x.maxBounds&&this.setMaxBounds(x.maxBounds),this._spriteFormat=x.spriteFormat,a.aV(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Kp),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new a0(this,x),this._localFontFamily=x.localFontFamily,this._localIdeographFontFamily=x.localIdeographFontFamily,(x.style||!x.testMode)&&this.setStyle(x.style||a.e.DEFAULT_STYLE,{config:x.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),x.projection&&this.setProjection(x.projection),this.indoor=new Qm(this),x.hash&&(this._hash=new Eh(typeof x.hash=="string"&&x.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){s.center==null&&s.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:x.center,zoom:x.zoom,bearing:x.bearing,pitch:x.pitch});const u=x.bounds;u&&(this.resize(),this.fitBounds(u,a.l({},x.fitBoundsOptions,{duration:0})))}this.resize(),x.attributionControl&&this.addControl(new kf({customAttribution:x.customAttribution})),this._logoControl=new md,this.addControl(this._logoControl,x.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",u=>{this._update(u.dataType==="style"),this.fire(new a.A(`${u.dataType}data`,u))}),this.on("dataloading",u=>{this.fire(new a.A(`${u.dataType}dataloading`,u))}),this._interactions=new ll(this)}_getMapId(){return this._mapId}addControl(x,s){if(s===void 0&&(s=x.getDefaultPosition?x.getDefaultPosition():"top-right"),!x||!x.onAdd)return this.fire(new a.z(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=x.onAdd(this);this._controls.push(x);const y=this._controlPositions[s];return s.indexOf("bottom")!==-1?y.insertBefore(u,y.firstChild):y.appendChild(u),this}removeControl(x){if(!x||!x.onRemove)return this.fire(new a.z(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(x);return s>-1&&this._controls.splice(s,1),x.onRemove(this),this}hasControl(x){return this._controls.indexOf(x)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(x){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const s=!this._moving;return s&&this.fire(new a.A("movestart",x)).fire(new a.A("move",x)),this.fire(new a.A("resize",x)),s&&this.fire(new a.A("moveend",x)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(x){return this.transform.setMaxBounds(a.aG.convert(x)),this._update()}setMinZoom(x){if((x=x??-2)>=-2&&x<=this.transform.maxZoom)return this.transform.minZoom=x,this._update(),this.getZoom()<x?this.setZoom(x):this.fire(new a.A("zoomstart")).fire(new a.A("zoom")).fire(new a.A("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(x){if((x=x??22)>=this.transform.minZoom)return this.transform.maxZoom=x,this._update(),this.getZoom()>x?this.setZoom(x):this.fire(new a.A("zoomstart")).fire(new a.A("zoom")).fire(new a.A("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(x){if((x=x??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(x>=0&&x<=this.transform.maxPitch)return this.transform.minPitch=x,this._update(),this.getPitch()<x?this.setPitch(x):this.fire(new a.A("pitchstart")).fire(new a.A("pitch")).fire(new a.A("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(x){if((x=x??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(x>=this.transform.minPitch)return this.transform.maxPitch=x,this._update(),this.getPitch()>x?this.setPitch(x):this.fire(new a.A("pitchstart")).fire(new a.A("pitch")).fire(new a.A("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(x){return this._scaleFactor=x,this.painter.scaleFactor=x,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(s=>s.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(x){return this.transform.renderWorldCopies=x,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(x){return x==="auto"?navigator.language:Array.isArray(x)?x.length===0?void 0:x.map(s=>s==="auto"?navigator.language:s):x}setLanguage(x){const s=this._parseLanguage(x);if(!this.style||s===this._language)return this;this._language=s,this.style.reloadSources();for(const u of this._controls)u._setLanguage&&u._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(x){return this.style&&x!==this._worldview?(this._worldview=x,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(x){return this._lazyInitEmptyStyle(),x?typeof x=="string"&&(x={name:x}):x=null,this._useExplicitProjection=!!x,this._prioritizeAndUpdateProjection(x,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const x=this.transform,s=x.projection.name;let u;s==="globe"&&x.zoom>=a.cx?(x.setMercatorFromTransition(),u=!0):s==="mercator"&&x.zoom<a.cx&&(x.setProjection({name:"globe"}),u=!0),u&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(x,s){return this._updateProjection(x||s||{name:"mercator"})}_updateProjection(x){let s;return s=x.name==="globe"&&this.transform.zoom>=a.cx?this.transform.setMercatorFromTransition():this.transform.setProjection(x),this.style.applyProjectionUpdate(),s&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(x,s){return this.transform.locationPoint3D(a.cd.convert(x),s)}unproject(x,s){return this.transform.pointLocation3D(a.P.convert(x),s)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(x,s,u){const y=S=>{let A=[];if(Array.isArray(s)){const M=s.filter(D=>this.getLayer(D));A=M.length?this.queryRenderedFeatures(S,{layers:M}):[]}else A=this.queryRenderedFeatures(S,{target:s});return A};if(x==="mouseenter"||x==="mouseover"){let S=!1;return{listener:u,targets:s,delegates:{mousemove:M=>{const D=y(M.point);D.length?S||(S=!0,u.call(this,new no(x,this,M.originalEvent,{features:D}))):S=!1},mouseout:()=>{S=!1}}}}if(x==="mouseleave"||x==="mouseout"){let S=!1;return{listener:u,targets:s,delegates:{mousemove:D=>{y(D.point).length?S=!0:S&&(S=!1,u.call(this,new no(x,this,D.originalEvent)))},mouseout:D=>{S&&(S=!1,u.call(this,new no(x,this,D.originalEvent)))}}}}{const S=A=>{const M=y(A.point);M.length&&(A.features=M,u.call(this,A),delete A.features)};return{listener:u,targets:s,delegates:{[x]:S}}}}on(x,s,u){if(typeof s=="function"||u===void 0)return super.on(x,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const y=this._createDelegatedListener(x,s,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[x]=this._delegatedListeners[x]||[],this._delegatedListeners[x].push(y);for(const S in y.delegates)this.on(S,y.delegates[S]);return this}once(x,s,u){if(typeof s=="function"||u===void 0)return super.once(x,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const y=this._createDelegatedListener(x,s,u);for(const S in y.delegates)this.once(S,y.delegates[S]);return this}off(x,s,u){if(typeof s=="function"||u===void 0)return super.off(x,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const y=this._delegatedListeners?this._delegatedListeners[x]:void 0;return y&&(S=>{for(let A=0;A<S.length;A++){const M=S[A];if(M.listener===u&&Rf(M.targets,s)){for(const D in M.delegates)this.off(D,M.delegates[D]);return S.splice(A,1),this}}})(y),this}queryRenderedFeatures(x,s){if(!this.style)return[];if(x===void 0||x instanceof a.P||Array.isArray(x)||s!==void 0||(s=x,x=void 0),x=x||[[0,0],[this.transform.width,this.transform.height]],!s){const A=this.style.queryRenderedFeatures(x,void 0,this.transform),M=this.style.queryRenderedFeatureset(x,void 0,this.transform);return A.concat(M)}let u=!0;if(s.target&&(u=this._isTargetValid(s.target),u&&!s.layers))return this.style.queryRenderedFeatureset(x,s,this.transform);let y=!0;if(s.layers&&Array.isArray(s.layers)){for(const A of s.layers)if(!this._isValidId(A)){y=!1;break}if(y&&!s.target)return this.style.queryRenderedFeatures(x,s,this.transform)}let S=[];return y&&(S=S.concat(this.style.queryRenderedFeatures(x,s,this.transform))),u&&(S=S.concat(this.style.queryRenderedFeatureset(x,s,this.transform))),S}querySourceFeatures(x,s){return!x||typeof x=="string"&&!this._isValidId(x)?[]:this.style.querySourceFeatures(x,s)}isPointOnSurface(x){const{name:s}=this.transform.projection;return s!=="globe"&&s!=="mercator"&&a.w(`${s} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(a.P.convert(x))}addInteraction(x,s){return this._interactions.add(x,s),this}removeInteraction(x){return this._interactions.remove(x),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(x){return this._cooperativeGestures=x,this}setStyle(x,s){return s=a.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},s),this.style&&x&&s.diff!==!1&&s.localFontFamily===this._localFontFamily&&s.localIdeographFontFamily===this._localIdeographFontFamily&&!s.config?(this.style._diffStyle(x,(u,y)=>{if(u){const S=typeof u=="string"?u:u instanceof Error?u.message:u.error;a.w(`Unable to perform style diff: ${S}. Rebuilding the style from scratch.`),this._updateStyle(x,s)}else y&&this._update(!0)},()=>this._postStyleLoadEvent()),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._localFontFamily=s.localFontFamily,this._updateStyle(x,s))}_getUIString(x){const s=this._locale[x];if(s==null)throw new Error(`Missing UI string '${x}'`);return s}_updateStyle(x,s){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),x){const u=a.l({},s);s&&s.config&&(u.initialConfig=s.config,delete u.config),this.style=new il(this,u).load(x),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new il(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.w("There is no style added to the map."),!1)}_isValidId(x){return x==null?(this.fire(new a.z(new Error("IDs can't be empty."))),!1):!a.d9(x)||(this.fire(new a.z(new Error(`IDs can't contain special symbols: "${x}".`))),!1)}_isTargetValid(x){return"featuresetId"in x?this._isValidId("importId"in x?x.importId:x.featuresetId):"layerId"in x&&this._isValidId(x.layerId)}_areTargetsValid(x){if(Array.isArray(x)){for(const s of x)if(!this._isValidId(s))return!1;return!0}return this._isTargetValid(x)}addSource(x,s){return this._isValidId(x)?(this._lazyInitEmptyStyle(),this.style.addSource(x,s),this._update(!0)):this}isSourceLoaded(x){return!!this._isValidId(x)&&!!this.style&&this.style._isSourceCacheLoaded(x)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(x,s,u){this._lazyInitEmptyStyle(),this.style.addSourceType(x,s,u)}removeSource(x){return this._isValidId(x)?(this.style.removeSource(x),this._updateTerrain(),this._update(!0)):this}getSource(x){return this._isValidId(x)?this.style.getOwnSource(x):null}addImage(x,s,{pixelRatio:u=1,sdf:y=!1,stretchX:S,stretchY:A,content:M}={}){this._lazyInitEmptyStyle();const D=a.I.from(x);if(s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap){const{width:z,height:U,data:H}=a.q.getImageData(s);this.style.addImage(D,{data:new a.r({width:z,height:U},H),pixelRatio:u,stretchX:S,stretchY:A,content:M,sdf:y,version:0,usvg:!1})}else if(s.width===void 0||s.height===void 0)this.fire(new a.z(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:z,height:U}=s,H=s;this.style.addImage(D,{data:new a.r({width:z,height:U},new Uint8Array(H.data)),pixelRatio:u,stretchX:S,stretchY:A,content:M,sdf:y,usvg:!1,version:0,userImage:H}),H.onAdd&&H.onAdd(this,x)}}updateImage(x,s){this._lazyInitEmptyStyle();const u=a.I.from(x),y=this.style.getImage(u);if(!y)return void this.fire(new a.z(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const S=s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap?a.q.getImageData(s):s,{width:A,height:M,data:D}=S;if(A===void 0||M===void 0)return void this.fire(new a.z(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(A!==(y.usvg?y.icon.usvg_tree.width:y.data.width)||M!==(y.usvg?y.icon.usvg_tree.height:y.data.height))return void this.fire(new a.z(new Error(`The width and height of the updated image (${A}, ${M})
                must be that same as the previous version of the image
                (${y.data.width}, ${y.data.height})`)));const z=!(s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap);let U=!1;y.usvg?(y.data=new a.r({width:A,height:M},new Uint8Array(D)),y.usvg=!1,y.icon=void 0,U=!0):y.data.replace(D,z),this.style.updateImage(u,y,U)}hasImage(x){return x?!!this.style&&!!this.style.getImage(a.I.from(x)):(this.fire(new a.z(new Error("Missing required image id"))),!1)}removeImage(x){this.style.removeImage(a.I.from(x))}loadImage(x,s){a.o(this._requestManager.transformRequest(x,a.R.Image),(u,y)=>{s(u,y instanceof HTMLImageElement?a.q.getImageData(y):y)})}listImages(){return this.style.listImages().map(x=>x.name)}addModel(x,s){this._lazyInitEmptyStyle(),this.style.addModel(x,s)}hasModel(x){return x?this.style.hasModel(x):(this.fire(new a.z(new Error("Missing required model id"))),!1)}removeModel(x){this.style.removeModel(x)}listModels(){return this.style.listModels()}addLayer(x,s){return this._isValidId(x.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(x,s),this._update(!0)):this}getSlot(x){const s=this.getLayer(x);return s&&s.slot||null}setSlot(x,s){return this.style.setSlot(x,s),this.style.mergeLayers(),this._update(!0)}addImport(x,s){return this.style.addImport(x,s).catch(u=>this.fire(new a.z(new Error("Failed to add import",u)))),this}updateImport(x,s){return typeof s!="string"&&s.id!==x?(this.removeImport(x),this.addImport(s)):(this.style.updateImport(x,s),this._update(!0))}removeImport(x){return this.style.removeImport(x),this}moveImport(x,s){return this.style.moveImport(x,s),this._update(!0)}moveLayer(x,s){return this._isValidId(x)?(this.style.moveLayer(x,s),this._update(!0)):this}removeLayer(x){return this._isValidId(x)?(this.style.removeLayer(x),this._update(!0)):this}getLayer(x){if(!this._isValidId(x))return null;const s=this.style.getOwnLayer(x);return s?s.type==="custom"?s.implementation:s.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(x,s,u){return this._isValidId(x)?(this.style.setLayerZoomRange(x,s,u),this._update(!0)):this}setFilter(x,s,u={}){return this._isValidId(x)?(this.style.setFilter(x,s,u),this._update(!0)):this}getFilter(x){return this._isValidId(x)?this.style.getFilter(x):null}setPaintProperty(x,s,u,y={}){return this._isValidId(x)?(this.style.setPaintProperty(x,s,u,y),this._update(!0)):this}getPaintProperty(x,s){return this._isValidId(x)?this.style.getPaintProperty(x,s):null}setLayoutProperty(x,s,u,y={}){return this._isValidId(x)?(this.style.setLayoutProperty(x,s,u,y),this._update(!0)):this}getLayoutProperty(x,s){return this._isValidId(x)?this.style.getLayoutProperty(x,s):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(x){return this.style.setGlyphsUrl(x),this._update(!0)}getSchema(x){return this.style.getSchema(x)}setSchema(x,s){return this.style.setSchema(x,s),this._update(!0)}getConfig(x){return this.style.getConfig(x)}setConfig(x,s){return this.style.setConfig(x,s),this._update(!0)}getConfigProperty(x,s){return this.style.getConfigProperty(x,s)}setConfigProperty(x,s,u){return this.style.setConfigProperty(x,s,u),this._update(!0)}getFeaturesetDescriptors(x){return this.style.getFeaturesetDescriptors(x)}setLights(x){if(this._lazyInitEmptyStyle(),x&&x.length===1&&x[0].type==="flat"){const s=x[0];s.properties?this.style.setFlatLight(s.properties,s.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(x),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const x=this.style.getLights()||[];return x.length===0&&x.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),x}setLight(x,s={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:x}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(x){return this._lazyInitEmptyStyle(),!x&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(x),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(x){return this._lazyInitEmptyStyle(),this.style.setFog(x),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(x){return this._lazyInitEmptyStyle(),this.style.setSnow(x),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(x){return this._lazyInitEmptyStyle(),this.style.setRain(x),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(x){return this._lazyInitEmptyStyle(),this.style.setColorTheme(x),this._update(!0)}setImportColorTheme(x,s){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(x,s),this._update(!0)}setCamera(x){return this.style.setCamera(x),this._triggerCameraUpdate(x)}_triggerCameraUpdate(x){return this._update(this.transform.setOrthographicProjectionAtLowPitch(x["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(x){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.cd.convert(x),this.transform):0}setFeatureState(x,s){return x.source&&!this._isValidId(x.source)?this:(this.style.setFeatureState(x,s),this._update())}removeFeatureState(x,s){return x.source&&!this._isValidId(x.source)?this:(this.style.removeFeatureState(x,s),this._update())}getFeatureState(x){return x.source&&!this._isValidId(x.source)?null:this.style.getFeatureState(x)}_updateContainerDimensions(){if(!this._container)return;const x=this._container.getBoundingClientRect().width||400,s=this._container.getBoundingClientRect().height||300;let u,y,S,A=this._container;for(;A&&(!y||!S);){const M=window.getComputedStyle(A).transform;M&&M!=="none"&&(u=M.match(/matrix.*\((.+)\)/)[1].split(", "),u[0]&&u[0]!=="0"&&u[0]!=="1"&&(y=u[0]),u[3]&&u[3]!=="0"&&u[3]!=="1"&&(S=u[3])),A=A.parentElement}this._containerWidth=y?Math.abs(x/y):x,this._containerHeight=S?Math.abs(s/S):s}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const x=this._container;x.classList.add("mapboxgl-map"),(this._missingCSSCanary=W("div","mapboxgl-canary",x)).style.visibility="hidden",this._detectMissingCSS();const s=this._canvasContainer=W("div","mapboxgl-canvas-container",x);this._canvas=W("canvas","mapboxgl-canvas",s),this._interactive&&(s.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=W("div","mapboxgl-control-container",x),y=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(S=>{y[S]=W("div",`mapboxgl-ctrl-${S}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(x,s){const u=a.q.devicePixelRatio||1;this._canvas.width=u*Math.ceil(x),this._canvas.height=u*Math.ceil(s),this._canvas.style.width=`${x}px`,this._canvas.style.height=`${s}px`}_addMarker(x){this._markers.push(x)}_removeMarker(x){const s=this._markers.indexOf(x);s!==-1&&this._markers.splice(s,1)}_addPopup(x){this._popups.push(x)}_removePopup(x){const s=this._popups.indexOf(x);s!==-1&&this._popups.splice(s,1)}_setupPainter(){const x=a.l({},F.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),s=this._canvas.getContext("webgl2",x);s?(dn(s,!0),this.painter=new Th(s,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",u=>{u.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.m.testSupport(s)):this.fire(new a.z(new Error("Failed to initialize WebGL")))}_contextLost(x){x.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.A("webglcontextlost",{originalEvent:x}))}_contextRestored(x){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new a.A("webglcontextrestored",{originalEvent:x}))}_onMapScroll(x){if(x.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(x){return this.style?(this._styleDirty=this._styleDirty||x,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(x){return this._update(),this._renderTaskQueue.add(x)}_cancelRenderFrame(x){this._renderTaskQueue.remove(x)}_requestDomTask(x){!this.loaded()||this.loaded()&&!this.isMoving()?x():this._domRenderTaskQueue.add(x)}_render(x){let s;this.fire(new a.A("renderstart")),++this._frameId;const u=this.painter.context.extTimerQuery,y=a.q.now(),S=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(s=S.createQuery(),S.beginQuery(u.TIME_ELAPSED_EXT,s)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(x),this._domRenderTaskQueue.run(x),this._removed)return;this._updateProjectionTransition();const A=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const U=this.transform.zoom,H=this.transform.pitch,K=a.q.now(),X=new a.aa(U,{now:K,fadeDuration:A,pitch:H,transition:this.style.transition});this.style.update(X)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let M=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),M=this._updateAverageElevation(y),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):M=this._updateAverageElevation(y);const D=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,A,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),D&&(this._placementDirty=D.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:A,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.A("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,E.mark(T.load),this.fire(new a.A("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),s){const U=a.q.now()-y;S.endQuery(u.TIME_ELAPSED_EXT),setTimeout(()=>{const H=S.getQueryParameter(s,S.QUERY_RESULT)/1e6;S.deleteQuery(s),this.fire(new a.A("gpu-timing-frame",{cpuTime:U,gpuTime:H}))},50)}if(this.listens("gpu-timing-layer")){const U=this.painter.collectGpuTimers();setTimeout(()=>{const H=this.painter.queryGpuTimers(U);this.fire(new a.A("gpu-timing-layer",{layerTimes:H}))},50)}if(this.listens("gpu-timing-deferred-render")){const U=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const H=this.painter.queryGpuTimeDeferredRender(U);this.fire(new a.A("gpu-timing-deferred-render",{gpuTime:H}))},50)}const z=this._sourcesDirty||this._styleDirty||this._placementDirty||M;if(z||this._repaint)this.triggerRepaint();else{const U=this.idle();if(U&&(M=this._updateAverageElevation(y,!0)),M)this.triggerRepaint();else if(this._triggerFrame(!1),U&&(this.fire(new a.A("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const H=this._calculateSpeedIndex();this.fire(new a.A("speedindexcompleted",{speedIndex:H})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||z||(this._fullyLoaded=!0,E.mark(T.fullLoad),this._performanceMetricsCollection&&Sr(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(x){for(const s of this._markers)x&&!this.getRenderWorldCopies()&&(s._lngLat=s._lngLat.wrap()),s._update();for(const s of this._popups)!x||this.getRenderWorldCopies()||s._trackPointer||(s._lngLat=s._lngLat.wrap()),s._update()}_updateAverageElevation(x,s=!1){const u=S=>(this.transform.averageElevation=S,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&u(0);const y=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(y||(s||x-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(x)){const S=this.transform.averageElevation;let A=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(A)?A=0:this._averageElevationLastSampledAt=x;const M=Math.abs(S-A);if(M>1){if(this._isInitialLoad||y)return this._averageElevation.jumpTo(A),u(A);this._averageElevation.easeTo(A,x,300)}else if(M>1e-4)return this._averageElevation.jumpTo(A),u(A)}return!!this._averageElevation.isEasing(x)&&u(this._averageElevation.getValue(x))}_authenticate(){er(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,x=>{if(x&&(x.message===jt||x.status===401)){const s=this.painter.context.gl;dn(s,!1),this._logoControl instanceof md&&this._logoControl._updateLogo(),s&&s.clear(s.DEPTH_BUFFER_BIT|s.COLOR_BUFFER_BIT|s.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.z(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),In(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&vn(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const x=this._isDragging();this.painter.updateTerrain(this.style,x)}_calculateSpeedIndex(){const x=this.painter.canvasCopy(),s=this.painter.getCanvasCopiesAndTimestamps();s.timeStamps.push(performance.now());const u=this.painter.context.gl,y=u.createFramebuffer();function S(A){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,A,0);const M=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,M),M}return u.bindFramebuffer(u.FRAMEBUFFER,y),this._canvasPixelComparison(S(x),s.canvasCopies.map(S),s.timeStamps)}_canvasPixelComparison(x,s,u){let y=u[1]-u[0];const S=x.length/4;for(let A=0;A<s.length;A++){const M=s[A];let D=0;for(let z=0;z<M.length;z+=4)M[z]===x[z]&&M[z+1]===x[z+1]&&M[z+2]===x[z+2]&&M[z+3]===x[z+3]&&(D+=1);y+=(u[A+2]-u[A+1])*(1-D/S)}return y}remove(){this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const x=this.painter.context.gl.getExtension("WEBGL_lose_context");x&&x.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),hr.delete(this.painter.context.gl),un.remove(),It.remove(),this._removed=!0,this.fire(new a.A("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(x){this._renderNextFrame=this._renderNextFrame||x,this.style&&!this._frame&&(this._frame=a.q.frame(s=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(s)}))}_preloadTiles(x){const s=this.style?this.style.getSourceCaches():[];return a.bt(s,(u,y)=>u._preloadTiles(x,y),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(x){this._trackResize&&this.resize({originalEvent:x})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(x){this._showTileBoundaries!==x&&(this._showTileBoundaries=x,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(x){this._showParseStatus!==x&&(this._showParseStatus=x,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(x){this._showTerrainWireframe!==x&&(this._showTerrainWireframe=x,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(x){this._showLayers2DWireframe!==x&&(this._showLayers2DWireframe=x,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(x){this._showLayers3DWireframe!==x&&(this._showLayers3DWireframe=x,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(x){this._speedIndexTiming!==x&&(this._speedIndexTiming=x,this._update())}get showPadding(){return!!this._showPadding}set showPadding(x){this._showPadding!==x&&(this._showPadding=x,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(x){this._showCollisionBoxes!==x&&(this._showCollisionBoxes=x,this._tp.refreshUI(),x?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(x){this._showOverdrawInspector!==x&&(this._showOverdrawInspector=x,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(x){this._repaint!==x&&(this._repaint=x,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(x){this._vertices=x,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(x){this._showTileAABBs!==x&&(this._showTileAABBs=x,this._tp.refreshUI(),x&&this._update())}_setCacheLimits(x,s){a.eJ(x,s)}get version(){return b}},NavigationControl:class{constructor(x={}){this.options=a.l({},Gy,x),this._container=W("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(a.aV(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",s=>{this._map&&this._map.zoomIn({},{originalEvent:s})}),W("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",s=>{this._map&&this._map.zoomOut({},{originalEvent:s})}),W("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.aV(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",s=>{const u=this._map;u&&(this.options.visualizePitch?u.resetNorthPitch({},{originalEvent:s}):u.resetNorth({},{originalEvent:s}))}),this._compassIcon=W("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const x=this._map;if(!x)return;const s=x.getZoom(),u=s===x.getMaxZoom(),y=s===x.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const x=this._map;if(!x)return;const s=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(x.transform.pitch*(Math.PI/180)),.5)}) rotateX(${x.transform.pitch}deg) rotateZ(${x.transform.angle*(180/Math.PI)}deg)`:`rotate(${x.transform.angle*(180/Math.PI)}deg)`;x._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=s)})}onAdd(x){return this._map=x,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),x.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&x.on("pitch",this._rotateCompassArrow),x.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new cl(x,this._compass,this.options.visualizePitch)),this._container}onRemove(){const x=this._map;x&&(this._container.remove(),this.options.showZoom&&x.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&x.off("pitch",this._rotateCompassArrow),x.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(x,s){const u=W("button",x,this._container);return u.type="button",u.addEventListener("click",s),u}_setButtonTitle(x,s){if(!this._map)return;const u=this._map._getUIString(`NavigationControl.${s}`);x.setAttribute("aria-label",u),x.firstElementChild&&x.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends a.E{constructor(x={}){super();const s=navigator.geolocation;this.options=a.l({geolocation:s},tm,x),a.aV(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=cd(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(x){return this._map=x,this._container=W("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(x){const s=(u=!!this.options.geolocation)=>{this._supportsGeolocation=u,x(u)};this._supportsGeolocation!==void 0?x(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(u=>s(u.state!=="denied")).catch(()=>s()):s()}_isOutOfMapMaxBounds(x){const s=this._map.getMaxBounds(),u=x.coords;return!!s&&(u.longitude<s.getWest()||u.longitude>s.getEast()||u.latitude<s.getSouth()||u.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(x){if(this._map){if(this._isOutOfMapMaxBounds(x))return this._setErrorState(),this.fire(new a.A("outofmaxbounds",x)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=x,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(x),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(x),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.A("geolocate",x)),this._finish()}}_updateCamera(x){const s=new a.cd(x.coords.longitude,x.coords.latitude),u=x.coords.accuracy,y=this._map.getBearing(),S=a.l({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(s.toBounds(u),S,{geolocateSource:!0})}_updateMarker(x){if(x){const s=new a.cd(x.coords.longitude,x.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=x.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const x=this._map.transform,s=a.c6(1,x._center.lat)*x.worldSize,u=Math.ceil(2*this._accuracy*s);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(x){if(this._map){if(this.options.trackUserLocation)if(x.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(x.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.A("error",x)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(x){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=W("button","mapboxgl-ctrl-geolocate",this._container),W("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",x===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=W("div","mapboxgl-user-location"),this._dotElement.appendChild(W("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(W("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new ga({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=W("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ga({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.A("trackuserlocationend")))})}}_onDeviceOrientation(x){this._userLocationDotMarker&&(x.webkitCompassHeading?this._heading=x.webkitCompassHeading:x.absolute===!0&&(this._heading=-1*x.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.A("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.A("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.A("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let x;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(x={maximumAge:6e5,timeout:0},this._noTimeout=!0):(x=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,x),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const x=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(s=>{s==="granted"&&x()}).catch(console.error):x()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:kf,ScaleControl:class{constructor(x={}){this.options=a.l({},Lf,x),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),a.aV(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const x=this.options.maxWidth||100,s=this._map,u=s._containerHeight/2,y=s._containerWidth/2-x/2,S=s.unproject([y,u]),A=s.unproject([y+x,u]),M=S.distanceTo(A);if(this.options.unit==="imperial"){const D=3.2808*M;D>5280?this._setScale(x,D/5280,"mile"):this._setScale(x,D,"foot")}else this.options.unit==="nautical"?this._setScale(x,M/1852,"nautical-mile"):M>=1e3?this._setScale(x,M/1e3,"kilometer"):this._setScale(x,M,"meter")}_setScale(x,s,u){this._map._requestDomTask(()=>{const y=function(A){const M=Math.pow(10,`${Math.floor(A)}`.length-1);let D=A/M;return D=D>=10?10:D>=5?5:D>=3?3:D>=2?2:D>=1?1:function(z){const U=Math.pow(10,Math.ceil(-Math.log(z)/Math.LN10));return Math.round(z*U)/U}(D),M*D}(s),S=y/s;this._container.innerHTML=this._isNumberFormatSupported&&u!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:u}).format(y):`${y}&nbsp;${Fc[u]}`,this._container.style.width=x*S+"px"})}onAdd(x){return this._map=x,this._language=x.getLanguage(),this._container=W("div","mapboxgl-ctrl mapboxgl-ctrl-scale",x.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(x){this._language=x,this._update()}setUnit(x){this.options.unit=x,this._update()}},FullscreenControl:class{constructor(x={}){this._fullscreen=!1,x&&x.container&&(x.container instanceof HTMLElement?this._container=x.container:a.w("Full screen control 'container' must be a DOM element.")),a.aV(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(x){return this._map=x,this._container||(this._container=this._map.getContainer()),this._controlContainer=W("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const x=this._fullscreenButton=W("button","mapboxgl-ctrl-fullscreen",this._controlContainer);W("span","mapboxgl-ctrl-icon",x).setAttribute("aria-hidden","true"),x.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const x=this._getTitle();this._fullscreenButton.setAttribute("aria-label",x),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",x)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.E{constructor(x){super(),this.options=a.l(Object.create(Ao),x),this._altitude=this.options.altitude,a.aV(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(x&&x.className?x.className.trim().split(/\s+/):[])}addTo(x){return this._map&&this.remove(),this._map=x,this.options.closeOnClick&&x.on("preclick",this._onClose),this.options.closeOnMove&&x.on("move",this._onClose),x.on("remove",this.remove),this._update(),x._addPopup(this),this._focusFirstElement(),this._trackPointer?(x.on("mousemove",this._onMouseEvent),x.on("mouseup",this._onMouseEvent),x._canvasContainer.classList.add("mapboxgl-track-pointer")):x.on("move",this._update),this.fire(new a.A("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const x=this._map;return x&&(x.off("move",this._update),x.off("move",this._onClose),x.off("preclick",this._onClose),x.off("click",this._onClose),x.off("remove",this.remove),x.off("mousemove",this._onMouseEvent),x.off("mouseup",this._onMouseEvent),x.off("drag",this._onMouseEvent),x._canvasContainer&&x._canvasContainer.classList.remove("mapboxgl-track-pointer"),x._removePopup(this),this._map=void 0),this.fire(new a.A("close")),this}getLngLat(){return this._lngLat}setLngLat(x){this._lngLat=a.cd.convert(x),this._pos=null,this._trackPointer=!1,this._update();const s=this._map;return s&&(s.on("move",this._update),s.off("mousemove",this._onMouseEvent),s._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(x){return this._altitude=x,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const x=this._map;return x&&(x.off("move",this._update),x.on("mousemove",this._onMouseEvent),x.on("drag",this._onMouseEvent),x._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(x){return this.setDOMContent(document.createTextNode(x))}setHTML(x){const s=document.createDocumentFragment(),u=document.createElement("body");let y;for(u.innerHTML=x;y=u.firstChild,y;)s.appendChild(y);return this.setDOMContent(s)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(x){return this.options.maxWidth=x,this._update(),this}setDOMContent(x){let s=this._content;if(s)for(;s.hasChildNodes();)s.firstChild&&s.removeChild(s.firstChild);else s=this._content=W("div","mapboxgl-popup-content",this._container||void 0);if(s.appendChild(x),this.options.closeButton){const u=this._closeButton=W("button","mapboxgl-popup-close-button",s);u.type="button",u.setAttribute("aria-label","Close popup"),u.innerHTML='<span aria-hidden="true">&#215;</span>',u.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(x){return this._classList.add(x),this._updateClassList(),this}removeClassName(x){return this._classList.delete(x),this._updateClassList(),this}setOffset(x){return this.options.offset=x,this._update(),this}toggleClassName(x){let s;return this._classList.delete(x)?s=!1:(this._classList.add(x),s=!0),this._updateClassList(),s}_onMouseEvent(x){this._update(x.point)}_getAnchor(x){if(this.options.anchor)return this.options.anchor;const s=this._map,u=this._container,y=this._pos;if(!s||!u||!y)return"bottom";const S=u.offsetWidth,A=u.offsetHeight,M=y.x<S/2,D=y.x>s.transform.width-S/2;if(y.y+x<A)return M?"top-left":D?"top-right":"top";if(y.y>s.transform.height-A){if(M)return"bottom-left";if(D)return"bottom-right"}return M?"left":D?"right":"bottom"}_updateClassList(){const x=this._container;if(!x)return;const s=[...this._classList];s.push("mapboxgl-popup"),this._anchor&&s.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&s.push("mapboxgl-popup-track-pointer"),x.className=s.join(" ")}_update(x){const s=this._map,u=this._content;if(!s||!this._lngLat&&!this._trackPointer||!u)return;let y=this._container;if(y||(y=this._container=W("div","mapboxgl-popup",s.getContainer()),this._tip=W("div","mapboxgl-popup-tip",y),y.appendChild(u)),this.options.maxWidth&&y.style.maxWidth!==this.options.maxWidth&&(y.style.maxWidth=this.options.maxWidth),s.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=o0(this._lngLat,this._pos,s.transform)),!this._trackPointer||x){const S=this._pos=this._trackPointer&&x instanceof a.P?x:s.project(this._lngLat,this._altitude),A=vu(this.options.offset),M=this._anchor=this._getAnchor(A.y),D=vu(this.options.offset,M),z=S.add(D).round();s._requestDomTask(()=>{this._container&&M&&(this._container.style.transform=`${zf[M]} translate(${z.x}px,${z.y}px)`)})}if(!this._marker&&s._showingGlobe()){const S=a.eK(s.transform,this._lngLat)?0:1;this._setOpacity(S)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const x=this._container.querySelector(Ts);x&&x.focus()}_onClose(){this.remove()}_setOpacity(x){this._container&&(this._container.style.opacity=`${x}`),this._content&&(this._content.style.pointerEvents=x?"auto":"none")}},Marker:ga,Style:il,LngLat:a.cd,LngLatBounds:a.aG,Point:a.P,MercatorCoordinate:a.ac,FreeCameraOptions:df,Evented:a.E,config:a.e,prewarm:a.eP,clearPrewarmedResources:a.eQ,get accessToken(){return a.e.ACCESS_TOKEN},set accessToken(x){a.e.ACCESS_TOKEN=x},get baseApiUrl(){return a.e.API_URL},set baseApiUrl(x){a.e.API_URL=x},get workerCount(){return a.eR.workerCount},set workerCount(x){a.eR.workerCount=x},get maxParallelImageRequests(){return a.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(x){a.e.MAX_PARALLEL_IMAGE_REQUESTS=x},clearStorage(x){a.eS(x)},get workerUrl(){return a.eT.workerUrl},set workerUrl(x){a.eT.workerUrl=x},get workerClass(){return a.eT.workerClass},set workerClass(x){a.eT.workerClass=x},get workerParams(){return a.eT.workerParams},set workerParams(x){a.eT.workerParams=x},get dracoUrl(){return a.eU()},set dracoUrl(x){a.eV(x)},get meshoptUrl(){return a.eW()},set meshoptUrl(x){a.eX(x)},setNow:a.q.setNow,restoreNow:a.q.restoreNow}});var p=l;return p})}(xT)),xT.exports}var N0e=P0e();const uo=Gs(N0e),D0e=async(e,t=3,n=800)=>{for(let r=1;r<=t;r++)try{const l=await fetch(e);if(!l.ok)throw new Error(`Código HTTP: ${l.status}`);return await l.json()}catch(l){if(r===t||l.name==="AbortError")throw l;console.warn(`🔁 Reintentando carga de mapa... intento ${r}`),await new Promise(p=>setTimeout(p,n*r))}};function VN(e){if(!Array.isArray(e))return!1;const t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n=new Date,r=t[n.getDay()],l=n.getHours().toString().padStart(2,"0")+":"+n.getMinutes().toString().padStart(2,"0"),d=e.find(p=>p.day===r);return!d||d.closed?!1:d.open<=l&&l<d.close}function xG(e){return sn({attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M100,116.43a8,8,0,0,0,4-6.93v-72A8,8,0,0,0,93.34,30,104.06,104.06,0,0,0,25.73,147a8,8,0,0,0,4.52,5.81,7.86,7.86,0,0,0,3.35.74,8,8,0,0,0,4-1.07ZM88,49.62v55.26L40.12,132.51C40,131,40,129.48,40,128A88.12,88.12,0,0,1,88,49.62ZM232,128A104,104,0,0,1,38.32,180.7a8,8,0,0,1,2.87-11L120,123.83V32a8,8,0,0,1,8-8,104.05,104.05,0,0,1,89.74,51.48c.11.16.21.32.31.49s.2.37.29.55A103.34,103.34,0,0,1,232,128Z"},child:[]}]})(e)}uo.accessToken="pk.eyJ1IjoiY29tbXVuaXRpZXM5NSIsImEiOiJjbWIxcmxpNTkwYmkxMmxvZ2g1bWE0MnVrIn0.qLTgNgjsc1Is8AEcpwaqQA";function O0e({negocios:e,coords:t}){const n=V.useRef(null),r=V.useRef(null),l=V.useRef(null),d=V.useRef(null),p=V.useRef(null),a=V.useRef(!1),b=aa(),[T,E]=V.useState(!1),[P,I]=V.useState(!1),[R,F]=V.useState([]),[W,$]=V.useState(!1),Z=ln(se=>{var me;return((me=se==null?void 0:se.ubicacion)==null?void 0:me.coords)??null}),ne=ln(se=>{var me;return(me=se==null?void 0:se.comunidadSeleccionada)==null?void 0:me.comunidad})??null,ie=(ne==null?void 0:ne.name)??"",ge=()=>window.innerWidth<1024?.8:1;V.useEffect(()=>{const se=setTimeout(()=>{$(!0);const me=setTimeout(()=>{a.current||$(!1)},4e3);return()=>clearTimeout(me)},1e3);return()=>clearTimeout(se)},[]),V.useEffect(()=>{if(!n.current||r.current)return;(async()=>{try{await D0e(`https://api.mapbox.com/styles/v1/mapbox/streets-v11?access_token=${uo.accessToken}`);const me=new uo.Map({container:n.current,style:"mapbox://styles/mapbox/streets-v11",center:[-96.797,32.7767],zoom:12,attributionControl:!1});r.current=me,me.on("load",()=>{E(!0)})}catch(me){console.error("❌ Error al cargar el mapa:",me),I(!0),E(!0)}})()},[]);const ae=Array.isArray(e)?e:[];return V.useEffect(()=>{const se=r.current;if(!se||!T)return;const me=ge(),ke=new uo.LngLatBounds;document.querySelectorAll(".emoji-pin, .marker-usuario").forEach(tt=>tt.remove());const qe=new Set;if(ae.forEach(tt=>{var It,In,Mn,vn;const nt=(In=(It=tt.location)==null?void 0:It.coordinates)==null?void 0:In.coordinates;if(!Array.isArray(nt)||nt.length!==2)return;const[bt,jt]=nt,Nt=Array.isArray(tt.categories)&&((Mn=tt.categories[0])!=null&&Mn.name)?(vn=tt.categories[0])==null?void 0:vn.name:"Sin categoría",vt=o8(Nt);qe.add(Nt);const He=tt.isPremium?40:36,ut=me*(tt.isPremium?He:He*.8),Tt=document.createElement("div");Tt.className="emoji-pin",Tt.style.position="absolute",Tt.style.zIndex="1",Tt.style.width=`${ut}px`,Tt.style.height=`${ut}px`,Tt.style.cursor="pointer";const Yt=document.createElement("div");Yt.style.width="80%",Yt.style.height="80%",Yt.style.borderRadius="50%",Yt.style.overflow="hidden",Yt.style.transition="transform 0.2s ease",Yt.style.pointerEvents="auto";const Ge=`
  <div class="w-[240px] rounded-xl shadow-2xl border border-white/10 bg-black/70 backdrop-blur-xs p-3">
    <div class="flex items-center gap-3">
      <img 
        src="${tt.profileImage||"/placeholder.png"}" 
        alt="Logo de ${tt.name}" 
        class="w-10 h-10 rounded-full object-cover border border-white/10"
      />
      <div class="flex flex-col">
        <h3 class="  text-xs font-semibold text-gray-100">${tt.name}</h3>
        <p class="text-[11px] text-gray-100 leading-tight">${Nt}</p>
      </div>
    </div>
    <div class="flex justify-between items-center mt-3">
      <a 
        href="/negocios/${tt._id}" 
        data-navigate="/negocios/${tt._id}"
        class="text-xs text-white bg-orange-500 hover:bg-orange-600 font-medium px-2 py-1 rounded transition"
      >
        Ver más
      </a>
      <div class="flex items-center gap-2 ml-2">
        ${VN(tt.openingHours)?'<span class="pulsing-dot"></span><span class="text-[11px] text-green-400">Abierto ahora</span>':'<span class="text-[11px] text-red-400">Cerrado</span>'}
      </div>
    </div>
  </div>
`,ot=new uo.Popup({offset:35,closeButton:!1}).setHTML(Ge);if(ot.on("open",()=>{const Zn=ot.getElement(),Sr=un=>{const er=un.target.closest("[data-navigate]");if(er){un.preventDefault();const hr=er.getAttribute("data-navigate");b(hr),ot.remove()}};Zn.addEventListener("click",Sr),Zn._popupClickHandler=Sr}),ot.on("close",()=>{const Zn=ot.getElement();Zn&&Zn._popupClickHandler&&(Zn.removeEventListener("click",Zn._popupClickHandler),delete Zn._popupClickHandler)}),tt.isPremium){Yt.style.backgroundColor="white",Yt.style.border=`1px solid ${vt}`,Yt.style.boxShadow="0 0 6px rgba(0, 0, 0, 0.3)";const Zn=document.createElement("img");Zn.src=tt.profileImage||"/placeholder.png",Zn.alt=`Logo de ${tt.name}`,Zn.style.width="100%",Zn.style.height="100%",Zn.style.objectFit="cover",Yt.appendChild(Zn),window.matchMedia("(min-width: 1024px)").matches&&(Tt.addEventListener("mouseenter",()=>{l.current||(Yt.style.transform="scale(3)",Tt.style.zIndex="20")}),Tt.addEventListener("mouseleave",()=>{l.current||(Yt.style.transform="scale(1)",Tt.style.zIndex="1")}))}else{const Zn=I0e(ie);Zn?(Yt.style.background=Zn,Yt.style.backgroundSize="100% 100%"):(Yt.style.backgroundColor=vt,Yt.style.border="none")}Tt.appendChild(Yt);const mt=new uo.Marker(Tt).setLngLat([bt,jt]).setPopup(ot);Tt.addEventListener("click",Zn=>{var Sr;Zn.stopPropagation(),l.current&&l.current.markerEl!==Yt&&(l.current.markerEl.style.transform="scale(1)",l.current.wrapper.style.zIndex="1",(Sr=l.current.popup)==null||Sr.remove()),ot.addTo(se),tt.isPremium&&(Yt.style.transform="scale(3)",Tt.style.zIndex="20"),l.current={markerEl:Yt,wrapper:Tt,popup:ot}}),mt.addTo(se),ke.extend([bt,jt])}),F(Array.from(qe)),Z){const tt=document.createElement("div");tt.className="marker-usuario",tt.style.width="18px",tt.style.height="18px",tt.style.backgroundColor="#3B82F6",tt.style.borderRadius="50%",tt.style.border="2px solid white",tt.style.boxShadow="0 0 6px rgba(0, 0, 0, 0.3)",new uo.Marker(tt).setLngLat([Z.lng,Z.lat]).setPopup(new uo.Popup().setText("Tu ubicación")).addTo(se),ke.extend([Z.lng,Z.lat])}ke.isEmpty()||se.fitBounds(ke,{padding:50})},[e,t,Z,T]),V.useEffect(()=>{const se=me=>{var ke,qe;W&&d.current&&!d.current.contains(me.target)&&!((ke=p.current)!=null&&ke.contains(me.target))&&$(!1),l.current&&(l.current.markerEl.style.transform="scale(1)",l.current.wrapper.style.zIndex="1",(qe=l.current.popup)==null||qe.remove(),l.current=null)};return document.addEventListener("click",se),()=>document.removeEventListener("click",se)},[W]),f.jsxs("div",{className:"relative overflow-hidden rounded-xl shadow h-full",children:[!T&&f.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center bg-white/70 backdrop-blur",children:f.jsx(wy,{})}),f.jsxs("div",{className:"absolute top-2 left-2 z-20",children:[f.jsxs("button",{ref:p,onClick:se=>{se.stopPropagation(),a.current=!0,$(me=>!me)},className:"flex items-center gap-1 bg-white text-gray-700 px-3 py-2 rounded shadow  text-xs hover:bg-gray-100",children:[f.jsx(xG,{className:"text-lg text-orange-500"}),f.jsx("p",{className:"text-xs",children:"Categorias"})]}),f.jsx(ax,{children:W&&f.jsx(Ko.div,{ref:d,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"absolute mt-2 w-max bg-black/50 backdrop-blur-sm rounded-md shadow p-3 text-xs text-white",children:R.map((se,me)=>f.jsxs(Ko.div,{className:"flex items-center gap-2 py-1",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.1*me},children:[f.jsx("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:o8(se)}}),f.jsx("span",{children:se})]},se))})})]}),!P&&f.jsx("div",{ref:n,className:"w-full h-full min-h-[500px] md:min-h-[500px] lg:min-h-0"})]})}function o8(e){switch(e){case"Gastronomía":return"#fbbf24";case"Salud y Belleza":return"#10b981";case"Deporte":return"#3b82f6";case"Comercio":return"#f9a8d4";case"Educación":return"#8b5cf6";case"Entretenimiento":return"#facc15";case"Mascotas":return"#d6a35c";case"Finanzas y Legal":return"#e5e7eb";case"Cultura":return"#7c3aed";case"Construcción":return"#00a116ff";case"Tecnología":return"#00158fff";case"Inmobiliario":return"#ff1111ff";case"Automotriz":return"#00d9ffff";case"Arte corporal":return"#ff00ffff";default:return"#9ca3af"}}function I0e(e=""){const t=String(e||"").toLowerCase().trim();return t.includes("colom")?"linear-gradient(to bottom, #FCD116 0% 50%, #0038A8 50% 75%, #CE1126 75% 100%)":t.includes("vene")?"linear-gradient(to bottom, #FCD116 0% 33.333%, #0033A0 33.333% 66.666%, #EF3340 66.666% 100%)":t.includes("peru")||t.includes("perú")?"linear-gradient(to right, #D91023 0% 33.333%, #FFFFFF 33.333% 66.666%, #D91023 66.666% 100%)":t.includes("argen")?"linear-gradient(to bottom, #74ACDF 0% 33.333%, #FFFFFF 33.333% 66.666%, #74ACDF 66.666% 100%)":t.includes("mex")||t.includes("méx")?"linear-gradient(to right, #006847 0% 33.333%, #FFFFFF 33.333% 66.666%, #CE1126 66.666% 100%)":t.includes("usa")||t.includes("estados unidos")||t.includes("united states")?"repeating-linear-gradient(to bottom, #B22234 0 10%, #FFFFFF 10% 20%)":null}function k0e(){const e=br(),{comunidad:t,negocios:n,loaded:r}=ln(a=>a.comunidadSeleccionada),l=ln(a=>a.ubicacion.coords);V.useEffect(()=>{t!=null&&t._id&&!r&&(l!=null&&l.lat)&&(l!=null&&l.lng)&&e(wM({communityId:t._id,coords:l}))},[t==null?void 0:t._id,r,l,e]);const d=n.find(a=>{var b,T,E,P;return((T=(b=a.ubicacion)==null?void 0:b.coordenadas)==null?void 0:T.lat)&&((P=(E=a.ubicacion)==null?void 0:E.coordenadas)==null?void 0:P.lng)}),p=d?{lat:d.ubicacion.coordenadas.lat,lng:d.ubicacion.coordenadas.lng}:l;return p?f.jsx("section",{className:"space-y-4 relative h-full rounded-xl shadow overflow-hidden z-0",children:f.jsx(O0e,{negocios:n,coords:p})}):f.jsx("div",{className:"w-full h-full min-h-[500px] flex items-center justify-center",children:f.jsx(wy,{})})}const R0e="/assets/bnnhome-CR6ZuErc.png";function UN(e){return sn({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M3.1.7a.5.5 0 0 1 .4-.2h9a.5.5 0 0 1 .4.2l2.976 3.974c.149.185.156.45.01.644L8.4 15.3a.5.5 0 0 1-.8 0L.1 5.3a.5.5 0 0 1 0-.6zm11.386 3.785-1.806-2.41-.776 2.413zm-3.633.004.961-2.989H4.186l.963 2.995zM5.47 5.495 8 13.366l2.532-7.876zm-1.371-.999-.78-2.422-1.818 2.425zM1.499 5.5l5.113 6.817-2.192-6.82zm7.889 6.817 5.123-6.83-2.928.002z"},child:[]}]})(e)}function yG({title:e,image:t,tipo:n,isPremium:r=!1,className:l=""}){const d=`
    rounded-2xl w-full overflow-hidden flex flex-col transition-all duration-200
    border ${r?"border-yellow-400  ":"border-gray-200"}
    ${r?"shadow-[0_0_10px_3px_rgba(234,179,8,0.4)]":"shadow-sm hover:shadow-xl"}
    ${r?"max-h-[180px] min-h-[182px] ":"aspect-square"}
    bg-white group
    ${l}
  `;return f.jsxs("div",{className:d,children:[f.jsxs("div",{className:`w-full ${r?"h-[65%]":"h-2/3"} bg-gray-100 relative`,children:[f.jsx("img",{src:t||"/placeholder.svg",alt:e,className:`object-cover w-full transition group-hover:scale-105 ${r?"h-[120px]":"h-full"}`}),r&&f.jsx("div",{className:"absolute top-2 left-2 text-yellow-400 drop-shadow",children:f.jsx(UN,{className:"text-lg"})})]}),f.jsxs("div",{className:`p-2 flex flex-col justify-between  ${r?"h-[62px] bg-black text-white":"h-1/3"}`,children:[f.jsx("h3",{className:"text-xs md:  text-xs font-medium truncate leading-tight",children:e}),f.jsx("p",{className:`text-[8px] uppercase tracking-wide ${r?"text-yellow-400":"text-gray-500"}`,children:n})]})]})}const z0e=e=>e.nombre||e.titulo||e.title||e.name||"Sin título",L0e=e=>e.imagen||e.imagenDestacada||e.featuredImage||e.bannerImage||"",F0e=e=>e.tipo||"Sin tipo",B0e=(e,t)=>{switch(e){case"negocio":return`/negocios/${t}`;case"evento":return`/eventos/${t}`;case"comunidad":return`/comunidades/${t}`;default:return"#"}},V0e={hidden:{opacity:0,y:20},visible:e=>({opacity:1,y:0,transition:{delay:e*.05,duration:.4,ease:"easeOut"}})};function U0e({resultados:e=[]}){return e.length?f.jsxs("section",{className:"w-full max-w-7xl mx-auto flex flex-col gap-4 ",children:[f.jsx("h2",{className:" text-lg font-semibold text-gray-800",children:"🔍 Resultados de tu búsqueda"}),f.jsx("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(120px,1fr))] sm:grid-cols-[repeat(auto-fit,minmax(180px,180px))] md:grid-cols-[repeat(auto-fit,minmax(180px,180px))]  gap-4",children:e.map((t,n)=>f.jsx(Ko.div,{custom:n,initial:"hidden",animate:"visible",variants:V0e,className:t.isPremium?"col-span-2 ":"",children:f.jsx(Wn,{to:B0e(t.tipo,t.id||t._id),className:"",children:f.jsx(yG,{title:z0e(t),image:L0e(t),tipo:F0e(t),isPremium:t.isPremium})})},t.id||t._id))})]}):null}function $0e(){const e=V.useRef(null),[t,n]=V.useState(!1),[r,l]=V.useState("map"),d=ln(R=>R.negocios.lista),p=ln(R=>R.negocios.loading),a=ln(R=>R.eventos.lista),b=ln(R=>R.eventos.loading),T=ln(R=>R.busquedaGlobal.resultados),E=ln(R=>R.comunidades.lista),P=ln(R=>R.comunidades.loading),I=ln(R=>R.comunidadSeleccionada.comunidad);return f.jsxs("div",{className:"flex flex-col gap-12 md:gap-16 xl:gap-24 md:mt-12",children:[f.jsxs(Oa,{children:[f.jsx("title",{children:"Communidades | Inicio"}),f.jsx("meta",{name:"description",content:"Explora negocios, eventos y servicios útiles para comunidades migrantes en tu ciudad."})]}),f.jsxs("div",{className:"relative flex flex-col lg:flex-row gap-4 min-h-[500px]",children:[f.jsx("div",{onFocus:()=>l("map"),className:`
            transition-all duration-500 ease-in-out w-full
            ${r==="map"?"block":"hidden"}
            sm:block
            ${r==="map"?"lg:w-[75%]":"lg:w-[25%]"}
          `,children:f.jsx(k0e,{})}),f.jsx("div",{onFocus:()=>l("search"),className:`
            transition-all duration-500 ease-in-out w-full
            ${r==="search"?"block":"hidden"}
            sm:block
            ${r==="search"?"lg:w-[75%]":"lg:w-[25%]"}
          `,children:f.jsx(j0e,{onResultadosRef:e,onResaltar:()=>{n(!0),setTimeout(()=>n(!1),1e3)}})})]}),T&&T.length>0&&f.jsx("div",{ref:e,className:`w-full px-4 sm:px-6 lg:px-8 xl:px-10 max-w-screen-xl mx-auto flex flex-col gap-8 py-10
      transition-all duration-500
      ${t?"md:ring-4 ring-sky-300/60 rounded-xl":""}
      pt-[80px] -mt-[80px] scroll-mt-[180px]
    `,children:f.jsx(U0e,{resultados:T})}),I?f.jsx("div",{className:"w-full max-w-5xl mx-auto px-4 mt-6 text-center",children:f.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-yellow-50 p-4 rounded-xl shadow  text-xs text-gray-800 font-semibold",children:["👋 Estás explorando la comunidad"," ",f.jsx("span",{className:"text-sky-600",children:I.name}),". ¡Todo lo que ves ahora está pensado para vos!"]})}):f.jsx("div",{className:"w-full max-w-5xl mx-auto px-4 mt-6 text-center",children:f.jsx("div",{className:"bg-gradient-to-r from-yellow-50 to-purple-50 p-4 rounded-xl shadow  text-xs text-gray-700 font-medium",children:"🌍 Aún no seleccionaste una comunidad. Elegí la que más te represente para ver contenido relevante."})}),f.jsx("div",{className:"sm:hidden mb-4 px-2 w-full",children:f.jsxs("div",{className:"relative flex bg-orange-50 rounded-lg p-1",children:[f.jsx("span",{className:`absolute inset-y-0 left-0 w-1/2 bg-orange-500 rounded-md transition-transform duration-300 ease-in-out ${r==="search"?"translate-x-full":"translate-x-0"}`}),f.jsx("button",{onClick:()=>l("map"),className:`flex-1 z-10 text-center py-2  text-xs font-semibold rounded-md transition-colors duration-200 ${r==="map"?"text-white":"text-orange-600"}`,children:"Mapa"}),f.jsx("button",{onClick:()=>l("search"),className:`flex-1 z-10 text-center py-2  text-xs font-semibold rounded-md transition-colors duration-200 ${r==="search"?"text-white":"text-orange-600"}`,children:"Buscador"})]})}),f.jsxs("div",{className:"flex flex-col gap-12 md:gap-16 xl:gap-24 mt-12",children:[f.jsx(hG,{negocios:d,loading:p}),f.jsx(fG,{eventos:a,loading:b}),f.jsx(pG,{comunidades:E,loading:P}),f.jsx("div",{className:"w-full hidden sm:flex justify-center px-4 py-10",children:f.jsx("img",{src:R0e,alt:"Banner negocios",className:" inset-0 w-full h-full object-cover"})})]})]})}const Kc="/assets/ilust2-D9T8tYsc.svg";function q0e(e){return sn({attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},child:[]}]})(e)}function H0e(e){return sn({attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},child:[]}]})(e)}function vG(e){return sn({attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"},child:[]}]})(e)}function G0e(e){return sn({attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"},child:[]},{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"},child:[]}]})(e)}function $N(e){return sn({attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"},child:[]}]})(e)}function W0e(e){return sn({attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"},child:[]}]})(e)}function Bw(e){return sn({attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},child:[]}]})(e)}function qN({title:e,image:t,isVerified:n=!1,isNew:r=!1,hasDiscount:l=!1,descuento:d="",logo:p,category:a,location:b,isPremium:T=!1}){const E=!!t;return f.jsxs("div",{className:`relative flex flex-col rounded-2xl overflow-hidden transition duration-300 group
        bg-white border hover:shadow-2xl
        ${T?"border-yellow-400 shadow-[0_0_15px_rgba(234,179,8,0.5)]":"border-gray-200 shadow-md"}`,children:[f.jsxs("div",{className:"relative w-full h-48 bg-gray-200 overflow-hidden",children:[E?f.jsx("div",{className:"w-full h-full bg-cover bg-center transform transition-transform duration-500 group-hover:scale-110",style:{backgroundImage:`url(${t})`}}):f.jsx(LN,{size:36}),f.jsx("div",{className:"absolute inset-0 bg-black/10 opacity-0 group-hover:opacity-100 transition duration-300"}),f.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-16 bg-gradient-to-t from-black/40 to-transparent"}),f.jsxs("div",{className:"absolute top-2 left-2 flex gap-1",children:[l&&f.jsx(uG,{value:d}),r&&f.jsx(dG,{})]}),a&&f.jsx("div",{className:`absolute top-2 right-2 px-2 py-0.5 rounded-full text-xs font-semibold shadow-sm
      ${T?"bg-orange-500 text-white":"bg-white text-gray-800"}`,children:a}),f.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 duration-300 transition",children:f.jsx("button",{className:"bg-orange-500 text-white text-xs px-3 py-1 rounded-full transition",children:"Ver más"})}),p&&f.jsx("div",{className:`absolute bottom-2 right-2 rounded-full border border-white shadow-md bg-white overflow-hidden
      ${T?"w-16 h-16":"w-10 h-10"}`,children:f.jsx("div",{className:"w-full h-full bg-cover bg-center",style:{backgroundImage:`url("${p}")`}})})]}),f.jsxs("div",{className:`flex flex-col gap-0.5 px-2 py-2 justify-between flex-1 min-h-[70px] max-h-[70px] relative
    ${T?"bg-black text-white":""}`,children:[f.jsx("div",{className:"flex items-center gap-1",children:f.jsx("h3",{className:`\r
         text-xs font-semibold tracking-tight leading-tight\r
        overflow-hidden text-ellipsis\r
        [display:-webkit-box] [-webkit-line-clamp:2] [-webkit-box-orient:vertical]\r
      `,style:{letterSpacing:"0.02em"},children:e})}),b&&f.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[f.jsx(G0e,{className:`w-4 h-4 flex-shrink-0 ${T?"text-white":"text-gray-500"}`}),f.jsx("p",{className:"text-xs font-medium tracking-wide truncate",style:{letterSpacing:"0.02em"},children:b.replace(/,\s*\d+$/,"").replace(/\s\d+$/,"").replace(/,\s*$/,"").trim()})]}),T&&f.jsx("div",{className:"absolute bottom-2 right-2  rounded-full p-1 text-yellow-500 shadow-md",children:f.jsx(R$,{className:"w-6 h-6"})})]})]})}const HN=V.forwardRef(({children:e,className:t="",tipo:n="grid"},r)=>{const l=n==="lista"?"flex flex-col gap-4":["grid","items-start","grid-cols-2","md:grid-cols-3","xl:grid-cols-4","gap-y-8 gap-x-4 xl:gap-x-6","w-full","max-h-fit"].join(" ");return f.jsx("div",{ref:r,className:`${l} ${t}`,children:e})});function _G({tipo:e="negocios"}){const t=br(),n=ln(p=>e==="eventos"?p.eventos.categoria:p.negocios.categoria),r=ln(p=>p.categorias.data),l=ln(p=>p.categorias.loading);V.useEffect(()=>{t(Em())},[t]);const d=p=>{e==="eventos"?(t(Xre(p)),t(Kg(p==="todas"?{page:1}:{all:!0}))):(t(Bre(p)),t(Yf(p==="todas"?{page:1}:{all:!0})))};return f.jsxs("div",{className:"mt-4",children:[f.jsx("h3",{className:"text-[#181411] text-lg font-bold px-4 pb-2 pt-4",children:"Categorías"}),l?f.jsx("p",{className:"px-4",children:"Cargando categorías..."}):f.jsxs(f.Fragment,{children:[f.jsx(M_,{children:r.map(p=>{const a=(p.valor||p.name).toLowerCase(),b=n.toLowerCase()===a;return f.jsxs("button",{onClick:()=>d(a),className:`group flex flex-col gap-2 flex-shrink-0 snap-start p-2 cursor-pointer
                    w-[40vw] aspect-square md:w-[205px]
                    rounded-2xl text-left ring-offset-6 transition
${b?"border-4 border-[#f4c753]":"border border-transparent"}
                  `,children:[f.jsx("div",{className:"w-full h-full rounded-xl flex items-center justify-center bg-gray-100 overflow-hidden",style:p.icon?{backgroundImage:`url("${p.icon}")`,backgroundSize:"cover",backgroundPosition:"center"}:{},children:!p.icon&&f.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:`M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10\r
                            10-4.48 10-10S17.52 2 12 2zm0 18c-1.85 0-3.55-.63-4.9-1.69.01-2.5 3.27-3.88 4.9-3.88\r
                            1.63 0 4.89 1.38 4.9 3.88C15.55 19.37 13.85 20 12 20zm0-8a3 3 0 100-6 3 3 0 000 6z`})})}),f.jsx("p",{className:"line-clamp-2 text-[#181411]  text-xs font-medium leading-tight mt-1 transition-colors duration-200 ",children:p.name})]},p._id)})}),f.jsx("div",{className:"px-4 pt-3",children:f.jsx("button",{onClick:()=>d("todas"),className:"mt-4 inline-block bg-white text-[#181411] font-semibold  text-xs md:text-sm px-4 py-2 border border-gray-300 rounded-lg shadow-md hover:bg-orange-500 hover:text-white transition-colors duration-200",children:"Todas las categorías"})})]})]})}const Z0e="/assets/negociosbanner-DnfGhO-b.jpg";function X0e({scrollToRef:e}){const t=()=>{var n;(n=e==null?void 0:e.current)==null||n.scrollIntoView({behavior:"smooth"})};return f.jsx("div",{className:"flex justify-center",children:f.jsxs("div",{className:"w-full rounded-xl overflow-hidden relative",children:[f.jsx("img",{src:Z0e,alt:"Banner negocios",className:"absolute inset-0 w-full h-full object-cover"}),f.jsx("div",{className:"relative z-10 flex flex-col gap-6 sm:gap-8 min-h-[300px] items-start justify-end p-6 sm:p-10 text-white",children:f.jsx("button",{onClick:t,className:"bg-[#fff] hover:shadow-xl transition text-black  text-xs sm:text-base font-bold px-5 py-2 sm:py-3 rounded-full",children:"Explorar negocios"})})]})})}function GN({totalPages:e,currentPage:t,onPageChange:n,gridRef:r}){if(e<=1)return null;const l=()=>{r!=null&&r.current&&r.current.scrollIntoView({behavior:"smooth",block:"start"})},d=()=>{t>1&&(n(t-1),l())},p=()=>{t<e&&(n(t+1),l())},a=b=>{n(b),l()};return f.jsx("footer",{className:"flex justify-center mt-12",children:f.jsx("div",{className:"flex max-w-[960px] w-full flex-col",children:f.jsxs("div",{className:"flex items-center justify-center gap-2 flex-wrap",children:[f.jsx("button",{onClick:d,disabled:t===1,className:`flex size-10 items-center justify-center rounded-full border transition duration-200 ${t===1?"text-gray-300 border-gray-200 cursor-not-allowed bg-gray-50":"text-gray-700 border-gray-300 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-300"}`,children:f.jsx(Ece,{className:"w-4 h-4"})}),Array.from({length:e},(b,T)=>{const E=T+1,P=t===E;return f.jsx("button",{onClick:()=>a(E),className:`  text-xs size-10 flex items-center justify-center rounded-full border font-medium transition duration-200 ${P?"bg-black text-white border-black":"text-gray-700 border-gray-300 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-300"}`,children:E},E)}),f.jsx("button",{onClick:p,disabled:t===e,className:`flex size-10 items-center justify-center rounded-full border transition duration-200 ${t===e?"text-gray-300 border-gray-200 cursor-not-allowed bg-gray-50":"text-gray-700 border-gray-300 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-300"}`,children:f.jsx(Ace,{className:"w-4 h-4"})})]})})})}const K0e=e=>e.imagen||e.imagenDestacada||e.featuredImage||e.bannerImage||"",Y0e=e=>e.nombre||e.titulo||e.title||e.name||"Sin título",Q0e=e=>e.tipo||"Sin tipo",J0e=(e,t)=>{switch(e){case"negocio":return`/negocios/${t}`;case"evento":return`/eventos/${t}`;case"comunidad":return`/comunidades/${t}`;default:return"#"}},eye={hidden:{opacity:0,y:20},visible:e=>({opacity:1,y:0,transition:{delay:e*.05,duration:.4,ease:"easeOut"}})};function WN({placeholder:e="Buscar...",filtroTipo:t=null,onSelectResultado:n=null}){const r=br(),{resultados:l,loading:d,error:p}=ln(R=>R.busquedaGlobal),[a,b]=V.useState(""),T=V.useRef(null),E=()=>{const R=a.trim();R?r(jb(R)).then(()=>{var F;(F=T.current)==null||F.scrollIntoView({behavior:"smooth"})}):r(Qb())},P=()=>{b(""),r(Qb())},I=t?l.filter(R=>R.tipo===t):l;return f.jsxs("div",{className:"w-full flex flex-col gap-6",children:[f.jsx(mG,{value:a,onChange:b,onBuscar:E,onLimpiar:P,placeholder:e}),I.length>0&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"min-h-[20vh]",children:[d&&f.jsx("p",{className:"text-gray-500",children:"Buscando..."}),p&&f.jsxs("p",{className:"text-red-500",children:["Error: ",p]}),!d&&I.length===0&&a&&f.jsx("p",{className:"text-gray-500",children:"No se encontraron resultados."}),f.jsx(Ko.div,{ref:T,className:"grid grid-cols-[repeat(auto-fit,minmax(120px,1fr))] sm:grid-cols-[repeat(auto-fit,minmax(180px,180px))] md:grid-cols-[repeat(auto-fit,minmax(180px,180px))] gap-4 max-w-7xl mx-auto mt-10",initial:"hidden",animate:"visible",children:I.map((R,F)=>{const W=J0e(R.tipo,R._id||R.id);return f.jsx(Ko.div,{custom:F,variants:eye,className:`cursor-pointer flex flex-col items-center justify-center ${R.isPremium?"col-span-2":""}`,onClick:()=>n==null?void 0:n(R),children:f.jsx(Wn,{to:W,className:"w-full flex justify-center",children:f.jsx(yG,{title:Y0e(R),image:K0e(R),tipo:Q0e(R),isPremium:R.isPremium})})},R._id||R.id)})})]}),f.jsx("div",{className:"w-full border-t border-gray-200 mt-12"}),f.jsx("div",{className:"flex justify-center",children:f.jsx("button",{onClick:P,className:"mt-4 px-6 py-2 rounded-2xl bg-gray-200 text-gray-700 hover:bg-gray-300  text-xs transition",children:"Limpiar búsqueda"})})]})]})}function ZN(){const e=br();return V.useEffect(()=>{e(Qb())},[e]),null}function XN(){return f.jsxs("div",{className:"animate-pulse bg-gray-100 rounded-xl w-full h-[240px] flex flex-col overflow-hidden",children:[f.jsx("div",{className:"bg-gray-300 h-[170px] w-full"}),f.jsxs("div",{className:"flex-1 flex flex-col gap-2 p-4",children:[f.jsx("div",{className:"h-4 bg-gray-300 rounded w-3/4"}),f.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3 mt-auto"})]})]})}function tye(){const e=br(),t=V.useRef(null),{coords:n}=ln(R=>R.ubicacion),{lista:r,loading:l,error:d,currentPage:p,totalPages:a,categoria:b,busqueda:T,loaded:E}=ln(R=>R.negocios);V.useEffect(()=>{n&&!E&&e(Yf({page:1,lat:n.lat,lng:n.lng}))},[e,n,E]);const P=R=>{n&&e(Yf({page:R,lat:n.lat,lng:n.lng}))},I=b==="todas"?r:r.filter(R=>{var F;return(F=R.categories)==null?void 0:F.some(W=>(W.name||"").toLowerCase()===b.toLowerCase())});return f.jsxs("div",{className:"flex flex-col gap-12 md:gap-16 xl:gap-24 mt-12",children:[f.jsx(ZN,{}),f.jsxs(Oa,{children:[f.jsx("title",{children:"Communidades | Negocios"}),f.jsx("meta",{name:"description",content:"Explora negocios y servicios dentro de tu comunidad migrante."})]}),f.jsxs("div",{className:"w-full max-w-full overflow-hidden flex flex-col gap-12 md:gap-16 xl:gap-24",children:[f.jsxs("div",{className:"flex flex-col gap-12 md:gap-16 xl:gap-24",children:[f.jsx(hG,{}),f.jsxs("div",{children:[f.jsx("h4",{className:" text-lg md: text-lg font-bold text-black tracking-tight leading-snug my-4",children:"Busca los negocios que te conectan con tu comunidad"}),f.jsx(WN,{placeholder:"Buscar negocios...",filtroTipo:"negocio",onSelectResultado:R=>c_(`/negocios/${R._id||R.id}`)})]}),f.jsx(_G,{})]}),f.jsx("div",{className:"min-h-[70vh]",children:f.jsx(HN,{ref:t,tipo:"grid",children:l?Array.from({length:15}).map((R,F)=>f.jsx(XN,{},F)):I.length>0?I.map(R=>{var F;return f.jsx(Wn,{to:`/negocios/${R._id}`,className:`flex-shrink-0 ${R.isPremium?"col-span-2":""}`,children:f.jsx(qN,{isPremium:R.isPremium,title:R.name,image:R.featuredImage,isVerified:R.isVerified,isNew:!1,hasDiscount:!1,descuento:"",logo:R.profileImage,category:(F=R.categories[0])==null?void 0:F.name,location:`${R.location.city}, ${R.country||""}`})},R._id)}):f.jsx("div",{className:"col-span-full flex justify-center py-16 w-full",children:f.jsxs("div",{className:"flex flex-col items-center text-center gap-5 max-w-sm w-full px-4",children:[f.jsx("img",{src:Kc,alt:"Sin negocios",className:"w-32 md:w-60 xl:w-120 opacity-90"}),f.jsxs("p",{className:"text-gray-600  text-xs md:text-base xl: text-lg",children:["Ups... no encontramos ningún negocio en esta categoría dentro de tu comunidad.",f.jsx("br",{}),"Quizás aún nadie ha dado el primer paso."]}),f.jsx(Wn,{to:"/dashboard/mis-negocios/crear",className:"inline-block shadow-2xl bg-orange-500 hover:bg-orange-600 text-white  text-xs font-medium px-4 py-2 xl: text-lg rounded-2xl transition",children:"¿Tienes una buena idea para esta categoría? Publícala aquí"})]})})})}),!l&&I.length>0&&f.jsx(GN,{totalPages:a||1,currentPage:p||1,onPageChange:P,gridRef:t}),f.jsx(X0e,{scrollToRef:t})]})]})}const nye="/assets/comunidadbanner-DTd4_OXX.png";function rye({scrollToRef:e}){const t=()=>{var n;(n=e==null?void 0:e.current)==null||n.scrollIntoView({behavior:"smooth",block:"start"})};return f.jsx("div",{className:"flex justify-center",children:f.jsxs("div",{className:"w-full rounded-xl overflow-hidden relative h-[300px]  md:h-[300px]",children:[f.jsx("img",{src:nye,alt:"Banner eventos",className:"absolute inset-0 w-full h-full object-cover"}),f.jsx("div",{className:"relative z-10 flex flex-col gap-6 sm:gap-8 h-full items-start justify-end p-6 sm:p-10 text-white",children:f.jsx("button",{onClick:t,className:"bg-[#f45525] hover:bg-[#e64a1d] transition text-white  text-xs sm:text-base font-bold px-5 py-2 sm:py-3 rounded-full",children:"Ver eventos"})})]})})}function iye(){const e=br(),t=V.useRef(null),{coords:n}=ln(P=>P.ubicacion),{lista:r,loading:l,error:d,paginaActual:p,totalPaginas:a,busqueda:b,categoria:T}=ln(P=>P.eventos);V.useEffect(()=>{n!=null&&n.lat&&(n!=null&&n.lng)&&e(Kg({page:p,limit:12,lat:n.lat,lng:n.lng}))},[e,p,n]),V.useEffect(()=>{e(f6(1))},[b,e]);const E=T==="todas"?r:r.filter(P=>{var I;return(I=P.categories)==null?void 0:I.some(R=>(R.name||"").toLowerCase()===T.toLowerCase())});return f.jsxs("div",{className:"flex flex-col gap-12 md:gap-16 xl:gap-24 mt-12",children:[f.jsx(ZN,{}),f.jsxs(Oa,{children:[f.jsx("title",{children:"Communidades | Eventos"}),f.jsx("meta",{name:"description",content:"Consulta eventos culturales y comunitarios relevantes para migrantes."})]}),f.jsxs("div",{className:"w-full max-w-full overflow-hidden flex flex-col gap-12 md:gap-16 xl:gap-24",children:[f.jsxs("div",{className:"flex flex-col gap-12 md:gap-16 xl:gap-24",children:[f.jsx(fG,{}),f.jsxs("div",{children:[f.jsx("h4",{className:" text-lg md: text-lg font-bold text-black tracking-tight leading-snug my-4",children:"Descubre eventos que enriquecen tu conexión cultural"}),f.jsx(WN,{placeholder:"Buscar eventos...",filtroTipo:"evento",onSelectResultado:P=>c_(`/eventos/${P._id||P.id}`)})]}),f.jsx(_G,{tipo:"eventos"})]}),f.jsx("div",{className:"min-h-[70vh]",children:f.jsx(HN,{ref:t,tipo:"grid",children:l?Array.from({length:12}).map((P,I)=>f.jsx(XN,{},I)):E.length>0?E.map(P=>{const{_id:I,title:R,description:F,featuredImage:W,isNew:$=!1,isVerified:Z=!1}=P;return f.jsx(Wn,{to:`/eventos/${I}`,className:"flex-shrink-0",children:f.jsx(qN,{title:R,description:(F==null?void 0:F.length)>90?F.slice(0,90)+"...":F||"Sin descripción",image:W||"",isNew:$,hasDiscount:!1,isVerified:Z})},I)}):f.jsx("div",{className:"col-span-full flex justify-center py-16 w-full",children:f.jsxs("div",{className:"flex flex-col items-center text-center gap-5 max-w-sm w-full px-4",children:[f.jsx("img",{src:Kc,alt:"Sin eventos",className:"w-32 md:w-60 xl:w-120 opacity-90"}),f.jsxs("p",{className:"text-gray-600  text-xs md:text-base xl: text-lg",children:["Ups... no encontramos ningún evento en esta categoría dentro de tu comunidad.",f.jsx("br",{}),"Quizás aún nadie lo ha organizado."]}),f.jsx(Wn,{to:"/dashboard/mis-eventos/crear",className:"inline-block shadow-2xl bg-orange-500 hover:bg-orange-600 text-white  text-xs font-medium px-4 py-2 xl: text-lg rounded-2xl transition",children:"¿Tienes una idea de evento? Publícalo aquí"})]})})})}),!l&&E.length>0&&f.jsx(GN,{totalPages:a,currentPage:p,onPageChange:P=>e(f6(P)),gridRef:t}),f.jsx(rye,{scrollToRef:t})]})]})}const aye="/assets/eventosbanner-Bz-pE_tn.png";function sye({scrollToRef:e}){return f.jsx("div",{className:"w-full",children:f.jsxs("div",{className:"relative w-full rounded-xl overflow-hidden h-[250px]  md:h-[300px]",children:[f.jsx("img",{src:aye,alt:"Banner comunidades",className:"absolute inset-0 w-full h-full object-cover"}),f.jsx("div",{className:"absolute inset-0 bg-black/10 z-10"})]})})}function oye(){const e=br(),t=aa(),n=V.useRef(null),{lista:r,loadingLista:l,error:d,busqueda:p,totalPages:a,currentPage:b}=ln(I=>I.comunidades)||{},{coords:T}=ln(I=>I.ubicacion)||{},E=V.useMemo(()=>{if(Array.isArray(r))return r;if(Array.isArray(r==null?void 0:r.data))return r.data;if(r&&typeof r=="object"){const I=Object.values(r).find(R=>Array.isArray(R));if(Array.isArray(I))return I}return[]},[r]);V.useEffect(()=>{T&&e(zd({lat:T.lat,lng:T.lng,page:1}))},[e,T]),V.useEffect(()=>{T&&e(zd({lat:T.lat,lng:T.lng,page:1}))},[e,T,p]);const P=I=>{T&&e(zd({lat:T.lat,lng:T.lng,page:I}))};return d?f.jsxs("div",{className:"p-4 text-red-600",children:["Error: ",String(d)]}):f.jsxs("div",{className:"flex flex-col gap-12 md:gap-16 xl:gap-24 mt-12",children:[f.jsx(ZN,{}),f.jsxs(Oa,{children:[f.jsx("title",{children:"Communidades | Comunidades"}),f.jsx("meta",{name:"description",content:"Explora comunidades migrantes con negocios, eventos y servicios propios."})]}),f.jsxs("div",{className:"flex flex-col gap-12 md:gap-16 xl:gap-24",children:[f.jsx(pG,{}),f.jsxs("div",{children:[f.jsx("h4",{className:" text-lg sm:text-2xl font-bold text-black tracking-tight leading-snug my-4",children:"Buscá tu comunidad de origen o afinidad"}),f.jsx(WN,{placeholder:"Buscar tu comunidad...",filtroTipo:"comunidad",onSelectResultado:I=>t(`/comunidades/${(I==null?void 0:I._id)||(I==null?void 0:I.id)}`)})]})]}),f.jsx(HN,{ref:n,tipo:"grid",className:"min-h-[30vh] md:min-h-[130vh] flex-grow",children:l?Array.from({length:12}).map((I,R)=>f.jsx(XN,{},R)):E.length>0?E.map(I=>{if(!I)return null;const R=I.id||I._id,F=I.name||"Comunidad",W=I.description||"",$=I.bannerImage||I.flagImage,Z=I.flagImage,ne=!!I.isVerified;return f.jsx(Wn,{to:`/comunidades/${R}`,className:"flex-shrink-0",children:f.jsx(qN,{title:F,description:W,image:$,isVerified:ne,logo:Z})},R)}):f.jsx("p",{className:"text-gray-500 w-full text-center",children:"No se encontraron comunidades."})}),!l&&E.length>0&&f.jsx(GN,{totalPages:a||1,currentPage:b||1,onPageChange:P,gridRef:n}),f.jsx(sye,{scrollToRef:n})]})}function KN({url:e,title:t="Mirá esto en Communidades",text:n=""}){const[r,l]=V.useState(!1),d=async()=>{try{await navigator.clipboard.writeText(e),l(!0),setTimeout(()=>l(!1),2e3)}catch(E){console.error("No se pudo copiar el enlace",E)}},p=async()=>{if(navigator.share)try{await navigator.share({title:t,text:n||t,url:e})}catch(E){console.error("Error usando Web Share API:",E)}},a=encodeURIComponent(e),b=encodeURIComponent(t),T=typeof window<"u"&&navigator.share;return f.jsxs("div",{className:"w-full bg-white ",children:[f.jsxs("h2",{className:"text-gray-900 text-base sm:text-lg font-semibold mb-4",children:["Compartilo con alguien — juntos creamos comunidad"," "]}),f.jsxs("div",{className:"flex flex-wrap items-center gap-3  text-lg sm:text-2xl",children:[T?f.jsx("button",{onClick:p,className:"rounded-full p-3 bg-gray-100 hover:bg-gray-200 text-gray-600 hover:text-black transition",title:"Compartir desde tu dispositivo",children:f.jsx(U$,{})}):f.jsxs(f.Fragment,{children:[f.jsx("a",{href:`https://www.facebook.com/sharer/sharer.php?u=${a}`,target:"_blank",rel:"noopener noreferrer",className:"rounded-full p-3 bg-blue-100 hover:bg-blue-200 text-blue-600 hover:text-blue-800 transition",title:"Compartir en Facebook",children:f.jsx(vce,{})}),f.jsx("a",{href:`https://wa.me/?text=${b}%20${a}`,target:"_blank",rel:"noopener noreferrer",className:"rounded-full p-3 bg-green-100 hover:bg-green-200 text-green-600 hover:text-green-800 transition",title:"Compartir en WhatsApp",children:f.jsx(c3,{})}),f.jsx("a",{href:`https://twitter.com/intent/tweet?url=${a}&text=${b}`,target:"_blank",rel:"noopener noreferrer",className:"rounded-full p-3 bg-sky-100 hover:bg-sky-200 text-sky-600 hover:text-sky-800 transition",title:"Compartir en X",children:f.jsx($P,{})})]}),f.jsx("button",{onClick:d,className:"rounded-full p-3 bg-gray-100 hover:bg-gray-200 text-gray-600 hover:text-black transition",title:"Copiar enlace",children:f.jsx(Oce,{})}),r&&f.jsx("span",{className:"  text-xs text-green-600 font-medium ml-1 animate-fade-in",children:"¡Enlace copiado!"})]})]})}uo.accessToken="pk.eyJ1IjoiY29tbXVuaXRpZXM5NSIsImEiOiJjbWIxcmxpNTkwYmkxMmxvZ2g1bWE0MnVrIn0.qLTgNgjsc1Is8AEcpwaqQA";function lye(){const e=V.useRef(null),t=V.useRef(null),n=V.useRef(null),r=V.useRef(null),l=V.useRef(null),d=V.useRef(!1),{id:p}=Ec(),a=ln(se=>se.ubicacion.coords),[b,T]=V.useState([]),[E,P]=V.useState(!0),[I,R]=V.useState(!1),[F,W]=V.useState(null),[$,Z]=V.useState(!1),[ne,ie]=V.useState([]);V.useEffect(()=>{navigator.geolocation.getCurrentPosition(se=>{W([se.coords.longitude,se.coords.latitude])},se=>{W([-96.797,32.7767])},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})},[]);const ge=b.find(se=>{var me,ke,qe,tt;return((ke=(me=se.ubicacion)==null?void 0:me.coordenadas)==null?void 0:ke.lat)&&((tt=(qe=se.ubicacion)==null?void 0:qe.coordenadas)==null?void 0:tt.lng)}),ae=ge?{lat:ge.ubicacion.coordenadas.lat,lng:ge.ubicacion.coordenadas.lng}:a;return V.useEffect(()=>{if(!p)return;(async()=>{try{P(!0);const me=await AP(p,ae);T(me||[])}catch(me){console.error("Error al cargar negocios del mapa:",me)}finally{P(!1)}})()},[p]),V.useEffect(()=>{const se=setTimeout(()=>{Z(!0);const me=setTimeout(()=>{d.current||Z(!1)},4e3);return()=>clearTimeout(me)},1e3);return()=>clearTimeout(se)},[]),V.useEffect(()=>{var qe,tt,nt,bt;if(!e.current)return;t.current&&(t.current.remove(),t.current=null);const se=Array.isArray(b)&&((nt=(tt=(qe=b[0])==null?void 0:qe.location)==null?void 0:tt.coordinates)!=null&&nt.coordinates)?(bt=b[0])==null?void 0:bt.location.coordinates.coordinates:null,me=(se==null?void 0:se.length)===2?se:F||[-74.006,40.7128],ke=new uo.Map({container:e.current,style:"mapbox://styles/mapbox/streets-v11",center:me,zoom:12,attributionControl:!1});return t.current=ke,ke.on("load",()=>{R(!0);const jt=new uo.LngLatBounds;document.querySelectorAll(".emoji-pin, .marker-usuario").forEach(vt=>vt.remove());const Nt=new Set;if(b.forEach(vt=>{var vn,Zn,Sr;const He=(Zn=(vn=vt.location)==null?void 0:vn.coordinates)==null?void 0:Zn.coordinates;if(!Array.isArray(He)||He.length!==2)return;const[ut,Tt]=He,Yt=Array.isArray(vt.categories)&&((Sr=vt.categories[0])!=null&&Sr.name)?vt.categories[0].name:"Sin categoría",Ge=l8(Yt);Nt.add(Yt);const ot=vt.isPremium?40:25,mt=document.createElement("div");mt.className="emoji-pin",mt.style.position="absolute",mt.style.zIndex="1",mt.style.width=`${ot}px`,mt.style.height=`${ot}px`,mt.style.cursor="pointer";const It=document.createElement("div");It.style.width="70%",It.style.height="70%",It.style.borderRadius="50%",It.style.overflow="hidden",It.style.transition="transform 0.2s ease",It.style.pointerEvents="auto";const In=new uo.Popup({offset:35,closeButton:!1}).setHTML(`
        <div class="w-[240px] rounded-xl shadow-2xl  border border-white/10 bg-black/70 backdrop-blur-xs p-3">
          <div class="flex items-center gap-3">
            <img 
              src="${vt.profileImage||"/placeholder.png"}" 
              alt="Logo de ${vt.name}" 
              class="w-10 h-10 rounded-full object-cover border border-white/10"
            />
            <div class="flex flex-col">
              <h3 class="  text-xs font-semibold text-gray-100">${vt.name}</h3>
              <p class="text-[11px] text-gray-100 leading-tight">${Yt}</p>
            </div>
          </div>
          <div class="flex justify-between items-center mt-3">
            <a href="/negocios/${vt._id}" class="text-xs text-white bg-orange-500 hover:bg-orange-600 font-medium px-2 py-1 rounded transition">
              Ver más
            </a>
            <div class="flex items-center gap-2 ml-2">
              ${VN(vt.openingHours)?'<span class="pulsing-dot"></span><span class="text-[11px] text-green-400">Abierto ahora</span>':'<span class="text-[11px] text-red-400">Cerrado</span>'}
            </div>
          </div>
        </div>
      `);if(vt.isPremium){It.style.backgroundColor="white",It.style.border=`1px solid ${Ge}`;const un=document.createElement("img");un.src=vt.profileImage||"/placeholder.png",un.alt=`Logo de ${vt.name}`,un.style.width="100%",un.style.height="100%",un.style.objectFit="cover",It.appendChild(un),window.matchMedia("(min-width: 1024px)").matches&&(mt.addEventListener("mouseenter",()=>{n.current||(It.style.transform="scale(3)",mt.style.zIndex="20")}),mt.addEventListener("mouseleave",()=>{n.current||(It.style.transform="scale(1)",mt.style.zIndex="1")}))}else It.style.backgroundColor=Ge;mt.appendChild(It);const Mn=new uo.Marker(mt).setLngLat([ut,Tt]).setPopup(In);mt.addEventListener("click",un=>{var er;un.stopPropagation(),n.current&&n.current.markerEl!==It&&(n.current.markerEl.style.transform="scale(1)",n.current.wrapper.style.zIndex="1",(er=n.current.popup)==null||er.remove()),In.addTo(ke),vt.isPremium&&(It.style.transform="scale(3)",mt.style.zIndex="20"),n.current={markerEl:It,wrapper:mt,popup:In}}),Mn.addTo(ke),jt.extend([ut,Tt])}),ie(Array.from(Nt)),F){const vt=document.createElement("div");vt.className="marker-usuario",vt.style.width="18px",vt.style.height="18px",vt.style.backgroundColor="#3B82F6",vt.style.borderRadius="50%",vt.style.border="2px solid white",vt.style.boxShadow="0 0 6px rgba(0, 0, 0, 0.3)",new uo.Marker(vt).setLngLat(F).setPopup(new uo.Popup().setText("Tu ubicación")).addTo(ke),jt.extend(F)}jt.isEmpty()||ke.fitBounds(jt,{padding:50})}),()=>{ke.remove(),t.current=null}},[b,F]),V.useEffect(()=>{const se=me=>{var ke,qe;$&&r.current&&!r.current.contains(me.target)&&!((ke=l.current)!=null&&ke.contains(me.target))&&Z(!1),n.current&&(n.current.markerEl.style.transform="scale(1)",n.current.wrapper.style.zIndex="1",(qe=n.current.popup)==null||qe.remove(),n.current=null)};return document.addEventListener("click",se),()=>document.removeEventListener("click",se)},[$]),f.jsxs("div",{className:"relative overflow-hidden rounded-xl shadow h-full",children:[E||!I?f.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center bg-white/70 backdrop-blur",children:f.jsx(wy,{})}):null,f.jsxs("div",{className:"absolute top-2 left-2 z-20",children:[f.jsxs("button",{ref:l,onClick:se=>{se.stopPropagation(),d.current=!0,Z(me=>!me)},className:"flex items-center gap-1 bg-white text-gray-700 px-3 py-2 rounded shadow  text-xs hover:bg-gray-100",children:[f.jsx(xG,{className:"text-lg text-orange-500"}),f.jsx("p",{className:"text-xs",children:"Categorías"})]}),f.jsx(ax,{children:$&&f.jsx(Ko.div,{ref:r,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"absolute mt-2 w-max bg-black/50 backdrop-blur-sm rounded-md shadow p-3 text-xs text-white",children:ne.map((se,me)=>f.jsxs(Ko.div,{className:"flex items-center gap-2 py-1",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.1*me},children:[f.jsx("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:l8(se)}}),f.jsx("span",{children:se})]},se))})})]}),f.jsx("div",{ref:e,className:"w-full h-full min-h-[500px] md:min-h-[500px]"})]})}function l8(e){switch(e){case"Comida y Bebida":return"#fbbf24";case"Salud y Bienestar":return"#10b981";case"Deporte y Fitness":return"#3b82f6";case"Belleza y Cuidado Personal":return"#f9a8d4";case"Educación":return"#8b5cf6";case"Entretenimiento":return"#facc15";case"Mascotas":return"#d6a35c";case"Finanzas y Legales":return"#e5e7eb";case"Arte y Cultura":return"#7c3aed";default:return"#9ca3af"}}const cye={Gastronomía:f.jsx(q$,{className:"text-orange-500"}),"Salud y Belleza":f.jsx(L$,{className:"text-red-500"}),Tecnología:f.jsx(k$,{className:"text-purple-500"}),"Bienes Raíces":f.jsx(F$,{className:"text-gray-600"}),"Arte y Cultura":f.jsx(zM,{className:"text-indigo-500"}),Mascotas:f.jsx(V$,{className:"text-yellow-600"}),Educación:f.jsx(z$,{className:"text-blue-600"}),"Deporte y Fitness":f.jsx(O$,{className:"text-green-600"}),"Finanzas y Legales":f.jsx(B$,{className:"text-teal-600"}),Entretenimiento:f.jsx(I$,{className:"text-amber-600"}),Construcción:f.jsx(bce,{className:"text-gray-700"}),Automotriz:f.jsx(Sce,{className:"text-cyan-500"}),Comercio:f.jsx(Vce,{className:"text-pink-500"}),Cultura:f.jsx(zM,{className:"text-purple-700"}),"Arte Corporal":f.jsx(Ice,{className:"text-fuchsia-500"}),Otro:f.jsx(HP,{className:"text-gray-400"})};function uye({negocio:e}){const t=Array.isArray(e.categories)&&e.categories.length>0?e.categories:[],n=e.isPremium===!0;return f.jsxs("div",{className:`relative flex flex-col hover:shadow-xl items-center rounded-2xl overflow-hidden transition-all p-4 text-center
        ${n?"bg-black text-white shadow-[0_0_10px_4px_rgba(234,179,8,0.4)]":"bg-gray-100 text-back "}`,children:[f.jsxs("div",{className:`relative w-16 h-16 sm:w-20 sm:h-20 rounded-full overflow-hidden mb-3 border-2 shadow-sm
          ${n?"border-yellow-400":"border-gray-300"} bg-white`,children:[f.jsx("img",{src:e.profileImage||"https://via.placeholder.com/80?text=Logo",alt:`Logo de ${e.name}`,className:"w-full h-full object-cover"}),n&&f.jsx("div",{className:"absolute -bottom-2 -right-2 bg-white text-yellow-500 rounded-full p-1 shadow-md",children:f.jsx(FaGem,{className:"w-4 h-4"})})]}),f.jsx("p",{className:"  text-xs sm:text-m font-semibold break-words leading-snug min-h-[3.5rem]",children:e.name}),f.jsx("div",{className:"flex flex-wrap justify-center gap-1 mt-2",children:t.length>0?t.map(r=>f.jsx("div",{className:`w-6 h-6 md:w-9 md:h-9 flex items-center justify-center rounded-full shadow-md
                bg-white`,title:r.name,children:cye[r.name]||f.jsx(HP,{className:n?"text-white":"text-gray-500"})},r.name)):f.jsx("span",{className:"text-xs text-gray-400",children:"Sin categoría"})})]})}const dye={"Comida y Bebida":f.jsx(q$,{className:"text-orange-500"}),"Salud y Bienestar":f.jsx(L$,{className:"text-red-500"}),"Ciencia y Tecnología":f.jsx(k$,{className:"text-purple-500"}),"Belleza y Cuidado Personal":f.jsx(Bce,{className:"text-pink-400"}),"Bienes Raíces":f.jsx(F$,{className:"text-gray-600"}),"Arte y Cultura":f.jsx(zM,{className:"text-indigo-500"}),Mascotas:f.jsx(V$,{className:"text-yellow-600"}),Educación:f.jsx(z$,{className:"text-blue-600"}),"Deporte y Fitness":f.jsx(O$,{className:"text-green-600"}),"Finanzas y Legales":f.jsx(B$,{className:"text-teal-600"}),Entretenimiento:f.jsx(I$,{className:"text-amber-600"})};function hye({title:e,subtitle:t,image:n,to:r,categories:l=[]}){return f.jsxs(Wn,{to:r,className:"flex flex-col sm:flex-row w-full bg-gray-100 rounded-2xl hover:shadow-2xl transition overflow-hidden text-black",children:[f.jsx("div",{className:"w-full sm:w-1/3 aspect-square flex-shrink-0 bg-gray-300",children:n?f.jsx("img",{src:n,alt:e,className:"w-full h-full object-cover"}):f.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400  text-xs",children:"Sin imagen"})}),f.jsxs("div",{className:"flex flex-col justify-between px-4 py-3 flex-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"  text-xs sm:text-base font-semibold leading-snug line-clamp-2",children:e}),t&&f.jsx("p",{className:"text-xs text-gray-400 mt-1 line-clamp-2",children:t})]}),f.jsx("div",{className:"flex flex-wrap gap-1 mt-3",children:Array.isArray(l)&&l.length>0?l.map((d,p)=>f.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 flex items-center justify-center rounded-full bg-white shadow-md",title:d.name,children:dye[d.name]||f.jsx(HP,{className:"text-gray-500 text-xs"})},p)):f.jsx("span",{className:"text-xs text-gray-500",children:"Sin categoría"})})]})]})}function YN(){return f.jsxs("div",{className:"w-full animate-pulse flex flex-col gap-16",children:[f.jsx("div",{className:"w-full h-56 sm:h-72 bg-gray-200 rounded-xl"}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("div",{className:"h-6 bg-gray-300 rounded w-2/3"}),f.jsx("div",{className:"h-4 bg-gray-300 rounded w-16"})]}),f.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),f.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),f.jsx("div",{className:"h-3 bg-gray-100 rounded w-1/3"})]}),f.jsxs("div",{className:"flex flex-col gap-3",children:[f.jsx("div",{className:"h-8 bg-gray-300 rounded w-40"}),f.jsx("div",{className:"h-8 bg-gray-200 rounded w-48"}),f.jsx("div",{className:"h-8 bg-gray-200 rounded w-32"})]}),f.jsx("hr",{className:"border-t border-gray-200"}),f.jsxs("div",{className:"border-l-4 border-gray-200 pl-4 space-y-2",children:[f.jsx("div",{className:"h-3 bg-gray-200 rounded w-full"}),f.jsx("div",{className:"h-3 bg-gray-200 rounded w-5/6"}),f.jsx("div",{className:"h-3 bg-gray-200 rounded w-4/6"}),f.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"}),f.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]}),f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[1,2,3].map(e=>f.jsx("div",{className:"w-full h-40 bg-gray-200 rounded-xl"},e))}),f.jsx("div",{className:"flex flex-wrap gap-2",children:[1,2,3,4].map(e=>f.jsx("div",{className:"h-6 bg-gray-200 rounded-full w-20"},e))}),f.jsx("hr",{className:"border-t border-gray-200"}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("div",{className:"h-5 bg-gray-300 rounded w-32"}),f.jsx("div",{className:"flex gap-3",children:[1,2,3].map(e=>f.jsxs("div",{className:"flex flex-col items-center space-y-1 w-24",children:[f.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-xl"}),f.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]},e))})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("div",{className:"h-5 bg-gray-300 rounded w-48"}),f.jsx("div",{className:"flex gap-2 flex-wrap",children:[1,2,3].map(e=>f.jsx("div",{className:"flex items-center gap-2 px-3 py-1 bg-gray-200 rounded-full w-36 h-8"},e))})]}),f.jsx("hr",{className:"border-t border-gray-200"}),f.jsx("div",{className:"w-full h-64 bg-gray-200 rounded-xl"})]})}function QN({entityType:e,entityId:t}){const n=br();aa(),yl();const r=ln(E=>E.auth.usuario),{items:l,loading:d}=ln(E=>E.follow),[p,a]=V.useState(!1),b=l.some(E=>E.entityType===e&&E.entityId===t),T=async()=>{if(!r){n(Jt({message:"Debes iniciar sesión para seguir este perfil.",type:"error"}));return}a(!0);try{b?await Rn.delete("/follow",{data:{entityType:e,entityId:t}}):await Rn.post("/follow",{entityType:e,entityId:t}),await n(Nb())}catch{n(Jt({message:"Error al cambiar seguimiento.",type:"error"}))}finally{a(!1)}};return V.useEffect(()=>{r&&l.length===0&&n(Nb())},[n,l.length,r]),f.jsx("button",{onClick:T,disabled:p||d,title:b?"Ya estás siguiendo":"Seguir",className:`flex items-center gap-2 px-4 py-1.5 rounded-xl transition-all shadow-md  text-xs font-semibold
        ${b?"bg-blue-100 hover:bg-blue-200 text-blue-800 border border-blue-300":"bg-blue-100 hover:bg-blue-50 text-blue-600 border border-blue-300"}
      `,children:p?f.jsx("span",{className:"animate-pulse",children:"..."}):f.jsxs(f.Fragment,{children:[b?f.jsx(Ple,{className:"text-lg"}):f.jsx(Mle,{className:"text-lg"}),f.jsx("span",{children:b?"Siguiéndonos":"¡Seguinos!"})]})})}const fye={facebook:f.jsx(o3,{}),instagram:f.jsx(l3,{}),whatsapp:f.jsx(c3,{}),twitter:f.jsx($P,{}),website:f.jsx(tw,{}),youtube:f.jsx(D$,{})};function pye(){var F,W;const{id:e}=Ec(),{lista:t,loading:n}=ln($=>$.comunidades),r=ln($=>$.eventos.lista),l=ln($=>$.eventos.loading),d=ln($=>$.negocios.lista),p=ln($=>$.negocios.loading),[a,b]=V.useState(!1),[T,E]=V.useState("negocios"),P=V.useMemo(()=>t.find($=>String($.id)===e||String($._id)===e),[t,e]);V.useEffect(()=>{(async()=>{if(P!=null&&P._id)try{const ne=(await Rn.get("/users/me/following?type=community")).data.items.map(ie=>String(ie._id));b(ne.includes(String(P._id)))}catch(Z){console.warn("No se pudo cargar el estado de seguimiento:",Z)}})()},[P==null?void 0:P._id]);const I=V.useMemo(()=>P!=null&&P._id?d.filter($=>$.community?typeof $.community=="object"&&$.community._id?String($.community._id)===String(P._id):String($.community)===String(P._id):!1):[],[d,P]),R=V.useMemo(()=>P!=null&&P._id?r.filter($=>{var ie,ge;const Z=((ie=$.comunidad)==null?void 0:ie.trim())===((ge=P.name)==null?void 0:ge.trim()),ne=Array.isArray($.communities)?$.communities.some(ae=>String(ae._id)===String(P._id)):!1;return Z||ne}):[],[r,P]);return n?f.jsx("div",{className:"px-4 sm:px-8 lg:px-8 xl:px-40 py-5 flex justify-center",children:f.jsx("div",{className:"w-full max-w-[1400px]",children:f.jsx(YN,{})})}):P?f.jsxs(f.Fragment,{children:[f.jsxs(Oa,{children:[f.jsx("title",{children:P.metaTitle||`Communities | ${P.name}`}),f.jsx("meta",{name:"description",content:P.metaDescription||P.description})]}),f.jsx("div",{className:" sm:px-8 lg:px-8 xl:px-40 py-5 flex justify-center",children:f.jsxs("div",{className:"w-full max-w-[1400px] flex flex-col gap-10",children:[f.jsx("div",{className:"w-full h-56 sm:h-72 md:rounded-xl bg-cover bg-center shadow-md",style:{backgroundImage:`url(${P.bannerImage||"/placeholder.jpg"})`}}),f.jsxs("div",{className:"space-y-4 m-2",children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:P.name||"Nombre no disponible"}),P._id&&f.jsx(QN,{entityType:"community",entityId:P._id,initialFollowed:a}),f.jsx(KN,{url:window.location.href,title:`Descubrí la comunidad "${P.name}" en Communidades`,text:`Mirá esta comunidad: ${P.name||""} - ${((F=P.description)==null?void 0:F.slice(0,100))||""}...`})]}),f.jsx("div",{className:"border-l-4 border-gray-200 pl-4",children:f.jsx("p",{className:"font-sans text-[15px] text-gray-800 leading-relaxed whitespace-pre-line",children:P.description||"Sin descripción disponible."})}),f.jsx("div",{className:"flex flex-wrap gap-2 border-b border-gray-200 pt-4",children:["negocios","eventos","puntos"].map($=>f.jsx("button",{onClick:()=>E($),className:`  text-xs px-3 py-2 rounded-t font-medium transition ${T===$?"bg-white border border-b-0 border-gray-200 text-gray-800":"text-gray-600 hover:text-gray-800"}`,children:$==="negocios"?"Negocios":$==="eventos"?"Eventos":"Puntos de encuentro"},$))}),f.jsxs("div",{className:"pt-4 flex flex-col gap-6 m-2",children:[T==="negocios"&&f.jsxs(f.Fragment,{children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Negocios de la comunidad"}),p?f.jsx("p",{className:"  text-xs text-gray-500",children:"Cargando negocios..."}):I.length>0?f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 xl:grid-cols-6 gap-4",children:I.map($=>f.jsx(Wn,{to:`/negocios/${$._id}`,children:f.jsx(uye,{negocio:$})},$._id))}):f.jsx("p",{className:"  text-xs text-gray-500",children:"No hay negocios registrados todavía."})]}),T==="eventos"&&f.jsxs(f.Fragment,{children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Eventos de la comunidad"}),l?f.jsx("p",{className:"  text-xs text-gray-500",children:"Cargando eventos..."}):R.length>0?f.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-4",children:R.map($=>f.jsx(hye,{title:$.title,subtitle:$.date?new Date($.date).toLocaleDateString():"Sin fecha",image:$.featuredImage,to:`/eventos/${$._id}`,categories:$.categories},$._id))}):f.jsx("p",{className:"  text-xs text-gray-500",children:"No hay eventos registrados todavía."})]}),T==="puntos"&&f.jsxs(f.Fragment,{children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Puntos de encuentro y enlaces útiles"}),((W=P.externalLinks)==null?void 0:W.length)>0?f.jsx(f.Fragment,{children:["facebook","instagram","whatsapp","otros"].map($=>{let Z=[];if($==="otros"?Z=P.externalLinks.filter(ge=>ge.type!=="facebook"&&ge.type!=="instagram"&&ge.type!=="whatsapp"):Z=P.externalLinks.filter(ge=>ge.type===$),Z.length===0)return null;const ne=$==="facebook"?f.jsx(o3,{className:"text-blue-600"}):$==="instagram"?f.jsx(l3,{className:"text-pink-500"}):$==="whatsapp"?f.jsx(c3,{className:"text-green-500"}):f.jsx(tw,{className:"text-gray-500"}),ie=$==="facebook"?"Grupos que reúnen la comunidad en Facebook":$==="instagram"?"Perfiles de la comunidad en Instagram":$==="whatsapp"?"Grupos o chats de la comunidad en WhatsApp":"Otros enlaces útiles de la comunidad";return f.jsxs("div",{className:"mb-8",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx("span",{className:" text-lg",children:ne}),f.jsx("h3",{className:"text-md font-semibold text-gray-500",children:ie})]}),f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:Z.map((ge,ae)=>f.jsxs("a",{href:ge.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-4 rounded-xl bg-gray-50 hover:bg-gray-100 border border-gray-200 shadow-sm",children:[f.jsx("div",{className:" text-lg text-back-600",children:fye[ge.type]||f.jsx(tw,{})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-gray-800  text-xs",children:ge.title}),ge.description&&f.jsx("p",{className:"text-xs text-gray-500 line-clamp-2",children:ge.description})]})]},ae))})]},$)})}):f.jsx("p",{className:"  text-xs text-gray-500",children:"No hay enlaces registrados para esta comunidad."})]})]}),f.jsx("p",{className:"text-lg text-gray-900 font-bold",children:"Conectá con los negocios que mueven tu comunidad."}),f.jsx("div",{className:"overflow-hidden z-0 mt-8",children:f.jsx(lye,{logo:""})})]})})]}):f.jsxs("div",{className:"p-4 text-center text-gray-600",children:[f.jsx(Oa,{children:f.jsx("title",{children:"Communidades | Comunidad no encontrada"})}),"Comunidad no encontrada."]})}const Yh="/assets/ilusta-55x3n-sN.svg",mye="/assets/ilustb-nnF5Ubuk.svg",gye="/assets/ilustc-DGw-W2Jm.svg";function xye(){return f.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-12 space-y-24",children:[f.jsxs(Oa,{children:[f.jsx("title",{children:"Sobre Nosotros | communidades"}),f.jsx("meta",{name:"description",content:"Conoce la historia, valores y misión de communidades. Un puente digital para las comunidades migrantes."}),f.jsx("meta",{property:"og:title",content:"Sobre Nosotros | communidades"}),f.jsx("meta",{property:"og:description",content:"Conoce la historia, valores y misión de communidades. Un puente digital para las comunidades migrantes."})]}),f.jsxs("section",{className:"space-y-4 text-center",children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Nuestra Historia"}),f.jsxs("p",{className:"text-gray-700 max-w-2xl mx-auto",children:[f.jsx("span",{className:"font-semibold text-[#F45525]",children:"communidades"})," ","nació con una idea sencilla pero poderosa: hacer visible lo invisible. Queremos que cada migrante encuentre un espacio donde conectarse con su cultura, su gente y los servicios que hacen que un nuevo lugar se sienta como ",f.jsx("strong",{children:"hogar"}),"."]})]}),f.jsxs("section",{className:"flex flex-col md:flex-row gap-12 items-center",children:[f.jsx("div",{className:"md:w-1/2 w-full",children:f.jsx(Kh,{direction:"left",duration:700,delay:200,children:f.jsx("img",{src:Yh,alt:"Inspiración",className:"w-full h-auto rounded-xl"})})}),f.jsxs("div",{className:"md:w-1/2 space-y-4",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Inspirados en nuestra propia experiencia"}),f.jsx("p",{className:"text-gray-700",children:"Como migrantes, sabemos lo que significa llegar a un país diferente. La incertidumbre, la nostalgia, las ganas de pertenecer. Durante años vimos cómo negocios y eventos culturales pasaban desapercibidos porque no existía un espacio que los reuniera."}),f.jsxs("p",{className:"text-gray-700",children:[f.jsx("span",{className:"font-semibold text-[#F45525]",children:"communidades"})," ","surge para cambiar eso. Creemos en la fuerza de la"," ",f.jsx("strong",{children:"comunidad"}),", en la solidaridad que nos une y en el poder de la información compartida."]})]})]}),f.jsxs("section",{className:"space-y-8",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900 text-center",children:"Nuestros Valores"}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[{title:"Cercanía",text:"Queremos que cada usuario sienta que aquí encuentra un aliado y un lugar seguro."},{title:"Visibilidad",text:"Damos espacio a negocios, servicios y organizaciones que merecen ser descubiertos."},{title:"Inclusión",text:"Celebramos la diversidad cultural que hace únicas a nuestras comunidades."},{title:"Confianza",text:"Somos un puente digital confiable, con información actualizada y relevante."}].map(e=>f.jsxs("div",{className:"bg-gray-50 p-5 rounded-xl shadow-sm space-y-2",children:[f.jsx("h3",{className:"font-semibold text-gray-800 mb-1",children:f.jsx("strong",{children:e.title})}),f.jsx("p",{className:"text-gray-700",children:e.text})]},e.title))})]}),f.jsxs("section",{className:"flex flex-col md:flex-row-reverse gap-12 items-center",children:[f.jsx("div",{className:"md:w-1/2 w-full",children:f.jsx(Kh,{direction:"right",duration:750,delay:250,children:f.jsx("img",{src:mye,alt:"Misión y Visión",className:"w-full h-auto rounded-xl "})})}),f.jsxs("div",{className:"md:w-1/2 space-y-4",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Misión y Visión"}),f.jsxs("p",{className:"text-gray-700",children:["Nuestra misión es"," ",f.jsx("strong",{children:"conectar a las comunidades migrantes"})," con su cultura, sus servicios y entre sí, fortaleciendo su identidad y bienestar."]}),f.jsxs("p",{className:"text-gray-700",children:["Nuestra visión es consolidarnos como la plataforma digital de referencia para migrantes en Estados Unidos y Europa, siendo un espacio de ",f.jsx("strong",{children:"integración, confianza y apoyo cultural"}),"."]})]})]}),f.jsxs("section",{className:"text-center space-y-8",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Nuestro impacto"}),f.jsx("div",{className:"flex flex-wrap justify-center gap-6",children:[{number:"+100",label:"Negocios registrados"},{number:"+500",label:"Usuarios activos"},{number:"+10",label:"Alianzas comunitarias"}].map(e=>f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-3xl font-bold text-[#F45525]",children:e.number}),f.jsx("p",{className:"text-gray-700",children:e.label})]},e.label))})]}),f.jsxs("section",{className:"flex flex-col md:flex-row gap-12 items-center",children:[f.jsx("div",{className:"md:w-1/2 w-full",children:f.jsx(Kh,{direction:"left",duration:800,delay:300,children:f.jsx("img",{src:gye,alt:"Compromiso Social",className:"w-full h-auto rounded-xl"})})}),f.jsxs("div",{className:"md:w-1/2 space-y-4",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Nuestro Compromiso Social"}),f.jsxs("p",{className:"text-gray-700",children:[f.jsx("span",{className:"font-semibold text-[#F45525]",children:"communidades"})," ","no es solo un directorio. Es un proyecto con alma social que busca reforzar los lazos de pertenencia, promover la participación ciudadana y difundir la cultura de quienes llegaron con sueños nuevos."]}),f.jsx("p",{className:"text-gray-700",children:"Colaboramos con organizaciones, consulados, medios comunitarios y asociaciones culturales para que la información llegue a quienes más la necesitan."})]})]}),f.jsxs("section",{className:"text-center space-y-8",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Lo que dicen nuestros usuarios"}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[{quote:"Gracias a communidades descubrí negocios colombianos en Dallas que ahora visito cada semana.",author:"María G."},{quote:"Una plataforma confiable que me ayudó a sentirme en casa desde el primer día.",author:"Juan P."}].map((e,t)=>f.jsxs("blockquote",{className:"bg-gray-50 p-5 rounded-xl shadow-sm text-gray-700 italic",children:["“",e.quote,"”",f.jsxs("footer",{className:"mt-2 font-semibold text-gray-800 not-italic",children:["– ",e.author]})]},t))})]}),f.jsxs("section",{className:"text-center space-y-4",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Quién está detrás"}),f.jsxs("div",{className:"max-w-md mx-auto space-y-2",children:[f.jsxs("p",{className:"text-gray-700",children:["Somos un ",f.jsx("strong",{children:"equipo de migrantes"})," que compartimos la misma visión: crear un espacio donde todas las personas puedan sentirse más cerca de casa, sin importar de dónde vengan."]}),f.jsxs("p",{className:"text-gray-700",children:[f.jsx("span",{className:"font-semibold text-[#F45525]",children:"communidades"})," ","nace del deseo de tender puentes, compartir lo que nos une y visibilizar todo aquello que hace valiosa nuestra diversidad cultural."]})]})]}),f.jsxs("section",{className:"text-center space-y-4",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"¿Quieres impulsar este proyecto?"}),f.jsxs("p",{className:"text-gray-700 max-w-2xl mx-auto",children:["Buscamos ",f.jsx("strong",{children:"auspiciantes"}),", empresas con propósito social y ONG que deseen aportar valor real a las comunidades migrantes. Si crees en nuestra visión, súmate y ayúdanos a dar vida a"," ",f.jsx("span",{className:"font-semibold text-[#F45525]",children:"communidades"}),"."]}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mt-4",children:[f.jsx("a",{href:"/contact",className:"bg-[#F45525] text-white px-5 py-2 rounded-full font-medium hover:bg-[#d9451f] transition",children:"Contáctanos"}),f.jsx("a",{href:"/negocios",className:"border border-[#F45525] text-[#F45525] px-5 py-2 rounded-full font-medium hover:bg-[#f4552511] transition",children:"Explora negocios"})]})]})]})}const yye="/assets/ilustd-JiF-xnOD.svg";function vye(){const[e,t]=V.useState(!1),n=br();V.useEffect(()=>{(()=>{/Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent)&&t(!0)})()},[]);const r=V.useCallback(()=>{const p={title:"communidades",text:"Conectá con tu comunidad en communidades.",url:window.location.origin};navigator.share?navigator.share(p).then(()=>{n(Jt({message:"✅ Contenido compartido",type:"success"}))}).catch(a=>{console.error("Error al compartir:",a),n(Jt({message:"❌ No se pudo compartir",type:"error"}))}):navigator.clipboard.writeText(p.url).then(()=>{n(Jt({message:"🔗 Enlace copiado al portapapeles",type:"success"}))}).catch(()=>{n(Jt({message:"❌ No se pudo copiar el enlace",type:"error"}))})},[n]),l=[{categoria:"Contacto General",correos:["info@communidades.com","contacto@communidades.com","infoadmin@communidades.com","contactoadmin@communidades.com"]},{categoria:"Área Comercial y Auspicios",correos:["comercial@communidades.com","comercialadmin@communidades.com"]},{categoria:"Eventos y Actividades",correos:["eventos@communidades.com","eventosadmin@communidades.com"]}],d=[{nombre:"Instagram",icono:f.jsx(l3,{}),url:"https://www.instagram.com/communidades_/"},{nombre:"Facebook",icono:f.jsx(o3,{}),url:"https://www.facebook.com/profile.php?id=61576800572394"},{nombre:"TikTok",icono:f.jsx(N$,{}),url:"https://www.tiktok.com/@comunnidades_latino?lang=en"}];return f.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-12 space-y-16 grid gap-12",children:[f.jsxs(Oa,{children:[f.jsx("title",{children:"Contacto | communidades"}),f.jsx("meta",{name:"description",content:"Ponte en contacto con communidades. Encuentra nuestros correos y redes sociales."})]}),f.jsxs("section",{className:"space-y-4 text-center",children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Contacto"}),f.jsx("p",{className:"text-gray-700 max-w-2xl mx-auto",children:"Estamos aquí para escucharte y echarte una mano en lo que necesites. Escríbenos con confianza o síguenos en nuestras redes para mantenernos cerca y compartir juntos."}),f.jsx("p",{className:"text-gray-700 max-w-2xl mx-auto",children:"Si quieres auspiciar tu negocio o un evento, o si tienes alguna duda sobre cómo usar la plataforma, no dudes en contactarnos. Nuestro equipo te responderá con gusto."})]}),f.jsxs("section",{className:"space-y-4 text-center",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Nuestras redes sociales"}),f.jsx("div",{className:"flex justify-center gap-6 text-3xl text-gray-600",children:d.map(p=>f.jsx("a",{href:p.url,target:"_blank",rel:"noopener noreferrer","aria-label":p.nombre,className:"hover:text-[#F45525] transition",children:p.icono},p.nombre))})]}),f.jsxs("section",{className:"space-y-4 text-center",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Auspiciar o Promocionar"}),f.jsxs("p",{className:"text-gray-700 max-w-2xl mx-auto",children:["Si tienes un negocio, servicio o evento y te gustaría darle visibilidad dentro de"," ",f.jsx("span",{className:"font-semibold text-[#F45525]",children:"communidades"}),", contáctanos. Nos encanta sumar proyectos que aporten valor real a la comunidad. Juntos podemos crear alianzas que hagan crecer tu marca y fortalezcan el tejido cultural que nos une."]})]}),f.jsx("section",{className:"flex justify-center",children:f.jsx(Kh,{direction:"up",duration:1800,delay:2950,children:f.jsx("img",{src:yye,alt:"Conexión y comunidad",className:"w-full max-w-lg h-auto rounded-xl"})})}),f.jsxs("section",{className:"space-y-4 text-center",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Soporte"}),f.jsxs("p",{className:"text-gray-700 max-w-2xl mx-auto",children:["¿Algo no funciona como esperabas? Estamos aquí para ayudarte. Escríbenos contándonos tu situación y nuestro equipo de soporte revisará tu caso con atención y compromiso. Queremos que tu experiencia en"," ",f.jsx("span",{className:"font-semibold text-[#F45525]",children:"communidades"})," sea siempre sencilla y positiva."]})]}),f.jsxs("section",{className:"space-y-4 text-center",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Dudas y Consultas"}),f.jsxs("p",{className:"text-gray-700 max-w-2xl mx-auto",children:["Si tienes preguntas sobre cómo usar la plataforma, cómo publicar tu negocio o cómo participar en eventos, no dudes en escribirnos. Cada consulta es importante y será respondida con calidez. En"," ",f.jsx("span",{className:"font-semibold text-[#F45525]",children:"communidades"})," ","queremos que te sientas acompañado desde el primer momento."]})]}),f.jsxs("section",{className:"space-y-4",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900 text-center",children:"Preguntas Frecuentes"}),f.jsx("div",{className:"max-w-2xl mx-auto space-y-2",children:[{pregunta:"¿Es gratis usar communidades?",respuesta:"Sí, es totalmente gratis para cualquier migrante que quiera descubrir negocios, eventos y servicios en su comunidad."},{pregunta:"¿Cuánto cuesta registrar mi negocio?",respuesta:"Tenemos un plan gratuito para que cualquier emprendimiento pueda estar presente. Además, contamos con planes premium con suscripciones muy accesibles que incluyen más opciones de visibilidad."},{pregunta:"¿Puedo publicar eventos o actividades?",respuesta:"Claro que sí. Puedes compartir tus eventos culturales, talleres o actividades comunitarias. Escríbenos y te ayudamos a publicarlos."},{pregunta:"¿Quién puede aparecer en la plataforma?",respuesta:"Emprendedores, negocios, profesionales, organizaciones y cualquier persona que ofrezca servicios de interés para la comunidad migrante."},{pregunta:"¿Cómo puedo contactar al soporte si tengo un problema?",respuesta:"Puedes escribirnos a cualquiera de los correos de contacto, especialmente a info@communidades.com, y nuestro equipo responderá a la brevedad."}].map(({pregunta:p,respuesta:a})=>f.jsxs("details",{className:"bg-gray-50 rounded-lg p-4 shadow-sm group overflow-hidden transition-all duration-300",children:[f.jsxs("summary",{className:"cursor-pointer font-medium text-gray-800 relative list-none",children:[f.jsx("span",{className:"inline-block",children:p}),f.jsx("span",{className:"absolute right-0 transform transition-transform duration-300 group-open:rotate-180",children:"▼"})]}),f.jsx("div",{className:"mt-2 text-gray-700",children:f.jsx("p",{children:a})})]},p))})]}),f.jsxs("section",{className:"space-y-8",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900 text-center",children:"Correos de contacto"}),l.map(p=>f.jsxs("div",{className:"space-y-3",children:[f.jsx("h3",{className:"text-lg font-medium text-gray-800",children:p.categoria}),f.jsx("ul",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-4",children:p.correos.map(a=>f.jsxs("li",{className:"flex items-center gap-2 bg-gray-50 p-3 rounded-lg shadow-sm",children:[f.jsx(qP,{className:"text-[#F45525]"}),e?f.jsx("a",{href:`mailto:${a}`,className:"text-gray-800 truncate",children:a}):f.jsx("span",{className:"text-gray-800 truncate",children:a})]},a))})]},p.categoria))]}),f.jsxs("section",{className:"text-center space-y-2",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Comparte communidades con tus conocidos"}),f.jsx("p",{className:"text-gray-700 max-w-2xl mx-auto",children:"Ayúdanos a llegar a más personas que puedan necesitar este espacio."}),f.jsxs("button",{onClick:r,className:"inline-flex items-center gap-2 mt-2 bg-[#F45525] text-white px-5 py-2 rounded-full font-medium hover:bg-[#d9451f] transition",children:[f.jsx(U$,{}),"Compartir"]})]})]})}const _ye="/assets/iluste-OdZ9pDNy.svg",bye="/assets/ilustf-DCk750Hi.svg";function wye(){return f.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-12 space-y-16 grid md:gap-22",children:[f.jsxs(Oa,{children:[f.jsx("title",{children:"Legal y Privacidad | communidades"}),f.jsx("meta",{name:"description",content:"Lee nuestras políticas de privacidad, uso y condiciones de communidades. Tu confianza es importante para nosotros."})]}),f.jsxs("section",{className:"space-y-4 text-center",children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Legal y Privacidad"}),f.jsxs("p",{className:"text-gray-700 max-w-2xl mx-auto",children:["En ",f.jsx("span",{className:"font-semibold text-[#F45525]",children:"communidades"})," ","nos importa tu tranquilidad y confianza. Aquí te contamos de forma clara cómo usamos tu información y cuáles son tus derechos al usar nuestra plataforma."]})]}),f.jsxs("section",{className:"flex flex-col md:flex-row gap-8 items-center",children:[f.jsxs("div",{className:"md:w-1/2 space-y-3",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Política de Privacidad"}),f.jsx("p",{className:"text-gray-700",children:"Solo recopilamos la información estrictamente necesaria para que puedas crear tu cuenta, interactuar con otros usuarios y publicar tus negocios, eventos o iniciativas."}),f.jsx("p",{className:"text-gray-700",children:"Tus datos personales no se venderán ni compartirán con terceros sin tu consentimiento, salvo obligación legal."}),f.jsxs("p",{className:"text-gray-700",children:["Puedes solicitar en cualquier momento la eliminación de tu información enviando un correo a"," ",f.jsx("a",{href:"mailto:info@communidades.com",className:"text-[#F45525] font-medium",children:"info@communidades.com"}),"."]}),f.jsx("p",{className:"text-gray-700",children:"Utilizamos cookies y tecnologías similares para mejorar tu experiencia. Si preferís, podés desactivarlas desde tu navegador o configurar tus preferencias desde el modal de cookies."})]}),f.jsx("div",{className:"md:w-1/2 w-full flex justify-center",children:f.jsx(Kh,{direction:"right",duration:600,delay:100,children:f.jsx("img",{src:_ye,alt:"Protección de datos",className:"max-w-xs w-full h-auto rounded-xl"})})})]}),f.jsxs("section",{className:"space-y-4",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"¿Qué cookies usamos?"}),f.jsx("p",{className:"text-gray-700",children:"A continuación te mostramos un resumen de las cookies que podemos usar en nuestra plataforma:"}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"min-w-full text-left  text-xs border border-gray-200",children:[f.jsx("thead",{className:"bg-gray-100 text-gray-900",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-2 border",children:"Tipo"}),f.jsx("th",{className:"px-4 py-2 border",children:"Descripción"}),f.jsx("th",{className:"px-4 py-2 border",children:"Ejemplos"})]})}),f.jsxs("tbody",{className:"text-gray-700",children:[f.jsxs("tr",{children:[f.jsx("td",{className:"px-4 py-2 border",children:"Esenciales"}),f.jsx("td",{className:"px-4 py-2 border",children:"Necesarias para el funcionamiento básico del sitio."}),f.jsx("td",{className:"px-4 py-2 border",children:"sessionId, authToken"})]}),f.jsxs("tr",{children:[f.jsx("td",{className:"px-4 py-2 border",children:"Analíticas"}),f.jsx("td",{className:"px-4 py-2 border",children:"Nos ayudan a entender cómo se usa la plataforma."}),f.jsx("td",{className:"px-4 py-2 border",children:"Google Analytics"})]}),f.jsxs("tr",{children:[f.jsx("td",{className:"px-4 py-2 border",children:"Publicidad"}),f.jsx("td",{className:"px-4 py-2 border",children:"Utilizadas para mostrar anuncios relevantes."}),f.jsx("td",{className:"px-4 py-2 border",children:"Google Ads"})]}),f.jsxs("tr",{children:[f.jsx("td",{className:"px-4 py-2 border",children:"Terceros"}),f.jsx("td",{className:"px-4 py-2 border",children:"Cookies usadas por servicios externos integrados."}),f.jsx("td",{className:"px-4 py-2 border",children:"Mapbox (mapas)"})]})]})]})})]}),f.jsxs("section",{className:"flex flex-col md:flex-row-reverse gap-8 items-center",children:[f.jsxs("div",{className:"md:w-1/2 space-y-3",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Términos de Uso"}),f.jsxs("p",{className:"text-gray-700",children:["Al usar"," ",f.jsx("span",{className:"font-semibold text-[#F45525]",children:"communidades"}),", aceptás hacerlo de forma respetuosa y conforme a las leyes vigentes."]}),f.jsx("p",{className:"text-gray-700",children:"Nos reservamos el derecho de moderar, editar o eliminar contenido que consideremos ofensivo, falso, discriminatorio o que infrinja derechos de terceros."}),f.jsx("p",{className:"text-gray-700",children:"Las publicaciones y opiniones expresadas por los usuarios son de su exclusiva responsabilidad."})]}),f.jsx("div",{className:"md:w-1/2 w-full flex justify-center",children:f.jsx(Kh,{direction:"left",duration:2e3,delay:900,children:f.jsx("img",{src:bye,alt:"Términos y condiciones",className:"max-w-xs w-full h-auto rounded-xl"})})})]}),f.jsxs("section",{className:"space-y-3",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Cambios y Actualizaciones"}),f.jsx("p",{className:"text-gray-700",children:"Estas políticas pueden actualizarse en cualquier momento para reflejar cambios en la ley, mejoras del servicio o nuevas funciones."}),f.jsx("p",{className:"text-gray-700",children:"Te informaremos si realizamos modificaciones relevantes a través de un aviso en la plataforma o por correo electrónico."})]}),f.jsxs("section",{className:"space-y-3",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Limitación de Responsabilidad"}),f.jsxs("p",{className:"text-gray-700",children:["Aunque hacemos todo lo posible por mantener actualizada y precisa la información publicada en"," ",f.jsx("span",{className:"font-semibold text-[#F45525]",children:"communidades"}),", no garantizamos su exactitud completa. El uso de la plataforma es bajo tu propia responsabilidad."]}),f.jsx("p",{className:"text-gray-700",children:"No nos hacemos responsables de daños directos o indirectos derivados del uso o imposibilidad de uso de la plataforma."})]}),f.jsxs("section",{className:"space-y-3",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Contacto Legal"}),f.jsxs("p",{className:"text-gray-700",children:["Si tenés preguntas sobre tu privacidad, nuestras políticas o el uso de tu información, podés escribirnos a"," ",f.jsx("a",{href:"mailto:info@communidades.com",className:"text-[#F45525] font-medium",children:"info@communidades.com"}),". Estamos acá para ayudarte con transparencia y respeto."]})]})]})}const Sye="/assets/ilustg-B4sjHJfR.svg";function Tye(){return f.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-12 space-y-16 grid md:gap-18",children:[f.jsxs(Oa,{children:[f.jsx("title",{children:"Términos y Condiciones | communidades"}),f.jsx("meta",{name:"description",content:"Lee nuestros términos y condiciones de uso de la plataforma communidades. Tu confianza es importante para nosotros."})]}),f.jsxs("section",{className:"text-center space-y-4",children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Términos y Condiciones"}),f.jsxs("p",{className:"text-gray-700 max-w-2xl mx-auto",children:["Al utilizar"," ",f.jsx("span",{className:"font-semibold text-[#F45525]",children:"communidades"}),", aceptas estos términos de uso. Te invitamos a leerlos detenidamente para que sepas cómo funciona nuestra plataforma."]})]}),f.jsxs("section",{className:"flex flex-col md:flex-row gap-8 items-center",children:[f.jsx("div",{className:"md:w-1/2 w-full",children:f.jsx(Kh,{direction:"left",duration:900,delay:300,children:f.jsx("img",{src:Sye,alt:"Términos y condiciones",className:"w-full h-auto rounded-xl "})})}),f.jsxs("div",{className:"md:w-1/2 space-y-4",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Uso de la Plataforma"}),f.jsxs("ul",{className:"list-disc space-y-2 pl-6 text-gray-700",children:[f.jsx("li",{children:"El contenido publicado (textos, imágenes, datos) es responsabilidad exclusiva de cada usuario o negocio que lo comparta."}),f.jsxs("li",{children:["No se permite el uso de"," ",f.jsx("span",{className:"font-semibold text-[#F45525]",children:"communidades"})," ","con fines ilegales, fraudulentos, difamatorios o que infrinjan derechos de terceros."]}),f.jsx("li",{children:"Nos reservamos el derecho de editar, moderar o eliminar cualquier contenido que consideremos inadecuado u ofensivo."}),f.jsx("li",{children:"Podemos suspender cuentas que incumplan reiteradamente estas normas."})]})]})]}),f.jsxs("section",{className:"space-y-4",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Derechos de Propiedad Intelectual"}),f.jsxs("p",{className:"text-gray-700",children:["Todos los contenidos, logotipos, marcas, nombres comerciales, ilustraciones, textos, imágenes y diseños que aparecen en"," ",f.jsx("span",{className:"font-semibold text-[#F45525]",children:"communidades"})," ","están protegidos por derechos de propiedad intelectual e industrial, y pertenecen a sus respectivos titulares o a la plataforma, salvo que se indique expresamente lo contrario."]}),f.jsxs("p",{className:"text-gray-700",children:["El uso de los contenidos de la plataforma con fines distintos a la consulta, promoción legítima o difusión de los servicios ofrecidos por"," ",f.jsx("span",{className:"font-semibold text-[#F45525]",children:"communidades"})," ","requiere la autorización previa y por escrito de sus propietarios. En ningún caso se entenderá que el acceso a la plataforma otorga licencia o cesión de dichos derechos."]}),f.jsx("p",{className:"text-gray-700",children:"Queda expresamente prohibido reproducir, copiar, distribuir, transformar, comunicar públicamente, extraer o reutilizar cualquier contenido protegido sin consentimiento expreso, total o parcial, por cualquier medio o procedimiento."}),f.jsxs("p",{className:"text-gray-700",children:["Los usuarios que suban contenidos (por ejemplo: textos, imágenes, logotipos o cualquier material) garantizan que son titulares de los derechos de explotación sobre dichos contenidos o que cuentan con las autorizaciones necesarias para su uso en la plataforma."," ",f.jsx("span",{className:"font-semibold text-[#F45525]",children:"communidades"})," no se hace responsable de los posibles conflictos que puedan derivarse por un uso indebido de derechos de terceros."]}),f.jsxs("p",{className:"text-gray-700",children:["Si consideras que algún contenido vulnera tus derechos de autor, de imagen o de propiedad industrial, puedes escribirnos a"," ",f.jsx("a",{href:"mailto:info@communidades.com",className:"text-[#F45525] font-medium",children:"info@communidades.com"})," ","indicando la información necesaria para analizar la situación. Nos comprometemos a revisar y atender cualquier reclamación con la mayor diligencia posible."]})]}),f.jsxs("section",{className:"space-y-4",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Modificaciones de los Términos"}),f.jsx("p",{className:"text-gray-700",children:"Nos reservamos el derecho de actualizar estos términos y condiciones en cualquier momento. Si realizamos cambios relevantes, se notificará en la plataforma o por correo electrónico."}),f.jsx("p",{className:"text-gray-700",children:"El uso continuado de la plataforma implica la aceptación de los nuevos términos."})]}),f.jsxs("section",{className:"space-y-4",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Suspensión y Terminación"}),f.jsx("p",{className:"text-gray-700",children:"Podemos suspender o cerrar tu cuenta si detectamos un uso que vaya en contra de estos términos, si es fraudulento o si afecta negativamente a la comunidad."})]}),f.jsxs("section",{className:"space-y-4",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Contacto Legal"}),f.jsxs("p",{className:"text-gray-700",children:["Si tienes dudas sobre estos términos, tu cuenta o cualquier aspecto legal, puedes escribirnos a"," ",f.jsx("a",{href:"mailto:info@communidades.com",className:"text-[#F45525] font-medium",children:"info@communidades.com"}),". Estamos aquí para ayudarte con transparencia y respeto."]})]})]})}const Eye="/assets/ilustz-C-gTkQ46.svg";function Aye(){return f.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen text-center p-6 bg-orange-500",children:[f.jsx(Ko.img,{src:Eye,alt:"Página no encontrada",className:"w-64 md:w-96 mb-6",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.6}}),f.jsx(Ko.h1,{className:"text-6xl font-bold text-white mb-2",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.5},children:"404"}),f.jsx(Ko.p,{className:" text-lg text-white mb-6",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.4,duration:.5},children:"La página que buscas no existe o fue movida."}),f.jsxs(Ko.div,{className:"flex flex-wrap justify-center gap-4 mb-6",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.5},children:[f.jsx("a",{href:"/negocios",className:"px-4 py-2 bg-white text-orange-600 rounded hover:bg-orange-100 transition",children:"Ver negocios"}),f.jsx("a",{href:"/eventos",className:"px-4 py-2 bg-white text-orange-600 rounded hover:bg-orange-100 transition",children:"Ver eventos"}),f.jsx("a",{href:"/comunidades",className:"px-4 py-2 bg-white text-orange-600 rounded hover:bg-orange-100 transition",children:"Ver comunidades"})]}),f.jsx(Ko.a,{href:"/",className:"inline-block px-6 py-3 bg-white text-orange-600 rounded hover:bg-orange-100 transition",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7,duration:.5},children:"Volver al inicio"})]})}var Cye=function(t){return jye(t)&&!Mye(t)};function jye(e){return!!e&&typeof e=="object"}function Mye(e){var t=Object.prototype.toString.call(e);return t==="[object RegExp]"||t==="[object Date]"||Dye(e)}var Pye=typeof Symbol=="function"&&Symbol.for,Nye=Pye?Symbol.for("react.element"):60103;function Dye(e){return e.$$typeof===Nye}function Oye(e){return Array.isArray(e)?[]:{}}function tE(e,t){return t.clone!==!1&&t.isMergeableObject(e)?hw(Oye(e),e,t):e}function Iye(e,t,n){return e.concat(t).map(function(r){return tE(r,n)})}function kye(e,t,n){var r={};return n.isMergeableObject(e)&&Object.keys(e).forEach(function(l){r[l]=tE(e[l],n)}),Object.keys(t).forEach(function(l){!n.isMergeableObject(t[l])||!e[l]?r[l]=tE(t[l],n):r[l]=hw(e[l],t[l],n)}),r}function hw(e,t,n){n=n||{},n.arrayMerge=n.arrayMerge||Iye,n.isMergeableObject=n.isMergeableObject||Cye;var r=Array.isArray(t),l=Array.isArray(e),d=r===l;return d?r?n.arrayMerge(e,t,n):kye(e,t,n):tE(t,n)}hw.all=function(t,n){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(r,l){return hw(r,l,n)},{})};var p5=hw,bG=typeof global=="object"&&global&&global.Object===Object&&global,Rye=typeof self=="object"&&self&&self.Object===Object&&self,lp=bG||Rye||Function("return this")(),sx=lp.Symbol,wG=Object.prototype,zye=wG.hasOwnProperty,Lye=wG.toString,ab=sx?sx.toStringTag:void 0;function Fye(e){var t=zye.call(e,ab),n=e[ab];try{e[ab]=void 0;var r=!0}catch{}var l=Lye.call(e);return r&&(t?e[ab]=n:delete e[ab]),l}var Bye=Object.prototype,Vye=Bye.toString;function Uye(e){return Vye.call(e)}var $ye="[object Null]",qye="[object Undefined]",c8=sx?sx.toStringTag:void 0;function Sy(e){return e==null?e===void 0?qye:$ye:c8&&c8 in Object(e)?Fye(e):Uye(e)}function SG(e,t){return function(n){return e(t(n))}}var JN=SG(Object.getPrototypeOf,Object);function Ty(e){return e!=null&&typeof e=="object"}var Hye="[object Object]",Gye=Function.prototype,Wye=Object.prototype,TG=Gye.toString,Zye=Wye.hasOwnProperty,Xye=TG.call(Object);function u8(e){if(!Ty(e)||Sy(e)!=Hye)return!1;var t=JN(e);if(t===null)return!0;var n=Zye.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&TG.call(n)==Xye}function Kye(){this.__data__=[],this.size=0}function EG(e,t){return e===t||e!==e&&t!==t}function v3(e,t){for(var n=e.length;n--;)if(EG(e[n][0],t))return n;return-1}var Yye=Array.prototype,Qye=Yye.splice;function Jye(e){var t=this.__data__,n=v3(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Qye.call(t,n,1),--this.size,!0}function eve(e){var t=this.__data__,n=v3(t,e);return n<0?void 0:t[n][1]}function tve(e){return v3(this.__data__,e)>-1}function nve(e,t){var n=this.__data__,r=v3(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function Lm(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Lm.prototype.clear=Kye;Lm.prototype.delete=Jye;Lm.prototype.get=eve;Lm.prototype.has=tve;Lm.prototype.set=nve;function rve(){this.__data__=new Lm,this.size=0}function ive(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function ave(e){return this.__data__.get(e)}function sve(e){return this.__data__.has(e)}function Vw(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var ove="[object AsyncFunction]",lve="[object Function]",cve="[object GeneratorFunction]",uve="[object Proxy]";function AG(e){if(!Vw(e))return!1;var t=Sy(e);return t==lve||t==cve||t==ove||t==uve}var h4=lp["__core-js_shared__"],d8=function(){var e=/[^.]+$/.exec(h4&&h4.keys&&h4.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function dve(e){return!!d8&&d8 in e}var hve=Function.prototype,fve=hve.toString;function Ey(e){if(e!=null){try{return fve.call(e)}catch{}try{return e+""}catch{}}return""}var pve=/[\\^$.*+?()[\]{}|]/g,mve=/^\[object .+?Constructor\]$/,gve=Function.prototype,xve=Object.prototype,yve=gve.toString,vve=xve.hasOwnProperty,_ve=RegExp("^"+yve.call(vve).replace(pve,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function bve(e){if(!Vw(e)||dve(e))return!1;var t=AG(e)?_ve:mve;return t.test(Ey(e))}function wve(e,t){return e==null?void 0:e[t]}function Ay(e,t){var n=wve(e,t);return bve(n)?n:void 0}var fw=Ay(lp,"Map"),pw=Ay(Object,"create");function Sve(){this.__data__=pw?pw(null):{},this.size=0}function Tve(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Eve="__lodash_hash_undefined__",Ave=Object.prototype,Cve=Ave.hasOwnProperty;function jve(e){var t=this.__data__;if(pw){var n=t[e];return n===Eve?void 0:n}return Cve.call(t,e)?t[e]:void 0}var Mve=Object.prototype,Pve=Mve.hasOwnProperty;function Nve(e){var t=this.__data__;return pw?t[e]!==void 0:Pve.call(t,e)}var Dve="__lodash_hash_undefined__";function Ove(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=pw&&t===void 0?Dve:t,this}function py(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}py.prototype.clear=Sve;py.prototype.delete=Tve;py.prototype.get=jve;py.prototype.has=Nve;py.prototype.set=Ove;function Ive(){this.size=0,this.__data__={hash:new py,map:new(fw||Lm),string:new py}}function kve(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function _3(e,t){var n=e.__data__;return kve(t)?n[typeof t=="string"?"string":"hash"]:n.map}function Rve(e){var t=_3(this,e).delete(e);return this.size-=t?1:0,t}function zve(e){return _3(this,e).get(e)}function Lve(e){return _3(this,e).has(e)}function Fve(e,t){var n=_3(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function fx(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}fx.prototype.clear=Ive;fx.prototype.delete=Rve;fx.prototype.get=zve;fx.prototype.has=Lve;fx.prototype.set=Fve;var Bve=200;function Vve(e,t){var n=this.__data__;if(n instanceof Lm){var r=n.__data__;if(!fw||r.length<Bve-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new fx(r)}return n.set(e,t),this.size=n.size,this}function P_(e){var t=this.__data__=new Lm(e);this.size=t.size}P_.prototype.clear=rve;P_.prototype.delete=ive;P_.prototype.get=ave;P_.prototype.has=sve;P_.prototype.set=Vve;function Uve(e,t){for(var n=-1,r=e==null?0:e.length;++n<r&&t(e[n],n,e)!==!1;);return e}var h8=function(){try{var e=Ay(Object,"defineProperty");return e({},"",{}),e}catch{}}();function CG(e,t,n){t=="__proto__"&&h8?h8(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var $ve=Object.prototype,qve=$ve.hasOwnProperty;function jG(e,t,n){var r=e[t];(!(qve.call(e,t)&&EG(r,n))||n===void 0&&!(t in e))&&CG(e,t,n)}function b3(e,t,n,r){var l=!n;n||(n={});for(var d=-1,p=t.length;++d<p;){var a=t[d],b=void 0;b===void 0&&(b=e[a]),l?CG(n,a,b):jG(n,a,b)}return n}function Hve(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var Gve="[object Arguments]";function f8(e){return Ty(e)&&Sy(e)==Gve}var MG=Object.prototype,Wve=MG.hasOwnProperty,Zve=MG.propertyIsEnumerable,Xve=f8(function(){return arguments}())?f8:function(e){return Ty(e)&&Wve.call(e,"callee")&&!Zve.call(e,"callee")},Uw=Array.isArray;function Kve(){return!1}var PG=typeof exports=="object"&&exports&&!exports.nodeType&&exports,p8=PG&&typeof module=="object"&&module&&!module.nodeType&&module,Yve=p8&&p8.exports===PG,m8=Yve?lp.Buffer:void 0,Qve=m8?m8.isBuffer:void 0,NG=Qve||Kve,Jve=9007199254740991,e_e=/^(?:0|[1-9]\d*)$/;function t_e(e,t){var n=typeof e;return t=t??Jve,!!t&&(n=="number"||n!="symbol"&&e_e.test(e))&&e>-1&&e%1==0&&e<t}var n_e=9007199254740991;function DG(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=n_e}var r_e="[object Arguments]",i_e="[object Array]",a_e="[object Boolean]",s_e="[object Date]",o_e="[object Error]",l_e="[object Function]",c_e="[object Map]",u_e="[object Number]",d_e="[object Object]",h_e="[object RegExp]",f_e="[object Set]",p_e="[object String]",m_e="[object WeakMap]",g_e="[object ArrayBuffer]",x_e="[object DataView]",y_e="[object Float32Array]",v_e="[object Float64Array]",__e="[object Int8Array]",b_e="[object Int16Array]",w_e="[object Int32Array]",S_e="[object Uint8Array]",T_e="[object Uint8ClampedArray]",E_e="[object Uint16Array]",A_e="[object Uint32Array]",es={};es[y_e]=es[v_e]=es[__e]=es[b_e]=es[w_e]=es[S_e]=es[T_e]=es[E_e]=es[A_e]=!0;es[r_e]=es[i_e]=es[g_e]=es[a_e]=es[x_e]=es[s_e]=es[o_e]=es[l_e]=es[c_e]=es[u_e]=es[d_e]=es[h_e]=es[f_e]=es[p_e]=es[m_e]=!1;function C_e(e){return Ty(e)&&DG(e.length)&&!!es[Sy(e)]}function eD(e){return function(t){return e(t)}}var OG=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Vb=OG&&typeof module=="object"&&module&&!module.nodeType&&module,j_e=Vb&&Vb.exports===OG,f4=j_e&&bG.process,f_=function(){try{var e=Vb&&Vb.require&&Vb.require("util").types;return e||f4&&f4.binding&&f4.binding("util")}catch{}}(),g8=f_&&f_.isTypedArray,M_e=g8?eD(g8):C_e,P_e=Object.prototype,N_e=P_e.hasOwnProperty;function IG(e,t){var n=Uw(e),r=!n&&Xve(e),l=!n&&!r&&NG(e),d=!n&&!r&&!l&&M_e(e),p=n||r||l||d,a=p?Hve(e.length,String):[],b=a.length;for(var T in e)(t||N_e.call(e,T))&&!(p&&(T=="length"||l&&(T=="offset"||T=="parent")||d&&(T=="buffer"||T=="byteLength"||T=="byteOffset")||t_e(T,b)))&&a.push(T);return a}var D_e=Object.prototype;function tD(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||D_e;return e===n}var O_e=SG(Object.keys,Object),I_e=Object.prototype,k_e=I_e.hasOwnProperty;function R_e(e){if(!tD(e))return O_e(e);var t=[];for(var n in Object(e))k_e.call(e,n)&&n!="constructor"&&t.push(n);return t}function kG(e){return e!=null&&DG(e.length)&&!AG(e)}function nD(e){return kG(e)?IG(e):R_e(e)}function z_e(e,t){return e&&b3(t,nD(t),e)}function L_e(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var F_e=Object.prototype,B_e=F_e.hasOwnProperty;function V_e(e){if(!Vw(e))return L_e(e);var t=tD(e),n=[];for(var r in e)r=="constructor"&&(t||!B_e.call(e,r))||n.push(r);return n}function rD(e){return kG(e)?IG(e,!0):V_e(e)}function U_e(e,t){return e&&b3(t,rD(t),e)}var RG=typeof exports=="object"&&exports&&!exports.nodeType&&exports,x8=RG&&typeof module=="object"&&module&&!module.nodeType&&module,$_e=x8&&x8.exports===RG,y8=$_e?lp.Buffer:void 0,v8=y8?y8.allocUnsafe:void 0;function q_e(e,t){if(t)return e.slice();var n=e.length,r=v8?v8(n):new e.constructor(n);return e.copy(r),r}function zG(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}function H_e(e,t){for(var n=-1,r=e==null?0:e.length,l=0,d=[];++n<r;){var p=e[n];t(p,n,e)&&(d[l++]=p)}return d}function LG(){return[]}var G_e=Object.prototype,W_e=G_e.propertyIsEnumerable,_8=Object.getOwnPropertySymbols,iD=_8?function(e){return e==null?[]:(e=Object(e),H_e(_8(e),function(t){return W_e.call(e,t)}))}:LG;function Z_e(e,t){return b3(e,iD(e),t)}function FG(e,t){for(var n=-1,r=t.length,l=e.length;++n<r;)e[l+n]=t[n];return e}var X_e=Object.getOwnPropertySymbols,BG=X_e?function(e){for(var t=[];e;)FG(t,iD(e)),e=JN(e);return t}:LG;function K_e(e,t){return b3(e,BG(e),t)}function VG(e,t,n){var r=t(e);return Uw(e)?r:FG(r,n(e))}function Y_e(e){return VG(e,nD,iD)}function Q_e(e){return VG(e,rD,BG)}var m5=Ay(lp,"DataView"),g5=Ay(lp,"Promise"),x5=Ay(lp,"Set"),y5=Ay(lp,"WeakMap"),b8="[object Map]",J_e="[object Object]",w8="[object Promise]",S8="[object Set]",T8="[object WeakMap]",E8="[object DataView]",e1e=Ey(m5),t1e=Ey(fw),n1e=Ey(g5),r1e=Ey(x5),i1e=Ey(y5),vm=Sy;(m5&&vm(new m5(new ArrayBuffer(1)))!=E8||fw&&vm(new fw)!=b8||g5&&vm(g5.resolve())!=w8||x5&&vm(new x5)!=S8||y5&&vm(new y5)!=T8)&&(vm=function(e){var t=Sy(e),n=t==J_e?e.constructor:void 0,r=n?Ey(n):"";if(r)switch(r){case e1e:return E8;case t1e:return b8;case n1e:return w8;case r1e:return S8;case i1e:return T8}return t});var a1e=Object.prototype,s1e=a1e.hasOwnProperty;function o1e(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&s1e.call(e,"index")&&(n.index=e.index,n.input=e.input),n}var A8=lp.Uint8Array;function aD(e){var t=new e.constructor(e.byteLength);return new A8(t).set(new A8(e)),t}function l1e(e,t){var n=t?aD(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var c1e=/\w*$/;function u1e(e){var t=new e.constructor(e.source,c1e.exec(e));return t.lastIndex=e.lastIndex,t}var C8=sx?sx.prototype:void 0,j8=C8?C8.valueOf:void 0;function d1e(e){return j8?Object(j8.call(e)):{}}function h1e(e,t){var n=t?aD(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var f1e="[object Boolean]",p1e="[object Date]",m1e="[object Map]",g1e="[object Number]",x1e="[object RegExp]",y1e="[object Set]",v1e="[object String]",_1e="[object Symbol]",b1e="[object ArrayBuffer]",w1e="[object DataView]",S1e="[object Float32Array]",T1e="[object Float64Array]",E1e="[object Int8Array]",A1e="[object Int16Array]",C1e="[object Int32Array]",j1e="[object Uint8Array]",M1e="[object Uint8ClampedArray]",P1e="[object Uint16Array]",N1e="[object Uint32Array]";function D1e(e,t,n){var r=e.constructor;switch(t){case b1e:return aD(e);case f1e:case p1e:return new r(+e);case w1e:return l1e(e,n);case S1e:case T1e:case E1e:case A1e:case C1e:case j1e:case M1e:case P1e:case N1e:return h1e(e,n);case m1e:return new r;case g1e:case v1e:return new r(e);case x1e:return u1e(e);case y1e:return new r;case _1e:return d1e(e)}}var M8=Object.create,O1e=function(){function e(){}return function(t){if(!Vw(t))return{};if(M8)return M8(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function I1e(e){return typeof e.constructor=="function"&&!tD(e)?O1e(JN(e)):{}}var k1e="[object Map]";function R1e(e){return Ty(e)&&vm(e)==k1e}var P8=f_&&f_.isMap,z1e=P8?eD(P8):R1e,L1e="[object Set]";function F1e(e){return Ty(e)&&vm(e)==L1e}var N8=f_&&f_.isSet,B1e=N8?eD(N8):F1e,V1e=1,U1e=2,$1e=4,UG="[object Arguments]",q1e="[object Array]",H1e="[object Boolean]",G1e="[object Date]",W1e="[object Error]",$G="[object Function]",Z1e="[object GeneratorFunction]",X1e="[object Map]",K1e="[object Number]",qG="[object Object]",Y1e="[object RegExp]",Q1e="[object Set]",J1e="[object String]",ebe="[object Symbol]",tbe="[object WeakMap]",nbe="[object ArrayBuffer]",rbe="[object DataView]",ibe="[object Float32Array]",abe="[object Float64Array]",sbe="[object Int8Array]",obe="[object Int16Array]",lbe="[object Int32Array]",cbe="[object Uint8Array]",ube="[object Uint8ClampedArray]",dbe="[object Uint16Array]",hbe="[object Uint32Array]",Ga={};Ga[UG]=Ga[q1e]=Ga[nbe]=Ga[rbe]=Ga[H1e]=Ga[G1e]=Ga[ibe]=Ga[abe]=Ga[sbe]=Ga[obe]=Ga[lbe]=Ga[X1e]=Ga[K1e]=Ga[qG]=Ga[Y1e]=Ga[Q1e]=Ga[J1e]=Ga[ebe]=Ga[cbe]=Ga[ube]=Ga[dbe]=Ga[hbe]=!0;Ga[W1e]=Ga[$G]=Ga[tbe]=!1;function Ub(e,t,n,r,l,d){var p,a=t&V1e,b=t&U1e,T=t&$1e;if(p!==void 0)return p;if(!Vw(e))return e;var E=Uw(e);if(E){if(p=o1e(e),!a)return zG(e,p)}else{var P=vm(e),I=P==$G||P==Z1e;if(NG(e))return q_e(e,a);if(P==qG||P==UG||I&&!l){if(p=b||I?{}:I1e(e),!a)return b?K_e(e,U_e(p,e)):Z_e(e,z_e(p,e))}else{if(!Ga[P])return l?e:{};p=D1e(e,P,a)}}d||(d=new P_);var R=d.get(e);if(R)return R;d.set(e,p),B1e(e)?e.forEach(function($){p.add(Ub($,t,n,$,e,d))}):z1e(e)&&e.forEach(function($,Z){p.set(Z,Ub($,t,n,Z,e,d))});var F=T?b?Q_e:Y_e:b?rD:nD,W=E?void 0:F(e);return Uve(W||e,function($,Z){W&&(Z=$,$=e[Z]),jG(p,Z,Ub($,t,n,Z,e,d))}),p}var fbe=1,pbe=4;function Sb(e){return Ub(e,fbe|pbe)}var p4,D8;function mbe(){if(D8)return p4;D8=1;var e=Array.isArray,t=Object.keys,n=Object.prototype.hasOwnProperty,r=typeof Element<"u";function l(d,p){if(d===p)return!0;if(d&&p&&typeof d=="object"&&typeof p=="object"){var a=e(d),b=e(p),T,E,P;if(a&&b){if(E=d.length,E!=p.length)return!1;for(T=E;T--!==0;)if(!l(d[T],p[T]))return!1;return!0}if(a!=b)return!1;var I=d instanceof Date,R=p instanceof Date;if(I!=R)return!1;if(I&&R)return d.getTime()==p.getTime();var F=d instanceof RegExp,W=p instanceof RegExp;if(F!=W)return!1;if(F&&W)return d.toString()==p.toString();var $=t(d);if(E=$.length,E!==t(p).length)return!1;for(T=E;T--!==0;)if(!n.call(p,$[T]))return!1;if(r&&d instanceof Element&&p instanceof Element)return d===p;for(T=E;T--!==0;)if(P=$[T],!(P==="_owner"&&d.$$typeof)&&!l(d[P],p[P]))return!1;return!0}return d!==d&&p!==p}return p4=function(p,a){try{return l(p,a)}catch(b){if(b.message&&b.message.match(/stack|recursion/i)||b.number===-2146828260)return console.warn("Warning: react-fast-compare does not handle circular references.",b.name,b.message),!1;throw b}},p4}var gbe=mbe();const $g=Gs(gbe);var xbe=4;function O8(e){return Ub(e,xbe)}function HG(e,t){for(var n=-1,r=e==null?0:e.length,l=Array(r);++n<r;)l[n]=t(e[n],n,e);return l}var ybe="[object Symbol]";function sD(e){return typeof e=="symbol"||Ty(e)&&Sy(e)==ybe}var vbe="Expected a function";function oD(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(vbe);var n=function(){var r=arguments,l=t?t.apply(this,r):r[0],d=n.cache;if(d.has(l))return d.get(l);var p=e.apply(this,r);return n.cache=d.set(l,p)||d,p};return n.cache=new(oD.Cache||fx),n}oD.Cache=fx;var _be=500;function bbe(e){var t=oD(e,function(r){return n.size===_be&&n.clear(),r}),n=t.cache;return t}var wbe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Sbe=/\\(\\)?/g,Tbe=bbe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(wbe,function(n,r,l,d){t.push(l?d.replace(Sbe,"$1"):r||n)}),t});function Ebe(e){if(typeof e=="string"||sD(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var I8=sx?sx.prototype:void 0,k8=I8?I8.toString:void 0;function GG(e){if(typeof e=="string")return e;if(Uw(e))return HG(e,GG)+"";if(sD(e))return k8?k8.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function Abe(e){return e==null?"":GG(e)}function WG(e){return Uw(e)?HG(e,Ebe):sD(e)?[e]:zG(Tbe(Abe(e)))}function Na(){return Na=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Na.apply(this,arguments)}function ZG(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function Xg(e,t){if(e==null)return{};var n={},r=Object.keys(e),l,d;for(d=0;d<r.length;d++)l=r[d],!(t.indexOf(l)>=0)&&(n[l]=e[l]);return n}function R8(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var w3=V.createContext(void 0);w3.displayName="FormikContext";var Cbe=w3.Provider,jbe=w3.Consumer;function mo(){var e=V.useContext(w3);return e}var z8=function(t){return Array.isArray(t)&&t.length===0},pl=function(t){return typeof t=="function"},$w=function(t){return t!==null&&typeof t=="object"},Mbe=function(t){return String(Math.floor(Number(t)))===t},m4=function(t){return Object.prototype.toString.call(t)==="[object String]"},XG=function(t){return V.Children.count(t)===0},g4=function(t){return $w(t)&&pl(t.then)};function ss(e,t,n,r){r===void 0&&(r=0);for(var l=WG(t);e&&r<l.length;)e=e[l[r++]];return r!==l.length&&!e||e===void 0?n:e}function rp(e,t,n){for(var r=O8(e),l=r,d=0,p=WG(t);d<p.length-1;d++){var a=p[d],b=ss(e,p.slice(0,d+1));if(b&&($w(b)||Array.isArray(b)))l=l[a]=O8(b);else{var T=p[d+1];l=l[a]=Mbe(T)&&Number(T)>=0?[]:{}}}return(d===0?e:l)[p[d]]===n?e:(n===void 0?delete l[p[d]]:l[p[d]]=n,d===0&&n===void 0&&delete r[p[d]],r)}function KG(e,t,n,r){n===void 0&&(n=new WeakMap),r===void 0&&(r={});for(var l=0,d=Object.keys(e);l<d.length;l++){var p=d[l],a=e[p];$w(a)?n.get(a)||(n.set(a,!0),r[p]=Array.isArray(a)?[]:{},KG(a,t,n,r[p])):r[p]=t}return r}function Pbe(e,t){switch(t.type){case"SET_VALUES":return Na({},e,{values:t.payload});case"SET_TOUCHED":return Na({},e,{touched:t.payload});case"SET_ERRORS":return $g(e.errors,t.payload)?e:Na({},e,{errors:t.payload});case"SET_STATUS":return Na({},e,{status:t.payload});case"SET_ISSUBMITTING":return Na({},e,{isSubmitting:t.payload});case"SET_ISVALIDATING":return Na({},e,{isValidating:t.payload});case"SET_FIELD_VALUE":return Na({},e,{values:rp(e.values,t.payload.field,t.payload.value)});case"SET_FIELD_TOUCHED":return Na({},e,{touched:rp(e.touched,t.payload.field,t.payload.value)});case"SET_FIELD_ERROR":return Na({},e,{errors:rp(e.errors,t.payload.field,t.payload.value)});case"RESET_FORM":return Na({},e,t.payload);case"SET_FORMIK_STATE":return t.payload(e);case"SUBMIT_ATTEMPT":return Na({},e,{touched:KG(e.values,!0),isSubmitting:!0,submitCount:e.submitCount+1});case"SUBMIT_FAILURE":return Na({},e,{isSubmitting:!1});case"SUBMIT_SUCCESS":return Na({},e,{isSubmitting:!1});default:return e}}var I0={},NS={};function Nbe(e){var t=e.validateOnChange,n=t===void 0?!0:t,r=e.validateOnBlur,l=r===void 0?!0:r,d=e.validateOnMount,p=d===void 0?!1:d,a=e.isInitialValid,b=e.enableReinitialize,T=b===void 0?!1:b,E=e.onSubmit,P=Xg(e,["validateOnChange","validateOnBlur","validateOnMount","isInitialValid","enableReinitialize","onSubmit"]),I=Na({validateOnChange:n,validateOnBlur:l,validateOnMount:p,onSubmit:E},P),R=V.useRef(I.initialValues),F=V.useRef(I.initialErrors||I0),W=V.useRef(I.initialTouched||NS),$=V.useRef(I.initialStatus),Z=V.useRef(!1),ne=V.useRef({});V.useEffect(function(){return Z.current=!0,function(){Z.current=!1}},[]);var ie=V.useState(0),ge=ie[1],ae=V.useRef({values:Sb(I.initialValues),errors:Sb(I.initialErrors)||I0,touched:Sb(I.initialTouched)||NS,status:Sb(I.initialStatus),isSubmitting:!1,isValidating:!1,submitCount:0}),se=ae.current,me=V.useCallback(function(Ft){var Hn=ae.current;ae.current=Pbe(Hn,Ft),Hn!==ae.current&&ge(function(Zt){return Zt+1})},[]),ke=V.useCallback(function(Ft,Hn){return new Promise(function(Zt,pn){var tr=I.validate(Ft,Hn);tr==null?Zt(I0):g4(tr)?tr.then(function(Qn){Zt(Qn||I0)},function(Qn){pn(Qn)}):Zt(tr)})},[I.validate]),qe=V.useCallback(function(Ft,Hn){var Zt=I.validationSchema,pn=pl(Zt)?Zt(Hn):Zt,tr=Hn&&pn.validateAt?pn.validateAt(Hn,Ft):Obe(Ft,pn);return new Promise(function(Qn,Yr){tr.then(function(){Qn(I0)},function(pi){pi.name==="ValidationError"?Qn(Dbe(pi)):Yr(pi)})})},[I.validationSchema]),tt=V.useCallback(function(Ft,Hn){return new Promise(function(Zt){return Zt(ne.current[Ft].validate(Hn))})},[]),nt=V.useCallback(function(Ft){var Hn=Object.keys(ne.current).filter(function(pn){return pl(ne.current[pn].validate)}),Zt=Hn.length>0?Hn.map(function(pn){return tt(pn,ss(Ft,pn))}):[Promise.resolve("DO_NOT_DELETE_YOU_WILL_BE_FIRED")];return Promise.all(Zt).then(function(pn){return pn.reduce(function(tr,Qn,Yr){return Qn==="DO_NOT_DELETE_YOU_WILL_BE_FIRED"||Qn&&(tr=rp(tr,Hn[Yr],Qn)),tr},{})})},[tt]),bt=V.useCallback(function(Ft){return Promise.all([nt(Ft),I.validationSchema?qe(Ft):{},I.validate?ke(Ft):{}]).then(function(Hn){var Zt=Hn[0],pn=Hn[1],tr=Hn[2],Qn=p5.all([Zt,pn,tr],{arrayMerge:Ibe});return Qn})},[I.validate,I.validationSchema,nt,ke,qe]),jt=Ed(function(Ft){return Ft===void 0&&(Ft=se.values),me({type:"SET_ISVALIDATING",payload:!0}),bt(Ft).then(function(Hn){return Z.current&&(me({type:"SET_ISVALIDATING",payload:!1}),me({type:"SET_ERRORS",payload:Hn})),Hn})});V.useEffect(function(){p&&Z.current===!0&&$g(R.current,I.initialValues)&&jt(R.current)},[p,jt]);var Nt=V.useCallback(function(Ft){var Hn=Ft&&Ft.values?Ft.values:R.current,Zt=Ft&&Ft.errors?Ft.errors:F.current?F.current:I.initialErrors||{},pn=Ft&&Ft.touched?Ft.touched:W.current?W.current:I.initialTouched||{},tr=Ft&&Ft.status?Ft.status:$.current?$.current:I.initialStatus;R.current=Hn,F.current=Zt,W.current=pn,$.current=tr;var Qn=function(){me({type:"RESET_FORM",payload:{isSubmitting:!!Ft&&!!Ft.isSubmitting,errors:Zt,touched:pn,status:tr,values:Hn,isValidating:!!Ft&&!!Ft.isValidating,submitCount:Ft&&Ft.submitCount&&typeof Ft.submitCount=="number"?Ft.submitCount:0}})};if(I.onReset){var Yr=I.onReset(se.values,Ir);g4(Yr)?Yr.then(Qn):Qn()}else Qn()},[I.initialErrors,I.initialStatus,I.initialTouched,I.onReset]);V.useEffect(function(){Z.current===!0&&!$g(R.current,I.initialValues)&&T&&(R.current=I.initialValues,Nt(),p&&jt(R.current))},[T,I.initialValues,Nt,p,jt]),V.useEffect(function(){T&&Z.current===!0&&!$g(F.current,I.initialErrors)&&(F.current=I.initialErrors||I0,me({type:"SET_ERRORS",payload:I.initialErrors||I0}))},[T,I.initialErrors]),V.useEffect(function(){T&&Z.current===!0&&!$g(W.current,I.initialTouched)&&(W.current=I.initialTouched||NS,me({type:"SET_TOUCHED",payload:I.initialTouched||NS}))},[T,I.initialTouched]),V.useEffect(function(){T&&Z.current===!0&&!$g($.current,I.initialStatus)&&($.current=I.initialStatus,me({type:"SET_STATUS",payload:I.initialStatus}))},[T,I.initialStatus,I.initialTouched]);var vt=Ed(function(Ft){if(ne.current[Ft]&&pl(ne.current[Ft].validate)){var Hn=ss(se.values,Ft),Zt=ne.current[Ft].validate(Hn);return g4(Zt)?(me({type:"SET_ISVALIDATING",payload:!0}),Zt.then(function(pn){return pn}).then(function(pn){me({type:"SET_FIELD_ERROR",payload:{field:Ft,value:pn}}),me({type:"SET_ISVALIDATING",payload:!1})})):(me({type:"SET_FIELD_ERROR",payload:{field:Ft,value:Zt}}),Promise.resolve(Zt))}else if(I.validationSchema)return me({type:"SET_ISVALIDATING",payload:!0}),qe(se.values,Ft).then(function(pn){return pn}).then(function(pn){me({type:"SET_FIELD_ERROR",payload:{field:Ft,value:ss(pn,Ft)}}),me({type:"SET_ISVALIDATING",payload:!1})});return Promise.resolve()}),He=V.useCallback(function(Ft,Hn){var Zt=Hn.validate;ne.current[Ft]={validate:Zt}},[]),ut=V.useCallback(function(Ft){delete ne.current[Ft]},[]),Tt=Ed(function(Ft,Hn){me({type:"SET_TOUCHED",payload:Ft});var Zt=Hn===void 0?l:Hn;return Zt?jt(se.values):Promise.resolve()}),Yt=V.useCallback(function(Ft){me({type:"SET_ERRORS",payload:Ft})},[]),Ge=Ed(function(Ft,Hn){var Zt=pl(Ft)?Ft(se.values):Ft;me({type:"SET_VALUES",payload:Zt});var pn=Hn===void 0?n:Hn;return pn?jt(Zt):Promise.resolve()}),ot=V.useCallback(function(Ft,Hn){me({type:"SET_FIELD_ERROR",payload:{field:Ft,value:Hn}})},[]),mt=Ed(function(Ft,Hn,Zt){me({type:"SET_FIELD_VALUE",payload:{field:Ft,value:Hn}});var pn=Zt===void 0?n:Zt;return pn?jt(rp(se.values,Ft,Hn)):Promise.resolve()}),It=V.useCallback(function(Ft,Hn){var Zt=Hn,pn=Ft,tr;if(!m4(Ft)){Ft.persist&&Ft.persist();var Qn=Ft.target?Ft.target:Ft.currentTarget,Yr=Qn.type,pi=Qn.name,Ua=Qn.id,Ji=Qn.value,Xs=Qn.checked;Qn.outerHTML;var Ka=Qn.options,La=Qn.multiple;Zt=Hn||pi||Ua,pn=/number|range/.test(Yr)?(tr=parseFloat(Ji),isNaN(tr)?"":tr):/checkbox/.test(Yr)?Rbe(ss(se.values,Zt),Xs,Ji):Ka&&La?kbe(Ka):Ji}Zt&&mt(Zt,pn)},[mt,se.values]),In=Ed(function(Ft){if(m4(Ft))return function(Hn){return It(Hn,Ft)};It(Ft)}),Mn=Ed(function(Ft,Hn,Zt){Hn===void 0&&(Hn=!0),me({type:"SET_FIELD_TOUCHED",payload:{field:Ft,value:Hn}});var pn=Zt===void 0?l:Zt;return pn?jt(se.values):Promise.resolve()}),vn=V.useCallback(function(Ft,Hn){Ft.persist&&Ft.persist();var Zt=Ft.target,pn=Zt.name,tr=Zt.id;Zt.outerHTML;var Qn=Hn||pn||tr;Mn(Qn,!0)},[Mn]),Zn=Ed(function(Ft){if(m4(Ft))return function(Hn){return vn(Hn,Ft)};vn(Ft)}),Sr=V.useCallback(function(Ft){pl(Ft)?me({type:"SET_FORMIK_STATE",payload:Ft}):me({type:"SET_FORMIK_STATE",payload:function(){return Ft}})},[]),un=V.useCallback(function(Ft){me({type:"SET_STATUS",payload:Ft})},[]),er=V.useCallback(function(Ft){me({type:"SET_ISSUBMITTING",payload:Ft})},[]),hr=Ed(function(){return me({type:"SUBMIT_ATTEMPT"}),jt().then(function(Ft){var Hn=Ft instanceof Error,Zt=!Hn&&Object.keys(Ft).length===0;if(Zt){var pn;try{if(pn=Zr(),pn===void 0)return}catch(tr){throw tr}return Promise.resolve(pn).then(function(tr){return Z.current&&me({type:"SUBMIT_SUCCESS"}),tr}).catch(function(tr){if(Z.current)throw me({type:"SUBMIT_FAILURE"}),tr})}else if(Z.current&&(me({type:"SUBMIT_FAILURE"}),Hn))throw Ft})}),dn=Ed(function(Ft){Ft&&Ft.preventDefault&&pl(Ft.preventDefault)&&Ft.preventDefault(),Ft&&Ft.stopPropagation&&pl(Ft.stopPropagation)&&Ft.stopPropagation(),hr().catch(function(Hn){console.warn("Warning: An unhandled error was caught from submitForm()",Hn)})}),Ir={resetForm:Nt,validateForm:jt,validateField:vt,setErrors:Yt,setFieldError:ot,setFieldTouched:Mn,setFieldValue:mt,setStatus:un,setSubmitting:er,setTouched:Tt,setValues:Ge,setFormikState:Sr,submitForm:hr},Zr=Ed(function(){return E(se.values,Ir)}),sa=Ed(function(Ft){Ft&&Ft.preventDefault&&pl(Ft.preventDefault)&&Ft.preventDefault(),Ft&&Ft.stopPropagation&&pl(Ft.stopPropagation)&&Ft.stopPropagation(),Nt()}),Mi=V.useCallback(function(Ft){return{value:ss(se.values,Ft),error:ss(se.errors,Ft),touched:!!ss(se.touched,Ft),initialValue:ss(R.current,Ft),initialTouched:!!ss(W.current,Ft),initialError:ss(F.current,Ft)}},[se.errors,se.touched,se.values]),Ci=V.useCallback(function(Ft){return{setValue:function(Zt,pn){return mt(Ft,Zt,pn)},setTouched:function(Zt,pn){return Mn(Ft,Zt,pn)},setError:function(Zt){return ot(Ft,Zt)}}},[mt,Mn,ot]),ls=V.useCallback(function(Ft){var Hn=$w(Ft),Zt=Hn?Ft.name:Ft,pn=ss(se.values,Zt),tr={name:Zt,value:pn,onChange:In,onBlur:Zn};if(Hn){var Qn=Ft.type,Yr=Ft.value,pi=Ft.as,Ua=Ft.multiple;Qn==="checkbox"?Yr===void 0?tr.checked=!!pn:(tr.checked=!!(Array.isArray(pn)&&~pn.indexOf(Yr)),tr.value=Yr):Qn==="radio"?(tr.checked=pn===Yr,tr.value=Yr):pi==="select"&&Ua&&(tr.value=tr.value||[],tr.multiple=!0)}return tr},[Zn,In,se.values]),wa=V.useMemo(function(){return!$g(R.current,se.values)},[R.current,se.values]),Xa=V.useMemo(function(){return typeof a<"u"?wa?se.errors&&Object.keys(se.errors).length===0:a!==!1&&pl(a)?a(I):a:se.errors&&Object.keys(se.errors).length===0},[a,wa,se.errors,I]),Ds=Na({},se,{initialValues:R.current,initialErrors:F.current,initialTouched:W.current,initialStatus:$.current,handleBlur:Zn,handleChange:In,handleReset:sa,handleSubmit:dn,resetForm:Nt,setErrors:Yt,setFormikState:Sr,setFieldTouched:Mn,setFieldValue:mt,setFieldError:ot,setStatus:un,setSubmitting:er,setTouched:Tt,setValues:Ge,submitForm:hr,validateForm:jt,validateField:vt,isValid:Xa,dirty:wa,unregisterField:ut,registerField:He,getFieldProps:ls,getFieldMeta:Mi,getFieldHelpers:Ci,validateOnBlur:l,validateOnChange:n,validateOnMount:p});return Ds}function ef(e){var t=Nbe(e),n=e.component,r=e.children,l=e.render,d=e.innerRef;return V.useImperativeHandle(d,function(){return t}),V.createElement(Cbe,{value:t},n?V.createElement(n,t):l?l(t):r?pl(r)?r(t):XG(r)?null:V.Children.only(r):null)}function Dbe(e){var t={};if(e.inner){if(e.inner.length===0)return rp(t,e.path,e.message);for(var l=e.inner,n=Array.isArray(l),r=0,l=n?l:l[Symbol.iterator]();;){var d;if(n){if(r>=l.length)break;d=l[r++]}else{if(r=l.next(),r.done)break;d=r.value}var p=d;ss(t,p.path)||(t=rp(t,p.path,p.message))}}return t}function Obe(e,t,n,r){n===void 0&&(n=!1);var l=v5(e);return t[n?"validateSync":"validate"](l,{abortEarly:!1,context:l})}function v5(e){var t=Array.isArray(e)?[]:{};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=String(n);Array.isArray(e[r])===!0?t[r]=e[r].map(function(l){return Array.isArray(l)===!0||u8(l)?v5(l):l!==""?l:void 0}):u8(e[r])?t[r]=v5(e[r]):t[r]=e[r]!==""?e[r]:void 0}return t}function Ibe(e,t,n){var r=e.slice();return t.forEach(function(d,p){if(typeof r[p]>"u"){var a=n.clone!==!1,b=a&&n.isMergeableObject(d);r[p]=b?p5(Array.isArray(d)?[]:{},d,n):d}else n.isMergeableObject(d)?r[p]=p5(e[p],d,n):e.indexOf(d)===-1&&r.push(d)}),r}function kbe(e){return Array.from(e).filter(function(t){return t.selected}).map(function(t){return t.value})}function Rbe(e,t,n){if(typeof e=="boolean")return!!t;var r=[],l=!1,d=-1;if(Array.isArray(e))r=e,d=e.indexOf(n),l=d>=0;else if(!n||n=="true"||n=="false")return!!t;return t&&n&&!l?r.concat(n):l?r.slice(0,d).concat(r.slice(d+1)):r}var zbe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?V.useLayoutEffect:V.useEffect;function Ed(e){var t=V.useRef(e);return zbe(function(){t.current=e}),V.useCallback(function(){for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return t.current.apply(void 0,r)},[])}function jn(e){var t=e.validate,n=e.name,r=e.render,l=e.children,d=e.as,p=e.component,a=e.className,b=Xg(e,["validate","name","render","children","as","component","className"]),T=mo(),E=Xg(T,["validate","validationSchema"]),P=E.registerField,I=E.unregisterField;V.useEffect(function(){return P(n,{validate:t}),function(){I(n)}},[P,I,n,t]);var R=E.getFieldProps(Na({name:n},b)),F=E.getFieldMeta(n),W={field:R,form:E};if(r)return r(Na({},W,{meta:F}));if(pl(l))return l(Na({},W,{meta:F}));if(p){if(typeof p=="string"){var $=b.innerRef,Z=Xg(b,["innerRef"]);return V.createElement(p,Na({ref:$},R,Z,{className:a}),l)}return V.createElement(p,Na({field:R,form:E},b,{className:a}),l)}var ne=d||"input";if(typeof ne=="string"){var ie=b.innerRef,ge=Xg(b,["innerRef"]);return V.createElement(ne,Na({ref:ie},R,ge,{className:a}),l)}return V.createElement(ne,Na({},R,b,{className:a}),l)}var Ud=V.forwardRef(function(e,t){var n=e.action,r=Xg(e,["action"]),l=n??"#",d=mo(),p=d.handleReset,a=d.handleSubmit;return V.createElement("form",Na({onSubmit:a,ref:t,onReset:p,action:l},r))});Ud.displayName="Form";function YG(e){var t=function(l){return V.createElement(jbe,null,function(d){return V.createElement(e,Na({},l,{formik:d}))})},n=e.displayName||e.name||e.constructor&&e.constructor.name||"Component";return t.WrappedComponent=e,t.displayName="FormikConnect("+n+")",Gue(t,e)}var Lbe=function(t,n,r){var l=my(t),d=l[n];return l.splice(n,1),l.splice(r,0,d),l},Fbe=function(t,n,r){var l=my(t),d=l[n];return l[n]=l[r],l[r]=d,l},x4=function(t,n,r){var l=my(t);return l.splice(n,0,r),l},Bbe=function(t,n,r){var l=my(t);return l[n]=r,l},my=function(t){if(t){if(Array.isArray(t))return[].concat(t);var n=Object.keys(t).map(function(r){return parseInt(r)}).reduce(function(r,l){return l>r?l:r},0);return Array.from(Na({},t,{length:n+1}))}else return[]},L8=function(t,n){var r=typeof t=="function"?t:n;return function(l){if(Array.isArray(l)||$w(l)){var d=my(l);return r(d)}return l}},QG=function(e){ZG(t,e);function t(r){var l;return l=e.call(this,r)||this,l.updateArrayField=function(d,p,a){var b=l.props,T=b.name,E=b.formik.setFormikState;E(function(P){var I=L8(a,d),R=L8(p,d),F=rp(P.values,T,d(ss(P.values,T))),W=a?I(ss(P.errors,T)):void 0,$=p?R(ss(P.touched,T)):void 0;return z8(W)&&(W=void 0),z8($)&&($=void 0),Na({},P,{values:F,errors:a?rp(P.errors,T,W):P.errors,touched:p?rp(P.touched,T,$):P.touched})})},l.push=function(d){return l.updateArrayField(function(p){return[].concat(my(p),[Sb(d)])},!1,!1)},l.handlePush=function(d){return function(){return l.push(d)}},l.swap=function(d,p){return l.updateArrayField(function(a){return Fbe(a,d,p)},!0,!0)},l.handleSwap=function(d,p){return function(){return l.swap(d,p)}},l.move=function(d,p){return l.updateArrayField(function(a){return Lbe(a,d,p)},!0,!0)},l.handleMove=function(d,p){return function(){return l.move(d,p)}},l.insert=function(d,p){return l.updateArrayField(function(a){return x4(a,d,p)},function(a){return x4(a,d,null)},function(a){return x4(a,d,null)})},l.handleInsert=function(d,p){return function(){return l.insert(d,p)}},l.replace=function(d,p){return l.updateArrayField(function(a){return Bbe(a,d,p)},!1,!1)},l.handleReplace=function(d,p){return function(){return l.replace(d,p)}},l.unshift=function(d){var p=-1;return l.updateArrayField(function(a){var b=a?[d].concat(a):[d];return p=b.length,b},function(a){return a?[null].concat(a):[null]},function(a){return a?[null].concat(a):[null]}),p},l.handleUnshift=function(d){return function(){return l.unshift(d)}},l.handleRemove=function(d){return function(){return l.remove(d)}},l.handlePop=function(){return function(){return l.pop()}},l.remove=l.remove.bind(R8(l)),l.pop=l.pop.bind(R8(l)),l}var n=t.prototype;return n.componentDidUpdate=function(l){this.props.validateOnChange&&this.props.formik.validateOnChange&&!$g(ss(l.formik.values,l.name),ss(this.props.formik.values,this.props.name))&&this.props.formik.validateForm(this.props.formik.values)},n.remove=function(l){var d;return this.updateArrayField(function(p){var a=p?my(p):[];return d||(d=a[l]),pl(a.splice)&&a.splice(l,1),pl(a.every)&&a.every(function(b){return b===void 0})?[]:a},!0,!0),d},n.pop=function(){var l;return this.updateArrayField(function(d){var p=d.slice();return l||(l=p&&p.pop&&p.pop()),p},!0,!0),l},n.render=function(){var l={push:this.push,pop:this.pop,swap:this.swap,move:this.move,insert:this.insert,replace:this.replace,unshift:this.unshift,remove:this.remove,handlePush:this.handlePush,handlePop:this.handlePop,handleSwap:this.handleSwap,handleMove:this.handleMove,handleInsert:this.handleInsert,handleReplace:this.handleReplace,handleUnshift:this.handleUnshift,handleRemove:this.handleRemove},d=this.props,p=d.component,a=d.render,b=d.children,T=d.name,E=d.formik,P=Xg(E,["validate","validationSchema"]),I=Na({},l,{form:P,name:T});return p?V.createElement(p,I):a?a(I):b?typeof b=="function"?b(I):XG(b)?null:V.Children.only(b):null},t}(V.Component);QG.defaultProps={validateOnChange:!0};var mw=YG(QG),Vbe=function(e){ZG(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;return n.shouldComponentUpdate=function(l){return ss(this.props.formik.errors,this.props.name)!==ss(l.formik.errors,this.props.name)||ss(this.props.formik.touched,this.props.name)!==ss(l.formik.touched,this.props.name)||Object.keys(this.props).length!==Object.keys(l).length},n.render=function(){var l=this.props,d=l.component,p=l.formik,a=l.render,b=l.children,T=l.name,E=Xg(l,["component","formik","render","children","name"]),P=ss(p.touched,T),I=ss(p.errors,T);return P&&I?a?pl(a)?a(I):null:b?pl(b)?b(I):null:d?V.createElement(d,E,I):I:null},t}(V.Component),wn=YG(Vbe),y4,F8;function Ube(){if(F8)return y4;F8=1;function e(Z){this._maxSize=Z,this.clear()}e.prototype.clear=function(){this._size=0,this._values=Object.create(null)},e.prototype.get=function(Z){return this._values[Z]},e.prototype.set=function(Z,ne){return this._size>=this._maxSize&&this.clear(),Z in this._values||this._size++,this._values[Z]=ne};var t=/[^.^\]^[]+|(?=\[\]|\.\.)/g,n=/^\d+$/,r=/^\d/,l=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,d=/^\s*(['"]?)(.*?)(\1)\s*$/,p=512,a=new e(p),b=new e(p),T=new e(p);y4={Cache:e,split:P,normalizePath:E,setter:function(Z){var ne=E(Z);return b.get(Z)||b.set(Z,function(ge,ae){for(var se=0,me=ne.length,ke=ge;se<me-1;){var qe=ne[se];if(qe==="__proto__"||qe==="constructor"||qe==="prototype")return ge;ke=ke[ne[se++]]}ke[ne[se]]=ae})},getter:function(Z,ne){var ie=E(Z);return T.get(Z)||T.set(Z,function(ae){for(var se=0,me=ie.length;se<me;)if(ae!=null||!ne)ae=ae[ie[se++]];else return;return ae})},join:function(Z){return Z.reduce(function(ne,ie){return ne+(R(ie)||n.test(ie)?"["+ie+"]":(ne?".":"")+ie)},"")},forEach:function(Z,ne,ie){I(Array.isArray(Z)?Z:P(Z),ne,ie)}};function E(Z){return a.get(Z)||a.set(Z,P(Z).map(function(ne){return ne.replace(d,"$2")}))}function P(Z){return Z.match(t)||[""]}function I(Z,ne,ie){var ge=Z.length,ae,se,me,ke;for(se=0;se<ge;se++)ae=Z[se],ae&&($(ae)&&(ae='"'+ae+'"'),ke=R(ae),me=!ke&&/^\d+$/.test(ae),ne.call(ie,ae,ke,me,se,Z))}function R(Z){return typeof Z=="string"&&Z&&["'",'"'].indexOf(Z.charAt(0))!==-1}function F(Z){return Z.match(r)&&!Z.match(n)}function W(Z){return l.test(Z)}function $(Z){return!R(Z)&&(F(Z)||W(Z))}return y4}var iy=Ube(),v4,B8;function $be(){if(B8)return v4;B8=1;const e=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['’](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['’](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['’](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['’](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,t=E=>E.match(e)||[],n=E=>E[0].toUpperCase()+E.slice(1),r=(E,P)=>t(E).join(P).toLowerCase(),l=E=>t(E).reduce((P,I)=>`${P}${P?I[0].toUpperCase()+I.slice(1).toLowerCase():I.toLowerCase()}`,"");return v4={words:t,upperFirst:n,camelCase:l,pascalCase:E=>n(l(E)),snakeCase:E=>r(E,"_"),kebabCase:E=>r(E,"-"),sentenceCase:E=>n(r(E," ")),titleCase:E=>t(E).map(n).join(" ")},v4}var _4=$be(),DS={exports:{}},V8;function qbe(){if(V8)return DS.exports;V8=1,DS.exports=function(l){return e(t(l),l)},DS.exports.array=e;function e(l,d){var p=l.length,a=new Array(p),b={},T=p,E=n(d),P=r(l);for(d.forEach(function(R){if(!P.has(R[0])||!P.has(R[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});T--;)b[T]||I(l[T],T,new Set);return a;function I(R,F,W){if(W.has(R)){var $;try{$=", node was:"+JSON.stringify(R)}catch{$=""}throw new Error("Cyclic dependency"+$)}if(!P.has(R))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(R));if(!b[F]){b[F]=!0;var Z=E.get(R)||new Set;if(Z=Array.from(Z),F=Z.length){W.add(R);do{var ne=Z[--F];I(ne,P.get(ne),W)}while(F);W.delete(R)}a[--p]=R}}}function t(l){for(var d=new Set,p=0,a=l.length;p<a;p++){var b=l[p];d.add(b[0]),d.add(b[1])}return Array.from(d)}function n(l){for(var d=new Map,p=0,a=l.length;p<a;p++){var b=l[p];d.has(b[0])||d.set(b[0],new Set),d.has(b[1])||d.set(b[1],new Set),d.get(b[0]).add(b[1])}return d}function r(l){for(var d=new Map,p=0,a=l.length;p<a;p++)d.set(l[p],p);return d}return DS.exports}var Hbe=qbe();const Gbe=Gs(Hbe),Wbe=Object.prototype.toString,Zbe=Error.prototype.toString,Xbe=RegExp.prototype.toString,Kbe=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",Ybe=/^Symbol\((.*)\)(.*)$/;function Qbe(e){return e!=+e?"NaN":e===0&&1/e<0?"-0":""+e}function U8(e,t=!1){if(e==null||e===!0||e===!1)return""+e;const n=typeof e;if(n==="number")return Qbe(e);if(n==="string")return t?`"${e}"`:e;if(n==="function")return"[Function "+(e.name||"anonymous")+"]";if(n==="symbol")return Kbe.call(e).replace(Ybe,"Symbol($1)");const r=Wbe.call(e).slice(8,-1);return r==="Date"?isNaN(e.getTime())?""+e:e.toISOString(e):r==="Error"||e instanceof Error?"["+Zbe.call(e)+"]":r==="RegExp"?Xbe.call(e):null}function Cm(e,t){let n=U8(e,t);return n!==null?n:JSON.stringify(e,function(r,l){let d=U8(this[r],t);return d!==null?d:l},2)}function JG(e){return e==null?[]:[].concat(e)}let eW,tW,nW,Jbe=/\$\{\s*(\w+)\s*\}/g;eW=Symbol.toStringTag;class $8{constructor(t,n,r,l){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[eW]="Error",this.name="ValidationError",this.value=n,this.path=r,this.type=l,this.errors=[],this.inner=[],JG(t).forEach(d=>{if(Uc.isError(d)){this.errors.push(...d.errors);const p=d.inner.length?d.inner:[d];this.inner.push(...p)}else this.errors.push(d)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}tW=Symbol.hasInstance;nW=Symbol.toStringTag;class Uc extends Error{static formatError(t,n){const r=n.label||n.path||"this";return n=Object.assign({},n,{path:r,originalPath:n.path}),typeof t=="string"?t.replace(Jbe,(l,d)=>Cm(n[d])):typeof t=="function"?t(n):t}static isError(t){return t&&t.name==="ValidationError"}constructor(t,n,r,l,d){const p=new $8(t,n,r,l);if(d)return p;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[nW]="Error",this.name=p.name,this.message=p.message,this.type=p.type,this.value=p.value,this.path=p.path,this.errors=p.errors,this.inner=p.inner,Error.captureStackTrace&&Error.captureStackTrace(this,Uc)}static[tW](t){return $8[Symbol.hasInstance](t)||super[Symbol.hasInstance](t)}}let Wf={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:e,type:t,value:n,originalValue:r})=>{const l=r!=null&&r!==n?` (cast from the value \`${Cm(r,!0)}\`).`:".";return t!=="mixed"?`${e} must be a \`${t}\` type, but the final value was: \`${Cm(n,!0)}\``+l:`${e} must match the configured type. The validated value was: \`${Cm(n,!0)}\``+l}},Bc={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},Ug={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},_5={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},b5={isValue:"${path} field must be ${value}"},yT={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},vT={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},ewe={notType:e=>{const{path:t,value:n,spec:r}=e,l=r.types.length;if(Array.isArray(n)){if(n.length<l)return`${t} tuple value has too few items, expected a length of ${l} but got ${n.length} for value: \`${Cm(n,!0)}\``;if(n.length>l)return`${t} tuple value has too many items, expected a length of ${l} but got ${n.length} for value: \`${Cm(n,!0)}\``}return Uc.formatError(Wf.notType,e)}};Object.assign(Object.create(null),{mixed:Wf,string:Bc,number:Ug,date:_5,object:yT,array:vT,boolean:b5,tuple:ewe});const S3=e=>e&&e.__isYupSchema__;class nE{static fromOptions(t,n){if(!n.then&&!n.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:r,then:l,otherwise:d}=n,p=typeof r=="function"?r:(...a)=>a.every(b=>b===r);return new nE(t,(a,b)=>{var T;let E=p(...a)?l:d;return(T=E==null?void 0:E(b))!=null?T:b})}constructor(t,n){this.fn=void 0,this.refs=t,this.refs=t,this.fn=n}resolve(t,n){let r=this.refs.map(d=>d.getValue(n==null?void 0:n.value,n==null?void 0:n.parent,n==null?void 0:n.context)),l=this.fn(r,t,n);if(l===void 0||l===t)return t;if(!S3(l))throw new TypeError("conditions must return a schema object");return l.resolve(n)}}const OS={context:"$",value:"."};class Cy{constructor(t,n={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof t!="string")throw new TypeError("ref must be a string, got: "+t);if(this.key=t.trim(),t==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===OS.context,this.isValue=this.key[0]===OS.value,this.isSibling=!this.isContext&&!this.isValue;let r=this.isContext?OS.context:this.isValue?OS.value:"";this.path=this.key.slice(r.length),this.getter=this.path&&iy.getter(this.path,!0),this.map=n.map}getValue(t,n,r){let l=this.isContext?r:this.isValue?t:n;return this.getter&&(l=this.getter(l||{})),this.map&&(l=this.map(l)),l}cast(t,n){return this.getValue(t,n==null?void 0:n.parent,n==null?void 0:n.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(t){return t&&t.__isYupRef}}Cy.prototype.__isYupRef=!0;const Xh=e=>e==null;function Bv(e){function t({value:n,path:r="",options:l,originalValue:d,schema:p},a,b){const{name:T,test:E,params:P,message:I,skipAbsent:R}=e;let{parent:F,context:W,abortEarly:$=p.spec.abortEarly,disableStackTrace:Z=p.spec.disableStackTrace}=l;function ne(nt){return Cy.isRef(nt)?nt.getValue(n,F,W):nt}function ie(nt={}){const bt=Object.assign({value:n,originalValue:d,label:p.spec.label,path:nt.path||r,spec:p.spec,disableStackTrace:nt.disableStackTrace||Z},P,nt.params);for(const Nt of Object.keys(bt))bt[Nt]=ne(bt[Nt]);const jt=new Uc(Uc.formatError(nt.message||I,bt),n,bt.path,nt.type||T,bt.disableStackTrace);return jt.params=bt,jt}const ge=$?a:b;let ae={path:r,parent:F,type:T,from:l.from,createError:ie,resolve:ne,options:l,originalValue:d,schema:p};const se=nt=>{Uc.isError(nt)?ge(nt):nt?b(null):ge(ie())},me=nt=>{Uc.isError(nt)?ge(nt):a(nt)};if(R&&Xh(n))return se(!0);let qe;try{var tt;if(qe=E.call(ae,n,ae),typeof((tt=qe)==null?void 0:tt.then)=="function"){if(l.sync)throw new Error(`Validation test of type: "${ae.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(qe).then(se,me)}}catch(nt){me(nt);return}se(qe)}return t.OPTIONS=e,t}function twe(e,t,n,r=n){let l,d,p;return t?(iy.forEach(t,(a,b,T)=>{let E=b?a.slice(1,a.length-1):a;e=e.resolve({context:r,parent:l,value:n});let P=e.type==="tuple",I=T?parseInt(E,10):0;if(e.innerType||P){if(P&&!T)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${p}" must contain an index to the tuple element, e.g. "${p}[0]"`);if(n&&I>=n.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${a}, in the path: ${t}. because there is no value at that index. `);l=n,n=n&&n[I],e=P?e.spec.types[I]:e.innerType}if(!T){if(!e.fields||!e.fields[E])throw new Error(`The schema does not contain the path: ${t}. (failed at: ${p} which is a type: "${e.type}")`);l=n,n=n&&n[E],e=e.fields[E]}d=E,p=b?"["+a+"]":"."+a}),{schema:e,parent:l,parentPath:d}):{parent:l,parentPath:t,schema:e}}class rE extends Set{describe(){const t=[];for(const n of this.values())t.push(Cy.isRef(n)?n.describe():n);return t}resolveAll(t){let n=[];for(const r of this.values())n.push(t(r));return n}clone(){return new rE(this.values())}merge(t,n){const r=this.clone();return t.forEach(l=>r.add(l)),n.forEach(l=>r.delete(l)),r}}function Qv(e,t=new Map){if(S3(e)||!e||typeof e!="object")return e;if(t.has(e))return t.get(e);let n;if(e instanceof Date)n=new Date(e.getTime()),t.set(e,n);else if(e instanceof RegExp)n=new RegExp(e),t.set(e,n);else if(Array.isArray(e)){n=new Array(e.length),t.set(e,n);for(let r=0;r<e.length;r++)n[r]=Qv(e[r],t)}else if(e instanceof Map){n=new Map,t.set(e,n);for(const[r,l]of e.entries())n.set(r,Qv(l,t))}else if(e instanceof Set){n=new Set,t.set(e,n);for(const r of e)n.add(Qv(r,t))}else if(e instanceof Object){n={},t.set(e,n);for(const[r,l]of Object.entries(e))n[r]=Qv(l,t)}else throw Error(`Unable to clone ${e}`);return n}class Zc{constructor(t){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new rE,this._blacklist=new rE,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(Wf.notType)}),this.type=t.type,this._typeCheck=t.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},t==null?void 0:t.spec),this.withMutation(n=>{n.nonNullable()})}get _type(){return this.type}clone(t){if(this._mutate)return t&&Object.assign(this.spec,t),this;const n=Object.create(Object.getPrototypeOf(this));return n.type=this.type,n._typeCheck=this._typeCheck,n._whitelist=this._whitelist.clone(),n._blacklist=this._blacklist.clone(),n.internalTests=Object.assign({},this.internalTests),n.exclusiveTests=Object.assign({},this.exclusiveTests),n.deps=[...this.deps],n.conditions=[...this.conditions],n.tests=[...this.tests],n.transforms=[...this.transforms],n.spec=Qv(Object.assign({},this.spec,t)),n}label(t){let n=this.clone();return n.spec.label=t,n}meta(...t){if(t.length===0)return this.spec.meta;let n=this.clone();return n.spec.meta=Object.assign(n.spec.meta||{},t[0]),n}withMutation(t){let n=this._mutate;this._mutate=!0;let r=t(this);return this._mutate=n,r}concat(t){if(!t||t===this)return this;if(t.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${t.type}`);let n=this,r=t.clone();const l=Object.assign({},n.spec,r.spec);return r.spec=l,r.internalTests=Object.assign({},n.internalTests,r.internalTests),r._whitelist=n._whitelist.merge(t._whitelist,t._blacklist),r._blacklist=n._blacklist.merge(t._blacklist,t._whitelist),r.tests=n.tests,r.exclusiveTests=n.exclusiveTests,r.withMutation(d=>{t.tests.forEach(p=>{d.test(p.OPTIONS)})}),r.transforms=[...n.transforms,...r.transforms],r}isType(t){return t==null?!!(this.spec.nullable&&t===null||this.spec.optional&&t===void 0):this._typeCheck(t)}resolve(t){let n=this;if(n.conditions.length){let r=n.conditions;n=n.clone(),n.conditions=[],n=r.reduce((l,d)=>d.resolve(l,t),n),n=n.resolve(t)}return n}resolveOptions(t){var n,r,l,d;return Object.assign({},t,{from:t.from||[],strict:(n=t.strict)!=null?n:this.spec.strict,abortEarly:(r=t.abortEarly)!=null?r:this.spec.abortEarly,recursive:(l=t.recursive)!=null?l:this.spec.recursive,disableStackTrace:(d=t.disableStackTrace)!=null?d:this.spec.disableStackTrace})}cast(t,n={}){let r=this.resolve(Object.assign({value:t},n)),l=n.assert==="ignore-optionality",d=r._cast(t,n);if(n.assert!==!1&&!r.isType(d)){if(l&&Xh(d))return d;let p=Cm(t),a=Cm(d);throw new TypeError(`The value of ${n.path||"field"} could not be cast to a value that satisfies the schema type: "${r.type}". 

attempted value: ${p} 
`+(a!==p?`result of cast: ${a}`:""))}return d}_cast(t,n){let r=t===void 0?t:this.transforms.reduce((l,d)=>d.call(this,l,t,this),t);return r===void 0&&(r=this.getDefault(n)),r}_validate(t,n={},r,l){let{path:d,originalValue:p=t,strict:a=this.spec.strict}=n,b=t;a||(b=this._cast(b,Object.assign({assert:!1},n)));let T=[];for(let E of Object.values(this.internalTests))E&&T.push(E);this.runTests({path:d,value:b,originalValue:p,options:n,tests:T},r,E=>{if(E.length)return l(E,b);this.runTests({path:d,value:b,originalValue:p,options:n,tests:this.tests},r,l)})}runTests(t,n,r){let l=!1,{tests:d,value:p,originalValue:a,path:b,options:T}=t,E=W=>{l||(l=!0,n(W,p))},P=W=>{l||(l=!0,r(W,p))},I=d.length,R=[];if(!I)return P([]);let F={value:p,originalValue:a,path:b,options:T,schema:this};for(let W=0;W<d.length;W++){const $=d[W];$(F,E,function(ne){ne&&(Array.isArray(ne)?R.push(...ne):R.push(ne)),--I<=0&&P(R)})}}asNestedTest({key:t,index:n,parent:r,parentPath:l,originalParent:d,options:p}){const a=t??n;if(a==null)throw TypeError("Must include `key` or `index` for nested validations");const b=typeof a=="number";let T=r[a];const E=Object.assign({},p,{strict:!0,parent:r,value:T,originalValue:d[a],key:void 0,[b?"index":"key"]:a,path:b||a.includes(".")?`${l||""}[${b?a:`"${a}"`}]`:(l?`${l}.`:"")+t});return(P,I,R)=>this.resolve(E)._validate(T,E,I,R)}validate(t,n){var r;let l=this.resolve(Object.assign({},n,{value:t})),d=(r=n==null?void 0:n.disableStackTrace)!=null?r:l.spec.disableStackTrace;return new Promise((p,a)=>l._validate(t,n,(b,T)=>{Uc.isError(b)&&(b.value=T),a(b)},(b,T)=>{b.length?a(new Uc(b,T,void 0,void 0,d)):p(T)}))}validateSync(t,n){var r;let l=this.resolve(Object.assign({},n,{value:t})),d,p=(r=n==null?void 0:n.disableStackTrace)!=null?r:l.spec.disableStackTrace;return l._validate(t,Object.assign({},n,{sync:!0}),(a,b)=>{throw Uc.isError(a)&&(a.value=b),a},(a,b)=>{if(a.length)throw new Uc(a,t,void 0,void 0,p);d=b}),d}isValid(t,n){return this.validate(t,n).then(()=>!0,r=>{if(Uc.isError(r))return!1;throw r})}isValidSync(t,n){try{return this.validateSync(t,n),!0}catch(r){if(Uc.isError(r))return!1;throw r}}_getDefault(t){let n=this.spec.default;return n==null?n:typeof n=="function"?n.call(this,t):Qv(n)}getDefault(t){return this.resolve(t||{})._getDefault(t)}default(t){return arguments.length===0?this._getDefault():this.clone({default:t})}strict(t=!0){return this.clone({strict:t})}nullability(t,n){const r=this.clone({nullable:t});return r.internalTests.nullable=Bv({message:n,name:"nullable",test(l){return l===null?this.schema.spec.nullable:!0}}),r}optionality(t,n){const r=this.clone({optional:t});return r.internalTests.optionality=Bv({message:n,name:"optionality",test(l){return l===void 0?this.schema.spec.optional:!0}}),r}optional(){return this.optionality(!0)}defined(t=Wf.defined){return this.optionality(!1,t)}nullable(){return this.nullability(!0)}nonNullable(t=Wf.notNull){return this.nullability(!1,t)}required(t=Wf.required){return this.clone().withMutation(n=>n.nonNullable(t).defined(t))}notRequired(){return this.clone().withMutation(t=>t.nullable().optional())}transform(t){let n=this.clone();return n.transforms.push(t),n}test(...t){let n;if(t.length===1?typeof t[0]=="function"?n={test:t[0]}:n=t[0]:t.length===2?n={name:t[0],test:t[1]}:n={name:t[0],message:t[1],test:t[2]},n.message===void 0&&(n.message=Wf.default),typeof n.test!="function")throw new TypeError("`test` is a required parameters");let r=this.clone(),l=Bv(n),d=n.exclusive||n.name&&r.exclusiveTests[n.name]===!0;if(n.exclusive&&!n.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return n.name&&(r.exclusiveTests[n.name]=!!n.exclusive),r.tests=r.tests.filter(p=>!(p.OPTIONS.name===n.name&&(d||p.OPTIONS.test===l.OPTIONS.test))),r.tests.push(l),r}when(t,n){!Array.isArray(t)&&typeof t!="string"&&(n=t,t=".");let r=this.clone(),l=JG(t).map(d=>new Cy(d));return l.forEach(d=>{d.isSibling&&r.deps.push(d.key)}),r.conditions.push(typeof n=="function"?new nE(l,n):nE.fromOptions(l,n)),r}typeError(t){let n=this.clone();return n.internalTests.typeError=Bv({message:t,name:"typeError",skipAbsent:!0,test(r){return this.schema._typeCheck(r)?!0:this.createError({params:{type:this.schema.type}})}}),n}oneOf(t,n=Wf.oneOf){let r=this.clone();return t.forEach(l=>{r._whitelist.add(l),r._blacklist.delete(l)}),r.internalTests.whiteList=Bv({message:n,name:"oneOf",skipAbsent:!0,test(l){let d=this.schema._whitelist,p=d.resolveAll(this.resolve);return p.includes(l)?!0:this.createError({params:{values:Array.from(d).join(", "),resolved:p}})}}),r}notOneOf(t,n=Wf.notOneOf){let r=this.clone();return t.forEach(l=>{r._blacklist.add(l),r._whitelist.delete(l)}),r.internalTests.blacklist=Bv({message:n,name:"notOneOf",test(l){let d=this.schema._blacklist,p=d.resolveAll(this.resolve);return p.includes(l)?this.createError({params:{values:Array.from(d).join(", "),resolved:p}}):!0}}),r}strip(t=!0){let n=this.clone();return n.spec.strip=t,n}describe(t){const n=(t?this.resolve(t):this).clone(),{label:r,meta:l,optional:d,nullable:p}=n.spec;return{meta:l,label:r,optional:d,nullable:p,default:n.getDefault(t),type:n.type,oneOf:n._whitelist.describe(),notOneOf:n._blacklist.describe(),tests:n.tests.map(b=>({name:b.OPTIONS.name,params:b.OPTIONS.params})).filter((b,T,E)=>E.findIndex(P=>P.name===b.name)===T)}}}Zc.prototype.__isYupSchema__=!0;for(const e of["validate","validateSync"])Zc.prototype[`${e}At`]=function(t,n,r={}){const{parent:l,parentPath:d,schema:p}=twe(this,t,n,r.context);return p[e](l&&l[d],Object.assign({},r,{parent:l,path:t}))};for(const e of["equals","is"])Zc.prototype[e]=Zc.prototype.oneOf;for(const e of["not","nope"])Zc.prototype[e]=Zc.prototype.notOneOf;const nwe=()=>!0;function ps(e){return new rW(e)}class rW extends Zc{constructor(t){super(typeof t=="function"?{type:"mixed",check:t}:Object.assign({type:"mixed",check:nwe},t))}}ps.prototype=rW.prototype;function Id(){return new iW}class iW extends Zc{constructor(){super({type:"boolean",check(t){return t instanceof Boolean&&(t=t.valueOf()),typeof t=="boolean"}}),this.withMutation(()=>{this.transform((t,n,r)=>{if(r.spec.coerce&&!r.isType(t)){if(/^(true|1)$/i.test(String(t)))return!0;if(/^(false|0)$/i.test(String(t)))return!1}return t})})}isTrue(t=b5.isValue){return this.test({message:t,name:"is-value",exclusive:!0,params:{value:"true"},test(n){return Xh(n)||n===!0}})}isFalse(t=b5.isValue){return this.test({message:t,name:"is-value",exclusive:!0,params:{value:"false"},test(n){return Xh(n)||n===!1}})}default(t){return super.default(t)}defined(t){return super.defined(t)}optional(){return super.optional()}required(t){return super.required(t)}notRequired(){return super.notRequired()}nullable(){return super.nullable()}nonNullable(t){return super.nonNullable(t)}strip(t){return super.strip(t)}}Id.prototype=iW.prototype;const rwe=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function iwe(e){const t=w5(e);if(!t)return Date.parse?Date.parse(e):Number.NaN;if(t.z===void 0&&t.plusMinus===void 0)return new Date(t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond).valueOf();let n=0;return t.z!=="Z"&&t.plusMinus!==void 0&&(n=t.hourOffset*60+t.minuteOffset,t.plusMinus==="+"&&(n=0-n)),Date.UTC(t.year,t.month,t.day,t.hour,t.minute+n,t.second,t.millisecond)}function w5(e){var t,n;const r=rwe.exec(e);return r?{year:ym(r[1]),month:ym(r[2],1)-1,day:ym(r[3],1),hour:ym(r[4]),minute:ym(r[5]),second:ym(r[6]),millisecond:r[7]?ym(r[7].substring(0,3)):0,precision:(t=(n=r[7])==null?void 0:n.length)!=null?t:void 0,z:r[8]||void 0,plusMinus:r[9]||void 0,hourOffset:ym(r[10]),minuteOffset:ym(r[11])}:null}function ym(e,t=0){return Number(e)||t}let awe=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,swe=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,owe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,lwe="^\\d{4}-\\d{2}-\\d{2}",cwe="\\d{2}:\\d{2}:\\d{2}",uwe="(([+-]\\d{2}(:?\\d{2})?)|Z)",dwe=new RegExp(`${lwe}T${cwe}(\\.\\d+)?${uwe}$`),hwe=e=>Xh(e)||e===e.trim(),fwe={}.toString();function On(){return new aW}class aW extends Zc{constructor(){super({type:"string",check(t){return t instanceof String&&(t=t.valueOf()),typeof t=="string"}}),this.withMutation(()=>{this.transform((t,n,r)=>{if(!r.spec.coerce||r.isType(t)||Array.isArray(t))return t;const l=t!=null&&t.toString?t.toString():t;return l===fwe?t:l})})}required(t){return super.required(t).withMutation(n=>n.test({message:t||Wf.required,name:"required",skipAbsent:!0,test:r=>!!r.length}))}notRequired(){return super.notRequired().withMutation(t=>(t.tests=t.tests.filter(n=>n.OPTIONS.name!=="required"),t))}length(t,n=Bc.length){return this.test({message:n,name:"length",exclusive:!0,params:{length:t},skipAbsent:!0,test(r){return r.length===this.resolve(t)}})}min(t,n=Bc.min){return this.test({message:n,name:"min",exclusive:!0,params:{min:t},skipAbsent:!0,test(r){return r.length>=this.resolve(t)}})}max(t,n=Bc.max){return this.test({name:"max",exclusive:!0,message:n,params:{max:t},skipAbsent:!0,test(r){return r.length<=this.resolve(t)}})}matches(t,n){let r=!1,l,d;return n&&(typeof n=="object"?{excludeEmptyString:r=!1,message:l,name:d}=n:l=n),this.test({name:d||"matches",message:l||Bc.matches,params:{regex:t},skipAbsent:!0,test:p=>p===""&&r||p.search(t)!==-1})}email(t=Bc.email){return this.matches(awe,{name:"email",message:t,excludeEmptyString:!0})}url(t=Bc.url){return this.matches(swe,{name:"url",message:t,excludeEmptyString:!0})}uuid(t=Bc.uuid){return this.matches(owe,{name:"uuid",message:t,excludeEmptyString:!1})}datetime(t){let n="",r,l;return t&&(typeof t=="object"?{message:n="",allowOffset:r=!1,precision:l=void 0}=t:n=t),this.matches(dwe,{name:"datetime",message:n||Bc.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:n||Bc.datetime_offset,params:{allowOffset:r},skipAbsent:!0,test:d=>{if(!d||r)return!0;const p=w5(d);return p?!!p.z:!1}}).test({name:"datetime_precision",message:n||Bc.datetime_precision,params:{precision:l},skipAbsent:!0,test:d=>{if(!d||l==null)return!0;const p=w5(d);return p?p.precision===l:!1}})}ensure(){return this.default("").transform(t=>t===null?"":t)}trim(t=Bc.trim){return this.transform(n=>n!=null?n.trim():n).test({message:t,name:"trim",test:hwe})}lowercase(t=Bc.lowercase){return this.transform(n=>Xh(n)?n:n.toLowerCase()).test({message:t,name:"string_case",exclusive:!0,skipAbsent:!0,test:n=>Xh(n)||n===n.toLowerCase()})}uppercase(t=Bc.uppercase){return this.transform(n=>Xh(n)?n:n.toUpperCase()).test({message:t,name:"string_case",exclusive:!0,skipAbsent:!0,test:n=>Xh(n)||n===n.toUpperCase()})}}On.prototype=aW.prototype;let pwe=e=>e!=+e;function kd(){return new sW}class sW extends Zc{constructor(){super({type:"number",check(t){return t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&!pwe(t)}}),this.withMutation(()=>{this.transform((t,n,r)=>{if(!r.spec.coerce)return t;let l=t;if(typeof l=="string"){if(l=l.replace(/\s/g,""),l==="")return NaN;l=+l}return r.isType(l)||l===null?l:parseFloat(l)})})}min(t,n=Ug.min){return this.test({message:n,name:"min",exclusive:!0,params:{min:t},skipAbsent:!0,test(r){return r>=this.resolve(t)}})}max(t,n=Ug.max){return this.test({message:n,name:"max",exclusive:!0,params:{max:t},skipAbsent:!0,test(r){return r<=this.resolve(t)}})}lessThan(t,n=Ug.lessThan){return this.test({message:n,name:"max",exclusive:!0,params:{less:t},skipAbsent:!0,test(r){return r<this.resolve(t)}})}moreThan(t,n=Ug.moreThan){return this.test({message:n,name:"min",exclusive:!0,params:{more:t},skipAbsent:!0,test(r){return r>this.resolve(t)}})}positive(t=Ug.positive){return this.moreThan(0,t)}negative(t=Ug.negative){return this.lessThan(0,t)}integer(t=Ug.integer){return this.test({name:"integer",message:t,skipAbsent:!0,test:n=>Number.isInteger(n)})}truncate(){return this.transform(t=>Xh(t)?t:t|0)}round(t){var n;let r=["ceil","floor","round","trunc"];if(t=((n=t)==null?void 0:n.toLowerCase())||"round",t==="trunc")return this.truncate();if(r.indexOf(t.toLowerCase())===-1)throw new TypeError("Only valid options for round() are: "+r.join(", "));return this.transform(l=>Xh(l)?l:Math[t](l))}}kd.prototype=sW.prototype;let oW=new Date(""),mwe=e=>Object.prototype.toString.call(e)==="[object Date]";function gy(){return new qw}class qw extends Zc{constructor(){super({type:"date",check(t){return mwe(t)&&!isNaN(t.getTime())}}),this.withMutation(()=>{this.transform((t,n,r)=>!r.spec.coerce||r.isType(t)||t===null?t:(t=iwe(t),isNaN(t)?qw.INVALID_DATE:new Date(t)))})}prepareParam(t,n){let r;if(Cy.isRef(t))r=t;else{let l=this.cast(t);if(!this._typeCheck(l))throw new TypeError(`\`${n}\` must be a Date or a value that can be \`cast()\` to a Date`);r=l}return r}min(t,n=_5.min){let r=this.prepareParam(t,"min");return this.test({message:n,name:"min",exclusive:!0,params:{min:t},skipAbsent:!0,test(l){return l>=this.resolve(r)}})}max(t,n=_5.max){let r=this.prepareParam(t,"max");return this.test({message:n,name:"max",exclusive:!0,params:{max:t},skipAbsent:!0,test(l){return l<=this.resolve(r)}})}}qw.INVALID_DATE=oW;gy.prototype=qw.prototype;gy.INVALID_DATE=oW;function gwe(e,t=[]){let n=[],r=new Set,l=new Set(t.map(([p,a])=>`${p}-${a}`));function d(p,a){let b=iy.split(p)[0];r.add(b),l.has(`${a}-${b}`)||n.push([a,b])}for(const p of Object.keys(e)){let a=e[p];r.add(p),Cy.isRef(a)&&a.isSibling?d(a.path,p):S3(a)&&"deps"in a&&a.deps.forEach(b=>d(b,p))}return Gbe.array(Array.from(r),n).reverse()}function q8(e,t){let n=1/0;return e.some((r,l)=>{var d;if((d=t.path)!=null&&d.includes(r))return n=l,!0}),n}function lW(e){return(t,n)=>q8(e,t)-q8(e,n)}const cW=(e,t,n)=>{if(typeof e!="string")return e;let r=e;try{r=JSON.parse(e)}catch{}return n.isType(r)?r:e};function _T(e){if("fields"in e){const t={};for(const[n,r]of Object.entries(e.fields))t[n]=_T(r);return e.setFields(t)}if(e.type==="array"){const t=e.optional();return t.innerType&&(t.innerType=_T(t.innerType)),t}return e.type==="tuple"?e.optional().clone({types:e.spec.types.map(_T)}):"optional"in e?e.optional():e}const xwe=(e,t)=>{const n=[...iy.normalizePath(t)];if(n.length===1)return n[0]in e;let r=n.pop(),l=iy.getter(iy.join(n),!0)(e);return!!(l&&r in l)};let H8=e=>Object.prototype.toString.call(e)==="[object Object]";function G8(e,t){let n=Object.keys(e.fields);return Object.keys(t).filter(r=>n.indexOf(r)===-1)}const ywe=lW([]);function li(e){return new uW(e)}class uW extends Zc{constructor(t){super({type:"object",check(n){return H8(n)||typeof n=="function"}}),this.fields=Object.create(null),this._sortErrors=ywe,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{t&&this.shape(t)})}_cast(t,n={}){var r;let l=super._cast(t,n);if(l===void 0)return this.getDefault(n);if(!this._typeCheck(l))return l;let d=this.fields,p=(r=n.stripUnknown)!=null?r:this.spec.noUnknown,a=[].concat(this._nodes,Object.keys(l).filter(P=>!this._nodes.includes(P))),b={},T=Object.assign({},n,{parent:b,__validating:n.__validating||!1}),E=!1;for(const P of a){let I=d[P],R=P in l;if(I){let F,W=l[P];T.path=(n.path?`${n.path}.`:"")+P,I=I.resolve({value:W,context:n.context,parent:b});let $=I instanceof Zc?I.spec:void 0,Z=$==null?void 0:$.strict;if($!=null&&$.strip){E=E||P in l;continue}F=!n.__validating||!Z?I.cast(l[P],T):l[P],F!==void 0&&(b[P]=F)}else R&&!p&&(b[P]=l[P]);(R!==P in b||b[P]!==l[P])&&(E=!0)}return E?b:l}_validate(t,n={},r,l){let{from:d=[],originalValue:p=t,recursive:a=this.spec.recursive}=n;n.from=[{schema:this,value:p},...d],n.__validating=!0,n.originalValue=p,super._validate(t,n,r,(b,T)=>{if(!a||!H8(T)){l(b,T);return}p=p||T;let E=[];for(let P of this._nodes){let I=this.fields[P];!I||Cy.isRef(I)||E.push(I.asNestedTest({options:n,key:P,parent:T,parentPath:n.path,originalParent:p}))}this.runTests({tests:E,value:T,originalValue:p,options:n},r,P=>{l(P.sort(this._sortErrors).concat(b),T)})})}clone(t){const n=super.clone(t);return n.fields=Object.assign({},this.fields),n._nodes=this._nodes,n._excludedEdges=this._excludedEdges,n._sortErrors=this._sortErrors,n}concat(t){let n=super.concat(t),r=n.fields;for(let[l,d]of Object.entries(this.fields)){const p=r[l];r[l]=p===void 0?d:p}return n.withMutation(l=>l.setFields(r,[...this._excludedEdges,...t._excludedEdges]))}_getDefault(t){if("default"in this.spec)return super._getDefault(t);if(!this._nodes.length)return;let n={};return this._nodes.forEach(r=>{var l;const d=this.fields[r];let p=t;(l=p)!=null&&l.value&&(p=Object.assign({},p,{parent:p.value,value:p.value[r]})),n[r]=d&&"getDefault"in d?d.getDefault(p):void 0}),n}setFields(t,n){let r=this.clone();return r.fields=t,r._nodes=gwe(t,n),r._sortErrors=lW(Object.keys(t)),n&&(r._excludedEdges=n),r}shape(t,n=[]){return this.clone().withMutation(r=>{let l=r._excludedEdges;return n.length&&(Array.isArray(n[0])||(n=[n]),l=[...r._excludedEdges,...n]),r.setFields(Object.assign(r.fields,t),l)})}partial(){const t={};for(const[n,r]of Object.entries(this.fields))t[n]="optional"in r&&r.optional instanceof Function?r.optional():r;return this.setFields(t)}deepPartial(){return _T(this)}pick(t){const n={};for(const r of t)this.fields[r]&&(n[r]=this.fields[r]);return this.setFields(n,this._excludedEdges.filter(([r,l])=>t.includes(r)&&t.includes(l)))}omit(t){const n=[];for(const r of Object.keys(this.fields))t.includes(r)||n.push(r);return this.pick(n)}from(t,n,r){let l=iy.getter(t,!0);return this.transform(d=>{if(!d)return d;let p=d;return xwe(d,t)&&(p=Object.assign({},d),r||delete p[t],p[n]=l(d)),p})}json(){return this.transform(cW)}exact(t){return this.test({name:"exact",exclusive:!0,message:t||yT.exact,test(n){if(n==null)return!0;const r=G8(this.schema,n);return r.length===0||this.createError({params:{properties:r.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(t=!0,n=yT.noUnknown){typeof t!="boolean"&&(n=t,t=!0);let r=this.test({name:"noUnknown",exclusive:!0,message:n,test(l){if(l==null)return!0;const d=G8(this.schema,l);return!t||d.length===0||this.createError({params:{unknown:d.join(", ")}})}});return r.spec.noUnknown=t,r}unknown(t=!0,n=yT.noUnknown){return this.noUnknown(!t,n)}transformKeys(t){return this.transform(n=>{if(!n)return n;const r={};for(const l of Object.keys(n))r[t(l)]=n[l];return r})}camelCase(){return this.transformKeys(_4.camelCase)}snakeCase(){return this.transformKeys(_4.snakeCase)}constantCase(){return this.transformKeys(t=>_4.snakeCase(t).toUpperCase())}describe(t){const n=(t?this.resolve(t):this).clone(),r=super.describe(t);r.fields={};for(const[d,p]of Object.entries(n.fields)){var l;let a=t;(l=a)!=null&&l.value&&(a=Object.assign({},a,{parent:a.value,value:a.value[d]})),r.fields[d]=p.describe(a)}return r}}li.prototype=uW.prototype;function bc(e){return new dW(e)}class dW extends Zc{constructor(t){super({type:"array",spec:{types:t},check(n){return Array.isArray(n)}}),this.innerType=void 0,this.innerType=t}_cast(t,n){const r=super._cast(t,n);if(!this._typeCheck(r)||!this.innerType)return r;let l=!1;const d=r.map((p,a)=>{const b=this.innerType.cast(p,Object.assign({},n,{path:`${n.path||""}[${a}]`}));return b!==p&&(l=!0),b});return l?d:r}_validate(t,n={},r,l){var d;let p=this.innerType,a=(d=n.recursive)!=null?d:this.spec.recursive;n.originalValue!=null&&n.originalValue,super._validate(t,n,r,(b,T)=>{var E;if(!a||!p||!this._typeCheck(T)){l(b,T);return}let P=new Array(T.length);for(let R=0;R<T.length;R++){var I;P[R]=p.asNestedTest({options:n,index:R,parent:T,parentPath:n.path,originalParent:(I=n.originalValue)!=null?I:t})}this.runTests({value:T,tests:P,originalValue:(E=n.originalValue)!=null?E:t,options:n},r,R=>l(R.concat(b),T))})}clone(t){const n=super.clone(t);return n.innerType=this.innerType,n}json(){return this.transform(cW)}concat(t){let n=super.concat(t);return n.innerType=this.innerType,t.innerType&&(n.innerType=n.innerType?n.innerType.concat(t.innerType):t.innerType),n}of(t){let n=this.clone();if(!S3(t))throw new TypeError("`array.of()` sub-schema must be a valid yup schema not: "+Cm(t));return n.innerType=t,n.spec=Object.assign({},n.spec,{types:t}),n}length(t,n=vT.length){return this.test({message:n,name:"length",exclusive:!0,params:{length:t},skipAbsent:!0,test(r){return r.length===this.resolve(t)}})}min(t,n){return n=n||vT.min,this.test({message:n,name:"min",exclusive:!0,params:{min:t},skipAbsent:!0,test(r){return r.length>=this.resolve(t)}})}max(t,n){return n=n||vT.max,this.test({message:n,name:"max",exclusive:!0,params:{max:t},skipAbsent:!0,test(r){return r.length<=this.resolve(t)}})}ensure(){return this.default(()=>[]).transform((t,n)=>this._typeCheck(t)?t:n==null?[]:[].concat(n))}compact(t){let n=t?(r,l,d)=>!t(r,l,d):r=>!!r;return this.transform(r=>r!=null?r.filter(n):r)}describe(t){const n=(t?this.resolve(t):this).clone(),r=super.describe(t);if(n.innerType){var l;let d=t;(l=d)!=null&&l.value&&(d=Object.assign({},d,{parent:d.value,value:d.value[0]})),r.innerType=n.innerType.describe(d)}return r}}bc.prototype=dW.prototype;async function vwe(e){const r=`${e}/auth/google/mobile?redirect=${encodeURIComponent("communidades://oauth-callback")}&returnTo=${encodeURIComponent("/dashboard/perfil")}`;await i3.open({url:r})}const _we=li().shape({email:On().email("Correo inválido").required("Campo obligatorio"),password:On().min(6,"Mínimo 6 caracteres").required("Campo obligatorio")}),b4=e=>e>=1024?"/images/3.png":e>=768?"/images/2.png":"/images/1.png";function bwe(){var ne;const e=br(),t=aa(),n=yl(),r=((ne=n.state)==null?void 0:ne.redirectTo)||"/dashboard/perfil",l=new URLSearchParams(n.search),d=l.get("verified"),p=l.get("reason"),[a,b]=V.useState("");V.useEffect(()=>{b(d==="1"?"¡Correo verificado! Ya puedes iniciar sesión.":d==="0"?p==="expired"?"Tu enlace de verificación expiró. Podemos reenviártelo.":"El enlace de verificación no es válido. Podemos reenviártelo.":"")},[d,p]);const[T,E]=V.useState(()=>typeof window>"u"?"/images/3.png":b4(window.innerWidth));V.useEffect(()=>{var se;E(b4(window.innerWidth)),((se=navigator.connection)==null?void 0:se.saveData)&&E("/images/1.png");let ge=!1;const ae=()=>{ge||(window.requestAnimationFrame(()=>{const me=b4(window.innerWidth);E(ke=>ke===me?ke:me),ge=!1}),ge=!0)};return window.addEventListener("resize",ae,{passive:!0}),()=>window.removeEventListener("resize",ae)},[]);const P=async(ie,{setSubmitting:ge,setErrors:ae})=>{try{const se={email:ie.email.trim().toLowerCase(),password:ie.password},me=await Yre(se);e(_M(me)),t(r)}catch(se){console.error("Error en login:",se),ae({email:"Correo o contraseña incorrectos"})}finally{ge(!1)}},I=async()=>{if(_y){await vwe("https://apidev.communidades.com/api");return}const ie=500,ge=600,ae=window.screen.width/2-ie/2,se=window.screen.height/2-ge/2;window.open("https://api.communidades.com/api/auth/google","_blank",`width=${ie},height=${ge},left=${ae},top=${se}`);const qe=async tt=>{var nt;if(!(!(tt!=null&&tt.data)||((nt=tt.data)==null?void 0:nt.type)!=="oauth:success"))try{const{usuario:bt}=await mU();e(_M(bt)),t(r)}catch(bt){console.error("Error al obtener usuario después de login con Google:",bt)}finally{window.removeEventListener("message",qe)}};window.addEventListener("message",qe,{once:!0})},[R,F]=V.useState(""),[W,$]=V.useState(!1),Z=async()=>{if(R)try{$(!0),await gU(R.trim().toLowerCase()),b("Listo, te reenviamos el correo de verificación.")}catch(ie){console.error(ie),b("No pudimos reenviar el correo. Intenta más tarde.")}finally{$(!1)}};return f.jsxs(f.Fragment,{children:[f.jsx(Oa,{children:f.jsx("title",{children:"Communidades | Iniciar sesión"})}),f.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-cover bg-center relative px-2 py-10 gap-2",style:{backgroundImage:`url(${T})`},children:f.jsxs("div",{className:"relative w-full max-w-md mx-auto p-8 bg-white/40 backdrop-blur-md rounded-2xl shadow-2xl text-black",children:[f.jsx("h2",{className:"text-md md:text-lg font-bold text-center mb-6 tracking-wide",children:"¡Qué alegría tenerte de vuelta!"}),a&&f.jsxs("div",{className:"mb-4 p-3 rounded-lg bg-black/10 text-black text-xs",children:[a,d==="0"&&f.jsxs("div",{className:"mt-2 space-y-2",children:[f.jsx("input",{type:"email",value:R,onChange:ie=>F(ie.target.value),placeholder:"correo@ejemplo.com",className:"w-full px-3 py-2 rounded-lg bg-black/10"}),f.jsx("button",{type:"button",onClick:Z,disabled:W,className:"w-full bg-black/80 hover:bg-black disabled:opacity-60 disabled:cursor-not-allowed text-white py-2 rounded-lg font-semibold",children:W?"Reenviando...":"Reenviar verificación"})]})]}),f.jsx(ef,{initialValues:{email:"",password:""},validationSchema:_we,onSubmit:P,children:({isSubmitting:ie})=>f.jsxs(Ud,{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"email",className:"text-xs font-medium block mb-1",children:"Correo electrónico"}),f.jsx(jn,{id:"email",name:"email",type:"email",placeholder:"correo@ejemplo.com",autoComplete:"email",autoFocus:!0,className:"w-full px-4 py-1 border border-black/10 bg-black/30 rounded-lg placeholder:text-gray-300 focus:outline-none focus:ring-2 focus:ring-orange-500"}),f.jsx(wn,{name:"email",component:"div",className:"text-red-400 text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"password",className:"text-xs font-medium block mb-1",children:"Contraseña"}),f.jsx(jn,{id:"password",name:"password",type:"password",placeholder:"••••••••",autoComplete:"current-password",className:"w-full px-4 py-1 border border-black/10 bg-black/30 rounded-lg placeholder:text-gray-300 focus:outline-none focus:ring-2 focus:ring-orange-500"}),f.jsx(wn,{name:"password",component:"div",className:"text-red-400 text-xs mt-1"})]}),f.jsx("button",{type:"submit",disabled:ie,className:"w-full text-xs md:text-sm bg-orange-600 hover:bg-orange-700 disabled:opacity-60 disabled:cursor-not-allowed text-white py-2 rounded-lg font-semibold transition",children:ie?"Entrando...":"Entrar"}),f.jsxs("button",{type:"button",onClick:I,className:"w-full text-xs md:text-sm border border-black/10 bg-black/30 text-white py-2 rounded-lg font-semibold hover:bg-white/20 transition flex items-center justify-center gap-3",children:[f.jsx("span",{className:"relative flex items-center justify-center w-6 h-6 bg-white rounded-full shadow-md",children:f.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",children:[f.jsx("path",{fill:"#FFC107",d:"M43.6 20.5H42V20H24v8h11.3C34.2 32.5 29.5 36 24 36c-6.6 0-12-5.4-12-12s5.4-12 12-12c3.1 0 5.9 1.2 8 3.1l5.7-5.7C34.9 6.8 29.7 4 24 4 12.9 4 4 12.9 4 24s8.9 20 20 20c11 0 20-8 20-20 0-1.3-.1-2.5-.4-3.5z"}),f.jsx("path",{fill:"#FF3D00",d:"M6.3 14.7l6.6 4.8C14.2 16.2 18.8 14 24 14c3.1 0 5.9 1.2 8 3.1l5.7-5.7C34.9 6.8 29.7 4 24 4 16.1 4 9.1 8.6 6.3 14.7z"}),f.jsx("path",{fill:"#4CAF50",d:"M24 44c5.4 0 10.3-2.1 14-5.4l-6.5-5.3C29.9 35.5 27.1 36 24 36c-5.5 0-10.2-3.5-11.9-8.3l-6.6 5.1C9.1 39.4 16.1 44 24 44z"}),f.jsx("path",{fill:"#1976D2",d:"M43.6 20.5H42V20H24v8h11.3c-1.7 4.1-5.6 7-10.3 7-5.5 0-10.2-3.5-11.9-8.3l-6.6 5.1C9.1 39.4 16.1 44 24 44c11 0 20-8 20-20 0-1.3-.1-2.5-.4-3.5z"})]})}),f.jsx("span",{className:"relative z-10",children:"Iniciar sesión con Google"})]}),f.jsx("div",{className:"text-center text-gray-900 text-xs",children:"¿No tienes cuenta?"}),f.jsx(Wn,{to:"/registro",className:"block text-xs md:text-sm text-center border border-black/10 bg-black/30 border-white/20 text-white py-2 rounded-lg font-semibold hover:bg-white/20 transition",children:"Regístrate"})]})}),f.jsx("div",{className:"flex justify-center mt-8 relative z-10",children:f.jsxs("div",{className:"relative inline-block orbit-wrapper",children:[f.jsx("img",{src:s3,alt:"Logo Communidades",className:"h-24 opacity-90 relative z-20 logo-pulse select-none pointer-events-none",draggable:"false"}),f.jsx("span",{className:"orbit-sphere sphere1"}),f.jsx("span",{className:"orbit-sphere sphere2"}),f.jsx("span",{className:"orbit-sphere sphere3"})]})})]})})]})}const wwe=li().shape({name:On().min(2,"Muy corto").required("Campo obligatorio"),email:On().email("Correo inválido").required("Campo obligatorio"),password:On().min(8,"Mínimo 8 caracteres").required("Campo obligatorio")});function Swe(){const e=br(),t=aa(),[n,r]=V.useState(!1),l=async(d,{setSubmitting:p,setErrors:a})=>{var b,T,E;try{const P={name:d.name.trim(),email:d.email.trim().toLowerCase(),password:d.password},I=await Qre(P);e(_M(I));const F=((b=I==null?void 0:I.user)==null?void 0:b.isVerified)===!0?"/dashboard/perfil":`/verifica-tu-correo?email=${encodeURIComponent(P.email)}`;t(F)}catch(P){console.error("Error al registrar:",P);const I=((E=(T=P==null?void 0:P.response)==null?void 0:T.data)==null?void 0:E.msg)||"No se pudo registrar. Intenta más tarde.";a({email:I})}finally{p(!1)}};return f.jsxs(f.Fragment,{children:[f.jsx(Oa,{children:f.jsx("title",{children:"Communidades | Registro"})}),f.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-cover bg-center relative gap-2 py-7 px-2",style:{backgroundImage:"url(/images/1.png)"},children:f.jsxs("div",{className:"relative w-full max-w-md mx-auto p-8 bg-white/40 backdrop-blur-md rounded-2xl shadow-2xl text-black",children:[f.jsx("h2",{className:"text-lg font-bold text-center mb-6 tracking-wide",children:"Crear cuenta"}),f.jsx(ef,{initialValues:{name:"",email:"",password:""},validationSchema:wwe,onSubmit:l,children:({isSubmitting:d})=>f.jsxs(Ud,{className:"space-y-5",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"name",className:"text-xs font-medium block mb-1",children:"Nombre"}),f.jsx(jn,{id:"name",name:"name",placeholder:"Tu nombre",autoComplete:"given-name",autoFocus:!0,className:"w-full px-4 py-2 border border-black/10 bg-black/30 rounded-lg placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"name",component:"div",className:"text-red-400 text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"email",className:"text-xs font-medium block mb-1",children:"Correo electrónico"}),f.jsx(jn,{id:"email",name:"email",type:"email",placeholder:"correo@ejemplo.com",autoComplete:"email",className:"w-full px-4 py-2 border border-black/10 bg-black/30 rounded-lg placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"email",component:"div",className:"text-red-400 text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"password",className:"text-xs font-medium block mb-1",children:"Contraseña"}),f.jsxs("div",{className:"relative",children:[f.jsx(jn,{id:"password",name:"password",type:n?"text":"password",placeholder:"••••••••",autoComplete:"new-password",className:"w-full pr-10 px-4 py-2 border border-black/10 bg-black/30 rounded-lg placeholder:text-gray-300 focus:outline-none"}),f.jsx("button",{type:"button",onClick:()=>r(p=>!p),className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-white/80","aria-label":n?"Ocultar contraseña":"Mostrar contraseña",children:n?"Ocultar":"Mostrar"})]}),f.jsx(wn,{name:"password",component:"div",className:"text-red-400 text-xs mt-1"})]}),f.jsx("button",{type:"submit",disabled:d,className:"w-full bg-orange-600 hover:bg-orange-700 disabled:opacity-60 disabled:cursor-not-allowed text-white py-2 rounded-lg font-semibold transition",children:d?"Creando cuenta...":"Registrarse"})]})}),f.jsxs("div",{className:"text-center mt-4",children:[f.jsx("p",{className:"text-gray-900 text-xs mb-2",children:"¿Ya tienes cuenta?"}),f.jsx(Wn,{to:"/login",className:"block text-xs md:text-sm text-center border border-black/10 bg-black/30 text-white py-2 rounded-lg font-semibold hover:bg-white/20 transition",children:"Volver al inicio de sesión"})]}),f.jsx("div",{className:"flex justify-center mt-8",children:f.jsx("img",{src:s3,alt:"Logo Communidades",className:"h-20 opacity-90 logo-pulse select-none pointer-events-none",draggable:"false"})})]})})]})}function Twe(){const[e]=p$(),t=aa(),n=e.get("email")||"",[r,l]=V.useState(n),[d,p]=V.useState(!1),[a,b]=V.useState(""),T=V.useMemo(()=>/\S+@\S+\.\S+/.test(r),[r]),E=async()=>{var I;if(T)try{p(!0),await gU(r.trim().toLowerCase()),b("Listo, te reenviamos el correo. Revisa tu bandeja y Spam.")}catch(R){const F=(I=R==null?void 0:R.response)==null?void 0:I.status;b(F===429?"Demasiados intentos. Prueba en unos minutos.":"No pudimos reenviar. Intenta más tarde.")}finally{p(!1)}},P=async()=>{try{p(!0);const{usuario:I}=await mU();if(I!=null&&I.isVerified)return t("/dashboard/perfil");b("Aún no vemos tu correo verificado. Revisa el enlace del email.")}catch{b("Inicia sesión de nuevo para continuar."),t("/login")}finally{p(!1)}};return f.jsx("div",{className:"min-h-screen grid place-items-center bg-cover bg-center px-4 py-10",style:{backgroundImage:"url(/images/1.png)"},children:f.jsxs("div",{className:"w-full max-w-md bg-white/40 backdrop-blur-md p-6 rounded-2xl shadow",children:[f.jsx("h1",{className:"text-lg font-bold mb-1 text-center",children:"Verifica tu correo"}),f.jsxs("p",{className:"text-sm text-center mb-5",children:["Te enviamos un enlace de verificación",n?` a ${n}`:"","."]}),f.jsx("label",{className:"text-xs font-medium block mb-1",children:"Correo"}),f.jsx("input",{value:r,onChange:I=>l(I.target.value),placeholder:"correo@ejemplo.com",autoComplete:"email",className:"w-full px-3 py-2 rounded-lg bg-black/10 mb-3 focus:outline-none focus:ring-2 focus:ring-orange-500"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:E,disabled:!T||d,className:"flex-1 bg-black/80 text-white py-2 rounded-lg font-semibold disabled:opacity-60",children:d?"Reenviando...":"Reenviar verificación"}),f.jsx("button",{onClick:P,disabled:d,className:"flex-1 bg-orange-600 hover:bg-orange-700 text-white py-2 rounded-lg font-semibold disabled:opacity-60",children:"Ya verifiqué"})]}),a&&f.jsx("p",{className:"text-xs mt-3 text-center","aria-live":"polite",children:a}),f.jsx("div",{className:"mt-6 flex justify-center",children:f.jsx("img",{src:s3,alt:"Logo Communidades",className:"h-16 opacity-90 select-none pointer-events-none",draggable:"false",loading:"lazy"})})]})})}function Ewe({businessName:e="Nombre del negocio",backgroundImageUrl:t=""}){const n=(t==null?void 0:t.trim())!==""?t:"https://via.placeholder.com/1200x400?text=Imagen+no+disponible";return f.jsx("div",{className:`relative w-screen left-1/2 right-1/2 -translate-x-1/2\r
                 sm:relative sm:w-full sm:left-0 sm:right-0 sm:translate-x-0\r
                 bg-cover bg-center min-h-[220px] sm:min-h-[300px] lg:min-h-[400px] flex flex-col justify-end md:rounded-xl overflow-hidden shadow-sm`,style:{backgroundImage:`linear-gradient(0deg, rgba(0,0,0,0.4), rgba(0,0,0,0)), url(${n})`},children:f.jsx("div",{className:"p-6 sm:p-10",children:f.jsx("h1",{className:"text-white text-3xl sm:text-4xl font-bold leading-tight drop-shadow-md",children:e})})})}function Awe({contact:e}){if(!e)return null;const{phone:t,email:n,website:r}=e,l=({label:d,value:p,href:a,Icon:b})=>f.jsxs("div",{className:"flex items-center gap-4 bg-white px-4 min-h-[72px] py-2",children:[f.jsx("div",{className:"flex items-center justify-center rounded-lg bg-gray-100 shrink-0 size-12",children:b&&f.jsx(b,{size:20,className:"text-gray-600"})}),f.jsxs("div",{className:"flex flex-col justify-center",children:[f.jsx("p",{className:"text-gray-900 text-base font-medium leading-normal line-clamp-1",children:a?f.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:p}):p}),f.jsx("p",{className:"text-gray-500  text-xs font-normal leading-normal line-clamp-1",children:d})]})]});return f.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[f.jsx("h2",{className:"text-gray-900 text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5",children:"Contacto"}),f.jsxs("div",{className:"flex flex-col",children:[n&&f.jsx(l,{Icon:qP,label:"Correo electrónico",value:n,href:`mailto:${n}`}),t&&f.jsx(l,{Icon:Rce,label:"Teléfono",value:t,href:`tel:${t}`}),r&&f.jsx(l,{Icon:tw,label:"Sitio web",value:r,href:r})]})]})}function Cwe({hours:e}){if(!Array.isArray(e)||e.length===0)return null;const t={monday:"Lunes",tuesday:"Martes",wednesday:"Miércoles",thursday:"Jueves",friday:"Viernes",saturday:"Sábado",sunday:"Domingo"};return f.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[f.jsx("h2",{className:"text-[#181411] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5",children:"Horarios de atención"}),f.jsx("div",{className:"p-4 grid grid-cols-2",children:e.map(({day:n,open:r,close:l,closed:d},p)=>f.jsxs("div",{className:`flex flex-col gap-1 border-t border-solid border-t-[#e6e0db] py-4 ${p%2===0?"pr-2":"pl-2"} ${p===e.length-1&&e.length%2!==0?"col-span-2 pr-[50%]":""}`,children:[f.jsx("p",{className:"text-[#8a7460]  text-xs font-normal leading-normal capitalize",children:t[n.toLowerCase()]||n}),f.jsx("p",{className:"text-[#181411]  text-xs font-normal leading-normal",children:d?"Cerrado":`${r} - ${l}`})]},p))}),f.jsx("p",{className:"text-gray-400 text-xs px-4 pb-4",children:"*Horario habitual, sujeto a cambios.*"})]})}function jwe({imageUrl:e,categoryName:t,businessName:n,businessDescription:r,highlightText:l}){return f.jsx("div",{className:"",children:f.jsxs("div",{className:"flex flex-row items-stretch bg-white rounded-2xl shadow-lg  transition-all overflow-hidden",children:[f.jsx("div",{className:"w-[30vw] md:w-40 aspect-square bg-center bg-cover bg-no-repeat shrink-0",style:{backgroundImage:`url("${e}")`}}),f.jsxs("div",{className:"flex flex-col justify-between flex-grow gap-2 px-4 py-3",children:[f.jsx("p",{className:"text-xs md:  text-xs text-gray-500 font-medium",children:t}),f.jsx("p",{className:"  text-xs md:text-lg font-semibold text-gray-900",children:n}),f.jsx("div",{className:"flex flex-col gap-1 text-xs text-gray-600",children:f.jsx("p",{className:"line-clamp-2",children:r})})]})]})})}function hW({galleryImages:e=[]}){const[t,n]=V.useState(null);if(!Array.isArray(e)||e.length===0)return null;const r=e.slice(0,8);return f.jsxs("div",{className:"w-full",children:[f.jsx("h2",{className:"text-[#181411] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5",children:"Galeria"}),f.jsx("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(220px,1fr))] gap-4 p-2",children:r.map((l,d)=>f.jsx("button",{onClick:()=>n(l),className:"group relative w-full rounded-xl overflow-hidden",children:f.jsx("div",{className:"w-full bg-center bg-no-repeat aspect-[4/3] bg-cover rounded-xl shadow-sm group-hover:scale-[1.02] transition",style:{backgroundImage:`url("${l}")`}})},d))}),t&&f.jsx("div",{className:"fixed inset-0 z-50 bg-black/80 flex items-center justify-center p-4",onClick:()=>n(null),children:f.jsxs("div",{className:"relative w-full max-w-full lg:max-w-[50%]",onClick:l=>l.stopPropagation(),children:[f.jsx("button",{onClick:()=>n(null),className:"absolute border top-2 right-2 transition rounded-md text-white text-md px-1 hover:text-orange-400",children:"cerrar"}),f.jsx("img",{src:t,alt:"Imagen ampliada",className:"w-full h-auto max-h-[80vh] lg:max-h-[60vh] object-contain "})]})})]})}function fW({entityType:e,entityId:t}){const[n,r]=V.useState(!1),l=aa(),d=br();yl();const p=ln(b=>b.auth.usuario),a=async()=>{if(!p){d(Jt({message:"Debes iniciar sesión para enviar un mensaje.",type:"error"}));return}r(!0);try{const T=(await Rn.post("/conversations",{entityType:e,entityId:t})).data._id;l(`/dashboard/inbox/conversation/${T}`)}catch{d(Jt({message:"Hubo un error al iniciar la conversación.",type:"error"}))}finally{r(!1)}};return f.jsx("button",{onClick:a,disabled:n,className:`flex items-center gap-2 px-4 py-1.5 rounded-xl transition-all shadow-md  text-xs font-semibold
        ${n?"bg-gray-100 text-gray-400 border border-gray-300 cursor-not-allowed":"bg-white hover:bg-blue-50 text-blue-600 border border-blue-300"}
      `,title:"Enviar mensaje",children:n?f.jsx("span",{className:"animate-pulse",children:"Abriendo chat..."}):f.jsxs(f.Fragment,{children:[f.jsx(_le,{className:"text-lg"}),f.jsx("span",{className:"sm:inline",children:"Habla con nosotros"})]})})}const pW=({targetType:e,targetId:t})=>{const[n,r]=V.useState([]),[l,d]=V.useState(""),[p,a]=V.useState(!1),b=br(),{usuario:T}=ln(R=>R.auth),E=async()=>{try{const R=await Rn.get(`/comments/${e}/${t}`);r(R.data)}catch(R){console.error("Error al obtener comentarios:",R)}};V.useEffect(()=>{E()},[e,t]);const P=async R=>{if(R.preventDefault(),!T){b(Jt({message:"Debes iniciar sesión para comentar.",type:"error"}));return}if(l.trim()){a(!0);try{await Rn.post("/comments",{content:l,targetType:e,targetId:t}),d(""),E()}catch(F){console.error("Error creando comentario:",F)}finally{a(!1)}}},I=async R=>{try{await Rn.delete(`/comments/${R}`),E()}catch(F){console.error("Error eliminando comentario:",F)}};return f.jsxs("div",{className:"mt-6 border-t pt-4",children:[f.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Comentarios"}),f.jsxs("form",{onSubmit:P,className:"mb-4 flex flex-col gap-2",children:[f.jsx("div",{className:"w-full md:w-[80%]",children:f.jsx("textarea",{value:l,onChange:R=>d(R.target.value),className:`\r
              w-full\r
              bg-[#F4F9FE]\r
              border border-gray-200\r
              rounded-lg\r
              p-2\r
               text-xs\r
              placeholder:text-xs\r
              placeholder:text-gray-500\r
              focus:outline-none focus:ring-2 focus:ring-blue-200\r
              transition\r
            `,rows:3,placeholder:T?"Escribí tu comentario...":"Iniciá sesión para dejar un comentario",disabled:!T})}),f.jsx("div",{className:"w-full md:w-[80%] flex justify-end",children:f.jsx("button",{type:"submit",disabled:p,className:`flex items-center justify-center gap-2 shadow-md hover:shadow-lg px-3 py-2 rounded border border-gray-300 transition text-xs font-medium ${p||!T?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-white text-gray-600 hover:bg-gray-50"}`,children:p?"Enviando...":f.jsxs(f.Fragment,{children:[f.jsx(Tle,{className:"text-base"}),"Comentar"]})})})]}),n.length===0&&f.jsx("p",{className:"  text-xs text-gray-500",children:"No hay comentarios aún."}),f.jsx("ul",{className:"space-y-4 w-full",children:n.map(R=>{var F,W,$;return f.jsxs("li",{className:`\r
              border bg-[#F4F9FE] border-gray-200 p-3 rounded-lg\r
              w-full  md:w-[60%] md:max-w-[80%]\r
            `,children:[f.jsxs("div",{className:"flex justify-between items-center mb-1",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[((F=R.author)==null?void 0:F.profileImage)&&f.jsx("img",{src:R.author.profileImage,alt:"avatar",className:"w-6 h-6 rounded-full"}),f.jsx("span",{className:"text-xs text-gray-700 font-semibold",children:(W=R.author)==null?void 0:W.name})]}),f.jsx("span",{className:"text-xs text-gray-500",children:new Date(R.createdAt).toLocaleString()})]}),f.jsx("p",{className:"text-gray-500  text-xs",children:R.content}),T&&T.id===(($=R.author)==null?void 0:$.id)&&f.jsx("button",{onClick:()=>I(R._id),className:"text-red-500 text-xs mt-1",children:"Eliminar"})]},R._id)})})]})};function mW({targetType:e,targetId:t,initialLikes:n=[],className:r}){const{usuario:l}=ln(Z=>Z.auth),d=br(),[p,a]=V.useState(0),[b,T]=V.useState(!1),[E,P]=V.useState(!1),[I,R]=V.useState(!1),[F,W]=V.useState(!1);V.useEffect(()=>{if(Array.isArray(n)){a(n.length);const Z=l?n.some(ne=>ne.toString()===l._id):!1;T(Z),R(!Z)}},[n.length,l==null?void 0:l._id,t]);const $=async()=>{if(!l){d(Jt({message:"Debes iniciar sesión para dar me gusta.",type:"error"}));return}P(!0);try{const Z=e==="business"?`/businesses/${t}/like`:`/events/${t}/like`,ne=await Rn.put(Z);a(ne.data.likesCount),T(ne.data.liked),R(!1),ne.data.liked&&(W(!0),setTimeout(()=>W(!1),600))}catch{d(Jt({message:"Error al marcar me gusta.",type:"error"}))}finally{P(!1)}};return f.jsxs("div",{className:"relative flex flex-col items-start gap-1",children:[f.jsxs("button",{onClick:$,disabled:E,className:`flex items-center gap-1 bg-white transition px-3 py-2 rounded text-xs font-medium ${r}`,title:b?"Quitar me gusta":"Dar me gusta",children:[b?f.jsx(Yoe,{className:`text-4xl text-red-500 transition ${F?"heartbeat":""}`}):f.jsx(ele,{className:"text-4xl text-gray-400 transition"}),f.jsx("span",{className:"  text-xs text-gray-500",children:p})]}),I&&f.jsx("span",{className:"text-[14px] text-gray-500 pl-1 pt-1 animate-fade-in",onClick:()=>R(!1),children:"💡 ¿Te gustó este lugar? Dale un ❤️"})]})}const gW=({targetType:e,targetId:t})=>{const{usuario:n}=ln($=>$.auth),r=br(),[l,d]=V.useState(0),[p,a]=V.useState(0),[b,T]=V.useState(0),[E,P]=V.useState(0),[I,R]=V.useState(!1),F=async()=>{try{const $=await Rn.get(`/ratings/${e}/${t}/avg`);d($.data.avg),a($.data.count),$.data.userRating&&T($.data.userRating)}catch($){console.error("Error fetching average rating:",$)}};V.useEffect(()=>{F()},[e,t]);const W=async $=>{if(!n){r(Jt({message:"Debes iniciar sesión para calificar.",type:"error"}));return}T($),R(!0);try{await Rn.post("/ratings",{value:$,targetType:e,targetId:t}),F(),r(Jt({message:"¡Gracias por tu calificación!",type:"success"}))}catch{r(Jt({message:"Error al enviar calificación",type:"error"}))}finally{setTimeout(()=>R(!1),800)}};return f.jsxs("div",{className:"flex flex-col items-start gap-1  text-xs",children:[f.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map($=>{const Z=E?E>=$:b?b>=$:l>=$;return f.jsx(LM,{size:22,onMouseEnter:()=>P($),onMouseLeave:()=>P(0),onClick:()=>W($),className:`cursor-pointer transition-transform duration-200 ${Z?"text-yellow-400":"text-gray-300"} ${I&&b===$?"animate-pulse-heart":""}`},$)})}),b===0&&f.jsx("div",{className:"text-gray-500 text-xs",children:"¿Qué te pareció este lugar? ¡Dejá tu calificación!"}),p>0&&f.jsxs("div",{className:"text-gray-600 text-xs",children:[l.toFixed(1)," de 5 (",p," valoraciones)"]})]})};function W8(){return f.jsx("div",{className:"max-w-[1200px] w-full mx-auto flex flex-col gap-6 animate-pulse",children:f.jsx("div",{className:"w-full h-40 bg-gray-100 rounded-md"})})}function xW({title:e,image:t,descuento:n,maxClaims:r,claimedCount:l=0,businessId:d,isPremium:p=!1}){const[a,b]=V.useState(!1),T=ln($=>{var Z;return(Z=$.negocios.lista)==null?void 0:Z.find(ne=>ne._id===d)}),E=T==null?void 0:T.profileImage;V.useEffect(()=>{const $=()=>b(window.innerWidth<768);return $(),window.addEventListener("resize",$),()=>window.removeEventListener("resize",$)},[]);const P=typeof r=="number"&&!Number.isNaN(r),I=P?Math.max(0,r-(l||0)):null,R=P?I===0:n==="0 disponibles"||(n==null?void 0:n.includes("0 disponibles")),F=P?R?"Cupones agotados":`${I} disponibles`:n||"Disponible",W=`
    relative group z-0 overflow-hidden transition my-4
    aspect-[9/16] rounded-[1.5rem] w-[220px] sm:w-[280px] md:w-[300px] lg:w-[245px] xl:w-[225px]
    hover:shadow-lg bg-gray-100
    ${p?"border-1 border-yellow-200 shadow-[0_0_10px_3px_rgba(234,179,8,0.4)]":"shadow-md"}
  `;return f.jsxs("div",{className:W,children:[t&&f.jsx("div",{className:"absolute inset-0 bg-cover bg-center transition-transform duration-500",style:{backgroundImage:`url("${t}")`}}),f.jsx("div",{className:`absolute inset-0 bg-black/50 transition-opacity duration-500 ${a?"opacity-100":"opacity-0 group-hover:opacity-100"}`}),p&&f.jsx("div",{className:"absolute top-3 left-3 z-30 flex items-center gap-1 bg-black/70 text-yellow-300 px-2 py-1 rounded-full text-xs",children:f.jsx(UN,{className:"w-4 h-4"})}),f.jsx("div",{className:`m-4 transform transition-all duration-900 text-xs font-semibold text-center rounded-full py-1.5 px-4 self-center 
          ${a?"scale-105":"group-hover:-translate-y-1 group-hover:scale-105"}
          ${R?"bg-white text-red-700":p?"bg-black shadow-[0_0_30px_20px_rgba(234,179,8,0.4)] text-green-300":"bg-white shadow-md text-green-700"}
        `,children:F}),E&&f.jsx("div",{className:"absolute bottom-3 right-3 z-30",children:f.jsx("img",{src:E,alt:"Logo del negocio",className:"w-16 h-16 rounded-full border-2 border-white shadow-md"})}),f.jsx("div",{className:`absolute bottom-0 left-0 right-0 h-full flex items-end justify-center transition-all duration-500 z-20 pointer-events-none ${a?"opacity-100 translate-y-0":"opacity-0 translate-y-full group-hover:translate-y-0 group-hover:opacity-100"}`,children:f.jsx("div",{className:"w-full text-white text-lg font-bold p-4 rounded-b-[1.5rem] whitespace-normal break-words leading-snug pointer-events-none",children:e})})]})}function yW({promo:e,onClose:t}){const n=br(),r=ln(T=>T.auth.usuario),[l,d]=V.useState(!1),[p,a]=V.useState(!1),b=async()=>{if(!r)return;d(!0);const T=await n(kU(e._id));d(!1),T.meta.requestStatus==="fulfilled"&&(a(!0),setTimeout(()=>{t()},1500))};return f.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm flex items-center justify-center px-4",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 max-w-md w-full relative",children:[f.jsx("button",{onClick:t,className:"absolute top-2 right-2 text-gray-500 hover:text-black  text-lg",children:"×"}),f.jsxs("div",{className:"text-center space-y-4",children:[f.jsx("h2",{className:" text-lg font-bold text-sky-800",children:e.name}),f.jsx("p",{className:"text-gray-700  text-xs",children:e.description}),r?p?f.jsx("p",{className:"text-green-600 font-semibold",children:"¡Promoción guardada con éxito!"}):f.jsx("button",{onClick:b,disabled:l,className:"bg-sky-600 text-white px-6 py-2 rounded-lg hover:bg-sky-700 disabled:opacity-60",children:l?"Guardando...":"Guardar promoción"}):f.jsx("p",{className:"text-red-600 font-semibold",children:"Debes iniciar sesión para reclamar esta promoción."})]})]})})}function Mwe({businessId:e}){const[t,n]=V.useState([]),[r,l]=V.useState(!0),[d,p]=V.useState(null);return V.useEffect(()=>{e&&(async()=>{try{const b=await Rn.get(`/businesses/${e}/promotions`);n(b.data.promotions||[])}catch(b){console.error("Error al cargar promociones:",b)}finally{l(!1)}})()},[e]),r?f.jsxs("section",{className:"py-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Promociones destacadas"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(W8,{}),f.jsx(W8,{})]})]}):t.length===0?null:f.jsxs("section",{className:"py-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Promociones destacadas de este negocio"}),f.jsx(M_,{className:"relative overflow-visible",children:t.map(a=>f.jsx("div",{onClick:()=>p(a),className:"cursor-pointer flex-shrink-0 snap-start w-[220px] sm:w-[320px] md:w-[300px] lg:w-[260px] transform transition duration-300",children:f.jsx(xW,{isPremium:a.isPremium,title:a.name,image:a.featuredImage,maxClaims:a.maxClaims,descuento:a.maxClaims===0?"0 disponibles":typeof a.maxClaims=="number"?`Quedan ${a.maxClaims} cupones`:"Activa ahora"})},a._id))}),d&&f.jsx(yW,{promo:d,onClose:()=>p(null)})]})}uo.accessToken="pk.eyJ1IjoiY29tbXVuaXRpZXM5NSIsImEiOiJjbWIxcmxpNTkwYmkxMmxvZ2g1bWE0MnVrIn0.qLTgNgjsc1Is8AEcpwaqQA";function vW({lat:e,lng:t,logo:n=""}){const r=V.useRef(null),[l,d]=V.useState(!1),[p,a]=V.useState(null);return V.useEffect(()=>{navigator.geolocation.getCurrentPosition(b=>{a([b.coords.longitude,b.coords.latitude])},b=>{a([-96.797,32.7767])},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})},[]),V.useEffect(()=>{if(!r.current||typeof e!="number"||typeof t!="number")return;const b=new uo.Map({container:r.current,style:"mapbox://styles/mapbox/streets-v11",center:[t,e],zoom:14,attributionControl:!1});b.on("load",()=>d(!0));const T=new uo.LngLatBounds,E=document.createElement("div");if(n&&typeof n=="string"&&n.trim()!==""&&!n.includes("undefined")?E.innerHTML=`
        <div style="
          width: 35px;
          height: 35px;
          background-color: #dc2626;
          border-radius: 50% 50% 50% 0;
          transform: rotate(-45deg);
          box-shadow: 0 0 16px rgba(0,0,0,0.5);
          display: flex;
          align-items: center;
          justify-content: center;
          overflow: hidden;
        ">
          <img src="${n}" alt="logo" style="
            width: 90%;
            height: 90%;
            border-radius: 50%;
            object-fit: cover;
          " />
        </div>
      `:E.innerHTML=`
        <div style="
          width: 30px;
          height: 30px;
          background-color: #dc2626;
          border-radius: 50% 50% 50% 0;
          transform: rotate(-45deg);
          box-shadow: 0 0 16px rgba(0,0,0,0.5);
        "></div>
      `,new uo.Marker(E.firstElementChild).setLngLat([t,e]).addTo(b),T.extend([t,e]),p){const I=document.createElement("div");I.style.width="20px",I.style.height="20px",I.style.backgroundColor="#dc2626",I.style.borderRadius="50% 50% 50% 0",I.style.transform="rotate(-45deg)",I.style.boxShadow="0 0 6px rgba(0,0,0,0.3)",I.style.display="flex",I.style.alignItems="center",I.style.justifyContent="center";const R=document.createElement("div");R.style.width="10px",R.style.height="10px",R.style.borderRadius="50%",R.style.backgroundColor="white",R.style.transform="rotate(45deg)",I.appendChild(R),new uo.Marker(I).setLngLat(p).addTo(b),T.extend(p)}return T.isEmpty()||b.fitBounds(T,{padding:50}),()=>b.remove()},[e,t,p,n]),f.jsxs("div",{className:"relative overflow-hidden rounded-xl shadow",children:[!l&&f.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center bg-white/70 backdrop-blur",children:f.jsx("span",{className:"  text-xs text-gray-600",children:"Cargando mapa..."})}),f.jsx("div",{ref:r,className:`w-full h-[300px] transition-opacity duration-300 ${l?"opacity-100":"opacity-0"}`})]})}function Pwe({zip:e}){return f.jsxs("span",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-semibold\r
                 bg-blue-100 text-blue-800 border border-blue-200`,title:e?`Centro del ZIP ${e}`:"Delivery disponible",children:[f.jsx(Fce,{className:"text-blue-600"}),"Disponible para delivery",e?` · ZIP ${e}`:""]})}function Nwe({negocio:e}){var l,d,p;if(e.isDeliveryOnly)return f.jsx(Pwe,{zip:e.primaryZip});const t=(l=e.location)==null?void 0:l.address,n=(d=e.location)==null?void 0:d.city,r=(p=e.location)==null?void 0:p.state;return!t&&!n&&!r?null:f.jsxs("p",{className:"flex items-center  text-xs text-gray-500 gap-2",children:[f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13 21.314 8.343 16.657A8 8 0 1117.657 16.657z"})}),t?`${t}, `:"",n?`${n}, `:"",r||""]})}function Dwe({openingHours:e}){const t=VN(e);return f.jsx("div",{className:`inline-flex items-center gap-2 p-3 rounded-xl  text-xs font-semibold shadow-md transition-all
        ${t?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}
      `,children:t?f.jsxs(f.Fragment,{children:[f.jsx(VP,{className:"text-green-600 text-lg"}),f.jsx("span",{className:"text-gray-600 ",children:"¡Abierto ahora!"})]}):f.jsxs(f.Fragment,{children:[f.jsx(b$,{className:"text-red-600 text-lg"}),f.jsx("span",{className:"text-red-600 ",children:"Estamos cerrados — consultá nuestros horarios para visitarnos"})]})})}function Owe(){var E,P,I,R,F,W,$,Z,ne,ie,ge,ae,se;const e=ln(me=>me.auth.usuario),{id:t}=Ec(),[n,r]=V.useState(null),[l,d]=V.useState(!0),[p,a]=V.useState("galeria"),[b,T]=V.useState(!1);return V.useEffect(()=>{(async()=>{try{const ke=await EP(t);if(r(ke.business),e){try{await Rn.post(`/business-views/${t}/views`)}catch(qe){console.warn("⚠️ Error al registrar la vista:",qe)}try{const tt=(await Rn.get("/users/me/following?type=business")).data.items.map(nt=>nt._id);T(tt.includes(t))}catch(qe){console.warn("No se pudo cargar el estado de seguimiento:",qe)}}}catch(ke){console.error("Error al cargar el negocio:",ke),r(null)}finally{d(!1)}})()},[t,e]),l?f.jsx("div",{className:"px-4 sm:px-8 lg:px-8 xl:px-40 py-5 flex justify-center",children:f.jsx("div",{className:"w-full max-w-[960px]",children:f.jsx(YN,{})})}):n?f.jsx("div",{className:"px-4 sm:px-8 lg:px-8 py-5 flex justify-center",children:f.jsxs("div",{className:"w-full max-w-[960px] flex flex-col gap-8",children:[f.jsx(Ewe,{businessName:n.name,backgroundImageUrl:n.featuredImage}),f.jsxs("div",{className:"space-y-8",children:[f.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-2",children:[f.jsx("h1",{className:"hidden md:block text-2xl font-bold text-gray-900",children:n.name}),n.openingHours&&f.jsx(Dwe,{openingHours:n.openingHours})]}),f.jsx(Nwe,{negocio:n}),f.jsx("div",{className:"mt-4 flex flex-col gap-3 md:flex-row md:flex-wrap",children:f.jsxs("div",{className:"flex flex-wrap gap-2 md:w-full md:justify-start",children:[f.jsx(QN,{entityType:"business",entityId:t,initialFollowed:b}),f.jsx(fW,{entityType:"business",entityId:t})]})}),f.jsx(KN,{url:window.location.href,title:`Descubre ${n.name} en Communidades`,text:`Encontré este negocio latino que te puede interesar: ${n.name}`})]}),f.jsx("hr",{className:"border-t border-gray-200"}),f.jsx("div",{className:"border-l-4 border-gray-200 pl-4",children:f.jsx("p",{className:"text-[15px] text-gray-800 leading-relaxed whitespace-pre-line",children:n.description})}),f.jsx(jwe,{imageUrl:n.profileImage,categoryName:(P=(E=n.categories)==null?void 0:E[0])==null?void 0:P.name,businessName:n.name,highlightText:n.isVerified?"Verificado por Communidades":""}),((I=n.categories)==null?void 0:I.length)>0&&f.jsx("p",{className:"  text-xs text-gray-500 italic",children:n.categories.map(me=>me.description).filter(Boolean).join(" • ")}),f.jsx("div",{className:"flex flex-wrap gap-2 border-b border-gray-200 pt-4",children:[{id:"horarios",label:"Horarios"},{id:"galeria",label:"Galería"},{id:"redes",label:"Redes Sociales"},{id:"contacto",label:"Contacto"}].map(me=>f.jsx("button",{onClick:()=>a(me.id),className:`  text-xs px-3 py-2 rounded-t font-medium transition ${p===me.id?"bg-white border border-b-0 border-gray-200 text-gray-800":"text-gray-600 hover:text-gray-800"}`,children:me.label},me.id))}),f.jsxs("div",{className:"pt-4 flex flex-col gap-4",children:[p==="horarios"&&((R=n.openingHours)==null?void 0:R.length)>0&&f.jsx(Cwe,{hours:n.openingHours}),p==="galeria"&&((F=n.images)==null?void 0:F.length)>0&&f.jsx(hW,{galleryImages:n.images}),p==="redes"&&((W=n.contact)==null?void 0:W.socialMedia)&&f.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[f.jsx("h2",{className:"text-gray-900 text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5",children:"Redes sociales"}),f.jsxs("div",{className:"flex flex-col",children:[n.contact.socialMedia.instagram&&f.jsxs("div",{className:"flex items-center gap-4 bg-white px-4 min-h-[72px] py-2",children:[f.jsx("div",{className:"flex items-center justify-center rounded-lg bg-gray-100 shrink-0 size-12",children:f.jsx(l3,{size:20,className:"text-pink-600"})}),f.jsxs("div",{className:"flex flex-col justify-center",children:[f.jsx("a",{href:n.contact.socialMedia.instagram,target:"_blank",rel:"noopener noreferrer",className:"text-gray-900 text-base font-medium leading-normal hover:underline line-clamp-1 break-all",children:n.contact.socialMedia.instagram}),f.jsx("p",{className:"text-gray-500  text-xs",children:"Instagram"})]})]}),n.contact.socialMedia.facebook&&f.jsxs("div",{className:"flex items-center gap-4 bg-white px-4 min-h-[72px] py-2",children:[f.jsx("div",{className:"flex items-center justify-center rounded-lg bg-gray-100 shrink-0 size-12",children:f.jsx(o3,{size:20,className:"text-blue-600"})}),f.jsxs("div",{className:"flex flex-col justify-center",children:[f.jsx("a",{href:n.contact.socialMedia.facebook,target:"_blank",rel:"noopener noreferrer",className:"text-gray-900 text-base font-medium hover:underline line-clamp-1 break-all",children:n.contact.socialMedia.facebook}),f.jsx("p",{className:"text-gray-500  text-xs",children:"Facebook"})]})]}),n.contact.socialMedia.twitter&&f.jsxs("div",{className:"flex items-center gap-4 bg-white px-4 min-h-[72px] py-2",children:[f.jsx("div",{className:"flex items-center justify-center rounded-lg bg-gray-100 shrink-0 size-12",children:f.jsx($P,{size:20,className:"text-sky-500"})}),f.jsxs("div",{className:"flex flex-col justify-center",children:[f.jsx("a",{href:n.contact.socialMedia.twitter,target:"_blank",rel:"noopener noreferrer",className:"text-gray-900 text-base font-medium hover:underline line-clamp-1 break-all",children:n.contact.socialMedia.twitter}),f.jsx("p",{className:"text-gray-500  text-xs",children:"Twitter"})]})]}),n.contact.socialMedia.youtube&&f.jsxs("div",{className:"flex items-center gap-4 bg-white px-4 min-h-[72px] py-2",children:[f.jsx("div",{className:"flex items-center justify-center rounded-lg bg-gray-100 shrink-0 size-12",children:f.jsx(D$,{size:20,className:"text-red-600"})}),f.jsxs("div",{className:"flex flex-col justify-center",children:[f.jsx("a",{href:n.contact.socialMedia.youtube,target:"_blank",rel:"noopener noreferrer",className:"text-gray-900 text-base font-medium hover:underline line-clamp-1 break-all",children:n.contact.socialMedia.youtube}),f.jsx("p",{className:"text-gray-500  text-xs",children:"YouTube"})]})]}),n.contact.socialMedia.whatsapp&&f.jsxs("div",{className:"flex items-center gap-4 bg-white px-4 min-h-[72px] py-2",children:[f.jsx("div",{className:"flex items-center justify-center rounded-lg bg-gray-100 shrink-0 size-12",children:f.jsx(c3,{size:20,className:"text-green-500"})}),f.jsxs("div",{className:"flex flex-col justify-center",children:[f.jsx("a",{href:`https://wa.me/${n.contact.socialMedia.whatsapp.replace(/[^\d]/g,"")}`,target:"_blank",rel:"noopener noreferrer",className:"text-gray-900 text-base font-medium hover:underline line-clamp-1 break-all",children:n.contact.socialMedia.whatsapp}),f.jsx("p",{className:"text-gray-500  text-xs",children:"WhatsApp"})]})]})]})]}),p==="contacto"&&n.contact&&f.jsx(Awe,{contact:n.contact})]}),f.jsx(Mwe,{businessId:n._id}),f.jsxs("div",{className:"pt-6 flex flex-col gap-4",children:[n.community&&f.jsxs("div",{children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Comunidad relacionada"}),f.jsxs(Wn,{to:`/comunidades/${n.community._id}`,className:"w-fit flex items-center gap-2 p-2 rounded-full bg-gray-200  text-xs text-gray-700 hover:bg-gray-200",children:[f.jsx("img",{src:n.community.flagImage||"/placeholder-flag.png",alt:"bandera",className:"h-8 w-8 rounded-full object-cover"}),n.community.name]})]}),Array.isArray(($=n.location)==null?void 0:$.coordinates.coordinates)&&n.location.coordinates.coordinates.length===2&&f.jsx(vW,{lat:((ie=(ne=(Z=n==null?void 0:n.location)==null?void 0:Z.coordinates)==null?void 0:ne.coordinates)==null?void 0:ie[1])??0,lng:((se=(ae=(ge=n==null?void 0:n.location)==null?void 0:ge.coordinates)==null?void 0:ae.coordinates)==null?void 0:se[0])??0,name:(n==null?void 0:n.name)??"Sin nombre",logo:(n==null?void 0:n.profileImage)??""})]}),f.jsx("div",{className:"mt-4 flex flex-col gap-3 md:flex-row md:flex-wrap",children:f.jsxs("div",{className:"flex flex-wrap gap-2 md:w-full md:justify-between",children:[f.jsx(mW,{targetType:"business",targetId:t,initialLikes:n.likes}),f.jsx(gW,{targetType:"business",targetId:t})]})}),f.jsx(pW,{targetType:"business",targetId:t})]})}):f.jsx("div",{className:"p-4 text-center text-red-600",children:"Negocio no encontrado."})}function Iwe({date:e}){const t=new Date,n=new Date(e),r=t.toDateString()===n.toDateString();let l="próximo",d="bg-blue-100",p="text-blue-800",a=f.jsx(FT,{className:"text-blue-600  text-lg"});return t>n?(l="finalizado",d="bg-red-100",p="text-red-800",a=f.jsx(b$,{className:"text-red-600  text-lg"})):r&&(l="en vivo",d="bg-green-100",p="text-green-800",a=f.jsx(VP,{className:"text-green-600  text-lg"})),f.jsxs("div",{className:`inline-flex items-center gap-2 p-3 rounded-xl text-md font-semibold shadow-md ${d} ${p}`,children:[a,f.jsxs("span",{className:"capitalize ",children:["Evento ",l]})]})}function kwe(){var R,F,W,$,Z,ne,ie,ge,ae;const{id:e}=Ec(),[t,n]=V.useState(null),[r,l]=V.useState(!0),[d,p]=V.useState(null),[a,b]=V.useState([]),[T,E]=V.useState([]),[P,I]=V.useState(!1);return V.useEffect(()=>{(async()=>{try{const{event:me}=await fU(e);n(me)}catch(me){console.error("Error cargando evento:",me),p("No se pudo cargar el evento.")}finally{l(!1)}})()},[e]),V.useEffect(()=>{(async()=>{if(t!=null&&t._id)try{const ke=(await Rn.get("/users/me/following?type=event")).data.items.map(qe=>String(qe._id));I(ke.includes(String(t._id)))}catch(me){console.warn("No se pudo cargar el estado de seguimiento:",me)}})()},[t==null?void 0:t._id]),V.useEffect(()=>{(async()=>{var me;if(((me=t==null?void 0:t.sponsors)==null?void 0:me.length)>0)try{const ke=t.sponsors.map(tt=>EP(tt._id)),qe=await Promise.all(ke);b(qe)}catch(ke){console.error("Error cargando sponsors:",ke)}})()},[t==null?void 0:t.sponsors]),V.useEffect(()=>{(async()=>{var me;if(((me=t==null?void 0:t.communities)==null?void 0:me.length)>0)try{const ke=t.communities.map(tt=>vU(tt._id)),qe=await Promise.all(ke);E(qe)}catch(ke){console.error("Error cargando comunidades:",ke)}})()},[t==null?void 0:t.communities]),r?f.jsx("div",{className:"px-4 py-5 flex justify-center",children:f.jsx("div",{className:"w-full max-w-[960px]",children:f.jsx(YN,{})})}):d||!t?f.jsx("div",{className:"p-4 text-red-600 text-center",children:d||"Evento no encontrado."}):f.jsx("div",{className:"md:px-8 xl:px-40 py-5 flex justify-center",children:f.jsxs("div",{className:"w-full max-w-[960px] flex flex-col gap-12",children:[f.jsx("div",{className:"w-full max-w-[960px] flex flex-col gap-12",children:f.jsx("div",{className:`\r
      relative w-screen left-1/2 right-1/2 -translate-x-1/2\r
      sm:relative sm:w-full sm:left-0 sm:right-0 sm:translate-x-0\r
      bg-cover bg-center min-h-[220px] sm:min-h-[300px] lg:min-h-[400px]\r
      flex flex-col justify-end md:rounded-xl overflow-hidden shadow-sm\r
    `,style:{backgroundImage:`linear-gradient(0deg, rgba(0,0,0,0.4), rgba(0,0,0,0)), url(${t.featuredImage||"https://via.placeholder.com/1200x400?text=Imagen+no+disponible"})`},children:f.jsx("div",{className:"p-6 sm:p-10"})})}),f.jsxs("div",{className:"space-y-2 p-2",children:[f.jsxs("div",{className:" flex flex-col lg:flex-row justify-between md:items-center w-full gap-8",children:[f.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.title}),f.jsx(Iwe,{date:t.date})]}),f.jsxs("p",{className:"  text-xs text-gray-500",children:[new Date(t.date).toLocaleDateString()," - ",t.time,((R=t.location)==null?void 0:R.address)&&` · ${t.location.address}, ${t.location.city}`]}),!t.isFree&&t.price>0&&f.jsxs("p",{className:"  text-xs text-green-600 font-medium",children:["Precio: $",t.price]}),f.jsxs("p",{className:"text-xs text-gray-400",children:["Publicado el ",new Date(t.createdAt).toLocaleDateString()]})]}),f.jsxs("div",{className:"flex flex-col gap-3 p-2",children:[f.jsx("div",{className:"flex gap-4 items-start",children:f.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[f.jsx(QN,{entityType:"event",entityId:t._id,initialFollowed:P}),f.jsx(fW,{entityType:"event",entityId:e})]})}),f.jsx(KN,{url:window.location.href,title:`Participá en "${t.title}" en Communidades`,text:`Mirá este evento: ${t.title} - ${(F=t.description)==null?void 0:F.slice(0,100)}...`})]}),f.jsxs("div",{className:"flex gap-4",children:[t.registrationLink&&f.jsx("a",{href:t.registrationLink,target:"_blank",rel:"noreferrer",className:"inline-block w-fit px-4 py-2 bg-black text-white  text-xs rounded transition",children:"Registrate"}),t.isOnline&&t.virtualLink&&f.jsx("a",{href:t.virtualLink,target:"_blank",rel:"noreferrer",className:"inline-block w-fit px-4 py-2 bg-green-600 text-white  text-xs rounded transition",children:"Ingresar al evento virtual"})]}),f.jsx("div",{className:"border-l-4 border-gray-200 pl-4",children:f.jsx("p",{className:"font-sans text-[15px] text-gray-800 leading-relaxed whitespace-pre-line",children:t.description})}),((W=t.images)==null?void 0:W.length)>0&&f.jsx(hW,{galleryImages:t.images}),(($=t.tags)==null?void 0:$.length)>0&&f.jsx("div",{className:"flex flex-wrap gap-2",children:t.tags.map((se,me)=>f.jsx("span",{className:"bg-gray-100 text-gray-800 px-3 py-1 text-xs rounded-full w-fit",children:se},me))}),a.length>0&&f.jsxs("div",{children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Patrocinadores"}),f.jsx("div",{className:"flex gap-3 flex-wrap",children:a.map(({business:se})=>f.jsxs(Wn,{to:`/negocios/${se.id}`,className:"flex flex-col items-center w-24",children:[f.jsx("div",{className:"w-20 h-20 rounded-xl bg-cover bg-center border mb-1",style:{backgroundImage:`url(${se.profileImage||"/avatar-placeholder.png"})`}}),f.jsx("p",{className:"text-xs text-center text-gray-700 font-medium line-clamp-2",children:se.name})]},se.id))})]}),T.length>0&&f.jsxs("div",{children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Comunidades relacionadas"}),f.jsx("div",{className:"flex gap-2 flex-wrap",children:T.map(({community:se})=>f.jsxs(Wn,{to:`/comunidades/${se._id}`,className:"w-fit shadow-lg flex items-center gap-2 px-2 py-2 rounded-full bg-gray-100  text-xs text-gray-700 hover:bg-gray-200",children:[f.jsx("img",{src:se.flagImage||"/placeholder-flag.png",alt:"bandera",className:"h-8 w-8 rounded-full object-cover"}),se.name]},se._id))})]}),f.jsx("div",{className:"mt-4 flex flex-col gap-3 md:flex-row md:flex-wrap p-2",children:f.jsxs("div",{className:"flex flex-wrap gap-2 md:w-full md:justify-between",children:[f.jsx(mW,{targetType:"event",targetId:e,initialLikes:t.likes}),f.jsx(gW,{targetType:"event",targetId:e})]})}),f.jsxs("div",{className:"p-2",children:[Array.isArray((Z=t==null?void 0:t.coordinates)==null?void 0:Z.coordinates)&&t.coordinates.coordinates.length===2&&f.jsx(vW,{lat:((ie=(ne=t==null?void 0:t.coordinates)==null?void 0:ne.coordinates)==null?void 0:ie[1])??0,lng:((ae=(ge=t==null?void 0:t.coordinates)==null?void 0:ge.coordinates)==null?void 0:ae[0])??0,name:(t==null?void 0:t.title)??"Sin título",logo:""}),f.jsx(pW,{targetType:"event",targetId:e})]})]})})}function Rwe(){const e=br(),{lista:t,loading:n,error:r}=ln(P=>P.promociones),[l,d]=V.useState(null);V.useEffect(()=>{(!t||t.length===0)&&e(JS())},[e,t]);const p=Array.isArray(t)?t:[],a=p.filter(P=>P.type==="descuentos_imperdibles"),b=p.filter(P=>P.type==="nuevos_lanzamientos"),T=p.filter(P=>P.type==="promo_fin_de_semana"),E=(P,I,R,F,W={},$=!0)=>R.length===0?f.jsx("div",{className:"text-center text-gray-400 text-xs italic",children:"No hay promociones disponibles por ahora."}):f.jsxs("section",{children:[f.jsx(Kh,{direction:"up",duration:600,delay:100,children:f.jsx("div",{className:"text-left mb-4",children:f.jsxs("h2",{className:"text-md md:text-lg font-bold text-gray-800 relative inline-block",children:[f.jsx("span",{className:"relative z-10",children:`${P} ${I}`}),f.jsx("span",{className:"absolute bottom-0 h-2 bg-lime-300/60 z-0 rounded",style:{transform:"skewX(-12deg)",left:"-4px",right:"-4px",boxShadow:"0 4px 6px -2px rgba(0, 0, 0, 0.2)"}})]})})}),f.jsx(M_,{className:"relative overflow-visible",...W,children:R.filter(Z=>!!Z).map(Z=>{const ne=typeof Z.maxClaims=="number"&&!Number.isNaN(Z.maxClaims),ie=typeof Z.claimedCount=="number"?Z.claimedCount:Array.isArray(Z.claimed)?Z.claimed.length:0,ge=ne?Math.max(0,Z.maxClaims-ie):null,ae=ne?ge===0?"0 disponibles":`${ge} disponibles`:"No te la pierdas",se=typeof Z.business=="object"&&Z.business?Z.business._id:Z.business;return f.jsx("div",{onClick:()=>d(Z),className:"cursor-pointer flex-shrink-0 snap-start w-[220px] sm:w-[320px] md:w-[300px] lg:w-[260px] transform transition duration-300",children:f.jsx(xW,{title:Z.name,image:Z.featuredImage,isPremium:Z.isPremium,businessId:se,maxClaims:ne?Z.maxClaims:null,claimedCount:ie,descuento:ae})},Z._id)})}),$&&f.jsx("div",{className:"my-8 md:my-12",children:f.jsx("hr",{className:"border-t border-gray-200 mx-auto"})})]});return f.jsxs("div",{className:"flex flex-col gap-12 md:gap-10 md:mt-8",children:[f.jsxs(Oa,{children:[f.jsx("title",{children:"Communidades | Promociones"}),f.jsx("meta",{name:"description",content:"Descubrí promociones destacadas para tu comunidad."})]}),f.jsxs("div",{className:"w-full max-w-full overflow-hidden flex flex-col gap-12 md:gap-16",children:[n&&f.jsx("p",{className:"text-center text-gray-500",children:"Cargando promociones..."}),r&&f.jsx("p",{className:"text-center text-red-500",children:r}),!n&&!r&&f.jsxs(f.Fragment,{children:[E("Descuentos","imperdibles",a,"🎉",{autoplay:!0,direction:"right"},!0),E("Nuevos","lanzamientos",b,"🆕",{autoplay:!0,direction:"right"},!0),E("Promo","fin de semana",T,"🌞",{autoplay:!0,direction:"right"},!1)]})]}),l&&f.jsx(yW,{promo:l,onClose:()=>d(null)})]})}const zwe=async()=>(await Rn.post("/stripe/create-checkout-session")).data.url;async function Lwe(e){const{data:t}=await Rn.post("/stripe/create-banner-checkout-session",{bannerId:e},{withCredentials:!0});return t==null?void 0:t.url}function Fwe(){const[e,t]=V.useState(!1),[n,r]=V.useState(null),l=br(),d=async()=>{try{t(!0);const b=await zwe();window.location.href=b}catch{l(Jt({message:"Error al iniciar suscripción.",type:"error"}))}finally{t(!1)}},p=b=>{r(n===b?null:b)},a=[{question:"¿Puedo cancelar en cualquier momento?",answer:"Sí. Puedes cancelar tu suscripción desde tu perfil y tu plan volverá a gratuito al finalizar el ciclo actual."},{question:"¿Qué métodos de pago aceptan?",answer:"Aceptamos todas las tarjetas de crédito y débito principales a través de Stripe."},{question:"¿Puedo cambiar de plan después?",answer:"Sí. Puedes actualizar o cancelar tu plan en cualquier momento."},{question:"¿Qué beneficios obtengo?",answer:"Tu negocio o comunidad aparecerá en posiciones destacadas, con mayor visibilidad y acceso a promociones exclusivas."}];return f.jsxs(f.Fragment,{children:[f.jsx(Oa,{children:f.jsx("title",{children:"Suscripción Premium – Communidades"})}),f.jsxs("section",{className:"max-w-5xl mx-auto p-6 space-y-12 grid md:gap-8",children:[f.jsxs("header",{className:"text-center space-y-4",children:[f.jsx("h1",{className:"text-4xl font-bold text-orange-600",children:"Hazte Premium y Brilla en Grande"}),f.jsx("p",{className:"text-lg text-gray-600",children:"Llega a más personas, muestra tu esencia y convierte tu negocio o comunidad en protagonista. Con beneficios únicos y visibilidad que te hará destacar de verdad."})]}),f.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"border rounded-2xl p-6 bg-gray-50 shadow-sm",children:[f.jsx("h2",{className:"text-2xl font-semibold mb-4 text-gray-700",children:"Plan Gratuito"}),f.jsxs("ul",{className:"space-y-3 text-gray-700",children:[f.jsxs("li",{className:"flex items-start gap-3",children:[f.jsx("div",{className:"w-5 flex-shrink-0 flex justify-center",children:f.jsx(jd,{size:18,className:"text-green-600"})}),f.jsx("span",{className:"flex-1",children:"Publicación básica visible en la plataforma"})]}),f.jsxs("li",{className:"flex items-start gap-3",children:[f.jsx("div",{className:"w-5 flex-shrink-0 flex justify-center",children:f.jsx(jd,{size:18,className:"text-green-600"})}),f.jsx("span",{className:"flex-1",children:"Aparece en resultados de búsqueda generales"})]}),f.jsxs("li",{className:"flex items-start gap-3",children:[f.jsx("div",{className:"w-5 flex-shrink-0 flex justify-center",children:f.jsx(jd,{size:18,className:"text-green-600"})}),f.jsx("span",{className:"flex-1",children:"Ubicación mostrada en el mapa con icono estándar"})]}),f.jsxs("li",{className:"flex items-start gap-3",children:[f.jsx("div",{className:"w-5 flex-shrink-0 flex justify-center",children:f.jsx(jd,{size:18,className:"text-green-600"})}),f.jsx("span",{className:"flex-1",children:"Hasta 5 imágenes en la galería de tu negocio"})]})]}),f.jsx("div",{className:"mt-4  text-xs text-gray-500",children:"Ideal para comenzar a dar visibilidad a tu proyecto y explorar todas las posibilidades de Communidades."})]}),f.jsxs("div",{className:"border rounded-2xl p-6 bg-green-50 shadow-lg ring-2 ring-green-500",children:[f.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Plan Premium"}),f.jsxs("ul",{className:"space-y-3 text-gray-700",children:[f.jsxs("li",{className:"flex items-start gap-3",children:[f.jsx("div",{className:"w-5 flex-shrink-0 flex justify-center",children:f.jsx(jd,{size:18,className:"text-green-700"})}),f.jsx("span",{className:"flex-1",children:"Más visibilidad en búsquedas y listados"})]}),f.jsxs("li",{className:"flex items-start gap-3",children:[f.jsx("div",{className:"w-5 flex-shrink-0 flex justify-center",children:f.jsx(jd,{size:18,className:"text-green-700"})}),f.jsx("span",{className:"flex-1",children:"Icono destacado en el mapa de tu comunidad"})]}),f.jsxs("li",{className:"flex items-start gap-3",children:[f.jsx("div",{className:"w-5 flex-shrink-0 flex justify-center",children:f.jsx(jd,{size:18,className:"text-green-700"})}),f.jsx("span",{className:"flex-1",children:"Mejor indexación en categorías de tu comunidad"})]}),f.jsxs("li",{className:"flex items-start gap-3",children:[f.jsx("div",{className:"w-5 flex-shrink-0 flex justify-center",children:f.jsx(jd,{size:18,className:"text-green-700"})}),f.jsx("span",{className:"flex-1",children:"Notificaciones por correo de nuevos mensajes a tu negocio"})]}),f.jsxs("li",{className:"flex items-start gap-3",children:[f.jsx("div",{className:"w-5 flex-shrink-0 flex justify-center",children:f.jsx(jd,{size:18,className:"text-green-700"})}),f.jsx("span",{className:"flex-1",children:"Perfil de negocio destacado dentro del detalle de tu comunidad"})]}),f.jsxs("li",{className:"flex items-start gap-3",children:[f.jsx("div",{className:"w-5 flex-shrink-0 flex justify-center",children:f.jsx(jd,{size:18,className:"text-green-700"})}),f.jsx("span",{className:"flex-1",children:"Acceso prioritario a promociones y campañas"})]}),f.jsxs("li",{className:"flex items-start gap-3",children:[f.jsx("div",{className:"w-5 flex-shrink-0 flex justify-center",children:f.jsx(jd,{size:18,className:"text-green-700"})}),f.jsx("span",{className:"flex-1",children:"Soporte preferencial"})]})]}),f.jsxs("div",{className:"mt-6",children:[f.jsx("p",{className:" text-lg font-bold text-green-700 mb-4",children:"$12.99 / mes"}),f.jsx("button",{onClick:d,disabled:e,className:"bg-green-600 hover:bg-green-700 text-white px-5 py-2 rounded-full transition",children:e?"Redirigiendo...":"Suscribirse ahora"})]})]})]}),f.jsxs("div",{className:"grid md:grid-cols-3 gap-4 mt-12",children:[f.jsxs("div",{className:"flex flex-col items-center text-center p-4 bg-white rounded-xl shadow",children:[f.jsx(Lce,{size:28,className:"text-orange-500 mb-2"}),f.jsx("h3",{className:"font-semibold",children:"Pago Seguro"}),f.jsx("p",{className:"text-gray-500  text-xs",children:"Transacciones procesadas mediante Stripe con cifrado SSL."})]}),f.jsxs("div",{className:"flex flex-col items-center text-center p-4 bg-white rounded-xl shadow",children:[f.jsx($ce,{size:28,className:"text-orange-500 mb-2"}),f.jsx("h3",{className:"font-semibold",children:"Cancelación Flexible"}),f.jsx("p",{className:"text-gray-500  text-xs",children:"Cancela cuando quieras desde tu perfil sin penalizaciones."})]}),f.jsxs("div",{className:"flex flex-col items-center text-center p-4 bg-white rounded-xl shadow",children:[f.jsx(Pce,{size:28,className:"text-orange-500 mb-2"}),f.jsx("h3",{className:"font-semibold",children:"Soporte Prioritario"}),f.jsx("p",{className:"text-gray-500  text-xs",children:"Atención rápida y preferencial para usuarios Premium."})]})]}),f.jsxs("div",{className:"max-w-md mx-auto mt-10",children:[f.jsx("h3",{className:"text-2xl font-semibold mb-6 text-orange-600 text-center",children:"Preguntas Frecuentes"}),f.jsx("div",{className:"space-y-2",children:a.map((b,T)=>f.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[f.jsxs("button",{onClick:()=>p(T),className:"flex items-center justify-between w-full p-4 text-left bg-white hover:bg-gray-50 focus:outline-none",children:[f.jsx("span",{className:"font-medium",children:b.question}),n===T?f.jsx(Cce,{size:18,className:"text-orange-500"}):f.jsx(Tce,{size:18,className:"text-gray-500"})]}),n===T&&f.jsx("div",{className:"p-4 bg-gray-50 text-gray-700",children:b.answer})]},T))})]})]})]})}var w4,Z8;function Bwe(){if(Z8)return w4;Z8=1;var e={linear:function(t,n,r,l){var d=r-n;return d*t/l+n},easeInQuad:function(t,n,r,l){var d=r-n;return d*(t/=l)*t+n},easeOutQuad:function(t,n,r,l){var d=r-n;return-d*(t/=l)*(t-2)+n},easeInOutQuad:function(t,n,r,l){var d=r-n;return(t/=l/2)<1?d/2*t*t+n:-d/2*(--t*(t-2)-1)+n},easeInCubic:function(t,n,r,l){var d=r-n;return d*(t/=l)*t*t+n},easeOutCubic:function(t,n,r,l){var d=r-n;return d*((t=t/l-1)*t*t+1)+n},easeInOutCubic:function(t,n,r,l){var d=r-n;return(t/=l/2)<1?d/2*t*t*t+n:d/2*((t-=2)*t*t+2)+n},easeInQuart:function(t,n,r,l){var d=r-n;return d*(t/=l)*t*t*t+n},easeOutQuart:function(t,n,r,l){var d=r-n;return-d*((t=t/l-1)*t*t*t-1)+n},easeInOutQuart:function(t,n,r,l){var d=r-n;return(t/=l/2)<1?d/2*t*t*t*t+n:-d/2*((t-=2)*t*t*t-2)+n},easeInQuint:function(t,n,r,l){var d=r-n;return d*(t/=l)*t*t*t*t+n},easeOutQuint:function(t,n,r,l){var d=r-n;return d*((t=t/l-1)*t*t*t*t+1)+n},easeInOutQuint:function(t,n,r,l){var d=r-n;return(t/=l/2)<1?d/2*t*t*t*t*t+n:d/2*((t-=2)*t*t*t*t+2)+n},easeInSine:function(t,n,r,l){var d=r-n;return-d*Math.cos(t/l*(Math.PI/2))+d+n},easeOutSine:function(t,n,r,l){var d=r-n;return d*Math.sin(t/l*(Math.PI/2))+n},easeInOutSine:function(t,n,r,l){var d=r-n;return-d/2*(Math.cos(Math.PI*t/l)-1)+n},easeInExpo:function(t,n,r,l){var d=r-n;return t==0?n:d*Math.pow(2,10*(t/l-1))+n},easeOutExpo:function(t,n,r,l){var d=r-n;return t==l?n+d:d*(-Math.pow(2,-10*t/l)+1)+n},easeInOutExpo:function(t,n,r,l){var d=r-n;return t===0?n:t===l?n+d:(t/=l/2)<1?d/2*Math.pow(2,10*(t-1))+n:d/2*(-Math.pow(2,-10*--t)+2)+n},easeInCirc:function(t,n,r,l){var d=r-n;return-d*(Math.sqrt(1-(t/=l)*t)-1)+n},easeOutCirc:function(t,n,r,l){var d=r-n;return d*Math.sqrt(1-(t=t/l-1)*t)+n},easeInOutCirc:function(t,n,r,l){var d=r-n;return(t/=l/2)<1?-d/2*(Math.sqrt(1-t*t)-1)+n:d/2*(Math.sqrt(1-(t-=2)*t)+1)+n},easeInElastic:function(t,n,r,l){var d=r-n,p,a,b;return b=1.70158,a=0,p=d,t===0?n:(t/=l)===1?n+d:(a||(a=l*.3),p<Math.abs(d)?(p=d,b=a/4):b=a/(2*Math.PI)*Math.asin(d/p),-(p*Math.pow(2,10*(t-=1))*Math.sin((t*l-b)*(2*Math.PI)/a))+n)},easeOutElastic:function(t,n,r,l){var d=r-n,p,a,b;return b=1.70158,a=0,p=d,t===0?n:(t/=l)===1?n+d:(a||(a=l*.3),p<Math.abs(d)?(p=d,b=a/4):b=a/(2*Math.PI)*Math.asin(d/p),p*Math.pow(2,-10*t)*Math.sin((t*l-b)*(2*Math.PI)/a)+d+n)},easeInOutElastic:function(t,n,r,l){var d=r-n,p,a,b;return b=1.70158,a=0,p=d,t===0?n:(t/=l/2)===2?n+d:(a||(a=l*(.3*1.5)),p<Math.abs(d)?(p=d,b=a/4):b=a/(2*Math.PI)*Math.asin(d/p),t<1?-.5*(p*Math.pow(2,10*(t-=1))*Math.sin((t*l-b)*(2*Math.PI)/a))+n:p*Math.pow(2,-10*(t-=1))*Math.sin((t*l-b)*(2*Math.PI)/a)*.5+d+n)},easeInBack:function(t,n,r,l,d){var p=r-n;return d===void 0&&(d=1.70158),p*(t/=l)*t*((d+1)*t-d)+n},easeOutBack:function(t,n,r,l,d){var p=r-n;return d===void 0&&(d=1.70158),p*((t=t/l-1)*t*((d+1)*t+d)+1)+n},easeInOutBack:function(t,n,r,l,d){var p=r-n;return d===void 0&&(d=1.70158),(t/=l/2)<1?p/2*(t*t*(((d*=1.525)+1)*t-d))+n:p/2*((t-=2)*t*(((d*=1.525)+1)*t+d)+2)+n},easeInBounce:function(t,n,r,l){var d=r-n,p;return p=e.easeOutBounce(l-t,0,d,l),d-p+n},easeOutBounce:function(t,n,r,l){var d=r-n;return(t/=l)<1/2.75?d*(7.5625*t*t)+n:t<2/2.75?d*(7.5625*(t-=1.5/2.75)*t+.75)+n:t<2.5/2.75?d*(7.5625*(t-=2.25/2.75)*t+.9375)+n:d*(7.5625*(t-=2.625/2.75)*t+.984375)+n},easeInOutBounce:function(t,n,r,l){var d=r-n,p;return t<l/2?(p=e.easeInBounce(t*2,0,d,l),p*.5+n):(p=e.easeOutBounce(t*2-l,0,d,l),p*.5+d*.5+n)}};return w4=e,w4}var Vwe=Bwe();function Uwe(e){return e*Math.PI/180}function Cu(e,t){return e+Math.random()*(t-e)}function $we(e,t){return Math.floor(e+Math.random()*(t-e+1))}var $b;(function(e){e[e.Circle=0]="Circle",e[e.Square=1]="Square",e[e.Strip=2]="Strip"})($b||($b={}));var qg;(function(e){e[e.Positive=1]="Positive",e[e.Negative=-1]="Negative"})(qg||(qg={}));const qwe=1e3/60;class Hwe{constructor(t,n,r,l){this.getOptions=n;const{colors:d,initialVelocityX:p,initialVelocityY:a}=this.getOptions();this.context=t,this.x=r,this.y=l,this.w=Cu(5,20),this.h=Cu(5,20),this.radius=Cu(5,10),this.vx=typeof p=="number"?Cu(-p,p):Cu(p.min,p.max),this.vy=typeof a=="number"?Cu(-a,0):Cu(a.min,a.max),this.shape=$we(0,2),this.angle=Uwe(Cu(0,360)),this.angularSpin=Cu(-.2,.2),this.color=d[Math.floor(Math.random()*d.length)],this.rotateY=Cu(0,1),this.rotationDirection=Cu(0,1)?qg.Positive:qg.Negative}update(t){const{gravity:n,wind:r,friction:l,opacity:d,drawShape:p}=this.getOptions(),a=t/qwe;this.x+=this.vx*a,this.y+=this.vy*a,this.vy+=n*a,this.vx+=r*a,this.vx*=l**a,this.vy*=l**a,this.rotateY>=1&&this.rotationDirection===qg.Positive?this.rotationDirection=qg.Negative:this.rotateY<=-1&&this.rotationDirection===qg.Negative&&(this.rotationDirection=qg.Positive);const b=.1*this.rotationDirection*a;if(this.rotateY+=b,this.angle+=this.angularSpin,this.context.save(),this.context.translate(this.x,this.y),this.context.rotate(this.angle),this.context.scale(1,this.rotateY),this.context.rotate(this.angle),this.context.beginPath(),this.context.fillStyle=this.color,this.context.strokeStyle=this.color,this.context.globalAlpha=d,this.context.lineCap="round",this.context.lineWidth=2,p&&typeof p=="function")p.call(this,this.context);else switch(this.shape){case $b.Circle:{this.context.beginPath(),this.context.arc(0,0,this.radius,0,2*Math.PI),this.context.fill();break}case $b.Square:{this.context.fillRect(-this.w/2,-this.h/2,this.w,this.h);break}case $b.Strip:{this.context.fillRect(-this.w/6,-this.h/2,this.w/3,this.h);break}}this.context.closePath(),this.context.restore()}}class Gwe{constructor(t,n){this.x=0,this.y=0,this.w=0,this.h=0,this.lastNumberOfPieces=0,this.tweenProgress=0,this.tweenFrom=0,this.particles=[],this.particlesGenerated=0,this.removeParticleAt=l=>{this.particles.splice(l,1)},this.getParticle=()=>{const l=Cu(this.x,this.w+this.x),d=Cu(this.y,this.h+this.y);return new Hwe(this.context,this.getOptions,l,d)},this.animate=l=>{const{canvas:d,context:p,particlesGenerated:a,lastNumberOfPieces:b}=this,{run:T,recycle:E,numberOfPieces:P,debug:I,tweenFunction:R,tweenDuration:F}=this.getOptions();if(!T)return!1;const W=this.particles.length,$=E?W:a;if($<P){b!==P&&(this.tweenProgress=0,this.tweenFrom=$,this.lastNumberOfPieces=P),this.tweenProgress=Math.min(F,Math.max(0,this.tweenProgress+l));const Z=R(this.tweenProgress,this.tweenFrom,P,F),ne=Math.round(Z-$);for(let ie=0;ie<ne;ie++)this.particles.push(this.getParticle());this.particlesGenerated+=ne}I&&(p.font="12px sans-serif",p.fillStyle="#333",p.textAlign="right",p.fillText(`Particles: ${W}`,d.width-10,d.height-20));for(let Z=this.particles.length-1;Z>=0;Z--){const ne=this.particles[Z];ne.update(l),(ne.y>d.height||ne.y<-100||ne.x>d.width+100||ne.x<-100)&&(E&&$<=P?this.particles[Z]=this.getParticle():this.removeParticleAt(Z))}return W>0||$<P},this.canvas=t;const r=this.canvas.getContext("2d");if(!r)throw new Error("Could not get canvas context");this.context=r,this.getOptions=n}}const lD={width:typeof window<"u"?window.innerWidth:300,height:typeof window<"u"?window.innerHeight:200,numberOfPieces:200,friction:.99,wind:0,gravity:.1,initialVelocityX:4,initialVelocityY:10,colors:["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFEB3B","#FFC107","#FF9800","#FF5722","#795548"],opacity:1,debug:!1,tweenFunction:Vwe.easeInOutQuad,tweenDuration:5e3,recycle:!0,run:!0};class Wwe{constructor(t,n){this.lastFrameTime=0,this.setOptionsWithDefaults=l=>{const d={confettiSource:{x:0,y:0,w:this.canvas.width,h:0}};this._options={...d,...lD,...l},Object.assign(this,l.confettiSource)},this.update=(l=0)=>{const{options:{run:d,onConfettiComplete:p,frameRate:a},canvas:b,context:T}=this,E=Math.min(l-this.lastFrameTime,50);if(a&&E<1e3/a){this.rafId=requestAnimationFrame(this.update);return}this.lastFrameTime=l-(a?E%a:0),d&&(T.fillStyle="white",T.clearRect(0,0,b.width,b.height)),this.generator.animate(E)?this.rafId=requestAnimationFrame(this.update):(p&&typeof p=="function"&&this.generator.particlesGenerated>0&&p.call(this,this),this._options.run=!1)},this.reset=()=>{this.generator&&this.generator.particlesGenerated>0&&(this.generator.particlesGenerated=0,this.generator.particles=[],this.generator.lastNumberOfPieces=0)},this.stop=()=>{this.options={run:!1},this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=void 0)},this.canvas=t;const r=this.canvas.getContext("2d");if(!r)throw new Error("Could not get canvas context");this.context=r,this.generator=new Gwe(this.canvas,()=>this.options),this.options=n,this.update()}get options(){return this._options}set options(t){var l,d;const n=(l=this._options)==null?void 0:l.run,r=(d=this._options)==null?void 0:d.recycle;this.setOptionsWithDefaults(t),this.generator&&(Object.assign(this.generator,this.options.confettiSource),typeof t.recycle=="boolean"&&t.recycle&&r===!1&&(this.generator.lastNumberOfPieces=this.generator.particles.length)),typeof t.run=="boolean"&&t.run&&n===!1&&this.update()}}const Zwe=$s.createRef();class cD extends $s.Component{constructor(t){super(t),this.canvas=$s.createRef(),this.canvas=t.canvasRef||Zwe}componentDidMount(){if(this.canvas.current){const t=S4(this.props)[0];this.confetti=new Wwe(this.canvas.current,t)}}componentDidUpdate(){const t=S4(this.props)[0];this.confetti&&(this.confetti.options=t)}componentWillUnmount(){this.confetti&&this.confetti.stop(),this.confetti=void 0}render(){const[t,n]=S4(this.props),r={zIndex:2,position:"absolute",pointerEvents:"none",top:0,left:0,bottom:0,right:0,...n.style};return f.jsx("canvas",{width:t.width,height:t.height,ref:this.canvas,...n,style:r})}}cD.defaultProps={...lD};cD.displayName="ReactConfetti";function S4(e){const t={},n={},r={},l=[...Object.keys(lD),"confettiSource","drawShape","onConfettiComplete","frameRate"],d=["canvasRef"];for(const p in e){const a=e[p];l.includes(p)?t[p]=a:d.includes(p)?d[p]=a:r[p]=a}return[t,r,n]}const Xwe=$s.forwardRef((e,t)=>f.jsx(cD,{canvasRef:t,...e}));function Kwe(){const e=aa(),[t,n]=V.useState({width:window.innerWidth,height:window.innerHeight});return V.useEffect(()=>{const r=()=>{n({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),f.jsxs("section",{className:"min-h-screen bg-white flex flex-col items-center justify-center text-center p-6 relative overflow-hidden",children:[f.jsx(Xwe,{width:t.width,height:t.height,numberOfPieces:250,recycle:!1}),f.jsx("h1",{className:"text-4xl font-extrabold text-green-600 mb-4",children:"¡Gracias por subirte a lo Premium!"}),f.jsx("p",{className:"text-gray-700 text-lg mb-2 max-w-xl",children:"Tu suscripción ha sido activada con éxito. Ahora tu negocio brillará con más visibilidad, mejores posiciones y beneficios exclusivos que harán crecer tu comunidad."}),f.jsx("p",{className:"text-gray-500 mb-6",children:"Estamos felices de acompañarte en este camino. 🚀"}),f.jsx("button",{onClick:()=>e("/dashboard/perfil"),className:"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-full text-base font-medium transition",children:"Ir a mi perfil"})]})}function Ywe(){const e=aa();return f.jsxs(f.Fragment,{children:[f.jsx(Oa,{children:f.jsx("title",{children:"Suscripción Cancelada – Communidades"})}),f.jsx("section",{className:"min-h-screen flex flex-col items-center justify-center text-center px-6 py-12 bg-white",children:f.jsxs("div",{className:"flex flex-col items-center space-y-4 max-w-xl",children:[f.jsx(Hce,{className:"text-orange-400 text-6xl"}),f.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-orange-600",children:"¡Uups! No pudimos completar tu suscripción"}),f.jsx("p",{className:"text-gray-700 text-lg",children:"Parece que cancelaste el proceso o hubo un pequeño inconveniente."}),f.jsx("p",{className:"text-gray-500  text-xs",children:"No pasa nada, puedes volver a intentarlo cuando prefieras. Mientras tanto, tu cuenta sigue activa en el plan gratuito."}),f.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row gap-3",children:[f.jsx("button",{onClick:()=>e("/premium"),className:"bg-orange-600 hover:bg-orange-700 text-white px-6 py-2 rounded-full  text-xs font-semibold transition",children:"Intentar de nuevo"}),f.jsx("button",{onClick:()=>e("/dashboard/perfil"),className:"bg-gray-200 hover:bg-gray-300 text-gray-800 px-6 py-2 rounded-full  text-xs font-semibold transition",children:"Ir a mi perfil"})]})]})})]})}const Qwe=({usuario:e,handleLogout:t})=>{const n=(e==null?void 0:e.role)==="admin",r=[{to:"/dashboard/perfil",label:"Mi perfil",icon:f.jsx(S$,{})},{to:"/dashboard/mis-negocios",label:"Mis negocios",icon:f.jsx(BT,{})},{to:"/dashboard/mis-eventos",label:"Mis eventos",icon:f.jsx(FT,{})},{to:"/dashboard/cupones",label:"Mis cupones",icon:f.jsx(M$,{})},{to:"/dashboard/redimir",label:"Redimir Cupones",icon:f.jsx(BT,{})},{to:"/dashboard/mis-banners",label:"Mis banners",icon:f.jsx(T$,{})},{to:"/dashboard/mis-promos",label:"Mis promos",icon:f.jsx(hy,{})}],l=[{to:"/dashboard-admin/mis-categorias",label:"Categorías (admin)",icon:f.jsx(w$,{})},{to:"/dashboard-admin/mis-comunidades",label:"Comunidades (admin)",icon:f.jsx(VT,{})},{to:"/dashboard-admin/banners",label:"Banners / Ads",icon:f.jsx(j$,{})}],d=p=>`group relative flex text-white items-center justify-between gap-3 px-3 py-2 rounded-tr-2xl transition ${p?"bg-orange-500/90 active":""}`;return f.jsxs("aside",{className:`\r
        relative top-0 left-0 h-full w-20 md:w-60 lg:w-68 flex flex-col z-10 \r
        bg-gradient-to-br from-orange-500 via-red-500 \r
        bg-fixed\r
      `,children:[f.jsx("div",{className:"absolute inset-0 backdrop-blur-sm bg-black/20 pointer-events-none"}),f.jsxs("div",{className:"flex flex-col gap-8 justify-start flex-1 relative z-10 overflow-y-auto",children:[f.jsxs("div",{className:"w-full",children:[f.jsx("div",{className:"hidden md:flex w-full bg-black/40 text-white px-3 py-3 mb-4 rounded-br-xl",children:f.jsx("h1",{className:"text-base font-semibold leading-normal",children:"Dashboard"})}),f.jsx("div",{className:"hidden md:flex flex-col gap-1 px-4",children:f.jsxs("p",{className:"text-gray-100 text-xs font-bold leading-normal",children:[e==null?void 0:e.name," ",e==null?void 0:e.title]})})]}),f.jsx("div",{className:"flex flex-col gap-2 px-4 mt-4",children:r.map(({to:p,label:a,icon:b})=>f.jsxs(Ib,{to:p,className:({isActive:T})=>d(T),children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:" text-lg",children:b}),f.jsx("p",{className:"hidden md:block text-xs font-medium leading-normal truncate",children:a})]}),f.jsx("span",{className:" text-lg text-white opacity-0 group-hover:opacity-100 group-[.active]:opacity-100 transition-opacity duration-300 ease-out",children:f.jsx(iz,{})})]},p))}),n&&f.jsxs("div",{className:"flex flex-col gap-2 px-4 mt-6",children:[f.jsx("div",{className:"hidden md:block text-white/80 text-xs uppercase tracking-wide px-1 mb-1",children:"Admin"}),l.map(({to:p,label:a,icon:b})=>f.jsxs(Ib,{to:p,className:({isActive:T})=>d(T),children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:" text-lg",children:b}),f.jsx("p",{className:"hidden md:block text-xs font-medium leading-normal truncate",children:a})]}),f.jsx("span",{className:" text-lg text-white opacity-0 group-hover:opacity-100 group-[.active]:opacity-100 transition-opacity duration-300 ease-out",children:f.jsx(iz,{})})]},p))]}),f.jsxs(Ib,{to:"/premium",className:({isActive:p})=>`group hidden relative flex items-center gap-3 mx-4 px-4 py-2 rounded-md border border-white text-white font-semibold transition-all overflow-hidden ${p?"shadow-[0_0_12px_rgba(255,255,255,0.4)]":"hover:border-green-200 hover:text-white hover:shadow-[0_0_20px_rgba(34,197,94,0.5)]"}`,children:[f.jsx("span",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-700 ease-out"}),f.jsx("span",{className:"relative z-10  text-lg",children:f.jsx(zce,{})}),f.jsx("p",{className:"hidden md:block relative z-10 text-xs font-semibold",children:"Dale un impulso a tu cuenta"})]})]}),f.jsx("div",{className:"sticky bottom-0 w-full px-3 py-3 z-20 bg-gradient-to-br from-red-400 via-red-500 to-orange-500",children:f.jsxs("button",{onClick:t,className:"w-full flex items-center justify-center gap-2 text-xs text-white hover:bg-black/40 hover:text-white transition rounded-full py-2",children:[f.jsx(_$,{className:"text-lg"}),f.jsx("span",{children:"Cerrar sesión"})]})})]})};function Jwe(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M8 2v4"},child:[]},{tag:"path",attr:{d:"M16 2v4"},child:[]},{tag:"rect",attr:{width:"18",height:"18",x:"3",y:"4",rx:"2"},child:[]},{tag:"path",attr:{d:"M3 10h18"},child:[]},{tag:"path",attr:{d:"M8 14h.01"},child:[]},{tag:"path",attr:{d:"M12 14h.01"},child:[]},{tag:"path",attr:{d:"M16 14h.01"},child:[]},{tag:"path",attr:{d:"M8 18h.01"},child:[]},{tag:"path",attr:{d:"M12 18h.01"},child:[]},{tag:"path",attr:{d:"M16 18h.01"},child:[]}]})(e)}function e2e(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{width:"7",height:"7",x:"3",y:"3",rx:"1"},child:[]},{tag:"rect",attr:{width:"7",height:"7",x:"14",y:"3",rx:"1"},child:[]},{tag:"rect",attr:{width:"7",height:"7",x:"14",y:"14",rx:"1"},child:[]},{tag:"rect",attr:{width:"7",height:"7",x:"3",y:"14",rx:"1"},child:[]}]})(e)}function t2e(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"},child:[]},{tag:"path",attr:{d:"M3 3v5h5"},child:[]},{tag:"path",attr:{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"},child:[]},{tag:"path",attr:{d:"M16 16h5v5"},child:[]}]})(e)}function n2e(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19"},child:[]},{tag:"path",attr:{d:"M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z"},child:[]},{tag:"circle",attr:{cx:"6.5",cy:"9.5",r:".5",fill:"currentColor"},child:[]}]})(e)}function r2e(e){return sn({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M22 21v-2a4 4 0 0 0-3-3.87"},child:[]},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"},child:[]}]})(e)}function i2e({usuario:e}){const[t,n]=V.useState(!0),r=V.useRef(0),{pathname:l}=yl(),d=br();V.useEffect(()=>{d(bM())},[l,d]);const p=[{to:"mis-negocios",label:"Mis negocios",icon:f.jsx(uce,{size:24})},{to:"mis-eventos",label:"Mis eventos",icon:f.jsx(Jwe,{size:24})},{to:"mis-promos",label:"Promos",icon:f.jsx(n2e,{size:24})},{to:"cupones",label:"Cupones",icon:f.jsx(M$,{size:24})},{to:"redimir",label:"Redimir",icon:f.jsx(t2e,{size:24})}],a=[{to:"categorias",label:"Categorías",icon:f.jsx(e2e,{size:24})},{to:"mis-comunidades",label:"Comunidades",icon:f.jsx(r2e,{size:24})}],b=(e==null?void 0:e.role)==="admin"?[...p,...a]:p,E=b.map(R=>R.to).findIndex(R=>l.includes(R)),P=b.length,I=`w-1/${P}`;return V.useEffect(()=>{const R=()=>{const F=window.scrollY,W=F-r.current,$=window.innerHeight+F>=document.body.offsetHeight-50;if(F<20||$){n(!0),r.current=F;return}Math.abs(W)<10||(n(W<0),r.current=F)};return window.addEventListener("scroll",R),()=>window.removeEventListener("scroll",R)},[]),f.jsx("div",{className:"md:hidden fixed left-0 right-0 bg-white border-t-2 border-orange-500 z-50 transition-all duration-500",style:{bottom:t?0:"-100%"},children:f.jsxs("nav",{className:`relative grid grid-cols-${P}`,style:{gridTemplateColumns:`repeat(${P}, minmax(0, 1fr))`},children:[f.jsx("div",{className:`absolute top-0 left-0 h-full ${I} transition-transform duration-300`,style:{transform:`translateX(${E*100}%)`},children:f.jsx("div",{className:"w-full h-full bg-orange-100"})}),b.map(({to:R,icon:F,label:W})=>f.jsxs(Ib,{to:R,className:({isActive:$})=>`relative flex flex-col items-center justify-center py-3 transition-colors duration-200 ${$?"text-white bg-orange-500":"text-gray-500 hover:text-orange-500"}`,children:[F,(e==null?void 0:e.role)!=="admin"&&f.jsx("span",{className:"text-[10px] mt-1",children:W})]},R))]})})}const a2e=()=>{const e=br(),t=aa();return async()=>{try{await Rn.post("/auth/logout")}catch(r){console.error("Error al cerrar sesión:",r)}e(yU()),e(Tc()),t("/")}};function X8(){const e=ln(r=>r.auth.usuario),t=V.useRef(),n=a2e();return f.jsxs("div",{className:"flex flex-col min-h-screen",children:[f.jsx(P$,{}),f.jsxs("div",{className:"flex flex-1",children:[f.jsx("div",{className:" hidden md:block",children:f.jsx(Qwe,{usuario:e,handleLogout:n})}),f.jsx("main",{className:"flex-grow pt-4 overflow-y-auto p-4 lg:p-6 pb-24 md:pb-6",children:f.jsx(t3,{})}),f.jsx(i2e,{usuario:e,handleLogout:n,scrollContainerRef:t})]})]})}function s2e({size:e="md"}){const t={sm:"w-70 h-70",md:"w-10 h-10",lg:"w-10 h-10"};return f.jsx("div",{className:`${t[e]} rounded-full bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center flex-shrink-0 border border-gray-300 shadow-sm`,children:f.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M12 12c2.209 0 4-1.791 4-4s-1.791-4-4-4-4 1.791-4 4 1.791 4 4 4zM12 14c-3.314 0-6 2.686-6 6v1h12v-1c0-3.314-2.686-6-6-6z"})})})}function o2e({usuario:e}){if(!e)return null;const{name:t,lastName:n,title:r,description:l,location:d,country:p,role:a,profileImage:b}=e;return f.jsxs("div",{className:"flex flex-col gap-4 bg-[#f9fafb] p-4 md:p-6 rounded-2x bg-gradient-to-b from-[#fff7ec] to-[#f3e8ff] ",children:[f.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center  gap-4",children:[f.jsxs("div",{className:"flex flex-row md:flex-col items-end gap-10 md:gap-4 flex-shrink-0",children:[f.jsx("div",{className:"w-36 h-36 rounded-full overflow-hidden flex items-center justify-center bg-gray-100 border border-gray-200",children:b?f.jsx("img",{src:b,alt:t||"Usuario",className:"w-full h-full object-cover"}):f.jsx(s2e,{})}),f.jsxs("div",{className:"flex flex-col gap-1 text-left",children:[f.jsxs("p",{className:"text-[#111827] text-base sm:text-lg md: text-lg font-semibold leading-tight tracking-[-0.015em]",children:[t," ",n]}),r&&f.jsxs("p",{className:"text-[#6b7280] text-xs sm:  text-xs font-medium flex items-center gap-1",children:[f.jsx(mle,{className:"text-gray-400"}),r]}),d&&f.jsxs("p",{className:"text-[#6b7280] text-xs sm:  text-xs font-normal flex items-center gap-1",children:[f.jsx(cle,{className:"text-gray-400"}),d,", ",p]}),f.jsx("p",{className:"text-[#6b7280] ml-5 text-xs font-normal capitalize",children:a==="business_owner"?"Empresario":a})]})]}),l&&f.jsx("div",{className:"  text-xs text-gray-600 leading-snug md:ml-6 md:mt-0 md:text-center md:mx-auto",children:l})]}),f.jsxs("div",{className:"flex flex-wrap items-start gap-2 sm:gap-3 pt-2",children:[f.jsx(Wn,{to:"/dashboard/perfil/editar",className:"flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium whitespace-nowrap no-underline",children:"Editar perfil"}),f.jsx(Wn,{to:"/dashboard/mis-negocios/crear",className:"flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium whitespace-nowrap no-underline",children:"+ Nuevo negocio"}),f.jsxs(Wn,{to:"/dashboard/inbox",className:"flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium whitespace-nowrap no-underline",children:[f.jsx(y$,{className:"text-lg"}),"Mis mensajes"]})]})]})}function l2e({resumen:e=[],user:t}){const n=aa(),r={Comunidades:v$,Categorías:rz,Negocios:fle,Eventos:sle},l=e.filter(d=>!d.requireAdmin||(t==null?void 0:t.role)==="admin");return f.jsxs("div",{className:"bg-[#F7F7F7] px-2 py-3 md:p-3 lg:p-6 rounded-2xl h-full",children:[f.jsx("h3",{className:"text-gray-600 text-md font-semibold pb-4",children:"Resumen"}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-1 lg:grid-cols-1 xl:grid-cols-2 gap-3",children:l.map(({label:d,value:p,path:a},b)=>{const T=d.replace(/^(Tus|Mis)\s+/i,"").trim(),E=T.charAt(0).toUpperCase()+T.slice(1),P=r[E]||rz;return f.jsxs("div",{onClick:()=>a&&n(a),className:"cursor-pointer flex flex-col bg-white border border-gray-200 rounded-lg p-2 hover:shadow-md hover:-translate-y-0.5 transition",children:[f.jsx("div",{className:"w-7 h-7 flex items-center xl:mx-auto justify-center rounded-sm text-orange-500",children:f.jsx(P,{className:"w-5 h-5"})}),f.jsxs("div",{className:"flex xl:flex-col items-center justify-between gap-1",children:[f.jsx("p",{className:"text-xs font-normal text-[#3F5374] truncate",children:d}),f.jsx("p",{className:"text-md font-semibold text-gray-500",children:p})]})]},b)})})]})}function cp({open:e,onClose:t,onConfirm:n,entityName:r}){const[l,d]=V.useState("");return e?f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-4",onClick:t,children:f.jsxs("div",{onClick:p=>p.stopPropagation(),className:"bg-white max-w-md w-full rounded-xl shadow-xl p-6 flex flex-col gap-5",children:[f.jsxs("h2",{className:" text-lg font-bold text-[#141C24] leading-snug",children:["¿Quieres eliminar ",f.jsx("span",{className:"text-red-600",children:r}),"?"]}),f.jsx("p",{className:"  text-xs text-gray-600",children:"Para confirmar, escribe el nombre exactamente como aparece."}),f.jsx("div",{className:"  text-xs font-medium text-gray-800 border border-gray-200 bg-gray-50 rounded px-3 py-1 w-fit",children:r}),f.jsx("input",{type:"text",placeholder:"Escribe aquí el nombre completo",value:l,onChange:p=>d(p.target.value),className:"w-full border border-gray-300 rounded px-3 py-2  text-xs focus:outline-none focus:ring-2 focus:ring-orange-500"}),l.trim()&&l.trim()!==r&&f.jsx("p",{className:"text-xs text-red-500 mt-1",children:"El nombre no coincide exactamente."}),f.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 mt-2",children:[f.jsx("button",{onClick:t,className:"w-full sm:w-auto px-4 py-2 rounded border border-gray-300 text-gray-700 hover:bg-gray-100 transition  text-xs",children:"Cancelar"}),f.jsx("button",{onClick:()=>{n(),d("")},disabled:l.trim()!==r,className:`w-full sm:w-auto px-4 py-2 rounded  text-xs font-semibold transition ${l.trim()===r?"bg-red-600 text-white hover:bg-red-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Sí, eliminar"})]})]})}):null}function c2e({comunidades:e=[],onDelete:t}){const n=aa(),r=br(),[l,d]=V.useState(5),[p,a]=V.useState(!1),[b,T]=V.useState(null),E=F=>{n(`/dashboard-admin/mis-comunidades/${F}/editar`)},P=F=>{T(F),a(!0)},I=async()=>{if(!(b!=null&&b._id))return;const F=b._id;try{typeof t=="function"?await t(F):await r(_U(F)).unwrap(),r(Jt({message:`Comunidad "${b.name}" eliminada`,type:"success"}))}catch{r(Jt({message:"Error al eliminar comunidad",type:"error"}))}finally{a(!1),T(null)}};if(!e||e.length===0)return f.jsxs("div",{className:"bg-[#F7F7F7] p-4 md:p-6 rounded-2xl h-full flex flex-col items-center justify-center text-center gap-4",children:[f.jsx("h3",{className:"text-gray-600 text-lg font-semibold",children:"Tus comunidades"}),f.jsx("p",{className:"text-xs text-gray-500",children:"Aún no has creado ninguna comunidad. ¡Este es el momento perfecto para comenzar!"}),f.jsx(Wn,{to:"/dashboard/comunidades/crear",className:"inline-flex items-center gap-2 bg-orange-500 hover:bg-orange-600 text-white text-xs font-medium px-4 py-2 rounded-full transition cursor-pointer",children:"🚀 Crear mi primera comunidad"})]});const R=e.slice(0,l);return f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"bg-[#F7F7F7] px-2 py-3 md:p-3 lg:p-6 rounded-2xl flex flex-col justify-start gap-1 h-full",children:[f.jsx("h3",{className:"text-gray-600 text-lg font-semibold pb-4",children:"Tus comunidades"}),R.map((F,W)=>f.jsxs("div",{children:[f.jsxs("div",{onClick:()=>n(`/comunidades/${F._id}`),className:"flex items-center gap-3 p-1 cursor-pointer hover:bg-white hover:shadow-md rounded-lg transition",children:[f.jsx("div",{className:"w-12 h-12 flex-shrink-0",children:F.flagImage?f.jsx("img",{src:F.flagImage,alt:F.name,className:"w-full h-full rounded-lg object-cover border border-gray-200"}):f.jsx("div",{className:"w-full h-full bg-gray-200 rounded-lg flex items-center justify-center text-xs text-gray-500",children:"Sin imagen"})}),f.jsx("div",{className:"flex-1 min-w-0",children:f.jsx("p",{className:"text-xs font-medium text-[#3F5374] truncate",children:F.name})}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("button",{onClick:$=>{$.stopPropagation(),E(F._id)},className:"p-1 text-gray-500 hover:text-orange-500 transition",children:f.jsx(FP,{className:"w-4 h-4"})}),f.jsx("button",{onClick:$=>{$.stopPropagation(),P(F)},className:"p-1 text-gray-500 hover:text-red-500 transition",children:f.jsx(BP,{className:"w-4 h-4"})})]})]}),W!==R.length-1&&f.jsx("hr",{className:"border-t border-gray-200 mx-2"})]},F._id)),e.length>5&&f.jsxs("div",{className:"mt-3 flex flex-wrap justify-center gap-3",children:[l<e.length&&f.jsx("button",{onClick:()=>d(F=>F+5),className:"inline-flex items-center gap-1 text-xs font-medium text-orange-600 hover:text-orange-700 transition",children:"Ver más"}),l>5&&f.jsxs("button",{onClick:()=>d(5),className:"inline-flex items-center gap-1 text-xs font-medium text-orange-600 hover:text-orange-700 transition",children:[f.jsx(LP,{className:"w-4 h-4"}),"Ver menos"]})]})]}),b&&f.jsx(cp,{open:p,onClose:()=>a(!1),onConfirm:I,entityName:b.name,title:"Eliminar comunidad",description:"Para confirmar, escribe el nombre exacto de la comunidad:"})]})}function u2e({negocios:e=[],onDelete:t}){const n=aa(),r=br(),[l,d]=V.useState(5),[p,a]=V.useState(!1),[b,T]=V.useState(null),E=(e||[]).slice(0,l),P=F=>{n(`/dashboard/mis-negocios/${F}/editar`)},I=F=>{T(F),a(!0)},R=async()=>{if(!(b!=null&&b._id))return;const F=b._id;try{typeof t=="function"?await t(F):await r(CP(F)).unwrap(),r(Jt({message:`Negocio "${b.name}" eliminado`,type:"success"}))}catch{r(Jt({message:"Error al eliminar negocio",type:"error"}))}finally{a(!1),T(null)}};return!e||e.length===0?f.jsxs("div",{className:"bg-[#F7F7F7] h-full p-4 md:p-6 rounded-2xl flex flex-col items-center justify-center text-center gap-4",children:[f.jsx("h3",{className:"text-gray-600 text-lg font-bold pb-2",children:"Tus negocios"}),f.jsx("p",{className:"text-xs text-gray-500",children:"No tienes negocios registrados aún. ¡Es momento de dar a conocer tu proyecto!"}),f.jsx(Wn,{to:"/dashboard/mis-negocios/crear",className:"inline-flex items-center gap-2 bg-orange-500 hover:bg-orange-600 text-white text-xs font-medium px-4 py-2 rounded-full transition cursor-pointer",children:"✨ Crear mi primer negocio"})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"bg-[#F7F7F7] px-2 py-3 md:p-3 lg:p-6 rounded-2xl flex flex-col justify-start gap-1 h-full",children:[f.jsx("h3",{className:"text-gray-600 text-lg font-semibold pb-4",children:"Tus negocios"}),E.map((F,W)=>f.jsxs("div",{children:[f.jsxs("div",{onClick:()=>n(`/negocios/${F._id}`),className:"flex items-center gap-3 p-1 cursor-pointer hover:bg-white hover:shadow-md rounded-lg transition",children:[f.jsx("div",{className:"w-12 h-12 flex-shrink-0",children:F.profileImage?f.jsx("img",{src:F.profileImage,alt:F.name,className:"w-full h-full rounded-lg object-cover border border-gray-200"}):f.jsx("div",{className:"w-full h-full bg-gray-200 rounded-lg flex items-center justify-center text-xs text-gray-500",children:"Sin imagen"})}),f.jsx("div",{className:"flex-1 min-w-0",children:f.jsx("p",{className:"text-xs font-medium text-[#3F5374] truncate",children:F.name})}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("button",{onClick:$=>{$.stopPropagation(),P(F._id)},className:"p-1 text-gray-500 hover:text-orange-500 transition",children:f.jsx(FP,{className:"w-4 h-4"})}),f.jsx("button",{onClick:$=>{$.stopPropagation(),I(F)},className:"p-1 text-gray-500 hover:text-red-500 transition",children:f.jsx(BP,{className:"w-4 h-4"})})]})]}),W!==E.length-1&&f.jsx("hr",{className:"border-t border-gray-200 mx-2"})]},F._id)),e.length>5&&f.jsxs("div",{className:"mt-3 flex flex-wrap justify-center gap-3",children:[l<e.length&&f.jsx("button",{onClick:()=>d(F=>F+5),className:"inline-flex items-center gap-1 text-xs font-medium text-orange-600 hover:text-orange-700 transition",children:"Ver más"}),l>5&&f.jsxs("button",{onClick:()=>d(5),className:"inline-flex items-center gap-1 text-xs font-medium text-orange-600 hover:text-orange-700 transition",children:[f.jsx(LP,{className:"w-4 h-4"}),"Ver menos"]})]})]}),b&&f.jsx(cp,{open:p,onClose:()=>a(!1),onConfirm:R,entityName:b.name,title:"Eliminar negocio",description:"Para confirmar, escribe el nombre exacto del negocio:"})]})}function d2e({eventos:e=[],onDelete:t}){const n=aa(),r=br(),[l,d]=V.useState(5),[p,a]=V.useState(!1),[b,T]=V.useState(null),E=F=>{n(`/dashboard/mis-eventos/${F}/editar`)},P=F=>{T(F),a(!0)},I=async()=>{if(!(b!=null&&b._id))return;const F=b._id;try{typeof t=="function"?await t(F):await r(KE(F)).unwrap(),r(Jt({message:`Evento "${b.title}" eliminado`,type:"success"}))}catch{r(Jt({message:"Error al eliminar evento",type:"error"}))}finally{a(!1),T(null)}};if(!e||e.length===0)return f.jsxs("div",{className:"bg-[#F7F7F7] p-4 md:p-6 rounded-2xl h-full flex flex-col items-center justify-center text-center gap-4",children:[f.jsx("h3",{className:"text-gray-600 text-lg font-semibold",children:"Tus eventos"}),f.jsx("p",{className:"text-xs text-gray-500",children:"Aún no tienes eventos creados. ¡Comparte actividades y conecta con tu comunidad!"}),f.jsx(Wn,{to:"/dashboard/mis-eventos/crear",className:"inline-flex items-center gap-2 bg-orange-500 hover:bg-orange-600 text-white text-xs font-medium px-4 py-2 rounded-full transition cursor-pointer",children:"📅 Crear mi primer evento"})]});const R=e.slice(0,l);return f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"bg-[#F7F7F7] px-2 py-3 md:p-3 lg:p-6 rounded-2xl flex flex-col justify-start gap-1 h-full",children:[f.jsx("h3",{className:"text-gray-600 text-lg font-semibold pb-4",children:"Tus eventos"}),R.map((F,W)=>f.jsxs("div",{children:[f.jsxs("div",{onClick:()=>n(`/eventos/${F._id}`),className:"flex items-center gap-3 p-1 cursor-pointer hover:bg-white hover:shadow-md rounded-lg transition",children:[f.jsx("div",{className:"w-12 h-12 flex-shrink-0",children:F.featuredImage?f.jsx("img",{src:F.featuredImage,alt:F.title,className:"w-full h-full rounded-lg object-cover border border-gray-200"}):f.jsx("div",{className:"w-full h-full bg-gray-200 rounded-lg flex items-center justify-center text-xs text-gray-500",children:"Sin imagen"})}),f.jsx("div",{className:"flex-1 min-w-0",children:f.jsx("p",{className:"text-xs font-medium text-[#3F5374] whitespace-nowrap truncate",children:F.title})}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("button",{onClick:$=>{$.stopPropagation(),E(F._id)},className:"p-1 text-gray-500 hover:text-orange-500 transition",children:f.jsx(FP,{className:"w-4 h-4"})}),f.jsx("button",{onClick:$=>{$.stopPropagation(),P(F)},className:"p-1 text-gray-500 hover:text-red-500 transition",children:f.jsx(BP,{className:"w-4 h-4"})})]})]}),W!==R.length-1&&f.jsx("hr",{className:"border-t border-gray-200 mx-2"})]},F._id)),e.length>5&&f.jsxs("div",{className:"mt-3 flex flex-wrap justify-center gap-3",children:[l<e.length&&f.jsx("button",{onClick:()=>d(F=>F+5),className:"inline-flex items-center gap-1 text-xs font-medium text-orange-600 hover:text-orange-700 transition",children:"Ver más"}),l>5&&f.jsxs("button",{onClick:()=>d(5),className:"inline-flex items-center gap-1 text-xs font-medium text-orange-600 hover:text-orange-700 transition",children:[f.jsx(LP,{className:"w-4 h-4"}),"Ver menos"]})]})]}),b&&f.jsx(cp,{open:p,onClose:()=>a(!1),onConfirm:I,entityName:b.title,title:"Eliminar evento",description:"Para confirmar, escribe el nombre exacto del evento:"})]})}function h2e(){return f.jsxs("div",{className:"max-w-[1200px] w-full mx-auto flex flex-col gap-6 animate-pulse",children:[f.jsx("div",{className:"w-full h-40 bg-gray-100 rounded-md"}),f.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[f.jsx("div",{className:"w-full md:w-[30%] h-118 bg-gray-100 rounded-md"}),f.jsx("div",{className:"w-full md:w-[70%] h-118 bg-gray-100 rounded-md"})]}),f.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[f.jsx("div",{className:"w-full md:w-1/2 h-[200px] bg-gray-100 rounded-md"}),f.jsx("div",{className:"w-full md:w-1/2 h-[200px] bg-gray-100 rounded-md"})]})]})}const _W="/assets/ilust3-B8b0Ex29.svg";function f2e(){const e=br(),t=ln(ae=>ae.auth.usuario),n=ln(ae=>ae.categorias.data||[]),r=ln(ae=>ae.categorias.loaded),l=ln(ae=>ae.comunidades.lista||[]),d=ln(ae=>ae.comunidades.loaded),{coords:p,cargando:a}=ln(ae=>ae.ubicacion),b=ln(ae=>ae.comunidades.misComunidades||[]),T=ln(ae=>ae.negocios.misNegocios||[]),E=ln(ae=>ae.eventos.misEventos||[]),P=ln(ae=>ae.comunidades.loadingMis),I=ln(ae=>ae.negocios.misLoading),R=ln(ae=>ae.eventos.misLoading),[F,W]=V.useState("negocios"),$=["admin"].includes(t==null?void 0:t.role),Z=V.useRef(!1),ne=V.useRef(!1),ie=V.useRef(!1),ge=V.useRef(!1);return V.useEffect(()=>{!p&&!a&&e(Ob())},[e,p,a]),V.useEffect(()=>{(!r||n.length===0)&&e(Em())},[r,n.length,e]),V.useEffect(()=>{if(!p)return;(!Array.isArray(l)||l.length===0||!d)&&!Z.current&&(Z.current=!0,e(zd({lat:p.lat,lng:p.lng,page:1})))},[p,l,d,e]),V.useEffect(()=>{!ne.current&&b.length===0&&!P&&(ne.current=!0,e(Cb())),!ie.current&&T.length===0&&!I&&(ie.current=!0,e(Eb())),!ge.current&&E.length===0&&!R&&(ge.current=!0,e(KS()))},[b.length,T.length,E.length,P,I,R,e]),P||I||R?f.jsx(h2e,{}):f.jsxs("div",{className:"max-w-[1200px] w-full mx-auto flex flex-col gap-8 p-2",children:[f.jsx("div",{className:"border border-gray-100 rounded-2xl shadow-md",children:f.jsx(o2e,{usuario:t})}),f.jsx("div",{className:"flex flex-wrap rounded-t-xl bg-gray-100 gap-2 border-gray-200 pt-2 px-4 shadow-md",children:[$&&{id:"comunidades",label:"Mis comunidades"},{id:"negocios",label:"Mis negocios"},{id:"eventos",label:"Mis eventos"}].filter(Boolean).map(ae=>f.jsx("button",{onClick:()=>W(ae.id),className:`text-xs px-3 py-2 rounded-t-xl font-medium transition ${F===ae.id?"bg-white border border-b-0 border-gray-200 text-gray-800":"text-gray-600 hover:text-gray-800"}`,children:ae.label},ae.id))}),f.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-stretch",children:[f.jsx("div",{className:"w-full md:w-1/3 flex flex-col",children:f.jsx("div",{className:"bg-white border border-gray-200 rounded-2xl shadow-sm h-full",children:f.jsx(l2e,{resumen:[{label:"Tus comunidades",value:(b==null?void 0:b.length)||0,path:"/dashboard-admin/mis-comunidades",requireAdmin:!0},{label:"Tus categorías",value:(n==null?void 0:n.length)||0,path:"/dashboard/categorias",requireAdmin:!0},{label:"Tus negocios",value:(T==null?void 0:T.length)||0,path:"/dashboard/mis-negocios"},{label:"Tus eventos",value:(E==null?void 0:E.length)||0,path:"/dashboard/mis-eventos"}],user:t})})}),f.jsxs("div",{className:"w-full md:w-2/3 flex flex-col gap-4",children:[F==="comunidades"&&$&&f.jsx("div",{className:"bg-white border border-gray-200 rounded-2xl shadow-sm h-full",children:f.jsx(c2e,{comunidades:b})}),F==="negocios"&&f.jsx("div",{className:"bg-white border border-gray-200 rounded-2xl shadow-sm h-full",children:f.jsx(u2e,{negocios:T})}),F==="eventos"&&f.jsx("div",{className:"bg-white border border-gray-200 rounded-2xl shadow-sm h-full",children:f.jsx(d2e,{eventos:E})})]})]}),f.jsxs("div",{className:"flex flex-col items-center text-center gap-5 py-16",children:[f.jsx("img",{src:_W,alt:"Perfil",className:"w-40 opacity-90"}),f.jsx("p",{className:"text-gray-500 text-xs max-w-xs",children:"Mantener tu información actualizada hace más fácil que la comunidad conecte contigo y conozca mejor tu proyecto."}),f.jsx(Wn,{to:"/dashboard/perfil/editar",className:"inline-block bg-orange-500 hover:bg-orange-600 text-white  text-xs font-medium px-4 py-2 rounded-full transition shadow-lg",children:"Editar mi perfil"})]})]})}const xs={control:(e,t)=>({...e,backgroundColor:"rgba(255,255,255,0.05)",borderColor:t.isFocused?"#fb923c":"rgba(255,255,255,0.2)",boxShadow:t.isFocused?"0 0 0 1px #fb923c":"none","&:hover":{borderColor:"#fb923c"},borderRadius:"0.5rem",minHeight:"3rem",cursor:"pointer"}),menu:e=>({...e,backgroundColor:"rgba(0,0,0,0.8)",borderRadius:"0.5rem",zIndex:20,padding:"0.5rem"}),option:(e,t)=>({...e,backgroundColor:t.isFocused?"rgba(251, 146, 60, 0.2)":"transparent",color:"white",cursor:"pointer",borderRadius:"0.375rem",padding:"0.5rem 0.75rem"}),singleValue:e=>({...e,color:"white"}),placeholder:e=>({...e,color:"rgba(255,255,255,0.4)"}),input:e=>({...e,color:"white"}),dropdownIndicator:e=>({...e,color:"rgba(255,255,255,0.6)","&:hover":{color:"white"}}),indicatorSeparator:()=>({display:"none"})};function p2e(){const{values:e,setFieldValue:t}=mo(),n=[{value:"Empresario",label:"Empresario"},{value:"Estudiante",label:"Estudiante"},{value:"Profesional",label:"Profesional"},{value:"Otro",label:"Otro"}];return f.jsxs("div",{className:"space-y-6",children:[f.jsx("h3",{className:"text-white text-lg font-semibold",children:"Información personal"}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Nombre"}),f.jsx(jn,{name:"name",placeholder:"Usuario",className:"w-full px-4 py-3 border border-white/30 bg-white/10 rounded-lg placeholder:text-gray-300 text-white focus:outline-none focus:ring-2 focus:ring-orange-500"}),f.jsx(wn,{name:"name",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Apellido"}),f.jsx(jn,{name:"lastName",placeholder:"Usuario",className:"w-full px-4 py-3 border border-white/30 bg-white/10 rounded-lg placeholder:text-gray-300 text-white focus:outline-none focus:ring-2 focus:ring-orange-500"}),f.jsx(wn,{name:"lastName",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Título"}),f.jsx(gs,{menuPlacement:"top",options:n,placeholder:"Selecciona una opción...",styles:xs,value:n.find(r=>r.value===e.title)||null,onChange:r=>t("title",r==null?void 0:r.value)}),f.jsx(wn,{name:"title",component:"div",className:"text-red-400  text-xs mt-1"})]})]})}function m2e(){return f.jsxs("div",{className:"space-y-6",children:[f.jsx("h3",{className:"text-white text-lg font-semibold",children:"Sobre ti"}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Descripción"}),f.jsx(jn,{as:"textarea",name:"description",placeholder:"Cuéntanos algo sobre ti...",rows:5,className:"w-full px-4 py-3 border border-white/30 bg-white/10 rounded-lg placeholder:text-gray-300 text-white focus:outline-none focus:ring-2 focus:ring-orange-500"}),f.jsx(wn,{name:"description",component:"div",className:"text-red-400  text-xs mt-1"})]})]})}function jy(e,t,n,r){function l(d){return d instanceof n?d:new n(function(p){p(d)})}return new(n||(n=Promise))(function(d,p){function a(E){try{T(r.next(E))}catch(P){p(P)}}function b(E){try{T(r.throw(E))}catch(P){p(P)}}function T(E){E.done?d(E.value):l(E.value).then(a,b)}T((r=r.apply(e,t||[])).next())})}const g2e=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function p_(e,t,n){const r=x2e(e),{webkitRelativePath:l}=e,d=typeof t=="string"?t:typeof l=="string"&&l.length>0?l:`./${e.name}`;return typeof r.path!="string"&&K8(r,"path",d),K8(r,"relativePath",d),r}function x2e(e){const{name:t}=e;if(t&&t.lastIndexOf(".")!==-1&&!e.type){const r=t.split(".").pop().toLowerCase(),l=g2e.get(r);l&&Object.defineProperty(e,"type",{value:l,writable:!1,configurable:!1,enumerable:!0})}return e}function K8(e,t,n){Object.defineProperty(e,t,{value:n,writable:!1,configurable:!1,enumerable:!0})}const y2e=[".DS_Store","Thumbs.db"];function v2e(e){return jy(this,void 0,void 0,function*(){return iE(e)&&_2e(e.dataTransfer)?T2e(e.dataTransfer,e.type):b2e(e)?w2e(e):Array.isArray(e)&&e.every(t=>"getFile"in t&&typeof t.getFile=="function")?S2e(e):[]})}function _2e(e){return iE(e)}function b2e(e){return iE(e)&&iE(e.target)}function iE(e){return typeof e=="object"&&e!==null}function w2e(e){return S5(e.target.files).map(t=>p_(t))}function S2e(e){return jy(this,void 0,void 0,function*(){return(yield Promise.all(e.map(n=>n.getFile()))).map(n=>p_(n))})}function T2e(e,t){return jy(this,void 0,void 0,function*(){if(e.items){const n=S5(e.items).filter(l=>l.kind==="file");if(t!=="drop")return n;const r=yield Promise.all(n.map(E2e));return Y8(bW(r))}return Y8(S5(e.files).map(n=>p_(n)))})}function Y8(e){return e.filter(t=>y2e.indexOf(t.name)===-1)}function S5(e){if(e===null)return[];const t=[];for(let n=0;n<e.length;n++){const r=e[n];t.push(r)}return t}function E2e(e){if(typeof e.webkitGetAsEntry!="function")return Q8(e);const t=e.webkitGetAsEntry();return t&&t.isDirectory?wW(t):Q8(e,t)}function bW(e){return e.reduce((t,n)=>[...t,...Array.isArray(n)?bW(n):[n]],[])}function Q8(e,t){return jy(this,void 0,void 0,function*(){var n;if(globalThis.isSecureContext&&typeof e.getAsFileSystemHandle=="function"){const d=yield e.getAsFileSystemHandle();if(d===null)throw new Error(`${e} is not a File`);if(d!==void 0){const p=yield d.getFile();return p.handle=d,p_(p)}}const r=e.getAsFile();if(!r)throw new Error(`${e} is not a File`);return p_(r,(n=t==null?void 0:t.fullPath)!==null&&n!==void 0?n:void 0)})}function A2e(e){return jy(this,void 0,void 0,function*(){return e.isDirectory?wW(e):C2e(e)})}function wW(e){const t=e.createReader();return new Promise((n,r)=>{const l=[];function d(){t.readEntries(p=>jy(this,void 0,void 0,function*(){if(p.length){const a=Promise.all(p.map(A2e));l.push(a),d()}else try{const a=yield Promise.all(l);n(a)}catch(a){r(a)}}),p=>{r(p)})}d()})}function C2e(e){return jy(this,void 0,void 0,function*(){return new Promise((t,n)=>{e.file(r=>{const l=p_(r,e.fullPath);t(l)},r=>{n(r)})})})}var IS={},J8;function j2e(){return J8||(J8=1,IS.__esModule=!0,IS.default=function(e,t){if(e&&t){var n=Array.isArray(t)?t:t.split(",");if(n.length===0)return!0;var r=e.name||"",l=(e.type||"").toLowerCase(),d=l.replace(/\/.*$/,"");return n.some(function(p){var a=p.trim().toLowerCase();return a.charAt(0)==="."?r.toLowerCase().endsWith(a):a.endsWith("/*")?d===a.replace(/\/.*$/,""):l===a})}return!0}),IS}var M2e=j2e();const T4=Gs(M2e);function eF(e){return D2e(e)||N2e(e)||TW(e)||P2e()}function P2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function N2e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function D2e(e){if(Array.isArray(e))return T5(e)}function tF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function nF(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?tF(Object(n),!0).forEach(function(r){SW(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tF(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function SW(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gw(e,t){return k2e(e)||I2e(e,t)||TW(e,t)||O2e()}function O2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TW(e,t){if(e){if(typeof e=="string")return T5(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T5(e,t)}}function T5(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function I2e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r=[],l=!0,d=!1,p,a;try{for(n=n.call(e);!(l=(p=n.next()).done)&&(r.push(p.value),!(t&&r.length===t));l=!0);}catch(b){d=!0,a=b}finally{try{!l&&n.return!=null&&n.return()}finally{if(d)throw a}}return r}}function k2e(e){if(Array.isArray(e))return e}var R2e=typeof T4=="function"?T4:T4.default,z2e="file-invalid-type",L2e="file-too-large",F2e="file-too-small",B2e="too-many-files",V2e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=t.split(","),r=n.length>1?"one of ".concat(n.join(", ")):n[0];return{code:z2e,message:"File type must be ".concat(r)}},rF=function(t){return{code:L2e,message:"File is larger than ".concat(t," ").concat(t===1?"byte":"bytes")}},iF=function(t){return{code:F2e,message:"File is smaller than ".concat(t," ").concat(t===1?"byte":"bytes")}},U2e={code:B2e,message:"Too many files"};function EW(e,t){var n=e.type==="application/x-moz-file"||R2e(e,t);return[n,n?null:V2e(t)]}function AW(e,t,n){if(B0(e.size))if(B0(t)&&B0(n)){if(e.size>n)return[!1,rF(n)];if(e.size<t)return[!1,iF(t)]}else{if(B0(t)&&e.size<t)return[!1,iF(t)];if(B0(n)&&e.size>n)return[!1,rF(n)]}return[!0,null]}function B0(e){return e!=null}function $2e(e){var t=e.files,n=e.accept,r=e.minSize,l=e.maxSize,d=e.multiple,p=e.maxFiles,a=e.validator;return!d&&t.length>1||d&&p>=1&&t.length>p?!1:t.every(function(b){var T=EW(b,n),E=gw(T,1),P=E[0],I=AW(b,r,l),R=gw(I,1),F=R[0],W=a?a(b):null;return P&&F&&!W})}function aE(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function kS(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(t){return t==="Files"||t==="application/x-moz-file"}):!!e.target&&!!e.target.files}function aF(e){e.preventDefault()}function q2e(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function H2e(e){return e.indexOf("Edge/")!==-1}function G2e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return q2e(e)||H2e(e)}function Gf(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(r){for(var l=arguments.length,d=new Array(l>1?l-1:0),p=1;p<l;p++)d[p-1]=arguments[p];return t.some(function(a){return!aE(r)&&a&&a.apply(void 0,[r].concat(d)),aE(r)})}}function W2e(){return"showOpenFilePicker"in window}function Z2e(e){if(B0(e)){var t=Object.entries(e).filter(function(n){var r=gw(n,2),l=r[0],d=r[1],p=!0;return CW(l)||(console.warn('Skipped "'.concat(l,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),p=!1),(!Array.isArray(d)||!d.every(jW))&&(console.warn('Skipped "'.concat(l,'" because an invalid file extension was provided.')),p=!1),p}).reduce(function(n,r){var l=gw(r,2),d=l[0],p=l[1];return nF(nF({},n),{},SW({},d,p))},{});return[{description:"Files",accept:t}]}return e}function X2e(e){if(B0(e))return Object.entries(e).reduce(function(t,n){var r=gw(n,2),l=r[0],d=r[1];return[].concat(eF(t),[l],eF(d))},[]).filter(function(t){return CW(t)||jW(t)}).join(",")}function K2e(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function Y2e(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function CW(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||e==="application/*"||/\w+\/[-+.\w]+/g.test(e)}function jW(e){return/^.*\.[\w]+$/.test(e)}var Q2e=["children"],J2e=["open"],eSe=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],tSe=["refKey","onChange","onClick"];function nSe(e){return aSe(e)||iSe(e)||MW(e)||rSe()}function rSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iSe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aSe(e){if(Array.isArray(e))return E5(e)}function E4(e,t){return lSe(e)||oSe(e,t)||MW(e,t)||sSe()}function sSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MW(e,t){if(e){if(typeof e=="string")return E5(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E5(e,t)}}function E5(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function oSe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r=[],l=!0,d=!1,p,a;try{for(n=n.call(e);!(l=(p=n.next()).done)&&(r.push(p.value),!(t&&r.length===t));l=!0);}catch(b){d=!0,a=b}finally{try{!l&&n.return!=null&&n.return()}finally{if(d)throw a}}return r}}function lSe(e){if(Array.isArray(e))return e}function sF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function fs(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?sF(Object(n),!0).forEach(function(r){A5(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sF(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function A5(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sE(e,t){if(e==null)return{};var n=cSe(e,t),r,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(l=0;l<d.length;l++)r=d[l],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function cSe(e,t){if(e==null)return{};var n={},r=Object.keys(e),l,d;for(d=0;d<r.length;d++)l=r[d],!(t.indexOf(l)>=0)&&(n[l]=e[l]);return n}var uD=V.forwardRef(function(e,t){var n=e.children,r=sE(e,Q2e),l=dD(r),d=l.open,p=sE(l,J2e);return V.useImperativeHandle(t,function(){return{open:d}},[d]),$s.createElement(V.Fragment,null,n(fs(fs({},p),{},{open:d})))});uD.displayName="Dropzone";var PW={disabled:!1,getFilesFromEvent:v2e,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};uD.defaultProps=PW;uD.propTypes={children:zr.func,accept:zr.objectOf(zr.arrayOf(zr.string)),multiple:zr.bool,preventDropOnDocument:zr.bool,noClick:zr.bool,noKeyboard:zr.bool,noDrag:zr.bool,noDragEventsBubbling:zr.bool,minSize:zr.number,maxSize:zr.number,maxFiles:zr.number,disabled:zr.bool,getFilesFromEvent:zr.func,onFileDialogCancel:zr.func,onFileDialogOpen:zr.func,useFsAccessApi:zr.bool,autoFocus:zr.bool,onDragEnter:zr.func,onDragLeave:zr.func,onDragOver:zr.func,onDrop:zr.func,onDropAccepted:zr.func,onDropRejected:zr.func,onError:zr.func,validator:zr.func};var C5={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function dD(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=fs(fs({},PW),e),n=t.accept,r=t.disabled,l=t.getFilesFromEvent,d=t.maxSize,p=t.minSize,a=t.multiple,b=t.maxFiles,T=t.onDragEnter,E=t.onDragLeave,P=t.onDragOver,I=t.onDrop,R=t.onDropAccepted,F=t.onDropRejected,W=t.onFileDialogCancel,$=t.onFileDialogOpen,Z=t.useFsAccessApi,ne=t.autoFocus,ie=t.preventDropOnDocument,ge=t.noClick,ae=t.noKeyboard,se=t.noDrag,me=t.noDragEventsBubbling,ke=t.onError,qe=t.validator,tt=V.useMemo(function(){return X2e(n)},[n]),nt=V.useMemo(function(){return Z2e(n)},[n]),bt=V.useMemo(function(){return typeof $=="function"?$:oF},[$]),jt=V.useMemo(function(){return typeof W=="function"?W:oF},[W]),Nt=V.useRef(null),vt=V.useRef(null),He=V.useReducer(uSe,C5),ut=E4(He,2),Tt=ut[0],Yt=ut[1],Ge=Tt.isFocused,ot=Tt.isFileDialogActive,mt=V.useRef(typeof window<"u"&&window.isSecureContext&&Z&&W2e()),It=function(){!mt.current&&ot&&setTimeout(function(){if(vt.current){var pn=vt.current.files;pn.length||(Yt({type:"closeDialog"}),jt())}},300)};V.useEffect(function(){return window.addEventListener("focus",It,!1),function(){window.removeEventListener("focus",It,!1)}},[vt,ot,jt,mt]);var In=V.useRef([]),Mn=function(pn){Nt.current&&Nt.current.contains(pn.target)||(pn.preventDefault(),In.current=[])};V.useEffect(function(){return ie&&(document.addEventListener("dragover",aF,!1),document.addEventListener("drop",Mn,!1)),function(){ie&&(document.removeEventListener("dragover",aF),document.removeEventListener("drop",Mn))}},[Nt,ie]),V.useEffect(function(){return!r&&ne&&Nt.current&&Nt.current.focus(),function(){}},[Nt,ne,r]);var vn=V.useCallback(function(Zt){ke?ke(Zt):console.error(Zt)},[ke]),Zn=V.useCallback(function(Zt){Zt.preventDefault(),Zt.persist(),Xa(Zt),In.current=[].concat(nSe(In.current),[Zt.target]),kS(Zt)&&Promise.resolve(l(Zt)).then(function(pn){if(!(aE(Zt)&&!me)){var tr=pn.length,Qn=tr>0&&$2e({files:pn,accept:tt,minSize:p,maxSize:d,multiple:a,maxFiles:b,validator:qe}),Yr=tr>0&&!Qn;Yt({isDragAccept:Qn,isDragReject:Yr,isDragActive:!0,type:"setDraggedFiles"}),T&&T(Zt)}}).catch(function(pn){return vn(pn)})},[l,T,vn,me,tt,p,d,a,b,qe]),Sr=V.useCallback(function(Zt){Zt.preventDefault(),Zt.persist(),Xa(Zt);var pn=kS(Zt);if(pn&&Zt.dataTransfer)try{Zt.dataTransfer.dropEffect="copy"}catch{}return pn&&P&&P(Zt),!1},[P,me]),un=V.useCallback(function(Zt){Zt.preventDefault(),Zt.persist(),Xa(Zt);var pn=In.current.filter(function(Qn){return Nt.current&&Nt.current.contains(Qn)}),tr=pn.indexOf(Zt.target);tr!==-1&&pn.splice(tr,1),In.current=pn,!(pn.length>0)&&(Yt({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),kS(Zt)&&E&&E(Zt))},[Nt,E,me]),er=V.useCallback(function(Zt,pn){var tr=[],Qn=[];Zt.forEach(function(Yr){var pi=EW(Yr,tt),Ua=E4(pi,2),Ji=Ua[0],Xs=Ua[1],Ka=AW(Yr,p,d),La=E4(Ka,2),cs=La[0],Os=La[1],vs=qe?qe(Yr):null;if(Ji&&cs&&!vs)tr.push(Yr);else{var yi=[Xs,Os];vs&&(yi=yi.concat(vs)),Qn.push({file:Yr,errors:yi.filter(function(Is){return Is})})}}),(!a&&tr.length>1||a&&b>=1&&tr.length>b)&&(tr.forEach(function(Yr){Qn.push({file:Yr,errors:[U2e]})}),tr.splice(0)),Yt({acceptedFiles:tr,fileRejections:Qn,isDragReject:Qn.length>0,type:"setFiles"}),I&&I(tr,Qn,pn),Qn.length>0&&F&&F(Qn,pn),tr.length>0&&R&&R(tr,pn)},[Yt,a,tt,p,d,b,I,R,F,qe]),hr=V.useCallback(function(Zt){Zt.preventDefault(),Zt.persist(),Xa(Zt),In.current=[],kS(Zt)&&Promise.resolve(l(Zt)).then(function(pn){aE(Zt)&&!me||er(pn,Zt)}).catch(function(pn){return vn(pn)}),Yt({type:"reset"})},[l,er,vn,me]),dn=V.useCallback(function(){if(mt.current){Yt({type:"openDialog"}),bt();var Zt={multiple:a,types:nt};window.showOpenFilePicker(Zt).then(function(pn){return l(pn)}).then(function(pn){er(pn,null),Yt({type:"closeDialog"})}).catch(function(pn){K2e(pn)?(jt(pn),Yt({type:"closeDialog"})):Y2e(pn)?(mt.current=!1,vt.current?(vt.current.value=null,vt.current.click()):vn(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):vn(pn)});return}vt.current&&(Yt({type:"openDialog"}),bt(),vt.current.value=null,vt.current.click())},[Yt,bt,jt,Z,er,vn,nt,a]),Ir=V.useCallback(function(Zt){!Nt.current||!Nt.current.isEqualNode(Zt.target)||(Zt.key===" "||Zt.key==="Enter"||Zt.keyCode===32||Zt.keyCode===13)&&(Zt.preventDefault(),dn())},[Nt,dn]),Zr=V.useCallback(function(){Yt({type:"focus"})},[]),sa=V.useCallback(function(){Yt({type:"blur"})},[]),Mi=V.useCallback(function(){ge||(G2e()?setTimeout(dn,0):dn())},[ge,dn]),Ci=function(pn){return r?null:pn},ls=function(pn){return ae?null:Ci(pn)},wa=function(pn){return se?null:Ci(pn)},Xa=function(pn){me&&pn.stopPropagation()},Ds=V.useMemo(function(){return function(){var Zt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},pn=Zt.refKey,tr=pn===void 0?"ref":pn,Qn=Zt.role,Yr=Zt.onKeyDown,pi=Zt.onFocus,Ua=Zt.onBlur,Ji=Zt.onClick,Xs=Zt.onDragEnter,Ka=Zt.onDragOver,La=Zt.onDragLeave,cs=Zt.onDrop,Os=sE(Zt,eSe);return fs(fs(A5({onKeyDown:ls(Gf(Yr,Ir)),onFocus:ls(Gf(pi,Zr)),onBlur:ls(Gf(Ua,sa)),onClick:Ci(Gf(Ji,Mi)),onDragEnter:wa(Gf(Xs,Zn)),onDragOver:wa(Gf(Ka,Sr)),onDragLeave:wa(Gf(La,un)),onDrop:wa(Gf(cs,hr)),role:typeof Qn=="string"&&Qn!==""?Qn:"presentation"},tr,Nt),!r&&!ae?{tabIndex:0}:{}),Os)}},[Nt,Ir,Zr,sa,Mi,Zn,Sr,un,hr,ae,se,r]),Ft=V.useCallback(function(Zt){Zt.stopPropagation()},[]),Hn=V.useMemo(function(){return function(){var Zt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},pn=Zt.refKey,tr=pn===void 0?"ref":pn,Qn=Zt.onChange,Yr=Zt.onClick,pi=sE(Zt,tSe),Ua=A5({accept:tt,multiple:a,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:Ci(Gf(Qn,hr)),onClick:Ci(Gf(Yr,Ft)),tabIndex:-1},tr,vt);return fs(fs({},Ua),pi)}},[vt,n,a,hr,r]);return fs(fs({},Tt),{},{isFocused:Ge&&!r,getRootProps:Ds,getInputProps:Hn,rootRef:Nt,inputRef:vt,open:Ci(dn)})}function uSe(e,t){switch(t.type){case"focus":return fs(fs({},e),{},{isFocused:!0});case"blur":return fs(fs({},e),{},{isFocused:!1});case"openDialog":return fs(fs({},C5),{},{isFileDialogActive:!0});case"closeDialog":return fs(fs({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return fs(fs({},e),{},{isDragActive:t.isDragActive,isDragAccept:t.isDragAccept,isDragReject:t.isDragReject});case"setFiles":return fs(fs({},e),{},{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections,isDragReject:t.isDragReject});case"reset":return fs({},C5);default:return e}}function oF(){}function Zl({value:e,onChange:t,label:n="Imagen destacada",className:r="",infoTextClassName:l="text-xs text-gray-200"}){const d=V.useCallback(T=>{if(Array.isArray(T)&&T.length>0){const E=T[0];E instanceof File&&t(E)}},[t]),{getRootProps:p,getInputProps:a,isDragActive:b}=dD({onDrop:d,accept:{"image/*":[]},multiple:!1});return f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"block  text-xs font-medium text-gray-100",children:n}),f.jsxs("div",{...p(),className:`relative border-2 border-dashed rounded-xl px-4 py-8 flex flex-col items-center justify-center text-center transition cursor-pointer
          ${b?"bg-blue-50 border-blue-400 text-blue-600":"border-gray-300 text-gray-200 hover:border-blue-400 hover:bg-blue-50"}
          ${r}`,children:[f.jsx("input",{...a()}),f.jsx(wce,{className:"w-8 h-8 mb-2 opacity-70"}),f.jsx("p",{className:"  text-xs font-medium text-xs text-gray-200",children:b?"Suelta la imagen aquí...":"Toca o arrastra una imagen desde tu galería"}),f.jsx("p",{className:l,children:"Formatos: JPG, PNG, WEBP"})]}),e&&f.jsx("div",{className:"mt-2",children:f.jsx("img",{src:typeof e=="string"?e:URL.createObjectURL(e),alt:"Vista previa",className:"rounded-lg border  w-full max-w-[160px]  shadow-lg"})})]})}function dSe(){const{values:e,setFieldValue:t}=mo();return f.jsxs("div",{className:"space-y-6",children:[f.jsx("h3",{className:"text-white text-lg font-semibold",children:"Imagen y ubicación"}),f.jsxs("div",{children:[f.jsx(Zl,{value:e.profileImage,onChange:n=>t("profileImage",n),label:"Imagen de perfil"}),f.jsx(wn,{name:"profileImage",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Ubicación"}),f.jsx(jn,{name:"location",placeholder:"Dallas, TX",className:"w-full px-4 py-3 border border-white/30 bg-white/10 rounded-lg placeholder:text-gray-300 text-white focus:outline-none focus:ring-2 focus:ring-orange-500"}),f.jsx(wn,{name:"location",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"País"}),f.jsx(jn,{name:"country",placeholder:"Estados Unidos",className:"w-full px-4 py-3 border border-white/30 bg-white/10 rounded-lg placeholder:text-gray-300 text-white focus:outline-none focus:ring-2 focus:ring-orange-500"}),f.jsx(wn,{name:"country",component:"div",className:"text-red-400  text-xs mt-1"})]})]})}const sb=[p2e,m2e,dSe],A4=["Datos Básicos","Descripción","Ubicación"],hSe=[li({name:On().min(2,"Muy corto").required("Nombre requerido"),lastName:On().min(2,"Muy corto").required("Apellido requerido"),title:On().required("Título requerido")}),li({description:On().min(10,"Muy corta").required("Requerida")}),li({profileImage:ps().test("is-valid-profile-image","Debe ser una URL válida o un archivo de imagen",e=>e?typeof e=="string"?/^https?:\/\/.+/.test(e):e instanceof File:!1).required("Imagen requerida"),location:On().required("Requerida"),country:On().required("Selecciona un país")})];function fSe({initialValues:e,onSubmit:t}){const[n,r]=V.useState(0),l=sb[n],d=br(),p=ln(E=>E.comunidades.list),a=ln(E=>E.comunidades.loaded),{coords:b}=ln(E=>E.ubicacion);V.useEffect(()=>{b&&a&&d(zd(b))},[a,d]);const T={name:(e==null?void 0:e.name)||"",lastName:(e==null?void 0:e.lastName)||"",title:(e==null?void 0:e.title)||"",description:(e==null?void 0:e.description)||"",profileImage:(e==null?void 0:e.profileImage)||"",location:(e==null?void 0:e.location)||"",country:(e==null?void 0:e.country)||""};return f.jsx(ef,{initialValues:T,validationSchema:hSe[n],onSubmit:async(E,P)=>{if(n===sb.length-1){try{await t(E),d(Jt({message:"Perfil actualizado exitosamente",type:"success"}))}catch{d(Jt({message:"Error al actualizar el perfil",type:"error"}))}P.setSubmitting(!1)}else r(I=>I+1),P.setTouched({}),P.setSubmitting(!1)},validateOnBlur:!1,validateOnChange:!1,children:()=>f.jsxs(Ud,{className:"flex flex-col md:flex-row gap-8 w-full max-w-5xl mx-auto p-4 md:p-8 bg-black/40 backdrop-blur-lg md:rounded-2xl shadow-2xl text-white",children:[f.jsx("div",{className:"flex flex-row md:flex-col w-full md:w-20 lg:w-36 space-x-4 md:space-x-0 md:space-y-8",children:A4.map((E,P)=>f.jsxs("div",{className:"relative flex flex-row items-center md:items-start",children:[P!==A4.length-1&&f.jsx("span",{className:"absolute hidden md:block left-3 top-6 h-[2rem] w-px bg-white/20"}),f.jsx("div",{className:`w-6 h-6 flex items-center justify-center rounded-full border-2 shrink-0
                    ${n===P?"border-orange-500 bg-orange-500 text-black":n>P?"border-green-500 bg-green-500 text-black":"border-white/30 text-white"}`,children:n>P?"✓":P+1}),f.jsx("div",{className:"ml-2 text-xs lg:  text-xs hidden md:block",children:E})]},P))}),f.jsxs("div",{className:"flex-1 space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsxs("div",{className:"  text-xs font-medium",children:["Paso ",n+1," de ",sb.length,":"," ",f.jsx("span",{className:"text-orange-400",children:A4[n]})]}),f.jsx("div",{className:"w-1/3 h-2 bg-white/10 rounded-full overflow-hidden",children:f.jsx("div",{className:"h-full bg-orange-500 transition-all",style:{width:`${(n+1)/sb.length*100}%`}})})]}),f.jsx(ax,{mode:"wait",children:f.jsx(Ko.div,{initial:{opacity:0,x:40},animate:{opacity:1,x:0},exit:{opacity:0,x:-40},transition:{duration:.3,ease:"easeOut"},children:f.jsx(l,{comunidades:p})},n)}),f.jsxs("div",{className:"flex justify-between gap-2 mt-6",children:[n>0&&f.jsx("button",{type:"button",onClick:()=>r(E=>E-1),className:"w-full bg-white/10 border border-white/20 text-white py-3 rounded-lg font-semibold hover:bg-white/20 transition",children:"Atrás"}),f.jsx("button",{type:"submit",className:"w-full bg-orange-600 hover:bg-orange-700 text-white py-3 rounded-lg font-semibold transition",children:n===sb.length-1?"Guardar Cambios":"Siguiente"})]})]})]})})}const up="/assets/authbg-CnwcA7Ey.png";function pSe(){const e=aa(),t=br(),{usuario:n,loading:r}=ln(d=>d.auth),l=async d=>{try{const p=new FormData;Object.entries({name:d.name,lastName:d.lastName,title:d.title,description:d.description,location:d.location,country:d.country}).forEach(([a,b])=>p.append(a,b)),d.profileImage&&typeof d.profileImage!="string"&&p.append("profileImage",d.profileImage),await t(YS({userId:n.id,userData:p})).unwrap(),t(Jt({message:"✅ Perfil actualizado exitosamente",type:"success"})),e("/dashboard/perfil")}catch(p){t(Jt({message:(p==null?void 0:p.message)||"❌ Error al actualizar el perfil",type:"error"}))}};return f.jsxs(f.Fragment,{children:[f.jsx(Oa,{children:f.jsx("title",{children:"Editar Perfil | Communidades"})}),f.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen px-2 gap-8 lg:mt-16",children:[f.jsxs("section",{className:"relative w-full max-w-5xl shadow-xl rounded-2xl sm:p-16 space-y-6 overflow-hidden",style:{backgroundImage:`url(${up})`,backgroundSize:"cover",backgroundPosition:"center"},children:[f.jsx("div",{className:"absolute inset-0 bg-white/50 backdrop-blur-sm rounded-xl h-full z-0"}),f.jsxs("div",{className:"relative z-10 space-y-6 grid gap-8",children:[f.jsxs("div",{className:"flex items-center justify-between p-4 gap-2",children:[f.jsxs("div",{className:"grid gap-8",children:[f.jsx("h1",{className:"text-2xl font-bold text-black flex items-center gap-2",children:"Actualiza tu perfil"}),f.jsx("p",{className:"text-gray-700  text-xs sm:text-base",children:"Mantén tu información al día para conectar mejor con otras personas y negocios dentro de la comunidad."})]}),f.jsx("img",{src:Kc,alt:"Ilustración",className:"w-40 xl:w-60 opacity-90"})]}),f.jsx(fSe,{onSubmit:l,initialValues:n})]})]}),f.jsxs("div",{className:"pt-6 text-center space-y-2",children:[f.jsxs("p",{className:"text-[#141C24] text-base font-medium flex justify-center items-center gap-2",children:[f.jsx("img",{src:Rm,alt:"Icono",className:"h-8 md:h-12"}),"Tu historia merece ser contada."]}),f.jsx("p",{className:"  text-xs text-gray-600",children:"Comparte quién eres y fortalece los lazos con tu comunidad."})]})]})]})}function mSe(){const e=br(),{items:t,loaded:n,loading:r}=ln(I=>I.notificaciones),[l,d]=V.useState(5);V.useEffect(()=>{n||e(Pb())},[e,n]);const p=I=>{e(CU(I))},a=t.slice(0,l),b=t.length>l,T=l>5,E=()=>d(I=>I+5),P=()=>d(5);return f.jsxs("div",{className:"p-4 space-y-4 bg-gray-50 rounded-xl w-fit shadow-lg max-w-xl",children:[t.length===0&&!r&&f.jsx("p",{className:"text-gray-500",children:"No tienes notificaciones."}),a.map(I=>f.jsxs("div",{className:`border shadow  text-xs border-gray-200 rounded-xl p-4 flex flex-col md:flex-row md:items-center md:justify-between gap-3 transition hover:border-gray-300 ${I.read?"bg-white":"bg-blue-50"}`,children:[f.jsx("p",{className:`${I.read?"text-gray-600 font-extralight":"text-gray-800 font-light"}`,children:I.message}),f.jsxs("div",{className:"flex flex-col items-end text-right shrink-0",children:[f.jsxs("div",{className:"flex gap-4",children:[f.jsx(Wn,{to:I.link,className:"text-orange-500  text-xs font-medium hover:text-orange-700",onClick:()=>p(I._id),children:"Ver detalle"}),!I.read&&f.jsx("button",{onClick:()=>p(I._id),className:"text-gray-400 hover:text-green-500 transition","aria-label":"Marcar como leída",children:f.jsx(ole,{className:"w-5 h-5"})})]}),f.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(I.createdAt).toLocaleString("es-ES",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]},I._id)),(b||T)&&f.jsxs("div",{className:"text-center flex justify-center gap-4",children:[b&&f.jsx("button",{onClick:E,className:"  text-xs text-orange-600 hover:text-orange-800 font-medium transition",children:"Ver más"}),T&&f.jsx("button",{onClick:P,className:"  text-xs text-gray-500 hover:text-gray-700 font-medium transition",children:"Ver menos"})]})]})}function gSe(){return f.jsxs("div",{className:"max-w-[1200px] w-full flex flex-col gap-6 md:gap-12 xl:gap-16 px-2 md:px-4 md:px-6",children:[f.jsxs("div",{className:"flex flex-col gap-4",children:[f.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Tus notificaciones"}),f.jsx("h2",{className:"text-base text-gray-600 font-normal",children:"Mantente al día con lo que ocurre en tu comunidad"}),f.jsx("p",{className:"  text-xs text-gray-500 max-w-2xl",children:"Aquí encontrarás recordatorios, novedades y mensajes importantes que te ayudarán a estar siempre conectado con los negocios, eventos y servicios que reflejan tu cultura y te acompañan en tu camino."})]}),f.jsx(mSe,{})]})}function xSe({negocio:e,onSelect:t}){const n=e.featuredImage||`https://cdn.usegalileo.ai/sdxl10/${e._id||"default"}.png`;return f.jsxs("div",{onClick:()=>t(e),className:"group relative bg-white rounded-lg shadow hover:shadow-lg transition overflow-hidden border border-gray-200 flex flex-col cursor-pointer h-40",children:[f.jsx("div",{className:"w-full h-28 overflow-hidden bg-gray-50",children:f.jsx("img",{src:n,alt:e.name,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"})}),f.jsxs("div",{className:"flex flex-col justify-between h-[5rem]  p-2 xl:p-3 flex-grow",children:[f.jsx("h3",{className:`\r
     text-xs font-semibold text-gray-700\r
    line-clamp-2 leading-snug  overflow-hidden\r
  `,children:e.name}),Array.isArray(e.categories)&&e.categories.length>0?e.categories.map(r=>f.jsx("span",{className:"text-[0.65rem] font-medium rounded bg-white text-gray-500 w-fit mr-1 px-2 py-0.5",children:r.name},r._id)):f.jsx("span",{className:"text-[0.65rem] font-medium rounded bg-white text-gray-400 w-fit px-2 py-0.5",children:"Sin categoría"})]})]})}function px({icon:e="🌟",title:t="Título de la sección",badge:n="Sección",description:r="",illustration:l}){return f.jsxs("div",{className:"flex lg:flex-col justify-center h-full w-full p-6 lg:gap-6 bg-gradient-to-br from-yellow-50 via-pink-50 to-purple-50 rounded-2xl shadow-lg",children:[f.jsxs("div",{className:"flex flex-col gap-3 text-center md:text-left",children:[f.jsx("div",{className:"inline-block bg-orange-100 text-orange-700 text-xs font-semibold px-3 py-1 rounded-full self-center md:self-start",children:n}),f.jsxs("h1",{className:" text-lg xl:text-2xl font-extrabold text-[#141C24] tracking-tight leading-snug flex items-center gap-2 justify-center md:justify-start",children:[f.jsx("span",{children:e}),t]}),r&&f.jsx("p",{className:"  text-xs lg:text-base text-gray-700 leading-relaxed",children:r})]}),l&&f.jsx("div",{className:"flex justify-center md:justify-start",children:f.jsx("div",{className:"relative flex items-center justify-center",children:f.jsx("img",{src:l,alt:"Ilustración sección",className:"w-94 lg:w-64"})})})]})}function ySe(e){return sn({attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"},child:[]}]})(e)}function lF(e){return sn({attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"},child:[]}]})(e)}function vSe(e){return sn({attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"},child:[]},{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"},child:[]}]})(e)}function Hw(e){return sn({attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"},child:[]}]})(e)}function cF({negocio:e,onClose:t,onAskDelete:n}){var r,l;return e?f.jsxs("div",{className:`\r
        relative\r
        w-full\r
        bg-gradient-to-br from-gray-50 via-white to-gray-100\r
        rounded-2xl shadow-lg\r
        p-4 lg:p-8 xl:p-10\r
        border border-gray-200\r
        min-h-[260px]\r
        max-h-[80vh]\r
        overflow-y-auto\r
      `,children:[t&&f.jsx("button",{onClick:t,className:"md:hidden absolute -top-0.5 right-4 text-gray-900 hover:text-black  text-xs",children:"cerrar"}),f.jsxs("div",{className:`\r
        relative\r
        w-full\r
        flex flex-col xl:flex-row\r
        gap-6\r
      `,children:[f.jsx("div",{className:"w-full xl:w-60 flex-shrink-0",children:f.jsx("img",{src:e.featuredImage,alt:e.name,className:"w-full h-20 md:h-60 object-cover rounded-xl"})}),f.jsxs("div",{className:"flex-1 flex flex-col gap-4 justify-between",children:[f.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3 flex-wrap",children:[f.jsx("h2",{className:"text-2xl font-extrabold text-[#141C24] tracking-tight leading-snug",children:e.name}),e.profileImage&&f.jsx("img",{src:e.profileImage,alt:"Avatar negocio",className:"w-7 md:w-10 md:h-10 rounded-full object-cover"}),e.isVerified&&f.jsx("span",{className:"inline-flex items-center gap-1 bg-green-100 text-green-700 text-xs font-semibold px-2 py-1 rounded-full",children:"✓ Verificado"})]}),f.jsx("p",{className:"text-gray-700 text-xs md:text-md leading-relaxed whitespace-pre-line",children:e.description}),f.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[(r=e.tags)==null?void 0:r.map(d=>f.jsxs("span",{className:"inline-block bg-blue-100 text-blue-700 text-xs font-medium px-2 py-1 rounded-full",children:["#",d]},d)),((l=e==null?void 0:e.categories)==null?void 0:l.length)>0&&e.categories.map(d=>f.jsx("span",{className:"inline-block bg-black text-white text-xs font-medium px-2 py-1 rounded-full",children:d.name},d._id))]}),f.jsx("div",{className:"flex flex-wrap gap-1 md:gap-4 text-xs  text-gray-500 mt-2",children:f.jsxs("span",{children:["Actualizado: ",new Date(e.updatedAt).toLocaleDateString()]})})]})]}),f.jsxs("div",{className:"flex flex-row flex-wrap gap-2 mt-4",children:[f.jsxs(Wn,{to:`/dashboard/mis-negocios/${e._id}/promos/nueva`,className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium no-underline",children:[f.jsx(W0e,{className:"text-lg"}),"Crear promoción"]}),f.jsxs(Wn,{to:`/dashboard/mis-negocios/${e._id}/editar`,className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium no-underline",children:[f.jsx(Hw,{className:"text-lg"}),"Editar negocio"]}),f.jsxs(Wn,{to:`/dashboard/mis-negocios/${e._id}`,className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium no-underline",children:[f.jsx($N,{className:"text-lg"}),"Ver detalle privado"]}),f.jsxs(Wn,{to:`/negocios/${e._id}`,className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium no-underline",children:[f.jsx(vG,{className:"text-lg"}),"Ver perfil público"]}),f.jsxs("button",{onClick:()=>{t&&t(),n&&n(e)},className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-white items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-red-500 hover:bg-red-700 transition text-xs font-medium",children:[f.jsx(Bw,{className:"text-lg"}),"Eliminar negocio"]})]})]}):null}function My(){return f.jsxs("div",{className:"flex flex-col gap-8 w-full",children:[f.jsx("div",{className:"w-full h-28 sm:h-32 md:h-40 bg-gray-100 rounded-md animate-pulse"}),Array.from({length:2}).map((e,t)=>f.jsx("div",{className:`\r
            grid\r
            grid-cols-2\r
            md:grid-cols-2\r
            lg:grid-cols-4\r
            gap-y-5\r
            gap-x-3\r
            md:gap-6\r
            xl:gap-8\r
            w-full\r
          `,children:Array.from({length:4}).map((n,r)=>f.jsxs("div",{className:"flex flex-col gap-2 bg-gray-50 border border-gray-200 rounded-xl p-4 animate-pulse min-h-[10rem]",children:[f.jsx("div",{className:"w-full h-28 sm:h-32 bg-gray-200 rounded-md"}),f.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"}),f.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]},r))},t))]})}function _Se(){const e=br(),t=V.useRef(null),{misNegocios:n,misLoading:r,error:l,misLoaded:d}=ln(R=>R.negocios),[p,a]=V.useState(null),[b,T]=V.useState(!1),[E,P]=V.useState(!1);V.useEffect(()=>{!d&&n.length===0?e(Eb()).unwrap().then(R=>{(R==null?void 0:R.length)>0&&a((R==null?void 0:R[0])??null)}).catch(R=>{console.error("Error al cargar negocios:",R)}):!p&&n.length>0&&a((n==null?void 0:n[0])??null)},[e,n,p,d]);const I=async R=>{try{await e(CP(R)).unwrap();const F=n.filter(W=>W._id!==R);a(F[0]||null),P(!1)}catch{e(Jt({message:"Error al eliminar negocio",type:"error"}))}};return r?f.jsx(My,{}):l?f.jsx("div",{className:"p-4 text-red-600",children:l}):f.jsxs("div",{className:"max-w-[1200px] w-full mx-auto flex flex-col gap-8 md:gap-12 xl:gap-16 px-2",children:[f.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 md:gap-8 xl:gap-10 lg:mt-16",children:[f.jsx("div",{className:"flex-1",children:f.jsx(px,{icon:"🏪",title:"Tus negocios",badge:"Tu espacio de gestión",description:"Administra tus negocios, comparte novedades y conecta con tu comunidad.",illustration:Yh})}),p&&f.jsx("div",{ref:t,className:"hidden md:flex flex-3 flex-col justify-center",children:f.jsx(cF,{negocio:p,onAskDelete:R=>{a(R),P(!0)}})})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("hr",{className:"flex-grow border-gray-200"}),f.jsx("span",{className:"text-gray-400 text-xs uppercase tracking-wider",children:"Tus negocios"}),f.jsx("hr",{className:"flex-grow border-gray-200"})]}),f.jsxs("div",{className:"flex justify-between items-center mb-4 md:mb-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-[#141C24]",children:"Lista de negocios"}),f.jsxs(Wn,{to:"crear",className:"flex items-center gap-2 bg-black text-white px-3 py-2 rounded hover:bg-[#f4c753] hover:text-black transition  text-xs font-semibold",children:[f.jsx(Cle,{className:"text-lg"}),f.jsx("p",{className:"hidden md:block",children:"Crear negocio"})]})]}),n.length===0?f.jsxs("div",{className:"flex flex-col items-center text-center gap-5 py-16",children:[f.jsx("img",{src:Kc,alt:"Sin negocios",className:"w-40 opacity-90"}),f.jsxs("p",{className:"text-gray-600  text-xs md:text-base max-w-xs",children:["Aún no tienes ningún negocio creado.",f.jsx("br",{}),"Comparte tu proyecto con tu comunidad y haz que te encuentren fácilmente."]}),f.jsx(Wn,{to:"/dashboard/mis-negocios/crear",className:"inline-block bg-orange-500 hover:bg-orange-600 text-white  text-xs font-medium px-4 py-2 rounded transition",children:"Crear mi primer negocio"})]}):f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-y-5 gap-x-3 md:gap-6 xl:gap-8",children:n.map(R=>f.jsx("div",{onClick:()=>{a(R),window.innerWidth<768?T(!0):t.current&&t.current.scrollIntoView({behavior:"smooth",block:"start"})},className:`transition rounded-lg cursor-pointer ${(p==null?void 0:p._id)===R._id?"border-blue-400 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-400"}`,children:f.jsx(xSe,{negocio:R})},R._id))}),b&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4",onClick:()=>T(!1),children:f.jsx("div",{className:"relative w-full max-w-md",onClick:R=>R.stopPropagation(),children:f.jsx(cF,{negocio:p,onClose:()=>T(!1),onAskDelete:R=>{T(!1),a(R),P(!0)}})})}),E&&f.jsx(cp,{open:E,onClose:()=>P(!1),onConfirm:()=>I(p._id),entityName:p.name,title:"Eliminar negocio",description:"Para confirmar, escribe el nombre exacto del negocio:"})]})}function bSe({categorias:e=[],comunidades:t=[]}){const{values:n,setFieldValue:r}=mo(),l=Array.isArray(n==null?void 0:n.categories)?n.categories.length:0,d=2;return f.jsxs("div",{className:"space-y-5",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-white mb-1",children:"Nombre"}),f.jsx(jn,{name:"name",placeholder:"Estudio de Yoga Tierra y Alma",className:"form-input w-full bg-white/10 border border-white/30 rounded-lg h-12 px-4 placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"name",component:"div",className:"text-red-500 text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-white mb-1",children:"Descripción"}),f.jsx(jn,{as:"textarea",name:"description",placeholder:"Describe tu negocio",className:"form-textarea cursor-default w-full h-42 xl:h-82 bg-white/10 border border-white/30 rounded-lg px-4 py-3 placeholder:text-gray-300 focus:outline-none resize-none overflow-y-auto custom-scroll"}),f.jsx(wn,{name:"description",component:"div",className:"text-red-500 text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-white mb-1",children:"Categorías"}),f.jsx(gs,{isMulti:!0,menuPlacement:"top",options:e.map(p=>({value:p._id,label:p.name})),placeholder:"Selecciona una o más categorías...",styles:xs,value:e.filter(p=>{var a;return(a=n.categories)==null?void 0:a.includes(p._id)}).map(p=>({value:p._id,label:p.name})),onChange:p=>r("categories",p?p.map(a=>a.value):[])}),f.jsx("div",{className:`mt-1 text-xs ${l<d?"text-yellow-300":"text-green-400"}`,"aria-live":"polite",children:l<d?`Selecciona al menos ${d} categorías (te faltan ${d-l}).`:`Perfecto: ${l} categoría${l>1?"s":""} seleccionada${l>1?"s":""}.`}),f.jsx(wn,{name:"categories",component:"div",className:"text-red-500 text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-white mb-1",children:"Comunidad"}),f.jsx(gs,{menuPlacement:"top",options:t.map(p=>({value:p._id,label:p.name})),placeholder:"Selecciona una comunidad...",styles:xs,value:Array.isArray(t)&&t.filter(p=>(p==null?void 0:p._id)===(n==null?void 0:n.community)).map(p=>({value:p._id,label:p.name}))[0]||null,onChange:p=>r("community",p==null?void 0:p.value)}),f.jsx(wn,{name:"community",component:"div",className:"text-red-500 text-xs mt-1"})]})]})}function wSe(){return f.jsxs("div",{className:"space-y-5",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Teléfono"}),f.jsx(jn,{name:"contact.phone",placeholder:"555-1040",className:"form-input w-full bg-white/10 border border-white/30 rounded-lg h-12 px-4 placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"contact.phone",component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Email"}),f.jsx(jn,{required:!0,name:"contact.email",type:"email",placeholder:"example@email.com",className:"form-input w-full bg-white/10 border border-white/30 rounded-lg h-12 px-4 placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"contact.email",component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Sitio Web"}),f.jsx(jn,{name:"contact.website",placeholder:"https://your-business.com",className:"form-input w-full bg-white/10 border border-white/30 rounded-lg h-12 px-4 placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"contact.website",component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsx("h3",{className:"text-white text-lg font-semibold",children:"Redes Sociales"}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Facebook"}),f.jsx(jn,{name:"contact.socialMedia.facebook",placeholder:"https://...",className:"form-input w-full bg-white/10 border border-white/30 rounded-lg h-12 px-4 placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"contact.socialMedia.facebook",component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Instagram"}),f.jsx(jn,{name:"contact.socialMedia.instagram",placeholder:"https://...",className:"form-input w-full bg-white/10 border border-white/30 rounded-lg h-12 px-4 placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"contact.socialMedia.instagram",component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"WhatsApp"}),f.jsx(jn,{name:"contact.socialMedia.whatsapp",placeholder:"1234567890",className:"form-input w-full bg-white/10 border border-white/30 rounded-lg h-12 px-4 placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"contact.socialMedia.whatsapp",component:"div",className:"text-red-500  text-xs mt-1"})]})]})}function SSe(){var l;const{values:e,setFieldValue:t}=mo(),n=!!(e!=null&&e.isDeliveryOnly);V.useEffect(()=>{var d;n&&(!e.primaryZip&&((d=e==null?void 0:e.location)!=null&&d.zipCode)&&t("primaryZip",String(e.location.zipCode).slice(0,5)),t("location.address",""),t("location.city",""),t("location.state",""))},[n,t,(l=e==null?void 0:e.location)==null?void 0:l.zipCode,e==null?void 0:e.primaryZip]);const r=d=>{var a;const p=d.target.checked;t("isDeliveryOnly",p),p||!((a=e.location)!=null&&a.zipCode)&&e.primaryZip&&t("location.zipCode",e.primaryZip)};return f.jsxs("div",{className:"space-y-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-white",children:"Dirección del Evento"}),f.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg bg-white/5 border border-white/10",children:[f.jsx(jn,{type:"checkbox",name:"isDeliveryOnly",checked:n,onChange:r}),f.jsx("span",{className:"  text-xs text-white",children:"Solo delivery (sin ubicación física). Usaremos el centro del ZIP para ubicar el pin en el mapa."})]}),n?f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"ZIP principal (5 dígitos)"}),f.jsx(jn,{name:"primaryZip",children:({field:d})=>f.jsx("input",{...d,inputMode:"numeric",pattern:"\\d{5}",maxLength:5,placeholder:"75067",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none",onChange:p=>{const a=p.target.value.replace(/\D/g,"").slice(0,5);t("primaryZip",a)}})}),f.jsx(wn,{name:"primaryZip",component:"div",className:"text-red-400  text-xs mt-1"}),f.jsx("p",{className:"text-xs text-white/70 mt-2",children:"El mapa mostrará la ubicación aproximada en el centro de este ZIP."})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:n?"opacity-60 pointer-events-none":"",children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Dirección"}),f.jsx(jn,{name:"location.address",placeholder:" 345 Colorado Peace St",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none",disabled:n}),f.jsx(wn,{name:"location.address",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{className:n?"opacity-60 pointer-events-none":"",children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Ciudad"}),f.jsx(jn,{name:"location.city",placeholder:"Dallas",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none",disabled:n}),f.jsx(wn,{name:"location.city",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{className:n?"opacity-60 pointer-events-none":"",children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Estado"}),f.jsx(jn,{name:"location.state",placeholder:"TX",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none",disabled:n}),f.jsx(wn,{name:"location.state",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{className:n?"opacity-60 pointer-events-none":"",children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Código Postal"}),f.jsx(jn,{name:"location.zipCode",placeholder:"75081",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none",disabled:n}),f.jsx(wn,{name:"location.zipCode",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{className:n?"opacity-60 pointer-events-none":"",children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"País"}),f.jsx(jn,{name:"location.country",placeholder:"USA",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none",disabled:n}),f.jsx(wn,{name:"location.country",component:"div",className:"text-red-400  text-xs mt-1"})]})]})]})}const TSe=["Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Domingo"];function ESe(){const{values:e,setFieldValue:t}=mo();return f.jsxs("div",{className:"space-y-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-[#141C24]",children:"Horarios de atención"}),f.jsx(mw,{name:"openingHours",render:()=>f.jsx("div",{className:"space-y-4",children:TSe.map((n,r)=>f.jsxs("div",{className:"flex flex-col gap-2 border-b pb-4",children:[f.jsx("label",{className:"font-medium",children:n}),f.jsxs("label",{className:"flex items-center gap-2  text-xs",children:[f.jsx(jn,{type:"checkbox",name:`openingHours[${r}].closed`,onChange:l=>{const d=l.target.checked;t(`openingHours[${r}].closed`,d),d&&(t(`openingHours[${r}].open`,""),t(`openingHours[${r}].close`,""))}}),"Cerrado"]}),!e.openingHours[r].closed&&f.jsxs("div",{className:"flex gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs",children:"Abre"}),f.jsx(jn,{type:"time",name:`openingHours[${r}].open`,className:"form-input"}),f.jsx(wn,{name:`openingHours[${r}].open`,component:"div",className:"text-red-500 text-xs"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs",children:"Cierra"}),f.jsx(jn,{type:"time",name:`openingHours[${r}].close`,className:"form-input"}),f.jsx(wn,{name:`openingHours[${r}].close`,component:"div",className:"text-red-500 text-xs"})]})]})]},r))})})]})}function ASe(){var I;const{setFieldValue:e,values:t}=mo(),[n,r]=V.useState(""),[l,d]=V.useState([]),[p,a]=V.useState(!1),b=ln(R=>R.auth.usuario),T=(b==null?void 0:b.role)==="admin";b==null||b.role,V.useEffect(()=>{!T&&(b!=null&&b._id)&&(e("ownerId",b._id),e("ownerDisplay",{name:b.name,image:b.profileImage||""}))},[b,T,e]);const E=async()=>{if(n.trim()){a(!0);try{const R=await Ore(n);d(R||[])}catch(R){console.error("Error al buscar usuarios:",R)}finally{a(!1)}}},P=R=>{e("ownerId",R._id),e("ownerDisplay",{name:R.name,image:R.profileImage||""}),d([]),r("")};return f.jsxs("div",{className:"space-y-6",children:[f.jsx("h3",{className:"text-white text-lg font-semibold",children:"Propietario del negocio"}),!T&&f.jsxs("div",{className:"p-3 bg-black/30 border border-white/20 rounded-lg text-sm text-white",children:["Este negocio estará relacionado a tu cuenta en Communidades",f.jsx("br",{}),f.jsx("span",{className:"font-semibold",children:b==null?void 0:b.name})]}),T&&f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-white mb-1",children:"Buscar usuario por nombre"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",placeholder:"Ej: María López",value:n,onChange:R=>r(R.target.value),className:"flex-1 bg-white/10 border border-white/30 rounded-lg h-12 px-4 placeholder:text-gray-300 text-white focus:outline-none"}),f.jsx("button",{type:"button",onClick:E,className:"px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-semibold transition",children:p?"Buscando...":"Buscar"})]})]}),l.length>0&&f.jsx("ul",{className:"border border-white/20 rounded-lg p-2 space-y-2 bg-black/40 backdrop-blur max-h-60 overflow-auto",children:l.map(R=>f.jsxs("li",{className:"p-2 hover:bg-white/10 cursor-pointer rounded text-white",onClick:()=>P(R),children:[f.jsx("div",{className:"font-medium",children:R.name}),f.jsx("div",{className:"text-xs text-gray-300",children:R.email})]},R._id))})]}),((I=t.ownerDisplay)==null?void 0:I.name)&&f.jsxs("div",{children:[f.jsxs("p",{className:"text-xs text-white",children:[f.jsx("strong",{children:"Seleccionado:"})," ",t.ownerDisplay.name]}),t.ownerDisplay.image&&f.jsx("img",{src:t.ownerDisplay.image,alt:"Foto del propietario",className:"mt-2 w-20 h-20 object-cover rounded-full border border-white/30"})]})]})}function NW({values:e=[],onChange:t,label:n="Galería de imágenes",maxImages:r=5,className:l="",infoTextClassName:d="text-xs text-gray-200"}){const p=br(),a=V.useCallback(I=>{if(!I.length)return;if(e.length>=r){p(Jt({message:`Máximo ${r} imágenes`,type:"error"}));return}const R=I.slice(0,r-e.length);t([...e,...R])},[e,t,r,p]),{getRootProps:b,getInputProps:T,isDragActive:E}=dD({onDrop:a,accept:{"image/*":[]},multiple:!0}),P=I=>{const R=e.filter((F,W)=>W!==I);t(R)};return f.jsxs("div",{className:"space-y-3",children:[f.jsx("label",{className:"block  text-xs font-medium text-gray-100",children:n}),f.jsxs("div",{...b(),className:`border-2 border-dashed rounded-xl px-4 py-6 text-center transition cursor-pointer
          ${E?"bg-blue-50 border-blue-400 text-blue-600":"border-gray-300 text-gray-500 hover:border-blue-400 hover:bg-blue-50"}
          ${l}`,children:[f.jsx("input",{...T()}),f.jsx(Nce,{className:"w-8 h-8 mx-auto mb-2 opacity-70"}),f.jsx("p",{className:"  text-xs font-medium",children:E?"Suelta las imágenes aquí...":"Arrastra o toca para subir múltiples imágenes"}),f.jsx("p",{className:d,children:`Máximo ${r} imágenes. Formatos: JPG, PNG, WEBP`})]}),e.length>0&&f.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:e.map((I,R)=>f.jsxs("div",{className:"relative group",children:[f.jsx("img",{src:typeof I=="string"?I:URL.createObjectURL(I),alt:`Imagen ${R+1}`,className:"rounded-md border w-full aspect-square object-cover"}),f.jsx("button",{type:"button",onClick:()=>P(R),className:"absolute top-1 right-1 bg-white/80 hover:bg-white text-red-600 rounded-full p-1 shadow",title:"Eliminar",children:f.jsx(Uce,{className:"w-4 h-4"})})]},R))})]})}function CSe(){const{setFieldValue:e,values:t}=mo(),[n,r]=V.useState(Array.isArray(t.tags)?t.tags.join(", "):""),l=T=>(T||"").split(",").map(E=>E.trim()).filter(Boolean),p=V.useMemo(()=>l(n),[n]).length,{colorClass:a,msg:b}=V.useMemo(()=>p<5?{colorClass:"text-red-400",msg:"Está bien, pero entre más pongas más fácil te encuentran los usuarios (apunta a 5–15)."}:p<=15?{colorClass:"text-yellow-300",msg:"Buen rango. Suma variaciones y sinónimos relevantes para mejorar el alcance."}:{colorClass:"text-green-400",msg:"Excelente cobertura de búsqueda. Mantén tags relevantes y evita duplicados."},[p]);return f.jsxs("div",{className:"space-y-6",children:[f.jsx("h3",{className:"text-white text-lg font-semibold",children:"Extras"}),f.jsx(Zl,{value:t.featuredImage,onChange:T=>e("featuredImage",T),label:"Imagen destacada del negocio",className:"text-white"}),f.jsx(wn,{name:"featuredImage",component:"div",className:"text-red-500 text-xs"}),f.jsx(Zl,{value:t.profileImage,onChange:T=>e("profileImage",T),label:"Logo o imagen de perfil",className:"text-white"}),f.jsx(wn,{name:"profileImage",component:"div",className:"text-red-500 text-xs"}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-white mb-1",children:"Etiquetas (separadas por coma)"}),f.jsx("input",{type:"text",placeholder:"Café, Latino, Artesanal",className:"w-full bg-white/10 border border-white/30 rounded-lg h-12 px-4 placeholder:text-gray-300 text-white focus:outline-none",value:n,onChange:T=>{const E=T.target.value;r(E),e("tags",l(E))},onBlur:()=>{e("tags",l(n))}}),f.jsxs("div",{className:"mt-1 flex items-center gap-2","aria-live":"polite",children:[f.jsxs("span",{className:`text-xs font-semibold px-2 py-0.5 rounded-full border border-white/20 bg-white/10 ${a}`,children:[p," tag",p!==1?"s":""]}),f.jsx("span",{className:`text-xs ${a}`,children:b})]}),f.jsx(wn,{name:"tags",component:"div",className:"text-red-500 text-xs mt-1"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(jn,{type:"checkbox",name:"isVerified",id:"isVerified",className:"form-checkbox h-5 w-5 text-orange-500 focus:ring-0 border-white/30"}),f.jsx("label",{htmlFor:"isVerified",className:"text-xs text-white",children:"Marcar como verificado"})]}),f.jsx(NW,{values:t.images||[],onChange:T=>e("images",T),label:"Galería de imágenes del negocio",maxImages:5,className:"text-white"}),f.jsx(wn,{name:"images",component:"div",className:"text-red-500 text-xs"})]})}const T3=()=>f.jsxs("div",{className:"w-full max-w-5xl mx-auto p-8 bg-black/40 backdrop-blur-lg rounded-2xl shadow-2xl text-white space-y-6 animate-pulse",children:[f.jsx("div",{className:"h-6 w-1/3 bg-white/20 rounded"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsx("div",{className:"h-12 bg-white/10 rounded"}),f.jsx("div",{className:"h-12 bg-white/10 rounded"}),f.jsx("div",{className:"h-32 md:h-72 bg-white/10 rounded col-span-1 md:col-span-2"}),f.jsx("div",{className:"h-12 bg-white/10 rounded"}),f.jsx("div",{className:"h-12 bg-white/10 rounded"})]}),f.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[f.jsx("div",{className:"h-10 w-32 bg-white/20 rounded"}),f.jsx("div",{className:"h-10 w-32 bg-orange-500 rounded"})]})]}),Vv=[bSe,wSe,SSe,ESe,ASe,CSe],C4=["General","Contacto","Ubicación","Horarios","Propietario","Extras"];function jSe(){const e=br(),{id:t}=Ec(),n=aa(),r=ln($=>$.auth.usuario),l=ln($=>$.comunidades.lista),d=ln($=>$.categorias.data),p=ln($=>$.comunidades.loaded),a=ln($=>$.categorias.loaded),[b,T]=V.useState(0),[E,P]=V.useState({name:"",description:"",categories:[],community:"",contact:{phone:"",email:"",website:"",socialMedia:{facebook:"",instagram:"",whatsapp:""}},isDeliveryOnly:!1,primaryZip:"",location:{address:"",city:"",state:"",zipCode:"",country:"",coordinates:{lat:"",lng:""}},openingHours:[{day:"Monday",open:"09:00",close:"21:00",closed:!1},{day:"Tuesday",open:"09:00",close:"21:00",closed:!1},{day:"Wednesday",open:"09:00",close:"21:00",closed:!1},{day:"Thursday",open:"09:00",close:"21:00",closed:!1},{day:"Friday",open:"09:00",close:"21:00",closed:!1},{day:"Saturday",open:"09:00",close:"21:00",closed:!1},{day:"Sunday",open:"09:00",close:"21:00",closed:!1}],ownerId:"",ownerDisplay:{name:"",image:""},featuredImage:"",profileImage:"",tags:[],isVerified:!1,images:[]}),[I,R]=V.useState(!1),F=Vv[b];if(V.useEffect(()=>{a||e(Em()),p||e(zd())},[e,a,p]),V.useEffect(()=>{t?(R(!0),EP(t).then($=>{const Z=$.business;P(ne=>{var ie,ge,ae,se,me,ke,qe,tt,nt,bt,jt,Nt,vt,He,ut,Tt,Yt,Ge,ot;return{...ne,...Z,categories:(Z.categories||[]).map(mt=>mt._id||mt),community:((ie=Z.community)==null?void 0:ie._id)||Z.community,ownerId:((ge=Z.owner)==null?void 0:ge._id)||Z.owner,ownerDisplay:{name:((ae=Z.owner)==null?void 0:ae.name)||"",image:((se=Z.owner)==null?void 0:se.profileImage)||""},isDeliveryOnly:!!Z.isDeliveryOnly,primaryZip:Z.primaryZip||"",location:{address:((me=Z.location)==null?void 0:me.address)||"",city:((ke=Z.location)==null?void 0:ke.city)||"",state:((qe=Z.location)==null?void 0:qe.state)||"",zipCode:((tt=Z.location)==null?void 0:tt.zipCode)||"",country:((nt=Z.location)==null?void 0:nt.country)||"",coordinates:{lat:((Nt=(jt=(bt=Z.location)==null?void 0:bt.coordinates)==null?void 0:jt.coordinates)==null?void 0:Nt[1])??((He=(vt=Z.location)==null?void 0:vt.coordinates)==null?void 0:He.lat)??"",lng:((Yt=(Tt=(ut=Z.location)==null?void 0:ut.coordinates)==null?void 0:Tt.coordinates)==null?void 0:Yt[0])??((ot=(Ge=Z.location)==null?void 0:Ge.coordinates)==null?void 0:ot.lng)??""}}}})}).catch(()=>{e(Jt({message:"Error al cargar los datos del negocio.",type:"error"}))}).finally(()=>R(!1))):(r==null?void 0:r.role)!=="admin"&&(r!=null&&r._id)&&P($=>({...$,ownerId:r._id,ownerDisplay:{name:r.name,image:r.profileImage}}))},[t,r,e]),I)return f.jsx(T3,{});const W=[li({name:On().required("Nombre requerido"),description:On().required("Descripción requerida"),categories:bc().of(On().matches(/^[0-9a-fA-F]{24}$/,"ID de categoría inválido")).min(2,"Selecciona al menos dos categorías"),community:On().required("Comunidad requerida")}),li({contact:li({phone:On().required("Teléfono requerido"),email:On().email("Email inválido").required("Email requerido"),website:On().url("URL inválida").nullable(),socialMedia:li({facebook:On().nullable(),instagram:On().nullable(),whatsapp:On().nullable()}).nullable()}).required()}),li({isDeliveryOnly:Id().default(!1),primaryZip:On().when("isDeliveryOnly",{is:!0,then:$=>$.required("ZIP requerido").matches(/^\d{5}$/,"Debe ser un ZIP de 5 dígitos"),otherwise:$=>$.notRequired().nullable(!0)}),location:li().when("isDeliveryOnly",{is:!0,then:$=>$.shape({address:On().nullable(!0),city:On().nullable(!0),state:On().nullable(!0),zipCode:On().nullable(!0),country:On().nullable(!0),coordinates:li({lat:ps().nullable(!0),lng:ps().nullable(!0)}).nullable(!0)}),otherwise:$=>$.shape({address:On().required("Dirección requerida"),city:On().required("Ciudad requerida"),state:On().required("Estado requerido"),zipCode:On().required("Código postal requerido"),country:On().required("País requerido"),coordinates:li({lat:ps().nullable(!0),lng:ps().nullable(!0)}).nullable(!0)})})}),li({openingHours:bc().of(li({day:On().required(),closed:Id(),open:On().nullable().when("closed",{is:!1,then:$=>$.required("Hora de apertura requerida").matches(/\d{2}:\d{2}/,"Formato HH:MM inválido")}),close:On().nullable().when("closed",{is:!1,then:$=>$.required("Hora de cierre requerida").matches(/\d{2}:\d{2}/,"Formato HH:MM inválido")})})).required()}),li((r==null?void 0:r.role)==="admin"?{ownerId:On().required("Propietario requerido"),ownerDisplay:li({name:On().nullable(),image:On().url("Debe ser una URL válida").nullable()}).nullable()}:{}),li({featuredImage:ps().required("Imagen destacada requerida"),profileImage:ps().required("Imagen de perfil requerida"),images:bc().of(ps().test("is-valid-image","Cada imagen debe ser una URL válida o un archivo",$=>typeof $=="string"||typeof File<"u"&&$ instanceof File)).min(1,"Sube al menos una imagen"),tags:bc().of(On()).nullable(),isVerified:Id().nullable()})];return f.jsx(ef,{enableReinitialize:!0,initialValues:E,validationSchema:W[b],validateOnBlur:!1,validateOnChange:!1,onSubmit:async($,{setSubmitting:Z,validateForm:ne})=>{var ge,ae;const ie=await ne();if(Object.keys(ie).length){Z(!1);return}if(b!==Vv.length-1){Z(!1);return}try{const{featuredImage:se,profileImage:me,images:ke,ownerId:qe,categories:tt,...nt}=$,{owner:bt,...jt}=nt,Nt=new Set(["_id","id","createdAt","updatedAt","__v","ownerDisplay","likes","feedback","isPremium","locationPrecision"]),vt={...jt};Object.keys(vt).forEach(ot=>{Nt.has(ot)&&delete vt[ot]}),(ge=vt==null?void 0:vt.location)!=null&&ge.coordinates&&delete vt.location.coordinates;const He=ot=>(String(ot||"").match(/\d/g)||[]).join("").slice(0,5);if(vt.isDeliveryOnly){const ot=He(vt.primaryZip||((ae=vt.location)==null?void 0:ae.zipCode));if(ot.length!==5){e(Jt({message:"ZIP requerido de 5 dígitos para negocios solo delivery",type:"error"})),Z(!1);return}vt.primaryZip=ot,delete vt.location}else{const ot=He(vt.primaryZip);ot.length===5?vt.primaryZip=ot:delete vt.primaryZip}typeof vt.isVerified<"u"&&(vt.isVerified=!!vt.isVerified),typeof vt.isDeliveryOnly<"u"&&(vt.isDeliveryOnly=!!vt.isDeliveryOnly);const ut=new FormData;se instanceof File?ut.append("featuredImage",se):typeof se=="string"&&se.trim()&&ut.append("featuredImage",se.trim()),me instanceof File?ut.append("profileImage",me):typeof me=="string"&&me.trim()&&ut.append("profileImage",me.trim());const Tt=(ke||[]).filter(ot=>typeof ot=="string");ut.append("existingImages",JSON.stringify(Tt)),(ke||[]).filter(ot=>ot instanceof File).forEach(ot=>ut.append("images",ot));const Yt=(r==null?void 0:r.role)==="admin"?qe:r==null?void 0:r._id;!t&&Yt&&ut.append("ownerId",Yt),(tt||[]).map(String).filter(ot=>/^[0-9a-fA-F]{24}$/.test(ot)).forEach(ot=>ut.append("categories",ot)),Object.entries(vt).forEach(([ot,mt])=>{mt===""||mt===null||typeof mt>"u"||ut.append(ot,typeof mt=="object"?JSON.stringify(mt):String(mt))}),t?(await e(Fre({id:t,formData:ut})).unwrap(),e(Jt({message:"Negocio actualizado con éxito",type:"success"}))):(await e(Lre(ut)).unwrap(),e(Jt({message:"Negocio creado con éxito",type:"success"}))),n("/dashboard/mis-negocios")}catch(se){e(Jt({message:(se==null?void 0:se.message)||"Error al guardar el negocio",type:"error"}))}finally{Z(!1)}},children:({validateForm:$})=>f.jsxs(Ud,{className:"flex flex-col md:flex-row gap-8 w-full max-w-5xl mx-auto p-4 md:p-8 md:rounded-2xl bg-black/40 backdrop-blur-lg shadow-2xl text-white",children:[f.jsx("div",{className:"flex flex-row md:flex-col w-full md:w-20 lg:w-36 space-x-4 md:space-x-0 md:space-y-8",children:C4.map((Z,ne)=>f.jsxs("div",{className:"relative flex flex-col md:flex-row md:items-start items-center",children:[ne!==C4.length-1&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"absolute hidden md:hidden left-1/2 top-6 w-10 h-px bg-white/20 translate-x-1/2"}),f.jsx("span",{className:"absolute hidden md:block left-2.5 top-7 h-full w-px bg-white/20",style:{minHeight:"1.5rem"}})]}),f.jsx("div",{className:`flex items-center justify-center w-6 h-6 rounded-full border-2 shrink-0
                    ${b===ne?"border-orange-500 bg-orange-500 text-black":b>ne?"border-green-500 bg-green-500 text-black":"border-white/30 text-white"}`,children:b>ne?"✓":ne+1}),f.jsx("div",{className:"ml-2 text-xs lg: text-xs hidden md:block",children:Z})]},ne))}),f.jsxs("div",{className:"flex-1 space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsxs("div",{className:" text-xs font-medium",children:["Paso ",b+1," de ",Vv.length,":"," ",f.jsx("span",{className:"text-orange-400",children:C4[b]})]}),f.jsx("div",{className:"w-1/3 h-2 bg-white/10 rounded-full overflow-hidden",children:f.jsx("div",{className:"h-full bg-orange-500 transition-all",style:{width:`${(b+1)/Vv.length*100}%`}})})]}),f.jsx(ax,{mode:"wait",children:f.jsx(Ko.div,{initial:{opacity:0,x:40},animate:{opacity:1,x:0},exit:{opacity:0,x:-40},transition:{duration:.3},children:f.jsx(F,{...b===0?{categorias:d,comunidades:l}:{},soloLectura:b===4&&(r==null?void 0:r.role)!=="admin"})},b)}),f.jsxs("div",{className:"flex justify-between gap-2 mt-6",children:[b>0&&f.jsx("button",{type:"button",onClick:()=>T(Z=>Z-1),className:"w-full bg-white/10 border border-white/20 text-white py-3 rounded-lg font-semibold hover:bg-white/20 transition",children:"Atrás"}),f.jsx("button",{type:"button",className:"w-full bg-orange-600 hover:bg-orange-700 text-white py-3 rounded-lg font-semibold transition",onClick:async()=>{var ne;const Z=await $();Object.keys(Z).length===0&&(b<Vv.length-1?T(ie=>ie+1):(ne=document.querySelector("form"))==null||ne.requestSubmit())},children:b===Vv.length-1?t?"Actualizar negocio":"Crear negocio":"Siguiente"})]})]})]})})}function uF(){return f.jsxs("div",{className:"flex-col flex items-center justify-center min-h-screen p-2 gap-8 lg:mt-16",children:[f.jsx(Oa,{children:f.jsx("title",{children:"Crear Negocio | Communidades"})}),f.jsxs("section",{className:"relative w-full max-w-5xl shadow-xl rounded-2xl md:p-6  space-y-6 overflow-hidden",style:{backgroundImage:`url(${up})`,backgroundSize:"cover",backgroundPosition:"center"},children:[f.jsx("div",{className:"absolute inset-0 bg-white/50 backdrop-blur-sm rounded-xl h-full"}),f.jsxs("div",{className:"relative space-y-6 grid gap-8",children:[f.jsxs("div",{className:"flex items-center justify-between gap-2 p-6 md:p-0 ",children:[f.jsxs("div",{className:"grid gap-8",children:[f.jsx("h1",{className:"text-2xl font-bold text-black flex items-center gap-2",children:"Empezá a dar a conocer tu negocio"}),f.jsx("p",{className:"text-gray-700  text-xs sm:text-base",children:"Comparte tu emprendimiento con la comunidad, atrae clientes y haz crecer tu negocio en EE. UU. 🚀"})]}),f.jsx("img",{src:Kc,alt:"Perfil",className:"w-40 xl:w-60 opacity-90"})]}),f.jsx(jSe,{})]})]}),f.jsxs("div",{className:"pt-6 text-center space-y-2",children:[f.jsxs("p",{className:"text-[#141C24] text-base font-medium flex justify-center items-center gap-2",children:[f.jsx("img",{src:Rm,alt:"Icono",className:"h-8 md:h-12"}),"Da visibilidad a tu proyecto y conecta con latinos que apoyan tu pasión."]}),f.jsx("p",{className:"  text-xs text-gray-600",children:"Tu negocio puede marcar la diferencia en la vida de otros migrantes."})]})]})}function DW({promo:e,onSelect:t}){const{_id:n,name:r,featuredImage:l,type:d,isPremium:p=!1}=e,a=l||"https://cdn.usegalileo.ai/sdxl10/placeholder.png",b=`
    group relative rounded-lg overflow-hidden cursor-pointer flex flex-col min-h-[10rem]
    transition
    ${p?"bg-white border border-yellow-400 shadow-[0_0_10px_3px_rgba(234,179,8,0.4)]":"bg-white border border-gray-200 shadow hover:shadow-lg"}
  `;return f.jsxs("div",{onClick:()=>t(e),className:b,children:[f.jsxs("div",{className:"w-full h-28 overflow-hidden bg-gray-50 relative",children:[f.jsx("img",{src:a,alt:r,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"}),p&&f.jsx("div",{className:"absolute top-2 left-2 text-yellow-400 drop-shadow",children:f.jsx(UN,{className:"text-lg"})})]}),f.jsxs("div",{className:`flex flex-col justify-between gap-2 p-2 h-[5.2rem] flex-grow ${p?"bg-black text-white":""}`,children:[f.jsx("h3",{className:"  text-xs font-semibold line-clamp-2 leading-snug",children:r}),d&&f.jsx("span",{className:`text-[0.65rem] font-medium py-0.5 rounded w-fit capitalize
              ${p?"text-yellow-400 bg-black":"text-gray-500 bg-white"}
            `,children:d.replace(/_/g," ")})]})]})}function MSe(){const{id:e}=Ec(),[t,n]=V.useState([]),[r,l]=V.useState(!0),[d,p]=V.useState(null),a=br(),b=async()=>{try{l(!0);const E=await Tie(e);n(E.promotions)}catch(E){p("Error al cargar promociones"),console.error(E)}finally{l(!1)}};V.useEffect(()=>{b()},[e]);const T=async E=>{try{await TU(E),n(P=>P.filter(I=>I._id!==E))}catch{a(Jt({message:"No se pudo eliminar la promoción",type:"error"}))}};return f.jsxs("div",{className:"p-4 space-y-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Promociones de este negocio"}),r?f.jsx("p",{className:"text-gray-500",children:"Cargando promociones..."}):d?f.jsx("p",{className:"text-red-500",children:d}):t.length===0?f.jsx("p",{className:"text-gray-500",children:"Este negocio aún no tiene promociones."}):t.map(E=>f.jsx(DW,{promo:E,onDelete:T},E._id))]})}const PSe="/assets/ilust5-Bklr8Eoi.svg";function NSe({onClose:e}){return f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 px-4",children:f.jsxs("div",{className:"bg-white rounded-xl p-6 md:p-8 w-full max-w-md shadow-xl relative",children:[f.jsx("button",{onClick:e,className:"absolute top-3 right-3 text-gray-500 hover:text-black  text-lg",children:"×"}),f.jsx("h2",{className:"text-lg font-bold text-[#141C24] mb-2",children:"¿Cómo crear una promoción?"}),f.jsxs("p",{className:"text-gray-600  text-xs mb-4",children:["Para crear una promoción, primero debes ir a"," ",f.jsx("strong",{children:"Mis negocios"})," y seleccionarla desde la tarjeta del negocio correspondiente."]}),f.jsxs("div",{className:"group relative bg-white rounded-lg shadow border border-gray-200 overflow-hidden",children:[f.jsx("div",{className:"w-full h-24 bg-blue-100 flex items-center justify-center text-blue-400 text-xs font-semibold",children:"Imagen destacada"}),f.jsxs("div",{className:"flex flex-col gap-3 p-5",children:[f.jsx("h3",{className:"  text-xs font-semibold text-gray-700 truncate",children:"Mi Negocio Ejemplo"}),f.jsx("span",{className:"inline-block bg-black text-white text-xs font-medium px-2 py-0.5 rounded-full w-fit",children:"Restaurante"}),f.jsxs("div",{className:"flex justify-between items-center mt-3",children:[f.jsx("span",{className:"text-xs text-blue-400",children:"Ver más"}),f.jsxs("div",{className:"flex gap-3 relative",children:[f.jsxs("div",{className:"relative flex flex-col items-center",children:[f.jsx("button",{disabled:!0,className:"p-1 text-orange-500 animate-pulse",title:"Crear promoción",children:f.jsx(hy,{className:"w-5 h-5"})}),f.jsx(_ce,{className:"text-orange-500 animate-bounce mt-2"})]}),f.jsx("button",{disabled:!0,className:"p-1 text-gray-300",children:f.jsx(a3,{className:"w-5 h-5"})}),f.jsx("button",{disabled:!0,className:"p-1 text-gray-300",children:f.jsx(Iw,{className:"w-5 h-5"})})]})]})]})]}),f.jsx(Wn,{to:"/dashboard/mis-negocios",className:"block w-full text-center mt-4 bg-black text-white py-2 rounded font-semibold hover:bg-[#f4c753] hover:text-black transition",children:"Ir a Mis negocios"})]})})}function dF({promo:e,onClose:t,onDelete:n}){const[r,l]=V.useState(!1);return e?f.jsxs("div",{className:`\r
        relative\r
        w-full\r
        bg-gradient-to-br from-gray-50 via-white to-gray-100\r
        rounded-2xl\r
        shadow-lg\r
        p-4 lg:p-8 xl:p-10\r
        border border-gray-200\r
        min-h-[260px]\r
        max-h-[80vh]\r
        overflow-y-auto\r
      `,children:[t&&f.jsx("button",{onClick:t,className:"md:hidden absolute -top-0.5 right-4 text-gray-900 hover:text-black  text-xs",children:"Cerrar"}),f.jsxs("div",{className:"relative w-full flex flex-col xl:flex-row gap-6",children:[f.jsx("div",{className:"w-full xl:w-60 flex-shrink-0",children:f.jsx("img",{src:e.featuredImage||"https://cdn.usegalileo.ai/sdxl10/placeholder.png",alt:e.name,className:"w-full h-20 md:h-60 object-cover rounded-xl"})}),f.jsxs("div",{className:"flex-1 flex flex-col gap-4 justify-between",children:[f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsx("h2",{className:"text-2xl font-extrabold text-[#141C24] tracking-tight leading-snug",children:e.name}),e.type&&f.jsx("span",{className:"inline-block self-start bg-black text-white text-xs font-medium px-2 py-1 rounded-full capitalize",children:e.type.replace(/_/g," ")})]}),f.jsx("p",{className:"text-gray-700 text-xs md:text-md leading-relaxed whitespace-pre-line",children:e.description}),f.jsxs("div",{className:"flex flex-wrap gap-1 md:gap-4 text-xs text-gray-500 mt-2",children:[f.jsxs("span",{children:["Vigencia: ",new Date(e.startDate).toLocaleDateString()," –"," ",new Date(e.endDate).toLocaleDateString()]}),f.jsxs("span",{children:["Creado: ",new Date(e.createdAt).toLocaleDateString()]}),f.jsxs("span",{children:["Actualizado: ",new Date(e.updatedAt).toLocaleDateString()]})]}),f.jsxs("div",{className:"flex flex-row flex-wrap gap-2 mt-4",children:[f.jsxs(Wn,{to:`/dashboard/mis-promos/${e._id}/editar`,className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium no-underline",children:[f.jsx(Hw,{className:"text-lg"}),"Editar promoción"]}),f.jsxs("button",{onClick:()=>l(!0),className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-white items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-red-500 hover:bg-red-700 transition text-xs font-medium",children:[f.jsx(Bw,{className:"text-lg"}),"Eliminar promoción"]})]})]})]}),f.jsx(cp,{open:r,onClose:()=>l(!1),onConfirm:()=>{l(!1),n(e._id)},entityName:e.name,title:"Eliminar promoción",description:"Para confirmar, escribe el nombre exacto de la promoción:"})]}):null}function DSe(){const e=br(),{lista:t,loading:n,error:r,loaded:l}=ln(F=>F.promociones),[d,p]=V.useState(!1),[a,b]=V.useState(null),[T,E]=V.useState(!1),P=V.useRef(null);V.useEffect(()=>{l||e(Mb())},[e,l]),V.useEffect(()=>{t.length>0&&!a&&b((t==null?void 0:t[0])??null)},[t,a]);const I=F=>{b(F),window.innerWidth<768?E(!0):setTimeout(()=>{var W;(W=P.current)==null||W.scrollIntoView({behavior:"smooth",block:"start"})},100)},R=async F=>{try{await e(AU(F)).unwrap();const W=t.filter($=>$._id!==F);b(W[0]||null),E(!1)}catch{e(Jt({message:"Error al eliminar promoción",type:"error"}))}};return n?f.jsx(My,{}):r?f.jsx("div",{className:"p-4 text-red-600",children:r}):f.jsxs("div",{className:"max-w-[1200px] w-full mx-auto flex flex-col gap-8 md:gap-12 xl:gap-16 px-2",children:[f.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 md:gap-8 xl:gap-10 lg:mt-16",children:[f.jsx("div",{className:"flex-1",children:f.jsx(px,{icon:"💡",title:"Tus promociones",badge:"Tu espacio de ofertas",description:"Crea promociones irresistibles y conecta con más clientes.",illustration:Yh})}),a&&f.jsx("div",{ref:P,className:"hidden md:flex flex-3 flex-col justify-center",children:f.jsx(dF,{promo:a,onDelete:R})})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("hr",{className:"flex-grow border-gray-200"}),f.jsx("span",{className:"text-gray-400 text-xs uppercase tracking-wider",children:"Tus promociones"}),f.jsx("hr",{className:"flex-grow border-gray-200"})]}),f.jsxs("div",{className:"flex justify-between items-center mb-4 md:mb-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-[#141C24]",children:"Lista de promociones"}),f.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-2 bg-black text-white px-3 py-2 rounded hover:bg-[#f4c753] hover:text-black transition  text-xs font-semibold",children:[f.jsx(hy,{className:"text-lg"}),"Crear promoción"]})]}),t.length===0?f.jsxs("div",{className:"flex flex-col items-center text-center gap-5 py-16",children:[f.jsx("img",{src:PSe,alt:"Sin promociones",className:"w-40 opacity-90"}),f.jsxs("p",{className:"text-gray-600  text-xs md:text-base max-w-xs",children:["Aún no has creado ninguna promoción.",f.jsx("br",{}),"Destaca tus productos o servicios con ofertas especiales."]}),f.jsx("button",{onClick:()=>p(!0),className:"inline-block bg-orange-500 hover:bg-orange-600 text-white  text-xs font-medium px-4 py-2 rounded transition",children:"Crear promoción"})]}):f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-y-5 gap-x-3 md:gap-6 xl:gap-8",children:t.map(F=>f.jsx("div",{onClick:()=>I(F),className:`transition rounded-lg cursor-pointer ${(a==null?void 0:a._id)===F._id?"border-blue-400 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-400"}`,children:f.jsx(DW,{promo:F})},F._id))}),d&&f.jsx(NSe,{onClose:()=>p(!1)}),T&&a&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4",onClick:()=>E(!1),children:f.jsx("div",{className:"relative w-full max-w-md max-h-[80vh] overflow-y-auto",onClick:F=>F.stopPropagation(),children:f.jsx(dF,{promo:a,onClose:()=>E(!1),onDelete:R})})})]})}function OW(){const e=br(),t=ln(n=>n.categorias.data);V.useEffect(()=>{(!t||t.length===0)&&e(Em())},[t,e])}const OSe=li().shape({name:On().required("Nombre obligatorio"),description:On().required("Descripción obligatoria"),type:On().required("Tipo obligatorio"),startDate:gy().required("Fecha de inicio obligatoria"),endDate:gy().required("Fecha de fin obligatoria"),image:ps().required("Imagen obligatoria"),community:On().required("Comunidad obligatoria"),business:On().required("Negocio obligatorio"),maxClaims:kd().nullable().min(1,"Debe ser al menos 1").typeError("Debe ser un número")});function ISe(){const e=br();OW();const{negocioId:t}=Ec(),n=aa(),r=ln(b=>b.auth.usuario),l=ln(b=>b.comunidades.lista),d=ln(b=>b.categorias.data)||[],p={name:"",description:"",type:"promo_fin_de_semana",startDate:"",endDate:"",image:null,category:"",community:"",business:t,maxClaims:""},a=async(b,T)=>{try{const E=new FormData,P={name:b.name,description:b.description,type:b.type,startDate:b.startDate,endDate:b.endDate,business:b.business,category:b.category,community:b.community,createdBy:r._id,maxClaims:b.maxClaims||null};E.append("data",JSON.stringify(P)),E.append("featuredImage",b.image),await e(EU(E)).unwrap(),n("/dashboard/mis-negocios")}catch{}finally{T.setSubmitting(!1)}};return f.jsx(ef,{initialValues:p,validationSchema:OSe,onSubmit:a,validateOnBlur:!1,validateOnChange:!1,enableReinitialize:!0,children:({values:b,setFieldValue:T,isSubmitting:E})=>{var P,I;return f.jsx(Ud,{className:"flex flex-col md:flex-row gap-8 w-full max-w-5xl mx-auto p-4 md:p-8 bg-black/40 backdrop-blur-lg md:rounded-2xl shadow-2xl text-white",children:f.jsxs("div",{className:"flex-1 space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1 text-white",children:"Nombre"}),f.jsx(jn,{name:"name",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none",placeholder:"Nombre de la promoción"}),f.jsx(wn,{name:"name",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1 text-white",children:"Descripción"}),f.jsx(jn,{as:"textarea",name:"description",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none",placeholder:"Describe tu promoción",rows:3}),f.jsx(wn,{name:"description",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1 text-white",children:"Tipo de promoción"}),f.jsx(gs,{menuPlacement:"top",options:[{value:"promo_fin_de_semana",label:"Promo fin de semana"},{value:"descuentos_imperdibles",label:"Descuentos imperdibles"},{value:"nuevos_lanzamientos",label:"Nuevos lanzamientos"}],value:[{value:"promo_fin_de_semana",label:"Promo fin de semana"},{value:"descuentos_imperdibles",label:"Descuentos imperdibles"},{value:"nuevos_lanzamientos",label:"Nuevos lanzamientos"}].find(R=>R.value===b.type)||null,placeholder:"Selecciona el tipo de promoción...",styles:xs,onChange:R=>T("type",R.value)}),f.jsx(wn,{name:"type",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1 text-white",children:"Desde"}),f.jsx(jn,{type:"date",name:"startDate",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg text-white focus:outline-none"}),f.jsx(wn,{name:"startDate",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1 text-white",children:"Hasta"}),f.jsx(jn,{type:"date",name:"endDate",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg text-white focus:outline-none"}),f.jsx(wn,{name:"endDate",component:"div",className:"text-red-400  text-xs mt-1"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1 text-white",children:"Comunidad"}),f.jsx(gs,{menuPlacement:"top",options:l==null?void 0:l.map(R=>({value:R._id,label:R.name})),value:l!=null&&l.find(R=>R._id===b.community)?{value:b.community,label:(P=l.find(R=>R._id===b.community))==null?void 0:P.name}:null,placeholder:"Selecciona una comunidad...",styles:xs,onChange:R=>T("community",R.value)}),f.jsx(wn,{name:"community",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1 text-white",children:"Categoría"}),f.jsx(gs,{menuPlacement:"top",options:d==null?void 0:d.map(R=>({value:R._id,label:R.name})),value:d!=null&&d.find(R=>R._id===b.category)?{value:b.category,label:(I=d.find(R=>R._id===b.category))==null?void 0:I.name}:null,placeholder:"Selecciona una categoría...",styles:xs,onChange:R=>T("category",R.value)}),f.jsx(wn,{name:"category",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block  text-xs font-medium mb-1 text-white",children:["Límite de cupones disponibles"," ",f.jsx("span",{className:"text-white/60",children:"(opcional)"})]}),f.jsx(jn,{name:"maxClaims",type:"number",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg text-white placeholder:text-gray-300 focus:outline-none",placeholder:"Ej: 100"}),f.jsx(wn,{name:"maxClaims",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx(Zl,{value:b.image,nombreCampo:"image",onChange:R=>T("image",R)}),f.jsx(wn,{name:"image",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsx("button",{type:"submit",disabled:E,className:"w-full bg-orange-600 hover:bg-orange-700 text-white py-3 rounded-lg font-semibold transition",children:E?"Guardando...":"Crear Promoción"})]})})}})}const kSe=li().shape({name:On().required("Nombre obligatorio"),description:On().required("Descripción obligatoria"),type:On().required("Tipo obligatorio"),startDate:gy().required("Fecha de inicio obligatoria"),endDate:gy().required("Fecha de fin obligatoria"),community:On().required("Comunidad obligatoria"),maxClaims:kd().nullable().min(1,"Debe ser al menos 1").typeError("Debe ser un número")});function RSe({promo:e}){var b,T;OW();const t=aa(),n=ln(E=>E.auth.usuario),r=ln(E=>E.comunidades.lista),l=ln(E=>E.categorias.data)||[],d=br();if(!e)return f.jsx("p",{className:"p-4",children:"Cargando promoción..."});const p={name:e.name||"",description:e.description||"",type:e.type||"promo_fin_de_semana",startDate:e.startDate?e.startDate.slice(0,10):"",endDate:e.endDate?e.endDate.slice(0,10):"",image:e.featuredImage||"",category:((b=e.category)==null?void 0:b._id)||e.category||"",community:((T=e.community)==null?void 0:T._id)||e.community||"",maxClaims:e.maxClaims||""},a=async(E,P)=>{try{const I=new FormData,R={name:E.name,description:E.description,type:E.type,startDate:E.startDate,endDate:E.endDate,category:E.category,community:E.community,updatedBy:n._id,maxClaims:E.maxClaims||null};E.image&&(typeof E.image=="string"?R.featuredImage=E.image:I.append("featuredImage",E.image)),I.append("data",JSON.stringify(R)),await SU(e._id,I),d(Jt({message:"✅ Promoción actualizada correctamente",type:"success"})),t("/dashboard/mis-negocios")}catch(I){console.error("❌ Error al actualizar promoción:",I),d(Jt({message:"❌ Error al guardar la promoción",type:"error"}))}finally{P.setSubmitting(!1)}};return f.jsx(ef,{initialValues:p,validationSchema:kSe,onSubmit:a,validateOnBlur:!1,validateOnChange:!1,children:({values:E,setFieldValue:P,isSubmitting:I})=>{var R,F;return f.jsx(Ud,{className:"flex flex-col md:flex-row gap-8 w-full max-w-5xl mx-auto p-4  md:p-8 bg-black/40 backdrop-blur-lg md:rounded-2xl shadow-2xl text-white",children:f.jsxs("div",{className:"flex-1 space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1 text-white",children:"Nombre"}),f.jsx(jn,{name:"name",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none",placeholder:"Nombre de la promoción"}),f.jsx(wn,{name:"name",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1 text-white",children:"Descripción"}),f.jsx(jn,{as:"textarea",name:"description",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none",placeholder:"Describe tu promoción",rows:3}),f.jsx(wn,{name:"description",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1 text-white",children:"Tipo de promoción"}),f.jsx(gs,{menuPlacement:"top",options:[{value:"promo_fin_de_semana",label:"Promo fin de semana"},{value:"descuentos_imperdibles",label:"Descuentos imperdibles"},{value:"nuevos_lanzamientos",label:"Nuevos lanzamientos"}],value:[{value:"promo_fin_de_semana",label:"Promo fin de semana"},{value:"descuentos_imperdibles",label:"Descuentos imperdibles"},{value:"nuevos_lanzamientos",label:"Nuevos lanzamientos"}].find(W=>W.value===E.type)||null,placeholder:"Selecciona el tipo de promoción...",styles:xs,onChange:W=>P("type",W.value)}),f.jsx(wn,{name:"type",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1 text-white",children:"Desde"}),f.jsx(jn,{type:"date",name:"startDate",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg text-white focus:outline-none"}),f.jsx(wn,{name:"startDate",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1 text-white",children:"Hasta"}),f.jsx(jn,{type:"date",name:"endDate",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg text-white focus:outline-none"}),f.jsx(wn,{name:"endDate",component:"div",className:"text-red-400  text-xs mt-1"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1 text-white",children:"Comunidad"}),f.jsx(gs,{menuPlacement:"top",options:r==null?void 0:r.map(W=>({value:W._id,label:W.name})),value:r!=null&&r.find(W=>W._id===E.community)?{value:E.community,label:(R=r.find(W=>W._id===E.community))==null?void 0:R.name}:null,placeholder:"Selecciona una comunidad...",styles:xs,onChange:W=>P("community",W.value)}),f.jsx(wn,{name:"community",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1 text-white",children:"Categoría"}),f.jsx(gs,{menuPlacement:"top",options:l==null?void 0:l.map(W=>({value:W._id,label:W.name})),value:l!=null&&l.find(W=>W._id===E.category)?{value:E.category,label:(F=l.find(W=>W._id===E.category))==null?void 0:F.name}:null,placeholder:"Selecciona una categoría...",styles:xs,onChange:W=>P("category",W.value)})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block  text-xs font-medium mb-1 text-white",children:["Límite de cupones disponibles"," ",f.jsx("span",{className:"text-white/60",children:"(opcional)"})]}),f.jsx(jn,{name:"maxClaims",type:"number",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg text-white placeholder:text-gray-300 focus:outline-none",placeholder:"Ej: 100"}),f.jsx(wn,{name:"maxClaims",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1 text-white",children:"Imagen destacada"}),f.jsx(Zl,{value:E.image,nombreCampo:"image",onChange:W=>P("image",W)})]}),f.jsx("button",{type:"submit",disabled:I,className:"w-full bg-orange-600 hover:bg-orange-700 text-white py-3 rounded-lg font-semibold transition",children:I?"Guardando...":"Guardar cambios"})]})})}})}function hF(){const{promoId:e}=Ec(),t=br(),n=ln(b=>b.promociones.lista),[r,l]=V.useState(null),[d,p]=V.useState(!!e),a=!!e;return V.useEffect(()=>{(async()=>{if(e){const T=n.find(E=>E._id===e);if(T)l(T),p(!1);else try{const E=await wie(e);l(E.promotion)}catch{t(Jt({message:"Error al cargar promoción",type:"error"}))}finally{p(!1)}}})()},[e,n]),V.useEffect(()=>{n.length===0&&t(Mb())},[t,n.length]),f.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen gap-8 md:mt-8 lg:mt-16",children:[f.jsx(Oa,{children:f.jsxs("title",{children:[a?"Editar Promoción":"Crear Promoción"," | Communidades"]})}),f.jsxs("section",{className:"relative w-full max-w-5xl shadow-xl rounded-2xl  sm:p-16 space-y-6 overflow-hidden",style:{backgroundImage:`url(${up})`,backgroundSize:"cover",backgroundPosition:"center"},children:[f.jsx("div",{className:"absolute inset-0 bg-white/50 backdrop-blur-sm rounded-xl h-full"}),f.jsxs("div",{className:"relative space-y-6 grid gap-8",children:[f.jsxs("div",{className:"flex items-center justify-between gap-2 p-6",children:[f.jsxs("div",{className:"grid gap-6",children:[f.jsx("h1",{className:"text-2xl font-bold text-black flex items-center gap-2",children:a?"Hazla aún más irresistible":"Comparte tu próxima gran oferta"}),f.jsx("p",{className:"text-gray-700  text-xs sm:text-base max-w-xl",children:a?"Modifica los detalles de tu promoción para mantenerla actualizada y relevante.":"Comparte ofertas especiales y promociones exclusivas que ayuden a tu negocio a conectar con la comunidad latina 💫"})]}),f.jsx("img",{src:Kc,alt:"Ilustración promoción",className:"w-40 xl:w-60 opacity-90"})]}),a?d?f.jsx("p",{className:"text-gray-600",children:"Cargando promoción..."}):r?f.jsx(RSe,{promo:r}):f.jsx("p",{className:"text-red-500",children:"No se encontró la promoción."}):f.jsx(ISe,{})]})]}),f.jsxs("div",{className:"pt-6 text-center space-y-2",children:[f.jsxs("p",{className:"text-[#141C24] text-base font-medium flex justify-center items-center gap-2",children:[f.jsx("img",{src:Rm,alt:"Icono",className:"h-8 md:h-12"}),a?"Mantén tus promociones al día y aumenta su impacto.":"Destaca tus productos y fortalece la identidad de tu comunidad."]}),f.jsx("p",{className:"  text-xs text-gray-600",children:a?"Actualizar tu promoción ayuda a tus clientes a conocer tus novedades.":"Cada promoción es una oportunidad de crecer juntos."})]})]})}function zSe({evento:e,onSelect:t}){const{_id:n,title:r="Sin título",date:l,featuredImage:d}=e,p=d||`https://cdn.usegalileo.ai/sdxl10/${n||"default"}.png`;return f.jsxs("div",{onClick:()=>t(e),className:`\r
        group relative bg-white rounded-lg shadow hover:shadow-lg transition overflow-hidden border border-gray-200 h-50 flex flex-col cursor-pointer\r
      `,children:[f.jsx("div",{className:"w-full min-h-28 overflow-hidden bg-gray-50",children:f.jsx("img",{src:p,alt:r,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"})}),f.jsxs("div",{className:"flex flex-col gap-2 justify-between p-2 h-[9rem] flex-grow",children:[f.jsx("h3",{className:"  text-xs font-semibold text-gray-700 line-clamp-2",children:r}),f.jsx("span",{className:"text-[0.65rem] font-mediumpy-0.5 rounded bg-white text-gray-500 w-fit",children:l?new Date(l).toLocaleDateString():"Sin fecha"})]})]})}const LSe="/assets/ilust4-B0SbxeLM.svg";function fF({evento:e,onClose:t,onDelete:n}){var r;return e?f.jsxs("div",{className:`\r
        relative\r
        w-full\r
        bg-gradient-to-br from-gray-50 via-white to-gray-100\r
        rounded-2xl\r
        shadow-lg\r
        p-4 lg:p-8 xl:p-10\r
        border border-gray-200\r
        min-h-[260px]\r
        max-h-[80vh]\r
        overflow-y-auto\r
      `,children:[t&&f.jsx("button",{onClick:t,className:"md:hidden absolute -top-0.5 right-4 text-gray-900 hover:text-black  text-xs",children:"Cerrar"}),f.jsxs("div",{className:"relative w-full flex flex-col xl:flex-row gap-6",children:[f.jsx("div",{className:"w-full xl:w-60 flex-shrink-0",children:f.jsx("img",{src:e.featuredImage,alt:e.title,className:"w-full h-20 md:h-60 object-cover rounded-xl"})}),f.jsxs("div",{className:"flex-1 flex flex-col gap-4 justify-between",children:[f.jsx("h2",{className:"text-2xl font-extrabold text-[#141C24] tracking-tight leading-snug",children:e.title}),f.jsx("p",{className:"text-gray-700 text-xs md:text-md leading-relaxed whitespace-pre-line",children:e.description}),((r=e.tags)==null?void 0:r.length)>0&&f.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:e.tags.map(l=>f.jsxs("span",{className:"inline-block bg-blue-100 text-blue-700 text-xs font-medium px-2 py-1 rounded-full",children:["#",l]},l))}),f.jsxs("div",{className:"flex flex-wrap gap-1 md:gap-4 text-xs text-gray-500 mt-2",children:[f.jsxs("span",{children:["Fecha:"," ",e.date?new Date(e.date).toLocaleDateString():"Sin fecha"]}),e.location&&f.jsxs("span",{children:[e.location.address,", ",e.location.city]}),f.jsxs("span",{children:["Creado: ",new Date(e.createdAt).toLocaleDateString()]})]}),f.jsxs("div",{className:"flex flex-row flex-wrap gap-2 mt-4",children:[f.jsxs(Wn,{to:`/dashboard/mis-eventos/${e._id}/editar`,className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium no-underline",children:[f.jsx(Hw,{className:"text-lg"}),"Editar evento"]}),f.jsxs(Wn,{to:`/dashboard/mis-eventos/${e._id}`,className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium no-underline",children:[f.jsx($N,{className:"text-lg"}),"Ver detalle privado"]}),f.jsxs(Wn,{to:`/eventos/${e._id}`,className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium no-underline",children:[f.jsx(vG,{className:"text-lg"}),"Detalle del evento"]}),f.jsxs("button",{onClick:()=>n(e._id),className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-white items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-red-500 hover:bg-red-700 transition text-xs font-medium",children:[f.jsx(Bw,{className:"text-lg"}),"Eliminar evento"]})]})]})]})]}):null}function FSe(){const e=br(),{misEventos:t,loading:n,error:r,loaded:l}=ln(F=>F.eventos),[d,p]=V.useState(null),[a,b]=V.useState(!1),[T,E]=V.useState(null),P=V.useRef(null);V.useEffect(()=>{l&&t.length>0&&!d&&p((t==null?void 0:t[0])??null)},[l,t,d]);const I=async F=>{try{await e(KE(F)).unwrap();const W=t.filter($=>$._id!==F);p(W[0]||null),b(!1),E(null)}catch{e(Jt({message:"Error al eliminar evento",type:"error"}))}},R=F=>{p(F),window.innerWidth<768?b(!0):setTimeout(()=>{var W;(W=P.current)==null||W.scrollIntoView({behavior:"smooth",block:"start"})},100)};return n?f.jsx(My,{}):r?f.jsx("div",{className:"p-4 text-red-600",children:r}):f.jsxs("div",{className:"max-w-[1200px] w-full mx-auto flex flex-col gap-8 md:gap-12 xl:gap-16 px-2 ",children:[f.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 md:gap-8 xl:gap-10 lg:mt-16",children:[f.jsx("div",{className:"flex-1",children:f.jsx(px,{icon:"🎉",title:"Tus eventos",badge:"Tu espacio de organización",description:"Administra tus eventos, comparte novedades y conecta con tu comunidad.",illustration:Yh})}),d&&f.jsx("div",{ref:P,className:"hidden md:flex flex-3 flex-col justify-center",children:f.jsx(fF,{evento:d,onDelete:F=>E(F)})})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("hr",{className:"flex-grow border-gray-200"}),f.jsx("span",{className:"text-gray-400 text-xs uppercase tracking-wider",children:"Tus eventos"}),f.jsx("hr",{className:"flex-grow border-gray-200"})]}),f.jsxs("div",{className:"flex justify-between items-center mb-4 md:mb-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-[#141C24]",children:"Lista de eventos"}),f.jsxs(Wn,{to:"crear",className:"flex items-center gap-2 bg-black text-white px-3 py-2 rounded hover:bg-[#f4c753] hover:text-black transition  text-xs font-semibold",children:[f.jsx(wle,{className:"text-lg"}),f.jsx("span",{className:"hidden md:block",children:"Crear evento"})]})]}),t.length===0?f.jsxs("div",{className:"flex flex-col items-center text-center gap-5 py-16",children:[f.jsx("img",{src:LSe,alt:"Sin eventos",className:"w-40 opacity-90"}),f.jsxs("p",{className:"text-gray-600  text-xs md:text-base max-w-xs",children:["Aún no has creado ningún evento.",f.jsx("br",{}),"Publica tus actividades y conecta con tu comunidad fácilmente."]}),f.jsx(Wn,{to:"/dashboard/mis-eventos/crear",className:"inline-block bg-orange-500 hover:bg-orange-600 text-white  text-xs font-medium px-4 py-2 rounded transition",children:"Crear mi primer evento"})]}):f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-y-5 gap-x-3 md:gap-6 xl:gap-8",children:t.map(F=>f.jsx("div",{onClick:()=>R(F),className:`transition rounded-lg cursor-pointer ${(d==null?void 0:d._id)===F._id?"border-blue-400 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-400"}`,children:f.jsx(zSe,{evento:F})},F._id))}),a&&d&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4",onClick:()=>b(!1),children:f.jsx("div",{className:"relative w-full max-w-md max-h-[80vh] overflow-y-auto rounded-xl",onClick:F=>F.stopPropagation(),children:f.jsx(fF,{evento:d,onClose:()=>b(!1),onDelete:F=>E(F)})})}),T&&d&&f.jsx(cp,{open:!!T,onClose:()=>E(null),onConfirm:()=>I(T),entityName:d.title,title:"¿Eliminar este evento?",description:"Para confirmar, escribe el nombre exacto del evento:"})]})}function BSe(){const{values:e,setFieldValue:t}=mo(),n=[{value:"es",label:"Español"},{value:"en",label:"Inglés"},{value:"pt",label:"Portugués"},{value:"fr",label:"Francés"}];return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Título del evento"}),f.jsx(jn,{name:"title",placeholder:"Título del evento",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"title",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Descripción"}),f.jsx(jn,{as:"textarea",name:"description",placeholder:"Breve descripción del evento",rows:3,className:"w-full h-42 lg:h-62 px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"description",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Etiquetas (separadas por coma)"}),f.jsx(jn,{name:"tags",placeholder:"ej. música, comida, feria",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"tags",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Idioma del evento"}),f.jsx(gs,{menuPlacement:"top",name:"language",options:n,placeholder:"Selecciona un idioma...",styles:xs,value:n.find(r=>r.value===e.language)||null,onChange:r=>t("language",r.value)}),f.jsx(wn,{name:"language",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(jn,{type:"checkbox",name:"isFree",id:"isFree",className:"h-5 w-5 text-orange-500 border-white/40 bg-white/10 rounded focus:ring-0"}),f.jsx("label",{htmlFor:"isFree",className:"  text-xs text-white font-medium",children:"Evento gratuito"})]}),!e.isFree&&f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Precio"}),f.jsx(jn,{type:"number",name:"price",placeholder:"Ej: 10",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"price",component:"div",className:"text-red-400  text-xs mt-1"})]})]})}function VSe(){const{values:e,setFieldValue:t}=mo(),n=!!(e!=null&&e.isOnline);V.useEffect(()=>{n?(t("location.address",""),t("location.city",""),t("location.state",""),t("location.zipCode",""),t("location.coordinates.lat",""),t("location.coordinates.lng","")):e.virtualLink&&t("virtualLink","")},[n]);const r=l=>{const d=l.target.checked;t("isOnline",d)};return f.jsxs("div",{className:"space-y-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-white",children:"Ubicación del Evento"}),f.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg bg-white/5 border border-white/10",children:[f.jsx(jn,{type:"checkbox",name:"isOnline",checked:n,onChange:r}),f.jsx("span",{className:"text-xs text-white",children:"Evento online (sin ubicación física)"})]}),n?f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-white mb-1",children:"Enlace del evento (virtual)"}),f.jsx(jn,{name:"virtualLink",children:({field:l})=>f.jsx("input",{...l,type:"url",placeholder:"https://tu-evento-virtual.com/sala",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none",onChange:d=>{const p=d.target.value.trim();t("virtualLink",p)}})}),f.jsx(wn,{name:"virtualLink",component:"div",className:"text-red-400 text-xs mt-1"}),f.jsx("p",{className:"text-xs text-white/70 mt-2",children:"Si es online, no necesitas ingresar dirección. El backend guardará el enlace como referencia para los asistentes."})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-white mb-1",children:"Dirección"}),f.jsx(jn,{name:"location.address",placeholder:"345 Colorado Peace St",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"location.address",component:"div",className:"text-red-400 text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-white mb-1",children:"Ciudad"}),f.jsx(jn,{name:"location.city",placeholder:"Dallas",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"location.city",component:"div",className:"text-red-400 text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-white mb-1",children:"Estado (2 letras)"}),f.jsx(jn,{name:"location.state",children:({field:l})=>f.jsx("input",{...l,maxLength:2,placeholder:"TX",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none",onChange:d=>{const p=d.target.value.toUpperCase().slice(0,2);t("location.state",p)}})}),f.jsx(wn,{name:"location.state",component:"div",className:"text-red-400 text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-white mb-1",children:"Código Postal (5 dígitos)"}),f.jsx(jn,{name:"location.zipCode",children:({field:l})=>f.jsx("input",{...l,inputMode:"numeric",pattern:"\\d{5}",maxLength:5,placeholder:"75081",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none",onChange:d=>{const p=d.target.value.replace(/\D/g,"").slice(0,5);t("location.zipCode",p)}})}),f.jsx(wn,{name:"location.zipCode",component:"div",className:"text-red-400 text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-white mb-1",children:"País"}),f.jsx(jn,{name:"location.country",placeholder:"USA",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"location.country",component:"div",className:"text-red-400 text-xs mt-1"})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-white mb-1",children:"Latitud (opcional)"}),f.jsx(jn,{name:"location.coordinates.lat",children:({field:l})=>f.jsx("input",{...l,type:"number",step:"any",placeholder:"32.7767",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none"})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-white mb-1",children:"Longitud (opcional)"}),f.jsx(jn,{name:"location.coordinates.lng",children:({field:l})=>f.jsx("input",{...l,type:"number",step:"any",placeholder:"-96.7970",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none"})})]})]}),f.jsx("p",{className:"text-xs text-white/70 mt-2",children:"Si no indicas coordenadas, el sistema intentará geocodificar la dirección. Para máxima precisión en el mapa, agrega lat/lng."})]})]})}function USe(){const{values:e}=mo();return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Fecha del evento"}),f.jsx(jn,{type:"date",name:"date",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg text-white placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"date",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"time",className:"block  text-xs font-medium text-white mb-1",children:"Hora del evento"}),f.jsx(jn,{type:"time",name:"time",id:"time",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg text-white placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"time",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(jn,{type:"checkbox",name:"isOnline",id:"isOnline",className:"form-checkbox h-5 w-5 text-orange-500"}),f.jsx("label",{htmlFor:"isOnline",className:"  text-xs font-medium text-white",children:"¿Es un evento virtual?"})]}),e.isOnline&&f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Link del evento online"}),f.jsx(jn,{name:"virtualLink",placeholder:"https://...",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg text-white placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"virtualLink",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Link de registro (opcional)"}),f.jsx(jn,{name:"registrationLink",placeholder:"https://formulario.com/registro",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg text-white placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"registrationLink",component:"div",className:"text-red-400  text-xs mt-1"})]})]})}function $Se(){const{values:e,setFieldValue:t}=mo();return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx(Zl,{value:e.image,onChange:n=>t("image",n),label:"Imagen destacada del evento"}),f.jsx(wn,{name:"image",component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsx("div",{children:f.jsx(NW,{values:e.images,onChange:n=>t("images",n),label:"Galería de imágenes del evento"})})]})}function qSe({value:e,onChange:t}){const[n,r]=V.useState(""),[l,d]=V.useState([]),[p,a]=V.useState(!1),b=async()=>{if(!(n.length<2)){a(!0);try{const E=(await Rn.get(`/busqueda/search/organizers?q=${n}`)).data.map(P=>({label:P.label,value:P.value,model:P.model}));d(E)}catch(T){console.error("Error buscando organizadores:",T)}finally{a(!1)}}};return f.jsxs("div",{className:"space-y-3",children:[f.jsx("label",{className:"block  text-xs font-medium",children:"Organizador"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",value:n,onChange:T=>r(T.target.value),placeholder:"Escribe nombre...",className:"flex-1 border border-white/30 bg-white/10 text-white placeholder:text-gray-400 px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"}),f.jsx("button",{type:"button",onClick:b,className:"px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-semibold transition",children:"Buscar"})]}),f.jsx(gs,{menuPlacement:"top",isLoading:p,options:l,value:e,onChange:t,placeholder:"Selecciona un organizador...",styles:xs,classNamePrefix:"rs",noOptionsMessage:()=>"Sin resultados"})]})}function HSe(){const e=br(),{values:t,setFieldValue:n}=mo(),r=ln(T=>{var E;return((E=T.categorias)==null?void 0:E.data)??[]}),l=ln(T=>{var E;return((E=T.comunidades)==null?void 0:E.lista)??[]}),d=ln(T=>{var E;return((E=T.negocios)==null?void 0:E.lista)??[]}),p=ln(T=>T.auth.usuario),{coords:a}=ln(T=>T.ubicacion),b=ln(T=>T.categorias.loading)||ln(T=>T.comunidades.loading)||ln(T=>T.negocios.loading);return V.useEffect(()=>{(Array.isArray(r)===!1||r.length===0)&&e(Em()),(Array.isArray(d)===!1||d.length===0)&&e(Yf())},[]),V.useEffect(()=>{a&&(!l||l.length===0)&&e(zd(a))},[a]),b?f.jsx("p",{className:"  text-xs text-gray-500",children:"Cargando opciones..."}):f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Categorías"}),f.jsx(gs,{menuPlacement:"top",isMulti:!0,options:r.map(T=>({value:T._id,label:T.name})),value:r.filter(T=>Array.isArray(t.categories)&&t.categories.includes(T._id)).map(T=>({value:T._id,label:T.name})),styles:xs,onChange:T=>n("categories",T.map(E=>E.value)),placeholder:"Selecciona categorías..."}),f.jsx(wn,{name:"categories",component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Comunidades"}),f.jsx(gs,{menuPlacement:"top",isMulti:!0,options:l.map(T=>({value:T._id,label:T.name})),value:l.filter(T=>Array.isArray(t.communities)&&t.communities.includes(T._id)).map(T=>({value:T._id,label:T.name})),styles:xs,onChange:T=>n("communities",T.map(E=>E.value)),placeholder:"Selecciona comunidades..."}),f.jsx(wn,{name:"communities",component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Negocios auspiciantes (opcional)"}),f.jsx(gs,{menuPlacement:"top",isMulti:!0,options:d.map(T=>({value:T._id,label:T.name})),value:d.filter(T=>Array.isArray(t.sponsors)&&t.sponsors.includes(T._id)).map(T=>({value:T._id,label:T.name})),styles:xs,onChange:T=>n("sponsors",T.map(E=>E.value)),placeholder:"Selecciona negocios..."}),f.jsx(wn,{name:"sponsors",component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Estado del evento"}),f.jsx(gs,{menuPlacement:"top",options:[{value:"activo",label:"Activo"},{value:"cancelado",label:"Cancelado"},{value:"finalizado",label:"Finalizado"}],value:t.status?{value:t.status,label:t.status.charAt(0).toUpperCase()+t.status.slice(1)}:null,styles:xs,onChange:T=>n("status",T.value),placeholder:"Selecciona estado..."}),f.jsx(wn,{name:"status",component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(jn,{type:"checkbox",name:"featured",id:"featured",className:"form-checkbox h-5 w-5 text-blue-600"}),f.jsx("label",{htmlFor:"featured",className:"  text-xs font-medium",children:"Marcar como destacado"})]}),p.role==="admin"&&f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Organizador del evento"}),f.jsx(qSe,{menuPlacement:"top",placeholder:"Selecciona el organizador (usuario o negocio)...",value:t.organizer&&t.organizerModel?{value:t.organizer,label:t.organizerLabel||"",model:t.organizerModel}:null,onChange:T=>{n("organizer",T.value),n("organizerModel",T.model),n("organizerLabel",T.label)}}),f.jsx(wn,{name:"organizer",component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(jn,{type:"checkbox",name:"isPublished",id:"isPublished",className:"form-checkbox h-5 w-5 text-blue-600"}),f.jsx("label",{htmlFor:"isPublished",className:"  text-xs font-medium",children:"Publicar evento al guardarlo"})]})]})}const j4=["Información","Ubicación","Detalles","Imágenes","Opciones Finales"],ob=[BSe,VSe,USe,$Se,HSe],GSe=[li({title:On().required("Título obligatorio"),description:On().required("Descripción obligatoria"),tags:On().nullable()}),li({isOnline:Id(),location:li({address:On().when("isOnline",{is:!1,then:e=>e.required("Dirección obligatoria"),otherwise:e=>e.notRequired()}),city:On().when("isOnline",{is:!1,then:e=>e.required("Ciudad obligatoria"),otherwise:e=>e.notRequired()}),state:On().when("isOnline",{is:!1,then:e=>e.required("Estado obligatorio"),otherwise:e=>e.notRequired()}),zipCode:On().when("isOnline",{is:!1,then:e=>e.required("Código postal obligatorio"),otherwise:e=>e.notRequired()}),country:On().when("isOnline",{is:!1,then:e=>e.required("País obligatorio"),otherwise:e=>e.notRequired()})})}),li({date:gy().required("Fecha obligatoria"),time:On().required("Hora obligatoria"),isOnline:Id(),virtualLink:On().transform(e=>e===""?null:e).when("isOnline",{is:!0,then:e=>e.required("El link virtual es obligatorio").url("URL inválida"),otherwise:e=>e.nullable().notRequired()}),registrationLink:On().transform(e=>e===""?null:e).nullable().notRequired().url("Debe ser una URL válida")}),li({image:ps().required("Imagen destacada requerida"),images:bc().of(ps()).nullable()}),li({categories:bc().min(1,"Selecciona al menos una categoría").of(On().required()),communities:bc().min(1,"Selecciona al menos una comunidad").of(On().required()),isFree:Id(),price:ps().when("isFree",{is:!1,then:()=>kd().typeError("Debe ser un número").required("Precio obligatorio").min(1,"Debe ser mayor a 0"),otherwise:()=>kd().notRequired()}),sponsors:bc().of(On()).nullable(),language:On().oneOf(["es","en","pt","fr"]).default("es"),status:On().oneOf(["activo","cancelado","finalizado"]),featured:Id(),isPublished:Id()})],WSe={title:"",description:"",date:"",time:"",location:{address:"",city:"",state:"",zipCode:"",country:"USA"},image:null,images:[],categories:[],communities:[],tags:"",language:"es",isFree:!0,price:0,isOnline:!1,virtualLink:"",registrationLink:"",sponsors:[],status:"activo",featured:!1,isPublished:!1,organizer:"",organizerModel:""};function IW({initialValues:e=WSe,onSubmit:t,modoEdicion:n=!1}){const[r,l]=V.useState(0),d=ob[r],p=ln(E=>E.auth.usuario),a=aa(),b=br(),T=async(E,P)=>{var I,R,F;try{const W=new FormData;E.image&&typeof E.image!="string"&&W.append("featuredImage",E.image),Array.isArray(E.images)&&E.images.forEach(qe=>{qe instanceof File&&W.append("images",qe)});const $=E.tags?E.tags.split(",").map(qe=>qe.trim()).filter(Boolean):[],Z=typeof E.organizer=="object"&&E.organizer!==null?E.organizer.value||E.organizer._id||"":E.organizer||"",ne=typeof E.organizer=="object"&&E.organizer!==null?E.organizer.model:E.organizerModel;let ie=Z?String(Z):"",ge=ne||"";if(!ie||!/^[0-9a-fA-F]{24}$/.test(ie))if((p==null?void 0:p.role)==="admin"){b(Jt({message:"Selecciona un organizador válido",type:"error"})),P.setSubmitting(!1);return}else{ie=String((p==null?void 0:p._id)||"");const qe=(I=p==null?void 0:p.role)==null?void 0:I.toLowerCase();ge=qe==="business"||qe==="business_owner"?"Business":"User"}else ge||(ge="User");const ae=Number(E.price||0);let se={...E.location||{}};if(E.isOnline)se={address:"",city:"",state:"",zipCode:"",country:se.country||"USA"};else{const qe=(R=se==null?void 0:se.coordinates)==null?void 0:R.lat,tt=(F=se==null?void 0:se.coordinates)==null?void 0:F.lng,nt=qe===""?null:Number(qe),bt=tt===""?null:Number(tt);nt!==null&&bt!==null&&!Number.isNaN(nt)&&Number.isNaN(bt),se!=null&&se.coordinates&&delete se.coordinates}const me=(qe,tt)=>{tt!=null&&(typeof tt=="string"&&tt.trim()===""||W.append(qe,typeof tt=="object"?JSON.stringify(tt):String(tt)))},ke=(qe,tt)=>{const nt=Array.isArray(tt)?tt:[];nt.length&&W.append(qe,JSON.stringify(nt.map(String)))};me("title",E.title),me("description",E.description),me("date",E.date),me("time",E.time),me("isOnline",E.isOnline),E.isOnline&&me("virtualLink",E.virtualLink),me("registrationLink",E.registrationLink),W.append("organizer",ie),W.append("organizerModel",ge),me("location",se),me("isFree",E.isFree),E.isFree||me("price",ae),me("language",E.language),me("status",E.status),me("featured",E.featured),me("isPublished",E.isPublished),ke("categories",E.categories),ke("communities",E.communities),ke("sponsors",E.sponsors),ke("likes",E.likes),ke("tags",$),await b(Wre(W)).unwrap(),b(Jt({message:"✅ Evento creado correctamente",type:"success"})),a("/dashboard/mis-eventos")}catch(W){b(Jt({message:(W==null?void 0:W.message)||"❌ Ocurrió un error al crear el evento",type:"error"}))}finally{P.setSubmitting(!1)}};return f.jsx(ef,{initialValues:e,enableReinitialize:!0,validationSchema:GSe[r],onSubmit:(E,P)=>{r===ob.length-1?n?t(E,P):T(E,P):l(I=>I+1)},validateOnBlur:!1,validateOnChange:!1,children:({values:E})=>f.jsxs(Ud,{className:"flex flex-col md:flex-row gap-8 w-full max-w-5xl mx-auto p-4 md:p-8 bg-black/40 backdrop-blur-lg md:rounded-2xl shadow-2xl text-white",children:[f.jsx("div",{className:"flex flex-row md:flex-col w-full md:w-20 lg:w-36 space-x-4 md:space-x-0 md:space-y-8",children:j4.map((P,I)=>f.jsxs("div",{className:"relative flex flex-row items-center md:items-start",children:[I!==j4.length-1&&f.jsx("span",{className:"absolute hidden md:block left-3 top-6 h-[2rem] w-px bg-white/20"}),f.jsx("div",{className:`w-6 h-6 flex items-center justify-center rounded-full border-2 shrink-0
                    ${r===I?"border-orange-500 bg-orange-500 text-black":r>I?"border-green-500 bg-green-500 text-black":"border-white/30 text-white"}`,children:r>I?"✓":I+1}),f.jsx("div",{className:"ml-2 text-xs hidden md:block",children:P})]},I))}),f.jsxs("div",{className:"flex-1 space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsxs("div",{className:"text-xs font-medium",children:["Paso ",r+1," de ",ob.length,":"," ",f.jsx("span",{className:"text-orange-400",children:j4[r]})]}),f.jsx("div",{className:"w-1/3 h-2 bg-white/10 rounded-full overflow-hidden",children:f.jsx("div",{className:"h-full bg-orange-500 transition-all",style:{width:`${(r+1)/ob.length*100}%`}})})]}),f.jsx(ax,{mode:"wait",children:f.jsx(Ko.div,{initial:{opacity:0,x:40},animate:{opacity:1,x:0},exit:{opacity:0,x:-40},transition:{duration:.3,ease:"easeOut"},children:f.jsx(d,{customSelectStyles:xs})},r)}),f.jsxs("div",{className:"flex justify-between gap-2 mt-6",children:[r>0&&f.jsx("button",{type:"button",onClick:()=>l(P=>P-1),className:"w-full bg-white/10 border border-white/20 text-white py-3 rounded-lg font-semibold hover:bg-white/20 transition",children:"Atrás"}),f.jsx("button",{type:"submit",className:"w-full bg-orange-600 hover:bg-orange-700 text-white py-3 rounded-lg font-semibold transition",children:r===ob.length-1?n?"Actualizar Evento":"Crear Evento":"Siguiente"})]})]})]})})}function ZSe(){return f.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen p-2 gap-8",children:[f.jsx(Oa,{children:f.jsx("title",{children:"Crear Evento | Communidades"})}),f.jsxs("section",{className:"relative w-full max-w-5xl shadow-xl rounded-2xl md:p-6 sm:p-16 space-y-6 overflow-hidden",style:{backgroundImage:`url(${up})`,backgroundSize:"cover",backgroundPosition:"center"},children:[f.jsx("div",{className:"absolute inset-0 bg-white/50 backdrop-blur-sm rounded-xl h-full"}),f.jsxs("div",{className:"relative z-10 space-y-6 grid gap-8 ",children:[f.jsxs("div",{className:"flex items-center justify-between gap-2 p-4",children:[f.jsxs("div",{className:"grid gap-8",children:[f.jsx("h1",{className:"text-2xl font-bold text-black flex items-center gap-2",children:"Crea un nuevo evento"}),f.jsx("p",{className:"text-gray-700  text-xs sm:text-base",children:"Organizá una experiencia única para tu comunidad, celebrá tus raíces y creá momentos que queden en la memoria de todos ✨"})]}),f.jsx("img",{src:Kc,alt:"Ilustración evento",className:"w-40 xl:w-60 opacity-90"})]}),f.jsx(IW,{})]})]}),f.jsxs("div",{className:"pt-6 text-center space-y-2",children:[f.jsxs("p",{className:"text-[#141C24] text-base font-medium flex justify-center items-center gap-2",children:[f.jsx("img",{src:Rm,alt:"Icono",className:"h-8 md:h-12"}),"Comparte experiencias únicas y hacé crecer tu comunidad latina en EE. UU."]}),f.jsx("p",{className:"  text-xs text-gray-600",children:"Cada evento es una oportunidad para conectar y celebrar juntos."})]})]})}function XSe(){var I,R,F,W,$,Z,ne,ie,ge;const{id:e}=Ec(),t=aa(),n=br(),r=ln(ae=>ae.auth.token),l=ln(ae=>ae.auth.usuario),[d,p]=V.useState(null),[a,b]=V.useState(!0),[T,E]=V.useState(null);V.useEffect(()=>{(async()=>{var se;try{const me=await fU(e);if(l.role!=="admin"&&me.organizer!==l.id&&((se=me.organizer)==null?void 0:se.id)!==l.id){E("Acceso no autorizado");return}p(me.event)}catch(me){console.error(me),E("Error al cargar evento")}finally{b(!1)}})()},[e,l]);const P=async(ae,{setSubmitting:se})=>{try{const me=new FormData;ae.image instanceof File?me.append("featuredImage",ae.image):typeof ae.image=="string"&&ae.image.trim()&&me.append("featuredImage",ae.image.trim());const ke=Array.isArray(ae.images)?ae.images:[],qe=ke.filter(Tt=>typeof Tt=="string");ke.filter(Tt=>Tt instanceof File).forEach(Tt=>me.append("images",Tt));const nt=ae.tags?ae.tags.split(",").map(Tt=>Tt.trim()).filter(Boolean):[],bt=typeof ae.organizer=="object"&&ae.organizer?ae.organizer.value||ae.organizer._id||"":ae.organizer||"",jt=typeof ae.organizer=="object"&&ae.organizer?ae.organizer.model:ae.organizerModel,Nt=String(bt||""),vt=jt||"User";let He={...ae.location||{}};ae.isOnline?He={address:"",city:"",state:"",zipCode:"",country:He.country||"USA"}:He!=null&&He.coordinates&&delete He.coordinates;const ut={title:ae.title,description:ae.description,date:ae.date,time:ae.time,location:He,communities:(ae.communities||[]).map(String),businesses:(ae.businesses||[]).map(String),categories:(ae.categories||[]).map(String),tags:nt,language:ae.language||"es",price:Number(ae.price||0),isFree:!!ae.isFree,isOnline:!!ae.isOnline,status:ae.status||"activo",featured:!!ae.featured,isPublished:!!ae.isPublished,registrationLink:ae.registrationLink||"",sponsors:(ae.sponsors||[]).map(String),organizer:Nt,organizerModel:vt,existingImages:qe};ae.isOnline&&ae.virtualLink&&(ut.virtualLink=ae.virtualLink),ae.coordinates&&(ut.coordinates=ae.coordinates),me.append("data",JSON.stringify(ut)),await n(Zre({id:e,formData:me,token:r})).unwrap(),n(Jt({message:"✅ Evento actualizado exitosamente",type:"success"})),t("/dashboard/mis-eventos")}catch(me){n(Jt({message:(me==null?void 0:me.message)||"❌ No se pudo actualizar el evento",type:"error"}))}finally{se(!1)}};return a?f.jsx("div",{className:"p-4",children:"Cargando evento..."}):T?f.jsx("div",{className:"p-4 text-red-600",children:T}):d?f.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen px-2 gap-8 lg:mt-16",children:[f.jsx(Oa,{children:f.jsx("title",{children:"Editar Evento | Communidades"})}),f.jsxs("section",{className:"relative w-full max-w-5xl shadow-xl rounded-2xl  sm:p-16 space-y-6 overflow-hidden",style:{backgroundImage:`url(${up})`,backgroundSize:"cover",backgroundPosition:"center"},children:[f.jsx("div",{className:"absolute inset-0 bg-white/50 backdrop-blur-sm rounded-xl h-full z-0"}),f.jsx("div",{className:"relative z-10 space-y-6 grid gap-8",children:f.jsxs("div",{className:"flex items-center justify-between p-4 gap-2",children:[f.jsxs("div",{className:"grid gap-8",children:[f.jsx("h1",{className:"text-2xl font-bold text-black flex items-center gap-2",children:"Poné al día tu evento"}),f.jsx("p",{className:"text-gray-700  text-xs sm:text-base",children:"Editá la información de tu evento para mantener a tu comunidad al tanto de cada detalle y asegurarte de que nadie se lo pierda."})]}),f.jsx("img",{src:Kc,alt:"Communities Logo",className:"w-40 xl:w-60 opacity-90"})]})}),f.jsx(IW,{onSubmit:P,modoEdicion:!0,initialValues:{title:d.title||"",description:d.description||"",date:((I=d.date)==null?void 0:I.slice(0,10))||"",time:d.time||"",location:d.location||"",image:d.featuredImage||"",images:Array.isArray(d.images)?d.images:[],categories:((R=d.categories)==null?void 0:R.map(ae=>ae._id||ae))||[],communities:((F=d.communities)==null?void 0:F.map(ae=>ae._id||ae))||[],businesses:((W=d.businesses)==null?void 0:W.map(ae=>ae._id||ae))||[],tags:Array.isArray(d.tags)?d.tags.join(", "):"",language:d.language||"es",isFree:d.isFree??!0,price:d.price??0,isOnline:d.isOnline??!1,virtualLink:d.virtualLink||"",registrationLink:d.registrationLink||"",sponsors:(($=d.sponsors)==null?void 0:$.map(ae=>ae._id||ae))||[],status:d.status||"activo",featured:d.featured??!1,isPublished:d.isPublished??!1,organizer:{value:((Z=d.organizer)==null?void 0:Z._id)||((ne=d.organizer)==null?void 0:ne.id)||"",model:((ie=d.organizer)==null?void 0:ie.__t)||"User"},organizerModel:((ge=d.organizer)==null?void 0:ge.__t)||"User",coordinates:d.coordinates||null}})]}),f.jsxs("div",{className:"pt-6 text-center space-y-2",children:[f.jsxs("p",{className:"text-[#141C24] text-base font-medium flex justify-center items-center gap-2",children:[f.jsx("img",{src:Rm,alt:"Icono",className:"h-8 md:h-12"}),"Actualiza tu evento y seguí fortaleciendo tu comunidad"]}),f.jsx("p",{className:"  text-xs text-gray-600",children:"Cada cambio es una nueva oportunidad para conectar."})]})]}):f.jsx("div",{className:"p-4",children:"Evento no encontrado."})}function KSe({categoria:e,onSelect:t}){const{name:n,description:r,icon:l}=e;return f.jsxs("div",{onClick:()=>t(e),className:`\r
        group relative bg-white rounded-lg shadow hover:shadow-lg transition overflow-hidden border border-gray-200 min-h-[10rem] flex flex-col cursor-pointer\r
      `,children:[f.jsx("div",{className:"w-full h-28 overflow-hidden bg-gray-50",children:l?f.jsx("img",{src:l,alt:n,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"}):f.jsx("div",{className:"flex items-center justify-center w-full h-full text-gray-400  text-xs",children:"Sin imagen"})}),f.jsx("div",{className:"flex flex-col gap-2 p-2 flex-grow h-[3.5rem]",children:f.jsx("h3",{className:`\r
     text-xs font-semibold text-gray-700\r
    line-clamp-2 leading-snug  overflow-hidden\r
  `,children:n})})]})}function pF({categoria:e,onClose:t,onDelete:n}){const[r,l]=V.useState(!1);return e?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:`\r
          relative\r
          w-full\r
          bg-gradient-to-br from-gray-50 via-white to-gray-100\r
          rounded-2xl\r
          shadow-lg\r
          p-4 lg:p-8 xl:p-10\r
          border border-gray-200\r
          min-h-[260px]\r
          max-h-[80vh]\r
          overflow-y-auto\r
        `,children:[t&&f.jsx("button",{onClick:t,className:"md:hidden absolute -top-0.5 right-4 text-gray-900 hover:text-black  text-xs",children:"Cerrar"}),f.jsxs("div",{className:"relative w-full flex flex-col xl:flex-row gap-6",children:[f.jsx("div",{className:"w-full xl:w-60 flex-shrink-0 self-center lg:self-start",children:e.icon?f.jsx("img",{src:e.icon,alt:e.name,className:"w-full h-20 md:h-60 object-cover rounded-xl"}):f.jsx("div",{className:"w-full h-20 md:h-60 flex items-center justify-center bg-gray-100 rounded-xl text-3xl",children:"🏷️"})}),f.jsxs("div",{className:"flex-1 flex flex-col gap-4 justify-between",children:[f.jsx("h2",{className:"text-2xl font-extrabold text-[#141C24] tracking-tight leading-snug",children:e.name}),f.jsx("p",{className:"text-gray-700 text-xs md:text-md leading-relaxed whitespace-pre-line",children:e.description}),f.jsxs("div",{className:"flex flex-wrap gap-1 md:gap-4 text-xs text-gray-500 mt-2",children:[f.jsxs("span",{children:["Creado: ",new Date(e.createdAt).toLocaleDateString()]}),f.jsx("span",{children:new Date(e.updatedAt).toLocaleDateString()})]}),f.jsxs("div",{className:"flex flex-row flex-wrap gap-2 mt-4",children:[f.jsxs(Wn,{to:`/dashboard-admin/mis-categorias/${e._id}/editar`,className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium no-underline",children:[f.jsx(Hw,{className:"text-lg"}),"Editar categoría"]}),f.jsxs("button",{onClick:()=>l(!0),className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-white items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-red-500 hover:bg-red-700 transition text-xs font-medium",children:[f.jsx(Bw,{className:"text-lg"}),"Eliminar categoría"]})]})]})]})]}),r&&f.jsx(cp,{open:r,onClose:()=>l(!1),onConfirm:()=>{n(e._id),l(!1),t&&t()},entityName:e.name,title:"Eliminar categoría",description:"Para confirmar, escribe el nombre exacto de la categoría:"})]}):null}function mF(){const[e,t]=V.useState(null),[n,r]=V.useState(!1),l=br(),d=V.useRef(null),p=ln(R=>R.auth.usuario),{data:a=[],loading:b,error:T,loaded:E}=ln(R=>R.categorias);V.useEffect(()=>{(p==null?void 0:p.role)==="admin"&&!E&&l(Em())},[p,E,l]),V.useEffect(()=>{Array.isArray(a)&&a.length>0&&!e&&t((a==null?void 0:a[0])??null)},[a,e]);const P=R=>{t(R),window.innerWidth<768?r(!0):setTimeout(()=>{var F;(F=d.current)==null||F.scrollIntoView({behavior:"smooth",block:"start"})},100)},I=async R=>{try{await gie(R);const F=a.filter(W=>W._id!==R);t(F[0]||null),r(!1)}catch{l(Jt({message:"Error al eliminar categoría",type:"error"}))}};return b?f.jsx(My,{}):T?f.jsx("div",{className:"p-4 text-red-600",children:T}):f.jsxs("div",{className:"max-w-[1200px] w-full mx-auto flex flex-col gap-8 md:gap-12 xl:gap-16 px-2",children:[f.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 md:gap-8 xl:gap-10 lg:mt-16",children:[f.jsx("div",{className:"flex-1",children:f.jsx(px,{icon:"🏷️",title:"Tus categorías",badge:"Tu espacio de organización",description:"Crea, edita y organiza categorías para clasificar tu contenido.",illustration:Yh})}),f.jsx("div",{ref:d,className:"hidden md:flex flex-3 flex-col justify-center",children:e?f.jsx(pF,{categoria:e,onDelete:I}):f.jsxs("div",{className:"flex flex-col items-center justify-center bg-gradient-to-br from-gray-50 via-white to-gray-100 rounded-2xl shadow-lg p-6 md:p-8 xl:p-10 border border-gray-200 min-h-[260px] text-center",children:[f.jsx("p",{className:"text-gray-600  text-xs",children:"No hay ninguna categoría seleccionada."}),f.jsx("p",{className:"text-gray-500 text-xs mt-2",children:"Haz clic en una tarjeta de la lista para ver detalles aquí."})]})})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("hr",{className:"flex-grow border-gray-200"}),f.jsx("span",{className:"text-gray-400 text-xs uppercase tracking-wider",children:"Tus categorías"}),f.jsx("hr",{className:"flex-grow border-gray-200"})]}),f.jsxs("div",{className:"flex justify-between items-center mb-4 md:mb-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-[#141C24]",children:"Lista de categorías"}),f.jsxs(Wn,{to:"/dashboard-admin/mis-categorias/crear",className:"flex items-center gap-2 bg-black text-white px-3 py-2 rounded hover:bg-[#f4c753] hover:text-black transition  text-xs font-semibold",children:[f.jsx(w$,{className:"text-lg"}),f.jsx("p",{className:"hidden md:block",children:"Crear categoría"})]})]}),a.length===0?f.jsxs("div",{className:"flex flex-col items-center text-center gap-5 py-16",children:[f.jsx("img",{src:nx,alt:"Sin comunidades",className:"w-40 opacity-90"}),f.jsxs("p",{className:"text-gray-600  text-xs md:text-base max-w-xs",children:["Aún no has creado ninguna categoría.",f.jsx("br",{}),"Comparte tu cultura, conecta personas y haz crecer tu red."]}),f.jsx(Wn,{to:"/dashboard-admin/mis-categorias/crear",className:"inline-block bg-orange-500 hover:bg-orange-600 text-white  text-xs font-medium px-4 py-2 rounded transition",children:"Crear mi primera categoría"})]}):f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-y-5 gap-x-3 md:gap-6 xl:gap-8",children:a.map(R=>f.jsx("div",{onClick:()=>P(R),className:`transition rounded-lg cursor-pointer ${(e==null?void 0:e._id)===R._id?"border-blue-400 ring-2 ring-blue-200":"border-none"}`,children:f.jsx(KSe,{categoria:R})},R._id))}),n&&e&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4",onClick:()=>r(!1),children:f.jsx("div",{className:"relative w-full max-w-md max-h-[80vh] overflow-y-auto",onClick:R=>R.stopPropagation(),children:f.jsx(pF,{categoria:e,onClose:()=>r(!1),onDelete:I})})})]})}const YSe=li().shape({name:On().required("Nombre obligatorio"),description:On().required("Descripción obligatoria"),icon:ps().required("Icono obligatorio")});function QSe(){const e=ln(d=>d.auth.token),t=ln(d=>d.auth.usuario),n=aa(),r=br();if(t.role!=="admin")return f.jsx("div",{className:"p-4 text-red-600",children:"Acceso no autorizado"});const l=async(d,{setSubmitting:p})=>{try{const a=new FormData,b={name:d.name,description:d.description,createdBy:t._id};a.append("data",JSON.stringify(b)),d.icon&&typeof d.icon!="string"&&a.append("profileImage",d.icon),await pie(a,e),r(Jt({type:"success",message:"✅ Categoría creada correctamente"})),n("/dashboard/categorias")}catch{r(Jt({type:"error",message:"❌ Ocurrió un error al crear la categoría"}))}finally{p(!1)}};return f.jsxs(f.Fragment,{children:[f.jsx(Oa,{children:f.jsx("title",{children:"Nueva Categoría | Dashboard"})}),f.jsx("div",{className:"flex flex-col items-center justify-center md:px-4 ",children:f.jsx("section",{className:"w-full max-w-2xl shadow md:rounded-2xl p-4 md:p-8 space-y-6 bg-black/40 backdrop-blur-lg",children:f.jsx(ef,{initialValues:{name:"",description:"",icon:null},validationSchema:YSe,onSubmit:l,validateOnBlur:!1,validateOnChange:!1,children:({values:d,setFieldValue:p,isSubmitting:a})=>f.jsxs(Ud,{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Nombre"}),f.jsx(jn,{name:"name",placeholder:"Nombre de la categoría",className:"w-full px-4 py-3 border border-white/30 bg-white/10 rounded-lg placeholder:text-gray-300 text-white focus:outline-none"}),f.jsx(wn,{name:"name",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Descripción"}),f.jsx(jn,{as:"textarea",name:"description",placeholder:"Descripción breve",rows:3,className:"w-full px-4 py-3 border border-white/30 bg-white/10 rounded-lg placeholder:text-gray-300 text-white focus:outline-none"}),f.jsx(wn,{name:"description",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx(Zl,{value:d.icon,onChange:b=>p("icon",b),label:"Icono de la categoría"}),f.jsx(wn,{name:"icon",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsx("button",{type:"submit",disabled:a,className:"w-full bg-orange-600 hover:bg-orange-700 text-white py-3 rounded-lg font-semibold transition",children:a?"Creando...":"Crear Categoría"})]})})})})]})}function JSe(){return f.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen p-2  gap-8 md:mt-8 lg:mt-16",children:[f.jsx(Oa,{children:f.jsx("title",{children:"Crear Categoría | Communidades"})}),f.jsxs("section",{className:"relative w-full max-w-3xl shadow-xl rounded-2xl md:p-6 sm:p-16 space-y-6 overflow-hidden",style:{backgroundImage:`url(${up})`,backgroundSize:"cover",backgroundPosition:"center"},children:[f.jsx("div",{className:"absolute inset-0 bg-white/50 backdrop-blur-sm rounded-xl h-full"}),f.jsxs("div",{className:"relative space-y-6 grid gap-8",children:[f.jsxs("div",{className:"flex items-start justify-between gap-4 flex-wrap sm:flex-nowrap p-4",children:[f.jsxs("div",{className:"flex-1 space-y-2",children:[f.jsx("h1",{className:"text-2xl font-bold text-black",children:"Crear Categoría"}),f.jsx("p",{className:"text-gray-700  text-xs sm:text-base",children:"Crea nuevas categorías para organizar mejor los negocios, eventos y promociones de tu comunidad latina ✨"})]}),f.jsx("img",{src:Kc,alt:"Ilustración comunidad",className:"w-36 xl:w-52 opacity-90"})]}),f.jsx(QSe,{})]})]}),f.jsxs("div",{className:"pt-6 text-center space-y-2",children:[f.jsxs("p",{className:"text-[#141C24] text-base font-medium flex justify-center items-center gap-2",children:[f.jsx("img",{src:Rm,alt:"Icono",className:"h-8 md:h-12"}),"Las categorías ayudan a que los usuarios encuentren fácilmente lo que buscan."]}),f.jsx("p",{className:"  text-xs text-gray-600",children:"Cada categoría es una oportunidad de dar visibilidad a la cultura y los servicios de tu comunidad."})]})]})}const eTe=li().shape({name:On().required("Nombre obligatorio"),description:On().required("Descripción obligatoria"),icon:ps().required("Icono obligatorio")});function tTe(){const{id:e}=Ec(),t=aa(),n=ln(T=>T.auth.token),[r,l]=V.useState(null),[d,p]=V.useState(!0),a=br();if(V.useEffect(()=>{(async()=>{try{const E=await fie(e);l(E.category)}catch(E){console.error("Error al cargar categoría:",E)}finally{p(!1)}})()},[e]),!r)return f.jsx("div",{className:"p-4 text-red-600",children:"No se encontró la categoría."});const b=async(T,{setSubmitting:E})=>{try{const P=new FormData,I={name:T.name,description:T.description};P.append("data",JSON.stringify(I)),T.icon&&P.append("profileImage",T.icon),await mie(e,P,n),a(Jt({type:"success",message:"✅ Categoría actualizada correctamente"})),t("/dashboard/categorias")}catch{a(Jt({type:"error",message:"❌ Ocurrió un error al actualizar la categoría"}))}finally{E(!1)}};return f.jsxs(f.Fragment,{children:[f.jsx(Oa,{children:f.jsx("title",{children:"Editar Categoría | Dashboard"})}),f.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen md:px-4 mt-8 lg:mt-16",children:[f.jsxs("section",{className:"w-full max-w-2xl shadow-xl rounded-2xl relative sm:p-16 space-y-6 overflow-hidden",style:{backgroundImage:`url(${up})`,backgroundSize:"cover",backgroundPosition:"center"},children:[f.jsx("div",{className:"absolute inset-0 bg-white/50 backdrop-blur-sm rounded-xl z-0"}),f.jsxs("div",{className:"relative z-10 flex gap-2 items-start justify-between",children:[f.jsxs("div",{className:"space-y-2 grid",children:[f.jsx("h1",{className:"text-2xl font-bold text-[#141C24]",children:"Editar Categoría"}),f.jsx("p",{className:"text-gray-700  text-xs sm:text-base",children:"Actualiza los detalles de tu categoría para mantener tu catálogo organizado ✨"})]}),f.jsx("img",{src:Kc,alt:"Ilustración comunidad",className:"w-36 xl:w-52 opacity-90"})]}),f.jsx("section",{className:"relative z-10 w-full max-w-2xl shadow rounded-2xl p-6 md:p-8 space-y-6 bg-black/40 backdrop-blur-lg",children:d?f.jsx(T3,{}):f.jsx(ef,{initialValues:{name:r.name,description:r.description||"",icon:r.icon||""},validationSchema:eTe,onSubmit:b,validateOnBlur:!1,validateOnChange:!1,children:({values:T,setFieldValue:E,isSubmitting:P})=>f.jsxs(Ud,{className:"space-y-6 text-white",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Nombre"}),f.jsx(jn,{name:"name",placeholder:"Nombre de la categoría",className:"w-full px-4 py-3 border border-white/30 bg-white/10 rounded-lg placeholder:text-gray-300 text-white focus:outline-none"}),f.jsx(wn,{name:"name",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Descripción"}),f.jsx(jn,{as:"textarea",name:"description",placeholder:"Descripción breve",rows:3,className:"w-full px-4 py-3 border border-white/30 bg-white/10 rounded-lg placeholder:text-gray-300 text-white focus:outline-none"}),f.jsx(wn,{name:"description",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx(Zl,{value:T.icon,onChange:I=>E("icon",I),label:"Icono de la categoría"}),f.jsx(wn,{name:"icon",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsx("button",{type:"submit",disabled:P,className:"w-full bg-orange-600 hover:bg-orange-700 text-white py-3 rounded-lg font-semibold transition",children:P?"Guardando...":"Guardar cambios"})]})})})]}),f.jsxs("div",{className:"pt-6 text-center",children:[f.jsx("p",{className:"text-[#141C24] text-base font-medium",children:"🌟 Mantén tu catálogo actualizado y profesional."}),f.jsx("p",{className:"  text-xs text-gray-600",children:"Las categorías ayudan a tus usuarios a encontrar lo que buscan fácilmente."})]})]})]})}function nTe({comunidad:e,onSelect:t}){const{_id:n,name:r="Nombre comunidad",flagImage:l,bannerImage:d,language:p="es"}=e,a=d||l||`https://cdn.usegalileo.ai/sdxl10/${n||"default"}.png`;return f.jsxs("div",{onClick:()=>t(e),className:`\r
        group relative bg-white rounded-lg shadow hover:shadow-lg transition overflow-hidden border border-gray-200 min-h-[10rem] flex flex-col cursor-pointer\r
      `,children:[f.jsx("div",{className:"w-full h-28 overflow-hidden bg-gray-50",children:f.jsx("img",{src:a,alt:r,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"})}),f.jsx("div",{className:"flex flex-col gap-2 p-2 h-[3.2rem] flex-grow",children:f.jsx("h3",{className:`\r
             text-xs font-semibold text-gray-700\r
            \r
            flex items-start md:items-center\r
          `,children:r})})]})}function gF({comunidad:e,onClose:t,onDelete:n}){const[r,l]=V.useState(!1);return e?f.jsxs("div",{className:`\r
        relative\r
        w-full\r
        bg-gradient-to-br from-gray-50 via-white to-gray-100\r
        rounded-2xl\r
        shadow-lg\r
        p-4 lg:p-8 xl:p-10\r
        border border-gray-200\r
        min-h-[260px]\r
        max-h-[80vh]\r
        overflow-y-auto\r
      `,children:[t&&f.jsx("button",{onClick:t,className:"md:hidden absolute -top-0.5 right-4 text-gray-900 hover:text-black  text-xs",children:"Cerrar"}),f.jsxs("div",{className:"relative w-full flex flex-col xl:flex-row gap-6",children:[f.jsx("div",{className:"w-full xl:w-60 flex-shrink-0",children:f.jsx("img",{src:e.bannerImage||e.flagImage||`https://cdn.usegalileo.ai/sdxl10/${e._id}.png`,alt:e.name,className:"w-full h-20 md:h-60 object-cover rounded-xl"})}),f.jsxs("div",{className:"flex-1 flex flex-col gap-4 justify-between",children:[f.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3 flex-wrap",children:[f.jsx("h2",{className:"text-2xl font-extrabold text-[#141C24] tracking-tight leading-snug",children:e.name}),e.status&&f.jsx("span",{className:"inline-flex items-center gap-1 bg-black text-white text-xs font-semibold px-2 py-1 rounded-full",children:e.status})]}),f.jsx("p",{className:"text-gray-700 text-xs md:text-md leading-relaxed whitespace-pre-line",children:e.description}),f.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-gray-600 mt-1",children:[e.region&&f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(lF,{className:"w-4 h-4 text-gray-500"}),f.jsxs("span",{children:["Región: ",e.region]})]}),e.language&&f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(fce,{className:"w-4 h-4 text-gray-500"}),f.jsxs("span",{children:["Idioma: ",e.language.toUpperCase()]})]})]}),f.jsxs("div",{className:"flex flex-wrap gap-1 md:gap-4 text-xs text-gray-500 mt-2",children:[f.jsxs("span",{children:["Creado: ",new Date(e.createdAt).toLocaleDateString()]}),f.jsxs("span",{children:["Actualizado: ",new Date(e.updatedAt).toLocaleDateString()]})]}),f.jsxs("div",{className:"flex flex-row flex-wrap gap-2 mt-4",children:[f.jsxs(Wn,{to:`/dashboard-admin/mis-comunidades/${e._id}`,className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium no-underline",children:[f.jsx($N,{className:"text-lg"}),"Ver detalle privado"]}),f.jsxs(Wn,{to:`/dashboard-admin/mis-comunidades/${e._id}/editar`,className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium no-underline",children:[f.jsx(Hw,{className:"text-lg"}),"Editar comunidad"]}),f.jsxs(Wn,{to:`/comunidades/${e._id}`,className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium no-underline",children:[f.jsx(lF,{className:"text-lg"}),"Perfil público"]}),f.jsxs("button",{onClick:()=>l(!0),className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-white items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-red-500 hover:bg-red-700 transition text-xs font-medium",children:[f.jsx(Bw,{className:"text-lg"}),"Eliminar comunidad"]})]})]})]}),f.jsx(cp,{open:r,onClose:()=>l(!1),onConfirm:()=>{l(!1),n(e._id)},entityName:e.name,title:"Eliminar comunidad",description:"Para confirmar, escribe el nombre exacto de la comunidad:"})]}):null}function xF(){const e=br(),t=aa(),{usuario:n}=ln(F=>F.auth),{misComunidades:r,loadingMis:l,error:d}=ln(F=>F.comunidades),p=["admin","business_owner"].includes(n==null?void 0:n.role);V.useEffect(()=>{p||t("/")},[p,t]);const[a,b]=V.useState(null),[T,E]=V.useState(!1),P=V.useRef(null);V.useEffect(()=>{p&&r.length===0&&e(Cb())},[e,p,r.length]),V.useEffect(()=>{r.length>0&&!a&&b((r==null?void 0:r[0])??null)},[r,a]);const I=F=>{b(F),window.innerWidth<768?E(!0):setTimeout(()=>{var W;(W=P.current)==null||W.scrollIntoView({behavior:"smooth",block:"start"})},100)},R=async F=>{try{e(Jt({message:"Comunidad eliminada",type:"success"}))}catch{e(Jt({message:"No se pudo eliminar la comunidad.",type:"success"}))}};return p?l?f.jsx(My,{}):d?f.jsx("div",{className:"p-4 text-red-600",children:d}):f.jsxs("div",{className:"max-w-[1200px] w-full mx-auto flex flex-col gap-8 md:gap-12 xl:gap-16 px-2",children:[f.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 md:gap-8 xl:gap-10 lg:mt-16",children:[f.jsx("div",{className:"flex-1",children:f.jsx(px,{icon:"🌍",title:"Tus comunidades",badge:"Tu espacio de conexión",description:"Aquí puedes gestionar, actualizar y compartir tus comunidades con el mundo.",illustration:Yh})}),a&&f.jsx("div",{ref:P,className:"hidden md:flex flex-3 flex-col justify-center",children:f.jsx(gF,{comunidad:a,onDelete:R})})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("hr",{className:"flex-grow border-gray-200"}),f.jsx("span",{className:"text-gray-400 text-xs uppercase tracking-wider",children:"Tus comunidades"}),f.jsx("hr",{className:"flex-grow border-gray-200"})]}),f.jsxs("div",{className:"flex justify-between items-center mb-4 md:mb-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-[#141C24]",children:"Lista de comunidades"}),f.jsxs(Wn,{to:"crear",className:"flex items-center gap-2 bg-black text-white px-3 py-2 rounded hover:bg-[#f4c753] hover:text-black transition  text-xs font-semibold",children:[f.jsx(VT,{className:"text-lg"}),f.jsx("p",{className:"hidden md:block",children:"Crear comunidad"})]})]}),r.length===0?f.jsxs("div",{className:"flex flex-col items-center text-center gap-5 py-16",children:[f.jsx("img",{src:nx,alt:"Sin comunidades",className:"w-40 opacity-90"}),f.jsxs("p",{className:"text-gray-600  text-xs md:text-base max-w-xs",children:["Aún no has creado ninguna comunidad.",f.jsx("br",{}),"Comparte tu cultura, conecta personas y haz crecer tu red."]}),f.jsx(Wn,{to:"/dashboard-admin/mis-comunidades/crear",className:"inline-block bg-orange-500 hover:bg-orange-600 text-white  text-xs font-medium px-4 py-2 rounded transition",children:"Crear mi primera comunidad"})]}):f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-y-5 gap-x-3 md:gap-6 xl:gap-8",children:r.map(F=>f.jsx("div",{onClick:()=>I(F),className:`transition rounded-lg cursor-pointer ${(a==null?void 0:a._id)===F._id?"border-blue-400 ring-2 ring-blue-200":"border-none"}`,children:f.jsx(nTe,{comunidad:F})},F._id))}),T&&a&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4",onClick:()=>E(!1),children:f.jsx("div",{className:"relative w-full max-w-md max-h-[80vh] overflow-y-auto",onClick:F=>F.stopPropagation(),children:f.jsx(gF,{comunidad:a,onClose:()=>E(!1),onDelete:R})})})]}):null}const yF=[{value:"migrante",label:"Migrante"},{value:"cultural",label:"Cultural"},{value:"social",label:"Social"}];function rTe(){return f.jsxs("div",{className:"space-y-5",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Nombre de la comunidad"}),f.jsx(jn,{name:"name",placeholder:"comunidad en usa",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"name",component:"div",className:"text-red-400 text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Descripción"}),f.jsx(jn,{name:"description",as:"textarea",placeholder:"Una comunidad para compartir eventos, negocios y cultura.",className:"w-full h-40 lg:h-70 px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none min-h-[100px] "}),f.jsx(wn,{name:"description",component:"div",className:"text-red-400 text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Idioma"}),f.jsx(jn,{name:"language",placeholder:"es",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"language",component:"div",className:"text-red-400 text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Tipo de comunidad"}),f.jsx(jn,{name:"tipo",children:({field:e,form:t})=>f.jsx(gs,{menuPlacement:"top",styles:xs,options:yF,placeholder:"Selecciona el tipo...",value:yF.find(n=>n.value===e.value)||null,onChange:n=>t.setFieldValue("tipo",n.value)})}),f.jsx(wn,{name:"tipo",component:"div",className:"text-red-400 text-xs mt-1"})]})]})}function iTe(){var n;const{values:e,setFieldValue:t}=mo();return f.jsxs("div",{className:"space-y-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-[#141C24]",children:"País de origen"}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Nombre"}),f.jsx(jn,{name:"originCountryInfo.name",placeholder:"Usa",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"}),f.jsx(wn,{name:"originCountryInfo.name",component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Bandera"}),f.jsx(Zl,{value:((n=e.originCountryInfo)==null?void 0:n.flag)||"",onChange:r=>t("originCountryInfo.flag",r),label:"Bandera"}),f.jsx(wn,{name:"originCountryInfo.flag",component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Capital"}),f.jsx(jn,{name:"originCountryInfo.capital",placeholder:"Bs As",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"}),f.jsx(wn,{name:"originCountryInfo.capital",component:"div",className:"text-red-500  text-xs mt-1"})]})]}),f.jsx("h3",{className:"text-lg font-semibold text-[#141C24]",children:"Tradiciones"}),f.jsx(mw,{name:"traditions",children:({push:r,remove:l})=>{var d;return f.jsxs("div",{className:"space-y-4",children:[(d=e.traditions)==null?void 0:d.map((p,a)=>f.jsxs("div",{className:"flex gap-2 items-center",children:[f.jsx(jn,{name:`traditions[${a}]`,placeholder:"Carnaval",className:"form-input flex-1 h-12 px-4 rounded-xl border border-gray-300"}),f.jsx("button",{type:"button",onClick:()=>l(a),className:"text-red-500  text-xs",children:"Eliminar"})]},a)),f.jsx("button",{type:"button",onClick:()=>r(""),className:"btn btn-secondary",children:"Agregar tradición"})]})}}),f.jsx("h3",{className:"text-lg font-semibold text-[#141C24]",children:"Gastronomía"}),f.jsx(mw,{name:"food",children:({push:r,remove:l})=>{var d;return f.jsxs("div",{className:"space-y-6",children:[(d=e.food)==null?void 0:d.map((p,a)=>f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 border-b pb-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"  text-xs font-medium",children:"Nombre"}),f.jsx(jn,{name:`food[${a}].name`,placeholder:"tacos",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"  text-xs font-medium",children:"Descripción"}),f.jsx(jn,{name:`food[${a}].description`,placeholder:"Típico alimento a base de maíz",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"  text-xs font-medium",children:"Imagen"}),f.jsx(Zl,{value:(p==null?void 0:p.image)||"",onChange:b=>t(`food[${a}].image`,b),label:`Imagen del plato ${a+1}`})]}),f.jsx("div",{className:"col-span-full",children:f.jsx("button",{type:"button",onClick:()=>l(a),className:"text-red-500  text-xs mt-2",children:"Eliminar plato"})})]},a)),f.jsx("button",{type:"button",onClick:()=>r({name:"",description:"",image:""}),className:"btn btn-secondary",children:"Agregar plato típico"})]})}})]})}function aTe(){const{values:e}=mo();return f.jsxs("div",{className:"space-y-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-[#141C24]",children:"Recursos útiles"}),f.jsx(mw,{name:"resources",children:({push:t,remove:n})=>{var r;return f.jsxs("div",{className:"space-y-4",children:[(r=e.resources)==null?void 0:r.map((l,d)=>f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 items-start border-b pb-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Título"}),f.jsx(jn,{name:`resources[${d}].title`,placeholder:"",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"}),f.jsx(wn,{name:`resources[${d}].title`,component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"URL"}),f.jsx(jn,{name:`resources[${d}].url`,placeholder:"https://...",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"}),f.jsx(wn,{name:`resources[${d}].url`,component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Tipo"}),f.jsxs(jn,{name:`resources[${d}].type`,as:"select",className:"form-select w-full h-12 px-4 rounded-xl border border-gray-300",children:[f.jsx("option",{value:"",children:"Seleccionar"}),f.jsx("option",{value:"legal",children:"Legal"}),f.jsx("option",{value:"salud",children:"Salud"}),f.jsx("option",{value:"educación",children:"Educación"}),f.jsx("option",{value:"otros",children:"Otros"})]}),f.jsx(wn,{name:`resources[${d}].type`,component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsx("div",{className:"col-span-full",children:f.jsx("button",{type:"button",onClick:()=>n(d),className:"text-red-500  text-xs",children:"Eliminar recurso"})})]},d)),f.jsx("button",{type:"button",onClick:()=>t({title:"",url:"",type:""}),className:"btn btn-secondary",children:"Agregar recurso"})]})}}),f.jsx("h3",{className:"text-lg font-semibold text-[#141C24] pt-6",children:"Redes sociales"}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Facebook"}),f.jsx(jn,{name:"socialMediaLinks.facebook",placeholder:"https://facebook.com/...",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Instagram"}),f.jsx(jn,{name:"socialMediaLinks.instagram",placeholder:"https://instagram.com/...",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"WhatsApp"}),f.jsx(jn,{name:"socialMediaLinks.whatsapp",placeholder:"=1 9 00 233...",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"YouTube"}),f.jsx(jn,{name:"socialMediaLinks.youtube",placeholder:"https://youtube.com/...",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"})]})]})]})}function sTe(){return f.jsxs("div",{className:"space-y-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-[#141C24]",children:"Región de la comunidad"}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-[#141C24] mb-1",children:"Región / Área"}),f.jsx(jn,{name:"region",placeholder:"Ej: DFW, NYC, South Florida...",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"}),f.jsx(wn,{name:"region",component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsx("h3",{className:"text-lg font-semibold text-[#141C24]",children:"Dirección general de la comunidad"}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Dirección"}),f.jsx(jn,{name:"location.address",placeholder:"Calle 123",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"}),f.jsx(wn,{name:"location.address",component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Ciudad"}),f.jsx(jn,{name:"location.city",placeholder:"Dallas",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"}),f.jsx(wn,{name:"location.city",component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Estado"}),f.jsx(jn,{name:"location.state",placeholder:"Texas",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"}),f.jsx(wn,{name:"location.state",component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Código postal"}),f.jsx(jn,{name:"location.zipCode",placeholder:"75201",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"}),f.jsx(wn,{name:"location.zipCode",component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"País"}),f.jsx(jn,{name:"location.country",placeholder:"Estados Unidos",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"}),f.jsx(wn,{name:"location.country",component:"div",className:"text-red-500  text-xs mt-1"})]})]}),f.jsx("h3",{className:"text-lg font-semibold text-[#141C24] pt-4",children:"Centro del mapa (opcional)"}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Latitud"}),f.jsx(jn,{name:"mapCenter.lat",placeholder:"Ej: 32.7767",type:"number",step:"any",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"}),f.jsx(wn,{name:"mapCenter.lat",component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Longitud"}),f.jsx(jn,{name:"mapCenter.lng",placeholder:"Ej: -96.7970",type:"number",step:"any",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"}),f.jsx(wn,{name:"mapCenter.lng",component:"div",className:"text-red-500  text-xs mt-1"})]})]})]})}function oTe(){const{setFieldValue:e,values:t}=mo(),n=[{value:"Publicada",label:"Publicada"},{value:"Pendiente",label:"Pendiente"},{value:"Inactiva",label:"Inactiva"}];return f.jsxs("div",{className:"space-y-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-white",children:"SEO y visibilidad"}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Meta título"}),f.jsx(jn,{name:"metaTitle",placeholder:"Comunidad en DFW",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none"}),f.jsx(wn,{name:"metaTitle",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Meta descripción"}),f.jsx(jn,{as:"textarea",name:"metaDescription",placeholder:"Conecta con migrantes, negocios locales, eventos y más en USA.",className:"w-full px-4 py-3 border border-white/40 bg-white/10 rounded-lg placeholder:text-gray-300 focus:outline-none min-h-[100px]"}),f.jsx(wn,{name:"metaDescription",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Estado de publicación"}),f.jsx(gs,{menuPlacement:"top",name:"status",options:n,placeholder:"Selecciona el estado...",styles:xs,value:n.find(r=>r.value===t.status)||null,onChange:r=>e("status",r.value)}),f.jsx(wn,{name:"status",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(jn,{type:"checkbox",name:"isVerified",className:"form-checkbox border-white/40 bg-white/10 text-orange-500 focus:ring-0 focus:outline-none"}),f.jsx("label",{className:"  text-xs text-white",children:"Marcar como verificada"})]})]})}function lTe(){const{values:e,setFieldValue:t}=mo();return f.jsxs("div",{className:"space-y-6",children:[f.jsx("h3",{className:"text-2xl font-bold text-[#141C24]",children:"Imágenes"}),f.jsx(Zl,{value:e.flagImage,onChange:n=>t("flagImage",n),label:"Bandera de la comunidad (formato JPG, PNG o WEBP)"}),f.jsx(wn,{name:"flagImage",component:"div",className:"text-red-500  text-xs"}),f.jsx(Zl,{value:e.bannerImage,onChange:n=>t("bannerImage",n),label:"Imagen destacada o banner principal"}),f.jsx(wn,{name:"bannerImage",component:"div",className:"text-red-500  text-xs"})]})}function cTe(){var t,n,r,l,d,p,a,b,T,E,P;const{values:e}=mo();return f.jsxs("div",{className:"space-y-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-green-200",children:"Revisión final de la comunidad"}),f.jsx("p",{className:"  text-xs text-gray-100",children:"Asegúrate de que toda la información sea correcta antes de crear la comunidad. Aquí tienes un resumen de los datos que has ingresado:"}),f.jsxs("div",{className:"bg-black/20 p-4 rounded-xl  text-xs space-y-2 ",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Nombre:"})," ",e.name]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Descripción:"})," ",e.description]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Idioma:"})," ",e.language||"es"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Tipo:"})," ",e.tipo]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Slug:"})," ",e.slug||"(se generará automáticamente)"]}),((t=e.contact)==null?void 0:t.email)&&f.jsxs("p",{children:[f.jsx("strong",{children:"Email:"})," ",e.contact.email]}),((n=e.contact)==null?void 0:n.phone)&&f.jsxs("p",{children:[f.jsx("strong",{children:"Teléfono:"})," ",e.contact.phone]}),((r=e.contact)==null?void 0:r.website)&&f.jsxs("p",{children:[f.jsx("strong",{children:"Sitio web:"})," ",e.contact.website]}),f.jsx("p",{children:f.jsx("strong",{children:"Ubicación:"})}),f.jsxs("ul",{className:"ml-4 list-disc",children:[f.jsxs("li",{children:[(l=e.location)==null?void 0:l.address,", ",(d=e.location)==null?void 0:d.city]}),f.jsxs("li",{children:[(p=e.location)==null?void 0:p.state,", ",(a=e.location)==null?void 0:a.zipCode,","," ",(b=e.location)==null?void 0:b.country]})]}),((T=e.tags)==null?void 0:T.length)>0&&f.jsxs("p",{children:[f.jsx("strong",{children:"Etiquetas:"})," ",e.tags.join(", ")]}),e.isVerified&&f.jsx("p",{className:"text-green-600 font-medium",children:"✅ Comunidad marcada como verificada"}),((E=e.culturalResources)==null?void 0:E.length)>0&&f.jsxs(f.Fragment,{children:[f.jsx("p",{children:f.jsx("strong",{children:"Recursos culturales:"})}),f.jsx("ul",{className:"ml-4 list-disc",children:e.culturalResources.map((I,R)=>f.jsx("li",{children:I},R))})]}),((P=e.usefulLinks)==null?void 0:P.length)>0&&f.jsxs(f.Fragment,{children:[f.jsx("p",{children:f.jsx("strong",{children:"Enlaces útiles:"})}),f.jsx("ul",{className:"ml-4 list-disc",children:e.usefulLinks.map((I,R)=>f.jsx("li",{children:f.jsx("a",{href:I,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:I})},R))})]})]}),f.jsxs("p",{className:"  text-xs text-gray-100",children:["Si todo está correcto, haz clic en ",f.jsx("strong",{children:"Crear comunidad"})," para finalizar."]})]})}const M4={name:"",description:"",language:"es",tipo:"migrante",originCountryInfo:{name:"",capital:"",flag:""},traditions:[],food:[],resources:[],socialMediaLinks:{facebook:"",instagram:"",whatsapp:"",youtube:""},externalLinks:[],region:"",mapCenter:{lat:"",lng:""},location:{address:"",city:"",state:"",zipCode:"",country:"",coordinates:{lat:"",lng:""}},flagImage:"",bannerImage:"",metaTitle:"",metaDescription:"",status:"Publicada",verified:!1},vF=[li({name:On().required("El nombre es obligatorio"),description:On().required("La descripción es obligatoria"),language:On().required("El idioma es obligatorio"),tipo:On().required("El tipo es obligatorio")}),li({originCountryInfo:li({name:On().required("El país de origen es obligatorio"),capital:On().required("La capital es obligatoria"),flag:ps().required("La bandera es obligatoria")}),traditions:bc().of(On().trim().required("La tradición no puede estar vacía")).min(1,"Agrega al menos una tradición"),food:bc().of(li({name:On().required("El nombre del plato es obligatorio"),description:On().required("La descripción es obligatoria"),image:ps().required("La imagen es obligatoria")}))}),li({resources:bc().of(li({title:On().required("El título es obligatorio"),url:On().url("Debe ser un enlace válido").required("La URL es obligatoria"),type:On().required("El tipo es obligatorio")})),socialMediaLinks:li({facebook:On().url("URL inválida").nullable(),instagram:On().url("URL inválida").nullable(),whatsapp:On().url("URL inválida").nullable(),youtube:On().url("URL inválida").nullable()})}),li({region:On().required("La región es obligatoria"),mapCenter:li({lat:kd().nullable().transform((e,t)=>t===""?null:e),lng:kd().nullable().transform((e,t)=>t===""?null:e)}),location:li({address:On().required("Dirección obligatoria"),city:On().required("Ciudad obligatoria"),state:On().required("Estado obligatorio"),zipCode:On().required("Código postal obligatorio"),country:On().required("País obligatorio"),coordinates:li({lat:kd().nullable().transform((e,t)=>t===""||isNaN(t)?null:e),lng:kd().nullable().transform((e,t)=>t===""||isNaN(t)?null:e)})})}),li({metaTitle:On().required("El meta título es obligatorio"),metaDescription:On().required("La meta descripción es obligatoria"),status:On().oneOf(["Publicada","Pendiente","Inactiva"]).required("El estado es obligatorio"),verified:Id()}),li({flagImage:ps().required("La bandera es obligatoria").test("is-valid","La bandera es inválida",e=>typeof e=="string"||typeof e=="object"),bannerImage:ps().required("La imagen de banner es obligatoria").test("is-valid","La imagen es inválida",e=>typeof e=="string"||typeof e=="object")}),li(),li({externalLinks:bc().of(li({title:On().required("El título es obligatorio"),url:On().url("Debe ser una URL válida").required("La URL es obligatoria"),type:On().oneOf(["facebook","instagram","whatsapp","otro"]).required("El tipo es obligatorio"),description:On().nullable()})).notRequired()})],_F=[{value:"facebook",label:"Facebook"},{value:"instagram",label:"Instagram"},{value:"whatsapp",label:"WhatsApp"},{value:"otro",label:"Otro"}];function uTe(){const{values:e,setFieldValue:t}=mo();return f.jsxs("div",{className:"space-y-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-[#141C24]",children:"Enlaces útiles externos"}),f.jsx(mw,{name:"externalLinks",children:({push:n,remove:r})=>{var l;return f.jsxs("div",{className:"space-y-4",children:[(l=e.externalLinks)==null?void 0:l.map((d,p)=>f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4 items-start border-b pb-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Título"}),f.jsx(jn,{name:`externalLinks[${p}].title`,placeholder:"Grupo de WhatsApp",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"}),f.jsx(wn,{name:`externalLinks[${p}].title`,component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"URL"}),f.jsx(jn,{name:`externalLinks[${p}].url`,placeholder:"https://...",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"}),f.jsx(wn,{name:`externalLinks[${p}].url`,component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Tipo"}),f.jsx(gs,{name:`externalLinks[${p}].type`,options:_F,className:"react-select-container",classNamePrefix:"react-select",placeholder:"Seleccionar",styles:xs,value:_F.find(a=>a.value===e.externalLinks[p].type),onChange:a=>t(`externalLinks[${p}].type`,a?a.value:"")}),f.jsx(wn,{name:`externalLinks[${p}].type`,component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium mb-1",children:"Descripción (opcional)"}),f.jsx(jn,{name:`externalLinks[${p}].description`,placeholder:"Grupo de ayuda para migrantes",className:"form-input w-full h-12 px-4 rounded-xl border border-gray-300"}),f.jsx(wn,{name:`externalLinks[${p}].description`,component:"div",className:"text-red-500  text-xs mt-1"})]}),f.jsx("div",{className:"col-span-full",children:f.jsx("button",{type:"button",onClick:()=>r(p),className:"text-red-500  text-xs",children:"Eliminar enlace"})})]},p)),f.jsx("button",{type:"button",onClick:()=>n({title:"",url:"",type:"",description:""}),className:"btn btn-secondary",children:"Agregar enlace"})]})}})]})}const P4=["Información Básica","Cultura y Origen","Recursos y Enlaces","Ubicación","SEO y Visibilidad","Imágenes","Resumen Final","Enlaces Externos"],Uv=[rTe,iTe,aTe,sTe,oTe,lTe,cTe,uTe];function kW({modoEdicion:e=!1,comunidadInicial:t=null}){const[n,r]=V.useState(0),l=aa(),d=ln(E=>E.auth.usuario),p=Uv[n],a=br(),b=async(E,{setSubmitting:P})=>{var I,R,F;try{const{flagImage:W,bannerImage:$,food:Z,originCountryInfo:ne,...ie}=E,ge=new FormData;W instanceof File&&ge.append("flagImage",W),$ instanceof File&&ge.append("bannerImage",$),(ne==null?void 0:ne.flag)instanceof File&&ge.append("originCountryFlag",ne.flag),Z.forEach((se,me)=>{se.image instanceof File&&ge.append(`foodImages[${me}]`,se.image)});const ae={...ie,originCountryInfo:{...ne,flag:(ne==null?void 0:ne.flag)instanceof File?"":ne==null?void 0:ne.flag},food:Z.map(se=>({name:se.name,description:se.description||"",...se.image instanceof File?{}:{image:se.image}})),owner:d.id};if((I=ae.location)!=null&&I.coordinates&&(ae.location.coordinates.lat=ae.location.coordinates.lat===""?null:ae.location.coordinates.lat,ae.location.coordinates.lng=ae.location.coordinates.lng===""?null:ae.location.coordinates.lng),((R=ae.mapCenter)==null?void 0:R.lat)!==void 0&&((F=ae.mapCenter)==null?void 0:F.lng)!==void 0){const se=ae.mapCenter.lat===""?null:Number(ae.mapCenter.lat),me=ae.mapCenter.lng===""?null:Number(ae.mapCenter.lng);ae.mapCenter={type:"Point",coordinates:[me,se]}}ge.append("data",JSON.stringify(ae)),e&&(t!=null&&t._id)?(await a(lie({id:t._id,formData:ge})).unwrap(),a(Jt({message:"✅ Comunidad actualizada correctamente",type:"success"}))):(await a(oie(ge)).unwrap(),a(Jt({message:"✅ Comunidad creada correctamente",type:"success"}))),l("/dashboard-admin/mis-comunidades")}catch(W){a(Jt({message:(W==null?void 0:W.message)||"❌ Ocurrió un error al guardar la comunidad",type:"error"}))}finally{P(!1)}},T=V.useMemo(()=>{var E,P,I;return!e||!t?M4:{...M4,...t,flagImage:t.flagImage??"",bannerImage:t.bannerImage??"",originCountryInfo:{...M4.originCountryInfo,...t.originCountryInfo,flag:((E=t.originCountryInfo)==null?void 0:E.flag)??""},food:((P=t.food)==null?void 0:P.map(R=>({name:R.name,description:R.description||"",image:R.image??""})))||[],externalLinks:((I=t.externalLinks)==null?void 0:I.map(R=>({title:R.title,url:R.url,type:R.type,description:R.description||""})))||[]}},[e,t]);return f.jsx(ef,{initialValues:T,enableReinitialize:!0,validationSchema:vF[n],onSubmit:(E,P)=>{n===Uv.length-1?b(E,P):r(I=>I+1)},validateOnBlur:!1,validateOnChange:!1,children:({validateForm:E,values:P,setErrors:I})=>f.jsxs(Ud,{className:"flex flex-col lg:flex-row gap-8 w-full max-w-5xl mx-auto p-4 md:p-8 bg-black/40 backdrop-blur-lg md:rounded-2xl shadow-2xl text-white",onKeyDown:R=>R.key==="Enter"&&R.preventDefault(),children:[f.jsx("div",{className:"flex flex-row lg:flex-col w-full lg:w-36 space-x-4 lg:space-x-0 lg:space-y-8",children:P4.map((R,F)=>f.jsxs("div",{className:"relative flex flex-col lg:flex-row lg:items-start items-center",children:[F!==P4.length-1&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"absolute lg:hidden left-full top-3 w-4 h-px bg-white/20"}),f.jsx("span",{className:"absolute hidden lg:block left-2.5 top-7 h-full w-px bg-white/20",style:{minHeight:"1.5rem"}})]}),f.jsx("div",{className:`flex items-center justify-center w-6 h-6 rounded-full border-2 shrink-0 ${n===F?"border-orange-500 bg-orange-500 text-black":n>F?"border-green-500 bg-green-500 text-black":"border-white/30 text-white"}`,children:n>F?"✓":F+1}),f.jsx("div",{className:"mt-2 text-xs lg:  text-xs hidden lg:block lg:ml-2",children:R})]},F))}),f.jsxs("div",{className:"flex-1 space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsxs("div",{className:"  text-xs font-medium",children:["Paso ",n+1," de ",Uv.length,":"," ",f.jsx("span",{className:"text-orange-400",children:P4[n]})]}),f.jsx("div",{className:"w-1/3 h-2 bg-white/10 rounded-full overflow-hidden",children:f.jsx("div",{className:"h-full bg-orange-500 transition-all",style:{width:`${(n+1)/Uv.length*100}%`}})})]}),f.jsx(ax,{mode:"wait",children:f.jsx(Ko.div,{initial:{opacity:0,x:40},animate:{opacity:1,x:0},exit:{opacity:0,x:-40},transition:{duration:.3,ease:"easeOut"},children:f.jsx(p,{customSelectStyles:xs})},n)}),f.jsxs("div",{className:"flex justify-between gap-2 mt-6",children:[n>0&&f.jsx("button",{type:"button",onClick:()=>r(R=>R-1),className:"w-full bg-white/10 border border-white/20 text-white py-3 rounded-lg font-semibold hover:bg-white/20 transition",children:"Atrás"}),n<Uv.length-1&&f.jsx("button",{type:"button",onClick:async()=>{const R=vF[n];try{await R.validate(P,{abortEarly:!1}),r(F=>F+1)}catch(F){const W={};F.inner&&F.inner.forEach($=>{W[$.path]=$.message}),I(W)}},className:"w-full bg-orange-600 hover:bg-orange-700 text-white py-3 rounded-lg font-semibold transition",children:"Siguiente"}),n===Uv.length-1&&f.jsx("button",{type:"submit",className:"w-full bg-orange-600 hover:bg-orange-700 text-white py-3 rounded-lg font-semibold transition",children:e?"Actualizar comunidad":"Crear comunidad"})]})]})]})})}function dTe(){const[e,t]=V.useState(!0);return V.useEffect(()=>{const n=setTimeout(()=>t(!1),100);return()=>clearTimeout(n)},[]),f.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen  md:px-4 gap-8",children:[f.jsx(Oa,{children:f.jsx("title",{children:"Crear Comunidad | Communidades"})}),f.jsxs("section",{className:"relative w-full max-w-5xl shadow-xl rounded-2xl  md:p-6 sm:p-16 space-y-6 overflow-hidden",style:{backgroundImage:`url(${up})`,backgroundSize:"cover",backgroundPosition:"center"},children:[f.jsx("div",{className:"absolute inset-0 bg-white/50 backdrop-blur-sm rounded-xl h-full"}),f.jsxs("div",{className:"relative z-10 space-y-6 grid gap-8",children:[f.jsxs("div",{className:"flex items-center justify-between gap-2 p-6",children:[f.jsxs("div",{className:"grid gap-8",children:[f.jsx("h1",{className:"text-2xl font-bold text-black flex items-center gap-2",children:"Crea tu espacio cultural"}),f.jsx("p",{className:"text-gray-700  text-xs sm:text-base",children:"Une a las personas, celebra tu cultura y comparte tu historia con el mundo 🌎"})]}),f.jsx("img",{src:Kc,alt:"Ilustración comunidad",className:"w-40 xl:w-60 opacity-90"})]}),e?f.jsx(T3,{}):f.jsx(kW,{})]})]}),f.jsxs("div",{className:"pt-6 text-center space-y-2",children:[f.jsxs("p",{className:"text-[#141C24] text-base font-medium flex justify-center items-center gap-2",children:[f.jsx("img",{src:Rm,alt:"Icono",className:"h-8 md:h-12"}),"Dale vida a tu comunidad y conecta a los latinos en EE. UU."]}),f.jsx("p",{className:"  text-xs text-gray-600",children:"Crea un espacio donde todos se sientan como en casa."})]})]})}function hTe(){const{id:e}=Ec(),t=br(),n=ln(d=>d.comunidades.comunidadActual),r=ln(d=>d.comunidades.loadingDetalle),l=ln(d=>d.comunidades.error);return V.useEffect(()=>{e&&t(QS(e))},[e,t]),l?f.jsx("p",{className:"text-center text-red-500 py-10",children:l}):n?f.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen gap-8 md:mt-8 lg:mt-16",children:[f.jsx(Oa,{children:f.jsx("title",{children:"Editar Comunidad | Communidades"})}),f.jsxs("section",{className:"relative w-full max-w-5xl shadow-xl rounded-2xl sm:p-16 space-y-6 overflow-hidden",style:{backgroundImage:`url(${up})`,backgroundSize:"cover",backgroundPosition:"center"},children:[f.jsx("div",{className:"absolute inset-0 bg-white/50 backdrop-blur-sm rounded-xl h-full"}),f.jsxs("div",{className:"relative z-10 space-y-6 grid gap-8",children:[f.jsxs("div",{className:"flex items-center justify-between p-4 gap-2",children:[f.jsxs("div",{className:"grid gap-8",children:[f.jsx("h1",{className:"text-2xl font-bold text-black flex items-center gap-2",children:"Refresca tu identidad local"}),f.jsx("p",{className:"text-gray-700  text-xs sm:text-base",children:"Une a las personas, celebra tu cultura y comparte tu historia con el mundo 🌎"})]}),f.jsx("img",{src:Kc,alt:"Ilustración comunidad",className:"w-40 xl:w-60 opacity-90"})]}),r&&f.jsx(T3,{}),f.jsx(kW,{modoEdicion:!0,comunidadInicial:n})," "]})]}),f.jsxs("div",{className:"pt-6 text-center space-y-2",children:[f.jsxs("p",{className:"text-[#141C24] text-base font-medium flex justify-center items-center gap-2 ",children:[f.jsx("img",{src:Rm,alt:"Icono",className:"h-8 md:h-12"}),"Dale vida a tu comunidad y conecta a los latinos en EE. UU."]}),f.jsx("p",{className:"  text-xs text-gray-600",children:"Crea un espacio donde todos se sientan como en casa."})]})]}):null}function fTe(){const e=ln(zP),t=ln(m$),n=yl();return e?f.jsx("div",{className:"w-full min-h-screen grid place-items-center",children:f.jsx(wy,{})}):t?f.jsx(t3,{}):f.jsx(c_,{to:"/login",replace:!0,state:{from:n}})}function pTe(){const e=ln(zP),t=ln(Foe),n=yl();return e?f.jsx("div",{className:"w-full min-h-screen grid place-items-center",children:f.jsx(wy,{})}):t?t.role!=="admin"?f.jsx(c_,{to:"/dashboard",replace:!0}):f.jsx(t3,{}):f.jsx(c_,{to:"/login",replace:!0,state:{from:n}})}function mTe(e){const t=new Date(e),n=Math.floor((new Date-t)/1e3);return n<60?"hace unos segundos":n<3600?`hace ${Math.floor(n/60)}m`:n<86400?`hace ${Math.floor(n/3600)}h`:`hace ${Math.floor(n/86400)}d`}const gTe=()=>{const e=br(),{items:t,loading:n,error:r}=ln(d=>d.conversations),{usuario:l}=ln(d=>d.auth);return V.useEffect(()=>{e(ty())},[e]),n?f.jsx(wy,{className:"min-h-[60svh]"}):r?f.jsx("p",{className:"text-center text-red-500 py-4",children:r}):!t||t.length===0?f.jsxs("div",{className:"flex flex-col items-center text-center gap-5 py-16 px-4",children:[f.jsx("img",{src:_W,alt:"Sin mensajes",className:"w-40 opacity-90"}),f.jsx("h2",{className:" text-lg font-semibold text-gray-700",children:"📨 Tu bandeja está vacía"}),f.jsxs("p",{className:"text-gray-600  text-xs md:text-base max-w-xs",children:["Aún no tienes conversaciones activas.",f.jsx("br",{}),"Cuando alguien te escriba, verás los mensajes aquí."]}),f.jsx(Wn,{to:"/",className:"inline-block bg-orange-500 hover:bg-orange-600 text-white  text-xs font-medium px-4 py-2 rounded transition",children:"Ir al inicio"})]}):f.jsxs("div",{className:"max-w-[1200px] mx-auto p-4 flex flex-col lg:flex-row gap-4 md:gap-8",children:[f.jsxs("div",{className:"w-full md:flex-1 flex flex-col gap-4",children:[f.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center gap-2",children:["📨 ",f.jsx("span",{className:"text-orange-500",children:"Mis Conversaciones"})]}),f.jsx("ul",{className:"flex flex-col gap-2",children:[...t].sort((d,p)=>new Date(p.updatedAt)-new Date(d.updatedAt)).map(d=>{var E,P,I,R,F,W;const p=((E=d.user)==null?void 0:E._id)===l.id,a=d.lastMessage&&!d.lastMessageIsRead,b=p?d.entityType==="business"?(P=d.entityId)==null?void 0:P.name:((I=d.entityId)==null?void 0:I.title)||"Evento":((R=d.user)==null?void 0:R.name)||"Usuario",T=d.user.profileImage;return f.jsx("li",{children:f.jsxs(Wn,{to:`/dashboard/inbox/conversation/${d._id}`,className:`flex items-center justify-between max-w-[90vw] md:max-w-[450px] lg:max-w-[350px] 2xl:max-w-[550px] p-3 border rounded-lg bg-white transition hover:shadow-md ${a?"border-orange-300 bg-orange-50":"border-gray-200"}`,children:[f.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[T?f.jsx("img",{src:T,alt:b,className:"w-9 h-9 rounded-full object-cover border border-gray-300 flex-none"}):f.jsx("div",{className:"flex-none",children:f.jsx(LN,{size:36})}),f.jsx("div",{className:"text-gray-400 shrink-0",children:a?f.jsx(dce,{className:"text-orange-500",size:18}):f.jsx(hce,{size:18})}),f.jsxs("div",{className:"flex flex-col flex-1 min-w-0",children:[f.jsx("p",{className:"text-[11px] text-gray-900 truncate",children:b}),f.jsx("p",{className:`text-xs truncate ${a?"text-gray-800 font-semibold":"text-gray-500"}`,title:((F=d.lastMessage)==null?void 0:F.trim())!==""?d.lastMessage:"Conversación iniciada, sin mensajes aún",children:((W=d.lastMessage)==null?void 0:W.trim())!==""?d.lastMessage:"Conversación iniciada, sin mensajes aún"})]})]}),f.jsxs("div",{className:"flex items-center gap-2 ml-2 whitespace-nowrap shrink-0",children:[d.updatedAt&&f.jsx("span",{className:"text-[10px] text-gray-400",children:mTe(d.updatedAt)}),a&&f.jsx("span",{className:"inline-block w-2 h-2 bg-blue-500 rounded-full"})]})]})},d._id)})})]}),f.jsxs("div",{className:"w-full  md:basis-[520px] md:flex-none md:max-w-[300px] 2xl:max-w-[600px] lg:basis-[560px] flex flex-col bg-orange-50 border border-orange-100 rounded-xl p-6 gap-4 shadow-sm",children:[f.jsx("img",{src:nx,alt:"Tips",className:"w-44 xl:w-84 h-auto mx-auto hidden md:block"}),f.jsx("h3",{className:"text-orange-600 font-semibold text-base text-center",children:"💡 Consejos para una conversación respetuosa"}),f.jsx("div",{className:"space-y-3",children:[{title:"✅ Respeto ante todo",text:"Usa un lenguaje amable y evita cualquier comentario ofensivo o despectivo. Recuerda que detrás de cada mensaje hay una persona."},{title:"✅ Protege tu privacidad",text:"No compartas datos sensibles como tu dirección, teléfono personal o información bancaria con personas que no conozcas."},{title:"✅ Dialoga con claridad",text:"Expresa tus ideas con respeto y claridad. Si algo no queda claro, pregunta sin miedo. La buena comunicación evita malentendidos."},{title:"✅ Recuerda las normas de convivencia",text:"Este espacio es para compartir, ayudar y construir comunidad. Evita actitudes que puedan incomodar o excluir a otras personas."}].map((d,p)=>f.jsxs("details",{className:"group border border-orange-100 rounded-lg bg-white px-4 py-2",children:[f.jsxs("summary",{className:"cursor-pointer flex justify-between items-center text-xs lg:font-medium text-gray-800 hover:text-orange-600",children:[d.title,f.jsx("svg",{className:"w-4 h-4 ml-2 transition-transform duration-200 group-open:rotate-180",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),f.jsx("p",{className:"mt-2 text-xs md:  text-xs text-gray-600",children:d.text})]},p))})]})]})};function xTe(e){const t=new Date(e),n=Math.floor((new Date-t)/1e3);return n<60?"hace unos segundos":n<3600?`hace ${Math.floor(n/60)}m`:n<86400?`hace ${Math.floor(n/3600)}h`:`hace ${Math.floor(n/86400)}d`}const yTe=()=>{var bt,jt,Nt,vt;const{id:e}=Ec(),t=br(),{items:n,loading:r,error:l,sending:d}=ln(He=>He.messages),{usuario:p}=ln(He=>He.auth),{items:a=[]}=ln(He=>He.conversations)||{},{negocios:b}=ln(He=>He.comunidadSeleccionada)||{},{data:T}=ln(He=>He.eventos)||{},[E,P]=V.useState(""),I=V.useRef(null),R=V.useRef(!1),F=(p==null?void 0:p._id)||(p==null?void 0:p.id);V.useEffect(()=>(t(eT(e)),t(ty()),()=>{t(Oie())}),[t,e]),V.useEffect(()=>{var He,ut;(He=I.current)==null||He.scrollIntoView({behavior:"smooth"}),(ut=n==null?void 0:n.forEach)==null||ut.call(n,Tt=>{var Yt;!(Tt!=null&&Tt.isRead)&&((Yt=Tt==null?void 0:Tt.sender)==null?void 0:Yt._id)!==F&&t(PU(Tt._id))})},[n,t,F]);const W=async He=>{He.preventDefault(),E.trim()&&(await t(tT({conversationId:e,text:E})),P(""),t(ty()))},$=He=>{var ut;return((ut=He==null?void 0:He.sender)==null?void 0:ut._id)===F},Z=a.find(He=>He._id===e),ne=((bt=Z==null?void 0:Z.user)==null?void 0:bt._id)===F,ie=ne?Z==null?void 0:Z.entityId:Z==null?void 0:Z.user;let ge=null;const ae=Z==null?void 0:Z.tipo;ae==="business"?ge=((jt=b==null?void 0:b.find)==null?void 0:jt.call(b,He=>He._id===(Z==null?void 0:Z.entityId)))||null:ae==="event"&&(ge=((Nt=T==null?void 0:T.find)==null?void 0:Nt.call(T,He=>(He._id||He.id)===(Z==null?void 0:Z.entityId)))||null);const se=ae==="business"?"Negocio":ae==="event"?"Evento":"Conversación nueva",me=ae==="business"?(ge==null?void 0:ge.name)||"Negocio":ae==="event"?(ge==null?void 0:ge.title)||"Evento":"Conversación",ke="/avatar-placeholder.png",qe="/placeholder.svg",tt=(ie==null?void 0:ie.profileImage)||ke,nt=ae==="business"?(ge==null?void 0:ge.profileImage)??qe:ae==="event"?(ge==null?void 0:ge.featuredImage)??qe:qe;return V.useEffect(()=>{!R.current&&Array.isArray(n)&&n.length>0&&!Z&&(R.current=!0,t(ty()))},[n,Z,t]),r?f.jsx("p",{className:"text-center text-gray-500 py-4",children:"Cargando mensajes..."}):l?f.jsx("p",{className:"text-center text-red-500 py-4",children:l}):f.jsxs("div",{className:"max-w-[1200px] mx-auto md:p-4 flex flex-col md:flex-row gap-4 md:gap-8",children:[f.jsxs("div",{className:"w-full md:w-2/3 flex flex-col gap-4",children:[f.jsxs("h2",{className:"text-lg md:text-2xl font-semibold text-gray-800 tracking-tight flex items-center gap-2",children:["🗨️ ",f.jsx("span",{className:"text-orange-500 font-bold",children:"Conversación"})]}),Z&&((n==null?void 0:n.length)||0)>0?f.jsxs("div",{className:"flex flex-col p-3 gap-3 rounded-lg border border-gray-200 bg-white max-w-[90vw]",children:[f.jsxs("div",{className:"flex items-center gap-2 ",children:[f.jsx("img",{src:ne?nt:tt,alt:"Participante",className:"w-12 h-12 rounded-full object-cover",onError:He=>He.currentTarget.src="/avatar-placeholder.png"}),f.jsxs("div",{className:"flex flex-col",children:[ne&&f.jsxs("span",{className:"text-xs text-gray-400",children:[se,":"]}),f.jsx("p",{className:"text-xs text-gray-700",children:ne?me:(ie==null?void 0:ie.name)||(ie==null?void 0:ie.username)||"Usuario"})]})]}),ne&&f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("img",{src:(p==null?void 0:p.profileImage)||"/avatar-placeholder.png",alt:(p==null?void 0:p.name)||"Yo",className:"w-12 h-12 rounded-full object-cover border border-gray-300",onError:He=>He.currentTarget.src="/avatar-placeholder.png"}),f.jsx("span",{className:"text-xs font-medium text-gray-700 truncate",title:p==null?void 0:p.name,children:(p==null?void 0:p.name)||"Yo"})]})]}):null,f.jsxs("div",{className:"relative flex-1 min-h-[80svh] md:min-h-[60svh] max-w-[98vw] md::min-w-[360px] lg:min-w-[30vw] ",children:[f.jsxs("div",{className:"absolute inset-0 overflow-x-hidden pointer-events-none z-0",children:[f.jsx("img",{src:DM,alt:"",className:"absolute top-[180px] left-[190px] md:w-24 w-12 opacity-15"}),f.jsx("img",{src:OM,alt:"",className:"absolute top-[16%] left-[80%] md:w-22 w-12 opacity-15"}),f.jsx("img",{src:IM,alt:"",className:"absolute top-[60%] left-[50%] md:w-20 w-12 opacity-15"}),f.jsx("img",{src:kM,alt:"",className:"absolute bottom-[10%] right-[15%] md:w-20 w-12 opacity-15"}),f.jsx("img",{src:RM,alt:"",className:"absolute top-[40%] right-[50%] md:w-20 w-12 opacity-15 rotate-12"}),f.jsx("img",{src:DM,alt:"",className:"absolute top-[40%] left-[10%] md:w-24 w-12 opacity-15 rotate-62"}),f.jsx("img",{src:OM,alt:"",className:"absolute top-[86%] left-[30%] md:w-22 w-12 rotate-22 opacity-15"}),f.jsx("img",{src:IM,alt:"",className:"absolute top-[5%] left-[5%] md:w-20 w-12 opacity-15 rotate-22"}),f.jsx("img",{src:kM,alt:"",className:"absolute bottom-[50%] right-[95%] w-12 md:w-20 opacity-15"}),f.jsx("img",{src:RM,alt:"",className:"absolute top-[40%] right-[0%] w-12 md:w-20 opacity-15 rotate-12"})]}),f.jsxs("div",{className:"relative z-10  overflow-y-auto space-y-2 p-3  max-h-[70svh] md:max-h-[68vh]  max-w-[90vw]md:p-4 lg:p-8 p-1",children:[(!n||n.length===0)&&f.jsx("p",{className:"text-gray-500 text-center",children:"No hay mensajes aún."}),(vt=n==null?void 0:n.map)==null?void 0:vt.call(n,He=>{const ut=$(He);return f.jsxs("div",{className:`flex w-full ${ut?"justify-end":"justify-start"} items-end gap-2`,children:[!ut&&!ne&&f.jsx("img",{src:tt,alt:"Participante",className:"w-12 h-12 rounded-full object-cover  shadow-lg",onError:Tt=>Tt.currentTarget.src=ke}),!ut&&ne&&f.jsx("img",{src:nt,alt:"Participante",className:"w-12 h-12 rounded-full object-cover",onError:Tt=>Tt.currentTarget.src=ke}),f.jsxs("div",{className:`max-w-[78%] sm:max-w-xs p-3 rounded-xl shadow-md ${ut?"bg-orange-500 text-white":"bg-white border border-gray-200 text-gray-800"}`,children:[f.jsx("p",{className:"text-xs 2xl:text-xs",children:He.text}),f.jsxs("div",{className:"text-[10px] text-gray-300 mt-1 flex items-center justify-between",children:[f.jsx("span",{children:xTe(He.createdAt)}),ut&&He.isRead&&f.jsx("span",{className:"ml-2",children:"✔ Leído"})]})]}),ut&&f.jsx("img",{src:ne?(p==null?void 0:p.profileImage)||tt:nt,alt:"Yo",className:"w-12 h-12 rounded-full object-cover",onError:Tt=>Tt.currentTarget.src=ke})]},He._id)}),f.jsx("div",{ref:I})]})]}),f.jsxs("form",{onSubmit:W,className:"flex mt-2 max-w-[90vw]",children:[f.jsx("input",{type:"text",value:E,onChange:He=>P(He.target.value),placeholder:"Escribe tu mensaje...",className:"flex-1 border text-xs 2xl:text-xs border-gray-300 rounded-l-xl px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500 max-w-[90vw]"}),f.jsx("button",{type:"submit",disabled:d,className:"bg-orange-500 text-xs text-white px-4 py-2 rounded-r-xl hover:bg-orange-600 disabled:opacity-50 transition",children:d?"Enviando...":"Enviar"})]})]}),f.jsxs("div",{className:"w-full md:max-w-[300px] 2xl:max-w-[600px] md:basis-[520px] md:flex-none  lg:basis-[560px] flex flex-col bg-orange-50 border border-orange-100 rounded-xl p-2 md:p-6 gap-4 shadow-sm",children:[f.jsx("img",{src:nx,alt:"Tips",className:"w-44 md:w-84 h-auto mx-auto hidden md:block"}),f.jsx("h3",{className:"text-orange-600 font-semibold text-base text-center",children:"💡 Consejos para una conversación respetuosa"}),f.jsx("div",{className:"space-y-3",children:[{title:"✅ Respeto ante todo",text:"Usa un lenguaje amable y evita cualquier comentario ofensivo o despectivo. Recuerda que detrás de cada mensaje hay una persona."},{title:"✅ Protege tu privacidad",text:"No compartas datos sensibles como tu dirección, teléfono personal o información bancaria con personas que no conozcas."},{title:"✅ Dialoga con claridad",text:"Expresa tus ideas con respeto y claridad. Si algo no queda claro, pregunta sin miedo. La buena comunicación evita malentendidos."},{title:"✅ Recuerda las normas de convivencia",text:"Este espacio es para compartir, ayudar y construir comunidad. Evita actitudes que puedan incomodar o excluir a otras personas."}].map((He,ut)=>f.jsxs("details",{className:"group border border-orange-100 rounded-lg bg-white px-2 md:px-4 py-2 max-w-[90vw]",children:[f.jsxs("summary",{className:"cursor-pointer  text-xs 2xl:text-xs flex justify-between items-center font-medium text-gray-800 hover:text-orange-600",children:[He.title,f.jsx("svg",{className:"w-4 h-4 ml-2 transition-transform duration-200 group-open:rotate-180",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),f.jsx("p",{className:"mt-2  text-xs 2xl:text-xs text-gray-600",children:He.text})]},ut))})]})]})};function vTe({summary:e}){return e?f.jsxs("div",{className:"grid grid-cols-3  lg:grid-cols-1 gap-4 mt-4",children:[f.jsxs("div",{className:"bg-blue-50 border border-gray-200 rounded-lg p-4 text-center hover:shadow transition",children:[f.jsx($$,{className:"mx-auto text-gray-500 mb-1"}),f.jsx("p",{className:"text-xs text-gray-500",children:"Seguidores"}),f.jsx("p",{className:"text-lg font-bold text-gray-700",children:e.followersCount||0})]}),f.jsxs("div",{className:"bg-blue-50 border border-gray-200 rounded-lg p-4 text-center hover:shadow transition",children:[f.jsx(jce,{className:"mx-auto text-gray-500 mb-1"}),f.jsx("p",{className:"text-xs text-gray-500",children:"Comentarios"}),f.jsx("p",{className:"text-lg font-bold text-gray-700",children:e.commentsCount||0})]}),f.jsxs("div",{className:"bg-blue-50 border border-gray-200 rounded-lg p-4 text-center hover:shadow transition ",children:[f.jsx(LM,{className:"mx-auto text-gray-500 mb-1"}),f.jsx("p",{className:"text-xs text-gray-500",children:"Promedio"}),f.jsx("p",{className:"text-md font-bold text-gray-700",children:e.averageRating?`${Number(e.averageRating).toFixed(2)}`:"Sin datos"})]}),f.jsxs("div",{className:"bg-blue-50 border border-gray-200 rounded-lg p-4 hover:shadow transition col-span-3 md:col-span-3 lg:col-span-1",children:[f.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:["¿Cómo calificaron los usuarios?"," "]}),f.jsx("ul",{className:"space-y-1 text-xs text-gray-600",children:[5,4,3,2,1].map(t=>{var r,l;const n=((l=(r=e.ratings)==null?void 0:r.find(d=>d._id===t))==null?void 0:l.count)||0;return f.jsxs("li",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"flex gap-0.5 text-yellow-400",children:Array.from({length:t}).map((d,p)=>f.jsx(LM,{},p))}),f.jsx("span",{className:"text-gray-700",children:n})]},t)})})]})]}):null}function RW(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var l=e.length;for(t=0;t<l;t++)e[t]&&(n=RW(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function ba(){for(var e,t,n=0,r="",l=arguments.length;n<l;n++)(e=arguments[n])&&(t=RW(e))&&(r&&(r+=" "),r+=t);return r}var N4={},D4={},bF;function _Te(){return bF||(bF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==="__proto__"}e.isUnsafeProperty=t}(D4)),D4}var O4={},wF;function zW(){return wF||(wF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){switch(typeof n){case"number":case"symbol":return!1;case"string":return n.includes(".")||n.includes("[")||n.includes("]")}}e.isDeepKey=t}(O4)),O4}var I4={},SF;function LW(){return SF||(SF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){var r;return typeof n=="string"||typeof n=="symbol"?n:Object.is((r=n==null?void 0:n.valueOf)==null?void 0:r.call(n),-0)?"-0":String(n)}e.toKey=t}(I4)),I4}var k4={},TF;function hD(){return TF||(TF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){const r=[],l=n.length;if(l===0)return r;let d=0,p="",a="",b=!1;for(n.charCodeAt(0)===46&&(r.push(""),d++);d<l;){const T=n[d];a?T==="\\"&&d+1<l?(d++,p+=n[d]):T===a?a="":p+=T:b?T==='"'||T==="'"?a=T:T==="]"?(b=!1,r.push(p),p=""):p+=T:T==="["?(b=!0,p&&(r.push(p),p="")):T==="."?p&&(r.push(p),p=""):p+=T,d++}return p&&r.push(p),r}e.toPath=t}(k4)),k4}var EF;function fD(){return EF||(EF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_Te(),n=zW(),r=LW(),l=hD();function d(a,b,T){if(a==null)return T;switch(typeof b){case"string":{if(t.isUnsafeProperty(b))return T;const E=a[b];return E===void 0?n.isDeepKey(b)?d(a,l.toPath(b),T):T:E}case"number":case"symbol":{typeof b=="number"&&(b=r.toKey(b));const E=a[b];return E===void 0?T:E}default:{if(Array.isArray(b))return p(a,b,T);if(Object.is(b==null?void 0:b.valueOf(),-0)?b="-0":b=String(b),t.isUnsafeProperty(b))return T;const E=a[b];return E===void 0?T:E}}}function p(a,b,T){if(b.length===0)return T;let E=a;for(let P=0;P<b.length;P++){if(E==null||t.isUnsafeProperty(b[P]))return T;E=E[b[P]]}return E===void 0?T:E}e.get=d}(N4)),N4}var R4,AF;function bTe(){return AF||(AF=1,R4=fD().get),R4}var wTe=bTe();const ox=Gs(wTe);var STe=tq(),Yo=e=>e===0?0:e>0?1:-1,Xc=e=>typeof e=="number"&&e!=+e,H0=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,lr=e=>(typeof e=="number"||e instanceof Number)&&!Xc(e),ap=e=>lr(e)||typeof e=="string",TTe=0,xy=e=>{var t=++TTe;return"".concat(e||"").concat(t)},Sc=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!lr(t)&&typeof t!="string")return r;var d;if(H0(t)){if(n==null)return r;var p=t.indexOf("%");d=n*parseFloat(t.slice(0,p))/100}else d=+t;return Xc(d)&&(d=r),l&&n!=null&&d>n&&(d=n),d},FW=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,n={},r=0;r<t;r++)if(!n[e[r]])n[e[r]]=!0;else return!0;return!1},Hg=(e,t)=>lr(e)&&lr(t)?n=>e+n*(t-e):()=>t;function $v(e,t,n){return lr(e)&&lr(t)?e+n*(t-e):t}function BW(e,t,n){if(!(!e||!e.length))return e.find(r=>r&&(typeof t=="function"?t(r):ox(r,t))===n)}var Za=e=>e===null||typeof e>"u",Gw=e=>Za(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),ETe=["viewBox","children"],ATe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],CF=["points","pathLength"],z4={svg:ETe,polygon:CF,polyline:CF},pD=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],mD=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(V.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var r={};return Object.keys(n).forEach(l=>{pD.includes(l)&&(r[l]=d=>n[l](n,d))}),r},CTe=(e,t,n)=>r=>(e(t,n,r),null),E3=(e,t,n)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var r=null;return Object.keys(e).forEach(l=>{var d=e[l];pD.includes(l)&&typeof d=="function"&&(r||(r={}),r[l]=CTe(d,t,n))}),r},jF=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",MF=null,L4=null,VW=e=>{if(e===MF&&Array.isArray(L4))return L4;var t=[];return V.Children.forEach(e,n=>{Za(n)||(STe.isFragment(n)?t=t.concat(VW(n.props.children)):t.push(n))}),L4=t,MF=e,t};function Ww(e,t){var n=[],r=[];return Array.isArray(t)?r=t.map(l=>jF(l)):r=[jF(t)],VW(e).forEach(l=>{var d=ox(l,"type.displayName")||ox(l,"type.name");r.indexOf(d)!==-1&&n.push(l)}),n}var UW=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,jTe=(e,t,n,r)=>{var l,d=(l=r&&(z4==null?void 0:z4[r]))!==null&&l!==void 0?l:[];return t.startsWith("data-")||typeof e!="function"&&(r&&d.includes(t)||ATe.includes(t))||n&&pD.includes(t)},Qi=(e,t,n)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(V.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var l={};return Object.keys(r).forEach(d=>{var p;jTe((p=r)===null||p===void 0?void 0:p[d],d,t,n)&&(l[d]=r[d])}),l},MTe=["children","width","height","viewBox","className","style","title","desc"];function j5(){return j5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},j5.apply(null,arguments)}function PTe(e,t){if(e==null)return{};var n,r,l=NTe(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function NTe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var $W=V.forwardRef((e,t)=>{var{children:n,width:r,height:l,viewBox:d,className:p,style:a,title:b,desc:T}=e,E=PTe(e,MTe),P=d||{width:r,height:l,x:0,y:0},I=ba("recharts-surface",p);return V.createElement("svg",j5({},Qi(E,!0,"svg"),{className:I,width:r,height:l,style:a,viewBox:"".concat(P.x," ").concat(P.y," ").concat(P.width," ").concat(P.height),ref:t}),V.createElement("title",null,b),V.createElement("desc",null,T),n)}),DTe=["children","className"];function M5(){return M5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},M5.apply(null,arguments)}function OTe(e,t){if(e==null)return{};var n,r,l=ITe(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function ITe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var Hs=V.forwardRef((e,t)=>{var{children:n,className:r}=e,l=OTe(e,DTe),d=ba("recharts-layer",r);return V.createElement("g",M5({className:d},Qi(l,!0),{ref:t}),n)}),kTe=V.createContext(null);function Wa(e){return function(){return e}}const qW=Math.cos,oE=Math.sin,tf=Math.sqrt,lE=Math.PI,A3=2*lE,P5=Math.PI,N5=2*P5,z0=1e-6,RTe=N5-z0;function HW(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function zTe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return HW;const n=10**t;return function(r){this._+=r[0];for(let l=1,d=r.length;l<d;++l)this._+=Math.round(arguments[l]*n)/n+r[l]}}class LTe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?HW:zTe(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,l){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+l}`}bezierCurveTo(t,n,r,l,d,p){this._append`C${+t},${+n},${+r},${+l},${this._x1=+d},${this._y1=+p}`}arcTo(t,n,r,l,d){if(t=+t,n=+n,r=+r,l=+l,d=+d,d<0)throw new Error(`negative radius: ${d}`);let p=this._x1,a=this._y1,b=r-t,T=l-n,E=p-t,P=a-n,I=E*E+P*P;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(I>z0)if(!(Math.abs(P*b-T*E)>z0)||!d)this._append`L${this._x1=t},${this._y1=n}`;else{let R=r-p,F=l-a,W=b*b+T*T,$=R*R+F*F,Z=Math.sqrt(W),ne=Math.sqrt(I),ie=d*Math.tan((P5-Math.acos((W+I-$)/(2*Z*ne)))/2),ge=ie/ne,ae=ie/Z;Math.abs(ge-1)>z0&&this._append`L${t+ge*E},${n+ge*P}`,this._append`A${d},${d},0,0,${+(P*R>E*F)},${this._x1=t+ae*b},${this._y1=n+ae*T}`}}arc(t,n,r,l,d,p){if(t=+t,n=+n,r=+r,p=!!p,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(l),b=r*Math.sin(l),T=t+a,E=n+b,P=1^p,I=p?l-d:d-l;this._x1===null?this._append`M${T},${E}`:(Math.abs(this._x1-T)>z0||Math.abs(this._y1-E)>z0)&&this._append`L${T},${E}`,r&&(I<0&&(I=I%N5+N5),I>RTe?this._append`A${r},${r},0,1,${P},${t-a},${n-b}A${r},${r},0,1,${P},${this._x1=T},${this._y1=E}`:I>z0&&this._append`A${r},${r},0,${+(I>=P5)},${P},${this._x1=t+r*Math.cos(d)},${this._y1=n+r*Math.sin(d)}`)}rect(t,n,r,l){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+l}h${-r}Z`}toString(){return this._}}function gD(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new LTe(t)}function xD(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function GW(e){this._context=e}GW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function C3(e){return new GW(e)}function WW(e){return e[0]}function ZW(e){return e[1]}function XW(e,t){var n=Wa(!0),r=null,l=C3,d=null,p=gD(a);e=typeof e=="function"?e:e===void 0?WW:Wa(e),t=typeof t=="function"?t:t===void 0?ZW:Wa(t);function a(b){var T,E=(b=xD(b)).length,P,I=!1,R;for(r==null&&(d=l(R=p())),T=0;T<=E;++T)!(T<E&&n(P=b[T],T,b))===I&&((I=!I)?d.lineStart():d.lineEnd()),I&&d.point(+e(P,T,b),+t(P,T,b));if(R)return d=null,R+""||null}return a.x=function(b){return arguments.length?(e=typeof b=="function"?b:Wa(+b),a):e},a.y=function(b){return arguments.length?(t=typeof b=="function"?b:Wa(+b),a):t},a.defined=function(b){return arguments.length?(n=typeof b=="function"?b:Wa(!!b),a):n},a.curve=function(b){return arguments.length?(l=b,r!=null&&(d=l(r)),a):l},a.context=function(b){return arguments.length?(b==null?r=d=null:d=l(r=b),a):r},a}function RS(e,t,n){var r=null,l=Wa(!0),d=null,p=C3,a=null,b=gD(T);e=typeof e=="function"?e:e===void 0?WW:Wa(+e),t=typeof t=="function"?t:Wa(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?ZW:Wa(+n);function T(P){var I,R,F,W=(P=xD(P)).length,$,Z=!1,ne,ie=new Array(W),ge=new Array(W);for(d==null&&(a=p(ne=b())),I=0;I<=W;++I){if(!(I<W&&l($=P[I],I,P))===Z)if(Z=!Z)R=I,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),F=I-1;F>=R;--F)a.point(ie[F],ge[F]);a.lineEnd(),a.areaEnd()}Z&&(ie[I]=+e($,I,P),ge[I]=+t($,I,P),a.point(r?+r($,I,P):ie[I],n?+n($,I,P):ge[I]))}if(ne)return a=null,ne+""||null}function E(){return XW().defined(l).curve(p).context(d)}return T.x=function(P){return arguments.length?(e=typeof P=="function"?P:Wa(+P),r=null,T):e},T.x0=function(P){return arguments.length?(e=typeof P=="function"?P:Wa(+P),T):e},T.x1=function(P){return arguments.length?(r=P==null?null:typeof P=="function"?P:Wa(+P),T):r},T.y=function(P){return arguments.length?(t=typeof P=="function"?P:Wa(+P),n=null,T):t},T.y0=function(P){return arguments.length?(t=typeof P=="function"?P:Wa(+P),T):t},T.y1=function(P){return arguments.length?(n=P==null?null:typeof P=="function"?P:Wa(+P),T):n},T.lineX0=T.lineY0=function(){return E().x(e).y(t)},T.lineY1=function(){return E().x(e).y(n)},T.lineX1=function(){return E().x(r).y(t)},T.defined=function(P){return arguments.length?(l=typeof P=="function"?P:Wa(!!P),T):l},T.curve=function(P){return arguments.length?(p=P,d!=null&&(a=p(d)),T):p},T.context=function(P){return arguments.length?(P==null?d=a=null:a=p(d=P),T):d},T}class KW{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function FTe(e){return new KW(e,!0)}function BTe(e){return new KW(e,!1)}const yD={draw(e,t){const n=tf(t/lE);e.moveTo(n,0),e.arc(0,0,n,0,A3)}},VTe={draw(e,t){const n=tf(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},YW=tf(1/3),UTe=YW*2,$Te={draw(e,t){const n=tf(t/UTe),r=n*YW;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},qTe={draw(e,t){const n=tf(t),r=-n/2;e.rect(r,r,n,n)}},HTe=.8908130915292852,QW=oE(lE/10)/oE(7*lE/10),GTe=oE(A3/10)*QW,WTe=-qW(A3/10)*QW,ZTe={draw(e,t){const n=tf(t*HTe),r=GTe*n,l=WTe*n;e.moveTo(0,-n),e.lineTo(r,l);for(let d=1;d<5;++d){const p=A3*d/5,a=qW(p),b=oE(p);e.lineTo(b*n,-a*n),e.lineTo(a*r-b*l,b*r+a*l)}e.closePath()}},F4=tf(3),XTe={draw(e,t){const n=-tf(t/(F4*3));e.moveTo(0,n*2),e.lineTo(-F4*n,-n),e.lineTo(F4*n,-n),e.closePath()}},Ad=-.5,Cd=tf(3)/2,D5=1/tf(12),KTe=(D5/2+1)*3,YTe={draw(e,t){const n=tf(t/KTe),r=n/2,l=n*D5,d=r,p=n*D5+n,a=-d,b=p;e.moveTo(r,l),e.lineTo(d,p),e.lineTo(a,b),e.lineTo(Ad*r-Cd*l,Cd*r+Ad*l),e.lineTo(Ad*d-Cd*p,Cd*d+Ad*p),e.lineTo(Ad*a-Cd*b,Cd*a+Ad*b),e.lineTo(Ad*r+Cd*l,Ad*l-Cd*r),e.lineTo(Ad*d+Cd*p,Ad*p-Cd*d),e.lineTo(Ad*a+Cd*b,Ad*b-Cd*a),e.closePath()}};function QTe(e,t){let n=null,r=gD(l);e=typeof e=="function"?e:Wa(e||yD),t=typeof t=="function"?t:Wa(t===void 0?64:+t);function l(){let d;if(n||(n=d=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),d)return n=null,d+""||null}return l.type=function(d){return arguments.length?(e=typeof d=="function"?d:Wa(d),l):e},l.size=function(d){return arguments.length?(t=typeof d=="function"?d:Wa(+d),l):t},l.context=function(d){return arguments.length?(n=d??null,l):n},l}function cE(){}function uE(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function JW(e){this._context=e}JW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:uE(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:uE(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function JTe(e){return new JW(e)}function eZ(e){this._context=e}eZ.prototype={areaStart:cE,areaEnd:cE,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:uE(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function eEe(e){return new eZ(e)}function tZ(e){this._context=e}tZ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:uE(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function tEe(e){return new tZ(e)}function nZ(e){this._context=e}nZ.prototype={areaStart:cE,areaEnd:cE,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function nEe(e){return new nZ(e)}function PF(e){return e<0?-1:1}function NF(e,t,n){var r=e._x1-e._x0,l=t-e._x1,d=(e._y1-e._y0)/(r||l<0&&-0),p=(n-e._y1)/(l||r<0&&-0),a=(d*l+p*r)/(r+l);return(PF(d)+PF(p))*Math.min(Math.abs(d),Math.abs(p),.5*Math.abs(a))||0}function DF(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function B4(e,t,n){var r=e._x0,l=e._y0,d=e._x1,p=e._y1,a=(d-r)/3;e._context.bezierCurveTo(r+a,l+a*t,d-a,p-a*n,d,p)}function dE(e){this._context=e}dE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:B4(this,this._t0,DF(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,B4(this,DF(this,n=NF(this,e,t)),n);break;default:B4(this,this._t0,n=NF(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function rZ(e){this._context=new iZ(e)}(rZ.prototype=Object.create(dE.prototype)).point=function(e,t){dE.prototype.point.call(this,t,e)};function iZ(e){this._context=e}iZ.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,l,d){this._context.bezierCurveTo(t,e,r,n,d,l)}};function rEe(e){return new dE(e)}function iEe(e){return new rZ(e)}function aZ(e){this._context=e}aZ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=OF(e),l=OF(t),d=0,p=1;p<n;++d,++p)this._context.bezierCurveTo(r[0][d],l[0][d],r[1][d],l[1][d],e[p],t[p]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function OF(e){var t,n=e.length-1,r,l=new Array(n),d=new Array(n),p=new Array(n);for(l[0]=0,d[0]=2,p[0]=e[0]+2*e[1],t=1;t<n-1;++t)l[t]=1,d[t]=4,p[t]=4*e[t]+2*e[t+1];for(l[n-1]=2,d[n-1]=7,p[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=l[t]/d[t-1],d[t]-=r,p[t]-=r*p[t-1];for(l[n-1]=p[n-1]/d[n-1],t=n-2;t>=0;--t)l[t]=(p[t]-l[t+1])/d[t];for(d[n-1]=(e[n]+l[n-1])/2,t=0;t<n-1;++t)d[t]=2*e[t+1]-l[t+1];return[l,d]}function aEe(e){return new aZ(e)}function j3(e,t){this._context=e,this._t=t}j3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function sEe(e){return new j3(e,.5)}function oEe(e){return new j3(e,0)}function lEe(e){return new j3(e,1)}function m_(e,t){if((p=e.length)>1)for(var n=1,r,l,d=e[t[0]],p,a=d.length;n<p;++n)for(l=d,d=e[t[n]],r=0;r<a;++r)d[r][1]+=d[r][0]=isNaN(l[r][1])?l[r][0]:l[r][1]}function O5(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function cEe(e,t){return e[t]}function uEe(e){const t=[];return t.key=e,t}function dEe(){var e=Wa([]),t=O5,n=m_,r=cEe;function l(d){var p=Array.from(e.apply(this,arguments),uEe),a,b=p.length,T=-1,E;for(const P of d)for(a=0,++T;a<b;++a)(p[a][T]=[0,+r(P,p[a].key,T,d)]).data=P;for(a=0,E=xD(t(p));a<b;++a)p[E[a]].index=a;return n(p,E),p}return l.keys=function(d){return arguments.length?(e=typeof d=="function"?d:Wa(Array.from(d)),l):e},l.value=function(d){return arguments.length?(r=typeof d=="function"?d:Wa(+d),l):r},l.order=function(d){return arguments.length?(t=d==null?O5:typeof d=="function"?d:Wa(Array.from(d)),l):t},l.offset=function(d){return arguments.length?(n=d??m_,l):n},l}function hEe(e,t){if((r=e.length)>0){for(var n,r,l=0,d=e[0].length,p;l<d;++l){for(p=n=0;n<r;++n)p+=e[n][l][1]||0;if(p)for(n=0;n<r;++n)e[n][l][1]/=p}m_(e,t)}}function fEe(e,t){if((l=e.length)>0){for(var n=0,r=e[t[0]],l,d=r.length;n<d;++n){for(var p=0,a=0;p<l;++p)a+=e[p][n][1]||0;r[n][1]+=r[n][0]=-a/2}m_(e,t)}}function pEe(e,t){if(!(!((p=e.length)>0)||!((d=(l=e[t[0]]).length)>0))){for(var n=0,r=1,l,d,p;r<d;++r){for(var a=0,b=0,T=0;a<p;++a){for(var E=e[t[a]],P=E[r][1]||0,I=E[r-1][1]||0,R=(P-I)/2,F=0;F<a;++F){var W=e[t[F]],$=W[r][1]||0,Z=W[r-1][1]||0;R+=$-Z}b+=P,T+=R*P}l[r-1][1]+=l[r-1][0]=n,b&&(n-=T/b)}l[r-1][1]+=l[r-1][0]=n,m_(e,t)}}var mEe=["type","size","sizeType"];function I5(){return I5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},I5.apply(null,arguments)}function IF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function kF(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?IF(Object(n),!0).forEach(function(r){gEe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IF(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function gEe(e,t,n){return(t=xEe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xEe(e){var t=yEe(e,"string");return typeof t=="symbol"?t:t+""}function yEe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vEe(e,t){if(e==null)return{};var n,r,l=_Ee(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function _Ee(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var sZ={symbolCircle:yD,symbolCross:VTe,symbolDiamond:$Te,symbolSquare:qTe,symbolStar:ZTe,symbolTriangle:XTe,symbolWye:YTe},bEe=Math.PI/180,wEe=e=>{var t="symbol".concat(Gw(e));return sZ[t]||yD},SEe=(e,t,n)=>{if(t==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var r=18*bEe;return 1.25*e*e*(Math.tan(r)-Math.tan(r*2)*Math.tan(r)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},TEe=(e,t)=>{sZ["symbol".concat(Gw(e))]=t},oZ=e=>{var{type:t="circle",size:n=64,sizeType:r="area"}=e,l=vEe(e,mEe),d=kF(kF({},l),{},{type:t,size:n,sizeType:r}),p=()=>{var P=wEe(t),I=QTe().type(P).size(SEe(n,r,t));return I()},{className:a,cx:b,cy:T}=d,E=Qi(d,!0);return b===+b&&T===+T&&n===+n?V.createElement("path",I5({},E,{className:ba("recharts-symbols",a),transform:"translate(".concat(b,", ").concat(T,")"),d:p()})):null};oZ.registerSymbol=TEe;var V4={},U4={},RF;function EEe(){return RF||(RF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,r){const l=new Map;for(let d=0;d<n.length;d++){const p=n[d],a=r(p);l.has(a)||l.set(a,p)}return Array.from(l.values())}e.uniqBy=t}(U4)),U4}var $4={},zF;function lZ(){return zF||(zF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n}e.identity=t}($4)),$4}var q4={},H4={},G4={},LF;function AEe(){return LF||(LF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Number.isSafeInteger(n)&&n>=0}e.isLength=t}(G4)),G4}var FF;function vD(){return FF||(FF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=AEe();function n(r){return r!=null&&typeof r!="function"&&t.isLength(r.length)}e.isArrayLike=n}(H4)),H4}var W4={},BF;function CEe(){return BF||(BF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="object"&&n!==null}e.isObjectLike=t}(W4)),W4}var VF;function jEe(){return VF||(VF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=vD(),n=CEe();function r(l){return n.isObjectLike(l)&&t.isArrayLike(l)}e.isArrayLikeObject=r}(q4)),q4}var Z4={},X4={},UF;function MEe(){return UF||(UF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=fD();function n(r){return function(l){return t.get(l,r)}}e.property=n}(X4)),X4}var K4={},Y4={},Q4={},J4={},$F;function cZ(){return $F||($F=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n!==null&&(typeof n=="object"||typeof n=="function")}e.isObject=t}(J4)),J4}var ej={},qF;function uZ(){return qF||(qF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==null||typeof n!="object"&&typeof n!="function"}e.isPrimitive=t}(ej)),ej}var tj={},HF;function _D(){return HF||(HF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,r){return n===r||Number.isNaN(n)&&Number.isNaN(r)}e.eq=t}(tj)),tj}var GF;function PEe(){return GF||(GF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bD(),n=cZ(),r=uZ(),l=_D();function d(P,I,R){return typeof R!="function"?t.isMatch(P,I):p(P,I,function F(W,$,Z,ne,ie,ge){const ae=R(W,$,Z,ne,ie,ge);return ae!==void 0?!!ae:p(W,$,F,ge)},new Map)}function p(P,I,R,F){if(I===P)return!0;switch(typeof I){case"object":return a(P,I,R,F);case"function":return Object.keys(I).length>0?p(P,{...I},R,F):l.eq(P,I);default:return n.isObject(P)?typeof I=="string"?I==="":!0:l.eq(P,I)}}function a(P,I,R,F){if(I==null)return!0;if(Array.isArray(I))return T(P,I,R,F);if(I instanceof Map)return b(P,I,R,F);if(I instanceof Set)return E(P,I,R,F);const W=Object.keys(I);if(P==null)return W.length===0;if(W.length===0)return!0;if(F&&F.has(I))return F.get(I)===P;F&&F.set(I,P);try{for(let $=0;$<W.length;$++){const Z=W[$];if(!r.isPrimitive(P)&&!(Z in P)||I[Z]===void 0&&P[Z]!==void 0||I[Z]===null&&P[Z]!==null||!R(P[Z],I[Z],Z,P,I,F))return!1}return!0}finally{F&&F.delete(I)}}function b(P,I,R,F){if(I.size===0)return!0;if(!(P instanceof Map))return!1;for(const[W,$]of I.entries()){const Z=P.get(W);if(R(Z,$,W,P,I,F)===!1)return!1}return!0}function T(P,I,R,F){if(I.length===0)return!0;if(!Array.isArray(P))return!1;const W=new Set;for(let $=0;$<I.length;$++){const Z=I[$];let ne=!1;for(let ie=0;ie<P.length;ie++){if(W.has(ie))continue;const ge=P[ie];let ae=!1;if(R(ge,Z,$,P,I,F)&&(ae=!0),ae){W.add(ie),ne=!0;break}}if(!ne)return!1}return!0}function E(P,I,R,F){return I.size===0?!0:P instanceof Set?T([...P],[...I],R,F):!1}e.isMatchWith=d,e.isSetMatch=E}(Q4)),Q4}var WF;function bD(){return WF||(WF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PEe();function n(r,l){return t.isMatchWith(r,l,()=>{})}e.isMatch=n}(Y4)),Y4}var nj={},rj={},ij={},ZF;function dZ(){return ZF||(ZF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Object.getOwnPropertySymbols(n).filter(r=>Object.prototype.propertyIsEnumerable.call(n,r))}e.getSymbols=t}(ij)),ij}var aj={},XF;function wD(){return XF||(XF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}e.getTag=t}(aj)),aj}var sj={},KF;function SD(){return KF||(KF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",n="[object String]",r="[object Number]",l="[object Boolean]",d="[object Arguments]",p="[object Symbol]",a="[object Date]",b="[object Map]",T="[object Set]",E="[object Array]",P="[object Function]",I="[object ArrayBuffer]",R="[object Object]",F="[object Error]",W="[object DataView]",$="[object Uint8Array]",Z="[object Uint8ClampedArray]",ne="[object Uint16Array]",ie="[object Uint32Array]",ge="[object BigUint64Array]",ae="[object Int8Array]",se="[object Int16Array]",me="[object Int32Array]",ke="[object BigInt64Array]",qe="[object Float32Array]",tt="[object Float64Array]";e.argumentsTag=d,e.arrayBufferTag=I,e.arrayTag=E,e.bigInt64ArrayTag=ke,e.bigUint64ArrayTag=ge,e.booleanTag=l,e.dataViewTag=W,e.dateTag=a,e.errorTag=F,e.float32ArrayTag=qe,e.float64ArrayTag=tt,e.functionTag=P,e.int16ArrayTag=se,e.int32ArrayTag=me,e.int8ArrayTag=ae,e.mapTag=b,e.numberTag=r,e.objectTag=R,e.regexpTag=t,e.setTag=T,e.stringTag=n,e.symbolTag=p,e.uint16ArrayTag=ne,e.uint32ArrayTag=ie,e.uint8ArrayTag=$,e.uint8ClampedArrayTag=Z}(sj)),sj}var oj={},YF;function NEe(){return YF||(YF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}e.isTypedArray=t}(oj)),oj}var QF;function hZ(){return QF||(QF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=dZ(),n=wD(),r=SD(),l=uZ(),d=NEe();function p(E,P){return a(E,void 0,E,new Map,P)}function a(E,P,I,R=new Map,F=void 0){const W=F==null?void 0:F(E,P,I,R);if(W!=null)return W;if(l.isPrimitive(E))return E;if(R.has(E))return R.get(E);if(Array.isArray(E)){const $=new Array(E.length);R.set(E,$);for(let Z=0;Z<E.length;Z++)$[Z]=a(E[Z],Z,I,R,F);return Object.hasOwn(E,"index")&&($.index=E.index),Object.hasOwn(E,"input")&&($.input=E.input),$}if(E instanceof Date)return new Date(E.getTime());if(E instanceof RegExp){const $=new RegExp(E.source,E.flags);return $.lastIndex=E.lastIndex,$}if(E instanceof Map){const $=new Map;R.set(E,$);for(const[Z,ne]of E)$.set(Z,a(ne,Z,I,R,F));return $}if(E instanceof Set){const $=new Set;R.set(E,$);for(const Z of E)$.add(a(Z,void 0,I,R,F));return $}if(typeof Buffer<"u"&&Buffer.isBuffer(E))return E.subarray();if(d.isTypedArray(E)){const $=new(Object.getPrototypeOf(E)).constructor(E.length);R.set(E,$);for(let Z=0;Z<E.length;Z++)$[Z]=a(E[Z],Z,I,R,F);return $}if(E instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&E instanceof SharedArrayBuffer)return E.slice(0);if(E instanceof DataView){const $=new DataView(E.buffer.slice(0),E.byteOffset,E.byteLength);return R.set(E,$),b($,E,I,R,F),$}if(typeof File<"u"&&E instanceof File){const $=new File([E],E.name,{type:E.type});return R.set(E,$),b($,E,I,R,F),$}if(E instanceof Blob){const $=new Blob([E],{type:E.type});return R.set(E,$),b($,E,I,R,F),$}if(E instanceof Error){const $=new E.constructor;return R.set(E,$),$.message=E.message,$.name=E.name,$.stack=E.stack,$.cause=E.cause,b($,E,I,R,F),$}if(typeof E=="object"&&T(E)){const $=Object.create(Object.getPrototypeOf(E));return R.set(E,$),b($,E,I,R,F),$}return E}function b(E,P,I=E,R,F){const W=[...Object.keys(P),...t.getSymbols(P)];for(let $=0;$<W.length;$++){const Z=W[$],ne=Object.getOwnPropertyDescriptor(E,Z);(ne==null||ne.writable)&&(E[Z]=a(P[Z],Z,I,R,F))}}function T(E){switch(n.getTag(E)){case r.argumentsTag:case r.arrayTag:case r.arrayBufferTag:case r.dataViewTag:case r.booleanTag:case r.dateTag:case r.float32ArrayTag:case r.float64ArrayTag:case r.int8ArrayTag:case r.int16ArrayTag:case r.int32ArrayTag:case r.mapTag:case r.numberTag:case r.objectTag:case r.regexpTag:case r.setTag:case r.stringTag:case r.symbolTag:case r.uint8ArrayTag:case r.uint8ClampedArrayTag:case r.uint16ArrayTag:case r.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=p,e.cloneDeepWithImpl=a,e.copyProperties=b}(rj)),rj}var JF;function DEe(){return JF||(JF=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=hZ();function n(r){return t.cloneDeepWithImpl(r,void 0,r,new Map,void 0)}e.cloneDeep=n}(nj)),nj}var eB;function OEe(){return eB||(eB=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bD(),n=DEe();function r(l){return l=n.cloneDeep(l),d=>t.isMatch(d,l)}e.matches=r}(K4)),K4}var lj={},cj={},uj={},tB;function IEe(){return tB||(tB=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=hZ(),n=SD();function r(l,d){return t.cloneDeepWith(l,(p,a,b,T)=>{const E=d==null?void 0:d(p,a,b,T);if(E!=null)return E;if(typeof l=="object")switch(Object.prototype.toString.call(l)){case n.numberTag:case n.stringTag:case n.booleanTag:{const P=new l.constructor(l==null?void 0:l.valueOf());return t.copyProperties(P,l),P}case n.argumentsTag:{const P={};return t.copyProperties(P,l),P.length=l.length,P[Symbol.iterator]=l[Symbol.iterator],P}default:return}})}e.cloneDeepWith=r}(uj)),uj}var nB;function kEe(){return nB||(nB=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=IEe();function n(r){return t.cloneDeepWith(r)}e.cloneDeep=n}(cj)),cj}var dj={},hj={},rB;function fZ(){return rB||(rB=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function n(r,l=Number.MAX_SAFE_INTEGER){switch(typeof r){case"number":return Number.isInteger(r)&&r>=0&&r<l;case"symbol":return!1;case"string":return t.test(r)}}e.isIndex=n}(hj)),hj}var fj={},iB;function REe(){return iB||(iB=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=wD();function n(r){return r!==null&&typeof r=="object"&&t.getTag(r)==="[object Arguments]"}e.isArguments=n}(fj)),fj}var aB;function zEe(){return aB||(aB=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zW(),n=fZ(),r=REe(),l=hD();function d(p,a){let b;if(Array.isArray(a)?b=a:typeof a=="string"&&t.isDeepKey(a)&&(p==null?void 0:p[a])==null?b=l.toPath(a):b=[a],b.length===0)return!1;let T=p;for(let E=0;E<b.length;E++){const P=b[E];if((T==null||!Object.hasOwn(T,P))&&!((Array.isArray(T)||r.isArguments(T))&&n.isIndex(P)&&P<T.length))return!1;T=T[P]}return!0}e.has=d}(dj)),dj}var sB;function LEe(){return sB||(sB=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bD(),n=LW(),r=kEe(),l=fD(),d=zEe();function p(a,b){switch(typeof a){case"object":{Object.is(a==null?void 0:a.valueOf(),-0)&&(a="-0");break}case"number":{a=n.toKey(a);break}}return b=r.cloneDeep(b),function(T){const E=l.get(T,a);return E===void 0?d.has(T,a):b===void 0?E===void 0:t.isMatch(E,b)}}e.matchesProperty=p}(lj)),lj}var oB;function FEe(){return oB||(oB=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lZ(),n=MEe(),r=OEe(),l=LEe();function d(p){if(p==null)return t.identity;switch(typeof p){case"function":return p;case"object":return Array.isArray(p)&&p.length===2?l.matchesProperty(p[0],p[1]):r.matches(p);case"string":case"symbol":case"number":return n.property(p)}}e.iteratee=d}(Z4)),Z4}var lB;function BEe(){return lB||(lB=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=EEe(),n=lZ(),r=jEe(),l=FEe();function d(p,a=n.identity){return r.isArrayLikeObject(p)?t.uniqBy(Array.from(p),l.iteratee(a)):[]}e.uniqBy=d}(V4)),V4}var pj,cB;function VEe(){return cB||(cB=1,pj=BEe().uniqBy),pj}var UEe=VEe();const uB=Gs(UEe);function $Ee(e,t,n){return t===!0?uB(e,n):typeof t=="function"?uB(e,t):e}var mj={exports:{}},gj={},xj={exports:{}},yj={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dB;function qEe(){if(dB)return yj;dB=1;var e=b_();function t(P,I){return P===I&&(P!==0||1/P===1/I)||P!==P&&I!==I}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,l=e.useEffect,d=e.useLayoutEffect,p=e.useDebugValue;function a(P,I){var R=I(),F=r({inst:{value:R,getSnapshot:I}}),W=F[0].inst,$=F[1];return d(function(){W.value=R,W.getSnapshot=I,b(W)&&$({inst:W})},[P,R,I]),l(function(){return b(W)&&$({inst:W}),P(function(){b(W)&&$({inst:W})})},[P]),p(R),R}function b(P){var I=P.getSnapshot;P=P.value;try{var R=I();return!n(P,R)}catch{return!0}}function T(P,I){return I()}var E=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?T:a;return yj.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:E,yj}var hB;function HEe(){return hB||(hB=1,xj.exports=qEe()),xj.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fB;function GEe(){if(fB)return gj;fB=1;var e=b_(),t=HEe();function n(T,E){return T===E&&(T!==0||1/T===1/E)||T!==T&&E!==E}var r=typeof Object.is=="function"?Object.is:n,l=t.useSyncExternalStore,d=e.useRef,p=e.useEffect,a=e.useMemo,b=e.useDebugValue;return gj.useSyncExternalStoreWithSelector=function(T,E,P,I,R){var F=d(null);if(F.current===null){var W={hasValue:!1,value:null};F.current=W}else W=F.current;F=a(function(){function Z(se){if(!ne){if(ne=!0,ie=se,se=I(se),R!==void 0&&W.hasValue){var me=W.value;if(R(me,se))return ge=me}return ge=se}if(me=ge,r(ie,se))return me;var ke=I(se);return R!==void 0&&R(me,ke)?(ie=se,me):(ie=se,ge=ke)}var ne=!1,ie,ge,ae=P===void 0?null:P;return[function(){return Z(E())},ae===null?void 0:function(){return Z(ae())}]},[E,P,I,R]);var $=l(T,F[0],F[1]);return p(function(){W.hasValue=!0,W.value=$},[$]),b($),$},gj}var pB;function WEe(){return pB||(pB=1,mj.exports=GEe()),mj.exports}var ZEe=WEe(),TD=V.createContext(null),XEe=e=>e,Ns=()=>{var e=V.useContext(TD);return e?e.store.dispatch:XEe},bT=()=>{},KEe=()=>bT,YEe=(e,t)=>e===t;function Or(e){var t=V.useContext(TD);return ZEe.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:KEe,t?t.store.getState:bT,t?t.store.getState:bT,t?e:bT,YEe)}var vj={},_j={},bj={},mB;function QEe(){return mB||(mB=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"?1:r===null?2:r===void 0?3:r!==r?4:0}const n=(r,l,d)=>{if(r!==l){const p=t(r),a=t(l);if(p===a&&p===0){if(r<l)return d==="desc"?1:-1;if(r>l)return d==="desc"?-1:1}return d==="desc"?a-p:p-a}return 0};e.compareValues=n}(bj)),bj}var wj={},Sj={},gB;function pZ(){return gB||(gB=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"||n instanceof Symbol}e.isSymbol=t}(Sj)),Sj}var xB;function JEe(){return xB||(xB=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=pZ(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function l(d,p){return Array.isArray(d)?!1:typeof d=="number"||typeof d=="boolean"||d==null||t.isSymbol(d)?!0:typeof d=="string"&&(r.test(d)||!n.test(d))||p!=null&&Object.hasOwn(p,d)}e.isKey=l}(wj)),wj}var yB;function e3e(){return yB||(yB=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=QEe(),n=JEe(),r=hD();function l(d,p,a,b){if(d==null)return[];a=b?void 0:a,Array.isArray(d)||(d=Object.values(d)),Array.isArray(p)||(p=p==null?[null]:[p]),p.length===0&&(p=[null]),Array.isArray(a)||(a=a==null?[]:[a]),a=a.map(R=>String(R));const T=(R,F)=>{let W=R;for(let $=0;$<F.length&&W!=null;++$)W=W[F[$]];return W},E=(R,F)=>F==null||R==null?F:typeof R=="object"&&"key"in R?Object.hasOwn(F,R.key)?F[R.key]:T(F,R.path):typeof R=="function"?R(F):Array.isArray(R)?T(F,R):typeof F=="object"?F[R]:F,P=p.map(R=>(Array.isArray(R)&&R.length===1&&(R=R[0]),R==null||typeof R=="function"||Array.isArray(R)||n.isKey(R)?R:{key:R,path:r.toPath(R)}));return d.map(R=>({original:R,criteria:P.map(F=>E(F,R))})).slice().sort((R,F)=>{for(let W=0;W<P.length;W++){const $=t.compareValues(R.criteria[W],F.criteria[W],a[W]);if($!==0)return $}return 0}).map(R=>R.original)}e.orderBy=l}(_j)),_j}var Tj={},vB;function t3e(){return vB||(vB=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,r=1){const l=[],d=Math.floor(r),p=(a,b)=>{for(let T=0;T<a.length;T++){const E=a[T];Array.isArray(E)&&b<d?p(E,b+1):l.push(E)}};return p(n,0),l}e.flatten=t}(Tj)),Tj}var Ej={},_B;function mZ(){return _B||(_B=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=fZ(),n=vD(),r=cZ(),l=_D();function d(p,a,b){return r.isObject(b)&&(typeof a=="number"&&n.isArrayLike(b)&&t.isIndex(a)&&a<b.length||typeof a=="string"&&a in b)?l.eq(b[a],p):!1}e.isIterateeCall=d}(Ej)),Ej}var bB;function n3e(){return bB||(bB=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=e3e(),n=t3e(),r=mZ();function l(d,...p){const a=p.length;return a>1&&r.isIterateeCall(d,p[0],p[1])?p=[]:a>2&&r.isIterateeCall(p[0],p[1],p[2])&&(p=[p[0]]),t.orderBy(d,n.flatten(p),["asc"])}e.sortBy=l}(vj)),vj}var Aj,wB;function r3e(){return wB||(wB=1,Aj=n3e().sortBy),Aj}var i3e=r3e();const M3=Gs(i3e);var gZ=e=>e.legend.settings,a3e=e=>e.legend.size,s3e=e=>e.legend.payload;tn([s3e,gZ],(e,t)=>{var{itemSorter:n}=t,r=e.flat(1);return n?M3(r,n):r});var zS=1;function o3e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,n]=V.useState({height:0,left:0,top:0,width:0}),r=V.useCallback(l=>{if(l!=null){var d=l.getBoundingClientRect(),p={height:d.height,left:d.left,top:d.top,width:d.width};(Math.abs(p.height-t.height)>zS||Math.abs(p.left-t.left)>zS||Math.abs(p.top-t.top)>zS||Math.abs(p.width-t.width)>zS)&&n({height:p.height,left:p.left,top:p.top,width:p.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,r]}var l3e={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},xZ=Ia({name:"chartLayout",initialState:l3e,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){e.margin.top=t.payload.top,e.margin.right=t.payload.right,e.margin.bottom=t.payload.bottom,e.margin.left=t.payload.left},setScale(e,t){e.scale=t.payload}}}),{setMargin:c3e,setLayout:u3e,setChartSize:d3e,setScale:h3e}=xZ.actions,f3e=xZ.reducer;function SB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function TB(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?SB(Object(n),!0).forEach(function(r){p3e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function p3e(e,t,n){return(t=m3e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m3e(e){var t=g3e(e,"string");return typeof t=="symbol"?t:t+""}function g3e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hE=Math.PI/180,x3e=e=>e*180/Math.PI,fo=(e,t,n,r)=>({x:e+Math.cos(-hE*r)*n,y:t+Math.sin(-hE*r)*n}),yZ=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(r.left||0)-(r.right||0)),Math.abs(n-(r.top||0)-(r.bottom||0)))/2},y3e=(e,t)=>{var{x:n,y:r}=e,{x:l,y:d}=t;return Math.sqrt((n-l)**2+(r-d)**2)},v3e=(e,t)=>{var{x:n,y:r}=e,{cx:l,cy:d}=t,p=y3e({x:n,y:r},{x:l,y:d});if(p<=0)return{radius:p,angle:0};var a=(n-l)/p,b=Math.acos(a);return r>d&&(b=2*Math.PI-b),{radius:p,angle:x3e(b),angleInRadian:b}},_3e=e=>{var{startAngle:t,endAngle:n}=e,r=Math.floor(t/360),l=Math.floor(n/360),d=Math.min(r,l);return{startAngle:t-d*360,endAngle:n-d*360}},b3e=(e,t)=>{var{startAngle:n,endAngle:r}=t,l=Math.floor(n/360),d=Math.floor(r/360),p=Math.min(l,d);return e+p*360},w3e=(e,t)=>{var{x:n,y:r}=e,{radius:l,angle:d}=v3e({x:n,y:r},t),{innerRadius:p,outerRadius:a}=t;if(l<p||l>a||l===0)return null;var{startAngle:b,endAngle:T}=_3e(t),E=d,P;if(b<=T){for(;E>T;)E-=360;for(;E<b;)E+=360;P=E>=b&&E<=T}else{for(;E>b;)E-=360;for(;E<T;)E+=360;P=E>=T&&E<=b}return P?TB(TB({},t),{},{radius:l,angle:b3e(E,t)}):null};function EB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function Od(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?EB(Object(n),!0).forEach(function(r){S3e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):EB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function S3e(e,t,n){return(t=T3e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T3e(e){var t=E3e(e,"string");return typeof t=="symbol"?t:t+""}function E3e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ns(e,t,n){return Za(e)||Za(t)?n:ap(t)?ox(e,t,n):typeof t=="function"?t(e):n}var A3e=(e,t,n,r,l)=>{var d,p=-1,a=(d=t==null?void 0:t.length)!==null&&d!==void 0?d:0;if(a<=1||e==null)return 0;if(r==="angleAxis"&&l!=null&&Math.abs(Math.abs(l[1]-l[0])-360)<=1e-6)for(var b=0;b<a;b++){var T=b>0?n[b-1].coordinate:n[a-1].coordinate,E=n[b].coordinate,P=b>=a-1?n[0].coordinate:n[b+1].coordinate,I=void 0;if(Yo(E-T)!==Yo(P-E)){var R=[];if(Yo(P-E)===Yo(l[1]-l[0])){I=P;var F=E+l[1]-l[0];R[0]=Math.min(F,(F+T)/2),R[1]=Math.max(F,(F+T)/2)}else{I=T;var W=P+l[1]-l[0];R[0]=Math.min(E,(W+E)/2),R[1]=Math.max(E,(W+E)/2)}var $=[Math.min(E,(I+E)/2),Math.max(E,(I+E)/2)];if(e>$[0]&&e<=$[1]||e>=R[0]&&e<=R[1]){({index:p}=n[b]);break}}else{var Z=Math.min(T,P),ne=Math.max(T,P);if(e>(Z+E)/2&&e<=(ne+E)/2){({index:p}=n[b]);break}}}else if(t){for(var ie=0;ie<a;ie++)if(ie===0&&e<=(t[ie].coordinate+t[ie+1].coordinate)/2||ie>0&&ie<a-1&&e>(t[ie].coordinate+t[ie-1].coordinate)/2&&e<=(t[ie].coordinate+t[ie+1].coordinate)/2||ie===a-1&&e>(t[ie].coordinate+t[ie-1].coordinate)/2){({index:p}=t[ie]);break}}return p},C3e=(e,t,n)=>{if(t&&n){var{width:r,height:l}=n,{align:d,verticalAlign:p,layout:a}=t;if((a==="vertical"||a==="horizontal"&&p==="middle")&&d!=="center"&&lr(e[d]))return Od(Od({},e),{},{[d]:e[d]+(r||0)});if((a==="horizontal"||a==="vertical"&&d==="center")&&p!=="middle"&&lr(e[p]))return Od(Od({},e),{},{[p]:e[p]+(l||0)})}return e},Fm=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",vZ=(e,t,n,r)=>{if(r)return e.map(a=>a.coordinate);var l,d,p=e.map(a=>(a.coordinate===t&&(l=!0),a.coordinate===n&&(d=!0),a.coordinate));return l||p.push(t),d||p.push(n),p},_Z=(e,t,n)=>{if(!e)return null;var{duplicateDomain:r,type:l,range:d,scale:p,realScaleType:a,isCategorical:b,categoricalDomain:T,tickCount:E,ticks:P,niceTicks:I,axisType:R}=e;if(!p)return null;var F=a==="scaleBand"&&p.bandwidth?p.bandwidth()/2:2,W=l==="category"&&p.bandwidth?p.bandwidth()/F:0;if(W=R==="angleAxis"&&d&&d.length>=2?Yo(d[0]-d[1])*2*W:W,P||I){var $=(P||I||[]).map((Z,ne)=>{var ie=r?r.indexOf(Z):Z;return{coordinate:p(ie)+W,value:Z,offset:W,index:ne}});return $.filter(Z=>!Xc(Z.coordinate))}return b&&T?T.map((Z,ne)=>({coordinate:p(Z)+W,value:Z,index:ne,offset:W})):p.ticks&&E!=null?p.ticks(E).map((Z,ne)=>({coordinate:p(Z)+W,value:Z,offset:W,index:ne})):p.domain().map((Z,ne)=>({coordinate:p(Z)+W,value:r?r[Z]:Z,index:ne,offset:W}))},AB=1e-4,j3e=e=>{var t=e.domain();if(!(!t||t.length<=2)){var n=t.length,r=e.range(),l=Math.min(r[0],r[1])-AB,d=Math.max(r[0],r[1])+AB,p=e(t[0]),a=e(t[n-1]);(p<l||p>d||a<l||a>d)&&e.domain([t[0],t[n-1]])}},M3e=(e,t)=>{if(!t||t.length!==2||!lr(t[0])||!lr(t[1]))return e;var n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]),l=[e[0],e[1]];return(!lr(e[0])||e[0]<n)&&(l[0]=n),(!lr(e[1])||e[1]>r)&&(l[1]=r),l[0]>r&&(l[0]=r),l[1]<n&&(l[1]=n),l},P3e=e=>{var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var l=0,d=0,p=0;p<t;++p){var a=Xc(e[p][n][1])?e[p][n][0]:e[p][n][1];a>=0?(e[p][n][0]=l,e[p][n][1]=l+a,l=e[p][n][1]):(e[p][n][0]=d,e[p][n][1]=d+a,d=e[p][n][1])}},N3e=e=>{var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var l=0,d=0;d<t;++d){var p=Xc(e[d][n][1])?e[d][n][0]:e[d][n][1];p>=0?(e[d][n][0]=l,e[d][n][1]=l+p,l=e[d][n][1]):(e[d][n][0]=0,e[d][n][1]=0)}},D3e={sign:P3e,expand:hEe,none:m_,silhouette:fEe,wiggle:pEe,positive:N3e},O3e=(e,t,n)=>{var r=D3e[n],l=dEe().keys(t).value((d,p)=>+ns(d,p,0)).order(O5).offset(r);return l(e)};function ED(e){return e==null?void 0:String(e)}function CB(e){var{axis:t,ticks:n,bandSize:r,entry:l,index:d,dataKey:p}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Za(l[t.dataKey])){var a=BW(n,"value",l[t.dataKey]);if(a)return a.coordinate+r/2}return n[d]?n[d].coordinate+r/2:null}var b=ns(l,Za(p)?t.dataKey:p);return Za(b)?null:t.scale(b)}var jB=e=>{var{axis:t,ticks:n,offset:r,bandSize:l,entry:d,index:p}=e;if(t.type==="category")return n[p]?n[p].coordinate+r:null;var a=ns(d,t.dataKey,t.scale.domain()[p]);return Za(a)?null:t.scale(a)-l/2+r},I3e=e=>{var{numericAxis:t}=e,n=t.scale.domain();if(t.type==="number"){var r=Math.min(n[0],n[1]),l=Math.max(n[0],n[1]);return r<=0&&l>=0?0:l<0?l:r}return n[0]},k3e=e=>{var t=e.flat(2).filter(lr);return[Math.min(...t),Math.max(...t)]},R3e=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],z3e=(e,t,n)=>{if(e!=null)return R3e(Object.keys(e).reduce((r,l)=>{var d=e[l],{stackedData:p}=d,a=p.reduce((b,T)=>{var E=k3e(T.slice(t,n+1));return[Math.min(b[0],E[0]),Math.max(b[1],E[1])]},[1/0,-1/0]);return[Math.min(a[0],r[0]),Math.max(a[1],r[1])]},[1/0,-1/0]))},MB=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,PB=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,xw=(e,t,n)=>{if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var l=M3(t,E=>E.coordinate),d=1/0,p=1,a=l.length;p<a;p++){var b=l[p],T=l[p-1];d=Math.min((b.coordinate||0)-(T.coordinate||0),d)}return d===1/0?0:d}return n?void 0:0};function NB(e){var{tooltipEntrySettings:t,dataKey:n,payload:r,value:l,name:d}=e;return Od(Od({},t),{},{dataKey:n,payload:r,value:l,name:d})}function N_(e,t){if(e)return String(e);if(typeof t=="string")return t}function L3e(e,t,n,r,l){if(n==="horizontal"||n==="vertical"){var d=e>=l.left&&e<=l.left+l.width&&t>=l.top&&t<=l.top+l.height;return d?{x:e,y:t}:null}return r?w3e({x:e,y:t},r):null}var F3e=(e,t,n,r)=>{var l=t.find(T=>T&&T.index===n);if(l){if(e==="horizontal")return{x:l.coordinate,y:r.y};if(e==="vertical")return{x:r.x,y:l.coordinate};if(e==="centric"){var d=l.coordinate,{radius:p}=r;return Od(Od(Od({},r),fo(r.cx,r.cy,p,d)),{},{angle:d,radius:p})}var a=l.coordinate,{angle:b}=r;return Od(Od(Od({},r),fo(r.cx,r.cy,a,b)),{},{angle:b,radius:a})}return{x:0,y:0}},B3e=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,Bm=e=>e.layout.width,Vm=e=>e.layout.height,V3e=e=>e.layout.scale,bZ=e=>e.layout.margin,AD=tn(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),CD=tn(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),wZ="data-recharts-item-index",SZ="data-recharts-item-data-key",P3=60;function DB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function Lg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?DB(Object(n),!0).forEach(function(r){U3e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):DB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function U3e(e,t,n){return(t=$3e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $3e(e){var t=q3e(e,"string");return typeof t=="symbol"?t:t+""}function q3e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var H3e=e=>e.brush.height,Mo=tn([Bm,Vm,bZ,H3e,AD,CD,gZ,a3e],(e,t,n,r,l,d,p,a)=>{var b=d.reduce((F,W)=>{var{orientation:$}=W;if(!W.mirror&&!W.hide){var Z=typeof W.width=="number"?W.width:P3;return Lg(Lg({},F),{},{[$]:F[$]+Z})}return F},{left:n.left||0,right:n.right||0}),T=l.reduce((F,W)=>{var{orientation:$}=W;return!W.mirror&&!W.hide?Lg(Lg({},F),{},{[$]:ox(F,"".concat($))+W.height}):F},{top:n.top||0,bottom:n.bottom||0}),E=Lg(Lg({},T),b),P=E.bottom;E.bottom+=r,E=C3e(E,p,a);var I=e-E.left-E.right,R=t-E.top-E.bottom;return Lg(Lg({brushBottom:P},E),{},{width:Math.max(I,0),height:Math.max(R,0)})}),G3e=tn(Mo,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),TZ=tn(Bm,Vm,(e,t)=>({x:0,y:0,width:e,height:t})),W3e=V.createContext(null),Ac=()=>V.useContext(W3e)!=null,N3=e=>e.brush,D3=tn([N3,Mo,bZ],(e,t,n)=>({height:e.height,x:lr(e.x)?e.x:t.left,y:lr(e.y)?e.y:t.top+t.height+t.brushBottom-((n==null?void 0:n.bottom)||0),width:lr(e.width)?e.width:t.width})),jD=()=>{var e,t=Ac(),n=Or(G3e),r=Or(D3),l=(e=Or(N3))===null||e===void 0?void 0:e.padding;return!t||!r||!l?n:{width:r.width-l.left-l.right,height:r.height-l.top-l.bottom,x:l.left,y:l.top}},Z3e={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},EZ=()=>{var e;return(e=Or(Mo))!==null&&e!==void 0?e:Z3e},AZ=()=>Or(Bm),CZ=()=>Or(Vm),ha=e=>e.layout.layoutType,O3=()=>Or(ha),X3e={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},jZ=Ia({name:"legend",initialState:X3e,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var n=Tm(e).payload.indexOf(t.payload);n>-1&&e.payload.splice(n,1)}}}),{setLegendSize:q6e,setLegendSettings:H6e,addLegendPayload:MZ,removeLegendPayload:PZ}=jZ.actions,K3e=jZ.reducer;function k5(){return k5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},k5.apply(null,arguments)}function OB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function Cj(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?OB(Object(n),!0).forEach(function(r){Y3e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):OB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Y3e(e,t,n){return(t=Q3e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Q3e(e){var t=J3e(e,"string");return typeof t=="symbol"?t:t+""}function J3e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eAe(e){return Array.isArray(e)&&ap(e[0])&&ap(e[1])?e.join(" ~ "):e}var tAe=e=>{var{separator:t=" : ",contentStyle:n={},itemStyle:r={},labelStyle:l={},payload:d,formatter:p,itemSorter:a,wrapperClassName:b,labelClassName:T,label:E,labelFormatter:P,accessibilityLayer:I=!1}=e,R=()=>{if(d&&d.length){var ae={padding:0,margin:0},se=(a?M3(d,a):d).map((me,ke)=>{if(me.type==="none")return null;var qe=me.formatter||p||eAe,{value:tt,name:nt}=me,bt=tt,jt=nt;if(qe){var Nt=qe(tt,nt,me,ke,d);if(Array.isArray(Nt))[bt,jt]=Nt;else if(Nt!=null)bt=Nt;else return null}var vt=Cj({display:"block",paddingTop:4,paddingBottom:4,color:me.color||"#000"},r);return V.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(ke),style:vt},ap(jt)?V.createElement("span",{className:"recharts-tooltip-item-name"},jt):null,ap(jt)?V.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,V.createElement("span",{className:"recharts-tooltip-item-value"},bt),V.createElement("span",{className:"recharts-tooltip-item-unit"},me.unit||""))});return V.createElement("ul",{className:"recharts-tooltip-item-list",style:ae},se)}return null},F=Cj({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},n),W=Cj({margin:0},l),$=!Za(E),Z=$?E:"",ne=ba("recharts-default-tooltip",b),ie=ba("recharts-tooltip-label",T);$&&P&&d!==void 0&&d!==null&&(Z=P(E,d));var ge=I?{role:"status","aria-live":"assertive"}:{};return V.createElement("div",k5({className:ne,style:F},ge),V.createElement("p",{className:ie,style:W},V.isValidElement(Z)?Z:"".concat(Z)),R())},lb="recharts-tooltip-wrapper",nAe={visibility:"hidden"};function rAe(e){var{coordinate:t,translateX:n,translateY:r}=e;return ba(lb,{["".concat(lb,"-right")]:lr(n)&&t&&lr(t.x)&&n>=t.x,["".concat(lb,"-left")]:lr(n)&&t&&lr(t.x)&&n<t.x,["".concat(lb,"-bottom")]:lr(r)&&t&&lr(t.y)&&r>=t.y,["".concat(lb,"-top")]:lr(r)&&t&&lr(t.y)&&r<t.y})}function IB(e){var{allowEscapeViewBox:t,coordinate:n,key:r,offsetTopLeft:l,position:d,reverseDirection:p,tooltipDimension:a,viewBox:b,viewBoxDimension:T}=e;if(d&&lr(d[r]))return d[r];var E=n[r]-a-(l>0?l:0),P=n[r]+l;if(t[r])return p[r]?E:P;var I=b[r];if(I==null)return 0;if(p[r]){var R=E,F=I;return R<F?Math.max(P,I):Math.max(E,I)}if(T==null)return 0;var W=P+a,$=I+T;return W>$?Math.max(E,I):Math.max(P,I)}function iAe(e){var{translateX:t,translateY:n,useTranslate3d:r}=e;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function aAe(e){var{allowEscapeViewBox:t,coordinate:n,offsetTopLeft:r,position:l,reverseDirection:d,tooltipBox:p,useTranslate3d:a,viewBox:b}=e,T,E,P;return p.height>0&&p.width>0&&n?(E=IB({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:r,position:l,reverseDirection:d,tooltipDimension:p.width,viewBox:b,viewBoxDimension:b.width}),P=IB({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:r,position:l,reverseDirection:d,tooltipDimension:p.height,viewBox:b,viewBoxDimension:b.height}),T=iAe({translateX:E,translateY:P,useTranslate3d:a})):T=nAe,{cssProperties:T,cssClasses:rAe({translateX:E,translateY:P,coordinate:n})}}function kB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function LS(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kB(Object(n),!0).forEach(function(r){R5(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function R5(e,t,n){return(t=sAe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sAe(e){var t=oAe(e,"string");return typeof t=="symbol"?t:t+""}function oAe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class lAe extends V.PureComponent{constructor(){super(...arguments),R5(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),R5(this,"handleKeyDown",t=>{if(t.key==="Escape"){var n,r,l,d;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(n=(r=this.props.coordinate)===null||r===void 0?void 0:r.x)!==null&&n!==void 0?n:0,y:(l=(d=this.props.coordinate)===null||d===void 0?void 0:d.y)!==null&&l!==void 0?l:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,n;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((n=this.props.coordinate)===null||n===void 0?void 0:n.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:n,animationDuration:r,animationEasing:l,children:d,coordinate:p,hasPayload:a,isAnimationActive:b,offset:T,position:E,reverseDirection:P,useTranslate3d:I,viewBox:R,wrapperStyle:F,lastBoundingBox:W,innerRef:$,hasPortalFromProps:Z}=this.props,{cssClasses:ne,cssProperties:ie}=aAe({allowEscapeViewBox:n,coordinate:p,offsetTopLeft:T,position:E,reverseDirection:P,tooltipBox:{height:W.height,width:W.width},useTranslate3d:I,viewBox:R}),ge=Z?{}:LS(LS({transition:b&&t?"transform ".concat(r,"ms ").concat(l):void 0},ie),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&a?"visible":"hidden",position:"absolute",top:0,left:0}),ae=LS(LS({},ge),{},{visibility:!this.state.dismissed&&t&&a?"visible":"hidden"},F);return V.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:ne,style:ae,ref:$},d)}}var cAe=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Py={isSsr:cAe()},NZ=()=>Or(e=>e.rootProps.accessibilityLayer);function xl(e){return Number.isFinite(e)}function g_(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function z5(){return z5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},z5.apply(null,arguments)}function RB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function zB(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?RB(Object(n),!0).forEach(function(r){uAe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function uAe(e,t,n){return(t=dAe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dAe(e){var t=hAe(e,"string");return typeof t=="symbol"?t:t+""}function hAe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LB={curveBasisClosed:eEe,curveBasisOpen:tEe,curveBasis:JTe,curveBumpX:FTe,curveBumpY:BTe,curveLinearClosed:nEe,curveLinear:C3,curveMonotoneX:rEe,curveMonotoneY:iEe,curveNatural:aEe,curveStep:sEe,curveStepAfter:lEe,curveStepBefore:oEe},FS=e=>xl(e.x)&&xl(e.y),cb=e=>e.x,ub=e=>e.y,fAe=(e,t)=>{if(typeof e=="function")return e;var n="curve".concat(Gw(e));return(n==="curveMonotone"||n==="curveBump")&&t?LB["".concat(n).concat(t==="vertical"?"Y":"X")]:LB[n]||C3},pAe=e=>{var{type:t="linear",points:n=[],baseLine:r,layout:l,connectNulls:d=!1}=e,p=fAe(t,l),a=d?n.filter(FS):n,b;if(Array.isArray(r)){var T=d?r.filter(P=>FS(P)):r,E=a.map((P,I)=>zB(zB({},P),{},{base:T[I]}));return l==="vertical"?b=RS().y(ub).x1(cb).x0(P=>P.base.x):b=RS().x(cb).y1(ub).y0(P=>P.base.y),b.defined(FS).curve(p),b(E)}return l==="vertical"&&lr(r)?b=RS().y(ub).x1(cb).x0(r):lr(r)?b=RS().x(cb).y1(ub).y0(r):b=XW().x(cb).y(ub),b.defined(FS).curve(p),b(a)},qb=e=>{var{className:t,points:n,path:r,pathRef:l}=e;if((!n||!n.length)&&!r)return null;var d=n&&n.length?pAe(e):r;return V.createElement("path",z5({},Qi(e,!1),mD(e),{className:ba("recharts-curve",t),d:d===null?void 0:d,ref:l}))},mAe=["x","y","top","left","width","height","className"];function L5(){return L5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},L5.apply(null,arguments)}function FB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function gAe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?FB(Object(n),!0).forEach(function(r){xAe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function xAe(e,t,n){return(t=yAe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yAe(e){var t=vAe(e,"string");return typeof t=="symbol"?t:t+""}function vAe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _Ae(e,t){if(e==null)return{};var n,r,l=bAe(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function bAe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var wAe=(e,t,n,r,l,d)=>"M".concat(e,",").concat(l,"v").concat(r,"M").concat(d,",").concat(t,"h").concat(n),SAe=e=>{var{x:t=0,y:n=0,top:r=0,left:l=0,width:d=0,height:p=0,className:a}=e,b=_Ae(e,mAe),T=gAe({x:t,y:n,top:r,left:l,width:d,height:p},b);return!lr(t)||!lr(n)||!lr(d)||!lr(p)||!lr(r)||!lr(l)?null:V.createElement("path",L5({},Qi(T,!0),{className:ba("recharts-cross",a),d:wAe(t,n,d,p,r,l)}))};function TAe(e,t,n,r){var l=r/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-l:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-l,width:e==="horizontal"?r:n.width-1,height:e==="horizontal"?n.height-1:r}}function BB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function EAe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?BB(Object(n),!0).forEach(function(r){AAe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):BB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function AAe(e,t,n){return(t=CAe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CAe(e){var t=jAe(e,"string");return typeof t=="symbol"?t:t+""}function jAe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $d(e,t){var n=EAe({},e),r=t,l=Object.keys(t),d=l.reduce((p,a)=>(p[a]===void 0&&r[a]!==void 0&&(p[a]=r[a]),p),n);return d}var jj={},Mj={},Pj={},VB;function MAe(){return VB||(VB=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){if(!n||typeof n!="object")return!1;const r=Object.getPrototypeOf(n);return r===null||r===Object.prototype||Object.getPrototypeOf(r)===null?Object.prototype.toString.call(n)==="[object Object]":!1}e.isPlainObject=t}(Pj)),Pj}var UB;function PAe(){return UB||(UB=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=MAe(),n=dZ(),r=wD(),l=SD(),d=_D();function p(T,E,P){return a(T,E,void 0,void 0,void 0,void 0,P)}function a(T,E,P,I,R,F,W){const $=W(T,E,P,I,R,F);if($!==void 0)return $;if(typeof T==typeof E)switch(typeof T){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return T===E;case"number":return T===E||Object.is(T,E);case"function":return T===E;case"object":return b(T,E,F,W)}return b(T,E,F,W)}function b(T,E,P,I){if(Object.is(T,E))return!0;let R=r.getTag(T),F=r.getTag(E);if(R===l.argumentsTag&&(R=l.objectTag),F===l.argumentsTag&&(F=l.objectTag),R!==F)return!1;switch(R){case l.stringTag:return T.toString()===E.toString();case l.numberTag:{const Z=T.valueOf(),ne=E.valueOf();return d.eq(Z,ne)}case l.booleanTag:case l.dateTag:case l.symbolTag:return Object.is(T.valueOf(),E.valueOf());case l.regexpTag:return T.source===E.source&&T.flags===E.flags;case l.functionTag:return T===E}P=P??new Map;const W=P.get(T),$=P.get(E);if(W!=null&&$!=null)return W===E;P.set(T,E),P.set(E,T);try{switch(R){case l.mapTag:{if(T.size!==E.size)return!1;for(const[Z,ne]of T.entries())if(!E.has(Z)||!a(ne,E.get(Z),Z,T,E,P,I))return!1;return!0}case l.setTag:{if(T.size!==E.size)return!1;const Z=Array.from(T.values()),ne=Array.from(E.values());for(let ie=0;ie<Z.length;ie++){const ge=Z[ie],ae=ne.findIndex(se=>a(ge,se,void 0,T,E,P,I));if(ae===-1)return!1;ne.splice(ae,1)}return!0}case l.arrayTag:case l.uint8ArrayTag:case l.uint8ClampedArrayTag:case l.uint16ArrayTag:case l.uint32ArrayTag:case l.bigUint64ArrayTag:case l.int8ArrayTag:case l.int16ArrayTag:case l.int32ArrayTag:case l.bigInt64ArrayTag:case l.float32ArrayTag:case l.float64ArrayTag:{if(typeof Buffer<"u"&&Buffer.isBuffer(T)!==Buffer.isBuffer(E)||T.length!==E.length)return!1;for(let Z=0;Z<T.length;Z++)if(!a(T[Z],E[Z],Z,T,E,P,I))return!1;return!0}case l.arrayBufferTag:return T.byteLength!==E.byteLength?!1:b(new Uint8Array(T),new Uint8Array(E),P,I);case l.dataViewTag:return T.byteLength!==E.byteLength||T.byteOffset!==E.byteOffset?!1:b(new Uint8Array(T),new Uint8Array(E),P,I);case l.errorTag:return T.name===E.name&&T.message===E.message;case l.objectTag:{if(!(b(T.constructor,E.constructor,P,I)||t.isPlainObject(T)&&t.isPlainObject(E)))return!1;const ne=[...Object.keys(T),...n.getSymbols(T)],ie=[...Object.keys(E),...n.getSymbols(E)];if(ne.length!==ie.length)return!1;for(let ge=0;ge<ne.length;ge++){const ae=ne[ge],se=T[ae];if(!Object.hasOwn(E,ae))return!1;const me=E[ae];if(!a(se,me,ae,T,E,P,I))return!1}return!0}default:return!1}}finally{P.delete(T),P.delete(E)}}e.isEqualWith=p}(Mj)),Mj}var Nj={},$B;function NAe(){return $B||($B=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(){}e.noop=t}(Nj)),Nj}var qB;function DAe(){return qB||(qB=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PAe(),n=NAe();function r(l,d){return t.isEqualWith(l,d,n.noop)}e.isEqual=r}(jj)),jj}var Dj,HB;function OAe(){return HB||(HB=1,Dj=DAe().isEqual),Dj}var IAe=OAe();const kAe=Gs(IAe);function RAe(e){var t={},n=()=>null,r=!1,l=null,d=p=>{if(!r){if(Array.isArray(p)){if(!p.length)return;var a=p,[b,...T]=a;if(typeof b=="number"){l=e.setTimeout(d.bind(null,T),b);return}d(b),l=e.setTimeout(d.bind(null,T));return}typeof p=="object"&&(t=p,n(t)),typeof p=="function"&&p()}};return{stop:()=>{r=!0},start:p=>{r=!1,l&&(l(),l=null),d(p)},subscribe:p=>(n=p,()=>{n=()=>null}),getTimeoutController:()=>e}}var fE=1e-4,DZ=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],OZ=(e,t)=>e.map((n,r)=>n*t**r).reduce((n,r)=>n+r),GB=(e,t)=>n=>{var r=DZ(e,t);return OZ(r,n)},zAe=(e,t)=>n=>{var r=DZ(e,t),l=[...r.map((d,p)=>d*p).slice(1),0];return OZ(l,n)},WB=function(){for(var t,n,r,l,d=arguments.length,p=new Array(d),a=0;a<d;a++)p[a]=arguments[a];if(p.length===1)switch(p[0]){case"linear":[t,r,n,l]=[0,0,1,1];break;case"ease":[t,r,n,l]=[.25,.1,.25,1];break;case"ease-in":[t,r,n,l]=[.42,0,1,1];break;case"ease-out":[t,r,n,l]=[.42,0,.58,1];break;case"ease-in-out":[t,r,n,l]=[0,0,.58,1];break;default:{var b=p[0].split("(");b[0]==="cubic-bezier"&&b[1].split(")")[0].split(",").length===4&&([t,r,n,l]=b[1].split(")")[0].split(",").map(F=>parseFloat(F)))}}else p.length===4&&([t,r,n,l]=p);var T=GB(t,n),E=GB(r,l),P=zAe(t,n),I=F=>F>1?1:F<0?0:F,R=F=>{for(var W=F>1?1:F,$=W,Z=0;Z<8;++Z){var ne=T($)-W,ie=P($);if(Math.abs(ne-W)<fE||ie<fE)return E($);$=I($-ne/ie)}return E($)};return R.isStepper=!1,R},LAe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:n=100,damping:r=8,dt:l=17}=t,d=(p,a,b)=>{var T=-(p-a)*n,E=b*r,P=b+(T-E)*l/1e3,I=b*l/1e3+p;return Math.abs(I-a)<fE&&Math.abs(P)<fE?[a,0]:[I,P]};return d.isStepper=!0,d.dt=l,d},FAe=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return WB(e);case"spring":return LAe();default:if(e.split("(")[0]==="cubic-bezier")return WB(e)}return typeof e=="function"?e:null};function ZB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function XB(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ZB(Object(n),!0).forEach(function(r){BAe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ZB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function BAe(e,t,n){return(t=VAe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VAe(e){var t=UAe(e,"string");return typeof t=="symbol"?t:t+""}function UAe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $Ae=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),qAe=(e,t,n)=>e.map(r=>"".concat($Ae(r)," ").concat(t,"ms ").concat(n)).join(","),HAe=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((n,r)=>n.filter(l=>r.includes(l))),yw=(e,t)=>Object.keys(t).reduce((n,r)=>XB(XB({},n),{},{[r]:e(r,t[r])}),{});function KB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function ml(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?KB(Object(n),!0).forEach(function(r){GAe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):KB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function GAe(e,t,n){return(t=WAe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WAe(e){var t=ZAe(e,"string");return typeof t=="symbol"?t:t+""}function ZAe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pE=(e,t,n)=>e+(t-e)*n,F5=e=>{var{from:t,to:n}=e;return t!==n},IZ=(e,t,n)=>{var r=yw((l,d)=>{if(F5(d)){var[p,a]=e(d.from,d.to,d.velocity);return ml(ml({},d),{},{from:p,velocity:a})}return d},t);return n<1?yw((l,d)=>F5(d)?ml(ml({},d),{},{velocity:pE(d.velocity,r[l].velocity,n),from:pE(d.from,r[l].from,n)}):d,t):IZ(e,r,n-1)};function XAe(e,t,n,r,l,d){var p,a=r.reduce((I,R)=>ml(ml({},I),{},{[R]:{from:e[R],velocity:0,to:t[R]}}),{}),b=()=>yw((I,R)=>R.from,a),T=()=>!Object.values(a).filter(F5).length,E=null,P=I=>{p||(p=I);var R=I-p,F=R/n.dt;a=IZ(n,a,F),l(ml(ml(ml({},e),t),b())),p=I,T()||(E=d.setTimeout(P))};return()=>(E=d.setTimeout(P),()=>{E()})}function KAe(e,t,n,r,l,d,p){var a=null,b=l.reduce((P,I)=>ml(ml({},P),{},{[I]:[e[I],t[I]]}),{}),T,E=P=>{T||(T=P);var I=(P-T)/r,R=yw((W,$)=>pE(...$,n(I)),b);if(d(ml(ml(ml({},e),t),R)),I<1)a=p.setTimeout(E);else{var F=yw((W,$)=>pE(...$,n(1)),b);d(ml(ml(ml({},e),t),F))}};return()=>(a=p.setTimeout(E),()=>{a()})}const YAe=(e,t,n,r,l,d)=>{var p=HAe(e,t);return n.isStepper===!0?XAe(e,t,n,p,l,d):KAe(e,t,n,r,p,l,d)};class QAe{setTimeout(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=performance.now(),l=null,d=p=>{p-r>=n?t(p):typeof requestAnimationFrame=="function"&&(l=requestAnimationFrame(d))};return l=requestAnimationFrame(d),()=>{cancelAnimationFrame(l)}}}var JAe=["children","begin","duration","attributeName","easing","isActive","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart","animationManager"];function B5(){return B5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},B5.apply(null,arguments)}function eCe(e,t){if(e==null)return{};var n,r,l=tCe(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function tCe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function YB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function Fg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?YB(Object(n),!0).forEach(function(r){G0(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function G0(e,t,n){return(t=nCe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nCe(e){var t=rCe(e,"string");return typeof t=="symbol"?t:t+""}function rCe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iCe(){return RAe(new QAe)}class MD extends V.PureComponent{constructor(t,n){super(t,n),G0(this,"mounted",!1),G0(this,"manager",null),G0(this,"stopJSAnimation",null),G0(this,"unSubscribe",null);var{isActive:r,attributeName:l,from:d,to:p,children:a,duration:b,animationManager:T}=this.props;if(this.manager=T,this.handleStyleChange=this.handleStyleChange.bind(this),this.changeStyle=this.changeStyle.bind(this),!r||b<=0){this.state={style:{}},typeof a=="function"&&(this.state={style:p});return}if(d){if(typeof a=="function"){this.state={style:d};return}this.state={style:l?{[l]:d}:d}}else this.state={style:{}}}componentDidMount(){var{isActive:t,canBegin:n}=this.props;this.mounted=!0,!(!t||!n)&&this.runAnimation(this.props)}componentDidUpdate(t){var{isActive:n,canBegin:r,attributeName:l,shouldReAnimate:d,to:p,from:a}=this.props,{style:b}=this.state;if(r){if(!n){var T={style:l?{[l]:p}:p};this.state&&b&&(l&&b[l]!==p||!l&&b!==p)&&this.setState(T);return}if(!(kAe(t.to,p)&&t.canBegin&&t.isActive)){var E=!t.canBegin||!t.isActive;this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var P=E||d?a:t.to;if(this.state&&b){var I={style:l?{[l]:P}:P};(l&&b[l]!==P||!l&&b!==P)&&this.setState(I)}this.runAnimation(Fg(Fg({},this.props),{},{from:P,begin:0}))}}}componentWillUnmount(){this.mounted=!1;var{onAnimationEnd:t}=this.props;this.unSubscribe&&this.unSubscribe(),this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation(),t&&t()}handleStyleChange(t){this.changeStyle(t)}changeStyle(t){this.mounted&&this.setState({style:t})}runJSAnimation(t){var{from:n,to:r,duration:l,easing:d,begin:p,onAnimationEnd:a,onAnimationStart:b}=t,T=YAe(n,r,FAe(d),l,this.changeStyle,this.manager.getTimeoutController()),E=()=>{this.stopJSAnimation=T()};this.manager.start([b,p,E,l,a])}runAnimation(t){var{begin:n,duration:r,attributeName:l,to:d,easing:p,onAnimationStart:a,onAnimationEnd:b,children:T}=t;if(this.unSubscribe=this.manager.subscribe(this.handleStyleChange),typeof p=="function"||typeof T=="function"||p==="spring"){this.runJSAnimation(t);return}var E=l?{[l]:d}:d,P=qAe(Object.keys(E),r,p);this.manager.start([a,n,Fg(Fg({},E),{},{transition:P}),r,b])}render(){var t=this.props,{children:n,begin:r,duration:l,attributeName:d,easing:p,isActive:a,from:b,to:T,canBegin:E,onAnimationEnd:P,shouldReAnimate:I,onAnimationReStart:R,animationManager:F}=t,W=eCe(t,JAe),$=V.Children.count(n),Z=this.state.style;if(typeof n=="function")return n(Z);if(!a||$===0||l<=0)return n;var ne=ie=>{var{style:ge={},className:ae}=ie.props,se=V.cloneElement(ie,Fg(Fg({},W),{},{style:Fg(Fg({},ge),Z),className:ae}));return se};return $===1?ne(V.Children.only(n)):V.createElement("div",null,V.Children.map(n,ie=>ne(ie)))}}G0(MD,"displayName","Animate");G0(MD,"defaultProps",{begin:0,duration:1e3,attributeName:"",easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}});var aCe=V.createContext(null);function lx(e){var t,n,r=V.useContext(aCe);return V.createElement(MD,B5({},e,{animationManager:(t=(n=e.animationManager)!==null&&n!==void 0?n:r)!==null&&t!==void 0?t:iCe()}))}function mE(){return mE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mE.apply(null,arguments)}var QB=(e,t,n,r,l)=>{var d=Math.min(Math.abs(n)/2,Math.abs(r)/2),p=r>=0?1:-1,a=n>=0?1:-1,b=r>=0&&n>=0||r<0&&n<0?1:0,T;if(d>0&&l instanceof Array){for(var E=[0,0,0,0],P=0,I=4;P<I;P++)E[P]=l[P]>d?d:l[P];T="M".concat(e,",").concat(t+p*E[0]),E[0]>0&&(T+="A ".concat(E[0],",").concat(E[0],",0,0,").concat(b,",").concat(e+a*E[0],",").concat(t)),T+="L ".concat(e+n-a*E[1],",").concat(t),E[1]>0&&(T+="A ".concat(E[1],",").concat(E[1],",0,0,").concat(b,`,
        `).concat(e+n,",").concat(t+p*E[1])),T+="L ".concat(e+n,",").concat(t+r-p*E[2]),E[2]>0&&(T+="A ".concat(E[2],",").concat(E[2],",0,0,").concat(b,`,
        `).concat(e+n-a*E[2],",").concat(t+r)),T+="L ".concat(e+a*E[3],",").concat(t+r),E[3]>0&&(T+="A ".concat(E[3],",").concat(E[3],",0,0,").concat(b,`,
        `).concat(e,",").concat(t+r-p*E[3])),T+="Z"}else if(d>0&&l===+l&&l>0){var R=Math.min(d,l);T="M ".concat(e,",").concat(t+p*R,`
            A `).concat(R,",").concat(R,",0,0,").concat(b,",").concat(e+a*R,",").concat(t,`
            L `).concat(e+n-a*R,",").concat(t,`
            A `).concat(R,",").concat(R,",0,0,").concat(b,",").concat(e+n,",").concat(t+p*R,`
            L `).concat(e+n,",").concat(t+r-p*R,`
            A `).concat(R,",").concat(R,",0,0,").concat(b,",").concat(e+n-a*R,",").concat(t+r,`
            L `).concat(e+a*R,",").concat(t+r,`
            A `).concat(R,",").concat(R,",0,0,").concat(b,",").concat(e,",").concat(t+r-p*R," Z")}else T="M ".concat(e,",").concat(t," h ").concat(n," v ").concat(r," h ").concat(-n," Z");return T},sCe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},kZ=e=>{var t=$d(e,sCe),n=V.useRef(null),[r,l]=V.useState(-1);V.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var Z=n.current.getTotalLength();Z&&l(Z)}catch{}},[]);var{x:d,y:p,width:a,height:b,radius:T,className:E}=t,{animationEasing:P,animationDuration:I,animationBegin:R,isAnimationActive:F,isUpdateAnimationActive:W}=t;if(d!==+d||p!==+p||a!==+a||b!==+b||a===0||b===0)return null;var $=ba("recharts-rectangle",E);return W?V.createElement(lx,{canBegin:r>0,from:{width:a,height:b,x:d,y:p},to:{width:a,height:b,x:d,y:p},duration:I,animationEasing:P,isActive:W},Z=>{var{width:ne,height:ie,x:ge,y:ae}=Z;return V.createElement(lx,{canBegin:r>0,from:"0px ".concat(r===-1?1:r,"px"),to:"".concat(r,"px 0px"),attributeName:"strokeDasharray",begin:R,duration:I,isActive:F,easing:P},V.createElement("path",mE({},Qi(t,!0),{className:$,d:QB(ge,ae,ne,ie,T),ref:n})))}):V.createElement("path",mE({},Qi(t,!0),{className:$,d:QB(d,p,a,b,T)}))};function RZ(e){var{cx:t,cy:n,radius:r,startAngle:l,endAngle:d}=e,p=fo(t,n,r,l),a=fo(t,n,r,d);return{points:[p,a],cx:t,cy:n,radius:r,startAngle:l,endAngle:d}}function V5(){return V5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},V5.apply(null,arguments)}var oCe=(e,t)=>{var n=Yo(t-e),r=Math.min(Math.abs(t-e),359.999);return n*r},BS=e=>{var{cx:t,cy:n,radius:r,angle:l,sign:d,isExternal:p,cornerRadius:a,cornerIsExternal:b}=e,T=a*(p?1:-1)+r,E=Math.asin(a/T)/hE,P=b?l:l+d*E,I=fo(t,n,T,P),R=fo(t,n,r,P),F=b?l-d*E:l,W=fo(t,n,T*Math.cos(E*hE),F);return{center:I,circleTangency:R,lineTangency:W,theta:E}},zZ=e=>{var{cx:t,cy:n,innerRadius:r,outerRadius:l,startAngle:d,endAngle:p}=e,a=oCe(d,p),b=d+a,T=fo(t,n,l,d),E=fo(t,n,l,b),P="M ".concat(T.x,",").concat(T.y,`
    A `).concat(l,",").concat(l,`,0,
    `).concat(+(Math.abs(a)>180),",").concat(+(d>b),`,
    `).concat(E.x,",").concat(E.y,`
  `);if(r>0){var I=fo(t,n,r,d),R=fo(t,n,r,b);P+="L ".concat(R.x,",").concat(R.y,`
            A `).concat(r,",").concat(r,`,0,
            `).concat(+(Math.abs(a)>180),",").concat(+(d<=b),`,
            `).concat(I.x,",").concat(I.y," Z")}else P+="L ".concat(t,",").concat(n," Z");return P},lCe=e=>{var{cx:t,cy:n,innerRadius:r,outerRadius:l,cornerRadius:d,forceCornerRadius:p,cornerIsExternal:a,startAngle:b,endAngle:T}=e,E=Yo(T-b),{circleTangency:P,lineTangency:I,theta:R}=BS({cx:t,cy:n,radius:l,angle:b,sign:E,cornerRadius:d,cornerIsExternal:a}),{circleTangency:F,lineTangency:W,theta:$}=BS({cx:t,cy:n,radius:l,angle:T,sign:-E,cornerRadius:d,cornerIsExternal:a}),Z=a?Math.abs(b-T):Math.abs(b-T)-R-$;if(Z<0)return p?"M ".concat(I.x,",").concat(I.y,`
        a`).concat(d,",").concat(d,",0,0,1,").concat(d*2,`,0
        a`).concat(d,",").concat(d,",0,0,1,").concat(-d*2,`,0
      `):zZ({cx:t,cy:n,innerRadius:r,outerRadius:l,startAngle:b,endAngle:T});var ne="M ".concat(I.x,",").concat(I.y,`
    A`).concat(d,",").concat(d,",0,0,").concat(+(E<0),",").concat(P.x,",").concat(P.y,`
    A`).concat(l,",").concat(l,",0,").concat(+(Z>180),",").concat(+(E<0),",").concat(F.x,",").concat(F.y,`
    A`).concat(d,",").concat(d,",0,0,").concat(+(E<0),",").concat(W.x,",").concat(W.y,`
  `);if(r>0){var{circleTangency:ie,lineTangency:ge,theta:ae}=BS({cx:t,cy:n,radius:r,angle:b,sign:E,isExternal:!0,cornerRadius:d,cornerIsExternal:a}),{circleTangency:se,lineTangency:me,theta:ke}=BS({cx:t,cy:n,radius:r,angle:T,sign:-E,isExternal:!0,cornerRadius:d,cornerIsExternal:a}),qe=a?Math.abs(b-T):Math.abs(b-T)-ae-ke;if(qe<0&&d===0)return"".concat(ne,"L").concat(t,",").concat(n,"Z");ne+="L".concat(me.x,",").concat(me.y,`
      A`).concat(d,",").concat(d,",0,0,").concat(+(E<0),",").concat(se.x,",").concat(se.y,`
      A`).concat(r,",").concat(r,",0,").concat(+(qe>180),",").concat(+(E>0),",").concat(ie.x,",").concat(ie.y,`
      A`).concat(d,",").concat(d,",0,0,").concat(+(E<0),",").concat(ge.x,",").concat(ge.y,"Z")}else ne+="L".concat(t,",").concat(n,"Z");return ne},cCe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},LZ=e=>{var t=$d(e,cCe),{cx:n,cy:r,innerRadius:l,outerRadius:d,cornerRadius:p,forceCornerRadius:a,cornerIsExternal:b,startAngle:T,endAngle:E,className:P}=t;if(d<l||T===E)return null;var I=ba("recharts-sector",P),R=d-l,F=Sc(p,R,0,!0),W;return F>0&&Math.abs(T-E)<360?W=lCe({cx:n,cy:r,innerRadius:l,outerRadius:d,cornerRadius:Math.min(F,R/2),forceCornerRadius:a,cornerIsExternal:b,startAngle:T,endAngle:E}):W=zZ({cx:n,cy:r,innerRadius:l,outerRadius:d,startAngle:T,endAngle:E}),V.createElement("path",V5({},Qi(t,!0),{className:I,d:W}))};function uCe(e,t,n){var r,l,d,p;if(e==="horizontal")r=t.x,d=r,l=n.top,p=n.top+n.height;else if(e==="vertical")l=t.y,p=l,r=n.left,d=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:a,cy:b,innerRadius:T,outerRadius:E,angle:P}=t,I=fo(a,b,T,P),R=fo(a,b,E,P);r=I.x,l=I.y,d=R.x,p=R.y}else return RZ(t);return[{x:r,y:l},{x:d,y:p}]}var Oj={},Ij={},kj={},JB;function dCe(){return JB||(JB=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=pZ();function n(r){return t.isSymbol(r)?NaN:Number(r)}e.toNumber=n}(kj)),kj}var e9;function hCe(){return e9||(e9=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=dCe();function n(r){return r?(r=t.toNumber(r),r===1/0||r===-1/0?(r<0?-1:1)*Number.MAX_VALUE:r===r?r:0):r===0?r:0}e.toFinite=n}(Ij)),Ij}var t9;function fCe(){return t9||(t9=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=mZ(),n=hCe();function r(l,d,p){p&&typeof p!="number"&&t.isIterateeCall(l,d,p)&&(d=p=void 0),l=n.toFinite(l),d===void 0?(d=l,l=0):d=n.toFinite(d),p=p===void 0?l<d?1:-1:n.toFinite(p);const a=Math.max(Math.ceil((d-l)/(p||1)),0),b=new Array(a);for(let T=0;T<a;T++)b[T]=l,l+=p;return b}e.range=r}(Oj)),Oj}var Rj,n9;function pCe(){return n9||(n9=1,Rj=fCe().range),Rj}var mCe=pCe();const FZ=Gs(mCe);function Yg(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function gCe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function PD(e){let t,n,r;e.length!==2?(t=Yg,n=(a,b)=>Yg(e(a),b),r=(a,b)=>e(a)-b):(t=e===Yg||e===gCe?e:xCe,n=e,r=e);function l(a,b,T=0,E=a.length){if(T<E){if(t(b,b)!==0)return E;do{const P=T+E>>>1;n(a[P],b)<0?T=P+1:E=P}while(T<E)}return T}function d(a,b,T=0,E=a.length){if(T<E){if(t(b,b)!==0)return E;do{const P=T+E>>>1;n(a[P],b)<=0?T=P+1:E=P}while(T<E)}return T}function p(a,b,T=0,E=a.length){const P=l(a,b,T,E-1);return P>T&&r(a[P-1],b)>-r(a[P],b)?P-1:P}return{left:l,center:p,right:d}}function xCe(){return 0}function BZ(e){return e===null?NaN:+e}function*yCe(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const vCe=PD(Yg),Zw=vCe.right;PD(BZ).center;class r9 extends Map{constructor(t,n=wCe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,l]of t)this.set(r,l)}get(t){return super.get(i9(this,t))}has(t){return super.has(i9(this,t))}set(t,n){return super.set(_Ce(this,t),n)}delete(t){return super.delete(bCe(this,t))}}function i9({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function _Ce({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function bCe({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function wCe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function SCe(e=Yg){if(e===Yg)return VZ;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function VZ(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const TCe=Math.sqrt(50),ECe=Math.sqrt(10),ACe=Math.sqrt(2);function gE(e,t,n){const r=(t-e)/Math.max(0,n),l=Math.floor(Math.log10(r)),d=r/Math.pow(10,l),p=d>=TCe?10:d>=ECe?5:d>=ACe?2:1;let a,b,T;return l<0?(T=Math.pow(10,-l)/p,a=Math.round(e*T),b=Math.round(t*T),a/T<e&&++a,b/T>t&&--b,T=-T):(T=Math.pow(10,l)*p,a=Math.round(e/T),b=Math.round(t/T),a*T<e&&++a,b*T>t&&--b),b<a&&.5<=n&&n<2?gE(e,t,n*2):[a,b,T]}function U5(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[l,d,p]=r?gE(t,e,n):gE(e,t,n);if(!(d>=l))return[];const a=d-l+1,b=new Array(a);if(r)if(p<0)for(let T=0;T<a;++T)b[T]=(d-T)/-p;else for(let T=0;T<a;++T)b[T]=(d-T)*p;else if(p<0)for(let T=0;T<a;++T)b[T]=(l+T)/-p;else for(let T=0;T<a;++T)b[T]=(l+T)*p;return b}function $5(e,t,n){return t=+t,e=+e,n=+n,gE(e,t,n)[2]}function q5(e,t,n){t=+t,e=+e,n=+n;const r=t<e,l=r?$5(t,e,n):$5(e,t,n);return(r?-1:1)*(l<0?1/-l:l)}function a9(e,t){let n;for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function s9(e,t){let n;for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function UZ(e,t,n=0,r=1/0,l){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(l=l===void 0?VZ:SCe(l);r>n;){if(r-n>600){const b=r-n+1,T=t-n+1,E=Math.log(b),P=.5*Math.exp(2*E/3),I=.5*Math.sqrt(E*P*(b-P)/b)*(T-b/2<0?-1:1),R=Math.max(n,Math.floor(t-T*P/b+I)),F=Math.min(r,Math.floor(t+(b-T)*P/b+I));UZ(e,t,R,F,l)}const d=e[t];let p=n,a=r;for(db(e,n,t),l(e[r],d)>0&&db(e,n,r);p<a;){for(db(e,p,a),++p,--a;l(e[p],d)<0;)++p;for(;l(e[a],d)>0;)--a}l(e[n],d)===0?db(e,n,a):(++a,db(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}return e}function db(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function CCe(e,t,n){if(e=Float64Array.from(yCe(e)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return s9(e);if(t>=1)return a9(e);var r,l=(r-1)*t,d=Math.floor(l),p=a9(UZ(e,d).subarray(0,d+1)),a=s9(e.subarray(d+1));return p+(a-p)*(l-d)}}function jCe(e,t,n=BZ){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,l=(r-1)*t,d=Math.floor(l),p=+n(e[d],d,e),a=+n(e[d+1],d+1,e);return p+(a-p)*(l-d)}}function MCe(e,t,n){e=+e,t=+t,n=(l=arguments.length)<2?(t=e,e=0,1):l<3?1:+n;for(var r=-1,l=Math.max(0,Math.ceil((t-e)/n))|0,d=new Array(l);++r<l;)d[r]=e+r*n;return d}function qd(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Um(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const H5=Symbol("implicit");function ND(){var e=new r9,t=[],n=[],r=H5;function l(d){let p=e.get(d);if(p===void 0){if(r!==H5)return r;e.set(d,p=t.push(d)-1)}return n[p%n.length]}return l.domain=function(d){if(!arguments.length)return t.slice();t=[],e=new r9;for(const p of d)e.has(p)||e.set(p,t.push(p)-1);return l},l.range=function(d){return arguments.length?(n=Array.from(d),l):n.slice()},l.unknown=function(d){return arguments.length?(r=d,l):r},l.copy=function(){return ND(t,n).unknown(r)},qd.apply(l,arguments),l}function DD(){var e=ND().unknown(void 0),t=e.domain,n=e.range,r=0,l=1,d,p,a=!1,b=0,T=0,E=.5;delete e.unknown;function P(){var I=t().length,R=l<r,F=R?l:r,W=R?r:l;d=(W-F)/Math.max(1,I-b+T*2),a&&(d=Math.floor(d)),F+=(W-F-d*(I-b))*E,p=d*(1-b),a&&(F=Math.round(F),p=Math.round(p));var $=MCe(I).map(function(Z){return F+d*Z});return n(R?$.reverse():$)}return e.domain=function(I){return arguments.length?(t(I),P()):t()},e.range=function(I){return arguments.length?([r,l]=I,r=+r,l=+l,P()):[r,l]},e.rangeRound=function(I){return[r,l]=I,r=+r,l=+l,a=!0,P()},e.bandwidth=function(){return p},e.step=function(){return d},e.round=function(I){return arguments.length?(a=!!I,P()):a},e.padding=function(I){return arguments.length?(b=Math.min(1,T=+I),P()):b},e.paddingInner=function(I){return arguments.length?(b=Math.min(1,I),P()):b},e.paddingOuter=function(I){return arguments.length?(T=+I,P()):T},e.align=function(I){return arguments.length?(E=Math.max(0,Math.min(1,I)),P()):E},e.copy=function(){return DD(t(),[r,l]).round(a).paddingInner(b).paddingOuter(T).align(E)},qd.apply(P(),arguments)}function $Z(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return $Z(t())},e}function PCe(){return $Z(DD.apply(null,arguments).paddingInner(1))}function OD(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function qZ(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Xw(){}var vw=.7,xE=1/vw,s_="\\s*([+-]?\\d+)\\s*",_w="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ip="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",NCe=/^#([0-9a-f]{3,8})$/,DCe=new RegExp(`^rgb\\(${s_},${s_},${s_}\\)$`),OCe=new RegExp(`^rgb\\(${ip},${ip},${ip}\\)$`),ICe=new RegExp(`^rgba\\(${s_},${s_},${s_},${_w}\\)$`),kCe=new RegExp(`^rgba\\(${ip},${ip},${ip},${_w}\\)$`),RCe=new RegExp(`^hsl\\(${_w},${ip},${ip}\\)$`),zCe=new RegExp(`^hsla\\(${_w},${ip},${ip},${_w}\\)$`),o9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};OD(Xw,bw,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:l9,formatHex:l9,formatHex8:LCe,formatHsl:FCe,formatRgb:c9,toString:c9});function l9(){return this.rgb().formatHex()}function LCe(){return this.rgb().formatHex8()}function FCe(){return HZ(this).formatHsl()}function c9(){return this.rgb().formatRgb()}function bw(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=NCe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?u9(t):n===3?new qc(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?VS(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?VS(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=DCe.exec(e))?new qc(t[1],t[2],t[3],1):(t=OCe.exec(e))?new qc(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=ICe.exec(e))?VS(t[1],t[2],t[3],t[4]):(t=kCe.exec(e))?VS(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=RCe.exec(e))?f9(t[1],t[2]/100,t[3]/100,1):(t=zCe.exec(e))?f9(t[1],t[2]/100,t[3]/100,t[4]):o9.hasOwnProperty(e)?u9(o9[e]):e==="transparent"?new qc(NaN,NaN,NaN,0):null}function u9(e){return new qc(e>>16&255,e>>8&255,e&255,1)}function VS(e,t,n,r){return r<=0&&(e=t=n=NaN),new qc(e,t,n,r)}function BCe(e){return e instanceof Xw||(e=bw(e)),e?(e=e.rgb(),new qc(e.r,e.g,e.b,e.opacity)):new qc}function G5(e,t,n,r){return arguments.length===1?BCe(e):new qc(e,t,n,r??1)}function qc(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}OD(qc,G5,qZ(Xw,{brighter(e){return e=e==null?xE:Math.pow(xE,e),new qc(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?vw:Math.pow(vw,e),new qc(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new qc(ay(this.r),ay(this.g),ay(this.b),yE(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:d9,formatHex:d9,formatHex8:VCe,formatRgb:h9,toString:h9}));function d9(){return`#${W0(this.r)}${W0(this.g)}${W0(this.b)}`}function VCe(){return`#${W0(this.r)}${W0(this.g)}${W0(this.b)}${W0((isNaN(this.opacity)?1:this.opacity)*255)}`}function h9(){const e=yE(this.opacity);return`${e===1?"rgb(":"rgba("}${ay(this.r)}, ${ay(this.g)}, ${ay(this.b)}${e===1?")":`, ${e})`}`}function yE(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ay(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function W0(e){return e=ay(e),(e<16?"0":"")+e.toString(16)}function f9(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Wh(e,t,n,r)}function HZ(e){if(e instanceof Wh)return new Wh(e.h,e.s,e.l,e.opacity);if(e instanceof Xw||(e=bw(e)),!e)return new Wh;if(e instanceof Wh)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,l=Math.min(t,n,r),d=Math.max(t,n,r),p=NaN,a=d-l,b=(d+l)/2;return a?(t===d?p=(n-r)/a+(n<r)*6:n===d?p=(r-t)/a+2:p=(t-n)/a+4,a/=b<.5?d+l:2-d-l,p*=60):a=b>0&&b<1?0:p,new Wh(p,a,b,e.opacity)}function UCe(e,t,n,r){return arguments.length===1?HZ(e):new Wh(e,t,n,r??1)}function Wh(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}OD(Wh,UCe,qZ(Xw,{brighter(e){return e=e==null?xE:Math.pow(xE,e),new Wh(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?vw:Math.pow(vw,e),new Wh(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,l=2*n-r;return new qc(zj(e>=240?e-240:e+120,l,r),zj(e,l,r),zj(e<120?e+240:e-120,l,r),this.opacity)},clamp(){return new Wh(p9(this.h),US(this.s),US(this.l),yE(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=yE(this.opacity);return`${e===1?"hsl(":"hsla("}${p9(this.h)}, ${US(this.s)*100}%, ${US(this.l)*100}%${e===1?")":`, ${e})`}`}}));function p9(e){return e=(e||0)%360,e<0?e+360:e}function US(e){return Math.max(0,Math.min(1,e||0))}function zj(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const ID=e=>()=>e;function $Ce(e,t){return function(n){return e+n*t}}function qCe(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function HCe(e){return(e=+e)==1?GZ:function(t,n){return n-t?qCe(t,n,e):ID(isNaN(t)?n:t)}}function GZ(e,t){var n=t-e;return n?$Ce(e,n):ID(isNaN(e)?t:e)}const m9=function e(t){var n=HCe(t);function r(l,d){var p=n((l=G5(l)).r,(d=G5(d)).r),a=n(l.g,d.g),b=n(l.b,d.b),T=GZ(l.opacity,d.opacity);return function(E){return l.r=p(E),l.g=a(E),l.b=b(E),l.opacity=T(E),l+""}}return r.gamma=e,r}(1);function GCe(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),l;return function(d){for(l=0;l<n;++l)r[l]=e[l]*(1-d)+t[l]*d;return r}}function WCe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function ZCe(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,l=new Array(r),d=new Array(n),p;for(p=0;p<r;++p)l[p]=D_(e[p],t[p]);for(;p<n;++p)d[p]=t[p];return function(a){for(p=0;p<r;++p)d[p]=l[p](a);return d}}function XCe(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function vE(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function KCe(e,t){var n={},r={},l;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(l in t)l in e?n[l]=D_(e[l],t[l]):r[l]=t[l];return function(d){for(l in n)r[l]=n[l](d);return r}}var W5=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Lj=new RegExp(W5.source,"g");function YCe(e){return function(){return e}}function QCe(e){return function(t){return e(t)+""}}function JCe(e,t){var n=W5.lastIndex=Lj.lastIndex=0,r,l,d,p=-1,a=[],b=[];for(e=e+"",t=t+"";(r=W5.exec(e))&&(l=Lj.exec(t));)(d=l.index)>n&&(d=t.slice(n,d),a[p]?a[p]+=d:a[++p]=d),(r=r[0])===(l=l[0])?a[p]?a[p]+=l:a[++p]=l:(a[++p]=null,b.push({i:p,x:vE(r,l)})),n=Lj.lastIndex;return n<t.length&&(d=t.slice(n),a[p]?a[p]+=d:a[++p]=d),a.length<2?b[0]?QCe(b[0].x):YCe(t):(t=b.length,function(T){for(var E=0,P;E<t;++E)a[(P=b[E]).i]=P.x(T);return a.join("")})}function D_(e,t){var n=typeof t,r;return t==null||n==="boolean"?ID(t):(n==="number"?vE:n==="string"?(r=bw(t))?(t=r,m9):JCe:t instanceof bw?m9:t instanceof Date?XCe:WCe(t)?GCe:Array.isArray(t)?ZCe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?KCe:vE)(e,t)}function kD(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function e4e(e,t){t===void 0&&(t=e,e=D_);for(var n=0,r=t.length-1,l=t[0],d=new Array(r<0?0:r);n<r;)d[n]=e(l,l=t[++n]);return function(p){var a=Math.max(0,Math.min(r-1,Math.floor(p*=r)));return d[a](p-a)}}function t4e(e){return function(){return e}}function _E(e){return+e}var g9=[0,1];function wc(e){return e}function Z5(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:t4e(isNaN(t)?NaN:.5)}function n4e(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function r4e(e,t,n){var r=e[0],l=e[1],d=t[0],p=t[1];return l<r?(r=Z5(l,r),d=n(p,d)):(r=Z5(r,l),d=n(d,p)),function(a){return d(r(a))}}function i4e(e,t,n){var r=Math.min(e.length,t.length)-1,l=new Array(r),d=new Array(r),p=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++p<r;)l[p]=Z5(e[p],e[p+1]),d[p]=n(t[p],t[p+1]);return function(a){var b=Zw(e,a,1,r)-1;return d[b](l[b](a))}}function Kw(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function I3(){var e=g9,t=g9,n=D_,r,l,d,p=wc,a,b,T;function E(){var I=Math.min(e.length,t.length);return p!==wc&&(p=n4e(e[0],e[I-1])),a=I>2?i4e:r4e,b=T=null,P}function P(I){return I==null||isNaN(I=+I)?d:(b||(b=a(e.map(r),t,n)))(r(p(I)))}return P.invert=function(I){return p(l((T||(T=a(t,e.map(r),vE)))(I)))},P.domain=function(I){return arguments.length?(e=Array.from(I,_E),E()):e.slice()},P.range=function(I){return arguments.length?(t=Array.from(I),E()):t.slice()},P.rangeRound=function(I){return t=Array.from(I),n=kD,E()},P.clamp=function(I){return arguments.length?(p=I?!0:wc,E()):p!==wc},P.interpolate=function(I){return arguments.length?(n=I,E()):n},P.unknown=function(I){return arguments.length?(d=I,P):d},function(I,R){return r=I,l=R,E()}}function RD(){return I3()(wc,wc)}function a4e(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function bE(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function x_(e){return e=bE(Math.abs(e)),e?e[1]:NaN}function s4e(e,t){return function(n,r){for(var l=n.length,d=[],p=0,a=e[0],b=0;l>0&&a>0&&(b+a+1>r&&(a=Math.max(1,r-b)),d.push(n.substring(l-=a,l+a)),!((b+=a+1)>r));)a=e[p=(p+1)%e.length];return d.reverse().join(t)}}function o4e(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var l4e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ww(e){if(!(t=l4e.exec(e)))throw new Error("invalid format: "+e);var t;return new zD({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ww.prototype=zD.prototype;function zD(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}zD.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function c4e(e){e:for(var t=e.length,n=1,r=-1,l;n<t;++n)switch(e[n]){case".":r=l=n;break;case"0":r===0&&(r=n),l=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(l+1):e}var WZ;function u4e(e,t){var n=bE(e,t);if(!n)return e+"";var r=n[0],l=n[1],d=l-(WZ=Math.max(-8,Math.min(8,Math.floor(l/3)))*3)+1,p=r.length;return d===p?r:d>p?r+new Array(d-p+1).join("0"):d>0?r.slice(0,d)+"."+r.slice(d):"0."+new Array(1-d).join("0")+bE(e,Math.max(0,t+d-1))[0]}function x9(e,t){var n=bE(e,t);if(!n)return e+"";var r=n[0],l=n[1];return l<0?"0."+new Array(-l).join("0")+r:r.length>l+1?r.slice(0,l+1)+"."+r.slice(l+1):r+new Array(l-r.length+2).join("0")}const y9={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:a4e,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>x9(e*100,t),r:x9,s:u4e,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function v9(e){return e}var _9=Array.prototype.map,b9=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function d4e(e){var t=e.grouping===void 0||e.thousands===void 0?v9:s4e(_9.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",l=e.decimal===void 0?".":e.decimal+"",d=e.numerals===void 0?v9:o4e(_9.call(e.numerals,String)),p=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"−":e.minus+"",b=e.nan===void 0?"NaN":e.nan+"";function T(P){P=ww(P);var I=P.fill,R=P.align,F=P.sign,W=P.symbol,$=P.zero,Z=P.width,ne=P.comma,ie=P.precision,ge=P.trim,ae=P.type;ae==="n"?(ne=!0,ae="g"):y9[ae]||(ie===void 0&&(ie=12),ge=!0,ae="g"),($||I==="0"&&R==="=")&&($=!0,I="0",R="=");var se=W==="$"?n:W==="#"&&/[boxX]/.test(ae)?"0"+ae.toLowerCase():"",me=W==="$"?r:/[%p]/.test(ae)?p:"",ke=y9[ae],qe=/[defgprs%]/.test(ae);ie=ie===void 0?6:/[gprs]/.test(ae)?Math.max(1,Math.min(21,ie)):Math.max(0,Math.min(20,ie));function tt(nt){var bt=se,jt=me,Nt,vt,He;if(ae==="c")jt=ke(nt)+jt,nt="";else{nt=+nt;var ut=nt<0||1/nt<0;if(nt=isNaN(nt)?b:ke(Math.abs(nt),ie),ge&&(nt=c4e(nt)),ut&&+nt==0&&F!=="+"&&(ut=!1),bt=(ut?F==="("?F:a:F==="-"||F==="("?"":F)+bt,jt=(ae==="s"?b9[8+WZ/3]:"")+jt+(ut&&F==="("?")":""),qe){for(Nt=-1,vt=nt.length;++Nt<vt;)if(He=nt.charCodeAt(Nt),48>He||He>57){jt=(He===46?l+nt.slice(Nt+1):nt.slice(Nt))+jt,nt=nt.slice(0,Nt);break}}}ne&&!$&&(nt=t(nt,1/0));var Tt=bt.length+nt.length+jt.length,Yt=Tt<Z?new Array(Z-Tt+1).join(I):"";switch(ne&&$&&(nt=t(Yt+nt,Yt.length?Z-jt.length:1/0),Yt=""),R){case"<":nt=bt+nt+jt+Yt;break;case"=":nt=bt+Yt+nt+jt;break;case"^":nt=Yt.slice(0,Tt=Yt.length>>1)+bt+nt+jt+Yt.slice(Tt);break;default:nt=Yt+bt+nt+jt;break}return d(nt)}return tt.toString=function(){return P+""},tt}function E(P,I){var R=T((P=ww(P),P.type="f",P)),F=Math.max(-8,Math.min(8,Math.floor(x_(I)/3)))*3,W=Math.pow(10,-F),$=b9[8+F/3];return function(Z){return R(W*Z)+$}}return{format:T,formatPrefix:E}}var $S,LD,ZZ;h4e({thousands:",",grouping:[3],currency:["$",""]});function h4e(e){return $S=d4e(e),LD=$S.format,ZZ=$S.formatPrefix,$S}function f4e(e){return Math.max(0,-x_(Math.abs(e)))}function p4e(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(x_(t)/3)))*3-x_(Math.abs(e)))}function m4e(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,x_(t)-x_(e))+1}function XZ(e,t,n,r){var l=q5(e,t,n),d;switch(r=ww(r??",f"),r.type){case"s":{var p=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(d=p4e(l,p))&&(r.precision=d),ZZ(r,p)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(d=m4e(l,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=d-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(d=f4e(l))&&(r.precision=d-(r.type==="%")*2);break}}return LD(r)}function mx(e){var t=e.domain;return e.ticks=function(n){var r=t();return U5(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var l=t();return XZ(l[0],l[l.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),l=0,d=r.length-1,p=r[l],a=r[d],b,T,E=10;for(a<p&&(T=p,p=a,a=T,T=l,l=d,d=T);E-- >0;){if(T=$5(p,a,n),T===b)return r[l]=p,r[d]=a,t(r);if(T>0)p=Math.floor(p/T)*T,a=Math.ceil(a/T)*T;else if(T<0)p=Math.ceil(p*T)/T,a=Math.floor(a*T)/T;else break;b=T}return e},e}function KZ(){var e=RD();return e.copy=function(){return Kw(e,KZ())},qd.apply(e,arguments),mx(e)}function YZ(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,_E),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return YZ(e).unknown(t)},e=arguments.length?Array.from(e,_E):[0,1],mx(n)}function QZ(e,t){e=e.slice();var n=0,r=e.length-1,l=e[n],d=e[r],p;return d<l&&(p=n,n=r,r=p,p=l,l=d,d=p),e[n]=t.floor(l),e[r]=t.ceil(d),e}function w9(e){return Math.log(e)}function S9(e){return Math.exp(e)}function g4e(e){return-Math.log(-e)}function x4e(e){return-Math.exp(-e)}function y4e(e){return isFinite(e)?+("1e"+e):e<0?0:e}function v4e(e){return e===10?y4e:e===Math.E?Math.exp:t=>Math.pow(e,t)}function _4e(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function T9(e){return(t,n)=>-e(-t,n)}function FD(e){const t=e(w9,S9),n=t.domain;let r=10,l,d;function p(){return l=_4e(r),d=v4e(r),n()[0]<0?(l=T9(l),d=T9(d),e(g4e,x4e)):e(w9,S9),t}return t.base=function(a){return arguments.length?(r=+a,p()):r},t.domain=function(a){return arguments.length?(n(a),p()):n()},t.ticks=a=>{const b=n();let T=b[0],E=b[b.length-1];const P=E<T;P&&([T,E]=[E,T]);let I=l(T),R=l(E),F,W;const $=a==null?10:+a;let Z=[];if(!(r%1)&&R-I<$){if(I=Math.floor(I),R=Math.ceil(R),T>0){for(;I<=R;++I)for(F=1;F<r;++F)if(W=I<0?F/d(-I):F*d(I),!(W<T)){if(W>E)break;Z.push(W)}}else for(;I<=R;++I)for(F=r-1;F>=1;--F)if(W=I>0?F/d(-I):F*d(I),!(W<T)){if(W>E)break;Z.push(W)}Z.length*2<$&&(Z=U5(T,E,$))}else Z=U5(I,R,Math.min(R-I,$)).map(d);return P?Z.reverse():Z},t.tickFormat=(a,b)=>{if(a==null&&(a=10),b==null&&(b=r===10?"s":","),typeof b!="function"&&(!(r%1)&&(b=ww(b)).precision==null&&(b.trim=!0),b=LD(b)),a===1/0)return b;const T=Math.max(1,r*a/t.ticks().length);return E=>{let P=E/d(Math.round(l(E)));return P*r<r-.5&&(P*=r),P<=T?b(E):""}},t.nice=()=>n(QZ(n(),{floor:a=>d(Math.floor(l(a))),ceil:a=>d(Math.ceil(l(a)))})),t}function JZ(){const e=FD(I3()).domain([1,10]);return e.copy=()=>Kw(e,JZ()).base(e.base()),qd.apply(e,arguments),e}function E9(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function A9(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function BD(e){var t=1,n=e(E9(t),A9(t));return n.constant=function(r){return arguments.length?e(E9(t=+r),A9(t)):t},mx(n)}function eX(){var e=BD(I3());return e.copy=function(){return Kw(e,eX()).constant(e.constant())},qd.apply(e,arguments)}function C9(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function b4e(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function w4e(e){return e<0?-e*e:e*e}function VD(e){var t=e(wc,wc),n=1;function r(){return n===1?e(wc,wc):n===.5?e(b4e,w4e):e(C9(n),C9(1/n))}return t.exponent=function(l){return arguments.length?(n=+l,r()):n},mx(t)}function UD(){var e=VD(I3());return e.copy=function(){return Kw(e,UD()).exponent(e.exponent())},qd.apply(e,arguments),e}function S4e(){return UD.apply(null,arguments).exponent(.5)}function j9(e){return Math.sign(e)*e*e}function T4e(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function tX(){var e=RD(),t=[0,1],n=!1,r;function l(d){var p=T4e(e(d));return isNaN(p)?r:n?Math.round(p):p}return l.invert=function(d){return e.invert(j9(d))},l.domain=function(d){return arguments.length?(e.domain(d),l):e.domain()},l.range=function(d){return arguments.length?(e.range((t=Array.from(d,_E)).map(j9)),l):t.slice()},l.rangeRound=function(d){return l.range(d).round(!0)},l.round=function(d){return arguments.length?(n=!!d,l):n},l.clamp=function(d){return arguments.length?(e.clamp(d),l):e.clamp()},l.unknown=function(d){return arguments.length?(r=d,l):r},l.copy=function(){return tX(e.domain(),t).round(n).clamp(e.clamp()).unknown(r)},qd.apply(l,arguments),mx(l)}function nX(){var e=[],t=[],n=[],r;function l(){var p=0,a=Math.max(1,t.length);for(n=new Array(a-1);++p<a;)n[p-1]=jCe(e,p/a);return d}function d(p){return p==null||isNaN(p=+p)?r:t[Zw(n,p)]}return d.invertExtent=function(p){var a=t.indexOf(p);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},d.domain=function(p){if(!arguments.length)return e.slice();e=[];for(let a of p)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Yg),l()},d.range=function(p){return arguments.length?(t=Array.from(p),l()):t.slice()},d.unknown=function(p){return arguments.length?(r=p,d):r},d.quantiles=function(){return n.slice()},d.copy=function(){return nX().domain(e).range(t).unknown(r)},qd.apply(d,arguments)}function rX(){var e=0,t=1,n=1,r=[.5],l=[0,1],d;function p(b){return b!=null&&b<=b?l[Zw(r,b,0,n)]:d}function a(){var b=-1;for(r=new Array(n);++b<n;)r[b]=((b+1)*t-(b-n)*e)/(n+1);return p}return p.domain=function(b){return arguments.length?([e,t]=b,e=+e,t=+t,a()):[e,t]},p.range=function(b){return arguments.length?(n=(l=Array.from(b)).length-1,a()):l.slice()},p.invertExtent=function(b){var T=l.indexOf(b);return T<0?[NaN,NaN]:T<1?[e,r[0]]:T>=n?[r[n-1],t]:[r[T-1],r[T]]},p.unknown=function(b){return arguments.length&&(d=b),p},p.thresholds=function(){return r.slice()},p.copy=function(){return rX().domain([e,t]).range(l).unknown(d)},qd.apply(mx(p),arguments)}function iX(){var e=[.5],t=[0,1],n,r=1;function l(d){return d!=null&&d<=d?t[Zw(e,d,0,r)]:n}return l.domain=function(d){return arguments.length?(e=Array.from(d),r=Math.min(e.length,t.length-1),l):e.slice()},l.range=function(d){return arguments.length?(t=Array.from(d),r=Math.min(e.length,t.length-1),l):t.slice()},l.invertExtent=function(d){var p=t.indexOf(d);return[e[p-1],e[p]]},l.unknown=function(d){return arguments.length?(n=d,l):n},l.copy=function(){return iX().domain(e).range(t).unknown(n)},qd.apply(l,arguments)}const Fj=new Date,Bj=new Date;function Po(e,t,n,r){function l(d){return e(d=arguments.length===0?new Date:new Date(+d)),d}return l.floor=d=>(e(d=new Date(+d)),d),l.ceil=d=>(e(d=new Date(d-1)),t(d,1),e(d),d),l.round=d=>{const p=l(d),a=l.ceil(d);return d-p<a-d?p:a},l.offset=(d,p)=>(t(d=new Date(+d),p==null?1:Math.floor(p)),d),l.range=(d,p,a)=>{const b=[];if(d=l.ceil(d),a=a==null?1:Math.floor(a),!(d<p)||!(a>0))return b;let T;do b.push(T=new Date(+d)),t(d,a),e(d);while(T<d&&d<p);return b},l.filter=d=>Po(p=>{if(p>=p)for(;e(p),!d(p);)p.setTime(p-1)},(p,a)=>{if(p>=p)if(a<0)for(;++a<=0;)for(;t(p,-1),!d(p););else for(;--a>=0;)for(;t(p,1),!d(p););}),n&&(l.count=(d,p)=>(Fj.setTime(+d),Bj.setTime(+p),e(Fj),e(Bj),Math.floor(n(Fj,Bj))),l.every=d=>(d=Math.floor(d),!isFinite(d)||!(d>0)?null:d>1?l.filter(r?p=>r(p)%d===0:p=>l.count(0,p)%d===0):l)),l}const wE=Po(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);wE.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Po(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):wE);wE.range;const wm=1e3,Rd=wm*60,Sm=Rd*60,Om=Sm*24,$D=Om*7,M9=Om*30,Vj=Om*365,Z0=Po(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*wm)},(e,t)=>(t-e)/wm,e=>e.getUTCSeconds());Z0.range;const qD=Po(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*wm)},(e,t)=>{e.setTime(+e+t*Rd)},(e,t)=>(t-e)/Rd,e=>e.getMinutes());qD.range;const HD=Po(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Rd)},(e,t)=>(t-e)/Rd,e=>e.getUTCMinutes());HD.range;const GD=Po(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*wm-e.getMinutes()*Rd)},(e,t)=>{e.setTime(+e+t*Sm)},(e,t)=>(t-e)/Sm,e=>e.getHours());GD.range;const WD=Po(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Sm)},(e,t)=>(t-e)/Sm,e=>e.getUTCHours());WD.range;const Yw=Po(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Rd)/Om,e=>e.getDate()-1);Yw.range;const k3=Po(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Om,e=>e.getUTCDate()-1);k3.range;const aX=Po(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Om,e=>Math.floor(e/Om));aX.range;function Ny(e){return Po(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Rd)/$D)}const R3=Ny(0),SE=Ny(1),E4e=Ny(2),A4e=Ny(3),y_=Ny(4),C4e=Ny(5),j4e=Ny(6);R3.range;SE.range;E4e.range;A4e.range;y_.range;C4e.range;j4e.range;function Dy(e){return Po(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/$D)}const z3=Dy(0),TE=Dy(1),M4e=Dy(2),P4e=Dy(3),v_=Dy(4),N4e=Dy(5),D4e=Dy(6);z3.range;TE.range;M4e.range;P4e.range;v_.range;N4e.range;D4e.range;const ZD=Po(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());ZD.range;const XD=Po(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());XD.range;const Im=Po(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Im.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Po(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Im.range;const km=Po(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());km.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Po(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});km.range;function sX(e,t,n,r,l,d){const p=[[Z0,1,wm],[Z0,5,5*wm],[Z0,15,15*wm],[Z0,30,30*wm],[d,1,Rd],[d,5,5*Rd],[d,15,15*Rd],[d,30,30*Rd],[l,1,Sm],[l,3,3*Sm],[l,6,6*Sm],[l,12,12*Sm],[r,1,Om],[r,2,2*Om],[n,1,$D],[t,1,M9],[t,3,3*M9],[e,1,Vj]];function a(T,E,P){const I=E<T;I&&([T,E]=[E,T]);const R=P&&typeof P.range=="function"?P:b(T,E,P),F=R?R.range(T,+E+1):[];return I?F.reverse():F}function b(T,E,P){const I=Math.abs(E-T)/P,R=PD(([,,$])=>$).right(p,I);if(R===p.length)return e.every(q5(T/Vj,E/Vj,P));if(R===0)return wE.every(Math.max(q5(T,E,P),1));const[F,W]=p[I/p[R-1][2]<p[R][2]/I?R-1:R];return F.every(W)}return[a,b]}const[O4e,I4e]=sX(km,XD,z3,aX,WD,HD),[k4e,R4e]=sX(Im,ZD,R3,Yw,GD,qD);function Uj(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function $j(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function hb(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function z4e(e){var t=e.dateTime,n=e.date,r=e.time,l=e.periods,d=e.days,p=e.shortDays,a=e.months,b=e.shortMonths,T=fb(l),E=pb(l),P=fb(d),I=pb(d),R=fb(p),F=pb(p),W=fb(a),$=pb(a),Z=fb(b),ne=pb(b),ie={a:ut,A:Tt,b:Yt,B:Ge,c:null,d:k9,e:k9,f:sje,g:gje,G:yje,H:rje,I:ije,j:aje,L:oX,m:oje,M:lje,p:ot,q:mt,Q:L9,s:F9,S:cje,u:uje,U:dje,V:hje,w:fje,W:pje,x:null,X:null,y:mje,Y:xje,Z:vje,"%":z9},ge={a:It,A:In,b:Mn,B:vn,c:null,d:R9,e:R9,f:Sje,g:Oje,G:kje,H:_je,I:bje,j:wje,L:cX,m:Tje,M:Eje,p:Zn,q:Sr,Q:L9,s:F9,S:Aje,u:Cje,U:jje,V:Mje,w:Pje,W:Nje,x:null,X:null,y:Dje,Y:Ije,Z:Rje,"%":z9},ae={a:tt,A:nt,b:bt,B:jt,c:Nt,d:O9,e:O9,f:J4e,g:D9,G:N9,H:I9,I:I9,j:X4e,L:Q4e,m:Z4e,M:K4e,p:qe,q:W4e,Q:tje,s:nje,S:Y4e,u:U4e,U:$4e,V:q4e,w:V4e,W:H4e,x:vt,X:He,y:D9,Y:N9,Z:G4e,"%":eje};ie.x=se(n,ie),ie.X=se(r,ie),ie.c=se(t,ie),ge.x=se(n,ge),ge.X=se(r,ge),ge.c=se(t,ge);function se(un,er){return function(hr){var dn=[],Ir=-1,Zr=0,sa=un.length,Mi,Ci,ls;for(hr instanceof Date||(hr=new Date(+hr));++Ir<sa;)un.charCodeAt(Ir)===37&&(dn.push(un.slice(Zr,Ir)),(Ci=P9[Mi=un.charAt(++Ir)])!=null?Mi=un.charAt(++Ir):Ci=Mi==="e"?" ":"0",(ls=er[Mi])&&(Mi=ls(hr,Ci)),dn.push(Mi),Zr=Ir+1);return dn.push(un.slice(Zr,Ir)),dn.join("")}}function me(un,er){return function(hr){var dn=hb(1900,void 0,1),Ir=ke(dn,un,hr+="",0),Zr,sa;if(Ir!=hr.length)return null;if("Q"in dn)return new Date(dn.Q);if("s"in dn)return new Date(dn.s*1e3+("L"in dn?dn.L:0));if(er&&!("Z"in dn)&&(dn.Z=0),"p"in dn&&(dn.H=dn.H%12+dn.p*12),dn.m===void 0&&(dn.m="q"in dn?dn.q:0),"V"in dn){if(dn.V<1||dn.V>53)return null;"w"in dn||(dn.w=1),"Z"in dn?(Zr=$j(hb(dn.y,0,1)),sa=Zr.getUTCDay(),Zr=sa>4||sa===0?TE.ceil(Zr):TE(Zr),Zr=k3.offset(Zr,(dn.V-1)*7),dn.y=Zr.getUTCFullYear(),dn.m=Zr.getUTCMonth(),dn.d=Zr.getUTCDate()+(dn.w+6)%7):(Zr=Uj(hb(dn.y,0,1)),sa=Zr.getDay(),Zr=sa>4||sa===0?SE.ceil(Zr):SE(Zr),Zr=Yw.offset(Zr,(dn.V-1)*7),dn.y=Zr.getFullYear(),dn.m=Zr.getMonth(),dn.d=Zr.getDate()+(dn.w+6)%7)}else("W"in dn||"U"in dn)&&("w"in dn||(dn.w="u"in dn?dn.u%7:"W"in dn?1:0),sa="Z"in dn?$j(hb(dn.y,0,1)).getUTCDay():Uj(hb(dn.y,0,1)).getDay(),dn.m=0,dn.d="W"in dn?(dn.w+6)%7+dn.W*7-(sa+5)%7:dn.w+dn.U*7-(sa+6)%7);return"Z"in dn?(dn.H+=dn.Z/100|0,dn.M+=dn.Z%100,$j(dn)):Uj(dn)}}function ke(un,er,hr,dn){for(var Ir=0,Zr=er.length,sa=hr.length,Mi,Ci;Ir<Zr;){if(dn>=sa)return-1;if(Mi=er.charCodeAt(Ir++),Mi===37){if(Mi=er.charAt(Ir++),Ci=ae[Mi in P9?er.charAt(Ir++):Mi],!Ci||(dn=Ci(un,hr,dn))<0)return-1}else if(Mi!=hr.charCodeAt(dn++))return-1}return dn}function qe(un,er,hr){var dn=T.exec(er.slice(hr));return dn?(un.p=E.get(dn[0].toLowerCase()),hr+dn[0].length):-1}function tt(un,er,hr){var dn=R.exec(er.slice(hr));return dn?(un.w=F.get(dn[0].toLowerCase()),hr+dn[0].length):-1}function nt(un,er,hr){var dn=P.exec(er.slice(hr));return dn?(un.w=I.get(dn[0].toLowerCase()),hr+dn[0].length):-1}function bt(un,er,hr){var dn=Z.exec(er.slice(hr));return dn?(un.m=ne.get(dn[0].toLowerCase()),hr+dn[0].length):-1}function jt(un,er,hr){var dn=W.exec(er.slice(hr));return dn?(un.m=$.get(dn[0].toLowerCase()),hr+dn[0].length):-1}function Nt(un,er,hr){return ke(un,t,er,hr)}function vt(un,er,hr){return ke(un,n,er,hr)}function He(un,er,hr){return ke(un,r,er,hr)}function ut(un){return p[un.getDay()]}function Tt(un){return d[un.getDay()]}function Yt(un){return b[un.getMonth()]}function Ge(un){return a[un.getMonth()]}function ot(un){return l[+(un.getHours()>=12)]}function mt(un){return 1+~~(un.getMonth()/3)}function It(un){return p[un.getUTCDay()]}function In(un){return d[un.getUTCDay()]}function Mn(un){return b[un.getUTCMonth()]}function vn(un){return a[un.getUTCMonth()]}function Zn(un){return l[+(un.getUTCHours()>=12)]}function Sr(un){return 1+~~(un.getUTCMonth()/3)}return{format:function(un){var er=se(un+="",ie);return er.toString=function(){return un},er},parse:function(un){var er=me(un+="",!1);return er.toString=function(){return un},er},utcFormat:function(un){var er=se(un+="",ge);return er.toString=function(){return un},er},utcParse:function(un){var er=me(un+="",!0);return er.toString=function(){return un},er}}}var P9={"-":"",_:" ",0:"0"},Qo=/^\s*\d+/,L4e=/^%/,F4e=/[\\^$*+?|[\]().{}]/g;function da(e,t,n){var r=e<0?"-":"",l=(r?-e:e)+"",d=l.length;return r+(d<n?new Array(n-d+1).join(t)+l:l)}function B4e(e){return e.replace(F4e,"\\$&")}function fb(e){return new RegExp("^(?:"+e.map(B4e).join("|")+")","i")}function pb(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function V4e(e,t,n){var r=Qo.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function U4e(e,t,n){var r=Qo.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function $4e(e,t,n){var r=Qo.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function q4e(e,t,n){var r=Qo.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function H4e(e,t,n){var r=Qo.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function N9(e,t,n){var r=Qo.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function D9(e,t,n){var r=Qo.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function G4e(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function W4e(e,t,n){var r=Qo.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function Z4e(e,t,n){var r=Qo.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function O9(e,t,n){var r=Qo.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function X4e(e,t,n){var r=Qo.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function I9(e,t,n){var r=Qo.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function K4e(e,t,n){var r=Qo.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Y4e(e,t,n){var r=Qo.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Q4e(e,t,n){var r=Qo.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function J4e(e,t,n){var r=Qo.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function eje(e,t,n){var r=L4e.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function tje(e,t,n){var r=Qo.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function nje(e,t,n){var r=Qo.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function k9(e,t){return da(e.getDate(),t,2)}function rje(e,t){return da(e.getHours(),t,2)}function ije(e,t){return da(e.getHours()%12||12,t,2)}function aje(e,t){return da(1+Yw.count(Im(e),e),t,3)}function oX(e,t){return da(e.getMilliseconds(),t,3)}function sje(e,t){return oX(e,t)+"000"}function oje(e,t){return da(e.getMonth()+1,t,2)}function lje(e,t){return da(e.getMinutes(),t,2)}function cje(e,t){return da(e.getSeconds(),t,2)}function uje(e){var t=e.getDay();return t===0?7:t}function dje(e,t){return da(R3.count(Im(e)-1,e),t,2)}function lX(e){var t=e.getDay();return t>=4||t===0?y_(e):y_.ceil(e)}function hje(e,t){return e=lX(e),da(y_.count(Im(e),e)+(Im(e).getDay()===4),t,2)}function fje(e){return e.getDay()}function pje(e,t){return da(SE.count(Im(e)-1,e),t,2)}function mje(e,t){return da(e.getFullYear()%100,t,2)}function gje(e,t){return e=lX(e),da(e.getFullYear()%100,t,2)}function xje(e,t){return da(e.getFullYear()%1e4,t,4)}function yje(e,t){var n=e.getDay();return e=n>=4||n===0?y_(e):y_.ceil(e),da(e.getFullYear()%1e4,t,4)}function vje(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+da(t/60|0,"0",2)+da(t%60,"0",2)}function R9(e,t){return da(e.getUTCDate(),t,2)}function _je(e,t){return da(e.getUTCHours(),t,2)}function bje(e,t){return da(e.getUTCHours()%12||12,t,2)}function wje(e,t){return da(1+k3.count(km(e),e),t,3)}function cX(e,t){return da(e.getUTCMilliseconds(),t,3)}function Sje(e,t){return cX(e,t)+"000"}function Tje(e,t){return da(e.getUTCMonth()+1,t,2)}function Eje(e,t){return da(e.getUTCMinutes(),t,2)}function Aje(e,t){return da(e.getUTCSeconds(),t,2)}function Cje(e){var t=e.getUTCDay();return t===0?7:t}function jje(e,t){return da(z3.count(km(e)-1,e),t,2)}function uX(e){var t=e.getUTCDay();return t>=4||t===0?v_(e):v_.ceil(e)}function Mje(e,t){return e=uX(e),da(v_.count(km(e),e)+(km(e).getUTCDay()===4),t,2)}function Pje(e){return e.getUTCDay()}function Nje(e,t){return da(TE.count(km(e)-1,e),t,2)}function Dje(e,t){return da(e.getUTCFullYear()%100,t,2)}function Oje(e,t){return e=uX(e),da(e.getUTCFullYear()%100,t,2)}function Ije(e,t){return da(e.getUTCFullYear()%1e4,t,4)}function kje(e,t){var n=e.getUTCDay();return e=n>=4||n===0?v_(e):v_.ceil(e),da(e.getUTCFullYear()%1e4,t,4)}function Rje(){return"+0000"}function z9(){return"%"}function L9(e){return+e}function F9(e){return Math.floor(+e/1e3)}var qv,dX,hX;zje({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function zje(e){return qv=z4e(e),dX=qv.format,qv.parse,hX=qv.utcFormat,qv.utcParse,qv}function Lje(e){return new Date(e)}function Fje(e){return e instanceof Date?+e:+new Date(+e)}function KD(e,t,n,r,l,d,p,a,b,T){var E=RD(),P=E.invert,I=E.domain,R=T(".%L"),F=T(":%S"),W=T("%I:%M"),$=T("%I %p"),Z=T("%a %d"),ne=T("%b %d"),ie=T("%B"),ge=T("%Y");function ae(se){return(b(se)<se?R:a(se)<se?F:p(se)<se?W:d(se)<se?$:r(se)<se?l(se)<se?Z:ne:n(se)<se?ie:ge)(se)}return E.invert=function(se){return new Date(P(se))},E.domain=function(se){return arguments.length?I(Array.from(se,Fje)):I().map(Lje)},E.ticks=function(se){var me=I();return e(me[0],me[me.length-1],se??10)},E.tickFormat=function(se,me){return me==null?ae:T(me)},E.nice=function(se){var me=I();return(!se||typeof se.range!="function")&&(se=t(me[0],me[me.length-1],se??10)),se?I(QZ(me,se)):E},E.copy=function(){return Kw(E,KD(e,t,n,r,l,d,p,a,b,T))},E}function Bje(){return qd.apply(KD(k4e,R4e,Im,ZD,R3,Yw,GD,qD,Z0,dX).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Vje(){return qd.apply(KD(O4e,I4e,km,XD,z3,k3,WD,HD,Z0,hX).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function L3(){var e=0,t=1,n,r,l,d,p=wc,a=!1,b;function T(P){return P==null||isNaN(P=+P)?b:p(l===0?.5:(P=(d(P)-n)*l,a?Math.max(0,Math.min(1,P)):P))}T.domain=function(P){return arguments.length?([e,t]=P,n=d(e=+e),r=d(t=+t),l=n===r?0:1/(r-n),T):[e,t]},T.clamp=function(P){return arguments.length?(a=!!P,T):a},T.interpolator=function(P){return arguments.length?(p=P,T):p};function E(P){return function(I){var R,F;return arguments.length?([R,F]=I,p=P(R,F),T):[p(0),p(1)]}}return T.range=E(D_),T.rangeRound=E(kD),T.unknown=function(P){return arguments.length?(b=P,T):b},function(P){return d=P,n=P(e),r=P(t),l=n===r?0:1/(r-n),T}}function gx(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function fX(){var e=mx(L3()(wc));return e.copy=function(){return gx(e,fX())},Um.apply(e,arguments)}function pX(){var e=FD(L3()).domain([1,10]);return e.copy=function(){return gx(e,pX()).base(e.base())},Um.apply(e,arguments)}function mX(){var e=BD(L3());return e.copy=function(){return gx(e,mX()).constant(e.constant())},Um.apply(e,arguments)}function YD(){var e=VD(L3());return e.copy=function(){return gx(e,YD()).exponent(e.exponent())},Um.apply(e,arguments)}function Uje(){return YD.apply(null,arguments).exponent(.5)}function gX(){var e=[],t=wc;function n(r){if(r!=null&&!isNaN(r=+r))return t((Zw(e,r,1)-1)/(e.length-1))}return n.domain=function(r){if(!arguments.length)return e.slice();e=[];for(let l of r)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Yg),n},n.interpolator=function(r){return arguments.length?(t=r,n):t},n.range=function(){return e.map((r,l)=>t(l/(e.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(l,d)=>CCe(e,d/r))},n.copy=function(){return gX(t).domain(e)},Um.apply(n,arguments)}function F3(){var e=0,t=.5,n=1,r=1,l,d,p,a,b,T=wc,E,P=!1,I;function R(W){return isNaN(W=+W)?I:(W=.5+((W=+E(W))-d)*(r*W<r*d?a:b),T(P?Math.max(0,Math.min(1,W)):W))}R.domain=function(W){return arguments.length?([e,t,n]=W,l=E(e=+e),d=E(t=+t),p=E(n=+n),a=l===d?0:.5/(d-l),b=d===p?0:.5/(p-d),r=d<l?-1:1,R):[e,t,n]},R.clamp=function(W){return arguments.length?(P=!!W,R):P},R.interpolator=function(W){return arguments.length?(T=W,R):T};function F(W){return function($){var Z,ne,ie;return arguments.length?([Z,ne,ie]=$,T=e4e(W,[Z,ne,ie]),R):[T(0),T(.5),T(1)]}}return R.range=F(D_),R.rangeRound=F(kD),R.unknown=function(W){return arguments.length?(I=W,R):I},function(W){return E=W,l=W(e),d=W(t),p=W(n),a=l===d?0:.5/(d-l),b=d===p?0:.5/(p-d),r=d<l?-1:1,R}}function xX(){var e=mx(F3()(wc));return e.copy=function(){return gx(e,xX())},Um.apply(e,arguments)}function yX(){var e=FD(F3()).domain([.1,1,10]);return e.copy=function(){return gx(e,yX()).base(e.base())},Um.apply(e,arguments)}function vX(){var e=BD(F3());return e.copy=function(){return gx(e,vX()).constant(e.constant())},Um.apply(e,arguments)}function QD(){var e=VD(F3());return e.copy=function(){return gx(e,QD()).exponent(e.exponent())},Um.apply(e,arguments)}function $je(){return QD.apply(null,arguments).exponent(.5)}const Tb=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:DD,scaleDiverging:xX,scaleDivergingLog:yX,scaleDivergingPow:QD,scaleDivergingSqrt:$je,scaleDivergingSymlog:vX,scaleIdentity:YZ,scaleImplicit:H5,scaleLinear:KZ,scaleLog:JZ,scaleOrdinal:ND,scalePoint:PCe,scalePow:UD,scaleQuantile:nX,scaleQuantize:rX,scaleRadial:tX,scaleSequential:fX,scaleSequentialLog:pX,scaleSequentialPow:YD,scaleSequentialQuantile:gX,scaleSequentialSqrt:Uje,scaleSequentialSymlog:mX,scaleSqrt:S4e,scaleSymlog:eX,scaleThreshold:iX,scaleTime:Bje,scaleUtc:Vje,tickFormat:XZ},Symbol.toStringTag,{value:"Module"}));var Oy=e=>e.chartData,JD=tn([Oy],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),eO=(e,t,n,r)=>r?JD(e):Oy(e);function __(e){if(Array.isArray(e)&&e.length===2){var[t,n]=e;if(xl(t)&&xl(n))return!0}return!1}function B9(e,t,n){return n?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function qje(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[n,r]=e,l,d;if(xl(n))l=n;else if(typeof n=="function")return;if(xl(r))d=r;else if(typeof r=="function")return;var p=[l,d];if(__(p))return p}}function Hje(e,t,n){if(!(!n&&t==null)){if(typeof e=="function"&&t!=null)try{var r=e(t,n);if(__(r))return B9(r,t,n)}catch{}if(Array.isArray(e)&&e.length===2){var[l,d]=e,p,a;if(l==="auto")t!=null&&(p=Math.min(...t));else if(lr(l))p=l;else if(typeof l=="function")try{t!=null&&(p=l(t==null?void 0:t[0]))}catch{}else if(typeof l=="string"&&MB.test(l)){var b=MB.exec(l);if(b==null||t==null)p=void 0;else{var T=+b[1];p=t[0]-T}}else p=t==null?void 0:t[0];if(d==="auto")t!=null&&(a=Math.max(...t));else if(lr(d))a=d;else if(typeof d=="function")try{t!=null&&(a=d(t==null?void 0:t[1]))}catch{}else if(typeof d=="string"&&PB.test(d)){var E=PB.exec(d);if(E==null||t==null)a=void 0;else{var P=+E[1];a=t[1]+P}}else a=t==null?void 0:t[1];var I=[p,a];if(__(I))return t==null?I:B9(I,t,n)}}}var O_=1e9,Gje={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},nO,os=!0,Bd="[DecimalError] ",sy=Bd+"Invalid argument: ",tO=Bd+"Exponent out of range: ",I_=Math.floor,L0=Math.pow,Wje=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Iu,Xo=1e7,ts=7,_X=9007199254740991,EE=I_(_X/ts),_r={};_r.absoluteValue=_r.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};_r.comparedTo=_r.cmp=function(e){var t,n,r,l,d=this;if(e=new d.constructor(e),d.s!==e.s)return d.s||-e.s;if(d.e!==e.e)return d.e>e.e^d.s<0?1:-1;for(r=d.d.length,l=e.d.length,t=0,n=r<l?r:l;t<n;++t)if(d.d[t]!==e.d[t])return d.d[t]>e.d[t]^d.s<0?1:-1;return r===l?0:r>l^d.s<0?1:-1};_r.decimalPlaces=_r.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*ts;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};_r.dividedBy=_r.div=function(e){return jm(this,new this.constructor(e))};_r.dividedToIntegerBy=_r.idiv=function(e){var t=this,n=t.constructor;return Va(jm(t,new n(e),0,1),n.precision)};_r.equals=_r.eq=function(e){return!this.cmp(e)};_r.exponent=function(){return po(this)};_r.greaterThan=_r.gt=function(e){return this.cmp(e)>0};_r.greaterThanOrEqualTo=_r.gte=function(e){return this.cmp(e)>=0};_r.isInteger=_r.isint=function(){return this.e>this.d.length-2};_r.isNegative=_r.isneg=function(){return this.s<0};_r.isPositive=_r.ispos=function(){return this.s>0};_r.isZero=function(){return this.s===0};_r.lessThan=_r.lt=function(e){return this.cmp(e)<0};_r.lessThanOrEqualTo=_r.lte=function(e){return this.cmp(e)<1};_r.logarithm=_r.log=function(e){var t,n=this,r=n.constructor,l=r.precision,d=l+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(Iu))throw Error(Bd+"NaN");if(n.s<1)throw Error(Bd+(n.s?"NaN":"-Infinity"));return n.eq(Iu)?new r(0):(os=!1,t=jm(Sw(n,d),Sw(e,d),d),os=!0,Va(t,l))};_r.minus=_r.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?SX(t,e):bX(t,(e.s=-e.s,e))};_r.modulo=_r.mod=function(e){var t,n=this,r=n.constructor,l=r.precision;if(e=new r(e),!e.s)throw Error(Bd+"NaN");return n.s?(os=!1,t=jm(n,e,0,1).times(e),os=!0,n.minus(t)):Va(new r(n),l)};_r.naturalExponential=_r.exp=function(){return wX(this)};_r.naturalLogarithm=_r.ln=function(){return Sw(this)};_r.negated=_r.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};_r.plus=_r.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?bX(t,e):SX(t,(e.s=-e.s,e))};_r.precision=_r.sd=function(e){var t,n,r,l=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(sy+e);if(t=po(l)+1,r=l.d.length-1,n=r*ts+1,r=l.d[r],r){for(;r%10==0;r/=10)n--;for(r=l.d[0];r>=10;r/=10)n++}return e&&t>n?t:n};_r.squareRoot=_r.sqrt=function(){var e,t,n,r,l,d,p,a=this,b=a.constructor;if(a.s<1){if(!a.s)return new b(0);throw Error(Bd+"NaN")}for(e=po(a),os=!1,l=Math.sqrt(+a),l==0||l==1/0?(t=Kf(a.d),(t.length+e)%2==0&&(t+="0"),l=Math.sqrt(t),e=I_((e+1)/2)-(e<0||e%2),l==1/0?t="5e"+e:(t=l.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new b(t)):r=new b(l.toString()),n=b.precision,l=p=n+3;;)if(d=r,r=d.plus(jm(a,d,p+2)).times(.5),Kf(d.d).slice(0,p)===(t=Kf(r.d)).slice(0,p)){if(t=t.slice(p-3,p+1),l==p&&t=="4999"){if(Va(d,n+1,0),d.times(d).eq(a)){r=d;break}}else if(t!="9999")break;p+=4}return os=!0,Va(r,n)};_r.times=_r.mul=function(e){var t,n,r,l,d,p,a,b,T,E=this,P=E.constructor,I=E.d,R=(e=new P(e)).d;if(!E.s||!e.s)return new P(0);for(e.s*=E.s,n=E.e+e.e,b=I.length,T=R.length,b<T&&(d=I,I=R,R=d,p=b,b=T,T=p),d=[],p=b+T,r=p;r--;)d.push(0);for(r=T;--r>=0;){for(t=0,l=b+r;l>r;)a=d[l]+R[r]*I[l-r-1]+t,d[l--]=a%Xo|0,t=a/Xo|0;d[l]=(d[l]+t)%Xo|0}for(;!d[--p];)d.pop();return t?++n:d.shift(),e.d=d,e.e=n,os?Va(e,P.precision):e};_r.toDecimalPlaces=_r.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(sp(e,0,O_),t===void 0?t=r.rounding:sp(t,0,8),Va(n,e+po(n)+1,t))};_r.toExponential=function(e,t){var n,r=this,l=r.constructor;return e===void 0?n=yy(r,!0):(sp(e,0,O_),t===void 0?t=l.rounding:sp(t,0,8),r=Va(new l(r),e+1,t),n=yy(r,!0,e+1)),n};_r.toFixed=function(e,t){var n,r,l=this,d=l.constructor;return e===void 0?yy(l):(sp(e,0,O_),t===void 0?t=d.rounding:sp(t,0,8),r=Va(new d(l),e+po(l)+1,t),n=yy(r.abs(),!1,e+po(r)+1),l.isneg()&&!l.isZero()?"-"+n:n)};_r.toInteger=_r.toint=function(){var e=this,t=e.constructor;return Va(new t(e),po(e)+1,t.rounding)};_r.toNumber=function(){return+this};_r.toPower=_r.pow=function(e){var t,n,r,l,d,p,a=this,b=a.constructor,T=12,E=+(e=new b(e));if(!e.s)return new b(Iu);if(a=new b(a),!a.s){if(e.s<1)throw Error(Bd+"Infinity");return a}if(a.eq(Iu))return a;if(r=b.precision,e.eq(Iu))return Va(a,r);if(t=e.e,n=e.d.length-1,p=t>=n,d=a.s,p){if((n=E<0?-E:E)<=_X){for(l=new b(Iu),t=Math.ceil(r/ts+4),os=!1;n%2&&(l=l.times(a),U9(l.d,t)),n=I_(n/2),n!==0;)a=a.times(a),U9(a.d,t);return os=!0,e.s<0?new b(Iu).div(l):Va(l,r)}}else if(d<0)throw Error(Bd+"NaN");return d=d<0&&e.d[Math.max(t,n)]&1?-1:1,a.s=1,os=!1,l=e.times(Sw(a,r+T)),os=!0,l=wX(l),l.s=d,l};_r.toPrecision=function(e,t){var n,r,l=this,d=l.constructor;return e===void 0?(n=po(l),r=yy(l,n<=d.toExpNeg||n>=d.toExpPos)):(sp(e,1,O_),t===void 0?t=d.rounding:sp(t,0,8),l=Va(new d(l),e,t),n=po(l),r=yy(l,e<=n||n<=d.toExpNeg,e)),r};_r.toSignificantDigits=_r.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(sp(e,1,O_),t===void 0?t=r.rounding:sp(t,0,8)),Va(new r(n),e,t)};_r.toString=_r.valueOf=_r.val=_r.toJSON=_r[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=po(e),n=e.constructor;return yy(e,t<=n.toExpNeg||t>=n.toExpPos)};function bX(e,t){var n,r,l,d,p,a,b,T,E=e.constructor,P=E.precision;if(!e.s||!t.s)return t.s||(t=new E(e)),os?Va(t,P):t;if(b=e.d,T=t.d,p=e.e,l=t.e,b=b.slice(),d=p-l,d){for(d<0?(r=b,d=-d,a=T.length):(r=T,l=p,a=b.length),p=Math.ceil(P/ts),a=p>a?p+1:a+1,d>a&&(d=a,r.length=1),r.reverse();d--;)r.push(0);r.reverse()}for(a=b.length,d=T.length,a-d<0&&(d=a,r=T,T=b,b=r),n=0;d;)n=(b[--d]=b[d]+T[d]+n)/Xo|0,b[d]%=Xo;for(n&&(b.unshift(n),++l),a=b.length;b[--a]==0;)b.pop();return t.d=b,t.e=l,os?Va(t,P):t}function sp(e,t,n){if(e!==~~e||e<t||e>n)throw Error(sy+e)}function Kf(e){var t,n,r,l=e.length-1,d="",p=e[0];if(l>0){for(d+=p,t=1;t<l;t++)r=e[t]+"",n=ts-r.length,n&&(d+=Gg(n)),d+=r;p=e[t],r=p+"",n=ts-r.length,n&&(d+=Gg(n))}else if(p===0)return"0";for(;p%10===0;)p/=10;return d+p}var jm=function(){function e(r,l){var d,p=0,a=r.length;for(r=r.slice();a--;)d=r[a]*l+p,r[a]=d%Xo|0,p=d/Xo|0;return p&&r.unshift(p),r}function t(r,l,d,p){var a,b;if(d!=p)b=d>p?1:-1;else for(a=b=0;a<d;a++)if(r[a]!=l[a]){b=r[a]>l[a]?1:-1;break}return b}function n(r,l,d){for(var p=0;d--;)r[d]-=p,p=r[d]<l[d]?1:0,r[d]=p*Xo+r[d]-l[d];for(;!r[0]&&r.length>1;)r.shift()}return function(r,l,d,p){var a,b,T,E,P,I,R,F,W,$,Z,ne,ie,ge,ae,se,me,ke,qe=r.constructor,tt=r.s==l.s?1:-1,nt=r.d,bt=l.d;if(!r.s)return new qe(r);if(!l.s)throw Error(Bd+"Division by zero");for(b=r.e-l.e,me=bt.length,ae=nt.length,R=new qe(tt),F=R.d=[],T=0;bt[T]==(nt[T]||0);)++T;if(bt[T]>(nt[T]||0)&&--b,d==null?ne=d=qe.precision:p?ne=d+(po(r)-po(l))+1:ne=d,ne<0)return new qe(0);if(ne=ne/ts+2|0,T=0,me==1)for(E=0,bt=bt[0],ne++;(T<ae||E)&&ne--;T++)ie=E*Xo+(nt[T]||0),F[T]=ie/bt|0,E=ie%bt|0;else{for(E=Xo/(bt[0]+1)|0,E>1&&(bt=e(bt,E),nt=e(nt,E),me=bt.length,ae=nt.length),ge=me,W=nt.slice(0,me),$=W.length;$<me;)W[$++]=0;ke=bt.slice(),ke.unshift(0),se=bt[0],bt[1]>=Xo/2&&++se;do E=0,a=t(bt,W,me,$),a<0?(Z=W[0],me!=$&&(Z=Z*Xo+(W[1]||0)),E=Z/se|0,E>1?(E>=Xo&&(E=Xo-1),P=e(bt,E),I=P.length,$=W.length,a=t(P,W,I,$),a==1&&(E--,n(P,me<I?ke:bt,I))):(E==0&&(a=E=1),P=bt.slice()),I=P.length,I<$&&P.unshift(0),n(W,P,$),a==-1&&($=W.length,a=t(bt,W,me,$),a<1&&(E++,n(W,me<$?ke:bt,$))),$=W.length):a===0&&(E++,W=[0]),F[T++]=E,a&&W[0]?W[$++]=nt[ge]||0:(W=[nt[ge]],$=1);while((ge++<ae||W[0]!==void 0)&&ne--)}return F[0]||F.shift(),R.e=b,Va(R,p?d+po(R)+1:d)}}();function wX(e,t){var n,r,l,d,p,a,b=0,T=0,E=e.constructor,P=E.precision;if(po(e)>16)throw Error(tO+po(e));if(!e.s)return new E(Iu);for(os=!1,a=P,p=new E(.03125);e.abs().gte(.1);)e=e.times(p),T+=5;for(r=Math.log(L0(2,T))/Math.LN10*2+5|0,a+=r,n=l=d=new E(Iu),E.precision=a;;){if(l=Va(l.times(e),a),n=n.times(++b),p=d.plus(jm(l,n,a)),Kf(p.d).slice(0,a)===Kf(d.d).slice(0,a)){for(;T--;)d=Va(d.times(d),a);return E.precision=P,t==null?(os=!0,Va(d,P)):d}d=p}}function po(e){for(var t=e.e*ts,n=e.d[0];n>=10;n/=10)t++;return t}function qj(e,t,n){if(t>e.LN10.sd())throw os=!0,n&&(e.precision=n),Error(Bd+"LN10 precision limit exceeded");return Va(new e(e.LN10),t)}function Gg(e){for(var t="";e--;)t+="0";return t}function Sw(e,t){var n,r,l,d,p,a,b,T,E,P=1,I=10,R=e,F=R.d,W=R.constructor,$=W.precision;if(R.s<1)throw Error(Bd+(R.s?"NaN":"-Infinity"));if(R.eq(Iu))return new W(0);if(t==null?(os=!1,T=$):T=t,R.eq(10))return t==null&&(os=!0),qj(W,T);if(T+=I,W.precision=T,n=Kf(F),r=n.charAt(0),d=po(R),Math.abs(d)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)R=R.times(e),n=Kf(R.d),r=n.charAt(0),P++;d=po(R),r>1?(R=new W("0."+n),d++):R=new W(r+"."+n.slice(1))}else return b=qj(W,T+2,$).times(d+""),R=Sw(new W(r+"."+n.slice(1)),T-I).plus(b),W.precision=$,t==null?(os=!0,Va(R,$)):R;for(a=p=R=jm(R.minus(Iu),R.plus(Iu),T),E=Va(R.times(R),T),l=3;;){if(p=Va(p.times(E),T),b=a.plus(jm(p,new W(l),T)),Kf(b.d).slice(0,T)===Kf(a.d).slice(0,T))return a=a.times(2),d!==0&&(a=a.plus(qj(W,T+2,$).times(d+""))),a=jm(a,new W(P),T),W.precision=$,t==null?(os=!0,Va(a,$)):a;a=b,l+=2}}function V9(e,t){var n,r,l;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(l=t.length;t.charCodeAt(l-1)===48;)--l;if(t=t.slice(r,l),t){if(l-=r,n=n-r-1,e.e=I_(n/ts),e.d=[],r=(n+1)%ts,n<0&&(r+=ts),r<l){for(r&&e.d.push(+t.slice(0,r)),l-=ts;r<l;)e.d.push(+t.slice(r,r+=ts));t=t.slice(r),r=ts-t.length}else r-=l;for(;r--;)t+="0";if(e.d.push(+t),os&&(e.e>EE||e.e<-EE))throw Error(tO+n)}else e.s=0,e.e=0,e.d=[0];return e}function Va(e,t,n){var r,l,d,p,a,b,T,E,P=e.d;for(p=1,d=P[0];d>=10;d/=10)p++;if(r=t-p,r<0)r+=ts,l=t,T=P[E=0];else{if(E=Math.ceil((r+1)/ts),d=P.length,E>=d)return e;for(T=d=P[E],p=1;d>=10;d/=10)p++;r%=ts,l=r-ts+p}if(n!==void 0&&(d=L0(10,p-l-1),a=T/d%10|0,b=t<0||P[E+1]!==void 0||T%d,b=n<4?(a||b)&&(n==0||n==(e.s<0?3:2)):a>5||a==5&&(n==4||b||n==6&&(r>0?l>0?T/L0(10,p-l):0:P[E-1])%10&1||n==(e.s<0?8:7))),t<1||!P[0])return b?(d=po(e),P.length=1,t=t-d-1,P[0]=L0(10,(ts-t%ts)%ts),e.e=I_(-t/ts)||0):(P.length=1,P[0]=e.e=e.s=0),e;if(r==0?(P.length=E,d=1,E--):(P.length=E+1,d=L0(10,ts-r),P[E]=l>0?(T/L0(10,p-l)%L0(10,l)|0)*d:0),b)for(;;)if(E==0){(P[0]+=d)==Xo&&(P[0]=1,++e.e);break}else{if(P[E]+=d,P[E]!=Xo)break;P[E--]=0,d=1}for(r=P.length;P[--r]===0;)P.pop();if(os&&(e.e>EE||e.e<-EE))throw Error(tO+po(e));return e}function SX(e,t){var n,r,l,d,p,a,b,T,E,P,I=e.constructor,R=I.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new I(e),os?Va(t,R):t;if(b=e.d,P=t.d,r=t.e,T=e.e,b=b.slice(),p=T-r,p){for(E=p<0,E?(n=b,p=-p,a=P.length):(n=P,r=T,a=b.length),l=Math.max(Math.ceil(R/ts),a)+2,p>l&&(p=l,n.length=1),n.reverse(),l=p;l--;)n.push(0);n.reverse()}else{for(l=b.length,a=P.length,E=l<a,E&&(a=l),l=0;l<a;l++)if(b[l]!=P[l]){E=b[l]<P[l];break}p=0}for(E&&(n=b,b=P,P=n,t.s=-t.s),a=b.length,l=P.length-a;l>0;--l)b[a++]=0;for(l=P.length;l>p;){if(b[--l]<P[l]){for(d=l;d&&b[--d]===0;)b[d]=Xo-1;--b[d],b[l]+=Xo}b[l]-=P[l]}for(;b[--a]===0;)b.pop();for(;b[0]===0;b.shift())--r;return b[0]?(t.d=b,t.e=r,os?Va(t,R):t):new I(0)}function yy(e,t,n){var r,l=po(e),d=Kf(e.d),p=d.length;return t?(n&&(r=n-p)>0?d=d.charAt(0)+"."+d.slice(1)+Gg(r):p>1&&(d=d.charAt(0)+"."+d.slice(1)),d=d+(l<0?"e":"e+")+l):l<0?(d="0."+Gg(-l-1)+d,n&&(r=n-p)>0&&(d+=Gg(r))):l>=p?(d+=Gg(l+1-p),n&&(r=n-l-1)>0&&(d=d+"."+Gg(r))):((r=l+1)<p&&(d=d.slice(0,r)+"."+d.slice(r)),n&&(r=n-p)>0&&(l+1===p&&(d+="."),d+=Gg(r))),e.s<0?"-"+d:d}function U9(e,t){if(e.length>t)return e.length=t,!0}function TX(e){var t,n,r;function l(d){var p=this;if(!(p instanceof l))return new l(d);if(p.constructor=l,d instanceof l){p.s=d.s,p.e=d.e,p.d=(d=d.d)?d.slice():d;return}if(typeof d=="number"){if(d*0!==0)throw Error(sy+d);if(d>0)p.s=1;else if(d<0)d=-d,p.s=-1;else{p.s=0,p.e=0,p.d=[0];return}if(d===~~d&&d<1e7){p.e=0,p.d=[d];return}return V9(p,d.toString())}else if(typeof d!="string")throw Error(sy+d);if(d.charCodeAt(0)===45?(d=d.slice(1),p.s=-1):p.s=1,Wje.test(d))V9(p,d);else throw Error(sy+d)}if(l.prototype=_r,l.ROUND_UP=0,l.ROUND_DOWN=1,l.ROUND_CEIL=2,l.ROUND_FLOOR=3,l.ROUND_HALF_UP=4,l.ROUND_HALF_DOWN=5,l.ROUND_HALF_EVEN=6,l.ROUND_HALF_CEIL=7,l.ROUND_HALF_FLOOR=8,l.clone=TX,l.config=l.set=Zje,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return l.config(e),l}function Zje(e){if(!e||typeof e!="object")throw Error(Bd+"Object expected");var t,n,r,l=["precision",1,O_,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<l.length;t+=3)if((r=e[n=l[t]])!==void 0)if(I_(r)===r&&r>=l[t+1]&&r<=l[t+2])this[n]=r;else throw Error(sy+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(sy+n+": "+r);return this}var nO=TX(Gje);Iu=new nO(1);const Da=nO;var Xje=e=>e,EX={},AX=e=>e===EX,$9=e=>function t(){return arguments.length===0||arguments.length===1&&AX(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},CX=(e,t)=>e===1?t:$9(function(){for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];var d=r.filter(p=>p!==EX).length;return d>=e?t(...r):CX(e-d,$9(function(){for(var p=arguments.length,a=new Array(p),b=0;b<p;b++)a[b]=arguments[b];var T=r.map(E=>AX(E)?a.shift():E);return t(...T,...a)}))}),B3=e=>CX(e.length,e),X5=(e,t)=>{for(var n=[],r=e;r<t;++r)n[r-e]=r;return n},Kje=B3((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(n=>t[n]).map(e)),Yje=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(!n.length)return Xje;var l=n.reverse(),d=l[0],p=l.slice(1);return function(){return p.reduce((a,b)=>b(a),d(...arguments))}},K5=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),jX=e=>{var t=null,n=null;return function(){for(var r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];return t&&l.every((p,a)=>{var b;return p===((b=t)===null||b===void 0?void 0:b[a])})||(t=l,n=e(...l)),n}};function MX(e){var t;return e===0?t=1:t=Math.floor(new Da(e).abs().log(10).toNumber())+1,t}function PX(e,t,n){for(var r=new Da(e),l=0,d=[];r.lt(t)&&l<1e5;)d.push(r.toNumber()),r=r.add(n),l++;return d}B3((e,t,n)=>{var r=+e,l=+t;return r+n*(l-r)});B3((e,t,n)=>{var r=t-+e;return r=r||1/0,(n-e)/r});B3((e,t,n)=>{var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});var NX=e=>{var[t,n]=e,[r,l]=[t,n];return t>n&&([r,l]=[n,t]),[r,l]},DX=(e,t,n)=>{if(e.lte(0))return new Da(0);var r=MX(e.toNumber()),l=new Da(10).pow(r),d=e.div(l),p=r!==1?.05:.1,a=new Da(Math.ceil(d.div(p).toNumber())).add(n).mul(p),b=a.mul(l);return t?new Da(b.toNumber()):new Da(Math.ceil(b.toNumber()))},Qje=(e,t,n)=>{var r=new Da(1),l=new Da(e);if(!l.isint()&&n){var d=Math.abs(e);d<1?(r=new Da(10).pow(MX(e)-1),l=new Da(Math.floor(l.div(r).toNumber())).mul(r)):d>1&&(l=new Da(Math.floor(e)))}else e===0?l=new Da(Math.floor((t-1)/2)):n||(l=new Da(Math.floor(e)));var p=Math.floor((t-1)/2),a=Yje(Kje(b=>l.add(new Da(b-p).mul(r)).toNumber()),X5);return a(0,t)},OX=function(t,n,r,l){var d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((n-t)/(r-1)))return{step:new Da(0),tickMin:new Da(0),tickMax:new Da(0)};var p=DX(new Da(n).sub(t).div(r-1),l,d),a;t<=0&&n>=0?a=new Da(0):(a=new Da(t).add(n).div(2),a=a.sub(new Da(a).mod(p)));var b=Math.ceil(a.sub(t).div(p).toNumber()),T=Math.ceil(new Da(n).sub(a).div(p).toNumber()),E=b+T+1;return E>r?OX(t,n,r,l,d+1):(E<r&&(T=n>0?T+(r-E):T,b=n>0?b:b+(r-E)),{step:p,tickMin:a.sub(new Da(b).mul(p)),tickMax:a.add(new Da(T).mul(p))})};function Jje(e){var[t,n]=e,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,d=Math.max(r,2),[p,a]=NX([t,n]);if(p===-1/0||a===1/0){var b=a===1/0?[p,...X5(0,r-1).map(()=>1/0)]:[...X5(0,r-1).map(()=>-1/0),a];return t>n?K5(b):b}if(p===a)return Qje(p,r,l);var{step:T,tickMin:E,tickMax:P}=OX(p,a,d,l,0),I=PX(E,P.add(new Da(.1).mul(T)),T);return t>n?K5(I):I}function eMe(e,t){var[n,r]=e,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[d,p]=NX([n,r]);if(d===-1/0||p===1/0)return[n,r];if(d===p)return[d];var a=Math.max(t,2),b=DX(new Da(p).sub(d).div(a-1),l,0),T=[...PX(new Da(d),new Da(p),b),p];return l===!1&&(T=T.map(E=>Math.round(E))),n>r?K5(T):T}var tMe=jX(Jje),nMe=jX(eMe),IX=e=>e.rootProps.maxBarSize,rMe=e=>e.rootProps.barGap,kX=e=>e.rootProps.barCategoryGap,iMe=e=>e.rootProps.barSize,Qw=e=>e.rootProps.stackOffset,rO=e=>e.options.chartName,iO=e=>e.rootProps.syncId,RX=e=>e.rootProps.syncMethod,aO=e=>e.options.eventEmitter,_m={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Du={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},V3=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},aMe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:_m.angleAxisId,includeHidden:!1,name:void 0,reversed:_m.reversed,scale:_m.scale,tick:_m.tick,tickCount:void 0,ticks:void 0,type:_m.type,unit:void 0},sMe={allowDataOverflow:Du.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Du.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Du.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Du.scale,tick:Du.tick,tickCount:Du.tickCount,ticks:void 0,type:Du.type,unit:void 0},oMe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:_m.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:_m.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:_m.scale,tick:_m.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},lMe={allowDataOverflow:Du.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Du.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Du.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Du.scale,tick:Du.tick,tickCount:Du.tickCount,ticks:void 0,type:"category",unit:void 0},sO=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?oMe:aMe,oO=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?lMe:sMe,U3=e=>e.polarOptions,lO=tn([Bm,Vm,Mo],yZ),zX=tn([U3,lO],(e,t)=>{if(e!=null)return Sc(e.innerRadius,t,0)}),LX=tn([U3,lO],(e,t)=>{if(e!=null)return Sc(e.outerRadius,t,t*.8)}),cMe=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:n}=e;return[t,n]},FX=tn([U3],cMe);tn([sO,FX],V3);var BX=tn([lO,zX,LX],(e,t,n)=>{if(!(e==null||t==null||n==null))return[t,n]});tn([oO,BX],V3);var uMe=tn([ha,U3,zX,LX,Bm,Vm],(e,t,n,r,l,d)=>{if(!(e!=="centric"&&e!=="radial"||t==null||n==null||r==null)){var{cx:p,cy:a,startAngle:b,endAngle:T}=t;return{cx:Sc(p,l,l/2),cy:Sc(a,d,d/2),innerRadius:n,outerRadius:r,startAngle:b,endAngle:T,clockWise:!1}}}),Ws=(e,t)=>t,Jw=(e,t,n)=>n;function q9(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function AE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?q9(Object(n),!0).forEach(function(r){dMe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q9(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function dMe(e,t,n){return(t=hMe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hMe(e){var t=fMe(e,"string");return typeof t=="symbol"?t:t+""}function fMe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Y5=[0,"auto"],ju={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},$m=(e,t)=>{var n=e.cartesianAxis.xAxis[t];return n??ju},Mu={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Y5,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:P3},xx=(e,t)=>{var n=e.cartesianAxis.yAxis[t];return n??Mu},pMe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},cO=(e,t)=>{var n=e.cartesianAxis.zAxis[t];return n??pMe},Zs=(e,t,n)=>{switch(t){case"xAxis":return $m(e,n);case"yAxis":return xx(e,n);case"zAxis":return cO(e,n);case"angleAxis":return sO(e,n);case"radiusAxis":return oO(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},mMe=(e,t,n)=>{switch(t){case"xAxis":return $m(e,n);case"yAxis":return xx(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},e2=(e,t,n)=>{switch(t){case"xAxis":return $m(e,n);case"yAxis":return xx(e,n);case"angleAxis":return sO(e,n);case"radiusAxis":return oO(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},VX=e=>e.graphicalItems.countOfBars>0;function uO(e,t){return n=>{switch(e){case"xAxis":return"xAxisId"in n&&n.xAxisId===t;case"yAxis":return"yAxisId"in n&&n.yAxisId===t;case"zAxis":return"zAxisId"in n&&n.zAxisId===t;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===t;default:return!1}}}var $3=e=>e.graphicalItems.cartesianItems,gMe=tn([Ws,Jw],uO),dO=(e,t,n)=>e.filter(n).filter(r=>(t==null?void 0:t.includeHidden)===!0?!0:!r.hide),t2=tn([$3,Zs,gMe],dO),UX=e=>e.filter(t=>t.stackId===void 0),xMe=tn([t2],UX),hO=e=>e.map(t=>t.data).filter(Boolean).flat(1),yMe=tn([t2],hO),fO=(e,t)=>{var{chartData:n=[],dataStartIndex:r,dataEndIndex:l}=t;return e.length>0?e:n.slice(r,l+1)},q3=tn([yMe,eO],fO),pO=(e,t,n)=>(t==null?void 0:t.dataKey)!=null?e.map(r=>({value:ns(r,t.dataKey)})):n.length>0?n.map(r=>r.dataKey).flatMap(r=>e.map(l=>({value:ns(l,r)}))):e.map(r=>({value:r})),H3=tn([q3,Zs,t2],pO);function $X(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Iy(e){return e.filter(t=>ap(t)||t instanceof Date).map(Number).filter(t=>Xc(t)===!1)}function vMe(e,t,n){return!n||typeof t!="number"||Xc(t)?[]:n.length?Iy(n.flatMap(r=>{var l=ns(e,r.dataKey),d,p;if(Array.isArray(l)?[d,p]=l:d=p=l,!(!xl(d)||!xl(p)))return[t-d,t+p]})):[]}var qX=(e,t,n)=>{var r={},l=t.reduce((d,p)=>(p.stackId==null||(d[p.stackId]==null&&(d[p.stackId]=[]),d[p.stackId].push(p)),d),r);return Object.fromEntries(Object.entries(l).map(d=>{var[p,a]=d,b=a.map(T=>T.dataKey);return[p,{stackedData:O3e(e,b,n),graphicalItems:a}]}))},Tw=tn([q3,t2,Qw],qX),HX=(e,t,n)=>{var{dataStartIndex:r,dataEndIndex:l}=t;if(n!=="zAxis"){var d=z3e(e,r,l);if(!(d!=null&&d[0]===0&&d[1]===0))return d}},_Me=tn([Tw,Oy,Ws],HX),GX=(e,t,n,r)=>n.length>0?e.flatMap(l=>n.flatMap(d=>{var p,a,b=(p=d.errorBars)===null||p===void 0?void 0:p.filter(E=>$X(r,E)),T=ns(l,(a=t.dataKey)!==null&&a!==void 0?a:d.dataKey);return{value:T,errorDomain:vMe(l,T,b)}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(l=>({value:ns(l,t.dataKey),errorDomain:[]})):e.map(l=>({value:l,errorDomain:[]})),bMe=tn(q3,Zs,xMe,Ws,GX);function wMe(e){var{value:t}=e;if(ap(t)||t instanceof Date)return t}var SMe=e=>{var t=e.flatMap(r=>[r.value,r.errorDomain]).flat(1),n=Iy(t);if(n.length!==0)return[Math.min(...n),Math.max(...n)]},TMe=(e,t,n)=>{var r=e.map(wMe).filter(l=>l!=null);return n&&(t.dataKey==null||t.allowDuplicatedCategory&&FW(r))?FZ(0,e.length):t.allowDuplicatedCategory?r:Array.from(new Set(r))},mO=e=>{var t;if(e==null||!("domain"in e))return Y5;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var n=Iy(e.ticks);return[Math.min(...n),Math.max(...n)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:Y5},gO=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var l=n.filter(Boolean);if(l.length!==0){var d=l.flat(),p=Math.min(...d),a=Math.max(...d);return[p,a]}},WX=e=>e.referenceElements.dots,k_=(e,t,n)=>e.filter(r=>r.ifOverflow==="extendDomain").filter(r=>t==="xAxis"?r.xAxisId===n:r.yAxisId===n),EMe=tn([WX,Ws,Jw],k_),ZX=e=>e.referenceElements.areas,AMe=tn([ZX,Ws,Jw],k_),XX=e=>e.referenceElements.lines,CMe=tn([XX,Ws,Jw],k_),KX=(e,t)=>{var n=Iy(e.map(r=>t==="xAxis"?r.x:r.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},jMe=tn(EMe,Ws,KX),YX=(e,t)=>{var n=Iy(e.flatMap(r=>[t==="xAxis"?r.x1:r.y1,t==="xAxis"?r.x2:r.y2]));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},MMe=tn([AMe,Ws],YX),QX=(e,t)=>{var n=Iy(e.map(r=>t==="xAxis"?r.x:r.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},PMe=tn(CMe,Ws,QX),NMe=tn(jMe,PMe,MMe,(e,t,n)=>gO(e,n,t)),JX=tn([Zs],mO),xO=(e,t,n,r,l)=>{var d=qje(t,e.allowDataOverflow);return d??Hje(t,gO(n,l,SMe(r)),e.allowDataOverflow)},DMe=tn([Zs,JX,_Me,bMe,NMe],xO),OMe=[0,1],yO=(e,t,n,r,l,d,p)=>{if(!(e==null||n==null||n.length===0)){var{dataKey:a,type:b}=e,T=Fm(t,d);return T&&a==null?FZ(0,n.length):b==="category"?TMe(r,e,T):l==="expand"?OMe:p}},vO=tn([Zs,ha,q3,H3,Qw,Ws,DMe],yO),eK=(e,t,n,r,l)=>{if(e!=null){var{scale:d,type:p}=e;if(d==="auto")return t==="radial"&&l==="radiusAxis"?"band":t==="radial"&&l==="angleAxis"?"linear":p==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?"point":p==="category"?"band":"linear";if(typeof d=="string"){var a="scale".concat(Gw(d));return a in Tb?a:"point"}}},R_=tn([Zs,ha,VX,rO,Ws],eK);function IMe(e){if(e!=null){if(e in Tb)return Tb[e]();var t="scale".concat(Gw(e));if(t in Tb)return Tb[t]()}}function _O(e,t,n,r){if(!(n==null||r==null)){if(typeof e.scale=="function")return e.scale.copy().domain(n).range(r);var l=IMe(t);if(l!=null){var d=l.domain(n).range(r);return j3e(d),d}}}var bO=(e,t,n)=>{var r=mO(t);if(!(n!=="auto"&&n!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(r)&&(r[0]==="auto"||r[1]==="auto")&&__(e))return tMe(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&__(e))return nMe(e,t.tickCount,t.allowDecimals)}},wO=tn([vO,e2,R_],bO),SO=(e,t,n,r)=>{if(r!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&__(t)&&Array.isArray(n)&&n.length>0){var l=t[0],d=n[0],p=t[1],a=n[n.length-1];return[Math.min(l,d),Math.max(p,a)]}return t},kMe=tn([Zs,vO,wO,Ws],SO),RMe=tn(H3,Zs,(e,t)=>{if(!(!t||t.type!=="number")){var n=1/0,r=Array.from(Iy(e.map(a=>a.value))).sort((a,b)=>a-b);if(r.length<2)return 1/0;var l=r[r.length-1]-r[0];if(l===0)return 1/0;for(var d=0;d<r.length-1;d++){var p=r[d+1]-r[d];n=Math.min(n,p)}return n/l}}),tK=tn(RMe,ha,kX,Mo,(e,t,n,r)=>r,(e,t,n,r,l)=>{if(!xl(e))return 0;var d=t==="vertical"?r.height:r.width;if(l==="gap")return e*d/2;if(l==="no-gap"){var p=Sc(n,e*d),a=e*d/2;return a-p-(a-p)/d*p}return 0}),zMe=(e,t)=>{var n=$m(e,t);return n==null||typeof n.padding!="string"?0:tK(e,"xAxis",t,n.padding)},LMe=(e,t)=>{var n=xx(e,t);return n==null||typeof n.padding!="string"?0:tK(e,"yAxis",t,n.padding)},FMe=tn($m,zMe,(e,t)=>{var n,r;if(e==null)return{left:0,right:0};var{padding:l}=e;return typeof l=="string"?{left:t,right:t}:{left:((n=l.left)!==null&&n!==void 0?n:0)+t,right:((r=l.right)!==null&&r!==void 0?r:0)+t}}),BMe=tn(xx,LMe,(e,t)=>{var n,r;if(e==null)return{top:0,bottom:0};var{padding:l}=e;return typeof l=="string"?{top:t,bottom:t}:{top:((n=l.top)!==null&&n!==void 0?n:0)+t,bottom:((r=l.bottom)!==null&&r!==void 0?r:0)+t}}),VMe=tn([Mo,FMe,D3,N3,(e,t,n)=>n],(e,t,n,r,l)=>{var{padding:d}=r;return l?[d.left,n.width-d.right]:[e.left+t.left,e.left+e.width-t.right]}),UMe=tn([Mo,ha,BMe,D3,N3,(e,t,n)=>n],(e,t,n,r,l,d)=>{var{padding:p}=l;return d?[r.height-p.bottom,p.top]:t==="horizontal"?[e.top+e.height-n.bottom,e.top+n.top]:[e.top+n.top,e.top+e.height-n.bottom]}),n2=(e,t,n,r)=>{var l;switch(t){case"xAxis":return VMe(e,n,r);case"yAxis":return UMe(e,n,r);case"zAxis":return(l=cO(e,n))===null||l===void 0?void 0:l.range;case"angleAxis":return FX(e);case"radiusAxis":return BX(e,n);default:return}},nK=tn([Zs,n2],V3),z_=tn([Zs,R_,kMe,nK],_O);tn(t2,Ws,(e,t)=>e.flatMap(n=>{var r;return(r=n.errorBars)!==null&&r!==void 0?r:[]}).filter(n=>$X(t,n)));function rK(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var G3=(e,t)=>t,W3=(e,t,n)=>n,$Me=tn(AD,G3,W3,(e,t,n)=>e.filter(r=>r.orientation===t).filter(r=>r.mirror===n).sort(rK)),qMe=tn(CD,G3,W3,(e,t,n)=>e.filter(r=>r.orientation===t).filter(r=>r.mirror===n).sort(rK)),iK=(e,t)=>({width:e.width,height:t.height}),HMe=(e,t)=>{var n=typeof t.width=="number"?t.width:P3;return{width:n,height:e.height}},aK=tn(Mo,$m,iK),GMe=(e,t,n)=>{switch(t){case"top":return e.top;case"bottom":return n-e.bottom;default:return 0}},WMe=(e,t,n)=>{switch(t){case"left":return e.left;case"right":return n-e.right;default:return 0}},ZMe=tn(Vm,Mo,$Me,G3,W3,(e,t,n,r,l)=>{var d={},p;return n.forEach(a=>{var b=iK(t,a);p==null&&(p=GMe(t,r,e));var T=r==="top"&&!l||r==="bottom"&&l;d[a.id]=p-Number(T)*b.height,p+=(T?-1:1)*b.height}),d}),XMe=tn(Bm,Mo,qMe,G3,W3,(e,t,n,r,l)=>{var d={},p;return n.forEach(a=>{var b=HMe(t,a);p==null&&(p=WMe(t,r,e));var T=r==="left"&&!l||r==="right"&&l;d[a.id]=p-Number(T)*b.width,p+=(T?-1:1)*b.width}),d}),KMe=(e,t)=>{var n=Mo(e),r=$m(e,t);if(r!=null){var l=ZMe(e,r.orientation,r.mirror),d=l[t];return d==null?{x:n.left,y:0}:{x:n.left,y:d}}},YMe=(e,t)=>{var n=Mo(e),r=xx(e,t);if(r!=null){var l=XMe(e,r.orientation,r.mirror),d=l[t];return d==null?{x:0,y:n.top}:{x:d,y:n.top}}},sK=tn(Mo,xx,(e,t)=>{var n=typeof t.width=="number"?t.width:P3;return{width:n,height:e.height}}),H9=(e,t,n)=>{switch(t){case"xAxis":return aK(e,n).width;case"yAxis":return sK(e,n).height;default:return}},oK=(e,t,n,r)=>{if(n!=null){var{allowDuplicatedCategory:l,type:d,dataKey:p}=n,a=Fm(e,r),b=t.map(T=>T.value);if(p&&a&&d==="category"&&l&&FW(b))return b}},TO=tn([ha,H3,Zs,Ws],oK),lK=(e,t,n,r)=>{if(!(n==null||n.dataKey==null)){var{type:l,scale:d}=n,p=Fm(e,r);if(p&&(l==="number"||d!=="auto"))return t.map(a=>a.value)}},EO=tn([ha,H3,e2,Ws],lK),G9=tn([ha,mMe,R_,z_,TO,EO,n2,wO,Ws],(e,t,n,r,l,d,p,a,b)=>{if(t==null)return null;var T=Fm(e,b);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:b,categoricalDomain:d,duplicateDomain:l,isCategorical:T,niceTicks:a,range:p,realScaleType:n,scale:r}}),QMe=(e,t,n,r,l,d,p,a,b)=>{if(!(t==null||r==null)){var T=Fm(e,b),{type:E,ticks:P,tickCount:I}=t,R=n==="scaleBand"&&typeof r.bandwidth=="function"?r.bandwidth()/2:2,F=E==="category"&&r.bandwidth?r.bandwidth()/R:0;F=b==="angleAxis"&&d!=null&&d.length>=2?Yo(d[0]-d[1])*2*F:F;var W=P||l;if(W){var $=W.map((Z,ne)=>{var ie=p?p.indexOf(Z):Z;return{index:ne,coordinate:r(ie)+F,value:Z,offset:F}});return $.filter(Z=>!Xc(Z.coordinate))}return T&&a?a.map((Z,ne)=>({coordinate:r(Z)+F,value:Z,index:ne,offset:F})):r.ticks?r.ticks(I).map(Z=>({coordinate:r(Z)+F,value:Z,offset:F})):r.domain().map((Z,ne)=>({coordinate:r(Z)+F,value:p?p[Z]:Z,index:ne,offset:F}))}},cK=tn([ha,e2,R_,z_,wO,n2,TO,EO,Ws],QMe),JMe=(e,t,n,r,l,d,p)=>{if(!(t==null||n==null||r==null||r[0]===r[1])){var a=Fm(e,p),{tickCount:b}=t,T=0;return T=p==="angleAxis"&&(r==null?void 0:r.length)>=2?Yo(r[0]-r[1])*2*T:T,a&&d?d.map((E,P)=>({coordinate:n(E)+T,value:E,index:P,offset:T})):n.ticks?n.ticks(b).map(E=>({coordinate:n(E)+T,value:E,offset:T})):n.domain().map((E,P)=>({coordinate:n(E)+T,value:l?l[E]:E,index:P,offset:T}))}},cx=tn([ha,e2,z_,n2,TO,EO,Ws],JMe),op=tn(Zs,z_,(e,t)=>{if(!(e==null||t==null))return AE(AE({},e),{},{scale:t})}),e5e=tn([Zs,R_,vO,nK],_O);tn((e,t,n)=>cO(e,n),e5e,(e,t)=>{if(!(e==null||t==null))return AE(AE({},e),{},{scale:t})});var t5e=tn([ha,AD,CD],(e,t,n)=>{switch(e){case"horizontal":return t.some(r=>r.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(r=>r.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),uK=e=>e.options.defaultTooltipEventType,dK=e=>e.options.validateTooltipEventTypes;function hK(e,t,n){if(e==null)return t;var r=e?"axis":"item";return n==null?t:n.includes(r)?r:t}function AO(e,t){var n=uK(e),r=dK(e);return hK(t,n,r)}function n5e(e){return Or(t=>AO(t,e))}var fK=(e,t)=>{var n,r=Number(t);if(!(Xc(r)||t==null))return r>=0?e==null||(n=e[r])===null||n===void 0?void 0:n.value:void 0},r5e=e=>e.tooltip.settings,Zg={active:!1,index:null,dataKey:void 0,coordinate:void 0},i5e={itemInteraction:{click:Zg,hover:Zg},axisInteraction:{click:Zg,hover:Zg},keyboardInteraction:Zg,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},pK=Ia({name:"tooltip",initialState:i5e,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var n=Tm(e).tooltipItemPayloads.indexOf(t.payload);n>-1&&e.tooltipItemPayloads.splice(n,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:a5e,removeTooltipEntrySettings:s5e,setTooltipSettingsState:o5e,setActiveMouseOverItemIndex:mK,mouseLeaveItem:l5e,mouseLeaveChart:gK,setActiveClickItemIndex:c5e,setMouseOverAxisIndex:xK,setMouseClickAxisIndex:u5e,setSyncInteraction:Q5,setKeyboardInteraction:J5}=pK.actions,d5e=pK.reducer;function W9(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function qS(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?W9(Object(n),!0).forEach(function(r){h5e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W9(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function h5e(e,t,n){return(t=f5e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f5e(e){var t=p5e(e,"string");return typeof t=="symbol"?t:t+""}function p5e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function m5e(e,t,n){return t==="axis"?n==="click"?e.axisInteraction.click:e.axisInteraction.hover:n==="click"?e.itemInteraction.click:e.itemInteraction.hover}function g5e(e){return e.index!=null}var yK=(e,t,n,r)=>{if(t==null)return Zg;var l=m5e(e,t,n);if(l==null)return Zg;if(l.active)return l;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var d=e.settings.active===!0;if(g5e(l)){if(d)return qS(qS({},l),{},{active:!0})}else if(r!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:r};return qS(qS({},Zg),{},{coordinate:l.coordinate})},CO=(e,t)=>{var n=e==null?void 0:e.index;if(n==null)return null;var r=Number(n);if(!xl(r))return n;var l=0,d=1/0;return t.length>0&&(d=t.length-1),String(Math.max(l,Math.min(r,d)))},vK=(e,t,n,r,l,d,p,a)=>{if(!(d==null||a==null)){var b=p[0],T=b==null?void 0:a(b.positions,d);if(T!=null)return T;var E=l==null?void 0:l[Number(d)];if(E)switch(n){case"horizontal":return{x:E.coordinate,y:(r.top+t)/2};default:return{x:(r.left+e)/2,y:E.coordinate}}}},_K=(e,t,n,r)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var l;return n==="hover"?l=e.itemInteraction.hover.dataKey:l=e.itemInteraction.click.dataKey,l==null&&r!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(d=>{var p;return((p=d.settings)===null||p===void 0?void 0:p.dataKey)===l})},r2=e=>e.options.tooltipPayloadSearcher,L_=e=>e.tooltip;function Z9(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function X9(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Z9(Object(n),!0).forEach(function(r){x5e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z9(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function x5e(e,t,n){return(t=y5e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y5e(e){var t=v5e(e,"string");return typeof t=="symbol"?t:t+""}function v5e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _5e(e,t,n){return Array.isArray(e)&&e&&t+n!==0?e.slice(t,n+1):e}function b5e(e,t){return e??t}var bK=(e,t,n,r,l,d,p)=>{if(!(t==null||d==null)){var{chartData:a,computedData:b,dataStartIndex:T,dataEndIndex:E}=n,P=[];return e.reduce((I,R)=>{var F,{dataDefinedOnItem:W,settings:$}=R,Z=b5e(W,a),ne=_5e(Z,T,E),ie=(F=$==null?void 0:$.dataKey)!==null&&F!==void 0?F:r==null?void 0:r.dataKey,ge=$==null?void 0:$.nameKey,ae;if(r!=null&&r.dataKey&&Array.isArray(ne)&&!Array.isArray(ne[0])&&p==="axis"?ae=BW(ne,r.dataKey,l):ae=d(ne,t,b,ge),Array.isArray(ae))ae.forEach(me=>{var ke=X9(X9({},$),{},{name:me.name,unit:me.unit,color:void 0,fill:void 0});I.push(NB({tooltipEntrySettings:ke,dataKey:me.dataKey,payload:me.payload,value:ns(me.payload,me.dataKey),name:me.name}))});else{var se;I.push(NB({tooltipEntrySettings:$,dataKey:ie,payload:ae,value:ns(ae,ie),name:(se=ns(ae,ge))!==null&&se!==void 0?se:$==null?void 0:$.name}))}return I},P)}},Jo=e=>{var t=ha(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},F_=e=>e.tooltip.settings.axisId,vl=e=>{var t=Jo(e),n=F_(e);return e2(e,t,n)},jO=tn([vl,ha,VX,rO,Jo],eK),w5e=tn([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),S5e=tn([Jo,F_],uO),Z3=tn([w5e,vl,S5e],dO),T5e=tn([Z3],hO),ky=tn([T5e,Oy],fO),MO=tn([ky,vl,Z3],pO),E5e=tn([vl],mO),A5e=tn([ky,Z3,Qw],qX),C5e=tn([A5e,Oy,Jo],HX),j5e=tn([Z3],UX),M5e=tn([ky,vl,j5e,Jo],GX),P5e=tn([WX,Jo,F_],k_),N5e=tn([P5e,Jo],KX),D5e=tn([ZX,Jo,F_],k_),O5e=tn([D5e,Jo],YX),I5e=tn([XX,Jo,F_],k_),k5e=tn([I5e,Jo],QX),R5e=tn([N5e,k5e,O5e],gO),z5e=tn([vl,E5e,C5e,M5e,R5e],xO),wK=tn([vl,ha,ky,MO,Qw,Jo,z5e],yO),L5e=tn([wK,vl,jO],bO),F5e=tn([vl,wK,L5e,Jo],SO),SK=e=>{var t=Jo(e),n=F_(e),r=!1;return n2(e,t,n,r)},TK=tn([vl,SK],V3),EK=tn([vl,jO,F5e,TK],_O),B5e=tn([ha,MO,vl,Jo],oK),V5e=tn([ha,MO,vl,Jo],lK),U5e=(e,t,n,r,l,d,p,a)=>{if(t){var{type:b}=t,T=Fm(e,a);if(r){var E=n==="scaleBand"&&r.bandwidth?r.bandwidth()/2:2,P=b==="category"&&r.bandwidth?r.bandwidth()/E:0;return P=a==="angleAxis"&&l!=null&&(l==null?void 0:l.length)>=2?Yo(l[0]-l[1])*2*P:P,T&&p?p.map((I,R)=>({coordinate:r(I)+P,value:I,index:R,offset:P})):r.domain().map((I,R)=>({coordinate:r(I)+P,value:d?d[I]:I,index:R,offset:P}))}}},qm=tn([ha,vl,jO,EK,SK,B5e,V5e,Jo],U5e),PO=tn([uK,dK,r5e],(e,t,n)=>hK(n.shared,e,t)),AK=e=>e.tooltip.settings.trigger,NO=e=>e.tooltip.settings.defaultIndex,X3=tn([L_,PO,AK,NO],yK),ux=tn([X3,ky],CO),CK=tn([qm,ux],fK),jK=tn([X3],e=>{if(e)return e.dataKey}),MK=tn([L_,PO,AK,NO],_K),$5e=tn([Bm,Vm,ha,Mo,qm,NO,MK,r2],vK),q5e=tn([X3,$5e],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),H5e=tn([X3],e=>e.active),G5e=tn([MK,ux,Oy,vl,CK,r2,PO],bK),W5e=tn([G5e],e=>{if(e!=null){var t=e.map(n=>n.payload).filter(n=>n!=null);return Array.from(new Set(t))}});function K9(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function Y9(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?K9(Object(n),!0).forEach(function(r){Z5e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K9(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Z5e(e,t,n){return(t=X5e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function X5e(e){var t=K5e(e,"string");return typeof t=="symbol"?t:t+""}function K5e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Y5e=()=>Or(vl),Q5e=()=>{var e=Y5e(),t=Or(qm),n=Or(EK);return xw(Y9(Y9({},e),{},{scale:n}),t)},PK=()=>Or(rO),DO=(e,t)=>t,NK=(e,t,n)=>n,OO=(e,t,n,r)=>r,J5e=tn(qm,e=>M3(e,t=>t.coordinate)),IO=tn([L_,DO,NK,OO],yK),DK=tn([IO,ky],CO),ePe=(e,t,n)=>{if(t!=null){var r=L_(e);return t==="axis"?n==="hover"?r.axisInteraction.hover.dataKey:r.axisInteraction.click.dataKey:n==="hover"?r.itemInteraction.hover.dataKey:r.itemInteraction.click.dataKey}},OK=tn([L_,DO,NK,OO],_K),CE=tn([Bm,Vm,ha,Mo,qm,OO,OK,r2],vK),tPe=tn([IO,CE],(e,t)=>{var n;return(n=e.coordinate)!==null&&n!==void 0?n:t}),IK=tn(qm,DK,fK),nPe=tn([OK,DK,Oy,vl,IK,r2,DO],bK),rPe=tn([IO],e=>({isActive:e.active,activeIndex:e.index})),iPe=(e,t,n,r,l,d,p,a)=>{if(!(!e||!t||!r||!l||!d)){var b=L3e(e.chartX,e.chartY,t,n,a);if(b){var T=B3e(b,t),E=A3e(T,p,d,r,l),P=F3e(t,d,E,b);return{activeIndex:String(E),activeCoordinate:P}}}};function eP(){return eP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},eP.apply(null,arguments)}function Q9(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function HS(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Q9(Object(n),!0).forEach(function(r){aPe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q9(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function aPe(e,t,n){return(t=sPe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sPe(e){var t=oPe(e,"string");return typeof t=="symbol"?t:t+""}function oPe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lPe(e){var{coordinate:t,payload:n,index:r,offset:l,tooltipAxisBandSize:d,layout:p,cursor:a,tooltipEventType:b,chartName:T}=e,E=t,P=n,I=r;if(!a||!E||T!=="ScatterChart"&&b!=="axis")return null;var R,F;if(T==="ScatterChart")R=E,F=SAe;else if(T==="BarChart")R=TAe(p,E,l,d),F=kZ;else if(p==="radial"){var{cx:W,cy:$,radius:Z,startAngle:ne,endAngle:ie}=RZ(E);R={cx:W,cy:$,startAngle:ne,endAngle:ie,innerRadius:Z,outerRadius:Z},F=LZ}else R={points:uCe(p,E,l)},F=qb;var ge=typeof a=="object"&&"className"in a?a.className:void 0,ae=HS(HS(HS(HS({stroke:"#ccc",pointerEvents:"none"},l),R),Qi(a,!1)),{},{payload:P,payloadIndex:I,className:ba("recharts-tooltip-cursor",ge)});return V.isValidElement(a)?V.cloneElement(a,ae):V.createElement(F,ae)}function cPe(e){var t=Q5e(),n=EZ(),r=O3(),l=PK();return V.createElement(lPe,eP({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:n,layout:r,tooltipAxisBandSize:t,chartName:l}))}var kK=V.createContext(null),uPe=()=>V.useContext(kK),Hj={exports:{}},J9;function dPe(){return J9||(J9=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function l(b,T,E){this.fn=b,this.context=T,this.once=E||!1}function d(b,T,E,P,I){if(typeof E!="function")throw new TypeError("The listener must be a function");var R=new l(E,P||b,I),F=n?n+T:T;return b._events[F]?b._events[F].fn?b._events[F]=[b._events[F],R]:b._events[F].push(R):(b._events[F]=R,b._eventsCount++),b}function p(b,T){--b._eventsCount===0?b._events=new r:delete b._events[T]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var T=[],E,P;if(this._eventsCount===0)return T;for(P in E=this._events)t.call(E,P)&&T.push(n?P.slice(1):P);return Object.getOwnPropertySymbols?T.concat(Object.getOwnPropertySymbols(E)):T},a.prototype.listeners=function(T){var E=n?n+T:T,P=this._events[E];if(!P)return[];if(P.fn)return[P.fn];for(var I=0,R=P.length,F=new Array(R);I<R;I++)F[I]=P[I].fn;return F},a.prototype.listenerCount=function(T){var E=n?n+T:T,P=this._events[E];return P?P.fn?1:P.length:0},a.prototype.emit=function(T,E,P,I,R,F){var W=n?n+T:T;if(!this._events[W])return!1;var $=this._events[W],Z=arguments.length,ne,ie;if($.fn){switch($.once&&this.removeListener(T,$.fn,void 0,!0),Z){case 1:return $.fn.call($.context),!0;case 2:return $.fn.call($.context,E),!0;case 3:return $.fn.call($.context,E,P),!0;case 4:return $.fn.call($.context,E,P,I),!0;case 5:return $.fn.call($.context,E,P,I,R),!0;case 6:return $.fn.call($.context,E,P,I,R,F),!0}for(ie=1,ne=new Array(Z-1);ie<Z;ie++)ne[ie-1]=arguments[ie];$.fn.apply($.context,ne)}else{var ge=$.length,ae;for(ie=0;ie<ge;ie++)switch($[ie].once&&this.removeListener(T,$[ie].fn,void 0,!0),Z){case 1:$[ie].fn.call($[ie].context);break;case 2:$[ie].fn.call($[ie].context,E);break;case 3:$[ie].fn.call($[ie].context,E,P);break;case 4:$[ie].fn.call($[ie].context,E,P,I);break;default:if(!ne)for(ae=1,ne=new Array(Z-1);ae<Z;ae++)ne[ae-1]=arguments[ae];$[ie].fn.apply($[ie].context,ne)}}return!0},a.prototype.on=function(T,E,P){return d(this,T,E,P,!1)},a.prototype.once=function(T,E,P){return d(this,T,E,P,!0)},a.prototype.removeListener=function(T,E,P,I){var R=n?n+T:T;if(!this._events[R])return this;if(!E)return p(this,R),this;var F=this._events[R];if(F.fn)F.fn===E&&(!I||F.once)&&(!P||F.context===P)&&p(this,R);else{for(var W=0,$=[],Z=F.length;W<Z;W++)(F[W].fn!==E||I&&!F[W].once||P&&F[W].context!==P)&&$.push(F[W]);$.length?this._events[R]=$.length===1?$[0]:$:p(this,R)}return this},a.prototype.removeAllListeners=function(T){var E;return T?(E=n?n+T:T,this._events[E]&&p(this,E)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a}(Hj)),Hj.exports}var hPe=dPe();const fPe=Gs(hPe);var Ew=new fPe,tP="recharts.syncEvent.tooltip",e7="recharts.syncEvent.brush";function kO(e,t){if(t){var n=Number.parseInt(t,10);if(!Xc(n))return e==null?void 0:e[n]}}var pPe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},RK=Ia({name:"options",initialState:pPe,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),mPe=RK.reducer,{createEventEmitter:gPe}=RK.actions;function xPe(e){return e.tooltip.syncInteraction}var yPe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},zK=Ia({name:"chartData",initialState:yPe,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:n,endIndex:r}=t.payload;n!=null&&(e.dataStartIndex=n),r!=null&&(e.dataEndIndex=r)}}}),{setChartData:t7,setDataStartEndIndexes:vPe,setComputedData:G6e}=zK.actions,_Pe=zK.reducer,LK=()=>{};function bPe(){var e=Or(iO),t=Or(aO),n=Ns(),r=Or(RX),l=Or(qm),d=O3(),p=jD(),a=Or(b=>b.rootProps.className);V.useEffect(()=>{if(e==null)return LK;var b=(T,E,P)=>{if(t!==P&&e===T){if(r==="index"){n(E);return}if(l!=null){var I;if(typeof r=="function"){var R={activeTooltipIndex:E.payload.index==null?void 0:Number(E.payload.index),isTooltipActive:E.payload.active,activeIndex:E.payload.index==null?void 0:Number(E.payload.index),activeLabel:E.payload.label,activeDataKey:E.payload.dataKey,activeCoordinate:E.payload.coordinate},F=r(l,R);I=l[F]}else r==="value"&&(I=l.find(se=>String(se.value)===E.payload.label));var{coordinate:W}=E.payload;if(I==null||E.payload.active===!1||W==null||p==null){n(Q5({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:$,y:Z}=W,ne=Math.min($,p.x+p.width),ie=Math.min(Z,p.y+p.height),ge={x:d==="horizontal"?I.coordinate:ne,y:d==="horizontal"?ie:I.coordinate},ae=Q5({active:E.payload.active,coordinate:ge,dataKey:E.payload.dataKey,index:String(I.index),label:E.payload.label});n(ae)}}};return Ew.on(tP,b),()=>{Ew.off(tP,b)}},[a,n,t,e,r,l,d,p])}function wPe(){var e=Or(iO),t=Or(aO),n=Ns();V.useEffect(()=>{if(e==null)return LK;var r=(l,d,p)=>{t!==p&&e===l&&n(vPe(d))};return Ew.on(e7,r),()=>{Ew.off(e7,r)}},[n,t,e])}function SPe(){var e=Ns();V.useEffect(()=>{e(gPe())},[e]),bPe(),wPe()}function TPe(e,t,n,r,l,d){var p=Or(I=>ePe(I,e,t)),a=Or(aO),b=Or(iO),T=Or(RX),E=Or(xPe),P=E==null?void 0:E.active;V.useEffect(()=>{if(!P&&b!=null&&a!=null){var I=Q5({active:d,coordinate:n,dataKey:p,index:l,label:typeof r=="number"?String(r):r});Ew.emit(tP,b,I,a)}},[P,n,p,l,r,a,b,T,d])}function n7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function r7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?n7(Object(n),!0).forEach(function(r){EPe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):n7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function EPe(e,t,n){return(t=APe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function APe(e){var t=CPe(e,"string");return typeof t=="symbol"?t:t+""}function CPe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jPe(e){return e.dataKey}function MPe(e,t){return V.isValidElement(e)?V.cloneElement(e,t):typeof e=="function"?V.createElement(e,t):V.createElement(tAe,t)}var i7=[],PPe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Py.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function mb(e){var t=$d(e,PPe),{active:n,allowEscapeViewBox:r,animationDuration:l,animationEasing:d,content:p,filterNull:a,isAnimationActive:b,offset:T,payloadUniqBy:E,position:P,reverseDirection:I,useTranslate3d:R,wrapperStyle:F,cursor:W,shared:$,trigger:Z,defaultIndex:ne,portal:ie,axisId:ge}=t,ae=Ns(),se=typeof ne=="number"?String(ne):ne;V.useEffect(()=>{ae(o5e({shared:$,trigger:Z,axisId:ge,active:n,defaultIndex:se}))},[ae,$,Z,ge,n,se]);var me=jD(),ke=NZ(),qe=n5e($),{activeIndex:tt,isActive:nt}=Or(Mn=>rPe(Mn,qe,Z,se)),bt=Or(Mn=>nPe(Mn,qe,Z,se)),jt=Or(Mn=>IK(Mn,qe,Z,se)),Nt=Or(Mn=>tPe(Mn,qe,Z,se)),vt=bt,He=uPe(),ut=n??nt,[Tt,Yt]=o3e([vt,ut]),Ge=qe==="axis"?jt:void 0;TPe(qe,Z,Nt,Ge,tt,ut);var ot=ie??He;if(ot==null)return null;var mt=vt??i7;ut||(mt=i7),a&&mt.length&&(mt=$Ee(vt.filter(Mn=>Mn.value!=null&&(Mn.hide!==!0||t.includeHidden)),E,jPe));var It=mt.length>0,In=V.createElement(lAe,{allowEscapeViewBox:r,animationDuration:l,animationEasing:d,isAnimationActive:b,active:ut,coordinate:Nt,hasPayload:It,offset:T,position:P,reverseDirection:I,useTranslate3d:R,viewBox:me,wrapperStyle:F,lastBoundingBox:Tt,innerRef:Yt,hasPortalFromProps:!!ie},MPe(p,r7(r7({},t),{},{payload:mt,label:Ge,active:ut,coordinate:Nt,accessibilityLayer:ke})));return V.createElement(V.Fragment,null,r3.createPortal(In,ot),ut&&V.createElement(cPe,{cursor:W,tooltipEventType:qe,coordinate:Nt,payload:vt,index:tt}))}var Gj={},Wj={},a7;function NPe(){return a7||(a7=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,r=0,l={}){typeof l!="object"&&(l={});let d=null,p=null,a=null,b=0,T=null,E;const{leading:P=!1,trailing:I=!0,maxWait:R}=l,F="maxWait"in l,W=F?Math.max(Number(R)||0,r):0,$=me=>(d!==null&&(E=n.apply(p,d)),d=p=null,b=me,E),Z=me=>(b=me,T=setTimeout(ae,r),P&&d!==null?$(me):E),ne=me=>(T=null,I&&d!==null?$(me):E),ie=me=>{if(a===null)return!0;const ke=me-a,qe=ke>=r||ke<0,tt=F&&me-b>=W;return qe||tt},ge=me=>{const ke=a===null?0:me-a,qe=r-ke,tt=W-(me-b);return F?Math.min(qe,tt):qe},ae=()=>{const me=Date.now();if(ie(me))return ne(me);T=setTimeout(ae,ge(me))},se=function(...me){const ke=Date.now(),qe=ie(ke);if(d=me,p=this,a=ke,qe){if(T===null)return Z(ke);if(F)return clearTimeout(T),T=setTimeout(ae,r),$(ke)}return T===null&&(T=setTimeout(ae,r)),E};return se.cancel=()=>{T!==null&&clearTimeout(T),b=0,a=d=p=T=null},se.flush=()=>T===null?E:ne(Date.now()),se}e.debounce=t}(Wj)),Wj}var s7;function DPe(){return s7||(s7=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=NPe();function n(r,l=0,d={}){const{leading:p=!0,trailing:a=!0}=d;return t.debounce(r,l,{leading:p,maxWait:l,trailing:a})}e.throttle=n}(Gj)),Gj}var Zj,o7;function OPe(){return o7||(o7=1,Zj=DPe().throttle),Zj}var IPe=OPe();const kPe=Gs(IPe);var Hb=function(t,n){for(var r=arguments.length,l=new Array(r>2?r-2:0),d=2;d<r;d++)l[d-2]=arguments[d]};function l7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function Xj(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?l7(Object(n),!0).forEach(function(r){RPe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function RPe(e,t,n){return(t=zPe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zPe(e){var t=LPe(e,"string");return typeof t=="symbol"?t:t+""}function LPe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gb=V.forwardRef((e,t)=>{var{aspect:n,initialDimension:r={width:-1,height:-1},width:l="100%",height:d="100%",minWidth:p=0,minHeight:a,maxHeight:b,children:T,debounce:E=0,id:P,className:I,onResize:R,style:F={}}=e,W=V.useRef(null),$=V.useRef();$.current=R,V.useImperativeHandle(t,()=>W.current);var[Z,ne]=V.useState({containerWidth:r.width,containerHeight:r.height}),ie=V.useCallback((ae,se)=>{ne(me=>{var ke=Math.round(ae),qe=Math.round(se);return me.containerWidth===ke&&me.containerHeight===qe?me:{containerWidth:ke,containerHeight:qe}})},[]);V.useEffect(()=>{var ae=qe=>{var tt,{width:nt,height:bt}=qe[0].contentRect;ie(nt,bt),(tt=$.current)===null||tt===void 0||tt.call($,nt,bt)};E>0&&(ae=kPe(ae,E,{trailing:!0,leading:!1}));var se=new ResizeObserver(ae),{width:me,height:ke}=W.current.getBoundingClientRect();return ie(me,ke),se.observe(W.current),()=>{se.disconnect()}},[ie,E]);var ge=V.useMemo(()=>{var{containerWidth:ae,containerHeight:se}=Z;if(ae<0||se<0)return null;Hb(H0(l)||H0(d),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,l,d),Hb(!n||n>0,"The aspect(%s) must be greater than zero.",n);var me=H0(l)?ae:l,ke=H0(d)?se:d;return n&&n>0&&(me?ke=me/n:ke&&(me=ke*n),b&&ke>b&&(ke=b)),Hb(me>0||ke>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,me,ke,l,d,p,a,n),V.Children.map(T,qe=>V.cloneElement(qe,{width:me,height:ke,style:Xj({width:me,height:ke},qe.props.style)}))},[n,T,d,b,a,p,Z,l]);return V.createElement("div",{id:P?"".concat(P):void 0,className:ba("recharts-responsive-container",I),style:Xj(Xj({},F),{},{width:l,height:d,minWidth:p,minHeight:a,maxHeight:b}),ref:W},V.createElement("div",{style:{width:0,height:0,overflow:"visible"}},ge))}),oy=e=>null;oy.displayName="Cell";function c7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function nP(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?c7(Object(n),!0).forEach(function(r){FPe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function FPe(e,t,n){return(t=BPe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function BPe(e){var t=VPe(e,"string");return typeof t=="symbol"?t:t+""}function VPe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hv={widthCache:{},cacheCount:0},UPe=2e3,$Pe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},u7="recharts_measurement_span";function qPe(e){var t=nP({},e);return Object.keys(t).forEach(n=>{t[n]||delete t[n]}),t}var Gb=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Py.isSsr)return{width:0,height:0};var r=qPe(n),l=JSON.stringify({text:t,copyStyle:r});if(Hv.widthCache[l])return Hv.widthCache[l];try{var d=document.getElementById(u7);d||(d=document.createElement("span"),d.setAttribute("id",u7),d.setAttribute("aria-hidden","true"),document.body.appendChild(d));var p=nP(nP({},$Pe),r);Object.assign(d.style,p),d.textContent="".concat(t);var a=d.getBoundingClientRect(),b={width:a.width,height:a.height};return Hv.widthCache[l]=b,++Hv.cacheCount>UPe&&(Hv.cacheCount=0,Hv.widthCache={}),b}catch{return{width:0,height:0}}},d7=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,h7=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,HPe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,GPe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,FK={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},WPe=Object.keys(FK),Jv="NaN";function ZPe(e,t){return e*FK[t]}class Vc{static parse(t){var n,[,r,l]=(n=GPe.exec(t))!==null&&n!==void 0?n:[];return new Vc(parseFloat(r),l??"")}constructor(t,n){this.num=t,this.unit=n,this.num=t,this.unit=n,Xc(t)&&(this.unit=""),n!==""&&!HPe.test(n)&&(this.num=NaN,this.unit=""),WPe.includes(n)&&(this.num=ZPe(t,n),this.unit="px")}add(t){return this.unit!==t.unit?new Vc(NaN,""):new Vc(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new Vc(NaN,""):new Vc(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Vc(NaN,""):new Vc(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Vc(NaN,""):new Vc(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Xc(this.num)}}function BK(e){if(e.includes(Jv))return Jv;for(var t=e;t.includes("*")||t.includes("/");){var n,[,r,l,d]=(n=d7.exec(t))!==null&&n!==void 0?n:[],p=Vc.parse(r??""),a=Vc.parse(d??""),b=l==="*"?p.multiply(a):p.divide(a);if(b.isNaN())return Jv;t=t.replace(d7,b.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var T,[,E,P,I]=(T=h7.exec(t))!==null&&T!==void 0?T:[],R=Vc.parse(E??""),F=Vc.parse(I??""),W=P==="+"?R.add(F):R.subtract(F);if(W.isNaN())return Jv;t=t.replace(h7,W.toString())}return t}var f7=/\(([^()]*)\)/;function XPe(e){for(var t=e,n;(n=f7.exec(t))!=null;){var[,r]=n;t=t.replace(f7,BK(r))}return t}function KPe(e){var t=e.replace(/\s+/g,"");return t=XPe(t),t=BK(t),t}function YPe(e){try{return KPe(e)}catch{return Jv}}function Kj(e){var t=YPe(e.slice(5,-1));return t===Jv?"":t}var QPe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],JPe=["dx","dy","angle","className","breakAll"];function rP(){return rP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rP.apply(null,arguments)}function p7(e,t){if(e==null)return{};var n,r,l=eNe(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function eNe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var VK=/[ \f\n\r\t\v\u2028\u2029]+/,UK=e=>{var{children:t,breakAll:n,style:r}=e;try{var l=[];Za(t)||(n?l=t.toString().split(""):l=t.toString().split(VK));var d=l.map(a=>({word:a,width:Gb(a,r).width})),p=n?0:Gb(" ",r).width;return{wordsWithComputedWidth:d,spaceWidth:p}}catch{return null}},tNe=(e,t,n,r,l)=>{var{maxLines:d,children:p,style:a,breakAll:b}=e,T=lr(d),E=p,P=function(){var nt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return nt.reduce((bt,jt)=>{var{word:Nt,width:vt}=jt,He=bt[bt.length-1];if(He&&(r==null||l||He.width+vt+n<Number(r)))He.words.push(Nt),He.width+=vt+n;else{var ut={words:[Nt],width:vt};bt.push(ut)}return bt},[])},I=P(t),R=tt=>tt.reduce((nt,bt)=>nt.width>bt.width?nt:bt);if(!T||l)return I;var F=I.length>d||R(I).width>Number(r);if(!F)return I;for(var W="…",$=tt=>{var nt=E.slice(0,tt),bt=UK({breakAll:b,style:a,children:nt+W}).wordsWithComputedWidth,jt=P(bt),Nt=jt.length>d||R(jt).width>Number(r);return[Nt,jt]},Z=0,ne=E.length-1,ie=0,ge;Z<=ne&&ie<=E.length-1;){var ae=Math.floor((Z+ne)/2),se=ae-1,[me,ke]=$(se),[qe]=$(ae);if(!me&&!qe&&(Z=ae+1),me&&qe&&(ne=ae-1),!me&&qe){ge=ke;break}ie++}return ge||I},m7=e=>{var t=Za(e)?[]:e.toString().split(VK);return[{words:t}]},nNe=e=>{var{width:t,scaleToFit:n,children:r,style:l,breakAll:d,maxLines:p}=e;if((t||n)&&!Py.isSsr){var a,b,T=UK({breakAll:d,children:r,style:l});if(T){var{wordsWithComputedWidth:E,spaceWidth:P}=T;a=E,b=P}else return m7(r);return tNe({breakAll:d,children:r,maxLines:p,style:l},a,b,t,n)}return m7(r)},g7="#808080",K3=V.forwardRef((e,t)=>{var{x:n=0,y:r=0,lineHeight:l="1em",capHeight:d="0.71em",scaleToFit:p=!1,textAnchor:a="start",verticalAnchor:b="end",fill:T=g7}=e,E=p7(e,QPe),P=V.useMemo(()=>nNe({breakAll:E.breakAll,children:E.children,maxLines:E.maxLines,scaleToFit:p,style:E.style,width:E.width}),[E.breakAll,E.children,E.maxLines,p,E.style,E.width]),{dx:I,dy:R,angle:F,className:W,breakAll:$}=E,Z=p7(E,JPe);if(!ap(n)||!ap(r))return null;var ne=n+(lr(I)?I:0),ie=r+(lr(R)?R:0),ge;switch(b){case"start":ge=Kj("calc(".concat(d,")"));break;case"middle":ge=Kj("calc(".concat((P.length-1)/2," * -").concat(l," + (").concat(d," / 2))"));break;default:ge=Kj("calc(".concat(P.length-1," * -").concat(l,")"));break}var ae=[];if(p){var se=P[0].width,{width:me}=E;ae.push("scale(".concat(lr(me)?me/se:1,")"))}return F&&ae.push("rotate(".concat(F,", ").concat(ne,", ").concat(ie,")")),ae.length&&(Z.transform=ae.join(" ")),V.createElement("text",rP({},Qi(Z,!0),{ref:t,x:ne,y:ie,className:ba("recharts-text",W),textAnchor:a,fill:T.includes("url")?g7:T}),P.map((ke,qe)=>{var tt=ke.words.join($?"":" ");return V.createElement("tspan",{x:ne,dy:qe===0?ge:l,key:"".concat(tt,"-").concat(qe)},tt)}))});K3.displayName="Text";var rNe=["offset"],iNe=["labelRef"];function x7(e,t){if(e==null)return{};var n,r,l=aNe(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function aNe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function y7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function co(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?y7(Object(n),!0).forEach(function(r){sNe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function sNe(e,t,n){return(t=oNe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oNe(e){var t=lNe(e,"string");return typeof t=="symbol"?t:t+""}function lNe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bm(){return bm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bm.apply(null,arguments)}var cNe=e=>{var{value:t,formatter:n}=e,r=Za(e.children)?t:e.children;return typeof n=="function"?n(r):r},RO=e=>e!=null&&typeof e=="function",uNe=(e,t)=>{var n=Yo(t-e),r=Math.min(Math.abs(t-e),360);return n*r},dNe=(e,t,n)=>{var{position:r,viewBox:l,offset:d,className:p}=e,{cx:a,cy:b,innerRadius:T,outerRadius:E,startAngle:P,endAngle:I,clockWise:R}=l,F=(T+E)/2,W=uNe(P,I),$=W>=0?1:-1,Z,ne;r==="insideStart"?(Z=P+$*d,ne=R):r==="insideEnd"?(Z=I-$*d,ne=!R):r==="end"&&(Z=I+$*d,ne=R),ne=W<=0?ne:!ne;var ie=fo(a,b,F,Z),ge=fo(a,b,F,Z+(ne?1:-1)*359),ae="M".concat(ie.x,",").concat(ie.y,`
    A`).concat(F,",").concat(F,",0,1,").concat(ne?0:1,`,
    `).concat(ge.x,",").concat(ge.y),se=Za(e.id)?xy("recharts-radial-line-"):e.id;return V.createElement("text",bm({},n,{dominantBaseline:"central",className:ba("recharts-radial-bar-label",p)}),V.createElement("defs",null,V.createElement("path",{id:se,d:ae})),V.createElement("textPath",{xlinkHref:"#".concat(se)},t))},hNe=e=>{var{viewBox:t,offset:n,position:r}=e,{cx:l,cy:d,innerRadius:p,outerRadius:a,startAngle:b,endAngle:T}=t,E=(b+T)/2;if(r==="outside"){var{x:P,y:I}=fo(l,d,a+n,E);return{x:P,y:I,textAnchor:P>=l?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:l,y:d,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:l,y:d,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:l,y:d,textAnchor:"middle",verticalAnchor:"end"};var R=(p+a)/2,{x:F,y:W}=fo(l,d,R,E);return{x:F,y:W,textAnchor:"middle",verticalAnchor:"middle"}},fNe=(e,t)=>{var{parentViewBox:n,offset:r,position:l}=e,{x:d,y:p,width:a,height:b}=t,T=b>=0?1:-1,E=T*r,P=T>0?"end":"start",I=T>0?"start":"end",R=a>=0?1:-1,F=R*r,W=R>0?"end":"start",$=R>0?"start":"end";if(l==="top"){var Z={x:d+a/2,y:p-T*r,textAnchor:"middle",verticalAnchor:P};return co(co({},Z),n?{height:Math.max(p-n.y,0),width:a}:{})}if(l==="bottom"){var ne={x:d+a/2,y:p+b+E,textAnchor:"middle",verticalAnchor:I};return co(co({},ne),n?{height:Math.max(n.y+n.height-(p+b),0),width:a}:{})}if(l==="left"){var ie={x:d-F,y:p+b/2,textAnchor:W,verticalAnchor:"middle"};return co(co({},ie),n?{width:Math.max(ie.x-n.x,0),height:b}:{})}if(l==="right"){var ge={x:d+a+F,y:p+b/2,textAnchor:$,verticalAnchor:"middle"};return co(co({},ge),n?{width:Math.max(n.x+n.width-ge.x,0),height:b}:{})}var ae=n?{width:a,height:b}:{};return l==="insideLeft"?co({x:d+F,y:p+b/2,textAnchor:$,verticalAnchor:"middle"},ae):l==="insideRight"?co({x:d+a-F,y:p+b/2,textAnchor:W,verticalAnchor:"middle"},ae):l==="insideTop"?co({x:d+a/2,y:p+E,textAnchor:"middle",verticalAnchor:I},ae):l==="insideBottom"?co({x:d+a/2,y:p+b-E,textAnchor:"middle",verticalAnchor:P},ae):l==="insideTopLeft"?co({x:d+F,y:p+E,textAnchor:$,verticalAnchor:I},ae):l==="insideTopRight"?co({x:d+a-F,y:p+E,textAnchor:W,verticalAnchor:I},ae):l==="insideBottomLeft"?co({x:d+F,y:p+b-E,textAnchor:$,verticalAnchor:P},ae):l==="insideBottomRight"?co({x:d+a-F,y:p+b-E,textAnchor:W,verticalAnchor:P},ae):l&&typeof l=="object"&&(lr(l.x)||H0(l.x))&&(lr(l.y)||H0(l.y))?co({x:d+Sc(l.x,a),y:p+Sc(l.y,b),textAnchor:"end",verticalAnchor:"end"},ae):co({x:d+a/2,y:p+b/2,textAnchor:"middle",verticalAnchor:"middle"},ae)},pNe=e=>"cx"in e&&lr(e.cx);function Ou(e){var{offset:t=5}=e,n=x7(e,rNe),r=co({offset:t},n),{viewBox:l,position:d,value:p,children:a,content:b,className:T="",textBreakAll:E,labelRef:P}=r,I=jD(),R=l||I;if(!R||Za(p)&&Za(a)&&!V.isValidElement(b)&&typeof b!="function")return null;if(V.isValidElement(b)){var{labelRef:F}=r,W=x7(r,iNe);return V.cloneElement(b,W)}var $;if(typeof b=="function"){if($=V.createElement(b,r),V.isValidElement($))return $}else $=cNe(r);var Z=pNe(R),ne=Qi(r,!0);if(Z&&(d==="insideStart"||d==="insideEnd"||d==="end"))return dNe(r,$,ne);var ie=Z?hNe(r):fNe(r,R);return V.createElement(K3,bm({ref:P,className:ba("recharts-label",T)},ne,ie,{breakAll:E}),$)}Ou.displayName="Label";var $K=e=>{var{cx:t,cy:n,angle:r,startAngle:l,endAngle:d,r:p,radius:a,innerRadius:b,outerRadius:T,x:E,y:P,top:I,left:R,width:F,height:W,clockWise:$,labelViewBox:Z}=e;if(Z)return Z;if(lr(F)&&lr(W)){if(lr(E)&&lr(P))return{x:E,y:P,width:F,height:W};if(lr(I)&&lr(R))return{x:I,y:R,width:F,height:W}}if(lr(E)&&lr(P))return{x:E,y:P,width:0,height:0};if(lr(t)&&lr(n))return{cx:t,cy:n,startAngle:l||r||0,endAngle:d||r||0,innerRadius:b||0,outerRadius:T||a||p||0,clockWise:$};if(e.viewBox)return e.viewBox},mNe=(e,t,n)=>{if(!e)return null;var r={viewBox:t,labelRef:n};return e===!0?V.createElement(Ou,bm({key:"label-implicit"},r)):ap(e)?V.createElement(Ou,bm({key:"label-implicit",value:e},r)):V.isValidElement(e)?e.type===Ou?V.cloneElement(e,co({key:"label-implicit"},r)):V.createElement(Ou,bm({key:"label-implicit",content:e},r)):RO(e)?V.createElement(Ou,bm({key:"label-implicit",content:e},r)):e&&typeof e=="object"?V.createElement(Ou,bm({},e,{key:"label-implicit"},r)):null},gNe=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&r&&!t.label)return null;var{children:l,labelRef:d}=t,p=$K(t),a=Ww(l,Ou).map((T,E)=>V.cloneElement(T,{viewBox:n||p,key:"label-".concat(E)}));if(!r)return a;var b=mNe(t.label,n||p,d);return[b,...a]};Ou.parseViewBox=$K;Ou.renderCallByParent=gNe;var Yj={},Qj={},v7;function xNe(){return v7||(v7=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n[n.length-1]}e.last=t}(Qj)),Qj}var Jj={},_7;function yNe(){return _7||(_7=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Array.isArray(n)?n:Array.from(n)}e.toArray=t}(Jj)),Jj}var b7;function vNe(){return b7||(b7=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xNe(),n=yNe(),r=vD();function l(d){if(r.isArrayLike(d))return t.last(n.toArray(d))}e.last=l}(Yj)),Yj}var eM,w7;function _Ne(){return w7||(w7=1,eM=vNe().last),eM}var bNe=_Ne();const wNe=Gs(bNe);var SNe=["valueAccessor"],TNe=["data","dataKey","clockWise","id","textBreakAll"];function jE(){return jE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jE.apply(null,arguments)}function S7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function T7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?S7(Object(n),!0).forEach(function(r){ENe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ENe(e,t,n){return(t=ANe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ANe(e){var t=CNe(e,"string");return typeof t=="symbol"?t:t+""}function CNe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function E7(e,t){if(e==null)return{};var n,r,l=jNe(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function jNe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var MNe=e=>Array.isArray(e.value)?wNe(e.value):e.value;function Qg(e){var{valueAccessor:t=MNe}=e,n=E7(e,SNe),{data:r,dataKey:l,clockWise:d,id:p,textBreakAll:a}=n,b=E7(n,TNe);return!r||!r.length?null:V.createElement(Hs,{className:"recharts-label-list"},r.map((T,E)=>{var P=Za(l)?t(T,E):ns(T&&T.payload,l),I=Za(p)?{}:{id:"".concat(p,"-").concat(E)};return V.createElement(Ou,jE({},Qi(T,!0),b,I,{parentViewBox:T.parentViewBox,value:P,textBreakAll:a,viewBox:Ou.parseViewBox(Za(d)?T:T7(T7({},T),{},{clockWise:d})),key:"label-".concat(E),index:E}))}))}Qg.displayName="LabelList";function PNe(e,t){return e?e===!0?V.createElement(Qg,{key:"labelList-implicit",data:t}):V.isValidElement(e)||RO(e)?V.createElement(Qg,{key:"labelList-implicit",data:t,content:e}):typeof e=="object"?V.createElement(Qg,jE({data:t},e,{key:"labelList-implicit"})):null:null}function NNe(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var{children:r}=e,l=Ww(r,Qg).map((p,a)=>V.cloneElement(p,{data:t,key:"labelList-".concat(a)}));if(!n)return l;var d=PNe(e.label,t);return[d,...l]}Qg.renderCallByParent=NNe;function iP(){return iP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},iP.apply(null,arguments)}var qK=e=>{var{cx:t,cy:n,r,className:l}=e,d=ba("recharts-dot",l);return t===+t&&n===+n&&r===+r?V.createElement("circle",iP({},Qi(e,!1),mD(e),{className:d,cx:t,cy:n,r})):null},HK=e=>e.graphicalItems.polarItems,DNe=tn([Ws,Jw],uO),zO=tn([HK,Zs,DNe],dO),ONe=tn([zO],hO),LO=tn([ONe,JD],fO),INe=tn([LO,Zs,zO],pO),kNe=tn([LO,Zs,zO],(e,t,n)=>n.length>0?e.flatMap(r=>n.flatMap(l=>{var d,p=ns(r,(d=t.dataKey)!==null&&d!==void 0?d:l.dataKey);return{value:p,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(r=>({value:ns(r,t.dataKey),errorDomain:[]})):e.map(r=>({value:r,errorDomain:[]}))),A7=()=>{},RNe=tn([Zs,JX,A7,kNe,A7],xO),GK=tn([Zs,ha,LO,INe,Qw,Ws,RNe],yO),zNe=tn([GK,Zs,R_],bO);tn([Zs,GK,zNe,Ws],SO);var LNe={radiusAxis:{},angleAxis:{}},WK=Ia({name:"polarAxis",initialState:LNe,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:W6e,removeRadiusAxis:Z6e,addAngleAxis:X6e,removeAngleAxis:K6e}=WK.actions,FNe=WK.reducer;function C7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function j7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?C7(Object(n),!0).forEach(function(r){BNe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function BNe(e,t,n){return(t=VNe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VNe(e){var t=UNe(e,"string");return typeof t=="symbol"?t:t+""}function UNe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FO=(e,t)=>t,$Ne=[],BO=(e,t,n)=>(n==null?void 0:n.length)===0?$Ne:n,ZK=tn([JD,FO,BO],(e,t,n)=>{var{chartData:r}=e,l;if((t==null?void 0:t.data)!=null&&t.data.length>0?l=t.data:l=r,(!l||!l.length)&&n!=null&&(l=n.map(d=>j7(j7({},t.presentationProps),d.props))),l!=null)return l}),qNe=tn([ZK,FO,BO],(e,t,n)=>{if(e!=null)return e.map((r,l)=>{var d,p=ns(r,t.nameKey,t.name),a;return n!=null&&(d=n[l])!==null&&d!==void 0&&(d=d.props)!==null&&d!==void 0&&d.fill?a=n[l].props.fill:typeof r=="object"&&r!=null&&"fill"in r?a=r.fill:a=t.fill,{value:N_(p,t.dataKey),color:a,payload:r,type:t.legendType}})}),HNe=tn([HK,FO],(e,t)=>{if(e.some(n=>n.type==="pie"&&t.dataKey===n.dataKey&&t.data===n.data))return t}),GNe=tn([ZK,HNe,BO,Mo],(e,t,n,r)=>{if(!(t==null||e==null))return zDe({offset:r,pieSettings:t,displayedData:e,cells:n})}),WNe={countOfBars:0,cartesianItems:[],polarItems:[]},XK=Ia({name:"graphicalItems",initialState:WNe,reducers:{addBar(e){e.countOfBars+=1},removeBar(e){e.countOfBars-=1},addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:n,next:r}=t.payload,l=Tm(e).cartesianItems.indexOf(n);l>-1&&(e.cartesianItems[l]=r)},removeCartesianGraphicalItem(e,t){var n=Tm(e).cartesianItems.indexOf(t.payload);n>-1&&e.cartesianItems.splice(n,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var n=Tm(e).polarItems.indexOf(t.payload);n>-1&&e.polarItems.splice(n,1)}}}),{addBar:ZNe,removeBar:XNe,addCartesianGraphicalItem:KNe,replaceCartesianGraphicalItem:YNe,removeCartesianGraphicalItem:QNe,addPolarGraphicalItem:JNe,removePolarGraphicalItem:eDe}=XK.actions,tDe=XK.reducer;function M7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function P7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?M7(Object(n),!0).forEach(function(r){nDe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function nDe(e,t,n){return(t=rDe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rDe(e){var t=iDe(e,"string");return typeof t=="symbol"?t:t+""}function iDe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aDe(e){var t=Ns(),n=V.useRef(null);return V.useEffect(()=>{var r=P7(P7({},e),{},{stackId:ED(e.stackId)});n.current===null?t(KNe(r)):n.current!==r&&t(YNe({prev:n.current,next:r})),n.current=r},[t,e]),V.useEffect(()=>()=>{n.current&&(t(QNe(n.current)),n.current=null)},[t]),null}function sDe(e){var t=Ns();return V.useEffect(()=>(t(JNe(e)),()=>{t(eDe(e))}),[t,e]),null}var tM={},N7;function oDe(){return N7||(N7=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){var l;if(typeof n!="object"||n==null)return!1;if(Object.getPrototypeOf(n)===null)return!0;if(Object.prototype.toString.call(n)!=="[object Object]"){const d=n[Symbol.toStringTag];return d==null||!((l=Object.getOwnPropertyDescriptor(n,Symbol.toStringTag))!=null&&l.writable)?!1:n.toString()===`[object ${d}]`}let r=n;for(;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(n)===r}e.isPlainObject=t}(tM)),tM}var nM,D7;function lDe(){return D7||(D7=1,nM=oDe().isPlainObject),nM}var cDe=lDe();const uDe=Gs(cDe);function ME(){return ME=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ME.apply(null,arguments)}var O7=(e,t,n,r,l)=>{var d=n-r,p;return p="M ".concat(e,",").concat(t),p+="L ".concat(e+n,",").concat(t),p+="L ".concat(e+n-d/2,",").concat(t+l),p+="L ".concat(e+n-d/2-r,",").concat(t+l),p+="L ".concat(e,",").concat(t," Z"),p},dDe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},hDe=e=>{var t=$d(e,dDe),n=V.useRef(),[r,l]=V.useState(-1);V.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var $=n.current.getTotalLength();$&&l($)}catch{}},[]);var{x:d,y:p,upperWidth:a,lowerWidth:b,height:T,className:E}=t,{animationEasing:P,animationDuration:I,animationBegin:R,isUpdateAnimationActive:F}=t;if(d!==+d||p!==+p||a!==+a||b!==+b||T!==+T||a===0&&b===0||T===0)return null;var W=ba("recharts-trapezoid",E);return F?V.createElement(lx,{canBegin:r>0,from:{upperWidth:0,lowerWidth:0,height:T,x:d,y:p},to:{upperWidth:a,lowerWidth:b,height:T,x:d,y:p},duration:I,animationEasing:P,isActive:F},$=>{var{upperWidth:Z,lowerWidth:ne,height:ie,x:ge,y:ae}=$;return V.createElement(lx,{canBegin:r>0,from:"0px ".concat(r===-1?1:r,"px"),to:"".concat(r,"px 0px"),attributeName:"strokeDasharray",begin:R,duration:I,easing:P},V.createElement("path",ME({},Qi(t,!0),{className:W,d:O7(ge,ae,Z,ne,ie),ref:n})))}):V.createElement("g",null,V.createElement("path",ME({},Qi(t,!0),{className:W,d:O7(d,p,a,b,T)})))},fDe=["option","shapeType","propTransformer","activeClassName","isActive"];function pDe(e,t){if(e==null)return{};var n,r,l=mDe(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function mDe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function I7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function PE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?I7(Object(n),!0).forEach(function(r){gDe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function gDe(e,t,n){return(t=xDe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xDe(e){var t=yDe(e,"string");return typeof t=="symbol"?t:t+""}function yDe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vDe(e,t){return PE(PE({},t),e)}function _De(e,t){return e==="symbols"}function k7(e){var{shapeType:t,elementProps:n}=e;switch(t){case"rectangle":return V.createElement(kZ,n);case"trapezoid":return V.createElement(hDe,n);case"sector":return V.createElement(LZ,n);case"symbols":if(_De(t))return V.createElement(oZ,n);break;default:return null}}function bDe(e){return V.isValidElement(e)?e.props:e}function KK(e){var{option:t,shapeType:n,propTransformer:r=vDe,activeClassName:l="recharts-active-shape",isActive:d}=e,p=pDe(e,fDe),a;if(V.isValidElement(t))a=V.cloneElement(t,PE(PE({},p),bDe(t)));else if(typeof t=="function")a=t(p);else if(uDe(t)&&typeof t!="boolean"){var b=r(t,p);a=V.createElement(k7,{shapeType:n,elementProps:b})}else{var T=p;a=V.createElement(k7,{shapeType:n,elementProps:T})}return d?V.createElement(Hs,{className:l},a):a}var VO=(e,t)=>{var n=Ns();return(r,l)=>d=>{e==null||e(r,l,d),n(mK({activeIndex:String(l),activeDataKey:t,activeCoordinate:r.tooltipPosition}))}},UO=e=>{var t=Ns();return(n,r)=>l=>{e==null||e(n,r,l),t(l5e())}},$O=(e,t)=>{var n=Ns();return(r,l)=>d=>{e==null||e(r,l,d),n(c5e({activeIndex:String(l),activeDataKey:t,activeCoordinate:r.tooltipPosition}))}};function qO(e){var{fn:t,args:n}=e,r=Ns(),l=Ac();return V.useEffect(()=>{if(!l){var d=t(n);return r(a5e(d)),()=>{r(s5e(d))}}},[t,n,r,l]),null}var YK=()=>{};function QK(e){var{legendPayload:t}=e,n=Ns(),r=Ac();return V.useEffect(()=>r?YK:(n(MZ(t)),()=>{n(PZ(t))}),[n,r,t]),null}function wDe(e){var{legendPayload:t}=e,n=Ns(),r=Or(ha);return V.useEffect(()=>r!=="centric"&&r!=="radial"?YK:(n(MZ(t)),()=>{n(PZ(t))}),[n,r,t]),null}function HO(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",n=V.useRef(xy(t)),r=V.useRef(e);return r.current!==e&&(n.current=xy(t),r.current=e),n.current}var SDe=["onMouseEnter","onClick","onMouseLeave"];function TDe(e,t){if(e==null)return{};var n,r,l=EDe(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function EDe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function R7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function js(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?R7(Object(n),!0).forEach(function(r){Y3(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Y3(e,t,n){return(t=ADe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ADe(e){var t=CDe(e,"string");return typeof t=="symbol"?t:t+""}function CDe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vy(){return vy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vy.apply(null,arguments)}function jDe(e){var t=V.useMemo(()=>Qi(e,!1),[e]),n=V.useMemo(()=>Ww(e.children,oy),[e.children]),r=V.useMemo(()=>({name:e.name,nameKey:e.nameKey,tooltipType:e.tooltipType,data:e.data,dataKey:e.dataKey,cx:e.cx,cy:e.cy,startAngle:e.startAngle,endAngle:e.endAngle,minAngle:e.minAngle,paddingAngle:e.paddingAngle,innerRadius:e.innerRadius,outerRadius:e.outerRadius,cornerRadius:e.cornerRadius,legendType:e.legendType,fill:e.fill,presentationProps:t}),[e.cornerRadius,e.cx,e.cy,e.data,e.dataKey,e.endAngle,e.innerRadius,e.minAngle,e.name,e.nameKey,e.outerRadius,e.paddingAngle,e.startAngle,e.tooltipType,e.legendType,e.fill,t]),l=Or(d=>qNe(d,r,n));return V.createElement(wDe,{legendPayload:l})}function MDe(e){var{dataKey:t,nameKey:n,sectors:r,stroke:l,strokeWidth:d,fill:p,name:a,hide:b,tooltipType:T}=e;return{dataDefinedOnItem:r==null?void 0:r.map(E=>E.tooltipPayload),positions:r==null?void 0:r.map(E=>E.tooltipPosition),settings:{stroke:l,strokeWidth:d,fill:p,dataKey:t,nameKey:n,name:N_(a,t),hide:b,type:T,color:p,unit:""}}}var PDe=(e,t)=>e>t?"start":e<t?"end":"middle",NDe=(e,t,n)=>typeof t=="function"?t(e):Sc(t,n,n*.8),DDe=(e,t,n)=>{var{top:r,left:l,width:d,height:p}=t,a=yZ(d,p),b=l+Sc(e.cx,d,d/2),T=r+Sc(e.cy,p,p/2),E=Sc(e.innerRadius,a,0),P=NDe(n,e.outerRadius,a),I=e.maxRadius||Math.sqrt(d*d+p*p)/2;return{cx:b,cy:T,innerRadius:E,outerRadius:P,maxRadius:I}},ODe=(e,t)=>{var n=Yo(t-e),r=Math.min(Math.abs(t-e),360);return n*r},IDe=(e,t)=>{if(V.isValidElement(e))return V.cloneElement(e,t);if(typeof e=="function")return e(t);var n=ba("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return V.createElement(qb,vy({},t,{type:"linear",className:n}))},kDe=(e,t,n)=>{if(V.isValidElement(e))return V.cloneElement(e,t);var r=n;if(typeof e=="function"&&(r=e(t),V.isValidElement(r)))return r;var l=ba("recharts-pie-label-text",typeof e!="boolean"&&typeof e!="function"?e.className:"");return V.createElement(K3,vy({},t,{alignmentBaseline:"middle",className:l}),r)};function RDe(e){var{sectors:t,props:n,showLabels:r}=e,{label:l,labelLine:d,dataKey:p}=n;if(!r||!l||!t)return null;var a=Qi(n,!1),b=Qi(l,!1),T=Qi(d,!1),E=typeof l=="object"&&"offsetRadius"in l&&l.offsetRadius||20,P=t.map((I,R)=>{var F=(I.startAngle+I.endAngle)/2,W=fo(I.cx,I.cy,I.outerRadius+E,F),$=js(js(js(js({},a),I),{},{stroke:"none"},b),{},{index:R,textAnchor:PDe(W.x,I.cx)},W),Z=js(js(js(js({},a),I),{},{fill:"none",stroke:I.fill},T),{},{index:R,points:[fo(I.cx,I.cy,I.outerRadius,F),W],key:"line"});return V.createElement(Hs,{key:"label-".concat(I.startAngle,"-").concat(I.endAngle,"-").concat(I.midAngle,"-").concat(R)},d&&IDe(d,Z),kDe(l,$,ns(I,p)))});return V.createElement(Hs,{className:"recharts-pie-labels"},P)}function JK(e){var{sectors:t,activeShape:n,inactiveShape:r,allOtherPieProps:l,showLabels:d}=e,p=Or(ux),{onMouseEnter:a,onClick:b,onMouseLeave:T}=l,E=TDe(l,SDe),P=VO(a,l.dataKey),I=UO(T),R=$O(b,l.dataKey);return t==null?null:V.createElement(V.Fragment,null,t.map((F,W)=>{if((F==null?void 0:F.startAngle)===0&&(F==null?void 0:F.endAngle)===0&&t.length!==1)return null;var $=n&&String(W)===p,Z=p?r:null,ne=$?n:Z,ie=js(js({},F),{},{stroke:F.stroke,tabIndex:-1,[wZ]:W,[SZ]:l.dataKey});return V.createElement(Hs,vy({tabIndex:-1,className:"recharts-pie-sector"},E3(E,F,W),{onMouseEnter:P(F,W),onMouseLeave:I(F,W),onClick:R(F,W),key:"sector-".concat(F==null?void 0:F.startAngle,"-").concat(F==null?void 0:F.endAngle,"-").concat(F.midAngle,"-").concat(W)}),V.createElement(KK,vy({option:ne,isActive:$,shapeType:"sector"},ie)))}),V.createElement(RDe,{sectors:t,props:l,showLabels:d}))}function zDe(e){var t,{pieSettings:n,displayedData:r,cells:l,offset:d}=e,{cornerRadius:p,startAngle:a,endAngle:b,dataKey:T,nameKey:E,tooltipType:P}=n,I=Math.abs(n.minAngle),R=ODe(a,b),F=Math.abs(R),W=r.length<=1?0:(t=n.paddingAngle)!==null&&t!==void 0?t:0,$=r.filter(se=>ns(se,T,0)!==0).length,Z=(F>=360?$:$-1)*W,ne=F-$*I-Z,ie=r.reduce((se,me)=>{var ke=ns(me,T,0);return se+(lr(ke)?ke:0)},0),ge;if(ie>0){var ae;ge=r.map((se,me)=>{var ke=ns(se,T,0),qe=ns(se,E,me),tt=DDe(n,d,se),nt=(lr(ke)?ke:0)/ie,bt,jt=js(js({},se),l&&l[me]&&l[me].props);me?bt=ae.endAngle+Yo(R)*W*(ke!==0?1:0):bt=a;var Nt=bt+Yo(R)*((ke!==0?I:0)+nt*ne),vt=(bt+Nt)/2,He=(tt.innerRadius+tt.outerRadius)/2,ut=[{name:qe,value:ke,payload:jt,dataKey:T,type:P}],Tt=fo(tt.cx,tt.cy,He,vt);return ae=js(js(js(js({},n.presentationProps),{},{percent:nt,cornerRadius:p,name:qe,tooltipPayload:ut,midAngle:vt,middleRadius:He,tooltipPosition:Tt},jt),tt),{},{value:ns(se,T),startAngle:bt,endAngle:Nt,payload:jt,paddingAngle:Yo(R)*W}),ae})}return ge}function LDe(e){var{props:t,previousSectorsRef:n}=e,{sectors:r,isAnimationActive:l,animationBegin:d,animationDuration:p,animationEasing:a,activeShape:b,inactiveShape:T,onAnimationStart:E,onAnimationEnd:P}=t,I=HO(t,"recharts-pie-"),R=n.current,[F,W]=V.useState(!0),$=V.useCallback(()=>{typeof P=="function"&&P(),W(!1)},[P]),Z=V.useCallback(()=>{typeof E=="function"&&E(),W(!0)},[E]);return V.createElement(lx,{begin:d,duration:p,isActive:l,easing:a,from:{t:0},to:{t:1},onAnimationStart:Z,onAnimationEnd:$,key:I},ne=>{var{t:ie}=ne,ge=[],ae=r&&r[0],se=ae.startAngle;return r.forEach((me,ke)=>{var qe=R&&R[ke],tt=ke>0?ox(me,"paddingAngle",0):0;if(qe){var nt=Hg(qe.endAngle-qe.startAngle,me.endAngle-me.startAngle),bt=js(js({},me),{},{startAngle:se+tt,endAngle:se+nt(ie)+tt});ge.push(bt),se=bt.endAngle}else{var{endAngle:jt,startAngle:Nt}=me,vt=Hg(0,jt-Nt),He=vt(ie),ut=js(js({},me),{},{startAngle:se+tt,endAngle:se+He+tt});ge.push(ut),se=ut.endAngle}}),n.current=ge,V.createElement(Hs,null,V.createElement(JK,{sectors:ge,activeShape:b,inactiveShape:T,allOtherPieProps:t,showLabels:!F}))})}function FDe(e){var{sectors:t,isAnimationActive:n,activeShape:r,inactiveShape:l}=e,d=V.useRef(null),p=d.current;return n&&t&&t.length&&(!p||p!==t)?V.createElement(LDe,{props:e,previousSectorsRef:d}):V.createElement(JK,{sectors:t,activeShape:r,inactiveShape:l,allOtherPieProps:e,showLabels:!0})}function BDe(e){var{hide:t,className:n,rootTabIndex:r}=e,l=ba("recharts-pie",n);return t?null:V.createElement(Hs,{tabIndex:r,className:l},V.createElement(FDe,e))}var eY={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!Py.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function VDe(e){var t=$d(e,eY),n=V.useMemo(()=>Ww(e.children,oy),[e.children]),r=Qi(t,!1),l=V.useMemo(()=>({name:t.name,nameKey:t.nameKey,tooltipType:t.tooltipType,data:t.data,dataKey:t.dataKey,cx:t.cx,cy:t.cy,startAngle:t.startAngle,endAngle:t.endAngle,minAngle:t.minAngle,paddingAngle:t.paddingAngle,innerRadius:t.innerRadius,outerRadius:t.outerRadius,cornerRadius:t.cornerRadius,legendType:t.legendType,fill:t.fill,presentationProps:r}),[t.cornerRadius,t.cx,t.cy,t.data,t.dataKey,t.endAngle,t.innerRadius,t.minAngle,t.name,t.nameKey,t.outerRadius,t.paddingAngle,t.startAngle,t.tooltipType,t.legendType,t.fill,r]),d=Or(p=>GNe(p,l,n));return V.createElement(V.Fragment,null,V.createElement(qO,{fn:MDe,args:js(js({},t),{},{sectors:d})}),V.createElement(BDe,vy({},t,{sectors:d})))}class NE extends V.PureComponent{constructor(){super(...arguments),Y3(this,"id",xy("recharts-pie-"))}render(){return V.createElement(V.Fragment,null,V.createElement(sDe,{data:this.props.data,dataKey:this.props.dataKey,hide:this.props.hide,angleAxisId:0,radiusAxisId:0,stackId:void 0,barSize:void 0,type:"pie"}),V.createElement(jDe,this.props),V.createElement(VDe,this.props),this.props.children)}}Y3(NE,"displayName","Pie");Y3(NE,"defaultProps",eY);var UDe=tn([Mo],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),$De=tn([UDe,Bm,Vm],(e,t,n)=>{if(!(!e||t==null||n==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,n-e.top-e.bottom)}}),qDe=e=>{var t=Ac();return Or(n=>op(n,"xAxis",e,t))},HDe=e=>{var t=Ac();return Or(n=>op(n,"yAxis",e,t))},GO=()=>Or($De),GDe=()=>Or(W5e);function z7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function L7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?z7(Object(n),!0).forEach(function(r){WDe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function WDe(e,t,n){return(t=ZDe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ZDe(e){var t=XDe(e,"string");return typeof t=="symbol"?t:t+""}function XDe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KDe=e=>{var{point:t,childIndex:n,mainColor:r,activeDot:l,dataKey:d}=e;if(l===!1||t.x==null||t.y==null)return null;var p=L7(L7({index:n,dataKey:d,cx:t.x,cy:t.y,r:4,fill:r??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},Qi(l,!1)),mD(l)),a;return V.isValidElement(l)?a=V.cloneElement(l,p):typeof l=="function"?a=l(p):a=V.createElement(qK,p),V.createElement(Hs,{className:"recharts-active-dot"},a)};function F7(e){var{points:t,mainColor:n,activeDot:r,itemDataKey:l}=e,d=Or(ux),p=GDe();if(t==null||p==null)return null;var a=t.find(b=>p.includes(b.payload));return Za(a)?null:KDe({point:a,childIndex:Number(d),mainColor:n,dataKey:l,activeDot:r})}var YDe=()=>{var e=Ns();return V.useEffect(()=>(e(ZNe()),()=>{e(XNe())})),null},QDe=["children"];function JDe(e,t){if(e==null)return{};var n,r,l=eOe(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function eOe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var B7=()=>{},tY=V.createContext({addErrorBar:B7,removeErrorBar:B7}),tOe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},nY=V.createContext(tOe);function nOe(e){var{children:t}=e,n=JDe(e,QDe);return V.createElement(nY.Provider,{value:n},t)}var rOe=()=>V.useContext(nY),rY=e=>{var{children:t,xAxisId:n,yAxisId:r,zAxisId:l,dataKey:d,data:p,stackId:a,hide:b,type:T,barSize:E}=e,[P,I]=V.useState([]),R=V.useCallback($=>{I(Z=>[...Z,$])},[I]),F=V.useCallback($=>{I(Z=>Z.filter(ne=>ne!==$))},[I]),W=Ac();return V.createElement(tY.Provider,{value:{addErrorBar:R,removeErrorBar:F}},V.createElement(aDe,{type:T,data:p,xAxisId:n,yAxisId:r,zAxisId:l,dataKey:d,errorBars:P,stackId:a,hide:b,barSize:E,isPanorama:W}),t)};function iOe(e){var{addErrorBar:t,removeErrorBar:n}=V.useContext(tY);return V.useEffect(()=>(t(e),()=>{n(e)}),[t,n,e]),null}var aOe=["direction","width","dataKey","isAnimationActive","animationBegin","animationDuration","animationEasing"];function iY(e,t,n){return(t=sOe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sOe(e){var t=oOe(e,"string");return typeof t=="symbol"?t:t+""}function oOe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Aw(){return Aw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Aw.apply(null,arguments)}function lOe(e,t){if(e==null)return{};var n,r,l=cOe(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function cOe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function uOe(e){var{direction:t,width:n,dataKey:r,isAnimationActive:l,animationBegin:d,animationDuration:p,animationEasing:a}=e,b=lOe(e,aOe),T=Qi(b,!1),{data:E,dataPointFormatter:P,xAxisId:I,yAxisId:R,errorBarOffset:F}=rOe(),W=qDe(I),$=HDe(R);if((W==null?void 0:W.scale)==null||($==null?void 0:$.scale)==null||E==null||t==="x"&&W.type!=="number")return null;var Z=E.map(ne=>{var{x:ie,y:ge,value:ae,errorVal:se}=P(ne,r,t);if(!se)return null;var me=[],ke,qe;if(Array.isArray(se)?[ke,qe]=se:ke=qe=se,t==="x"){var{scale:tt}=W,nt=ge+F,bt=nt+n,jt=nt-n,Nt=tt(ae-ke),vt=tt(ae+qe);me.push({x1:vt,y1:bt,x2:vt,y2:jt}),me.push({x1:Nt,y1:nt,x2:vt,y2:nt}),me.push({x1:Nt,y1:bt,x2:Nt,y2:jt})}else if(t==="y"){var{scale:He}=$,ut=ie+F,Tt=ut-n,Yt=ut+n,Ge=He(ae-ke),ot=He(ae+qe);me.push({x1:Tt,y1:ot,x2:Yt,y2:ot}),me.push({x1:ut,y1:Ge,x2:ut,y2:ot}),me.push({x1:Tt,y1:Ge,x2:Yt,y2:Ge})}var mt="".concat(ie+F,"px ").concat(ge+F,"px");return V.createElement(Hs,Aw({className:"recharts-errorBar",key:"bar-".concat(me.map(It=>"".concat(It.x1,"-").concat(It.x2,"-").concat(It.y1,"-").concat(It.y2)))},T),me.map(It=>{var In=l?{transformOrigin:"".concat(It.x1-5,"px")}:void 0;return V.createElement(lx,{from:{transform:"scaleY(0)",transformOrigin:mt},to:{transform:"scaleY(1)",transformOrigin:mt},begin:d,easing:a,isActive:l,duration:p,key:"line-".concat(It.x1,"-").concat(It.x2,"-").concat(It.y1,"-").concat(It.y2),style:{transformOrigin:mt}},V.createElement("line",Aw({},It,{style:In})))}))});return V.createElement(Hs,{className:"recharts-errorBars"},Z)}var aY=V.createContext(void 0);function dOe(e){var t=V.useContext(aY);return e??t??"x"}function hOe(e){var{direction:t,children:n}=e;return V.createElement(aY.Provider,{value:t},n)}var sY={stroke:"black",strokeWidth:1.5,width:5,offset:0,isAnimationActive:!0,animationBegin:0,animationDuration:400,animationEasing:"ease-in-out"};function fOe(e){var t=dOe(e.direction),{width:n,isAnimationActive:r,animationBegin:l,animationDuration:d,animationEasing:p}=$d(e,sY);return V.createElement(V.Fragment,null,V.createElement(iOe,{dataKey:e.dataKey,direction:t}),V.createElement(uOe,Aw({},e,{direction:t,width:n,isAnimationActive:r,animationBegin:l,animationDuration:d,animationEasing:p})))}class oY extends V.Component{render(){return V.createElement(fOe,this.props)}}iY(oY,"defaultProps",sY);iY(oY,"displayName","ErrorBar");var pOe="Invariant failed";function mOe(e,t){throw new Error(pOe)}var gOe=["x","y"];function aP(){return aP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},aP.apply(null,arguments)}function V7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function xb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?V7(Object(n),!0).forEach(function(r){xOe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function xOe(e,t,n){return(t=yOe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yOe(e){var t=vOe(e,"string");return typeof t=="symbol"?t:t+""}function vOe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _Oe(e,t){if(e==null)return{};var n,r,l=bOe(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function bOe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function wOe(e,t){var{x:n,y:r}=e,l=_Oe(e,gOe),d="".concat(n),p=parseInt(d,10),a="".concat(r),b=parseInt(a,10),T="".concat(t.height||l.height),E=parseInt(T,10),P="".concat(t.width||l.width),I=parseInt(P,10);return xb(xb(xb(xb(xb({},t),l),p?{x:p}:{}),b?{y:b}:{}),{},{height:E,width:I,name:t.name,radius:t.radius})}function lY(e){return V.createElement(KK,aP({shapeType:"rectangle",propTransformer:wOe,activeClassName:"recharts-active-bar"},e))}var SOe=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(r,l)=>{if(lr(t))return t;var d=lr(r)||Za(r);return d?t(r,l):(d||mOe(),n)}};function WO(e,t){var n,r,l=Or(T=>$m(T,e)),d=Or(T=>xx(T,t)),p=(n=l==null?void 0:l.allowDataOverflow)!==null&&n!==void 0?n:ju.allowDataOverflow,a=(r=d==null?void 0:d.allowDataOverflow)!==null&&r!==void 0?r:Mu.allowDataOverflow,b=p||a;return{needClip:b,needClipX:p,needClipY:a}}function cY(e){var{xAxisId:t,yAxisId:n,clipPathId:r}=e,l=GO(),{needClipX:d,needClipY:p,needClip:a}=WO(t,n);if(!a)return null;var{x:b,y:T,width:E,height:P}=l;return V.createElement("clipPath",{id:"clipPath-".concat(r)},V.createElement("rect",{x:d?b:b-E/2,y:p?T:T-P/2,width:d?E:E*2,height:p?P:P*2}))}var TOe=["onMouseEnter","onMouseLeave","onClick"],EOe=["value","background","tooltipPosition"],AOe=["onMouseEnter","onClick","onMouseLeave"];function Cw(){return Cw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Cw.apply(null,arguments)}function U7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function ql(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?U7(Object(n),!0).forEach(function(r){Q3(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Q3(e,t,n){return(t=COe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function COe(e){var t=jOe(e,"string");return typeof t=="symbol"?t:t+""}function jOe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sP(e,t){if(e==null)return{};var n,r,l=MOe(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function MOe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var POe=e=>{var{dataKey:t,name:n,fill:r,legendType:l,hide:d}=e;return[{inactive:d,dataKey:t,type:l,color:r,value:N_(n,t),payload:e}]};function NOe(e){var{dataKey:t,stroke:n,strokeWidth:r,fill:l,name:d,hide:p,unit:a}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:n,strokeWidth:r,fill:l,dataKey:t,nameKey:void 0,name:N_(d,t),hide:p,type:e.tooltipType,color:e.fill,unit:a}}}function DOe(e){var t=Or(ux),{data:n,dataKey:r,background:l,allOtherBarProps:d}=e,{onMouseEnter:p,onMouseLeave:a,onClick:b}=d,T=sP(d,TOe),E=VO(p,r),P=UO(a),I=$O(b,r);if(!l||n==null)return null;var R=Qi(l,!1);return V.createElement(V.Fragment,null,n.map((F,W)=>{var{value:$,background:Z,tooltipPosition:ne}=F,ie=sP(F,EOe);if(!Z)return null;var ge=E(F,W),ae=P(F,W),se=I(F,W),me=ql(ql(ql(ql(ql({option:l,isActive:String(W)===t},ie),{},{fill:"#eee"},Z),R),E3(T,F,W)),{},{onMouseEnter:ge,onMouseLeave:ae,onClick:se,dataKey:r,index:W,className:"recharts-bar-background-rectangle"});return V.createElement(lY,Cw({key:"background-bar-".concat(W)},me))}))}function uY(e){var{data:t,props:n,showLabels:r}=e,l=Qi(n,!1),{shape:d,dataKey:p,activeBar:a}=n,b=Or(ux),T=Or(jK),{onMouseEnter:E,onClick:P,onMouseLeave:I}=n,R=sP(n,AOe),F=VO(E,p),W=UO(I),$=$O(P,p);return t?V.createElement(V.Fragment,null,t.map((Z,ne)=>{var ie=a&&String(ne)===b&&(T==null||p===T),ge=ie?a:d,ae=ql(ql(ql({},l),Z),{},{isActive:ie,option:ge,index:ne,dataKey:p});return V.createElement(Hs,Cw({className:"recharts-bar-rectangle"},E3(R,Z,ne),{onMouseEnter:F(Z,ne),onMouseLeave:W(Z,ne),onClick:$(Z,ne),key:"rectangle-".concat(Z==null?void 0:Z.x,"-").concat(Z==null?void 0:Z.y,"-").concat(Z==null?void 0:Z.value,"-").concat(ne)}),V.createElement(lY,ae))}),r&&Qg.renderCallByParent(n,t)):null}function OOe(e){var{props:t,previousRectanglesRef:n}=e,{data:r,layout:l,isAnimationActive:d,animationBegin:p,animationDuration:a,animationEasing:b,onAnimationEnd:T,onAnimationStart:E}=t,P=n.current,I=HO(t,"recharts-bar-"),[R,F]=V.useState(!1),W=V.useCallback(()=>{typeof T=="function"&&T(),F(!1)},[T]),$=V.useCallback(()=>{typeof E=="function"&&E(),F(!0)},[E]);return V.createElement(lx,{begin:p,duration:a,isActive:d,easing:b,from:{t:0},to:{t:1},onAnimationEnd:W,onAnimationStart:$,key:I},Z=>{var{t:ne}=Z,ie=ne===1?r:r.map((ge,ae)=>{var se=P&&P[ae];if(se){var me=Hg(se.x,ge.x),ke=Hg(se.y,ge.y),qe=Hg(se.width,ge.width),tt=Hg(se.height,ge.height);return ql(ql({},ge),{},{x:me(ne),y:ke(ne),width:qe(ne),height:tt(ne)})}if(l==="horizontal"){var nt=Hg(0,ge.height),bt=nt(ne);return ql(ql({},ge),{},{y:ge.y+ge.height-bt,height:bt})}var jt=Hg(0,ge.width),Nt=jt(ne);return ql(ql({},ge),{},{width:Nt})});return ne>0&&(n.current=ie),V.createElement(Hs,null,V.createElement(uY,{props:t,data:ie,showLabels:!R}))})}function IOe(e){var{data:t,isAnimationActive:n}=e,r=V.useRef(null);return n&&t&&t.length&&(r.current==null||r.current!==t)?V.createElement(OOe,{previousRectanglesRef:r,props:e}):V.createElement(uY,{props:e,data:t,showLabels:!0})}var dY=0,kOe=(e,t)=>{var n=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:n,errorVal:ns(e,t)}};class ROe extends V.PureComponent{constructor(){super(...arguments),Q3(this,"id",xy("recharts-bar-"))}render(){var{hide:t,data:n,dataKey:r,className:l,xAxisId:d,yAxisId:p,needClip:a,background:b,id:T,layout:E}=this.props;if(t)return null;var P=ba("recharts-bar",l),I=Za(T)?this.id:T;return V.createElement(Hs,{className:P},a&&V.createElement("defs",null,V.createElement(cY,{clipPathId:I,xAxisId:d,yAxisId:p})),V.createElement(Hs,{className:"recharts-bar-rectangles",clipPath:a?"url(#clipPath-".concat(I,")"):null},V.createElement(DOe,{data:n,dataKey:r,background:b,allOtherBarProps:this.props}),V.createElement(IOe,this.props)),V.createElement(hOe,{direction:E==="horizontal"?"y":"x"},this.props.children))}}var hY={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Py.isSsr,legendType:"rect",minPointSize:dY,xAxisId:0,yAxisId:0};function zOe(e){var{xAxisId:t,yAxisId:n,hide:r,legendType:l,minPointSize:d,activeBar:p,animationBegin:a,animationDuration:b,animationEasing:T,isAnimationActive:E}=$d(e,hY),{needClip:P}=WO(t,n),I=O3(),R=Ac(),F=V.useMemo(()=>({barSize:e.barSize,data:void 0,dataKey:e.dataKey,maxBarSize:e.maxBarSize,minPointSize:d,stackId:ED(e.stackId)}),[e.barSize,e.dataKey,e.maxBarSize,d,e.stackId]),W=Ww(e.children,oy),$=Or(ie=>dIe(ie,t,n,R,F,W));if(I!=="vertical"&&I!=="horizontal")return null;var Z,ne=$==null?void 0:$[0];return ne==null||ne.height==null||ne.width==null?Z=0:Z=I==="vertical"?ne.height/2:ne.width/2,V.createElement(nOe,{xAxisId:t,yAxisId:n,data:$,dataPointFormatter:kOe,errorBarOffset:Z},V.createElement(ROe,Cw({},e,{layout:I,needClip:P,data:$,xAxisId:t,yAxisId:n,hide:r,legendType:l,minPointSize:d,activeBar:p,animationBegin:a,animationDuration:b,animationEasing:T,isAnimationActive:E})))}function LOe(e){var{layout:t,barSettings:{dataKey:n,minPointSize:r},pos:l,bandSize:d,xAxis:p,yAxis:a,xAxisTicks:b,yAxisTicks:T,stackedData:E,displayedData:P,offset:I,cells:R}=e,F=t==="horizontal"?a:p,W=E?F.scale.domain():null,$=I3e({numericAxis:F});return P.map((Z,ne)=>{var ie,ge,ae,se,me,ke;E?ie=M3e(E[ne],W):(ie=ns(Z,n),Array.isArray(ie)||(ie=[$,ie]));var qe=SOe(r,dY)(ie[1],ne);if(t==="horizontal"){var tt,[nt,bt]=[a.scale(ie[0]),a.scale(ie[1])];ge=jB({axis:p,ticks:b,bandSize:d,offset:l.offset,entry:Z,index:ne}),ae=(tt=bt??nt)!==null&&tt!==void 0?tt:void 0,se=l.size;var jt=nt-bt;if(me=Xc(jt)?0:jt,ke={x:ge,y:I.top,width:se,height:I.height},Math.abs(qe)>0&&Math.abs(me)<Math.abs(qe)){var Nt=Yo(me||qe)*(Math.abs(qe)-Math.abs(me));ae-=Nt,me+=Nt}}else{var[vt,He]=[p.scale(ie[0]),p.scale(ie[1])];if(ge=vt,ae=jB({axis:a,ticks:T,bandSize:d,offset:l.offset,entry:Z,index:ne}),se=He-vt,me=l.size,ke={x:I.left,y:ae,width:I.width,height:me},Math.abs(qe)>0&&Math.abs(se)<Math.abs(qe)){var ut=Yo(se||qe)*(Math.abs(qe)-Math.abs(se));se+=ut}}var Tt=ql(ql({},Z),{},{x:ge,y:ae,width:se,height:me,value:E?ie:ie[1],payload:Z,background:ke,tooltipPosition:{x:ge+se/2,y:ae+me/2}},R&&R[ne]&&R[ne].props);return Tt})}class DE extends V.PureComponent{render(){return V.createElement(rY,{type:"bar",data:null,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:this.props.stackId,hide:this.props.hide,barSize:this.props.barSize},V.createElement(YDe,null),V.createElement(QK,{legendPayload:POe(this.props)}),V.createElement(qO,{fn:NOe,args:this.props}),V.createElement(zOe,this.props))}}Q3(DE,"displayName","Bar");Q3(DE,"defaultProps",hY);function $7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function GS(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$7(Object(n),!0).forEach(function(r){FOe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function FOe(e,t,n){return(t=BOe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function BOe(e){var t=VOe(e,"string");return typeof t=="symbol"?t:t+""}function VOe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UOe=(e,t)=>t,$Oe=(e,t,n)=>n,qOe=(e,t,n,r)=>r,ZO=(e,t,n,r,l)=>l,HOe=(e,t,n,r,l)=>l.maxBarSize,GOe=(e,t,n,r,l,d)=>d,q7=(e,t,n)=>{var r=n??e;if(!Za(r))return Sc(r,t,0)},WOe=tn([ha,$3,UOe,$Oe,qOe],(e,t,n,r,l)=>t.filter(d=>e==="horizontal"?d.xAxisId===n:d.yAxisId===r).filter(d=>d.isPanorama===l).filter(d=>d.hide===!1).filter(d=>d.type==="bar")),ZOe=(e,t,n,r)=>{var l=ha(e);return l==="horizontal"?Tw(e,"yAxis",n,r):Tw(e,"xAxis",t,r)},XOe=(e,t,n)=>{var r=ha(e);return r==="horizontal"?H9(e,"xAxis",t):H9(e,"yAxis",n)};function KOe(e){return e.stackId!=null&&e.dataKey!=null}var YOe=(e,t,n)=>{var r={},l=e.filter(KOe),d=e.filter(T=>T.stackId==null),p=l.reduce((T,E)=>(T[E.stackId]||(T[E.stackId]=[]),T[E.stackId].push(E),T),r),a=Object.entries(p).map(T=>{var[E,P]=T,I=P.map(F=>F.dataKey),R=q7(t,n,P[0].barSize);return{stackId:E,dataKeys:I,barSize:R}}),b=d.map(T=>{var E=[T.dataKey].filter(I=>I!=null),P=q7(t,n,T.barSize);return{stackId:void 0,dataKeys:E,barSize:P}});return[...a,...b]},QOe=tn([WOe,iMe,XOe],YOe),JOe=(e,t,n,r,l)=>{var d,p,a=ha(e),b=IX(e),{maxBarSize:T}=l,E=Za(T)?b:T,P,I;return a==="horizontal"?(P=op(e,"xAxis",t,r),I=cx(e,"xAxis",t,r)):(P=op(e,"yAxis",n,r),I=cx(e,"yAxis",n,r)),(d=(p=xw(P,I,!0))!==null&&p!==void 0?p:E)!==null&&d!==void 0?d:0},fY=(e,t,n,r)=>{var l=ha(e),d,p;return l==="horizontal"?(d=op(e,"xAxis",t,r),p=cx(e,"xAxis",t,r)):(d=op(e,"yAxis",n,r),p=cx(e,"yAxis",n,r)),xw(d,p)};function eIe(e,t,n,r,l){var d=r.length;if(!(d<1)){var p=Sc(e,n,0,!0),a,b=[];if(xl(r[0].barSize)){var T=!1,E=n/d,P=r.reduce((Z,ne)=>Z+(ne.barSize||0),0);P+=(d-1)*p,P>=n&&(P-=(d-1)*p,p=0),P>=n&&E>0&&(T=!0,E*=.9,P=d*E);var I=(n-P)/2>>0,R={offset:I-p,size:0};a=r.reduce((Z,ne)=>{var ie,ge={stackId:ne.stackId,dataKeys:ne.dataKeys,position:{offset:R.offset+R.size+p,size:T?E:(ie=ne.barSize)!==null&&ie!==void 0?ie:0}},ae=[...Z,ge];return R=ae[ae.length-1].position,ae},b)}else{var F=Sc(t,n,0,!0);n-2*F-(d-1)*p<=0&&(p=0);var W=(n-2*F-(d-1)*p)/d;W>1&&(W>>=0);var $=xl(l)?Math.min(W,l):W;a=r.reduce((Z,ne,ie)=>[...Z,{stackId:ne.stackId,dataKeys:ne.dataKeys,position:{offset:F+(W+p)*ie+(W-$)/2,size:$}}],b)}return a}}var tIe=(e,t,n,r,l,d,p)=>{var a=Za(p)?t:p,b=eIe(n,r,l!==d?l:d,e,a);return l!==d&&b!=null&&(b=b.map(T=>GS(GS({},T),{},{position:GS(GS({},T.position),{},{offset:T.position.offset-l/2})}))),b},nIe=tn([QOe,IX,rMe,kX,JOe,fY,HOe],tIe),rIe=(e,t,n,r)=>op(e,"xAxis",t,r),iIe=(e,t,n,r)=>op(e,"yAxis",n,r),aIe=(e,t,n,r)=>cx(e,"xAxis",t,r),sIe=(e,t,n,r)=>cx(e,"yAxis",n,r),oIe=tn([nIe,ZO],(e,t)=>{if(e!=null){var n=e.find(r=>r.stackId===t.stackId&&r.dataKeys.includes(t.dataKey));if(n!=null)return n.position}}),lIe=(e,t)=>{if(!(!e||(t==null?void 0:t.dataKey)==null)){var{stackId:n}=t;if(n!=null){var r=e[n];if(r){var{stackedData:l}=r;if(l){var d=l.find(p=>p.key===t.dataKey);return d}}}}},cIe=tn([$3,ZO],(e,t)=>{if(e.some(n=>n.type==="bar"&&t.dataKey===n.dataKey&&t.stackId===n.stackId&&t.stackId===n.stackId))return t}),uIe=tn([ZOe,ZO],lIe),dIe=tn([Mo,rIe,iIe,aIe,sIe,oIe,ha,eO,fY,uIe,cIe,GOe],(e,t,n,r,l,d,p,a,b,T,E,P)=>{var{chartData:I,dataStartIndex:R,dataEndIndex:F}=a;if(!(E==null||d==null||p!=="horizontal"&&p!=="vertical"||t==null||n==null||r==null||l==null||b==null)){var{data:W}=E,$;if(W!=null&&W.length>0?$=W:$=I==null?void 0:I.slice(R,F+1),$!=null)return LOe({layout:p,barSettings:E,pos:d,bandSize:b,xAxis:t,yAxis:n,xAxisTicks:r,yAxisTicks:l,stackedData:T,displayedData:$,offset:e,cells:P})}}),pY=e=>{var{chartData:t}=e,n=Ns(),r=Ac();return V.useEffect(()=>r?()=>{}:(n(t7(t)),()=>{n(t7(void 0))}),[t,n,r]),null},H7={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},mY=Ia({name:"brush",initialState:H7,reducers:{setBrushSettings(e,t){return t.payload==null?H7:t.payload}}}),{setBrushSettings:Y6e}=mY.actions,hIe=mY.reducer;function fIe(e,t,n){return(t=pIe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pIe(e){var t=mIe(e,"string");return typeof t=="symbol"?t:t+""}function mIe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class XO{static create(t){return new XO(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:n,position:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(r)switch(r){case"start":return this.scale(t);case"middle":{var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+l}case"end":{var d=this.bandwidth?this.bandwidth():0;return this.scale(t)+d}default:return this.scale(t)}if(n){var p=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+p}return this.scale(t)}}isInRange(t){var n=this.range(),r=n[0],l=n[n.length-1];return r<=l?t>=r&&t<=l:t>=l&&t<=r}}fIe(XO,"EPS",1e-4);function gIe(e){return(e%180+180)%180}var xIe=function(t){var{width:n,height:r}=t,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,d=gIe(l),p=d*Math.PI/180,a=Math.atan(r/n),b=p>a&&p<Math.PI-a?r/Math.sin(p):n/Math.cos(p);return Math.abs(b)},yIe={dots:[],areas:[],lines:[]},gY=Ia({name:"referenceElements",initialState:yIe,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var n=Tm(e).dots.findIndex(r=>r===t.payload);n!==-1&&e.dots.splice(n,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var n=Tm(e).areas.findIndex(r=>r===t.payload);n!==-1&&e.areas.splice(n,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var n=Tm(e).lines.findIndex(r=>r===t.payload);n!==-1&&e.lines.splice(n,1)}}}),{addDot:Q6e,removeDot:J6e,addArea:eze,removeArea:tze,addLine:nze,removeLine:rze}=gY.actions,vIe=gY.reducer,_Ie=V.createContext(void 0),bIe=e=>{var{children:t}=e,[n]=V.useState("".concat(xy("recharts"),"-clip")),r=GO();if(r==null)return null;var{x:l,y:d,width:p,height:a}=r;return V.createElement(_Ie.Provider,{value:n},V.createElement("defs",null,V.createElement("clipPath",{id:n},V.createElement("rect",{x:l,y:d,height:a,width:p}))),t)};function rM(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function xY(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var r=[],l=0;l<e.length;l+=t)r.push(e[l]);return r}function wIe(e,t,n){var r={width:e.width+t.width,height:e.height+t.height};return xIe(r,n)}function SIe(e,t,n){var r=n==="width",{x:l,y:d,width:p,height:a}=e;return t===1?{start:r?l:d,end:r?l+p:d+a}:{start:r?l+p:d+a,end:r?l:d}}function OE(e,t,n,r,l){if(e*t<e*r||e*t>e*l)return!1;var d=n();return e*(t-e*d/2-r)>=0&&e*(t+e*d/2-l)<=0}function TIe(e,t){return xY(e,t+1)}function EIe(e,t,n,r,l){for(var d=(r||[]).slice(),{start:p,end:a}=t,b=0,T=1,E=p,P=function(){var F=r==null?void 0:r[b];if(F===void 0)return{v:xY(r,T)};var W=b,$,Z=()=>($===void 0&&($=n(F,W)),$),ne=F.coordinate,ie=b===0||OE(e,ne,Z,E,a);ie||(b=0,E=p,T+=1),ie&&(E=ne+e*(Z()/2+l),b+=T)},I;T<=d.length;)if(I=P(),I)return I.v;return[]}function G7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function $l(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?G7(Object(n),!0).forEach(function(r){AIe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function AIe(e,t,n){return(t=CIe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CIe(e){var t=jIe(e,"string");return typeof t=="symbol"?t:t+""}function jIe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MIe(e,t,n,r,l){for(var d=(r||[]).slice(),p=d.length,{start:a}=t,{end:b}=t,T=function(I){var R=d[I],F,W=()=>(F===void 0&&(F=n(R,I)),F);if(I===p-1){var $=e*(R.coordinate+e*W()/2-b);d[I]=R=$l($l({},R),{},{tickCoord:$>0?R.coordinate-$*e:R.coordinate})}else d[I]=R=$l($l({},R),{},{tickCoord:R.coordinate});var Z=OE(e,R.tickCoord,W,a,b);Z&&(b=R.tickCoord-e*(W()/2+l),d[I]=$l($l({},R),{},{isShow:!0}))},E=p-1;E>=0;E--)T(E);return d}function PIe(e,t,n,r,l,d){var p=(r||[]).slice(),a=p.length,{start:b,end:T}=t;if(d){var E=r[a-1],P=n(E,a-1),I=e*(E.coordinate+e*P/2-T);p[a-1]=E=$l($l({},E),{},{tickCoord:I>0?E.coordinate-I*e:E.coordinate});var R=OE(e,E.tickCoord,()=>P,b,T);R&&(T=E.tickCoord-e*(P/2+l),p[a-1]=$l($l({},E),{},{isShow:!0}))}for(var F=d?a-1:a,W=function(ne){var ie=p[ne],ge,ae=()=>(ge===void 0&&(ge=n(ie,ne)),ge);if(ne===0){var se=e*(ie.coordinate-e*ae()/2-b);p[ne]=ie=$l($l({},ie),{},{tickCoord:se<0?ie.coordinate-se*e:ie.coordinate})}else p[ne]=ie=$l($l({},ie),{},{tickCoord:ie.coordinate});var me=OE(e,ie.tickCoord,ae,b,T);me&&(b=ie.tickCoord+e*(ae()/2+l),p[ne]=$l($l({},ie),{},{isShow:!0}))},$=0;$<F;$++)W($);return p}function KO(e,t,n){var{tick:r,ticks:l,viewBox:d,minTickGap:p,orientation:a,interval:b,tickFormatter:T,unit:E,angle:P}=e;if(!l||!l.length||!r)return[];if(lr(b)||Py.isSsr){var I;return(I=TIe(l,lr(b)?b:0))!==null&&I!==void 0?I:[]}var R=[],F=a==="top"||a==="bottom"?"width":"height",W=E&&F==="width"?Gb(E,{fontSize:t,letterSpacing:n}):{width:0,height:0},$=(ie,ge)=>{var ae=typeof T=="function"?T(ie.value,ge):ie.value;return F==="width"?wIe(Gb(ae,{fontSize:t,letterSpacing:n}),W,P):Gb(ae,{fontSize:t,letterSpacing:n})[F]},Z=l.length>=2?Yo(l[1].coordinate-l[0].coordinate):1,ne=SIe(d,Z,F);return b==="equidistantPreserveStart"?EIe(Z,ne,$,l,p):(b==="preserveStart"||b==="preserveStartEnd"?R=PIe(Z,ne,$,l,p,b==="preserveStartEnd"):R=MIe(Z,ne,$,l,p),R.filter(ie=>ie.isShow))}var NIe=["viewBox"],DIe=["viewBox"];function e_(){return e_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e_.apply(null,arguments)}function W7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function jo(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?W7(Object(n),!0).forEach(function(r){YO(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Z7(e,t){if(e==null)return{};var n,r,l=OIe(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function OIe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function YO(e,t,n){return(t=IIe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function IIe(e){var t=kIe(e,"string");return typeof t=="symbol"?t:t+""}function kIe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class yx extends V.Component{constructor(t){super(t),this.tickRefs=V.createRef(),this.tickRefs.current=[],this.state={fontSize:"",letterSpacing:""}}shouldComponentUpdate(t,n){var{viewBox:r}=t,l=Z7(t,NIe),d=this.props,{viewBox:p}=d,a=Z7(d,DIe);return!rM(r,p)||!rM(l,a)||!rM(n,this.state)}getTickLineCoord(t){var{x:n,y:r,width:l,height:d,orientation:p,tickSize:a,mirror:b,tickMargin:T}=this.props,E,P,I,R,F,W,$=b?-1:1,Z=t.tickSize||a,ne=lr(t.tickCoord)?t.tickCoord:t.coordinate;switch(p){case"top":E=P=t.coordinate,R=r+ +!b*d,I=R-$*Z,W=I-$*T,F=ne;break;case"left":I=R=t.coordinate,P=n+ +!b*l,E=P-$*Z,F=E-$*T,W=ne;break;case"right":I=R=t.coordinate,P=n+ +b*l,E=P+$*Z,F=E+$*T,W=ne;break;default:E=P=t.coordinate,R=r+ +b*d,I=R+$*Z,W=I+$*T,F=ne;break}return{line:{x1:E,y1:I,x2:P,y2:R},tick:{x:F,y:W}}}getTickTextAnchor(){var{orientation:t,mirror:n}=this.props,r;switch(t){case"left":r=n?"start":"end";break;case"right":r=n?"end":"start";break;default:r="middle";break}return r}getTickVerticalAnchor(){var{orientation:t,mirror:n}=this.props;switch(t){case"left":case"right":return"middle";case"top":return n?"start":"end";default:return n?"end":"start"}}renderAxisLine(){var{x:t,y:n,width:r,height:l,orientation:d,mirror:p,axisLine:a}=this.props,b=jo(jo(jo({},Qi(this.props,!1)),Qi(a,!1)),{},{fill:"none"});if(d==="top"||d==="bottom"){var T=+(d==="top"&&!p||d==="bottom"&&p);b=jo(jo({},b),{},{x1:t,y1:n+T*l,x2:t+r,y2:n+T*l})}else{var E=+(d==="left"&&!p||d==="right"&&p);b=jo(jo({},b),{},{x1:t+E*r,y1:n,x2:t+E*r,y2:n+l})}return V.createElement("line",e_({},b,{className:ba("recharts-cartesian-axis-line",ox(a,"className"))}))}static renderTickItem(t,n,r){var l,d=ba(n.className,"recharts-cartesian-axis-tick-value");if(V.isValidElement(t))l=V.cloneElement(t,jo(jo({},n),{},{className:d}));else if(typeof t=="function")l=t(jo(jo({},n),{},{className:d}));else{var p="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(p=ba(p,t.className)),l=V.createElement(K3,e_({},n,{className:p}),r)}return l}renderTicks(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],{tickLine:l,stroke:d,tick:p,tickFormatter:a,unit:b}=this.props,T=KO(jo(jo({},this.props),{},{ticks:r}),t,n),E=this.getTickTextAnchor(),P=this.getTickVerticalAnchor(),I=Qi(this.props,!1),R=Qi(p,!1),F=jo(jo({},I),{},{fill:"none"},Qi(l,!1)),W=T.map(($,Z)=>{var{line:ne,tick:ie}=this.getTickLineCoord($),ge=jo(jo(jo(jo({textAnchor:E,verticalAnchor:P},I),{},{stroke:"none",fill:d},R),ie),{},{index:Z,payload:$,visibleTicksCount:T.length,tickFormatter:a});return V.createElement(Hs,e_({className:"recharts-cartesian-axis-tick",key:"tick-".concat($.value,"-").concat($.coordinate,"-").concat($.tickCoord)},E3(this.props,$,Z)),l&&V.createElement("line",e_({},F,ne,{className:ba("recharts-cartesian-axis-tick-line",ox(l,"className"))})),p&&yx.renderTickItem(p,ge,"".concat(typeof a=="function"?a($.value,Z):$.value).concat(b||"")))});return W.length>0?V.createElement("g",{className:"recharts-cartesian-axis-ticks"},W):null}render(){var{axisLine:t,width:n,height:r,className:l,hide:d}=this.props;if(d)return null;var{ticks:p}=this.props;return n!=null&&n<=0||r!=null&&r<=0?null:V.createElement(Hs,{className:ba("recharts-cartesian-axis",l),ref:a=>{if(a){var b=a.getElementsByClassName("recharts-cartesian-axis-tick-value");this.tickRefs.current=Array.from(b);var T=b[0];if(T){var E=window.getComputedStyle(T).fontSize,P=window.getComputedStyle(T).letterSpacing;(E!==this.state.fontSize||P!==this.state.letterSpacing)&&this.setState({fontSize:window.getComputedStyle(T).fontSize,letterSpacing:window.getComputedStyle(T).letterSpacing})}}}},t&&this.renderAxisLine(),this.renderTicks(this.state.fontSize,this.state.letterSpacing,p),Ou.renderCallByParent(this.props))}}YO(yx,"displayName","CartesianAxis");YO(yx,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var RIe=["x1","y1","x2","y2","key"],zIe=["offset"],LIe=["xAxisId","yAxisId"],FIe=["xAxisId","yAxisId"];function X7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function Hl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?X7(Object(n),!0).forEach(function(r){BIe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function BIe(e,t,n){return(t=VIe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VIe(e){var t=UIe(e,"string");return typeof t=="symbol"?t:t+""}function UIe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function X0(){return X0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},X0.apply(null,arguments)}function IE(e,t){if(e==null)return{};var n,r,l=$Ie(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function $Ie(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var qIe=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:n,x:r,y:l,width:d,height:p,ry:a}=e;return V.createElement("rect",{x:r,y:l,ry:a,width:d,height:p,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function yY(e,t){var n;if(V.isValidElement(e))n=V.cloneElement(e,t);else if(typeof e=="function")n=e(t);else{var{x1:r,y1:l,x2:d,y2:p,key:a}=t,b=IE(t,RIe),T=Qi(b,!1),{offset:E}=T,P=IE(T,zIe);n=V.createElement("line",X0({},P,{x1:r,y1:l,x2:d,y2:p,fill:"none",key:a}))}return n}function HIe(e){var{x:t,width:n,horizontal:r=!0,horizontalPoints:l}=e;if(!r||!l||!l.length)return null;var{xAxisId:d,yAxisId:p}=e,a=IE(e,LIe),b=l.map((T,E)=>{var P=Hl(Hl({},a),{},{x1:t,y1:T,x2:t+n,y2:T,key:"line-".concat(E),index:E});return yY(r,P)});return V.createElement("g",{className:"recharts-cartesian-grid-horizontal"},b)}function GIe(e){var{y:t,height:n,vertical:r=!0,verticalPoints:l}=e;if(!r||!l||!l.length)return null;var{xAxisId:d,yAxisId:p}=e,a=IE(e,FIe),b=l.map((T,E)=>{var P=Hl(Hl({},a),{},{x1:T,y1:t,x2:T,y2:t+n,key:"line-".concat(E),index:E});return yY(r,P)});return V.createElement("g",{className:"recharts-cartesian-grid-vertical"},b)}function WIe(e){var{horizontalFill:t,fillOpacity:n,x:r,y:l,width:d,height:p,horizontalPoints:a,horizontal:b=!0}=e;if(!b||!t||!t.length)return null;var T=a.map(P=>Math.round(P+l-l)).sort((P,I)=>P-I);l!==T[0]&&T.unshift(0);var E=T.map((P,I)=>{var R=!T[I+1],F=R?l+p-P:T[I+1]-P;if(F<=0)return null;var W=I%t.length;return V.createElement("rect",{key:"react-".concat(I),y:P,x:r,height:F,width:d,stroke:"none",fill:t[W],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return V.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},E)}function ZIe(e){var{vertical:t=!0,verticalFill:n,fillOpacity:r,x:l,y:d,width:p,height:a,verticalPoints:b}=e;if(!t||!n||!n.length)return null;var T=b.map(P=>Math.round(P+l-l)).sort((P,I)=>P-I);l!==T[0]&&T.unshift(0);var E=T.map((P,I)=>{var R=!T[I+1],F=R?l+p-P:T[I+1]-P;if(F<=0)return null;var W=I%n.length;return V.createElement("rect",{key:"react-".concat(I),x:P,y:d,width:F,height:a,stroke:"none",fill:n[W],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return V.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},E)}var XIe=(e,t)=>{var{xAxis:n,width:r,height:l,offset:d}=e;return vZ(KO(Hl(Hl(Hl({},yx.defaultProps),n),{},{ticks:_Z(n),viewBox:{x:0,y:0,width:r,height:l}})),d.left,d.left+d.width,t)},KIe=(e,t)=>{var{yAxis:n,width:r,height:l,offset:d}=e;return vZ(KO(Hl(Hl(Hl({},yx.defaultProps),n),{},{ticks:_Z(n),viewBox:{x:0,y:0,width:r,height:l}})),d.top,d.top+d.height,t)},YIe={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function wT(e){var t=AZ(),n=CZ(),r=EZ(),l=Hl(Hl({},$d(e,YIe)),{},{x:lr(e.x)?e.x:r.left,y:lr(e.y)?e.y:r.top,width:lr(e.width)?e.width:r.width,height:lr(e.height)?e.height:r.height}),{xAxisId:d,yAxisId:p,x:a,y:b,width:T,height:E,syncWithTicks:P,horizontalValues:I,verticalValues:R}=l,F=Ac(),W=Or(qe=>G9(qe,"xAxis",d,F)),$=Or(qe=>G9(qe,"yAxis",p,F));if(!lr(T)||T<=0||!lr(E)||E<=0||!lr(a)||a!==+a||!lr(b)||b!==+b)return null;var Z=l.verticalCoordinatesGenerator||XIe,ne=l.horizontalCoordinatesGenerator||KIe,{horizontalPoints:ie,verticalPoints:ge}=l;if((!ie||!ie.length)&&typeof ne=="function"){var ae=I&&I.length,se=ne({yAxis:$?Hl(Hl({},$),{},{ticks:ae?I:$.ticks}):void 0,width:t,height:n,offset:r},ae?!0:P);Hb(Array.isArray(se),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof se,"]")),Array.isArray(se)&&(ie=se)}if((!ge||!ge.length)&&typeof Z=="function"){var me=R&&R.length,ke=Z({xAxis:W?Hl(Hl({},W),{},{ticks:me?R:W.ticks}):void 0,width:t,height:n,offset:r},me?!0:P);Hb(Array.isArray(ke),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof ke,"]")),Array.isArray(ke)&&(ge=ke)}return V.createElement("g",{className:"recharts-cartesian-grid"},V.createElement(qIe,{fill:l.fill,fillOpacity:l.fillOpacity,x:l.x,y:l.y,width:l.width,height:l.height,ry:l.ry}),V.createElement(WIe,X0({},l,{horizontalPoints:ie})),V.createElement(ZIe,X0({},l,{verticalPoints:ge})),V.createElement(HIe,X0({},l,{offset:r,horizontalPoints:ie,xAxis:W,yAxis:$})),V.createElement(GIe,X0({},l,{offset:r,verticalPoints:ge,xAxis:W,yAxis:$})))}wT.displayName="CartesianGrid";var vY=(e,t,n,r)=>op(e,"xAxis",t,r),_Y=(e,t,n,r)=>cx(e,"xAxis",t,r),bY=(e,t,n,r)=>op(e,"yAxis",n,r),wY=(e,t,n,r)=>cx(e,"yAxis",n,r),QIe=tn([ha,vY,bY,_Y,wY],(e,t,n,r,l)=>Fm(e,"xAxis")?xw(t,r,!1):xw(n,l,!1)),JIe=(e,t,n,r,l)=>{var d,p=ha(e),a=Fm(p,"xAxis"),b;if(a?b=Tw(e,"yAxis",n,r):b=Tw(e,"xAxis",t,r),b!=null){var{dataKey:T,stackId:E}=l;if(E!=null){var P=(d=b[E])===null||d===void 0?void 0:d.stackedData;return P==null?void 0:P.find(I=>I.key===T)}}},eke=(e,t,n,r,l)=>l,tke=tn([$3,eke],(e,t)=>{if(e.some(n=>n.type==="area"&&t.dataKey===n.dataKey&&ED(t.stackId)===n.stackId&&t.data===n.data))return t}),nke=tn([ha,vY,bY,_Y,wY,JIe,eO,QIe,tke],(e,t,n,r,l,d,p,a,b)=>{var{chartData:T,dataStartIndex:E,dataEndIndex:P}=p;if(!(b==null||e!=="horizontal"&&e!=="vertical"||t==null||n==null||r==null||l==null||r.length===0||l.length===0||a==null)){var{data:I}=b,R;if(I&&I.length>0?R=I:R=T==null?void 0:T.slice(E,P+1),R!=null){var F=void 0;return bke({layout:e,xAxis:t,yAxis:n,xAxisTicks:r,yAxisTicks:l,dataStartIndex:E,areaSettings:b,stackedData:d,displayedData:R,chartBaseValue:F,bandSize:a})}}}),rke=["layout","type","stroke","connectNulls","isRange"],ike=["activeDot","animationBegin","animationDuration","animationEasing","connectNulls","dot","fill","fillOpacity","hide","isAnimationActive","legendType","stroke","xAxisId","yAxisId"];function SY(e,t){if(e==null)return{};var n,r,l=ake(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function ake(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function K7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function K0(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?K7(Object(n),!0).forEach(function(r){J3(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function J3(e,t,n){return(t=ske(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ske(e){var t=oke(e,"string");return typeof t=="symbol"?t:t+""}function oke(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jg(){return Jg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Jg.apply(null,arguments)}function kE(e,t){return e&&e!=="none"?e:t}var lke=e=>{var{dataKey:t,name:n,stroke:r,fill:l,legendType:d,hide:p}=e;return[{inactive:p,dataKey:t,type:d,color:kE(r,l),value:N_(n,t),payload:e}]};function cke(e){var{dataKey:t,data:n,stroke:r,strokeWidth:l,fill:d,name:p,hide:a,unit:b}=e;return{dataDefinedOnItem:n,positions:void 0,settings:{stroke:r,strokeWidth:l,fill:d,dataKey:t,nameKey:void 0,name:N_(p,t),hide:a,type:e.tooltipType,color:kE(r,d),unit:b}}}var uke=(e,t)=>{var n;if(V.isValidElement(e))n=V.cloneElement(e,t);else if(typeof e=="function")n=e(t);else{var r=ba("recharts-area-dot",typeof e!="boolean"?e.className:"");n=V.createElement(qK,Jg({},t,{className:r}))}return n};function dke(e,t){return e==null?!1:t?!0:e.length===1}function hke(e){var{clipPathId:t,points:n,props:r}=e,{needClip:l,dot:d,dataKey:p}=r;if(!dke(n,d))return null;var a=UW(d),b=Qi(r,!1),T=Qi(d,!0),E=n.map((I,R)=>{var F=K0(K0(K0({key:"dot-".concat(R),r:3},b),T),{},{index:R,cx:I.x,cy:I.y,dataKey:p,value:I.value,payload:I.payload,points:n});return uke(d,F)}),P={clipPath:l?"url(#clipPath-".concat(a?"":"dots-").concat(t,")"):void 0};return V.createElement(Hs,Jg({className:"recharts-area-dots"},P),E)}function oP(e){var{points:t,baseLine:n,needClip:r,clipPathId:l,props:d,showLabels:p}=e,{layout:a,type:b,stroke:T,connectNulls:E,isRange:P}=d,I=SY(d,rke);return V.createElement(V.Fragment,null,(t==null?void 0:t.length)>1&&V.createElement(Hs,{clipPath:r?"url(#clipPath-".concat(l,")"):void 0},V.createElement(qb,Jg({},Qi(I,!0),{points:t,connectNulls:E,type:b,baseLine:n,layout:a,stroke:"none",className:"recharts-area-area"})),T!=="none"&&V.createElement(qb,Jg({},Qi(d,!1),{className:"recharts-area-curve",layout:a,type:b,connectNulls:E,fill:"none",points:t})),T!=="none"&&P&&V.createElement(qb,Jg({},Qi(d,!1),{className:"recharts-area-curve",layout:a,type:b,connectNulls:E,fill:"none",points:n}))),V.createElement(hke,{points:t,props:d,clipPathId:l}),p&&Qg.renderCallByParent(d,t))}function fke(e){var{alpha:t,baseLine:n,points:r,strokeWidth:l}=e,d=r[0].y,p=r[r.length-1].y;if(!xl(d)||!xl(p))return null;var a=t*Math.abs(d-p),b=Math.max(...r.map(T=>T.x||0));return lr(n)?b=Math.max(n,b):n&&Array.isArray(n)&&n.length&&(b=Math.max(...n.map(T=>T.x||0),b)),lr(b)?V.createElement("rect",{x:0,y:d<p?d:d-a,width:b+(l?parseInt("".concat(l),10):1),height:Math.floor(a)}):null}function pke(e){var{alpha:t,baseLine:n,points:r,strokeWidth:l}=e,d=r[0].x,p=r[r.length-1].x;if(!xl(d)||!xl(p))return null;var a=t*Math.abs(d-p),b=Math.max(...r.map(T=>T.y||0));return lr(n)?b=Math.max(n,b):n&&Array.isArray(n)&&n.length&&(b=Math.max(...n.map(T=>T.y||0),b)),lr(b)?V.createElement("rect",{x:d<p?d:d-a,y:0,width:a,height:Math.floor(b+(l?parseInt("".concat(l),10):1))}):null}function mke(e){var{alpha:t,layout:n,points:r,baseLine:l,strokeWidth:d}=e;return n==="vertical"?V.createElement(fke,{alpha:t,points:r,baseLine:l,strokeWidth:d}):V.createElement(pke,{alpha:t,points:r,baseLine:l,strokeWidth:d})}function gke(e){var{needClip:t,clipPathId:n,props:r,previousPointsRef:l,previousBaselineRef:d}=e,{points:p,baseLine:a,isAnimationActive:b,animationBegin:T,animationDuration:E,animationEasing:P,onAnimationStart:I,onAnimationEnd:R}=r,F=HO(r,"recharts-area-"),[W,$]=V.useState(!0),Z=V.useCallback(()=>{typeof R=="function"&&R(),$(!1)},[R]),ne=V.useCallback(()=>{typeof I=="function"&&I(),$(!0)},[I]),ie=l.current,ge=d.current;return V.createElement(lx,{begin:T,duration:E,isActive:b,easing:P,from:{t:0},to:{t:1},onAnimationEnd:Z,onAnimationStart:ne,key:F},ae=>{var{t:se}=ae;if(ie){var me=ie.length/p.length,ke=se===1?p:p.map((tt,nt)=>{var bt=Math.floor(nt*me);if(ie[bt]){var jt=ie[bt];return K0(K0({},tt),{},{x:$v(jt.x,tt.x,se),y:$v(jt.y,tt.y,se)})}return tt}),qe;return lr(a)?qe=$v(ge,a,se):Za(a)||Xc(a)?qe=$v(ge,0,se):qe=a.map((tt,nt)=>{var bt=Math.floor(nt*me);if(Array.isArray(ge)&&ge[bt]){var jt=ge[bt];return K0(K0({},tt),{},{x:$v(jt.x,tt.x,se),y:$v(jt.y,tt.y,se)})}return tt}),se>0&&(l.current=ke,d.current=qe),V.createElement(oP,{points:ke,baseLine:qe,needClip:t,clipPathId:n,props:r,showLabels:!W})}return se>0&&(l.current=p,d.current=a),V.createElement(Hs,null,V.createElement("defs",null,V.createElement("clipPath",{id:"animationClipPath-".concat(n)},V.createElement(mke,{alpha:se,points:p,baseLine:a,layout:r.layout,strokeWidth:r.strokeWidth}))),V.createElement(Hs,{clipPath:"url(#animationClipPath-".concat(n,")")},V.createElement(oP,{points:p,baseLine:a,needClip:t,clipPathId:n,props:r,showLabels:!0})))})}function xke(e){var{needClip:t,clipPathId:n,props:r}=e,{points:l,baseLine:d,isAnimationActive:p}=r,a=V.useRef(null),b=V.useRef(),T=a.current,E=b.current;return p&&l&&l.length&&(T!==l||E!==d)?V.createElement(gke,{needClip:t,clipPathId:n,props:r,previousPointsRef:a,previousBaselineRef:b}):V.createElement(oP,{points:l,baseLine:d,needClip:t,clipPathId:n,props:r,showLabels:!0})}class yke extends V.PureComponent{constructor(){super(...arguments),J3(this,"id",xy("recharts-area-"))}render(){var t,{hide:n,dot:r,points:l,className:d,top:p,left:a,needClip:b,xAxisId:T,yAxisId:E,width:P,height:I,id:R,baseLine:F}=this.props;if(n)return null;var W=ba("recharts-area",d),$=Za(R)?this.id:R,{r:Z=3,strokeWidth:ne=2}=(t=Qi(r,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},ie=UW(r),ge=Z*2+ne;return V.createElement(V.Fragment,null,V.createElement(Hs,{className:W},b&&V.createElement("defs",null,V.createElement(cY,{clipPathId:$,xAxisId:T,yAxisId:E}),!ie&&V.createElement("clipPath",{id:"clipPath-dots-".concat($)},V.createElement("rect",{x:a-ge/2,y:p-ge/2,width:P+ge,height:I+ge}))),V.createElement(xke,{needClip:b,clipPathId:$,props:this.props})),V.createElement(F7,{points:l,mainColor:kE(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}),this.props.isRange&&Array.isArray(F)&&V.createElement(F7,{points:F,mainColor:kE(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}))}}var TY={activeDot:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!1,fill:"#3182bd",fillOpacity:.6,hide:!1,isAnimationActive:!Py.isSsr,legendType:"line",stroke:"#3182bd",xAxisId:0,yAxisId:0};function vke(e){var t,n=$d(e,TY),{activeDot:r,animationBegin:l,animationDuration:d,animationEasing:p,connectNulls:a,dot:b,fill:T,fillOpacity:E,hide:P,isAnimationActive:I,legendType:R,stroke:F,xAxisId:W,yAxisId:$}=n,Z=SY(n,ike),ne=O3(),ie=PK(),{needClip:ge}=WO(W,$),ae=Ac(),se=V.useMemo(()=>({baseValue:e.baseValue,stackId:e.stackId,connectNulls:a,data:e.data,dataKey:e.dataKey}),[e.baseValue,e.stackId,a,e.data,e.dataKey]),{points:me,isRange:ke,baseLine:qe}=(t=Or(Nt=>nke(Nt,W,$,ae,se)))!==null&&t!==void 0?t:{},{height:tt,width:nt,x:bt,y:jt}=GO();return ne!=="horizontal"&&ne!=="vertical"||ie!=="AreaChart"&&ie!=="ComposedChart"?null:V.createElement(yke,Jg({},Z,{activeDot:r,animationBegin:l,animationDuration:d,animationEasing:p,baseLine:qe,connectNulls:a,dot:b,fill:T,fillOpacity:E,height:tt,hide:P,layout:ne,isAnimationActive:I,isRange:ke,legendType:R,needClip:ge,points:me,stroke:F,width:nt,left:bt,top:jt,xAxisId:W,yAxisId:$}))}var _ke=(e,t,n,r,l)=>{var d=n??t;if(lr(d))return d;var p=e==="horizontal"?l:r,a=p.scale.domain();if(p.type==="number"){var b=Math.max(a[0],a[1]),T=Math.min(a[0],a[1]);return d==="dataMin"?T:d==="dataMax"||b<0?b:Math.max(Math.min(a[0],a[1]),0)}return d==="dataMin"?a[0]:d==="dataMax"?a[1]:a[0]};function bke(e){var{areaSettings:{connectNulls:t,baseValue:n,dataKey:r},stackedData:l,layout:d,chartBaseValue:p,xAxis:a,yAxis:b,displayedData:T,dataStartIndex:E,xAxisTicks:P,yAxisTicks:I,bandSize:R}=e,F=l&&l.length,W=_ke(d,p,n,a,b),$=d==="horizontal",Z=!1,ne=T.map((ge,ae)=>{var se;F?se=l[E+ae]:(se=ns(ge,r),Array.isArray(se)?Z=!0:se=[W,se]);var me=se[1]==null||F&&!t&&ns(ge,r)==null;return $?{x:CB({axis:a,ticks:P,bandSize:R,entry:ge,index:ae}),y:me?null:b.scale(se[1]),value:se,payload:ge}:{x:me?null:a.scale(se[1]),y:CB({axis:b,ticks:I,bandSize:R,entry:ge,index:ae}),value:se,payload:ge}}),ie;return F||Z?ie=ne.map(ge=>{var ae=Array.isArray(ge.value)?ge.value[0]:null;return $?{x:ge.x,y:ae!=null&&ge.y!=null?b.scale(ae):null}:{x:ae!=null?a.scale(ae):null,y:ge.y}}):ie=$?b.scale(W):a.scale(W),{points:ne,baseLine:ie,isRange:Z}}class QO extends V.PureComponent{render(){return V.createElement(rY,{type:"area",data:this.props.data,dataKey:this.props.dataKey,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,stackId:this.props.stackId,hide:this.props.hide,barSize:void 0},V.createElement(QK,{legendPayload:lke(this.props)}),V.createElement(qO,{fn:cke,args:this.props}),V.createElement(vke,this.props))}}J3(QO,"displayName","Area");J3(QO,"defaultProps",TY);function Y7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function Q7(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Y7(Object(n),!0).forEach(function(r){wke(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y7(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function wke(e,t,n){return(t=Ske(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ske(e){var t=Tke(e,"string");return typeof t=="symbol"?t:t+""}function Tke(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Eke={xAxis:{},yAxis:{},zAxis:{}},EY=Ia({name:"cartesianAxis",initialState:Eke,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:n,width:r}=t.payload;e.yAxis[n]&&(e.yAxis[n]=Q7(Q7({},e.yAxis[n]),{},{width:r}))}}}),{addXAxis:Ake,removeXAxis:Cke,addYAxis:jke,removeYAxis:Mke,addZAxis:ize,removeZAxis:aze,updateYAxisWidth:Pke}=EY.actions,Nke=EY.reducer,Dke=["children"],Oke=["dangerouslySetInnerHTML","ticks"];function AY(e,t,n){return(t=Ike(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ike(e){var t=kke(e,"string");return typeof t=="symbol"?t:t+""}function kke(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lP(){return lP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lP.apply(null,arguments)}function CY(e,t){if(e==null)return{};var n,r,l=Rke(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function Rke(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function zke(e){var t=Ns(),n=V.useMemo(()=>{var{children:d}=e,p=CY(e,Dke);return p},[e]),r=Or(d=>$m(d,n.id)),l=n===r;return V.useEffect(()=>(t(Ake(n)),()=>{t(Cke(n))}),[n,t]),l?e.children:null}var Lke=e=>{var{xAxisId:t,className:n}=e,r=Or(TZ),l=Ac(),d="xAxis",p=Or(R=>z_(R,d,t,l)),a=Or(R=>cK(R,d,t,l)),b=Or(R=>aK(R,t)),T=Or(R=>KMe(R,t));if(b==null||T==null)return null;var{dangerouslySetInnerHTML:E,ticks:P}=e,I=CY(e,Oke);return V.createElement(yx,lP({},I,{scale:p,x:T.x,y:T.y,width:b.width,height:b.height,className:ba("recharts-".concat(d," ").concat(d),n),viewBox:r,ticks:a}))},Fke=e=>{var t,n,r,l,d;return V.createElement(zke,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.xAxisId,scale:e.scale,type:e.type,padding:e.padding,allowDataOverflow:e.allowDataOverflow,domain:e.domain,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,includeHidden:(n=e.includeHidden)!==null&&n!==void 0?n:!1,reversed:e.reversed,ticks:e.ticks,height:e.height,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(r=e.angle)!==null&&r!==void 0?r:0,minTickGap:(l=e.minTickGap)!==null&&l!==void 0?l:5,tick:(d=e.tick)!==null&&d!==void 0?d:!0,tickFormatter:e.tickFormatter},V.createElement(Lke,e))};class Wb extends V.Component{render(){return V.createElement(Fke,this.props)}}AY(Wb,"displayName","XAxis");AY(Wb,"defaultProps",{allowDataOverflow:ju.allowDataOverflow,allowDecimals:ju.allowDecimals,allowDuplicatedCategory:ju.allowDuplicatedCategory,height:ju.height,hide:!1,mirror:ju.mirror,orientation:ju.orientation,padding:ju.padding,reversed:ju.reversed,scale:ju.scale,tickCount:ju.tickCount,type:ju.type,xAxisId:0});var Bke=e=>{var{ticks:t,label:n,labelGapWithTick:r=5,tickSize:l=0,tickMargin:d=0}=e,p=0;if(t){t.forEach(E=>{if(E){var P=E.getBoundingClientRect();P.width>p&&(p=P.width)}});var a=n?n.getBoundingClientRect().width:0,b=l+d,T=p+b+a+(n?r:0);return Math.round(T)}return 0},Vke=["dangerouslySetInnerHTML","ticks"];function jY(e,t,n){return(t=Uke(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Uke(e){var t=$ke(e,"string");return typeof t=="symbol"?t:t+""}function $ke(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cP(){return cP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cP.apply(null,arguments)}function qke(e,t){if(e==null)return{};var n,r,l=Hke(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function Hke(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function Gke(e){var t=Ns();return V.useEffect(()=>(t(jke(e)),()=>{t(Mke(e))}),[e,t]),null}var Wke=e=>{var t,{yAxisId:n,className:r,width:l,label:d}=e,p=V.useRef(null),a=V.useRef(null),b=Or(TZ),T=Ac(),E=Ns(),P="yAxis",I=Or(ie=>z_(ie,P,n,T)),R=Or(ie=>sK(ie,n)),F=Or(ie=>YMe(ie,n)),W=Or(ie=>cK(ie,P,n,T));if(V.useLayoutEffect(()=>{var ie;if(!(l!=="auto"||!R||RO(d)||V.isValidElement(d))){var ge=p.current,ae=ge==null||(ie=ge.tickRefs)===null||ie===void 0?void 0:ie.current,{tickSize:se,tickMargin:me}=ge.props,ke=Bke({ticks:ae,label:a.current,labelGapWithTick:5,tickSize:se,tickMargin:me});Math.round(R.width)!==Math.round(ke)&&E(Pke({id:n,width:ke}))}},[p,p==null||(t=p.current)===null||t===void 0||(t=t.tickRefs)===null||t===void 0?void 0:t.current,R==null?void 0:R.width,R,E,d,n,l]),R==null||F==null)return null;var{dangerouslySetInnerHTML:$,ticks:Z}=e,ne=qke(e,Vke);return V.createElement(yx,cP({},ne,{ref:p,labelRef:a,scale:I,x:F.x,y:F.y,width:R.width,height:R.height,className:ba("recharts-".concat(P," ").concat(P),r),viewBox:b,ticks:W}))},Zke=e=>{var t,n,r,l,d;return V.createElement(V.Fragment,null,V.createElement(Gke,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:(n=e.includeHidden)!==null&&n!==void 0?n:!1,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(r=e.angle)!==null&&r!==void 0?r:0,minTickGap:(l=e.minTickGap)!==null&&l!==void 0?l:5,tick:(d=e.tick)!==null&&d!==void 0?d:!0,tickFormatter:e.tickFormatter}),V.createElement(Wke,e))},Xke={allowDataOverflow:Mu.allowDataOverflow,allowDecimals:Mu.allowDecimals,allowDuplicatedCategory:Mu.allowDuplicatedCategory,hide:!1,mirror:Mu.mirror,orientation:Mu.orientation,padding:Mu.padding,reversed:Mu.reversed,scale:Mu.scale,tickCount:Mu.tickCount,type:Mu.type,width:Mu.width,yAxisId:0};class Zb extends V.Component{render(){return V.createElement(Zke,this.props)}}jY(Zb,"displayName","YAxis");jY(Zb,"defaultProps",Xke);var Kke=(e,t)=>t,JO=tn([Kke,ha,uMe,Jo,TK,qm,J5e,Mo],iPe),eI=e=>{var t=e.currentTarget.getBoundingClientRect(),n=t.width/e.currentTarget.offsetWidth,r=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/n),chartY:Math.round((e.clientY-t.top)/r)}},MY=Xl("mouseClick"),PY=jw();PY.startListening({actionCreator:MY,effect:(e,t)=>{var n=e.payload,r=JO(t.getState(),eI(n));(r==null?void 0:r.activeIndex)!=null&&t.dispatch(u5e({activeIndex:r.activeIndex,activeDataKey:void 0,activeCoordinate:r.activeCoordinate}))}});var uP=Xl("mouseMove"),NY=jw();NY.startListening({actionCreator:uP,effect:(e,t)=>{var n=e.payload,r=t.getState(),l=AO(r,r.tooltip.settings.shared),d=JO(r,eI(n));l==="axis"&&((d==null?void 0:d.activeIndex)!=null?t.dispatch(xK({activeIndex:d.activeIndex,activeDataKey:void 0,activeCoordinate:d.activeCoordinate})):t.dispatch(gK()))}});function Yke(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":t}var J7={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},DY=Ia({name:"rootProps",initialState:J7,reducers:{updateOptions:(e,t)=>{var n;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(n=t.payload.barGap)!==null&&n!==void 0?n:J7.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),Qke=DY.reducer,{updateOptions:Jke}=DY.actions,OY=Ia({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:eRe}=OY.actions,tRe=OY.reducer,IY=Xl("keyDown"),kY=Xl("focus"),tI=jw();tI.startListening({actionCreator:IY,effect:(e,t)=>{var n=t.getState(),r=n.rootProps.accessibilityLayer!==!1;if(r){var{keyboardInteraction:l}=n.tooltip,d=e.payload;if(!(d!=="ArrowRight"&&d!=="ArrowLeft"&&d!=="Enter")){var p=Number(CO(l,ky(n))),a=qm(n);if(d==="Enter"){var b=CE(n,"axis","hover",String(l.index));t.dispatch(J5({active:!l.active,activeIndex:l.index,activeDataKey:l.dataKey,activeCoordinate:b}));return}var T=t5e(n),E=T==="left-to-right"?1:-1,P=d==="ArrowRight"?1:-1,I=p+P*E;if(!(a==null||I>=a.length||I<0)){var R=CE(n,"axis","hover",String(I));t.dispatch(J5({active:!0,activeIndex:I.toString(),activeDataKey:void 0,activeCoordinate:R}))}}}}});tI.startListening({actionCreator:kY,effect:(e,t)=>{var n=t.getState(),r=n.rootProps.accessibilityLayer!==!1;if(r){var{keyboardInteraction:l}=n.tooltip;if(!l.active&&l.index==null){var d="0",p=CE(n,"axis","hover",String(d));t.dispatch(J5({activeDataKey:void 0,active:!0,activeIndex:d,activeCoordinate:p}))}}}});var Md=Xl("externalEvent"),RY=jw();RY.startListening({actionCreator:Md,effect:(e,t)=>{if(e.payload.handler!=null){var n=t.getState(),r={activeCoordinate:q5e(n),activeDataKey:jK(n),activeIndex:ux(n),activeLabel:CK(n),activeTooltipIndex:ux(n),isTooltipActive:H5e(n)};e.payload.handler(r,e.payload.reactEvent)}}});var nRe=tn([L_],e=>e.tooltipItemPayloads),rRe=tn([nRe,r2,(e,t,n)=>t,(e,t,n)=>n],(e,t,n,r)=>{var l=e.find(a=>a.settings.dataKey===r);if(l!=null){var{positions:d}=l;if(d!=null){var p=t(d,n);return p}}}),zY=Xl("touchMove"),LY=jw();LY.startListening({actionCreator:zY,effect:(e,t)=>{var n=e.payload,r=t.getState(),l=AO(r,r.tooltip.settings.shared);if(l==="axis"){var d=JO(r,eI({clientX:n.touches[0].clientX,clientY:n.touches[0].clientY,currentTarget:n.currentTarget}));(d==null?void 0:d.activeIndex)!=null&&t.dispatch(xK({activeIndex:d.activeIndex,activeDataKey:void 0,activeCoordinate:d.activeCoordinate}))}else if(l==="item"){var p,a=n.touches[0],b=document.elementFromPoint(a.clientX,a.clientY);if(!b||!b.getAttribute)return;var T=b.getAttribute(wZ),E=(p=b.getAttribute(SZ))!==null&&p!==void 0?p:void 0,P=rRe(t.getState(),T,E);t.dispatch(mK({activeDataKey:E,activeIndex:T,activeCoordinate:P}))}}});var iRe=fV({brush:hIe,cartesianAxis:Nke,chartData:_Pe,graphicalItems:tDe,layout:f3e,legend:K3e,options:mPe,polarAxis:FNe,polarOptions:tRe,referenceElements:vIe,rootProps:Qke,tooltip:d5e}),aRe=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return EV({reducer:iRe,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([PY.middleware,NY.middleware,tI.middleware,RY.middleware,LY.middleware]),devTools:{serialize:{replacer:Yke},name:"recharts-".concat(n)}})};function FY(e){var{preloadedState:t,children:n,reduxStoreName:r}=e,l=Ac(),d=V.useRef(null);if(l)return n;d.current==null&&(d.current=aRe(t,r));var p=TD;return V.createElement(cV,{context:p,store:d.current},n)}function BY(e){var{layout:t,width:n,height:r,margin:l}=e,d=Ns(),p=Ac();return V.useEffect(()=>{p||(d(u3e(t)),d(d3e({width:n,height:r})),d(c3e(l)))},[d,p,t,n,r,l]),null}function VY(e){var t=Ns();return V.useEffect(()=>{t(Jke(e))},[t,e]),null}var sRe=["children"];function oRe(e,t){if(e==null)return{};var n,r,l=lRe(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function lRe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function RE(){return RE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},RE.apply(null,arguments)}var cRe={width:"100%",height:"100%"},uRe=V.forwardRef((e,t)=>{var n=AZ(),r=CZ(),l=NZ();if(!g_(n)||!g_(r))return null;var{children:d,otherAttributes:p,title:a,desc:b}=e,T,E;return typeof p.tabIndex=="number"?T=p.tabIndex:T=l?0:void 0,typeof p.role=="string"?E=p.role:E=l?"application":void 0,V.createElement($W,RE({},p,{title:a,desc:b,role:E,tabIndex:T,width:n,height:r,style:cRe,ref:t}),d)}),dRe=e=>{var{children:t}=e,n=Or(D3);if(!n)return null;var{width:r,height:l,y:d,x:p}=n;return V.createElement($W,{width:r,height:l,x:p,y:d},t)},eV=V.forwardRef((e,t)=>{var{children:n}=e,r=oRe(e,sRe),l=Ac();return l?V.createElement(dRe,null,n):V.createElement(uRe,RE({ref:t},r),n)});function hRe(){var e=Ns(),[t,n]=V.useState(null),r=Or(V3e);return V.useEffect(()=>{if(t!=null){var l=t.getBoundingClientRect(),d=l.width/t.offsetWidth;xl(d)&&d!==r&&e(h3e(d))}},[t,e,r]),n}function tV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function fRe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?tV(Object(n),!0).forEach(function(r){pRe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tV(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function pRe(e,t,n){return(t=mRe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mRe(e){var t=gRe(e,"string");return typeof t=="symbol"?t:t+""}function gRe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xRe=V.forwardRef((e,t)=>{var{children:n,className:r,height:l,onClick:d,onContextMenu:p,onDoubleClick:a,onMouseDown:b,onMouseEnter:T,onMouseLeave:E,onMouseMove:P,onMouseUp:I,onTouchEnd:R,onTouchMove:F,onTouchStart:W,style:$,width:Z}=e,ne=Ns(),[ie,ge]=V.useState(null),[ae,se]=V.useState(null);SPe();var me=hRe(),ke=V.useCallback(mt=>{me(mt),typeof t=="function"&&t(mt),ge(mt),se(mt)},[me,t,ge,se]),qe=V.useCallback(mt=>{ne(MY(mt)),ne(Md({handler:d,reactEvent:mt}))},[ne,d]),tt=V.useCallback(mt=>{ne(uP(mt)),ne(Md({handler:T,reactEvent:mt}))},[ne,T]),nt=V.useCallback(mt=>{ne(gK()),ne(Md({handler:E,reactEvent:mt}))},[ne,E]),bt=V.useCallback(mt=>{ne(uP(mt)),ne(Md({handler:P,reactEvent:mt}))},[ne,P]),jt=V.useCallback(()=>{ne(kY())},[ne]),Nt=V.useCallback(mt=>{ne(IY(mt.key))},[ne]),vt=V.useCallback(mt=>{ne(Md({handler:p,reactEvent:mt}))},[ne,p]),He=V.useCallback(mt=>{ne(Md({handler:a,reactEvent:mt}))},[ne,a]),ut=V.useCallback(mt=>{ne(Md({handler:b,reactEvent:mt}))},[ne,b]),Tt=V.useCallback(mt=>{ne(Md({handler:I,reactEvent:mt}))},[ne,I]),Yt=V.useCallback(mt=>{ne(Md({handler:W,reactEvent:mt}))},[ne,W]),Ge=V.useCallback(mt=>{ne(zY(mt)),ne(Md({handler:F,reactEvent:mt}))},[ne,F]),ot=V.useCallback(mt=>{ne(Md({handler:R,reactEvent:mt}))},[ne,R]);return V.createElement(kK.Provider,{value:ie},V.createElement(kTe.Provider,{value:ae},V.createElement("div",{className:ba("recharts-wrapper",r),style:fRe({position:"relative",cursor:"default",width:Z,height:l},$),onClick:qe,onContextMenu:vt,onDoubleClick:He,onFocus:jt,onKeyDown:Nt,onMouseDown:ut,onMouseEnter:tt,onMouseLeave:nt,onMouseMove:bt,onMouseUp:Tt,onTouchEnd:ot,onTouchMove:Ge,onTouchStart:Yt,ref:ke},n)))}),yRe=["children","className","width","height","style","compact","title","desc"];function vRe(e,t){if(e==null)return{};var n,r,l=_Re(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function _Re(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var UY=V.forwardRef((e,t)=>{var{children:n,className:r,width:l,height:d,style:p,compact:a,title:b,desc:T}=e,E=vRe(e,yRe),P=Qi(E,!1);return a?V.createElement(eV,{otherAttributes:P,title:b,desc:T},n):V.createElement(xRe,{className:r,style:p,width:l,height:d,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},V.createElement(eV,{otherAttributes:P,title:b,desc:T,ref:t},V.createElement(bIe,null,n)))}),bRe=["width","height"];function dP(){return dP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},dP.apply(null,arguments)}function wRe(e,t){if(e==null)return{};var n,r,l=SRe(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function SRe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var TRe={top:5,right:5,bottom:5,left:5},ERe={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:TRe,reverseStackOrder:!1,syncMethod:"index"},$Y=V.forwardRef(function(t,n){var r,l=$d(t.categoricalChartProps,ERe),{width:d,height:p}=l,a=wRe(l,bRe);if(!g_(d)||!g_(p))return null;var{chartName:b,defaultTooltipEventType:T,validateTooltipEventTypes:E,tooltipPayloadSearcher:P,categoricalChartProps:I}=t,R={chartName:b,defaultTooltipEventType:T,validateTooltipEventTypes:E,tooltipPayloadSearcher:P,eventEmitter:void 0};return V.createElement(FY,{preloadedState:{options:R},reduxStoreName:(r=I.id)!==null&&r!==void 0?r:b},V.createElement(pY,{chartData:I.data}),V.createElement(BY,{width:d,height:p,layout:l.layout,margin:l.margin}),V.createElement(VY,{accessibilityLayer:l.accessibilityLayer,barCategoryGap:l.barCategoryGap,maxBarSize:l.maxBarSize,stackOffset:l.stackOffset,barGap:l.barGap,barSize:l.barSize,syncId:l.syncId,syncMethod:l.syncMethod,className:l.className}),V.createElement(UY,dP({},a,{width:d,height:p,ref:n})))}),ARe=["axis","item"],nV=V.forwardRef((e,t)=>V.createElement($Y,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:ARe,tooltipPayloadSearcher:kO,categoricalChartProps:e,ref:t}));function CRe(e){var t=Ns();return V.useEffect(()=>{t(eRe(e))},[t,e]),null}var jRe=["width","height","layout"];function hP(){return hP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hP.apply(null,arguments)}function MRe(e,t){if(e==null)return{};var n,r,l=PRe(e,t);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);for(r=0;r<d.length;r++)n=d[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function PRe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var NRe={top:5,right:5,bottom:5,left:5},DRe={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:NRe,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},ORe=V.forwardRef(function(t,n){var r,l=$d(t.categoricalChartProps,DRe),{width:d,height:p,layout:a}=l,b=MRe(l,jRe);if(!g_(d)||!g_(p))return null;var{chartName:T,defaultTooltipEventType:E,validateTooltipEventTypes:P,tooltipPayloadSearcher:I}=t,R={chartName:T,defaultTooltipEventType:E,validateTooltipEventTypes:P,tooltipPayloadSearcher:I,eventEmitter:void 0};return V.createElement(FY,{preloadedState:{options:R},reduxStoreName:(r=l.id)!==null&&r!==void 0?r:T},V.createElement(pY,{chartData:l.data}),V.createElement(BY,{width:d,height:p,layout:a,margin:l.margin}),V.createElement(VY,{accessibilityLayer:l.accessibilityLayer,barCategoryGap:l.barCategoryGap,maxBarSize:l.maxBarSize,stackOffset:l.stackOffset,barGap:l.barGap,barSize:l.barSize,syncId:l.syncId,syncMethod:l.syncMethod,className:l.className}),V.createElement(CRe,{cx:l.cx,cy:l.cy,startAngle:l.startAngle,endAngle:l.endAngle,innerRadius:l.innerRadius,outerRadius:l.outerRadius}),V.createElement(UY,hP({width:d,height:p},b,{ref:n})))}),IRe=["item"],kRe={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},rV=V.forwardRef((e,t)=>{var n=$d(e,kRe);return V.createElement(ORe,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:IRe,tooltipPayloadSearcher:kO,categoricalChartProps:n,ref:t})}),RRe=["axis"],zRe=V.forwardRef((e,t)=>V.createElement($Y,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:RRe,tooltipPayloadSearcher:kO,categoricalChartProps:e,ref:t}));function LRe({summary:e,dailyViews:t=[],ratingsDistribution:n=[],visitsSummary:r={anonymous:0,logged:0},topViewers:l=[],followersComments:d=[]}){var T;const[p,a]=V.useState("daily"),b=[{key:"daily",label:"Visitas Diarias",icon:f.jsx(ple,{})},{key:"ratings",label:"Calificaciones",icon:f.jsx(ile,{})},{key:"visits",label:"Anónimas vs Usuarios",icon:f.jsx(dle,{})},{key:"top",label:"Usuarios Recurrentes",icon:f.jsx(v$,{})},{key:"growth",label:"Seguidores/Comentarios",icon:f.jsx(rle,{})}];return f.jsxs("div",{className:"md:border border-gray-200 rounded-xl md:p-4 space-y-4 bg-blue-50 h-full",children:[f.jsx("h3",{className:"text-lg font-bold text-gray-700",children:"Métricas Visuales"}),f.jsx("div",{className:"flex flex-wrap gap-2 border-b pb-2",children:b.map(E=>f.jsx("button",{onClick:()=>a(E.key),className:`flex items-center justify-center p-2 rounded transition ${p===E.key?"text-orange-600":"text-gray-500 hover:text-gray-700"}`,children:E.icon},E.key))}),f.jsx("div",{className:"mt-1 text-xs font-medium text-gray-600 text-center",children:(T=b.find(E=>E.key===p))==null?void 0:T.label}),f.jsxs("div",{className:"w-full h-82 bg-white border border-gray-100 rounded-lg p-4",children:[p==="daily"&&(t==null?void 0:t.length)>0&&f.jsx(gb,{width:"100%",height:250,children:f.jsxs(zRe,{data:t,margin:{top:10,right:0,left:-30,bottom:0},children:[f.jsx("defs",{children:f.jsxs("linearGradient",{id:"colorCount",x1:"0",y1:"0",x2:"0",y2:"1",children:[f.jsx("stop",{offset:"5%",stopColor:"#60dbfaff",stopOpacity:.8}),f.jsx("stop",{offset:"95%",stopColor:"#60fa93ff",stopOpacity:0})]})}),f.jsx(Wb,{dataKey:"date",tickFormatter:E=>new Date(E).toLocaleDateString("es-ES"),stroke:"#6B7280",tick:{fontSize:11}}),f.jsx(Zb,{stroke:"#6B7280",tick:{fontSize:12}}),f.jsx(wT,{strokeDasharray:"2 2"}),f.jsx(mb,{formatter:E=>[`${E} visitas`,"Visitas"],labelFormatter:E=>`Fecha: ${new Date(E).toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"short",day:"numeric"})}`}),f.jsx(QO,{type:"monotone",dataKey:"count",stroke:"#60cefaff",fillOpacity:1,fill:"url(#colorCount)"})]})}),p==="ratings"&&f.jsx(gb,{width:"100%",height:250,children:f.jsxs(nV,{data:[5,4,3,2,1].map(E=>{var P;return{_id:E,count:((P=n==null?void 0:n.find(I=>I._id===E))==null?void 0:P.count)||0}}),margin:{top:10,right:0,left:-39,bottom:0},children:[f.jsx(wT,{strokeDasharray:"3 3"}),f.jsx(Wb,{tick:{fontSize:14},dataKey:"_id",tickFormatter:E=>`${E}★`,stroke:"#6B7280"}),f.jsx(Zb,{allowDecimals:!1,stroke:"#6B7280",tick:{fontSize:14}}),f.jsx(mb,{formatter:E=>[`${E} calificaciones`,"Cantidad"],labelFormatter:E=>`${E} estrellas`}),f.jsx(DE,{dataKey:"count",radius:[4,4,0,0],barSize:30,children:[5,4,3,2,1].map(E=>f.jsx(oy,{fill:E<2?"#de4e4eff":"#00c83cff"},E))})]})}),p==="visits"&&f.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[r.anonymous+r.logged>0?f.jsx(gb,{width:"100%",height:250,children:f.jsxs(rV,{children:[f.jsx(NE,{data:[{name:"Visitas anónimas",value:r.anonymous},{name:"Visitas de usuarios",value:r.logged}],cx:"50%",cy:"50%",outerRadius:60,label:!0,children:["#57ffd2ff","#ffe855ff"].map((E,P)=>f.jsx(oy,{fill:E},P))}),f.jsx(mb,{formatter:(E,P)=>[`${E} visitas`,P]})]})}):f.jsx("div",{className:"  text-xs text-gray-500 text-center w-full py-8",children:"No hay datos de visitas para mostrar."}),f.jsxs("div",{className:"flex flex-col text-xs text-gray-400 space-y-2",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"inline-block w-3 h-3 rounded",style:{backgroundColor:"#57ffd2ff"}}),f.jsx("span",{children:"Personas que vieron tu perfil pero no estaban logueadas"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"inline-block w-3 h-3 rounded",style:{backgroundColor:"#ffe855ff"}}),f.jsx("span",{children:"Personas que vieron tu perfil estando logueadas"})]})]})]}),p==="top"&&f.jsx(f.Fragment,{children:(l==null?void 0:l.length)>0?f.jsx(gb,{width:"100%",height:250,children:f.jsxs(nV,{layout:"vertical",data:l,margin:{top:10,right:0,left:-10,bottom:0},children:[f.jsx(wT,{strokeDasharray:"2 2"}),f.jsx(Wb,{type:"number",tick:{fontSize:14}}),f.jsx(Zb,{dataKey:"name",type:"category",tick:{fontSize:11}}),f.jsx(mb,{formatter:E=>[`${E} visitas`,"Visitas"]}),f.jsx(DE,{dataKey:"visitCount",fill:"#8bfa9aff",barSize:30})]})}):f.jsx("div",{className:"  text-xs text-gray-500 text-center w-full py-8",children:"No hay usuarios recurrentes registrados en este periodo."})}),p==="growth"&&e&&f.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[f.jsx(gb,{width:"100%",height:250,children:f.jsxs(rV,{children:[f.jsx(NE,{data:[{name:"Seguidores",value:e.followersCount>0?e.followersCount:1},{name:"Comentarios",value:e.commentsCount>0?e.commentsCount:1}],cx:"50%",cy:"50%",outerRadius:80,innerRadius:40,label:!0,children:["#60a5fa","#fbbf24"].map((E,P)=>f.jsx(oy,{fill:E},P))}),f.jsx(mb,{formatter:(E,P)=>[`${E}`,P]})]})}),f.jsxs("div",{className:"flex flex-col text-xs text-gray-600 space-y-2",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"inline-block w-3 h-3 rounded",style:{backgroundColor:"#60a5fa"}}),f.jsx("span",{children:"Total de seguidores"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"inline-block w-3 h-3 rounded",style:{backgroundColor:"#fbbf24"}}),f.jsx("span",{children:"Total de comentarios"})]})]})]})]})]})}function FRe(e,t=5){var l;const n=new Date,r=[];for(let d=t-1;d>=0;d--){const p=new Date(n);p.setDate(n.getDate()-d);const a=((l=p==null?void 0:p.toISOString)==null?void 0:l.call(p).split("T")[0])??"",b=e.find(T=>T.date===a);r.push({date:a,count:b?b.count:0})}return r}function BRe(e){if(!e)return[];const t=7,n=new Date,r=[];for(let l=t-1;l>=0;l--){const d=new Date(n);d.setDate(n.getDate()-l);const p=d instanceof Date&&!isNaN(d)?d.toISOString().split("T")[0]:"";r.push({date:p,followers:Math.floor(Math.random()*10),comments:Math.floor(Math.random()*5)})}return r}function nI({entityId:e,entityType:t,summary:n,className:r=""}){var F,W;const l=br(),[d,p]=V.useState(()=>{const $=new Date,Z=new Date;return Z.setDate($.getDate()-7),{startDate:Z instanceof Date&&!isNaN(Z)?Z.toISOString().split("T")[0]:"",endDate:$ instanceof Date&&!isNaN($)?$.toISOString().split("T")[0]:""}}),a=V.useMemo(()=>`${d.startDate}_${d.endDate}`,[d]),b=ln($=>$.metrics.entities[e])||{},T=b.general||null,E=((F=b.daily)==null?void 0:F[a])||null,P=((W=b.topViewers)==null?void 0:W[a])||null,I=ln($=>$.metrics.loading),R=ln($=>$.metrics.error);return V.useEffect(()=>{!e||!t||(T||l(Db({entityId:e,entityType:t})),E||l(nT({entityId:e,entityType:t,...d})),P||l(rT({entityId:e,entityType:t,...d,limit:5})))},[e,t,a]),I&&!T&&!E&&!P?f.jsx("p",{className:"p-2  text-xs",children:"Cargando métricas..."}):R?f.jsxs("p",{className:"text-red-600 p-2  text-xs",children:["Error: ",R]}):f.jsxs("div",{className:`space-y-6 ${r}`,children:[f.jsxs("div",{className:"flex flex-col md:flex-row gap-3 md:items-end",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Desde:"}),f.jsx("input",{type:"date",value:d.startDate,onChange:$=>p(Z=>({...Z,startDate:$.target.value})),className:"border border-gray-300 rounded px-2 py-1 text-xs focus:ring focus:border-blue-300"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Hasta:"}),f.jsx("input",{type:"date",value:d.endDate,onChange:$=>p(Z=>({...Z,endDate:$.target.value})),className:"border border-gray-300 rounded px-2 py-1 text-xs focus:ring focus:border-blue-300"})]})]}),T&&f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[f.jsxs("div",{className:"bg-blue-50 border border-gray-200 rounded-lg p-3 text-center hover:shadow transition",children:[f.jsx(dz,{className:"mx-auto text-gray-500 mb-1"}),f.jsx("p",{className:"text-lg font-bold text-gray-700",children:T.totalViews}),f.jsx("p",{className:"text-xs text-gray-500",children:"Visitas totales"})]}),f.jsxs("div",{className:"bg-blue-50 border border-gray-200 rounded-lg p-3 text-center hover:shadow transition",children:[f.jsx(dz,{className:"mx-auto text-gray-500 mb-1"}),f.jsx("p",{className:"text-lg font-bold text-gray-700",children:T.anonymousViews}),f.jsx("p",{className:"text-xs text-gray-500",children:"Visitas anónimas"})]}),f.jsxs("div",{className:"bg-blue-50 border border-gray-200 rounded-lg p-3 text-center hover:shadow transition",children:[f.jsx($$,{className:"mx-auto text-gray-500 mb-1"}),f.jsx("p",{className:"text-lg font-bold text-gray-700",children:T.uniqueLoggedInViews}),f.jsx("p",{className:"text-xs text-gray-500",children:"Visitas únicas"})]})]}),P&&P.length>0&&f.jsxs("div",{className:"bg-blue-50 border border-gray-200 rounded-lg p-4",children:[f.jsx("h4",{className:"  text-xs font-semibold mb-2 text-gray-600",children:"Usuarios más recurrentes"}),f.jsx("ul",{className:"space-y-1",children:P.map(($,Z)=>f.jsxs("li",{className:"flex justify-between border-b border-gray-200 py-1 text-xs text-gray-600",children:[f.jsx("span",{children:$.name}),f.jsxs("span",{children:[$.visitCount," visitas"]})]},Z))})]}),E&&E.length>0&&f.jsxs("div",{className:"bg-blue-50 border border-gray-200 rounded-lg p-4",children:[f.jsx("h4",{className:"  text-xs font-semibold mb-3 text-gray-600",children:"Visitas diarias"}),f.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2",children:E.map($=>f.jsxs("div",{className:"flex flex-col items-center bg-white border border-gray-200 rounded-md p-2 text-xs text-gray-600 hover:shadow transition",children:[f.jsx("span",{className:"font-semibold text-gray-700",children:new Date($.date).toLocaleDateString()}),f.jsxs("span",{className:"text-xs",children:["👁 ",$.count," visitas"]})]},$.date))})]}),n&&f.jsxs("section",{className:"bg-blue-50 border border-gray-200 rounded-lg p-4",children:[f.jsx("h4",{className:"  text-xs font-semibold mb-4 text-gray-600",children:"Resumen de actividad"}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[f.jsx("div",{className:"col-span-1",children:f.jsx(vTe,{summary:n})}),f.jsx("div",{className:"col-span-1 lg:col-span-2",children:f.jsx(LRe,{summary:n,dailyViews:FRe(E||[],5),ratingsDistribution:n.ratings,visitsSummary:{anonymous:(T==null?void 0:T.anonymousViews)||0,logged:(T==null?void 0:T.uniqueLoggedInViews)||0},topViewers:P,followersComments:BRe(n)})})]})]})]})}function VRe(){var W,$,Z,ne;const{id:e}=Ec(),[t,n]=V.useState(null),[r,l]=V.useState(null),[d,p]=V.useState(!0),[a,b]=V.useState(null),[T,E]=V.useState("info"),[P,I]=V.useState(!1),R=br(),F=async()=>{try{await Rn.delete(`/businesses/${e}`),window.location.href="/dashboard/mis-negocios"}catch{R(Jt({message:"Error al eliminar el negocio",type:"error"}))}finally{I(!1)}};return V.useEffect(()=>{(async()=>{try{const{data:ge}=await Rn.get(`/businesses/${e}`);n(ge.business);const{data:ae}=await Rn.get(`/business-views/${e}/summary`);l(ae)}catch(ge){console.error(ge),b("Error al cargar los datos del negocio.")}finally{p(!1)}})()},[e]),d?f.jsx("p",{className:"p-4",children:"Cargando negocio..."}):a?f.jsx("p",{className:"p-4 text-red-600",children:a}):t?f.jsxs("div",{className:"flex flex-col gap-6 max-w-[1200px] w-full mx-auto ",children:[f.jsxs("div",{className:"w-full flex flex-col lg:flex-row gap-6 bg-gradient-to-br from-gray-50 via-white to-gray-100 rounded-2xl shadow-lg p-6 lg:p-8 xl:p-10 border border-gray-200",children:[f.jsx("div",{className:"w-full lg:w-60 flex-shrink-0",children:f.jsx("img",{src:t.featuredImage||`https://cdn.usegalileo.ai/sdxl10/${t._id||"default"}.png`,alt:t.name,className:"w-full h-40 lg:h-60 object-cover rounded-xl"})}),f.jsxs("div",{className:"flex-1 flex flex-col gap-4",children:[f.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-3 flex-wrap",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-800 leading-snug",children:t.name}),t.isVerified&&f.jsx("span",{className:"inline-flex items-center gap-1 bg-green-100 text-green-700 text-xs font-medium px-2 py-1 rounded-full",children:"Verificado"})]}),f.jsx("p",{className:"text-gray-600  text-xs leading-relaxed whitespace-pre-line",children:t.description}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[(W=t.tags)==null?void 0:W.map(ie=>f.jsxs("span",{className:"inline-block bg-gray-200 text-gray-600 text-xs font-medium px-2 py-1 rounded-full",children:["#",ie]},ie)),(($=t==null?void 0:t.categories)==null?void 0:$.length)>0&&t.categories.map(ie=>f.jsx("span",{className:"inline-block bg-black text-white text-xs font-medium px-2 py-1 rounded-full",children:ie.name},ie._id))]}),f.jsx("div",{className:"flex gap-2 mt-2 border-b border-gray-200",children:[{id:"info",label:"Información"},{id:"horarios",label:"Horarios"},{id:"galeria",label:"Galería"}].map(ie=>f.jsx("button",{onClick:()=>E(ie.id),className:`  text-xs px-3 py-2 rounded-t font-medium transition ${T===ie.id?"bg-white border border-b-0 border-gray-200 text-gray-800":"text-gray-500 hover:text-gray-700"}`,children:ie.label},ie.id))}),f.jsxs("div",{className:"pt-2",children:[T==="info"&&f.jsxs("div",{className:"flex flex-col gap-2  text-xs text-gray-600",children:[t.location&&f.jsxs("p",{children:["Dirección: ",t.location.address,","," ",t.location.city,", ",t.location.state]}),t.contact&&f.jsxs("div",{className:"flex flex-col gap-1",children:[t.contact.phone&&f.jsxs("span",{className:"flex items-center gap-2",children:[f.jsx(kce,{className:"text-gray-500"}),t.contact.phone]}),t.contact.email&&f.jsxs("span",{className:"flex items-center gap-2",children:[f.jsx(qP,{className:"text-gray-500"}),t.contact.email]}),t.contact.website&&f.jsxs("a",{href:t.contact.website,target:"_blank",rel:"noreferrer",className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 no-underline",children:[f.jsx(tw,{className:"text-gray-500"}),t.contact.website]})]})]}),T==="horarios"&&((Z=t.openingHours)==null?void 0:Z.length)>0&&f.jsx("ul",{className:"w-full max-w-[400px] border border-gray-200 rounded overflow-hidden",children:t.openingHours.map((ie,ge)=>f.jsxs("li",{className:`flex justify-between px-3 py-2  text-xs ${ge%2===0?"bg-blue-50":"bg-white"}`,children:[f.jsx("span",{className:"text-gray-700",children:ie.day}),f.jsx("span",{className:"text-gray-600",children:ie.closed?"Cerrado":`${ie.open} - ${ie.close}`})]},ie.day))}),T==="galeria"&&((ne=t.images)==null?void 0:ne.length)>0&&f.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-2",children:t.images.map(ie=>f.jsx("img",{src:ie,alt:"Imagen galería",className:"w-full h-24 object-cover rounded"},ie))})]}),f.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-gray-400",children:[f.jsxs("span",{children:["Creado:"," ",t.createdAt?new Date(t.createdAt).toLocaleDateString():"Sin fecha"]}),f.jsxs("span",{children:["Actualizado:"," ",t.updatedAt?new Date(t.updatedAt).toLocaleDateString():"Sin fecha"]})]})]})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap gap-2 mt-4",children:[f.jsxs(Wn,{to:`/negocios/${t._id}`,className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium no-underline",children:[f.jsx(UP,{className:"text-lg"}),"Ver perfil público"]}),f.jsxs(Wn,{to:`/dashboard/mis-negocios/${t._id}/promos/nueva`,className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium no-underline",children:[f.jsx(hy,{className:"text-lg"}),"Crear promoción"]}),f.jsxs(Wn,{to:`/dashboard/mis-negocios/${t._id}/editar`,className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium no-underline",children:[f.jsx(a3,{className:"text-lg"}),"Editar negocio"]}),f.jsxs("button",{onClick:()=>I(!0),className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-white items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-red-500 hover:bg-red-700 transition text-xs font-medium",children:[f.jsx(Iw,{className:"text-lg"}),"Eliminar negocio"]})]}),f.jsxs("section",{className:"bg-white md:border border-gray-200 rounded-2xl md:p-6 md:shadow space-y-4",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Métricas"}),f.jsx("p",{className:"  text-xs text-gray-500",children:"Aquí puedes ver las estadísticas de visitas, seguidores y calificaciones."}),f.jsx(nI,{entityId:t._id,entityType:"business",summary:r})]}),f.jsx(cp,{open:P,onClose:()=>I(!1),onConfirm:F,entityName:t.name})]}):null}function URe(){var d;const{id:e}=Ec(),t=br(),n=aa(),r=ln(p=>p.eventos.misEventos.find(a=>a._id===e)),l=ln(p=>{var a;return((a=p.metrics.entities[e])==null?void 0:a.general)||null});return V.useEffect(()=>{l||t(Db({entityType:"event",entityId:e}))},[t,e,l]),r?f.jsxs("div",{className:"flex flex-col gap-6 max-w-[1200px] w-full mx-auto",children:[f.jsxs("div",{className:"w-full flex flex-col lg:flex-row gap-6 bg-gradient-to-br from-gray-50 via-white to-gray-100 rounded-2xl shadow-lg p-6 lg:p-8 xl:p-10 border border-gray-200",children:[f.jsx("div",{className:"w-full lg:w-60 flex-shrink-0",children:f.jsx("img",{src:r.featuredImage,alt:r.title,className:"w-full h-40 lg:h-60 object-cover rounded-xl"})}),f.jsxs("div",{className:"flex-1 flex flex-col gap-4",children:[f.jsx("h2",{className:"text-2xl font-extrabold text-[#141C24] leading-snug",children:r.title}),f.jsx("p",{className:"text-gray-700  text-xs lg:text-base leading-relaxed whitespace-pre-line",children:r.description}),((d=r.tags)==null?void 0:d.length)>0&&f.jsx("div",{className:"flex flex-wrap gap-2",children:r.tags.map(p=>f.jsxs("span",{className:"inline-block bg-blue-100 text-blue-700 text-xs font-medium px-2 py-1 rounded-full",children:["#",p]},p))}),f.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-gray-500 mt-1",children:[f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(ySe,{className:"w-4 h-4"}),f.jsx("span",{children:r.date?new Date(r.date).toLocaleDateString():"Sin fecha"})]}),f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(q0e,{className:"w-4 h-4"}),f.jsx("span",{children:r.time||"Sin hora"})]}),r.location&&f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(vSe,{className:"w-4 h-4"}),f.jsxs("span",{children:[r.location.address,", ",r.location.city]})]}),f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(H0e,{className:"w-4 h-4"}),f.jsxs("span",{children:["Creado: ",new Date(r.createdAt).toLocaleDateString()]})]})]})]})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap gap-2 mt-2",children:[f.jsxs(Wn,{to:`/dashboard/mis-eventos/${r._id}/editar`,className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium no-underline",children:[f.jsx(a3,{className:"text-lg"}),"Editar evento"]}),f.jsxs(Wn,{to:`/eventos/${r._id}`,className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium no-underline",children:[f.jsx(UP,{className:"text-lg"}),"Ver detalle del evento"]}),f.jsxs("button",{onClick:async()=>{await t(KE(r._id)),n("/dashboard/mis-eventos")},className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-white items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-red-500 hover:bg-red-700 transition text-xs font-medium",children:[f.jsx(Iw,{className:"text-lg"}),"Eliminar evento"]})]}),f.jsxs("section",{className:"bg-white md:border border-gray-200 rounded-2xl md:p-6 md:shadow space-y-4",children:[f.jsx("h3",{className:" text-lg font-bold",children:"Métricas del evento"}),f.jsx("p",{className:"  text-xs text-gray-500",children:"Aquí podrás visualizar estadísticas de visitas y engagement."}),f.jsx(nI,{entityId:e,entityType:"event",summary:l})]})]}):f.jsx("p",{className:"p-4",children:"Cargando evento..."})}function $Re(){const{id:e}=Ec(),t=aa(),[n,r]=V.useState(null),[l,d]=V.useState(null),[p,a]=V.useState(!0),[b,T]=V.useState(null),[E,P]=V.useState(!1),I=br();V.useEffect(()=>{if(!e||typeof e!="string"||e.length!==24){T("ID de comunidad inválido"),a(!1);return}(async()=>{try{const{data:W}=await Rn.get(`/communities/${e}`);r(W==null?void 0:W.community);const{data:$}=await Rn.get(`/community-views/${e}/summary`);d($)}catch(W){console.error(W),T("Error al cargar la comunidad")}finally{a(!1)}})()},[e]);const R=async()=>{try{await Rn.delete(`/communities/${e}`),t("/dashboard/comunidades")}catch{I(Jt({message:"Ocurrió un error al eliminar la comunidad.",type:"error"}))}};return p?f.jsx("p",{className:"p-4",children:"Cargando comunidad..."}):b?f.jsx("p",{className:"p-4 text-red-600",children:b}):n?f.jsxs("div",{className:"flex flex-col gap-6 px-4 pb-12 max-w-[1200px] w-full mx-auto",children:[f.jsxs("div",{className:"w-full flex flex-col lg:flex-row gap-6 bg-white rounded-3xl border border-gray-200 shadow p-6 lg:p-8 xl:p-10",children:[f.jsx("div",{className:"w-full lg:w-60 flex-shrink-0",children:f.jsx("img",{src:n.bannerImage||n.flagImage||`https://cdn.usegalileo.ai/sdxl10/${n._id}.png`,alt:n.name,className:"w-full h-40 lg:h-60 object-cover rounded-xl"})}),f.jsxs("div",{className:"flex-1 flex flex-col gap-4",children:[f.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center gap-3 flex-wrap",children:f.jsx("h2",{className:"text-2xl font-extrabold text-[#141C24] leading-snug",children:n.name})}),n.description&&f.jsx("p",{className:"text-gray-700  text-xs lg:text-base leading-relaxed whitespace-pre-line",children:n.description}),f.jsxs("div",{className:"flex flex-col gap-2 text-xs text-gray-600 mt-1",children:[n.region&&f.jsxs("span",{className:"flex items-center gap-1",children:["🌎 ",f.jsxs("span",{children:["Región: ",n.region]})]}),n.language&&f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx(Dce,{className:"text-gray-500  text-xs"}),f.jsxs("span",{children:["Idioma: ",n.language.toUpperCase()]})]})]}),f.jsx("div",{className:"flex flex-wrap gap-4 text-xs text-gray-500",children:f.jsxs("span",{children:["Actualizado: ",new Date(n.updatedAt).toLocaleDateString()]})})]})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap gap-2 mt-2",children:[f.jsxs(Wn,{to:`/dashboard/comunidades/${n._id}/editar`,className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium no-underline",children:[f.jsx(a3,{className:"text-lg"}),"Editar comunidad"]}),f.jsxs(Wn,{to:`/comunidades/${n.slug||n._id}`,className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-orange-600 items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-white hover:bg-gray-50 transition text-xs font-medium no-underline",children:[f.jsx(UP,{className:"text-lg"}),"Ver perfil público"]}),f.jsxs("button",{onClick:()=>P(!0),className:"whitespace-nowrap flex shadow-md hover:shadow-lg text-white items-center justify-center gap-2 px-3 py-2 rounded border border-gray-300 bg-red-500 hover:bg-red-700 transition text-xs font-medium",children:[f.jsx(Iw,{className:"text-lg"}),"Eliminar comunidad"]})]}),f.jsxs("section",{className:"bg-white md:border border-gray-200 rounded-2xl md:p-6 md:shadow space-y-4",children:[f.jsx("h3",{className:" text-lg font-bold text-[#141C24]",children:"Métricas de la comunidad"}),f.jsx("p",{className:"  text-xs text-gray-500",children:"Aquí puedes visualizar las estadísticas de visitas y actividad."}),f.jsx(nI,{entityId:e,entityType:"community",summary:l})]}),f.jsx(cp,{open:E,onClose:()=>P(!1),onConfirm:R,entityName:n.name,title:"Eliminar comunidad",description:"Para confirmar, escribe el nombre exacto de la comunidad:"})]}):f.jsx("p",{className:"p-4 text-gray-600",children:"Comunidad no encontrada."})}function qRe(){var P,I;const e=br(),{lista:t,loading:n,error:r}=ln(R=>R.userPromos)||{},[l,d]=V.useState(null);V.useEffect(()=>{try{e(iT())}catch{}},[e]);const p=V.useMemo(()=>{if(Array.isArray(t))return t;if(Array.isArray(t==null?void 0:t.data))return t.data;if(t&&typeof t=="object"){const R=Object.values(t).find(F=>Array.isArray(F));if(Array.isArray(R))return R}return[]},[t]),a=async(R,F)=>{var W;R.stopPropagation();try{if((W=navigator==null?void 0:navigator.clipboard)!=null&&W.writeText)await navigator.clipboard.writeText(String(F??""));else{const $=document.createElement("input");$.value=String(F??""),document.body.appendChild($),$.select(),document.execCommand("copy"),document.body.removeChild($)}e(Jt({message:"Código copiado",type:"success"}))}catch{e(Jt({message:"No se pudo copiar el código",type:"error"}))}},b=R=>{!R||!R.promotion||d(R)},T=()=>d(null),E=R=>{try{const F=new Date(R);return isNaN(F)?null:F.toLocaleDateString()}catch{return null}};return f.jsxs("div",{className:"max-w-[1200px] w-full mx-auto flex flex-col gap-8 md:gap-12 xl:gap-16 px-2",children:[f.jsx(Oa,{children:f.jsx("title",{children:"Mis Cupones | Communidades"})}),f.jsx(px,{icon:"🎁",title:"Tus cupones",badge:"Promociones guardadas",description:"Aquí podrás ver todas las promociones que has guardado con tu cuenta y sus respectivos códigos de uso.",illustration:Yh}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("hr",{className:"flex-grow border-gray-200"}),f.jsx("span",{className:"text-gray-400 text-xs uppercase tracking-wider",children:"Tus códigos"}),f.jsx("hr",{className:"flex-grow border-gray-200"})]}),n&&f.jsx("p",{className:"text-gray-500",children:"Cargando cupones..."}),!n&&r&&f.jsx("p",{className:"text-red-500",children:String(r)}),!n&&p.length===0?f.jsxs("div",{className:"flex flex-col items-center text-center gap-5 py-16",children:[f.jsx("img",{src:Kc,alt:"Sin cupones",className:"w-40 opacity-90"}),f.jsxs("p",{className:"text-gray-600  text-xs md:text-base max-w-xs",children:["Aún no has guardado ningún cupón. ",f.jsx("br",{})," Explorá promociones y guardá tus favoritas para redimirlas luego."]})]}):!n&&f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4 gap-y-6 gap-x-4 md:gap-6 xl:gap-8",children:p.map(R=>{var se;if(!R||typeof R!="object")return null;const F=R._id??R.id??`${R.code??"promo"}-${Math.random()}`,W=R.promotion??{},$=R.code??"",Z=!!R.redeemed,ne=E(R.redeemedAt),ie=W.featuredImage||"/placeholder.jpg",ge=W.name||"Promoción",ae=W.description||"";return(se=W.business)!=null&&se._id||W.businessId,f.jsxs("div",{className:"relative rounded-xl overflow-hidden shadow-md border border-gray-200 hover:border-gray-400 transition group h-65 sm:h-52 md:h-56 cursor-pointer",onClick:()=>b(R),children:[f.jsx("img",{src:ie,alt:ge,className:"absolute inset-0 w-full h-full object-cover z-0",onError:me=>{me.currentTarget.src="/placeholder.jpg"}}),f.jsx("div",{className:"absolute inset-0 bg-black/60 z-10"}),f.jsxs("div",{className:"relative z-20 p-4 h-full gap-2 flex flex-col justify-between text-white",children:[f.jsxs("div",{className:"space-y-1 grid gap-3",children:[f.jsx("h2",{className:"text-lg font-bold",children:ge}),!!ae&&f.jsx("p",{className:"hidden md:block text-xs text-gray-200",children:ae})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex items-center justify-between bg-[#39ff1415] border border-[#39FF14] p-2 rounded-lg",children:[f.jsx("span",{className:"font-mono tracking-widest  text-xs text-white",children:$||"—"}),f.jsx("button",{onClick:me=>a(me,$),className:"text-white hover:text-[#aaffaa]",title:"Copiar código",type:"button",children:f.jsx(qce,{})})]}),f.jsx("div",{className:"  text-xs font-medium",children:Z?f.jsxs("p",{className:"text-green-400 flex items-center gap-1",children:[f.jsx(jd,{className:"text-green-300"})," ","Redimido"," ",ne&&f.jsxs("span",{className:"text-gray-300 text-xs ml-1",children:["(",ne,")"]})]}):f.jsx("p",{className:"text-yellow-400",children:"⏳ No redimido"})})]})]})]},F)})}),l&&l.promotion&&f.jsx("div",{className:"fixed inset-0 bg-black/40 z-[200] flex items-center justify-center px-4",onClick:T,children:f.jsxs("div",{className:"bg-white rounded-xl shadow-lg max-w-md w-full relative overflow-hidden",onClick:R=>R.stopPropagation(),children:[f.jsx("button",{onClick:T,className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700  text-lg",type:"button",children:"×"}),f.jsx("img",{src:l.promotion.featuredImage||"/placeholder.jpg",alt:l.promotion.name||"Promo",className:"w-full h-48 object-cover",onError:R=>{R.currentTarget.src="/placeholder.jpg"}}),f.jsxs("div",{className:"p-4 space-y-3",children:[f.jsx("h2",{className:"text-lg font-bold text-gray-800",children:l.promotion.name||"Promoción"}),!!l.promotion.description&&f.jsx("p",{className:"text-gray-600  text-xs",children:l.promotion.description}),f.jsxs("div",{className:"  text-xs text-gray-700",children:[f.jsx("span",{className:"font-medium",children:"Código: "}),f.jsx("span",{className:"font-mono px-2 py-1 rounded border border-[#2ecc71] bg-[#2ecc7115] text-[#2ecc71] tracking-wider",children:l.code||"—"})]}),((I=(P=l.promotion)==null?void 0:P.business)==null?void 0:I._id)&&f.jsx(Wn,{to:`/negocios/${l.promotion.business._id}`,className:"block text-center bg-orange-500 hover:bg-orange-600 text-white font-medium py-2 rounded transition",children:"Ver negocio"})]})]})})]})}function HRe(){var E;const e=br(),[t,n]=V.useState(""),[r,l]=V.useState(null),[d,p]=V.useState(null),[a,b]=V.useState(!1),T=async P=>{var R;P.preventDefault(),b(!0),p(null),l(null);const I=await e(RU(t));b(!1),I.meta.requestStatus==="fulfilled"?l(I.payload):p(((R=I.error)==null?void 0:R.message)||"Código inválido o no autorizado")};return f.jsxs("div",{className:"max-w-[1200px] w-full mx-auto flex flex-col gap-8 md:gap-12 xl:gap-16 px-2 pb-10",children:[f.jsx(Oa,{children:f.jsx("title",{children:"Redimir Código | Communidades"})}),f.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 md:gap-8 xl:gap-10 mt-10",children:[f.jsx("div",{className:"flex-1",children:f.jsxs("div",{className:"space-y-4",children:[f.jsx("h1",{className:"text-2xl font-bold text-sky-800",children:"Redimir Código"}),f.jsx("p",{className:"text-gray-700  text-xs md:text-base max-w-lg",children:"Ingresá el código único que te presentó un usuario para validar y marcar la promoción como redimida."})]})}),f.jsx("div",{className:"hidden lg:block w-[240px] shrink-0",children:f.jsx("img",{src:Yh,alt:"Ilustración",className:"w-full"})})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("hr",{className:"flex-grow border-gray-200"}),f.jsx("span",{className:"text-gray-400 text-xs uppercase tracking-wider",children:"Validación"}),f.jsx("hr",{className:"flex-grow border-gray-200"})]}),f.jsxs("form",{onSubmit:T,className:"space-y-4 max-w-md mx-auto w-full",children:[f.jsx("input",{type:"text",placeholder:"Ingresá el código del usuario",value:t,onChange:P=>n(P.target.value.toUpperCase()),className:"w-full px-4 py-2 border border-gray-300 rounded-md text-center text-lg font-mono tracking-wide",required:!0}),f.jsx("button",{type:"submit",disabled:a,className:"w-full bg-sky-600 text-white px-6 py-2 rounded-lg hover:bg-sky-700 disabled:opacity-60 transition font-semibold",children:a?"Verificando...":"Redimir código"})]}),r&&f.jsxs("div",{className:"max-w-md mx-auto bg-green-50 border border-green-300 p-4 rounded-lg space-y-2",children:[f.jsx("p",{className:"text-green-700 font-semibold  text-xs",children:"✅ ¡Código redimido correctamente!"}),f.jsxs("p",{className:"text-gray-700  text-xs",children:["Promo: ",f.jsx("strong",{children:(E=r.promotion)==null?void 0:E.name})]}),f.jsxs("p",{className:"text-gray-700  text-xs",children:["Usuario: ",f.jsx("strong",{children:r.user})]}),f.jsxs("p",{className:"text-gray-500 text-xs",children:["Redimido el ",new Date(r.redeemedAt).toLocaleString()]})]}),d&&f.jsxs("div",{className:"max-w-md mx-auto text-red-600 font-medium bg-red-50 border border-red-300 p-4 rounded-lg  text-xs",children:["❌ ",d]}),f.jsx(Kh,{direction:"left",duration:900,delay:200,children:f.jsx("div",{className:"block lg:hidden mt-10 flex justify-center",children:f.jsx("img",{src:Yh,alt:"Ilustración",className:"max-h-48 w-auto"})})})]})}function GRe({banner:e,active:t,onClick:n}){return f.jsxs("div",{onClick:n,className:`rounded-lg border transition cursor-pointer overflow-hidden bg-white/70 hover:shadow ${t?"border-blue-400 ring-2 ring-blue-200":"border-gray-200"}`,children:[f.jsx("div",{className:"aspect-video bg-gray-50 flex items-center justify-center",children:e!=null&&e.imageUrl?f.jsx("img",{src:e.imageUrl,alt:e.imageAlt||e.title,className:"w-full h-full object-contain",loading:"lazy"}):f.jsx("div",{className:"text-gray-400  text-xs p-4",children:"Sin imagen"})}),f.jsxs("div",{className:"p-3",children:[f.jsx("div",{className:"  text-xs font-semibold text-[#141C24] truncate",children:e.title}),f.jsxs("div",{className:"text-xs text-gray-600 mt-1 truncate",children:[e.placement," · ",e.isActive?"Activo":"Inactivo",e.isFallback?" · Fallback":""]}),f.jsxs("div",{className:"text-[11px] text-gray-500 mt-1",children:["Imp: ",e.impressions??0," · Clicks: ",e.clicks??0]})]})]})}async function WRe(e){return(await Rn.post("ads/banners/submit",e,{headers:{"Content-Type":"multipart/form-data"}})).data}async function ZRe({page:e=1,limit:t=50}={}){const{data:n}=await Rn.get("/ads/my-banners",{params:{page:e,limit:t},headers:{"Cache-Control":"no-cache"}});return n}async function XRe(e){return(await Rn.post(`ads/banners/${e}/approve`)).data}async function KRe(e,t=""){return(await Rn.post(`ads/banners/${e}/reject`,{reason:t})).data}async function YRe(e){const{data:t}=await Rn.post(`ads/banners/${e}/checkout`);return t}function QRe({status:e}){const n={submitted:"bg-yellow-100 text-yellow-800",under_review:"bg-amber-100 text-amber-800",approved:"bg-emerald-100 text-emerald-800",awaiting_payment:"bg-blue-100 text-blue-800",active:"bg-green-100 text-green-800",rejected:"bg-gray-200 text-gray-800",archived:"bg-slate-200 text-slate-800"}[e]||"bg-slate-100 text-slate-800";return f.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${n}`,children:e||"—"})}function iV(e){if(!e)return"—";const t=new Date(e);return isNaN(t)?"—":t.toLocaleString()}function aV({banner:e,onDeleted:t,onUpdated:n}){var ne,ie,ge,ae,se,me,ke,qe,tt;const r=br(),{usuario:l}=ln(nt=>nt.auth),d=(l==null?void 0:l.role)==="admin",[p,a]=V.useState(!1);if(!e)return null;const b=e._id||e.id,T=async()=>{try{await navigator.clipboard.writeText(b),r(Jt({type:"success",message:"ID copiado"}))}catch{}},E=nt=>{nt&&window.open(nt,"_blank","noopener,noreferrer")},P=async()=>{var nt;try{a(!0);const{data:bt}=await Rn.put(`ads/banners/${b}`,{isActive:!e.isActive});r(Jt({type:"success",message:`Banner ${(nt=bt==null?void 0:bt.banner)!=null&&nt.isActive?"activado":"desactivado"}`})),n==null||n()}catch{r(Jt({type:"error",message:"No se pudo actualizar activo/inactivo"}))}finally{a(!1)}},I=async()=>{try{a(!0),await Rn.post(`ads/banners/${b}/under-review`),r(Jt({type:"success",message:"Marcado como 'en revisión'"})),n==null||n()}catch{r(Jt({type:"error",message:"No se pudo marcar 'en revisión'"}))}finally{a(!1)}},R=async()=>{try{a(!0),await XRe(b),r(Jt({type:"success",message:"Aprobado. Se notificó al usuario."})),n==null||n()}catch{r(Jt({type:"error",message:"No se pudo aprobar"}))}finally{a(!1)}},F=async()=>{const nt=prompt("Motivo del rechazo (opcional):")||"";try{a(!0),await KRe(b,nt),r(Jt({type:"success",message:"Rechazado"})),n==null||n()}catch{r(Jt({type:"error",message:"No se pudo rechazar"}))}finally{a(!1)}},W=async()=>{try{a(!0);const{url:nt}=await YRe(b);nt?window.open(nt,"_blank","noopener,noreferrer"):r(Jt({type:"error",message:"No se pudo crear checkout"}))}catch{r(Jt({type:"error",message:"Error creando checkout"}))}finally{a(!1)}},$=async()=>{if(confirm("¿Eliminar banner? Esta acción no se puede deshacer."))try{a(!0),await Rn.delete(`ads/banners/${b}`),r(Jt({type:"success",message:"Banner eliminado"})),t==null||t(b)}catch{r(Jt({type:"error",message:"No se pudo eliminar"}))}finally{a(!1)}},Z=e.imageUrl||((ne=e.sources)==null?void 0:ne.default)||e.imageDesktopUrl||e.imageTabletUrl||e.imageMobileUrl;return f.jsxs("div",{className:"bg-white/80 rounded-xl border border-gray-200 p-4 md:p-5 shadow-sm w-full",children:[f.jsxs("div",{className:"flex items-start justify-between gap-3",children:[f.jsxs("div",{className:"min-w-0",children:[f.jsx("h3",{className:"text-lg font-semibold text-[#141C24] truncate",children:e.title}),f.jsxs("p",{className:"  text-xs text-gray-600 truncate flex items-center gap-2",children:[e.placement," · ",f.jsx(QRe,{status:e.status}),e.isFallback?f.jsx("span",{className:"text-xs",children:"· Fallback"}):null,f.jsx("span",{className:"text-xs",children:e.isActive?"· Activo":"· Inactivo"})]}),f.jsxs("p",{className:"text-xs text-gray-500",children:["ID:"," ",f.jsx("button",{onClick:T,className:"underline",children:b})]})]}),f.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[f.jsxs("button",{onClick:()=>E(e.redirectUrl),className:"inline-flex items-center gap-1 px-3 py-2  text-xs rounded border border-gray-300 bg-white hover:bg-gray-50",title:"Abrir destino",children:[f.jsx(xle,{})," Destino"]}),f.jsxs("button",{onClick:T,className:"inline-flex items-center gap-1 px-3 py-2  text-xs rounded border border-gray-300 bg-white hover:bg-gray-50",title:"Copiar ID",children:[f.jsx(Sle,{})," Copiar ID"]})]})]}),f.jsx("div",{className:"mt-4 rounded-lg overflow-hidden bg-gray-50",children:Z?f.jsx("img",{src:Z,alt:e.imageAlt||e.title,className:"w-full h-auto object-contain"}):f.jsx("div",{className:"p-8 text-center text-gray-400  text-xs",children:"Sin imagen"})}),f.jsxs("div",{className:"grid sm:grid-cols-2 gap-2 mt-2 text-xs",children:[e.imageUrl&&f.jsx("button",{onClick:()=>E(e.imageUrl),className:"text-blue-600 underline text-left",children:"Cloudinary (default)"}),e.imageDesktopUrl&&f.jsx("button",{onClick:()=>E(e.imageDesktopUrl),className:"text-blue-600 underline text-left",children:"Cloudinary (desktop)"}),e.imageTabletUrl&&f.jsx("button",{onClick:()=>E(e.imageTabletUrl),className:"text-blue-600 underline text-left",children:"Cloudinary (tablet)"}),e.imageMobileUrl&&f.jsx("button",{onClick:()=>E(e.imageMobileUrl),className:"text-blue-600 underline text-left",children:"Cloudinary (mobile)"})]}),f.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mt-4  text-xs",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"URL destino:"})," ",f.jsx("a",{className:"text-blue-600 underline break-all",href:e.redirectUrl,target:"_blank",rel:"noopener noreferrer",children:e.redirectUrl})]}),f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Peso:"})," ",e.weight??1]}),f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Impresiones:"})," ",e.impressions??0," ",e.maxImpressions?`/ ${e.maxImpressions}`:""]}),f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Clicks:"})," ",e.clicks??0," ",e.maxClicks?`/ ${e.maxClicks}`:""]})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Inicio:"})," ",iV(e.startAt)]}),f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Fin:"})," ",iV(e.endAt)]}),f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Creado por:"})," ",e.createdByName||e.createdBy||"—"," (",e.createdByRole||"—",")"]}),f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Precio:"})," ",((e.priceCents??0)/100).toFixed(2)," ",((ge=(ie=e.currency)==null?void 0:ie.toUpperCase)==null?void 0:ge.call(ie))||"USD"]})]}),f.jsxs("div",{className:"space-y-1 md:col-span-2",children:[f.jsx("span",{className:"font-medium",children:"Segmentación:"})," ",(ae=e.communities)!=null&&ae.length||(se=e.categories)!=null&&se.length||(me=e.businesses)!=null&&me.length?f.jsxs("span",{className:"text-gray-700",children:["comm: ",((ke=e.communities)==null?void 0:ke.length)??0," · cat:"," ",((qe=e.categories)==null?void 0:qe.length)??0," · biz:"," ",((tt=e.businesses)==null?void 0:tt.length)??0]}):"Sin restricción"]})]}),d&&f.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-4",children:[["submitted"].includes(e.status)&&f.jsxs("button",{onClick:I,disabled:p,className:"inline-flex items-center gap-1 bg-slate-700 text-white  text-xs px-3 py-2 rounded hover:bg-slate-800 transition",title:"Marcar En revisión",children:[f.jsx(vle,{className:"text-base"})," En revisión"]}),["submitted","under_review"].includes(e.status)&&f.jsxs("button",{onClick:R,disabled:p,className:"inline-flex items-center gap-1 bg-emerald-600 text-white  text-xs px-3 py-2 rounded hover:bg-emerald-700 transition",title:"Aprobar",children:[f.jsx(VP,{className:"text-base"})," Aprobar"]}),["submitted","under_review","approved","awaiting_payment"].includes(e.status)&&f.jsxs("button",{onClick:F,disabled:p,className:"inline-flex items-center gap-1 bg-gray-700 text-white  text-xs px-3 py-2 rounded hover:bg-gray-800 transition",title:"Rechazar",children:[f.jsx(jle,{className:"text-base"})," Rechazar"]}),f.jsx("button",{onClick:P,disabled:p,className:"inline-flex items-center gap-1 bg-white border border-gray-300  text-xs px-3 py-2 rounded hover:bg-gray-50 transition",title:"Activar/Desactivar",children:e.isActive?"Desactivar":"Activar"}),["approved","awaiting_payment"].includes(e.status)&&f.jsx("button",{onClick:W,disabled:p,className:"inline-flex items-center gap-1 bg-black text-white  text-xs px-3 py-2 rounded hover:bg-[#f4c753] hover:text-black transition",title:"Crear Checkout",children:"Checkout"}),f.jsxs("button",{onClick:$,disabled:p,className:"inline-flex items-center gap-1 bg-red-600 text-white  text-xs px-3 py-2 rounded hover:bg-red-700 transition ml-auto",title:"Eliminar",children:[f.jsx(Iw,{className:"text-base"})," Eliminar"]})]})]})}const JRe=[{value:"",label:"Todos los placements"},{value:"home_top",label:"Home Top"},{value:"home_bottom",label:"Home Bottom"},{value:"sidebar_right_1",label:"Sidebar derecha #1"},{value:"sidebar_right_2",label:"Sidebar derecha #2"},{value:"listing_top",label:"Listado Top"},{value:"listing_inline",label:"Listado Inline"},{value:"community_banner",label:"Detalle Comunidad"},{value:"event_banner",label:"Detalle Evento"},{value:"business_banner",label:"Detalle Negocio"},{value:"custom",label:"Custom"}],e6e=[{value:"",label:"Todos los estados"},{value:"submitted",label:"Pendientes"},{value:"under_review",label:"En revisión"},{value:"approved",label:"Aprobados (pago)"},{value:"awaiting_payment",label:"Esperando pago"},{value:"active",label:"Publicados"},{value:"rejected",label:"Rechazados"},{value:"archived",label:"Archivados"}];function t6e({q:e,setQ:t,placement:n,setPlacement:r,status:l,setStatus:d,activeOnly:p,setActiveOnly:a,onReset:b}){return f.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3 mb-2",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[f.jsxs("div",{className:"relative",children:[f.jsx(yle,{className:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-500"}),f.jsx("input",{value:e,onChange:T=>t(T.target.value),placeholder:"Buscar por título…",className:"pl-8 pr-3 py-2 border border-gray-300 rounded-md  text-xs bg-white/80"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Ale,{className:"text-gray-600"}),f.jsx("select",{value:n,onChange:T=>r(T.target.value),className:"px-2 py-2 border border-gray-300 rounded-md  text-xs bg-white/80",children:JRe.map(T=>f.jsx("option",{value:T.value,children:T.label},T.value))}),f.jsx("select",{value:l,onChange:T=>d(T.target.value),className:"px-2 py-2 border border-gray-300 rounded-md  text-xs bg-white/80",title:"Estado",children:e6e.map(T=>f.jsx("option",{value:T.value,children:T.label},T.value))}),f.jsxs("label",{className:"inline-flex items-center gap-2  text-xs text-gray-700",children:[f.jsx("input",{type:"checkbox",checked:p,onChange:T=>a(T.target.checked)}),"Solo activos"]})]})]}),f.jsxs("button",{onClick:b,className:"inline-flex items-center gap-2 px-3 py-2  text-xs rounded border border-gray-300 bg-white hover:bg-gray-50",children:[f.jsx(Ele,{className:"text-lg"}),"Reset"]})]})}function n6e(e){const t=e._id||e.id;return{...e,_id:t,id:t}}function r6e(){const e=br(),t=aa(),n=V.useRef(null),{usuario:r}=ln(ot=>ot.auth),l=(r==null?void 0:r.role)==="admin",[d,p]=p$(),a=d.get("placement")||"",b=d.get("q")||"",T=d.get("activeOnly")==="true",E=d.get("status")||"",[P,I]=V.useState(a),[R,F]=V.useState(b),[W,$]=V.useState(T),[Z,ne]=V.useState(E),[ie,ge]=V.useState(!0),[ae,se]=V.useState([]),[me,ke]=V.useState(null),[qe,tt]=V.useState(null),[nt,bt]=V.useState(!1),[jt,Nt]=V.useState(b);V.useEffect(()=>{const ot=setTimeout(()=>Nt(R),350);return()=>clearTimeout(ot)},[R]);const vt=V.useMemo(()=>({...P?{placement:P}:{},...jt?{q:jt}:{},...W?{activeOnly:!0}:{},...Z?{status:Z}:{}}),[P,jt,W,Z]),He=async()=>{if(l)try{ge(!0),ke(null);const{data:ot}=await Rn.get("ads/banners",{params:vt,headers:{"Cache-Control":"no-cache"}});let mt=((ot==null?void 0:ot.banners)??[]).map(n6e).sort((It,In)=>+new Date(In.createdAt||0)-+new Date(It.createdAt||0));Z&&(mt=mt.filter(It=>(It.status||"")===Z)),W&&(mt=mt.filter(It=>It.isActive)),se(mt),mt.length>0?tt(It=>It&&mt.find(In=>In._id===It._id)?It:mt[0]):tt(null)}catch{ke("No se pudieron cargar los banners")}finally{ge(!1)}};V.useEffect(()=>{const ot={};P&&(ot.placement=P),jt&&(ot.q=jt),W&&(ot.activeOnly="true"),Z&&(ot.status=Z),p(ot,{replace:!0}),He()},[P,jt,W,Z,l]),V.useEffect(()=>{r&&!l&&t("/")},[r,l,t]);const ut=ot=>{tt(ot),window.innerWidth<768?bt(!0):setTimeout(()=>{var mt;(mt=n.current)==null||mt.scrollIntoView({behavior:"smooth",block:"start"})},100)},Tt=async ot=>{try{await Rn.delete(`ads/banners/${ot}`),e(Jt({type:"success",message:"Banner eliminado"}));const mt=ae.filter(It=>It._id!==ot);se(mt),tt(mt[0]||null)}catch{e(Jt({type:"error",message:"No se pudo eliminar el banner"}))}},Yt=()=>He(),Ge=()=>{I(""),F(""),ne(""),$(!1)};return r&&!l?f.jsx("div",{className:"p-4 text-red-600",children:"Acceso no autorizado"}):f.jsxs("div",{className:"max-w-[1200px] w-full mx-auto flex flex-col gap-8 md:gap-12 xl:gap-16 px-2",children:[f.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 md:gap-8 xl:gap-10 lg:mt-16",children:[f.jsx("div",{className:"flex-1",children:f.jsx(px,{icon:"🧲",title:"Banners / Ads",badge:"Gestión de anuncios",description:"Aprueba o rechaza banners enviados por usuarios, controla vigencia, límites y estado de publicación.",illustration:Yh})}),qe&&f.jsx("div",{ref:n,className:"hidden md:flex flex-3 flex-col justify-center",children:f.jsx(aV,{banner:qe,onDeleted:Tt,onUpdated:Yt})})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("hr",{className:"flex-grow border-gray-200"}),f.jsx("span",{className:"text-gray-400 text-xs uppercase tracking-wider",children:"Tus banners"}),f.jsx("hr",{className:"flex-grow border-gray-200"})]}),ie?f.jsx("div",{className:"w-full",children:f.jsx(My,{})}):f.jsxs(f.Fragment,{children:[f.jsx(t6e,{q:R,setQ:F,placement:P,setPlacement:I,status:Z,setStatus:ne,activeOnly:W,setActiveOnly:$,onReset:Ge}),me&&f.jsx("div",{className:"p-4 text-red-600",children:me}),ae.length===0?f.jsxs("div",{className:"flex flex-col items-center text-center gap-5 py-16",children:[f.jsx("img",{src:nx,alt:"Sin banners",className:"w-40 opacity-90"}),f.jsxs("p",{className:"text-gray-600  text-xs md:text-base max-w-xs",children:["No hay banners para los filtros seleccionados.",f.jsx("br",{}),"Cambia los filtros o crea uno nuevo."]}),f.jsx(Wn,{to:"crear",className:"inline-block bg-orange-500 hover:bg-orange-600 text-white  text-xs font-medium px-4 py-2 rounded transition",children:"Crear banner"})]}):f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-y-5 gap-x-3 md:gap-6 xl:gap-8",children:ae.map(ot=>f.jsx("div",{onClick:()=>ut(ot),className:"transition",children:f.jsx(GRe,{banner:ot,active:(qe==null?void 0:qe._id)===ot._id,onClick:()=>ut(ot)})},ot._id))}),f.jsx("div",{className:"flex justify-end",children:f.jsxs(Wn,{to:"crear",className:"flex items-center gap-2 bg-black text-white px-3 py-2 rounded hover:bg-[#f4c753] hover:text-black transition  text-xs font-semibold",children:[f.jsx(hy,{className:"text-lg"}),f.jsx("p",{className:"hidden md:block",children:"Crear banner"})]})})]}),nt&&qe&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4",onClick:()=>bt(!1),children:f.jsx("div",{className:"relative w-full max-w-md max-h-[80vh] overflow-y-auto",onClick:ot=>ot.stopPropagation(),children:f.jsx(aV,{banner:qe,onDeleted:ot=>{bt(!1),Tt(ot)},onUpdated:()=>{bt(!1),Yt()}})})})]})}const fP=[{value:"home_top",label:"Home - Top (728x90 / 100% x 120px)"},{value:"home_bottom",label:"Home - Bottom"},{value:"sidebar_right_1",label:"Sidebar derecha #1 (300x250)"},{value:"sidebar_right_2",label:"Sidebar derecha #2 (300x250)"}],iM=e=>{if(e===""||e===null||e===void 0)return null;const t=Number(e);return Number.isFinite(t)?t:null},sV=e=>{if(!e)return null;try{const t=new Date(e);return isNaN(t)?null:t.toISOString()}catch{return null}},i6e=e=>(e||"").split(",").map(t=>t.trim()).filter(Boolean),a6e=li().shape({title:On().required("Título obligatorio"),placement:On().oneOf(fP.map(e=>e.value)).required("Placement obligatorio"),redirectUrl:On().url("URL inválida").required("URL obligatoria"),image:ps().nullable(),imageDesktop:ps().nullable(),imageTablet:ps().nullable(),imageMobile:ps().nullable(),communities:bc().of(li({value:On().required(),label:On().required()})).min(1,"Debes elegir al menos 1 comunidad").required("Debes elegir al menos 1 comunidad"),categories:bc().of(li({value:On().required(),label:On().required()})).optional(),businessesCSV:On().optional(),weight:kd().min(0,"Mínimo 0").nullable(),maxImpressions:kd().min(1,"Debe ser > 0").nullable().transform((e,t)=>t===""?null:e),maxClicks:kd().min(1,"Debe ser > 0").nullable().transform((e,t)=>t===""?null:e),startAt:On().nullable(),endAt:On().nullable(),isFallback:Id().optional(),openInNewTab:Id().optional()}).test("al-menos-una-imagen","Debes subir al menos una imagen (fallback, desktop, tablet o mobile)",e=>!!(e!=null&&e.image||e!=null&&e.imageDesktop||e!=null&&e.imageTablet||e!=null&&e.imageMobile));function s6e(){const e=br(),t=aa(),n=ln(I=>I.auth.usuario),r=(n==null?void 0:n.role)==="admin",l=ln(I=>{var R;return(R=I.comunidades)==null?void 0:R.misComunidades})||[],d=ln(I=>{var R,F;return((R=I.comunidades)==null?void 0:R.lista)||((F=I.communidades)==null?void 0:F.lista)})||[],p=r?l:d,a=V.useMemo(()=>(p||[]).map(I=>({value:I._id??I.id,label:I.name??I.nombre??"—"})),[p]),b=ln(I=>{var R;return(R=I.categorias)==null?void 0:R.data})||[],T=V.useMemo(()=>(b||[]).map(I=>({value:I._id,label:I.name})),[b]),E={title:"",placement:"home_top",redirectUrl:"",openInNewTab:!0,image:null,imageDesktop:null,imageTablet:null,imageMobile:null,communities:[],categories:[],businessesCSV:"",weight:1,maxImpressions:"",maxClicks:"",startAt:"",endAt:"",isFallback:!1},P=async(I,{setSubmitting:R})=>{try{const F={...I};r||(F.openInNewTab=!0,F.isFallback=!1,F.categories=[],F.businessesCSV="",F.weight=1,F.maxImpressions=null,F.maxClicks=null);const W=new FormData,$=(F.communities||[]).map(ge=>ge.value),Z=(F.categories||[]).map(ge=>ge.value),ne=i6e(F.businessesCSV),ie={title:F.title,placement:F.placement,redirectUrl:F.redirectUrl,openInNewTab:!!F.openInNewTab,isFallback:!!F.isFallback,weight:iM(F.weight??1),maxImpressions:iM(F.maxImpressions),maxClicks:iM(F.maxClicks),startAt:sV(F.startAt),endAt:sV(F.endAt),communities:$,categories:Z,businesses:ne};W.append("data",JSON.stringify(ie)),F.image&&typeof F.image!="string"&&W.append("bannerImage",F.image),F.imageDesktop&&typeof F.imageDesktop!="string"&&W.append("bannerDesktop",F.imageDesktop),F.imageTablet&&typeof F.imageTablet!="string"&&W.append("bannerTablet",F.imageTablet),F.imageMobile&&typeof F.imageMobile!="string"&&W.append("bannerMobile",F.imageMobile),await WRe(W),e(Jt({type:"success",message:"✅ Enviado. Te avisaremos por email cuando sea aprobado."})),t("/dashboard/mis-banners")}catch{e(Jt({type:"error",message:"❌ Error al crear el banner"}))}finally{R(!1)}};return f.jsxs(f.Fragment,{children:[f.jsx(Oa,{children:f.jsx("title",{children:"Crear Banner | Dashboard"})}),f.jsx("div",{className:"flex flex-col items-center justify-center md:px-4",children:f.jsx("section",{className:"w-full max-w-3xl shadow md:rounded-2xl p-4 md:p-8 space-y-6 bg-black/40 backdrop-blur-lg",children:f.jsx(ef,{initialValues:E,validationSchema:a6e,onSubmit:P,validateOnBlur:!1,validateOnChange:!1,children:({values:I,setFieldValue:R,isSubmitting:F})=>{const W=I.placement==="home_top"||I.placement==="home_bottom";return f.jsxs(Ud,{className:"grid gap-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Título"}),f.jsx(jn,{name:"title",placeholder:"Ej. Promo de Arepas",className:"w-full px-4 py-3 border border-white/30 bg-white/10 rounded-lg placeholder:text-gray-300 text-white focus:outline-none"}),f.jsx(wn,{name:"title",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Placement"}),f.jsx(gs,{instanceId:"placementSelect",options:fP,value:fP.find($=>$.value===I.placement)||null,onChange:$=>R("placement",($==null?void 0:$.value)||""),styles:xs,placeholder:"Seleccioná un placement…",isSearchable:!0,menuPlacement:"auto"}),f.jsx(wn,{name:"placement",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"URL de destino"}),f.jsx(jn,{name:"redirectUrl",placeholder:"https://tu-destino.com/promo",className:"w-full px-4 py-3 border border-white/30 bg-white/10 rounded-lg placeholder:text-gray-300 text-white focus:outline-none"}),f.jsx(wn,{name:"redirectUrl",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsx("div",{className:"flex items-center gap-6",children:r?f.jsxs(f.Fragment,{children:[f.jsxs("label",{className:"inline-flex items-center gap-2 text-white",children:[f.jsx(jn,{type:"checkbox",name:"openInNewTab"}),f.jsx("span",{className:"  text-xs",children:"Abrir en nueva pestaña"})]}),f.jsxs("label",{className:"inline-flex items-center gap-2 text-white",children:[f.jsx(jn,{type:"checkbox",name:"isFallback"}),f.jsx("span",{className:"  text-xs",children:"Usar como fallback"})]})]}):f.jsxs(f.Fragment,{children:[f.jsx(jn,{type:"hidden",name:"openInNewTab",value:!0}),f.jsx(jn,{type:"hidden",name:"isFallback",value:!1})]})}),f.jsxs("div",{className:"grid gap-5",children:[f.jsx("div",{children:f.jsx(Zl,{value:I.image,onChange:$=>R("image",$),label:"Imagen general / fallback (recomendada siempre)"})}),W&&f.jsxs("div",{className:"grid sm:grid-cols-3 gap-4",children:[f.jsx("div",{children:f.jsx(Zl,{value:I.imageDesktop,onChange:$=>R("imageDesktop",$),label:"Imagen Desktop (opcional)"})}),f.jsx("div",{children:f.jsx(Zl,{value:I.imageTablet,onChange:$=>R("imageTablet",$),label:"Imagen Tablet (opcional)"})}),f.jsx("div",{children:f.jsx(Zl,{value:I.imageMobile,onChange:$=>R("imageMobile",$),label:"Imagen Mobile (opcional)"})})]}),f.jsx(wn,{name:"image",component:"div",className:"text-red-400  text-xs"}),f.jsx(wn,{name:"imageDesktop",component:"div",className:"text-red-400  text-xs"}),f.jsx(wn,{name:"imageTablet",component:"div",className:"text-red-400  text-xs"}),f.jsx(wn,{name:"imageMobile",component:"div",className:"text-red-400  text-xs"}),f.jsx("p",{className:"text-xs text-gray-300",children:"Sugerencias: Home Top/Bottom ~ 120px alto; Sidebar ~ 250px alto. Formatos: JPG/PNG/WebP ≤ 5MB. Podés cargar solo la imagen general o subir variantes por dispositivo para mejor legibilidad."})]}),f.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"sm:col-span-2",children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Comunidades (requerido)"}),f.jsx(gs,{instanceId:"communitiesSelect",isMulti:!0,options:a,value:I.communities,onChange:$=>R("communities",$||[]),styles:xs,placeholder:a.length?"Seleccioná una o más comunidades…":"No hay comunidades disponibles",isSearchable:!0,menuPlacement:"auto"}),f.jsx(wn,{name:"communities",component:"div",className:"text-red-400  text-xs mt-1"}),f.jsx("p",{className:"text-xs text-gray-300 mt-2",children:"Se mostrará cuando el usuario pertenezca a cualquiera de estas comunidades (MVP)."})]}),r?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"sm:col-span-2",children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Categorías (opcional)"}),f.jsx(gs,{instanceId:"categoriesSelect",isMulti:!0,options:T,value:I.categories,onChange:$=>R("categories",$||[]),styles:xs,placeholder:"(Opcional) Elegí categorías para segmentación futura",isSearchable:!0,menuPlacement:"auto"})]}),f.jsxs("div",{className:"sm:col-span-2",children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Businesses (IDs) (opcional)"}),f.jsx(jn,{name:"businessesCSV",placeholder:"id1,id2,id3",className:"w-full px-3 py-2 border border-white/30 bg-white/10 rounded-lg text-white focus:outline-none  text-xs"}),f.jsx("p",{className:"text-xs text-gray-300 mt-2",children:"IDs separados por coma. Si lo dejás vacío, no se restringe por negocio."})]})]}):f.jsxs(f.Fragment,{children:[f.jsx(jn,{type:"hidden",name:"categories"}),f.jsx(jn,{type:"hidden",name:"businessesCSV"})]})]}),r?f.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Peso (rotación)"}),f.jsx(jn,{name:"weight",type:"number",min:"0",placeholder:"1",className:"w-full px-4 py-3 border border-white/30 bg-white/10 rounded-lg text-white focus:outline-none"}),f.jsx(wn,{name:"weight",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Máx. impresiones"}),f.jsx(jn,{name:"maxImpressions",type:"number",min:"1",placeholder:"(opcional)",className:"w-full px-4 py-3 border border-white/30 bg-white/10 rounded-lg text-white focus:outline-none"}),f.jsx(wn,{name:"maxImpressions",component:"div",className:"text-red-400  text-xs mt-1"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Máx. clicks"}),f.jsx(jn,{name:"maxClicks",type:"number",min:"1",placeholder:"(opcional)",className:"w-full px-4 py-3 border border-white/30 bg-white/10 rounded-lg text-white focus:outline-none"}),f.jsx(wn,{name:"maxClicks",component:"div",className:"text-red-400  text-xs mt-1"})]})]}):f.jsxs(f.Fragment,{children:[f.jsx(jn,{type:"hidden",name:"weight"}),f.jsx(jn,{type:"hidden",name:"maxImpressions"}),f.jsx(jn,{type:"hidden",name:"maxClicks"})]}),f.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Inicio (UTC)"}),f.jsx(jn,{name:"startAt",type:"datetime-local",className:"w-full px-4 py-3 border border-white/30 bg-white/10 rounded-lg text-white focus:outline-none"}),f.jsx(wn,{name:"startAt",component:"div",className:"text-red-400  text-xs mt-1"})]}),r?f.jsxs("div",{children:[f.jsx("label",{className:"block  text-xs font-medium text-white mb-1",children:"Fin (UTC)"}),f.jsx(jn,{name:"endAt",type:"datetime-local",className:"w-full px-4 py-3 border border-white/30 bg-white/10 rounded-lg text-white focus:outline-none"}),f.jsx(wn,{name:"endAt",component:"div",className:"text-red-400  text-xs mt-1"})]}):f.jsx(jn,{type:"hidden",name:"endAt"})]}),f.jsx("button",{type:"submit",disabled:F,className:"w-full bg-orange-600 hover:bg-orange-700 text-white py-3 rounded-lg font-semibold transition",children:F?"Creando...":"Crear Banner"})]})}})})})]})}function oV(){return f.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen p-2 gap-8 md:mt-8 lg:mt-16",children:[f.jsx(Oa,{children:f.jsx("title",{children:"Crear Banner | Communidades"})}),f.jsxs("section",{className:"relative w-full max-w-4xl shadow-xl rounded-2xl md:p-6 sm:p-16 space-y-6 overflow-hidden",style:{backgroundImage:`url(${up})`,backgroundSize:"cover",backgroundPosition:"center"},children:[f.jsx("div",{className:"absolute inset-0 bg-white/50 backdrop-blur-sm rounded-xl h-full"}),f.jsxs("div",{className:"relative space-y-6 grid gap-8",children:[f.jsxs("div",{className:"flex items-start justify-between gap-4 flex-wrap sm:flex-nowrap p-4",children:[f.jsxs("div",{className:"flex-1 space-y-2",children:[f.jsx("h1",{className:"text-2xl font-bold text-black",children:"Crear Banner"}),f.jsx("p",{className:"text-gray-700  text-xs sm:text-base",children:"Sube el arte y configura la segmentación, vigencia y límites del anuncio ✨"})]}),f.jsx("img",{src:Kc,alt:"Ilustración",className:"w-36 xl:w-52 opacity-90"})]}),f.jsx(s6e,{})]})]})]})}function o6e({status:e}){const n={submitted:"bg-yellow-100 text-yellow-800",under_review:"bg-amber-100 text-amber-800",approved:"bg-emerald-100 text-emerald-800",awaiting_payment:"bg-blue-100 text-blue-800",active:"bg-green-100 text-green-800",rejected:"bg-gray-200 text-gray-800",archived:"bg-slate-200 text-slate-800"}[e]||"bg-slate-100 text-slate-800";return f.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${n}`,children:e||"—"})}function l6e({banner:e,isHighlight:t,payingId:n,onPay:r}){return f.jsxs("div",{className:["flex bg-white rounded-2xl overflow-hidden shadow-md hover:shadow-lg transition-shadow","h-24 md:h-32",t?"ring-2 ring-emerald-400":"border border-gray-200"].join(" "),children:[f.jsxs("div",{className:"relative flex items-center bg-gray-50 shrink-0 px-3 md:px-4 border-r border-gray-200",children:[e.imageUrl?f.jsx("img",{src:e.imageUrl,alt:e.title,className:"h-full w-auto object-contain max-w-[60vw] md:max-w-[40vw]",loading:"lazy"}):f.jsx("div",{className:"h-full min-w-36 flex items-center justify-center text-xs text-gray-400",children:"Sin imagen"}),f.jsx("div",{className:"absolute top-2 left-2",children:f.jsx(o6e,{status:e.status})})]}),f.jsx("div",{className:"flex-1 min-w-0 p-3 md:p-5 flex items-center",children:f.jsxs("div",{className:"w-full flex flex-col md:flex-row md:items-center md:justify-between gap-1 md:gap-3",children:[f.jsxs("div",{className:"min-w-0",children:[f.jsx("h3",{className:"  text-xs md:text-base font-semibold text-gray-900 truncate",children:e.title}),f.jsxs("p",{className:"text-xs md:  text-xs text-gray-600",children:["Vigencia:"," ",e.startAt?new Date(e.startAt).toLocaleDateString():"—"," ","–"," ",e.endAt?new Date(e.endAt).toLocaleDateString():"—"]})]}),(e.status==="approved"||e.status==="awaiting_payment")&&f.jsx("button",{onClick:()=>r(e._id),disabled:!!n,className:["inline-flex items-center justify-center gap-2 text-xs md:  text-xs px-3 py-2 rounded transition whitespace-nowrap",n?"bg-gray-400 text-white cursor-not-allowed":"bg-black text-white hover:bg-[#f4c753] hover:text-black"].join(" "),children:n===e._id?"Creando pago...":"Pagar"})]})})]})}function c6e(){const e=br(),t=aa(),n=yl(),{usuario:r}=ln(W=>W.auth),l=V.useMemo(()=>new URLSearchParams(n.search),[n.search]),d=l.get("bannerId"),p=l.get("checkout"),[a,b]=V.useState([]),[T,E]=V.useState(!0),[P,I]=V.useState(null),R=async()=>{E(!0);try{const{banners:W}=await ZRe();b(W||[])}catch{e(Jt({type:"error",message:"No se pudieron cargar tus banners"}))}finally{E(!1)}};V.useEffect(()=>{if(R(),p==="success"){e(Jt({type:"success",message:"Pago completado correctamente"}));const W=new URL(window.location.href);W.searchParams.delete("checkout"),W.searchParams.delete("bannerId"),t(W.pathname,{replace:!0})}else if(p==="cancel"){e(Jt({type:"info",message:"Pago cancelado"}));const W=new URL(window.location.href);W.searchParams.delete("checkout"),W.searchParams.delete("bannerId"),t(W.pathname,{replace:!0})}},[]);const F=async W=>{try{I(W);const $=await Lwe(W);$?window.location.href=$:e(Jt({type:"error",message:"No se pudo iniciar el pago"}))}catch{e(Jt({type:"error",message:"Error creando checkout"}))}finally{I(null)}};return r?T?f.jsx(My,{}):f.jsxs("div",{className:"max-w-[1200px] w-full mx-auto flex flex-col gap-8 md:gap-12 xl:gap-16 px-2",children:[f.jsx("div",{className:"flex flex-col lg:flex-row gap-6 md:gap-8 xl:gap-10 lg:mt-16",children:f.jsx("div",{className:"flex-1",children:f.jsx(px,{icon:"📣",title:"Tus banners",badge:"Promociona y crece",description:"Administra tus anuncios, revisa su estado y completa el pago cuando estén aprobados.",illustration:Yh})})}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("hr",{className:"flex-grow border-gray-200"}),f.jsx("span",{className:"text-gray-400 text-xs uppercase tracking-wider",children:"Mis banners"}),f.jsx("hr",{className:"flex-grow border-gray-200"})]}),f.jsxs("div",{className:"flex justify-between items-center mb-4 md:mb-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-[#141C24]",children:"Lista de banners"}),f.jsxs(Wn,{to:"/dashboard/mis-banners/crear",className:"flex items-center gap-2 bg-black text-white px-3 py-2 rounded hover:bg-[#f4c753] hover:text-black transition  text-xs font-semibold",children:[f.jsx("span",{className:"text-md",children:"➕"}),f.jsx("p",{className:"hidden md:block",children:"Crear banner"})]})]}),a.length===0?f.jsxs("div",{className:"flex flex-col items-center text-center gap-5 py-16",children:[f.jsx("img",{src:nx,alt:"Sin banners",className:"w-40 opacity-90"}),f.jsxs("p",{className:"text-gray-600  text-xs md:text-base max-w-xs",children:["Aún no tienes banners.",f.jsx("br",{}),"Crea tu primer anuncio y empieza a darle visibilidad a tu marca."]}),f.jsx(Wn,{to:"/dashboard/mis-banners/crear",className:"inline-block bg-orange-500 hover:bg-orange-600 text-white  text-xs font-medium px-4 py-2 rounded transition",children:"Crear mi primer banner"})]}):f.jsx("div",{className:"grid gap-4",children:a.map(W=>{const $=!!(d&&W._id===d);return f.jsx(l6e,{banner:W,isHighlight:$,payingId:P,onPay:F},W._id)})})]}):f.jsx("div",{className:"p-4",children:"Debes iniciar sesión"})}const u6e=Aoe([{path:"/",element:f.jsxs(f.Fragment,{children:[f.jsx(Uoe,{}),f.jsx($oe,{}),f.jsx(nle,{}),f.jsx(Loe,{children:f.jsx(T0e,{})})]}),children:[{path:"/",element:f.jsx($0e,{})},{path:"/negocios",element:f.jsx(tye,{})},{path:"/negocios/:id",element:f.jsx(Owe,{})},{path:"/eventos",element:f.jsx(iye,{})},{path:"/eventos/:id",element:f.jsx(kwe,{})},{path:"/comunidades",element:f.jsx(oye,{})},{path:"/comunidades/:id",element:f.jsx(pye,{})},{path:"/promociones",children:[{path:"",element:f.jsx(Rwe,{})}]},{path:"/about",element:f.jsx(xye,{})},{path:"/contact",element:f.jsx(vye,{})},{path:"/legal-privacy",element:f.jsx(wye,{})},{path:"/legal-terms",element:f.jsx(Tye,{})},{path:"/premium",element:f.jsx(Fwe,{})},{path:"/suscripcion-exitosa",element:f.jsx(Kwe,{})},{path:"/suscripcion-cancelada",element:f.jsx(Ywe,{})}]},{path:"/login",element:f.jsx(LC,{children:f.jsx(bwe,{})})},{path:"/registro",element:f.jsx(LC,{children:f.jsx(Swe,{})})},{path:"/verifica-tu-correo",element:f.jsx(LC,{children:f.jsx(Twe,{})})},{path:"/dashboard-admin",element:f.jsx(pTe,{}),children:[{path:"",element:f.jsx(X8,{}),children:[{path:"mis-categorias",children:[{path:"",element:f.jsx(mF,{})},{path:"crear",element:f.jsx(JSe,{})},{path:":id/editar",element:f.jsx(tTe,{})}]},{path:"mis-comunidades",children:[{path:"",element:f.jsx(xF,{})},{path:"crear",element:f.jsx(dTe,{})},{path:":id/editar",element:f.jsx(hTe,{})},{path:":id",element:f.jsx($Re,{})}]},{path:"banners",children:[{path:"",element:f.jsx(r6e,{})},{path:"crear",element:f.jsx(oV,{})}]}]}]},{path:"/dashboard",element:f.jsx(fTe,{}),children:[{path:"",element:f.jsx(X8,{}),children:[{path:"inbox",children:[{path:"",element:f.jsx(gTe,{})},{path:"conversation/:id",element:f.jsx(yTe,{})}]},{path:"perfil",element:f.jsx(f2e,{})},{path:"perfil/editar",element:f.jsx(pSe,{})},{path:"notificaciones",element:f.jsx(gSe,{})},{path:"cupones",element:f.jsx(qRe,{})},{path:"redimir",element:f.jsx(HRe,{})},{path:"mis-negocios",children:[{path:"",element:f.jsx(_Se,{})},{path:"crear",element:f.jsx(uF,{})},{path:":id",element:f.jsx(VRe,{})},{path:":id/editar",element:f.jsx(uF,{})},{path:":id/promos",element:f.jsx(MSe,{})},{path:":negocioId/promos/nueva",element:f.jsx(hF,{})}]},{path:"mis-banners",children:[{path:"",element:f.jsx(c6e,{})},{path:"crear",element:f.jsx(oV,{})}]},{path:"mis-eventos",children:[{path:"",element:f.jsx(FSe,{})},{path:"crear",element:f.jsx(ZSe,{})},{path:":id",element:f.jsx(URe,{})},{path:":id/editar",element:f.jsx(XSe,{})}]},{path:"mis-promos",children:[{path:"",element:f.jsx(DSe,{})},{path:":promoId/editar",element:f.jsx(hF,{})}]},{path:"categorias",children:[{path:"",element:f.jsx(mF,{})}]},{path:"comunidades",children:[{path:"",element:f.jsx(xF,{})}]}]}]},{path:"*",element:f.jsx(Aye,{})}]);function d6e(){return f.jsx(zoe,{router:u6e})}pee.createRoot(document.getElementById("root")).render(f.jsx(cV,{store:iae,children:f.jsx($U,{children:f.jsx(d6e,{})})}));const qY=e=>{try{return!new URL(e,window.location.href).hostname.endsWith("communidades.com")}catch{return!0}};document.addEventListener("click",async e=>{const t=e.target.closest("a[href]");if(!t)return;const n=t.getAttribute("href");if(n&&qY(n)){e.preventDefault();try{await i3.open({url:n})}catch{}}});window.open=async e=>{if(qY(e))try{await i3.open({url:e})}catch{}else window.location.href=e};export{cU as W};
